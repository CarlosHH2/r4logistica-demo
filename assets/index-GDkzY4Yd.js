var GW=e=>{throw TypeError(e)};var QL=(e,t,r)=>t.has(e)||GW("Cannot "+r);var mt=(e,t,r)=>(QL(e,t,"read from private field"),r?r.call(e):t.get(e)),dn=(e,t,r)=>t.has(e)?GW("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),zr=(e,t,r,n)=>(QL(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Vn=(e,t,r)=>(QL(e,t,"access private method"),r);var ZA=(e,t,r,n)=>({set _(a){zr(e,t,a,r)},get _(){return mt(e,t,n)}});function ife(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var Na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ofe(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var DY={exports:{}},ek={},LY={exports:{}},ri={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SE=Symbol.for("react.element"),afe=Symbol.for("react.portal"),sfe=Symbol.for("react.fragment"),lfe=Symbol.for("react.strict_mode"),cfe=Symbol.for("react.profiler"),ufe=Symbol.for("react.provider"),dfe=Symbol.for("react.context"),hfe=Symbol.for("react.forward_ref"),ffe=Symbol.for("react.suspense"),pfe=Symbol.for("react.memo"),mfe=Symbol.for("react.lazy"),qW=Symbol.iterator;function gfe(e){return e===null||typeof e!="object"?null:(e=qW&&e[qW]||e["@@iterator"],typeof e=="function"?e:null)}var NY={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zY=Object.assign,jY={};function Bx(e,t,r){this.props=e,this.context=t,this.refs=jY,this.updater=r||NY}Bx.prototype.isReactComponent={};Bx.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Bx.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function FY(){}FY.prototype=Bx.prototype;function iB(e,t,r){this.props=e,this.context=t,this.refs=jY,this.updater=r||NY}var oB=iB.prototype=new FY;oB.constructor=iB;zY(oB,Bx.prototype);oB.isPureReactComponent=!0;var HW=Array.isArray,BY=Object.prototype.hasOwnProperty,aB={current:null},$Y={key:!0,ref:!0,__self:!0,__source:!0};function UY(e,t,r){var n,a={},l=null,h=null;if(t!=null)for(n in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(l=""+t.key),t)BY.call(t,n)&&!$Y.hasOwnProperty(n)&&(a[n]=t[n]);var i=arguments.length-2;if(i===1)a.children=r;else if(1<i){for(var _=Array(i),b=0;b<i;b++)_[b]=arguments[b+2];a.children=_}if(e&&e.defaultProps)for(n in i=e.defaultProps,i)a[n]===void 0&&(a[n]=i[n]);return{$$typeof:SE,type:e,key:l,ref:h,props:a,_owner:aB.current}}function yfe(e,t){return{$$typeof:SE,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function sB(e){return typeof e=="object"&&e!==null&&e.$$typeof===SE}function vfe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var ZW=/\/+/g;function e3(e,t){return typeof e=="object"&&e!==null&&e.key!=null?vfe(""+e.key):t.toString(36)}function XC(e,t,r,n,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(l){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case SE:case afe:h=!0}}if(h)return h=e,a=a(h),e=n===""?"."+e3(h,0):n,HW(a)?(r="",e!=null&&(r=e.replace(ZW,"$&/")+"/"),XC(a,t,r,"",function(b){return b})):a!=null&&(sB(a)&&(a=yfe(a,r+(!a.key||h&&h.key===a.key?"":(""+a.key).replace(ZW,"$&/")+"/")+e)),t.push(a)),1;if(h=0,n=n===""?".":n+":",HW(e))for(var i=0;i<e.length;i++){l=e[i];var _=n+e3(l,i);h+=XC(l,t,r,_,a)}else if(_=gfe(e),typeof _=="function")for(e=_.call(e),i=0;!(l=e.next()).done;)l=l.value,_=n+e3(l,i++),h+=XC(l,t,r,_,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function XA(e,t,r){if(e==null)return e;var n=[],a=0;return XC(e,n,"","",function(l){return t.call(r,l,a++)}),n}function _fe(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ws={current:null},YC={transition:null},xfe={ReactCurrentDispatcher:Ws,ReactCurrentBatchConfig:YC,ReactCurrentOwner:aB};function VY(){throw Error("act(...) is not supported in production builds of React.")}ri.Children={map:XA,forEach:function(e,t,r){XA(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return XA(e,function(){t++}),t},toArray:function(e){return XA(e,function(t){return t})||[]},only:function(e){if(!sB(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ri.Component=Bx;ri.Fragment=sfe;ri.Profiler=cfe;ri.PureComponent=iB;ri.StrictMode=lfe;ri.Suspense=ffe;ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xfe;ri.act=VY;ri.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=zY({},e.props),a=e.key,l=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,h=aB.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(_ in t)BY.call(t,_)&&!$Y.hasOwnProperty(_)&&(n[_]=t[_]===void 0&&i!==void 0?i[_]:t[_])}var _=arguments.length-2;if(_===1)n.children=r;else if(1<_){i=Array(_);for(var b=0;b<_;b++)i[b]=arguments[b+2];n.children=i}return{$$typeof:SE,type:e.type,key:a,ref:l,props:n,_owner:h}};ri.createContext=function(e){return e={$$typeof:dfe,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ufe,_context:e},e.Consumer=e};ri.createElement=UY;ri.createFactory=function(e){var t=UY.bind(null,e);return t.type=e,t};ri.createRef=function(){return{current:null}};ri.forwardRef=function(e){return{$$typeof:hfe,render:e}};ri.isValidElement=sB;ri.lazy=function(e){return{$$typeof:mfe,_payload:{_status:-1,_result:e},_init:_fe}};ri.memo=function(e,t){return{$$typeof:pfe,type:e,compare:t===void 0?null:t}};ri.startTransition=function(e){var t=YC.transition;YC.transition={};try{e()}finally{YC.transition=t}};ri.unstable_act=VY;ri.useCallback=function(e,t){return Ws.current.useCallback(e,t)};ri.useContext=function(e){return Ws.current.useContext(e)};ri.useDebugValue=function(){};ri.useDeferredValue=function(e){return Ws.current.useDeferredValue(e)};ri.useEffect=function(e,t){return Ws.current.useEffect(e,t)};ri.useId=function(){return Ws.current.useId()};ri.useImperativeHandle=function(e,t,r){return Ws.current.useImperativeHandle(e,t,r)};ri.useInsertionEffect=function(e,t){return Ws.current.useInsertionEffect(e,t)};ri.useLayoutEffect=function(e,t){return Ws.current.useLayoutEffect(e,t)};ri.useMemo=function(e,t){return Ws.current.useMemo(e,t)};ri.useReducer=function(e,t,r){return Ws.current.useReducer(e,t,r)};ri.useRef=function(e){return Ws.current.useRef(e)};ri.useState=function(e){return Ws.current.useState(e)};ri.useSyncExternalStore=function(e,t,r){return Ws.current.useSyncExternalStore(e,t,r)};ri.useTransition=function(){return Ws.current.useTransition()};ri.version="18.3.1";LY.exports=ri;var ne=LY.exports;const Ae=yi(ne),tk=ife({__proto__:null,default:Ae},[ne]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bfe=ne,wfe=Symbol.for("react.element"),Sfe=Symbol.for("react.fragment"),Tfe=Object.prototype.hasOwnProperty,Efe=bfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Afe={key:!0,ref:!0,__self:!0,__source:!0};function WY(e,t,r){var n,a={},l=null,h=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(h=t.ref);for(n in t)Tfe.call(t,n)&&!Afe.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:wfe,type:e,key:l,ref:h,props:a,_owner:Efe.current}}ek.Fragment=Sfe;ek.jsx=WY;ek.jsxs=WY;DY.exports=ek;var j=DY.exports,GY={exports:{}},ac={},qY={exports:{}},HY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Be,lt){var zt=Be.length;Be.push(lt);e:for(;0<zt;){var Lt=zt-1>>>1,Bt=Be[Lt];if(0<a(Bt,lt))Be[Lt]=lt,Be[zt]=Bt,zt=Lt;else break e}}function r(Be){return Be.length===0?null:Be[0]}function n(Be){if(Be.length===0)return null;var lt=Be[0],zt=Be.pop();if(zt!==lt){Be[0]=zt;e:for(var Lt=0,Bt=Be.length,ct=Bt>>>1;Lt<ct;){var nr=2*(Lt+1)-1,mr=Be[nr],ir=nr+1,Ut=Be[ir];if(0>a(mr,zt))ir<Bt&&0>a(Ut,mr)?(Be[Lt]=Ut,Be[ir]=zt,Lt=ir):(Be[Lt]=mr,Be[nr]=zt,Lt=nr);else if(ir<Bt&&0>a(Ut,zt))Be[Lt]=Ut,Be[ir]=zt,Lt=ir;else break e}}return lt}function a(Be,lt){var zt=Be.sortIndex-lt.sortIndex;return zt!==0?zt:Be.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var h=Date,i=h.now();e.unstable_now=function(){return h.now()-i}}var _=[],b=[],E=1,C=null,I=3,F=!1,$=!1,B=!1,q=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function J(Be){for(var lt=r(b);lt!==null;){if(lt.callback===null)n(b);else if(lt.startTime<=Be)n(b),lt.sortIndex=lt.expirationTime,t(_,lt);else break;lt=r(b)}}function Q(Be){if(B=!1,J(Be),!$)if(r(_)!==null)$=!0,st(oe);else{var lt=r(b);lt!==null&&ot(Q,lt.startTime-Be)}}function oe(Be,lt){$=!1,B&&(B=!1,G(ve),ve=-1),F=!0;var zt=I;try{for(J(lt),C=r(_);C!==null&&(!(C.expirationTime>lt)||Be&&!Ce());){var Lt=C.callback;if(typeof Lt=="function"){C.callback=null,I=C.priorityLevel;var Bt=Lt(C.expirationTime<=lt);lt=e.unstable_now(),typeof Bt=="function"?C.callback=Bt:C===r(_)&&n(_),J(lt)}else n(_);C=r(_)}if(C!==null)var ct=!0;else{var nr=r(b);nr!==null&&ot(Q,nr.startTime-lt),ct=!1}return ct}finally{C=null,I=zt,F=!1}}var de=!1,ae=null,ve=-1,Fe=5,ke=-1;function Ce(){return!(e.unstable_now()-ke<Fe)}function je(){if(ae!==null){var Be=e.unstable_now();ke=Be;var lt=!0;try{lt=ae(!0,Be)}finally{lt?tt():(de=!1,ae=null)}}else de=!1}var tt;if(typeof H=="function")tt=function(){H(je)};else if(typeof MessageChannel<"u"){var Ze=new MessageChannel,Qe=Ze.port2;Ze.port1.onmessage=je,tt=function(){Qe.postMessage(null)}}else tt=function(){q(je,0)};function st(Be){ae=Be,de||(de=!0,tt())}function ot(Be,lt){ve=q(function(){Be(e.unstable_now())},lt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Be){Be.callback=null},e.unstable_continueExecution=function(){$||F||($=!0,st(oe))},e.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Fe=0<Be?Math.floor(1e3/Be):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return r(_)},e.unstable_next=function(Be){switch(I){case 1:case 2:case 3:var lt=3;break;default:lt=I}var zt=I;I=lt;try{return Be()}finally{I=zt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Be,lt){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var zt=I;I=Be;try{return lt()}finally{I=zt}},e.unstable_scheduleCallback=function(Be,lt,zt){var Lt=e.unstable_now();switch(typeof zt=="object"&&zt!==null?(zt=zt.delay,zt=typeof zt=="number"&&0<zt?Lt+zt:Lt):zt=Lt,Be){case 1:var Bt=-1;break;case 2:Bt=250;break;case 5:Bt=1073741823;break;case 4:Bt=1e4;break;default:Bt=5e3}return Bt=zt+Bt,Be={id:E++,callback:lt,priorityLevel:Be,startTime:zt,expirationTime:Bt,sortIndex:-1},zt>Lt?(Be.sortIndex=zt,t(b,Be),r(_)===null&&Be===r(b)&&(B?(G(ve),ve=-1):B=!0,ot(Q,zt-Lt))):(Be.sortIndex=Bt,t(_,Be),$||F||($=!0,st(oe))),Be},e.unstable_shouldYield=Ce,e.unstable_wrapCallback=function(Be){var lt=I;return function(){var zt=I;I=lt;try{return Be.apply(this,arguments)}finally{I=zt}}}})(HY);qY.exports=HY;var Cfe=qY.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mfe=ne,rc=Cfe;function pr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ZY=new Set,YS={};function qy(e,t){H0(e,t),H0(e+"Capture",t)}function H0(e,t){for(YS[e]=t,e=0;e<t.length;e++)ZY.add(t[e])}var qh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),HN=Object.prototype.hasOwnProperty,Pfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XW={},YW={};function Ife(e){return HN.call(YW,e)?!0:HN.call(XW,e)?!1:Pfe.test(e)?YW[e]=!0:(XW[e]=!0,!1)}function Ofe(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kfe(e,t,r,n){if(t===null||typeof t>"u"||Ofe(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gs(e,t,r,n,a,l,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=h}var Ya={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ya[e]=new Gs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ya[t]=new Gs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ya[e]=new Gs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ya[e]=new Gs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ya[e]=new Gs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ya[e]=new Gs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ya[e]=new Gs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ya[e]=new Gs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ya[e]=new Gs(e,5,!1,e.toLowerCase(),null,!1,!1)});var lB=/[\-:]([a-z])/g;function cB(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(lB,cB);Ya[t]=new Gs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(lB,cB);Ya[t]=new Gs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(lB,cB);Ya[t]=new Gs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ya[e]=new Gs(e,1,!1,e.toLowerCase(),null,!1,!1)});Ya.xlinkHref=new Gs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ya[e]=new Gs(e,1,!1,e.toLowerCase(),null,!0,!0)});function uB(e,t,r,n){var a=Ya.hasOwnProperty(t)?Ya[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kfe(t,r,a,n)&&(r=null),n||a===null?Ife(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var sf=Mfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,YA=Symbol.for("react.element"),J_=Symbol.for("react.portal"),Q_=Symbol.for("react.fragment"),dB=Symbol.for("react.strict_mode"),ZN=Symbol.for("react.profiler"),XY=Symbol.for("react.provider"),YY=Symbol.for("react.context"),hB=Symbol.for("react.forward_ref"),XN=Symbol.for("react.suspense"),YN=Symbol.for("react.suspense_list"),fB=Symbol.for("react.memo"),Mp=Symbol.for("react.lazy"),KY=Symbol.for("react.offscreen"),KW=Symbol.iterator;function pw(e){return e===null||typeof e!="object"?null:(e=KW&&e[KW]||e["@@iterator"],typeof e=="function"?e:null)}var Ro=Object.assign,t3;function Ww(e){if(t3===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);t3=t&&t[1]||""}return`
`+t3+e}var r3=!1;function n3(e,t){if(!e||r3)return"";r3=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var n=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){n=b}e.call(t.prototype)}else{try{throw Error()}catch(b){n=b}e()}}catch(b){if(b&&n&&typeof b.stack=="string"){for(var a=b.stack.split(`
`),l=n.stack.split(`
`),h=a.length-1,i=l.length-1;1<=h&&0<=i&&a[h]!==l[i];)i--;for(;1<=h&&0<=i;h--,i--)if(a[h]!==l[i]){if(h!==1||i!==1)do if(h--,i--,0>i||a[h]!==l[i]){var _=`
`+a[h].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=h&&0<=i);break}}}finally{r3=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ww(e):""}function Rfe(e){switch(e.tag){case 5:return Ww(e.type);case 16:return Ww("Lazy");case 13:return Ww("Suspense");case 19:return Ww("SuspenseList");case 0:case 2:case 15:return e=n3(e.type,!1),e;case 11:return e=n3(e.type.render,!1),e;case 1:return e=n3(e.type,!0),e;default:return""}}function KN(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Q_:return"Fragment";case J_:return"Portal";case ZN:return"Profiler";case dB:return"StrictMode";case XN:return"Suspense";case YN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case YY:return(e.displayName||"Context")+".Consumer";case XY:return(e._context.displayName||"Context")+".Provider";case hB:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fB:return t=e.displayName||null,t!==null?t:KN(e.type)||"Memo";case Mp:t=e._payload,e=e._init;try{return KN(e(t))}catch{}}return null}function Dfe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return KN(t);case 8:return t===dB?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function mm(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function JY(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Lfe(e){var t=JY(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,l=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(h){n=""+h,l.call(this,h)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(h){n=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function KA(e){e._valueTracker||(e._valueTracker=Lfe(e))}function QY(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=JY(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function WP(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function JN(e,t){var r=t.checked;return Ro({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function JW(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=mm(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function eK(e,t){t=t.checked,t!=null&&uB(e,"checked",t,!1)}function QN(e,t){eK(e,t);var r=mm(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ez(e,t.type,r):t.hasOwnProperty("defaultValue")&&ez(e,t.type,mm(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function QW(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ez(e,t,r){(t!=="number"||WP(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Gw=Array.isArray;function g0(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+mm(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function tz(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pr(91));return Ro({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function eG(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pr(92));if(Gw(r)){if(1<r.length)throw Error(pr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:mm(r)}}function tK(e,t){var r=mm(t.value),n=mm(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function tG(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rK(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rz(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rK(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var JA,nK=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(JA=JA||document.createElement("div"),JA.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=JA.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function KS(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var AS={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nfe=["Webkit","ms","Moz","O"];Object.keys(AS).forEach(function(e){Nfe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),AS[t]=AS[e]})});function iK(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||AS.hasOwnProperty(e)&&AS[e]?(""+t).trim():t+"px"}function oK(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=iK(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var zfe=Ro({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nz(e,t){if(t){if(zfe[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pr(62))}}function iz(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oz=null;function pB(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var az=null,y0=null,v0=null;function rG(e){if(e=AE(e)){if(typeof az!="function")throw Error(pr(280));var t=e.stateNode;t&&(t=ak(t),az(e.stateNode,e.type,t))}}function aK(e){y0?v0?v0.push(e):v0=[e]:y0=e}function sK(){if(y0){var e=y0,t=v0;if(v0=y0=null,rG(e),t)for(e=0;e<t.length;e++)rG(t[e])}}function lK(e,t){return e(t)}function cK(){}var i3=!1;function uK(e,t,r){if(i3)return e(t,r);i3=!0;try{return lK(e,t,r)}finally{i3=!1,(y0!==null||v0!==null)&&(cK(),sK())}}function JS(e,t){var r=e.stateNode;if(r===null)return null;var n=ak(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pr(231,t,typeof r));return r}var sz=!1;if(qh)try{var mw={};Object.defineProperty(mw,"passive",{get:function(){sz=!0}}),window.addEventListener("test",mw,mw),window.removeEventListener("test",mw,mw)}catch{sz=!1}function jfe(e,t,r,n,a,l,h,i,_){var b=Array.prototype.slice.call(arguments,3);try{t.apply(r,b)}catch(E){this.onError(E)}}var CS=!1,GP=null,qP=!1,lz=null,Ffe={onError:function(e){CS=!0,GP=e}};function Bfe(e,t,r,n,a,l,h,i,_){CS=!1,GP=null,jfe.apply(Ffe,arguments)}function $fe(e,t,r,n,a,l,h,i,_){if(Bfe.apply(this,arguments),CS){if(CS){var b=GP;CS=!1,GP=null}else throw Error(pr(198));qP||(qP=!0,lz=b)}}function Hy(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function dK(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function nG(e){if(Hy(e)!==e)throw Error(pr(188))}function Ufe(e){var t=e.alternate;if(!t){if(t=Hy(e),t===null)throw Error(pr(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var l=a.alternate;if(l===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===r)return nG(a),e;if(l===n)return nG(a),t;l=l.sibling}throw Error(pr(188))}if(r.return!==n.return)r=a,n=l;else{for(var h=!1,i=a.child;i;){if(i===r){h=!0,r=a,n=l;break}if(i===n){h=!0,n=a,r=l;break}i=i.sibling}if(!h){for(i=l.child;i;){if(i===r){h=!0,r=l,n=a;break}if(i===n){h=!0,n=l,r=a;break}i=i.sibling}if(!h)throw Error(pr(189))}}if(r.alternate!==n)throw Error(pr(190))}if(r.tag!==3)throw Error(pr(188));return r.stateNode.current===r?e:t}function hK(e){return e=Ufe(e),e!==null?fK(e):null}function fK(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fK(e);if(t!==null)return t;e=e.sibling}return null}var pK=rc.unstable_scheduleCallback,iG=rc.unstable_cancelCallback,Vfe=rc.unstable_shouldYield,Wfe=rc.unstable_requestPaint,Yo=rc.unstable_now,Gfe=rc.unstable_getCurrentPriorityLevel,mB=rc.unstable_ImmediatePriority,mK=rc.unstable_UserBlockingPriority,HP=rc.unstable_NormalPriority,qfe=rc.unstable_LowPriority,gK=rc.unstable_IdlePriority,rk=null,Ld=null;function Hfe(e){if(Ld&&typeof Ld.onCommitFiberRoot=="function")try{Ld.onCommitFiberRoot(rk,e,void 0,(e.current.flags&128)===128)}catch{}}var Iu=Math.clz32?Math.clz32:Yfe,Zfe=Math.log,Xfe=Math.LN2;function Yfe(e){return e>>>=0,e===0?32:31-(Zfe(e)/Xfe|0)|0}var QA=64,eC=4194304;function qw(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ZP(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,l=e.pingedLanes,h=r&268435455;if(h!==0){var i=h&~a;i!==0?n=qw(i):(l&=h,l!==0&&(n=qw(l)))}else h=r&~a,h!==0?n=qw(h):l!==0&&(n=qw(l));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Iu(t),a=1<<r,n|=e[r],t&=~a;return n}function Kfe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jfe(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var h=31-Iu(l),i=1<<h,_=a[h];_===-1?(!(i&r)||i&n)&&(a[h]=Kfe(i,t)):_<=t&&(e.expiredLanes|=i),l&=~i}}function cz(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yK(){var e=QA;return QA<<=1,!(QA&4194240)&&(QA=64),e}function o3(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function TE(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Iu(t),e[t]=r}function Qfe(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Iu(r),l=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~l}}function gB(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Iu(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ni=0;function vK(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _K,yB,xK,bK,wK,uz=!1,tC=[],em=null,tm=null,rm=null,QS=new Map,eT=new Map,kp=[],epe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oG(e,t){switch(e){case"focusin":case"focusout":em=null;break;case"dragenter":case"dragleave":tm=null;break;case"mouseover":case"mouseout":rm=null;break;case"pointerover":case"pointerout":QS.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":eT.delete(t.pointerId)}}function gw(e,t,r,n,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:l,targetContainers:[a]},t!==null&&(t=AE(t),t!==null&&yB(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function tpe(e,t,r,n,a){switch(t){case"focusin":return em=gw(em,e,t,r,n,a),!0;case"dragenter":return tm=gw(tm,e,t,r,n,a),!0;case"mouseover":return rm=gw(rm,e,t,r,n,a),!0;case"pointerover":var l=a.pointerId;return QS.set(l,gw(QS.get(l)||null,e,t,r,n,a)),!0;case"gotpointercapture":return l=a.pointerId,eT.set(l,gw(eT.get(l)||null,e,t,r,n,a)),!0}return!1}function SK(e){var t=Jg(e.target);if(t!==null){var r=Hy(t);if(r!==null){if(t=r.tag,t===13){if(t=dK(r),t!==null){e.blockedOn=t,wK(e.priority,function(){xK(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function KC(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=dz(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);oz=n,r.target.dispatchEvent(n),oz=null}else return t=AE(r),t!==null&&yB(t),e.blockedOn=r,!1;t.shift()}return!0}function aG(e,t,r){KC(e)&&r.delete(t)}function rpe(){uz=!1,em!==null&&KC(em)&&(em=null),tm!==null&&KC(tm)&&(tm=null),rm!==null&&KC(rm)&&(rm=null),QS.forEach(aG),eT.forEach(aG)}function yw(e,t){e.blockedOn===t&&(e.blockedOn=null,uz||(uz=!0,rc.unstable_scheduleCallback(rc.unstable_NormalPriority,rpe)))}function tT(e){function t(a){return yw(a,e)}if(0<tC.length){yw(tC[0],e);for(var r=1;r<tC.length;r++){var n=tC[r];n.blockedOn===e&&(n.blockedOn=null)}}for(em!==null&&yw(em,e),tm!==null&&yw(tm,e),rm!==null&&yw(rm,e),QS.forEach(t),eT.forEach(t),r=0;r<kp.length;r++)n=kp[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<kp.length&&(r=kp[0],r.blockedOn===null);)SK(r),r.blockedOn===null&&kp.shift()}var _0=sf.ReactCurrentBatchConfig,XP=!0;function npe(e,t,r,n){var a=Ni,l=_0.transition;_0.transition=null;try{Ni=1,vB(e,t,r,n)}finally{Ni=a,_0.transition=l}}function ipe(e,t,r,n){var a=Ni,l=_0.transition;_0.transition=null;try{Ni=4,vB(e,t,r,n)}finally{Ni=a,_0.transition=l}}function vB(e,t,r,n){if(XP){var a=dz(e,t,r,n);if(a===null)m3(e,t,n,YP,r),oG(e,n);else if(tpe(a,e,t,r,n))n.stopPropagation();else if(oG(e,n),t&4&&-1<epe.indexOf(e)){for(;a!==null;){var l=AE(a);if(l!==null&&_K(l),l=dz(e,t,r,n),l===null&&m3(e,t,n,YP,r),l===a)break;a=l}a!==null&&n.stopPropagation()}else m3(e,t,n,null,r)}}var YP=null;function dz(e,t,r,n){if(YP=null,e=pB(n),e=Jg(e),e!==null)if(t=Hy(e),t===null)e=null;else if(r=t.tag,r===13){if(e=dK(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return YP=e,null}function TK(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gfe()){case mB:return 1;case mK:return 4;case HP:case qfe:return 16;case gK:return 536870912;default:return 16}default:return 16}}var Zp=null,_B=null,JC=null;function EK(){if(JC)return JC;var e,t=_B,r=t.length,n,a="value"in Zp?Zp.value:Zp.textContent,l=a.length;for(e=0;e<r&&t[e]===a[e];e++);var h=r-e;for(n=1;n<=h&&t[r-n]===a[l-n];n++);return JC=a.slice(e,1<n?1-n:void 0)}function QC(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function rC(){return!0}function sG(){return!1}function sc(e){function t(r,n,a,l,h){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=l,this.target=h,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(r=e[i],this[i]=r?r(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?rC:sG,this.isPropagationStopped=sG,this}return Ro(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=rC)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=rC)},persist:function(){},isPersistent:rC}),t}var $x={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xB=sc($x),EE=Ro({},$x,{view:0,detail:0}),ope=sc(EE),a3,s3,vw,nk=Ro({},EE,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bB,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vw&&(vw&&e.type==="mousemove"?(a3=e.screenX-vw.screenX,s3=e.screenY-vw.screenY):s3=a3=0,vw=e),a3)},movementY:function(e){return"movementY"in e?e.movementY:s3}}),lG=sc(nk),ape=Ro({},nk,{dataTransfer:0}),spe=sc(ape),lpe=Ro({},EE,{relatedTarget:0}),l3=sc(lpe),cpe=Ro({},$x,{animationName:0,elapsedTime:0,pseudoElement:0}),upe=sc(cpe),dpe=Ro({},$x,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hpe=sc(dpe),fpe=Ro({},$x,{data:0}),cG=sc(fpe),ppe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mpe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gpe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ype(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gpe[e])?!!t[e]:!1}function bB(){return ype}var vpe=Ro({},EE,{key:function(e){if(e.key){var t=ppe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=QC(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mpe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bB,charCode:function(e){return e.type==="keypress"?QC(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?QC(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_pe=sc(vpe),xpe=Ro({},nk,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uG=sc(xpe),bpe=Ro({},EE,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bB}),wpe=sc(bpe),Spe=Ro({},$x,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tpe=sc(Spe),Epe=Ro({},nk,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ape=sc(Epe),Cpe=[9,13,27,32],wB=qh&&"CompositionEvent"in window,MS=null;qh&&"documentMode"in document&&(MS=document.documentMode);var Mpe=qh&&"TextEvent"in window&&!MS,AK=qh&&(!wB||MS&&8<MS&&11>=MS),dG=" ",hG=!1;function CK(e,t){switch(e){case"keyup":return Cpe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MK(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var e0=!1;function Ppe(e,t){switch(e){case"compositionend":return MK(t);case"keypress":return t.which!==32?null:(hG=!0,dG);case"textInput":return e=t.data,e===dG&&hG?null:e;default:return null}}function Ipe(e,t){if(e0)return e==="compositionend"||!wB&&CK(e,t)?(e=EK(),JC=_B=Zp=null,e0=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return AK&&t.locale!=="ko"?null:t.data;default:return null}}var Ope={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fG(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ope[e.type]:t==="textarea"}function PK(e,t,r,n){aK(n),t=KP(t,"onChange"),0<t.length&&(r=new xB("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var PS=null,rT=null;function kpe(e){BK(e,0)}function ik(e){var t=n0(e);if(QY(t))return e}function Rpe(e,t){if(e==="change")return t}var IK=!1;if(qh){var c3;if(qh){var u3="oninput"in document;if(!u3){var pG=document.createElement("div");pG.setAttribute("oninput","return;"),u3=typeof pG.oninput=="function"}c3=u3}else c3=!1;IK=c3&&(!document.documentMode||9<document.documentMode)}function mG(){PS&&(PS.detachEvent("onpropertychange",OK),rT=PS=null)}function OK(e){if(e.propertyName==="value"&&ik(rT)){var t=[];PK(t,rT,e,pB(e)),uK(kpe,t)}}function Dpe(e,t,r){e==="focusin"?(mG(),PS=t,rT=r,PS.attachEvent("onpropertychange",OK)):e==="focusout"&&mG()}function Lpe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ik(rT)}function Npe(e,t){if(e==="click")return ik(t)}function zpe(e,t){if(e==="input"||e==="change")return ik(t)}function jpe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nu=typeof Object.is=="function"?Object.is:jpe;function nT(e,t){if(Nu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!HN.call(t,a)||!Nu(e[a],t[a]))return!1}return!0}function gG(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function yG(e,t){var r=gG(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=gG(r)}}function kK(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?kK(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function RK(){for(var e=window,t=WP();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=WP(e.document)}return t}function SB(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Fpe(e){var t=RK(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&kK(r.ownerDocument.documentElement,r)){if(n!==null&&SB(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,l=Math.min(n.start,a);n=n.end===void 0?l:Math.min(n.end,a),!e.extend&&l>n&&(a=n,n=l,l=a),a=yG(r,l);var h=yG(r,n);a&&h&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>n?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Bpe=qh&&"documentMode"in document&&11>=document.documentMode,t0=null,hz=null,IS=null,fz=!1;function vG(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fz||t0==null||t0!==WP(n)||(n=t0,"selectionStart"in n&&SB(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),IS&&nT(IS,n)||(IS=n,n=KP(hz,"onSelect"),0<n.length&&(t=new xB("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=t0)))}function nC(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var r0={animationend:nC("Animation","AnimationEnd"),animationiteration:nC("Animation","AnimationIteration"),animationstart:nC("Animation","AnimationStart"),transitionend:nC("Transition","TransitionEnd")},d3={},DK={};qh&&(DK=document.createElement("div").style,"AnimationEvent"in window||(delete r0.animationend.animation,delete r0.animationiteration.animation,delete r0.animationstart.animation),"TransitionEvent"in window||delete r0.transitionend.transition);function ok(e){if(d3[e])return d3[e];if(!r0[e])return e;var t=r0[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in DK)return d3[e]=t[r];return e}var LK=ok("animationend"),NK=ok("animationiteration"),zK=ok("animationstart"),jK=ok("transitionend"),FK=new Map,_G="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cm(e,t){FK.set(e,t),qy(t,[e])}for(var h3=0;h3<_G.length;h3++){var f3=_G[h3],$pe=f3.toLowerCase(),Upe=f3[0].toUpperCase()+f3.slice(1);Cm($pe,"on"+Upe)}Cm(LK,"onAnimationEnd");Cm(NK,"onAnimationIteration");Cm(zK,"onAnimationStart");Cm("dblclick","onDoubleClick");Cm("focusin","onFocus");Cm("focusout","onBlur");Cm(jK,"onTransitionEnd");H0("onMouseEnter",["mouseout","mouseover"]);H0("onMouseLeave",["mouseout","mouseover"]);H0("onPointerEnter",["pointerout","pointerover"]);H0("onPointerLeave",["pointerout","pointerover"]);qy("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qy("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qy("onBeforeInput",["compositionend","keypress","textInput","paste"]);qy("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qy("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qy("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vpe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hw));function xG(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,$fe(n,t,void 0,e),e.currentTarget=null}function BK(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var l=void 0;if(t)for(var h=n.length-1;0<=h;h--){var i=n[h],_=i.instance,b=i.currentTarget;if(i=i.listener,_!==l&&a.isPropagationStopped())break e;xG(a,i,b),l=_}else for(h=0;h<n.length;h++){if(i=n[h],_=i.instance,b=i.currentTarget,i=i.listener,_!==l&&a.isPropagationStopped())break e;xG(a,i,b),l=_}}}if(qP)throw e=lz,qP=!1,lz=null,e}function ho(e,t){var r=t[vz];r===void 0&&(r=t[vz]=new Set);var n=e+"__bubble";r.has(n)||($K(t,e,2,!1),r.add(n))}function p3(e,t,r){var n=0;t&&(n|=4),$K(r,e,n,t)}var iC="_reactListening"+Math.random().toString(36).slice(2);function iT(e){if(!e[iC]){e[iC]=!0,ZY.forEach(function(r){r!=="selectionchange"&&(Vpe.has(r)||p3(r,!1,e),p3(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[iC]||(t[iC]=!0,p3("selectionchange",!1,t))}}function $K(e,t,r,n){switch(TK(t)){case 1:var a=npe;break;case 4:a=ipe;break;default:a=vB}r=a.bind(null,t,r,e),a=void 0,!sz||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function m3(e,t,r,n,a){var l=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var h=n.tag;if(h===3||h===4){var i=n.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(h===4)for(h=n.return;h!==null;){var _=h.tag;if((_===3||_===4)&&(_=h.stateNode.containerInfo,_===a||_.nodeType===8&&_.parentNode===a))return;h=h.return}for(;i!==null;){if(h=Jg(i),h===null)return;if(_=h.tag,_===5||_===6){n=l=h;continue e}i=i.parentNode}}n=n.return}uK(function(){var b=l,E=pB(r),C=[];e:{var I=FK.get(e);if(I!==void 0){var F=xB,$=e;switch(e){case"keypress":if(QC(r)===0)break e;case"keydown":case"keyup":F=_pe;break;case"focusin":$="focus",F=l3;break;case"focusout":$="blur",F=l3;break;case"beforeblur":case"afterblur":F=l3;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=lG;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=spe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=wpe;break;case LK:case NK:case zK:F=upe;break;case jK:F=Tpe;break;case"scroll":F=ope;break;case"wheel":F=Ape;break;case"copy":case"cut":case"paste":F=hpe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=uG}var B=(t&4)!==0,q=!B&&e==="scroll",G=B?I!==null?I+"Capture":null:I;B=[];for(var H=b,J;H!==null;){J=H;var Q=J.stateNode;if(J.tag===5&&Q!==null&&(J=Q,G!==null&&(Q=JS(H,G),Q!=null&&B.push(oT(H,Q,J)))),q)break;H=H.return}0<B.length&&(I=new F(I,$,null,r,E),C.push({event:I,listeners:B}))}}if(!(t&7)){e:{if(I=e==="mouseover"||e==="pointerover",F=e==="mouseout"||e==="pointerout",I&&r!==oz&&($=r.relatedTarget||r.fromElement)&&(Jg($)||$[Hh]))break e;if((F||I)&&(I=E.window===E?E:(I=E.ownerDocument)?I.defaultView||I.parentWindow:window,F?($=r.relatedTarget||r.toElement,F=b,$=$?Jg($):null,$!==null&&(q=Hy($),$!==q||$.tag!==5&&$.tag!==6)&&($=null)):(F=null,$=b),F!==$)){if(B=lG,Q="onMouseLeave",G="onMouseEnter",H="mouse",(e==="pointerout"||e==="pointerover")&&(B=uG,Q="onPointerLeave",G="onPointerEnter",H="pointer"),q=F==null?I:n0(F),J=$==null?I:n0($),I=new B(Q,H+"leave",F,r,E),I.target=q,I.relatedTarget=J,Q=null,Jg(E)===b&&(B=new B(G,H+"enter",$,r,E),B.target=J,B.relatedTarget=q,Q=B),q=Q,F&&$)t:{for(B=F,G=$,H=0,J=B;J;J=y_(J))H++;for(J=0,Q=G;Q;Q=y_(Q))J++;for(;0<H-J;)B=y_(B),H--;for(;0<J-H;)G=y_(G),J--;for(;H--;){if(B===G||G!==null&&B===G.alternate)break t;B=y_(B),G=y_(G)}B=null}else B=null;F!==null&&bG(C,I,F,B,!1),$!==null&&q!==null&&bG(C,q,$,B,!0)}}e:{if(I=b?n0(b):window,F=I.nodeName&&I.nodeName.toLowerCase(),F==="select"||F==="input"&&I.type==="file")var oe=Rpe;else if(fG(I))if(IK)oe=zpe;else{oe=Lpe;var de=Dpe}else(F=I.nodeName)&&F.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(oe=Npe);if(oe&&(oe=oe(e,b))){PK(C,oe,r,E);break e}de&&de(e,I,b),e==="focusout"&&(de=I._wrapperState)&&de.controlled&&I.type==="number"&&ez(I,"number",I.value)}switch(de=b?n0(b):window,e){case"focusin":(fG(de)||de.contentEditable==="true")&&(t0=de,hz=b,IS=null);break;case"focusout":IS=hz=t0=null;break;case"mousedown":fz=!0;break;case"contextmenu":case"mouseup":case"dragend":fz=!1,vG(C,r,E);break;case"selectionchange":if(Bpe)break;case"keydown":case"keyup":vG(C,r,E)}var ae;if(wB)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else e0?CK(e,r)&&(ve="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ve="onCompositionStart");ve&&(AK&&r.locale!=="ko"&&(e0||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&e0&&(ae=EK()):(Zp=E,_B="value"in Zp?Zp.value:Zp.textContent,e0=!0)),de=KP(b,ve),0<de.length&&(ve=new cG(ve,e,null,r,E),C.push({event:ve,listeners:de}),ae?ve.data=ae:(ae=MK(r),ae!==null&&(ve.data=ae)))),(ae=Mpe?Ppe(e,r):Ipe(e,r))&&(b=KP(b,"onBeforeInput"),0<b.length&&(E=new cG("onBeforeInput","beforeinput",null,r,E),C.push({event:E,listeners:b}),E.data=ae))}BK(C,t)})}function oT(e,t,r){return{instance:e,listener:t,currentTarget:r}}function KP(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=JS(e,r),l!=null&&n.unshift(oT(e,l,a)),l=JS(e,t),l!=null&&n.push(oT(e,l,a))),e=e.return}return n}function y_(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bG(e,t,r,n,a){for(var l=t._reactName,h=[];r!==null&&r!==n;){var i=r,_=i.alternate,b=i.stateNode;if(_!==null&&_===n)break;i.tag===5&&b!==null&&(i=b,a?(_=JS(r,l),_!=null&&h.unshift(oT(r,_,i))):a||(_=JS(r,l),_!=null&&h.push(oT(r,_,i)))),r=r.return}h.length!==0&&e.push({event:t,listeners:h})}var Wpe=/\r\n?/g,Gpe=/\u0000|\uFFFD/g;function wG(e){return(typeof e=="string"?e:""+e).replace(Wpe,`
`).replace(Gpe,"")}function oC(e,t,r){if(t=wG(t),wG(e)!==t&&r)throw Error(pr(425))}function JP(){}var pz=null,mz=null;function gz(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var yz=typeof setTimeout=="function"?setTimeout:void 0,qpe=typeof clearTimeout=="function"?clearTimeout:void 0,SG=typeof Promise=="function"?Promise:void 0,Hpe=typeof queueMicrotask=="function"?queueMicrotask:typeof SG<"u"?function(e){return SG.resolve(null).then(e).catch(Zpe)}:yz;function Zpe(e){setTimeout(function(){throw e})}function g3(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),tT(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);tT(t)}function nm(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function TG(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ux=Math.random().toString(36).slice(2),Ed="__reactFiber$"+Ux,aT="__reactProps$"+Ux,Hh="__reactContainer$"+Ux,vz="__reactEvents$"+Ux,Xpe="__reactListeners$"+Ux,Ype="__reactHandles$"+Ux;function Jg(e){var t=e[Ed];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Hh]||r[Ed]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=TG(e);e!==null;){if(r=e[Ed])return r;e=TG(e)}return t}e=r,r=e.parentNode}return null}function AE(e){return e=e[Ed]||e[Hh],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function n0(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pr(33))}function ak(e){return e[aT]||null}var _z=[],i0=-1;function Mm(e){return{current:e}}function mo(e){0>i0||(e.current=_z[i0],_z[i0]=null,i0--)}function no(e,t){i0++,_z[i0]=e.current,e.current=t}var gm={},ps=Mm(gm),wl=Mm(!1),Ay=gm;function Z0(e,t){var r=e.type.contextTypes;if(!r)return gm;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in r)a[l]=t[l];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Sl(e){return e=e.childContextTypes,e!=null}function QP(){mo(wl),mo(ps)}function EG(e,t,r){if(ps.current!==gm)throw Error(pr(168));no(ps,t),no(wl,r)}function UK(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(pr(108,Dfe(e)||"Unknown",a));return Ro({},r,n)}function eI(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||gm,Ay=ps.current,no(ps,e),no(wl,wl.current),!0}function AG(e,t,r){var n=e.stateNode;if(!n)throw Error(pr(169));r?(e=UK(e,t,Ay),n.__reactInternalMemoizedMergedChildContext=e,mo(wl),mo(ps),no(ps,e)):mo(wl),no(wl,r)}var Ch=null,sk=!1,y3=!1;function VK(e){Ch===null?Ch=[e]:Ch.push(e)}function Kpe(e){sk=!0,VK(e)}function Pm(){if(!y3&&Ch!==null){y3=!0;var e=0,t=Ni;try{var r=Ch;for(Ni=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ch=null,sk=!1}catch(a){throw Ch!==null&&(Ch=Ch.slice(e+1)),pK(mB,Pm),a}finally{Ni=t,y3=!1}}return null}var o0=[],a0=0,tI=null,rI=0,Ec=[],Ac=0,Cy=null,Ih=1,Oh="";function jg(e,t){o0[a0++]=rI,o0[a0++]=tI,tI=e,rI=t}function WK(e,t,r){Ec[Ac++]=Ih,Ec[Ac++]=Oh,Ec[Ac++]=Cy,Cy=e;var n=Ih;e=Oh;var a=32-Iu(n)-1;n&=~(1<<a),r+=1;var l=32-Iu(t)+a;if(30<l){var h=a-a%5;l=(n&(1<<h)-1).toString(32),n>>=h,a-=h,Ih=1<<32-Iu(t)+a|r<<a|n,Oh=l+e}else Ih=1<<l|r<<a|n,Oh=e}function TB(e){e.return!==null&&(jg(e,1),WK(e,1,0))}function EB(e){for(;e===tI;)tI=o0[--a0],o0[a0]=null,rI=o0[--a0],o0[a0]=null;for(;e===Cy;)Cy=Ec[--Ac],Ec[Ac]=null,Oh=Ec[--Ac],Ec[Ac]=null,Ih=Ec[--Ac],Ec[Ac]=null}var Jl=null,Yl=null,xo=!1,Su=null;function GK(e,t){var r=Pc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function CG(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Jl=e,Yl=nm(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Jl=e,Yl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Cy!==null?{id:Ih,overflow:Oh}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Pc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Jl=e,Yl=null,!0):!1;default:return!1}}function xz(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bz(e){if(xo){var t=Yl;if(t){var r=t;if(!CG(e,t)){if(xz(e))throw Error(pr(418));t=nm(r.nextSibling);var n=Jl;t&&CG(e,t)?GK(n,r):(e.flags=e.flags&-4097|2,xo=!1,Jl=e)}}else{if(xz(e))throw Error(pr(418));e.flags=e.flags&-4097|2,xo=!1,Jl=e}}}function MG(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jl=e}function aC(e){if(e!==Jl)return!1;if(!xo)return MG(e),xo=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!gz(e.type,e.memoizedProps)),t&&(t=Yl)){if(xz(e))throw qK(),Error(pr(418));for(;t;)GK(e,t),t=nm(t.nextSibling)}if(MG(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Yl=nm(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Yl=null}}else Yl=Jl?nm(e.stateNode.nextSibling):null;return!0}function qK(){for(var e=Yl;e;)e=nm(e.nextSibling)}function X0(){Yl=Jl=null,xo=!1}function AB(e){Su===null?Su=[e]:Su.push(e)}var Jpe=sf.ReactCurrentBatchConfig;function _w(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pr(309));var n=r.stateNode}if(!n)throw Error(pr(147,e));var a=n,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(h){var i=a.refs;h===null?delete i[l]:i[l]=h},t._stringRef=l,t)}if(typeof e!="string")throw Error(pr(284));if(!r._owner)throw Error(pr(290,e))}return e}function sC(e,t){throw e=Object.prototype.toString.call(t),Error(pr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function PG(e){var t=e._init;return t(e._payload)}function HK(e){function t(G,H){if(e){var J=G.deletions;J===null?(G.deletions=[H],G.flags|=16):J.push(H)}}function r(G,H){if(!e)return null;for(;H!==null;)t(G,H),H=H.sibling;return null}function n(G,H){for(G=new Map;H!==null;)H.key!==null?G.set(H.key,H):G.set(H.index,H),H=H.sibling;return G}function a(G,H){return G=sm(G,H),G.index=0,G.sibling=null,G}function l(G,H,J){return G.index=J,e?(J=G.alternate,J!==null?(J=J.index,J<H?(G.flags|=2,H):J):(G.flags|=2,H)):(G.flags|=1048576,H)}function h(G){return e&&G.alternate===null&&(G.flags|=2),G}function i(G,H,J,Q){return H===null||H.tag!==6?(H=T3(J,G.mode,Q),H.return=G,H):(H=a(H,J),H.return=G,H)}function _(G,H,J,Q){var oe=J.type;return oe===Q_?E(G,H,J.props.children,Q,J.key):H!==null&&(H.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===Mp&&PG(oe)===H.type)?(Q=a(H,J.props),Q.ref=_w(G,H,J),Q.return=G,Q):(Q=aM(J.type,J.key,J.props,null,G.mode,Q),Q.ref=_w(G,H,J),Q.return=G,Q)}function b(G,H,J,Q){return H===null||H.tag!==4||H.stateNode.containerInfo!==J.containerInfo||H.stateNode.implementation!==J.implementation?(H=E3(J,G.mode,Q),H.return=G,H):(H=a(H,J.children||[]),H.return=G,H)}function E(G,H,J,Q,oe){return H===null||H.tag!==7?(H=yy(J,G.mode,Q,oe),H.return=G,H):(H=a(H,J),H.return=G,H)}function C(G,H,J){if(typeof H=="string"&&H!==""||typeof H=="number")return H=T3(""+H,G.mode,J),H.return=G,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case YA:return J=aM(H.type,H.key,H.props,null,G.mode,J),J.ref=_w(G,null,H),J.return=G,J;case J_:return H=E3(H,G.mode,J),H.return=G,H;case Mp:var Q=H._init;return C(G,Q(H._payload),J)}if(Gw(H)||pw(H))return H=yy(H,G.mode,J,null),H.return=G,H;sC(G,H)}return null}function I(G,H,J,Q){var oe=H!==null?H.key:null;if(typeof J=="string"&&J!==""||typeof J=="number")return oe!==null?null:i(G,H,""+J,Q);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case YA:return J.key===oe?_(G,H,J,Q):null;case J_:return J.key===oe?b(G,H,J,Q):null;case Mp:return oe=J._init,I(G,H,oe(J._payload),Q)}if(Gw(J)||pw(J))return oe!==null?null:E(G,H,J,Q,null);sC(G,J)}return null}function F(G,H,J,Q,oe){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return G=G.get(J)||null,i(H,G,""+Q,oe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case YA:return G=G.get(Q.key===null?J:Q.key)||null,_(H,G,Q,oe);case J_:return G=G.get(Q.key===null?J:Q.key)||null,b(H,G,Q,oe);case Mp:var de=Q._init;return F(G,H,J,de(Q._payload),oe)}if(Gw(Q)||pw(Q))return G=G.get(J)||null,E(H,G,Q,oe,null);sC(H,Q)}return null}function $(G,H,J,Q){for(var oe=null,de=null,ae=H,ve=H=0,Fe=null;ae!==null&&ve<J.length;ve++){ae.index>ve?(Fe=ae,ae=null):Fe=ae.sibling;var ke=I(G,ae,J[ve],Q);if(ke===null){ae===null&&(ae=Fe);break}e&&ae&&ke.alternate===null&&t(G,ae),H=l(ke,H,ve),de===null?oe=ke:de.sibling=ke,de=ke,ae=Fe}if(ve===J.length)return r(G,ae),xo&&jg(G,ve),oe;if(ae===null){for(;ve<J.length;ve++)ae=C(G,J[ve],Q),ae!==null&&(H=l(ae,H,ve),de===null?oe=ae:de.sibling=ae,de=ae);return xo&&jg(G,ve),oe}for(ae=n(G,ae);ve<J.length;ve++)Fe=F(ae,G,ve,J[ve],Q),Fe!==null&&(e&&Fe.alternate!==null&&ae.delete(Fe.key===null?ve:Fe.key),H=l(Fe,H,ve),de===null?oe=Fe:de.sibling=Fe,de=Fe);return e&&ae.forEach(function(Ce){return t(G,Ce)}),xo&&jg(G,ve),oe}function B(G,H,J,Q){var oe=pw(J);if(typeof oe!="function")throw Error(pr(150));if(J=oe.call(J),J==null)throw Error(pr(151));for(var de=oe=null,ae=H,ve=H=0,Fe=null,ke=J.next();ae!==null&&!ke.done;ve++,ke=J.next()){ae.index>ve?(Fe=ae,ae=null):Fe=ae.sibling;var Ce=I(G,ae,ke.value,Q);if(Ce===null){ae===null&&(ae=Fe);break}e&&ae&&Ce.alternate===null&&t(G,ae),H=l(Ce,H,ve),de===null?oe=Ce:de.sibling=Ce,de=Ce,ae=Fe}if(ke.done)return r(G,ae),xo&&jg(G,ve),oe;if(ae===null){for(;!ke.done;ve++,ke=J.next())ke=C(G,ke.value,Q),ke!==null&&(H=l(ke,H,ve),de===null?oe=ke:de.sibling=ke,de=ke);return xo&&jg(G,ve),oe}for(ae=n(G,ae);!ke.done;ve++,ke=J.next())ke=F(ae,G,ve,ke.value,Q),ke!==null&&(e&&ke.alternate!==null&&ae.delete(ke.key===null?ve:ke.key),H=l(ke,H,ve),de===null?oe=ke:de.sibling=ke,de=ke);return e&&ae.forEach(function(je){return t(G,je)}),xo&&jg(G,ve),oe}function q(G,H,J,Q){if(typeof J=="object"&&J!==null&&J.type===Q_&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case YA:e:{for(var oe=J.key,de=H;de!==null;){if(de.key===oe){if(oe=J.type,oe===Q_){if(de.tag===7){r(G,de.sibling),H=a(de,J.props.children),H.return=G,G=H;break e}}else if(de.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===Mp&&PG(oe)===de.type){r(G,de.sibling),H=a(de,J.props),H.ref=_w(G,de,J),H.return=G,G=H;break e}r(G,de);break}else t(G,de);de=de.sibling}J.type===Q_?(H=yy(J.props.children,G.mode,Q,J.key),H.return=G,G=H):(Q=aM(J.type,J.key,J.props,null,G.mode,Q),Q.ref=_w(G,H,J),Q.return=G,G=Q)}return h(G);case J_:e:{for(de=J.key;H!==null;){if(H.key===de)if(H.tag===4&&H.stateNode.containerInfo===J.containerInfo&&H.stateNode.implementation===J.implementation){r(G,H.sibling),H=a(H,J.children||[]),H.return=G,G=H;break e}else{r(G,H);break}else t(G,H);H=H.sibling}H=E3(J,G.mode,Q),H.return=G,G=H}return h(G);case Mp:return de=J._init,q(G,H,de(J._payload),Q)}if(Gw(J))return $(G,H,J,Q);if(pw(J))return B(G,H,J,Q);sC(G,J)}return typeof J=="string"&&J!==""||typeof J=="number"?(J=""+J,H!==null&&H.tag===6?(r(G,H.sibling),H=a(H,J),H.return=G,G=H):(r(G,H),H=T3(J,G.mode,Q),H.return=G,G=H),h(G)):r(G,H)}return q}var Y0=HK(!0),ZK=HK(!1),nI=Mm(null),iI=null,s0=null,CB=null;function MB(){CB=s0=iI=null}function PB(e){var t=nI.current;mo(nI),e._currentValue=t}function wz(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function x0(e,t){iI=e,CB=s0=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(vl=!0),e.firstContext=null)}function Lc(e){var t=e._currentValue;if(CB!==e)if(e={context:e,memoizedValue:t,next:null},s0===null){if(iI===null)throw Error(pr(308));s0=e,iI.dependencies={lanes:0,firstContext:e}}else s0=s0.next=e;return t}var Qg=null;function IB(e){Qg===null?Qg=[e]:Qg.push(e)}function XK(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,IB(t)):(r.next=a.next,a.next=r),t.interleaved=r,Zh(e,n)}function Zh(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Pp=!1;function OB(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YK(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zh(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function im(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,_i&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Zh(e,r)}return a=n.interleaved,a===null?(t.next=t,IB(n)):(t.next=a.next,a.next=t),n.interleaved=t,Zh(e,r)}function eM(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,gB(e,r)}}function IG(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var h={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?a=l=h:l=l.next=h,r=r.next}while(r!==null);l===null?a=l=t:l=l.next=t}else a=l=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function oI(e,t,r,n){var a=e.updateQueue;Pp=!1;var l=a.firstBaseUpdate,h=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var _=i,b=_.next;_.next=null,h===null?l=b:h.next=b,h=_;var E=e.alternate;E!==null&&(E=E.updateQueue,i=E.lastBaseUpdate,i!==h&&(i===null?E.firstBaseUpdate=b:i.next=b,E.lastBaseUpdate=_))}if(l!==null){var C=a.baseState;h=0,E=b=_=null,i=l;do{var I=i.lane,F=i.eventTime;if((n&I)===I){E!==null&&(E=E.next={eventTime:F,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var $=e,B=i;switch(I=t,F=r,B.tag){case 1:if($=B.payload,typeof $=="function"){C=$.call(F,C,I);break e}C=$;break e;case 3:$.flags=$.flags&-65537|128;case 0:if($=B.payload,I=typeof $=="function"?$.call(F,C,I):$,I==null)break e;C=Ro({},C,I);break e;case 2:Pp=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,I=a.effects,I===null?a.effects=[i]:I.push(i))}else F={eventTime:F,lane:I,tag:i.tag,payload:i.payload,callback:i.callback,next:null},E===null?(b=E=F,_=C):E=E.next=F,h|=I;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;I=i,i=I.next,I.next=null,a.lastBaseUpdate=I,a.shared.pending=null}}while(!0);if(E===null&&(_=C),a.baseState=_,a.firstBaseUpdate=b,a.lastBaseUpdate=E,t=a.shared.interleaved,t!==null){a=t;do h|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);Py|=h,e.lanes=h,e.memoizedState=C}}function OG(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(pr(191,a));a.call(n)}}}var CE={},Nd=Mm(CE),sT=Mm(CE),lT=Mm(CE);function ey(e){if(e===CE)throw Error(pr(174));return e}function kB(e,t){switch(no(lT,t),no(sT,e),no(Nd,CE),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rz(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rz(t,e)}mo(Nd),no(Nd,t)}function K0(){mo(Nd),mo(sT),mo(lT)}function KK(e){ey(lT.current);var t=ey(Nd.current),r=rz(t,e.type);t!==r&&(no(sT,e),no(Nd,r))}function RB(e){sT.current===e&&(mo(Nd),mo(sT))}var Po=Mm(0);function aI(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var v3=[];function DB(){for(var e=0;e<v3.length;e++)v3[e]._workInProgressVersionPrimary=null;v3.length=0}var tM=sf.ReactCurrentDispatcher,_3=sf.ReactCurrentBatchConfig,My=0,Oo=null,Sa=null,La=null,sI=!1,OS=!1,cT=0,Qpe=0;function is(){throw Error(pr(321))}function LB(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Nu(e[r],t[r]))return!1;return!0}function NB(e,t,r,n,a,l){if(My=l,Oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tM.current=e===null||e.memoizedState===null?nme:ime,e=r(n,a),OS){l=0;do{if(OS=!1,cT=0,25<=l)throw Error(pr(301));l+=1,La=Sa=null,t.updateQueue=null,tM.current=ome,e=r(n,a)}while(OS)}if(tM.current=lI,t=Sa!==null&&Sa.next!==null,My=0,La=Sa=Oo=null,sI=!1,t)throw Error(pr(300));return e}function zB(){var e=cT!==0;return cT=0,e}function xd(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return La===null?Oo.memoizedState=La=e:La=La.next=e,La}function Nc(){if(Sa===null){var e=Oo.alternate;e=e!==null?e.memoizedState:null}else e=Sa.next;var t=La===null?Oo.memoizedState:La.next;if(t!==null)La=t,Sa=e;else{if(e===null)throw Error(pr(310));Sa=e,e={memoizedState:Sa.memoizedState,baseState:Sa.baseState,baseQueue:Sa.baseQueue,queue:Sa.queue,next:null},La===null?Oo.memoizedState=La=e:La=La.next=e}return La}function uT(e,t){return typeof t=="function"?t(e):t}function x3(e){var t=Nc(),r=t.queue;if(r===null)throw Error(pr(311));r.lastRenderedReducer=e;var n=Sa,a=n.baseQueue,l=r.pending;if(l!==null){if(a!==null){var h=a.next;a.next=l.next,l.next=h}n.baseQueue=a=l,r.pending=null}if(a!==null){l=a.next,n=n.baseState;var i=h=null,_=null,b=l;do{var E=b.lane;if((My&E)===E)_!==null&&(_=_.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),n=b.hasEagerState?b.eagerState:e(n,b.action);else{var C={lane:E,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};_===null?(i=_=C,h=n):_=_.next=C,Oo.lanes|=E,Py|=E}b=b.next}while(b!==null&&b!==l);_===null?h=n:_.next=i,Nu(n,t.memoizedState)||(vl=!0),t.memoizedState=n,t.baseState=h,t.baseQueue=_,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do l=a.lane,Oo.lanes|=l,Py|=l,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function b3(e){var t=Nc(),r=t.queue;if(r===null)throw Error(pr(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,l=t.memoizedState;if(a!==null){r.pending=null;var h=a=a.next;do l=e(l,h.action),h=h.next;while(h!==a);Nu(l,t.memoizedState)||(vl=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),r.lastRenderedState=l}return[l,n]}function JK(){}function QK(e,t){var r=Oo,n=Nc(),a=t(),l=!Nu(n.memoizedState,a);if(l&&(n.memoizedState=a,vl=!0),n=n.queue,jB(rJ.bind(null,r,n,e),[e]),n.getSnapshot!==t||l||La!==null&&La.memoizedState.tag&1){if(r.flags|=2048,dT(9,tJ.bind(null,r,n,a,t),void 0,null),za===null)throw Error(pr(349));My&30||eJ(r,t,a)}return a}function eJ(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Oo.updateQueue,t===null?(t={lastEffect:null,stores:null},Oo.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function tJ(e,t,r,n){t.value=r,t.getSnapshot=n,nJ(t)&&iJ(e)}function rJ(e,t,r){return r(function(){nJ(t)&&iJ(e)})}function nJ(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Nu(e,r)}catch{return!0}}function iJ(e){var t=Zh(e,1);t!==null&&Ou(t,e,1,-1)}function kG(e){var t=xd();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uT,lastRenderedState:e},t.queue=e,e=e.dispatch=rme.bind(null,Oo,e),[t.memoizedState,e]}function dT(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Oo.updateQueue,t===null?(t={lastEffect:null,stores:null},Oo.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function oJ(){return Nc().memoizedState}function rM(e,t,r,n){var a=xd();Oo.flags|=e,a.memoizedState=dT(1|t,r,void 0,n===void 0?null:n)}function lk(e,t,r,n){var a=Nc();n=n===void 0?null:n;var l=void 0;if(Sa!==null){var h=Sa.memoizedState;if(l=h.destroy,n!==null&&LB(n,h.deps)){a.memoizedState=dT(t,r,l,n);return}}Oo.flags|=e,a.memoizedState=dT(1|t,r,l,n)}function RG(e,t){return rM(8390656,8,e,t)}function jB(e,t){return lk(2048,8,e,t)}function aJ(e,t){return lk(4,2,e,t)}function sJ(e,t){return lk(4,4,e,t)}function lJ(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cJ(e,t,r){return r=r!=null?r.concat([e]):null,lk(4,4,lJ.bind(null,t,e),r)}function FB(){}function uJ(e,t){var r=Nc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&LB(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function dJ(e,t){var r=Nc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&LB(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function hJ(e,t,r){return My&21?(Nu(r,t)||(r=yK(),Oo.lanes|=r,Py|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,vl=!0),e.memoizedState=r)}function eme(e,t){var r=Ni;Ni=r!==0&&4>r?r:4,e(!0);var n=_3.transition;_3.transition={};try{e(!1),t()}finally{Ni=r,_3.transition=n}}function fJ(){return Nc().memoizedState}function tme(e,t,r){var n=am(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},pJ(e))mJ(t,r);else if(r=XK(e,t,r,n),r!==null){var a=Bs();Ou(r,e,n,a),gJ(r,t,n)}}function rme(e,t,r){var n=am(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(pJ(e))mJ(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var h=t.lastRenderedState,i=l(h,r);if(a.hasEagerState=!0,a.eagerState=i,Nu(i,h)){var _=t.interleaved;_===null?(a.next=a,IB(t)):(a.next=_.next,_.next=a),t.interleaved=a;return}}catch{}finally{}r=XK(e,t,a,n),r!==null&&(a=Bs(),Ou(r,e,n,a),gJ(r,t,n))}}function pJ(e){var t=e.alternate;return e===Oo||t!==null&&t===Oo}function mJ(e,t){OS=sI=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function gJ(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,gB(e,r)}}var lI={readContext:Lc,useCallback:is,useContext:is,useEffect:is,useImperativeHandle:is,useInsertionEffect:is,useLayoutEffect:is,useMemo:is,useReducer:is,useRef:is,useState:is,useDebugValue:is,useDeferredValue:is,useTransition:is,useMutableSource:is,useSyncExternalStore:is,useId:is,unstable_isNewReconciler:!1},nme={readContext:Lc,useCallback:function(e,t){return xd().memoizedState=[e,t===void 0?null:t],e},useContext:Lc,useEffect:RG,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,rM(4194308,4,lJ.bind(null,t,e),r)},useLayoutEffect:function(e,t){return rM(4194308,4,e,t)},useInsertionEffect:function(e,t){return rM(4,2,e,t)},useMemo:function(e,t){var r=xd();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xd();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tme.bind(null,Oo,e),[n.memoizedState,e]},useRef:function(e){var t=xd();return e={current:e},t.memoizedState=e},useState:kG,useDebugValue:FB,useDeferredValue:function(e){return xd().memoizedState=e},useTransition:function(){var e=kG(!1),t=e[0];return e=eme.bind(null,e[1]),xd().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Oo,a=xd();if(xo){if(r===void 0)throw Error(pr(407));r=r()}else{if(r=t(),za===null)throw Error(pr(349));My&30||eJ(n,t,r)}a.memoizedState=r;var l={value:r,getSnapshot:t};return a.queue=l,RG(rJ.bind(null,n,l,e),[e]),n.flags|=2048,dT(9,tJ.bind(null,n,l,r,t),void 0,null),r},useId:function(){var e=xd(),t=za.identifierPrefix;if(xo){var r=Oh,n=Ih;r=(n&~(1<<32-Iu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=cT++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Qpe++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ime={readContext:Lc,useCallback:uJ,useContext:Lc,useEffect:jB,useImperativeHandle:cJ,useInsertionEffect:aJ,useLayoutEffect:sJ,useMemo:dJ,useReducer:x3,useRef:oJ,useState:function(){return x3(uT)},useDebugValue:FB,useDeferredValue:function(e){var t=Nc();return hJ(t,Sa.memoizedState,e)},useTransition:function(){var e=x3(uT)[0],t=Nc().memoizedState;return[e,t]},useMutableSource:JK,useSyncExternalStore:QK,useId:fJ,unstable_isNewReconciler:!1},ome={readContext:Lc,useCallback:uJ,useContext:Lc,useEffect:jB,useImperativeHandle:cJ,useInsertionEffect:aJ,useLayoutEffect:sJ,useMemo:dJ,useReducer:b3,useRef:oJ,useState:function(){return b3(uT)},useDebugValue:FB,useDeferredValue:function(e){var t=Nc();return Sa===null?t.memoizedState=e:hJ(t,Sa.memoizedState,e)},useTransition:function(){var e=b3(uT)[0],t=Nc().memoizedState;return[e,t]},useMutableSource:JK,useSyncExternalStore:QK,useId:fJ,unstable_isNewReconciler:!1};function gu(e,t){if(e&&e.defaultProps){t=Ro({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Sz(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ro({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ck={isMounted:function(e){return(e=e._reactInternals)?Hy(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Bs(),a=am(e),l=zh(n,a);l.payload=t,r!=null&&(l.callback=r),t=im(e,l,a),t!==null&&(Ou(t,e,a,n),eM(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Bs(),a=am(e),l=zh(n,a);l.tag=1,l.payload=t,r!=null&&(l.callback=r),t=im(e,l,a),t!==null&&(Ou(t,e,a,n),eM(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Bs(),n=am(e),a=zh(r,n);a.tag=2,t!=null&&(a.callback=t),t=im(e,a,n),t!==null&&(Ou(t,e,n,r),eM(t,e,n))}};function DG(e,t,r,n,a,l,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,l,h):t.prototype&&t.prototype.isPureReactComponent?!nT(r,n)||!nT(a,l):!0}function yJ(e,t,r){var n=!1,a=gm,l=t.contextType;return typeof l=="object"&&l!==null?l=Lc(l):(a=Sl(t)?Ay:ps.current,n=t.contextTypes,l=(n=n!=null)?Z0(e,a):gm),t=new t(r,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ck,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function LG(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ck.enqueueReplaceState(t,t.state,null)}function Tz(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},OB(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=Lc(l):(l=Sl(t)?Ay:ps.current,a.context=Z0(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Sz(e,t,l,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&ck.enqueueReplaceState(a,a.state,null),oI(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function J0(e,t){try{var r="",n=t;do r+=Rfe(n),n=n.return;while(n);var a=r}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function w3(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ez(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ame=typeof WeakMap=="function"?WeakMap:Map;function vJ(e,t,r){r=zh(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){uI||(uI=!0,Lz=n),Ez(e,t)},r}function _J(e,t,r){r=zh(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ez(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){Ez(e,t),typeof n!="function"&&(om===null?om=new Set([this]):om.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),r}function NG(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ame;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=xme.bind(null,e,t,r),t.then(e,e))}function zG(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function jG(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=zh(-1,1),t.tag=2,im(r,t,1))),r.lanes|=1),e)}var sme=sf.ReactCurrentOwner,vl=!1;function Ls(e,t,r,n){t.child=e===null?ZK(t,null,r,n):Y0(t,e.child,r,n)}function FG(e,t,r,n,a){r=r.render;var l=t.ref;return x0(t,a),n=NB(e,t,r,n,l,a),r=zB(),e!==null&&!vl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xh(e,t,a)):(xo&&r&&TB(t),t.flags|=1,Ls(e,t,n,a),t.child)}function BG(e,t,r,n,a){if(e===null){var l=r.type;return typeof l=="function"&&!HB(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=l,xJ(e,t,l,n,a)):(e=aM(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var h=l.memoizedProps;if(r=r.compare,r=r!==null?r:nT,r(h,n)&&e.ref===t.ref)return Xh(e,t,a)}return t.flags|=1,e=sm(l,n),e.ref=t.ref,e.return=t,t.child=e}function xJ(e,t,r,n,a){if(e!==null){var l=e.memoizedProps;if(nT(l,n)&&e.ref===t.ref)if(vl=!1,t.pendingProps=n=l,(e.lanes&a)!==0)e.flags&131072&&(vl=!0);else return t.lanes=e.lanes,Xh(e,t,a)}return Az(e,t,r,n,a)}function bJ(e,t,r){var n=t.pendingProps,a=n.children,l=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},no(c0,Vl),Vl|=r;else{if(!(r&1073741824))return e=l!==null?l.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,no(c0,Vl),Vl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=l!==null?l.baseLanes:r,no(c0,Vl),Vl|=n}else l!==null?(n=l.baseLanes|r,t.memoizedState=null):n=r,no(c0,Vl),Vl|=n;return Ls(e,t,a,r),t.child}function wJ(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Az(e,t,r,n,a){var l=Sl(r)?Ay:ps.current;return l=Z0(t,l),x0(t,a),r=NB(e,t,r,n,l,a),n=zB(),e!==null&&!vl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xh(e,t,a)):(xo&&n&&TB(t),t.flags|=1,Ls(e,t,r,a),t.child)}function $G(e,t,r,n,a){if(Sl(r)){var l=!0;eI(t)}else l=!1;if(x0(t,a),t.stateNode===null)nM(e,t),yJ(t,r,n),Tz(t,r,n,a),n=!0;else if(e===null){var h=t.stateNode,i=t.memoizedProps;h.props=i;var _=h.context,b=r.contextType;typeof b=="object"&&b!==null?b=Lc(b):(b=Sl(r)?Ay:ps.current,b=Z0(t,b));var E=r.getDerivedStateFromProps,C=typeof E=="function"||typeof h.getSnapshotBeforeUpdate=="function";C||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(i!==n||_!==b)&&LG(t,h,n,b),Pp=!1;var I=t.memoizedState;h.state=I,oI(t,n,h,a),_=t.memoizedState,i!==n||I!==_||wl.current||Pp?(typeof E=="function"&&(Sz(t,r,E,n),_=t.memoizedState),(i=Pp||DG(t,r,i,n,I,_,b))?(C||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=_),h.props=n,h.state=_,h.context=b,n=i):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{h=t.stateNode,YK(e,t),i=t.memoizedProps,b=t.type===t.elementType?i:gu(t.type,i),h.props=b,C=t.pendingProps,I=h.context,_=r.contextType,typeof _=="object"&&_!==null?_=Lc(_):(_=Sl(r)?Ay:ps.current,_=Z0(t,_));var F=r.getDerivedStateFromProps;(E=typeof F=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(i!==C||I!==_)&&LG(t,h,n,_),Pp=!1,I=t.memoizedState,h.state=I,oI(t,n,h,a);var $=t.memoizedState;i!==C||I!==$||wl.current||Pp?(typeof F=="function"&&(Sz(t,r,F,n),$=t.memoizedState),(b=Pp||DG(t,r,b,n,I,$,_)||!1)?(E||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(n,$,_),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(n,$,_)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||i===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=$),h.props=n,h.state=$,h.context=_,n=b):(typeof h.componentDidUpdate!="function"||i===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),n=!1)}return Cz(e,t,r,n,l,a)}function Cz(e,t,r,n,a,l){wJ(e,t);var h=(t.flags&128)!==0;if(!n&&!h)return a&&AG(t,r,!1),Xh(e,t,l);n=t.stateNode,sme.current=t;var i=h&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&h?(t.child=Y0(t,e.child,null,l),t.child=Y0(t,null,i,l)):Ls(e,t,i,l),t.memoizedState=n.state,a&&AG(t,r,!0),t.child}function SJ(e){var t=e.stateNode;t.pendingContext?EG(e,t.pendingContext,t.pendingContext!==t.context):t.context&&EG(e,t.context,!1),kB(e,t.containerInfo)}function UG(e,t,r,n,a){return X0(),AB(a),t.flags|=256,Ls(e,t,r,n),t.child}var Mz={dehydrated:null,treeContext:null,retryLane:0};function Pz(e){return{baseLanes:e,cachePool:null,transitions:null}}function TJ(e,t,r){var n=t.pendingProps,a=Po.current,l=!1,h=(t.flags&128)!==0,i;if((i=h)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),no(Po,a&1),e===null)return bz(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=n.children,e=n.fallback,l?(n=t.mode,l=t.child,h={mode:"hidden",children:h},!(n&1)&&l!==null?(l.childLanes=0,l.pendingProps=h):l=hk(h,n,0,null),e=yy(e,n,r,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Pz(r),t.memoizedState=Mz,e):BB(t,h));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return lme(e,t,h,n,i,a,r);if(l){l=n.fallback,h=t.mode,a=e.child,i=a.sibling;var _={mode:"hidden",children:n.children};return!(h&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=_,t.deletions=null):(n=sm(a,_),n.subtreeFlags=a.subtreeFlags&14680064),i!==null?l=sm(i,l):(l=yy(l,h,r,null),l.flags|=2),l.return=t,n.return=t,n.sibling=l,t.child=n,n=l,l=t.child,h=e.child.memoizedState,h=h===null?Pz(r):{baseLanes:h.baseLanes|r,cachePool:null,transitions:h.transitions},l.memoizedState=h,l.childLanes=e.childLanes&~r,t.memoizedState=Mz,n}return l=e.child,e=l.sibling,n=sm(l,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function BB(e,t){return t=hk({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function lC(e,t,r,n){return n!==null&&AB(n),Y0(t,e.child,null,r),e=BB(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lme(e,t,r,n,a,l,h){if(r)return t.flags&256?(t.flags&=-257,n=w3(Error(pr(422))),lC(e,t,h,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=n.fallback,a=t.mode,n=hk({mode:"visible",children:n.children},a,0,null),l=yy(l,a,h,null),l.flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,t.mode&1&&Y0(t,e.child,null,h),t.child.memoizedState=Pz(h),t.memoizedState=Mz,l);if(!(t.mode&1))return lC(e,t,h,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var i=n.dgst;return n=i,l=Error(pr(419)),n=w3(l,n,void 0),lC(e,t,h,n)}if(i=(h&e.childLanes)!==0,vl||i){if(n=za,n!==null){switch(h&-h){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|h)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Zh(e,a),Ou(n,e,a,-1))}return qB(),n=w3(Error(pr(421))),lC(e,t,h,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=bme.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,Yl=nm(a.nextSibling),Jl=t,xo=!0,Su=null,e!==null&&(Ec[Ac++]=Ih,Ec[Ac++]=Oh,Ec[Ac++]=Cy,Ih=e.id,Oh=e.overflow,Cy=t),t=BB(t,n.children),t.flags|=4096,t)}function VG(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),wz(e.return,t,r)}function S3(e,t,r,n,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=r,l.tailMode=a)}function EJ(e,t,r){var n=t.pendingProps,a=n.revealOrder,l=n.tail;if(Ls(e,t,n.children,r),n=Po.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&VG(e,r,t);else if(e.tag===19)VG(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(no(Po,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&aI(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),S3(t,!1,a,r,l);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&aI(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}S3(t,!0,r,null,l);break;case"together":S3(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nM(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xh(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Py|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pr(153));if(t.child!==null){for(e=t.child,r=sm(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=sm(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function cme(e,t,r){switch(t.tag){case 3:SJ(t),X0();break;case 5:KK(t);break;case 1:Sl(t.type)&&eI(t);break;case 4:kB(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;no(nI,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(no(Po,Po.current&1),t.flags|=128,null):r&t.child.childLanes?TJ(e,t,r):(no(Po,Po.current&1),e=Xh(e,t,r),e!==null?e.sibling:null);no(Po,Po.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return EJ(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),no(Po,Po.current),n)break;return null;case 22:case 23:return t.lanes=0,bJ(e,t,r)}return Xh(e,t,r)}var AJ,Iz,CJ,MJ;AJ=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Iz=function(){};CJ=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ey(Nd.current);var l=null;switch(r){case"input":a=JN(e,a),n=JN(e,n),l=[];break;case"select":a=Ro({},a,{value:void 0}),n=Ro({},n,{value:void 0}),l=[];break;case"textarea":a=tz(e,a),n=tz(e,n),l=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=JP)}nz(r,n);var h;r=null;for(b in a)if(!n.hasOwnProperty(b)&&a.hasOwnProperty(b)&&a[b]!=null)if(b==="style"){var i=a[b];for(h in i)i.hasOwnProperty(h)&&(r||(r={}),r[h]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(YS.hasOwnProperty(b)?l||(l=[]):(l=l||[]).push(b,null));for(b in n){var _=n[b];if(i=a!=null?a[b]:void 0,n.hasOwnProperty(b)&&_!==i&&(_!=null||i!=null))if(b==="style")if(i){for(h in i)!i.hasOwnProperty(h)||_&&_.hasOwnProperty(h)||(r||(r={}),r[h]="");for(h in _)_.hasOwnProperty(h)&&i[h]!==_[h]&&(r||(r={}),r[h]=_[h])}else r||(l||(l=[]),l.push(b,r)),r=_;else b==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,i=i?i.__html:void 0,_!=null&&i!==_&&(l=l||[]).push(b,_)):b==="children"?typeof _!="string"&&typeof _!="number"||(l=l||[]).push(b,""+_):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(YS.hasOwnProperty(b)?(_!=null&&b==="onScroll"&&ho("scroll",e),l||i===_||(l=[])):(l=l||[]).push(b,_))}r&&(l=l||[]).push("style",r);var b=l;(t.updateQueue=b)&&(t.flags|=4)}};MJ=function(e,t,r,n){r!==n&&(t.flags|=4)};function xw(e,t){if(!xo)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function os(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ume(e,t,r){var n=t.pendingProps;switch(EB(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return os(t),null;case 1:return Sl(t.type)&&QP(),os(t),null;case 3:return n=t.stateNode,K0(),mo(wl),mo(ps),DB(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(aC(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Su!==null&&(jz(Su),Su=null))),Iz(e,t),os(t),null;case 5:RB(t);var a=ey(lT.current);if(r=t.type,e!==null&&t.stateNode!=null)CJ(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pr(166));return os(t),null}if(e=ey(Nd.current),aC(t)){n=t.stateNode,r=t.type;var l=t.memoizedProps;switch(n[Ed]=t,n[aT]=l,e=(t.mode&1)!==0,r){case"dialog":ho("cancel",n),ho("close",n);break;case"iframe":case"object":case"embed":ho("load",n);break;case"video":case"audio":for(a=0;a<Hw.length;a++)ho(Hw[a],n);break;case"source":ho("error",n);break;case"img":case"image":case"link":ho("error",n),ho("load",n);break;case"details":ho("toggle",n);break;case"input":JW(n,l),ho("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},ho("invalid",n);break;case"textarea":eG(n,l),ho("invalid",n)}nz(r,l),a=null;for(var h in l)if(l.hasOwnProperty(h)){var i=l[h];h==="children"?typeof i=="string"?n.textContent!==i&&(l.suppressHydrationWarning!==!0&&oC(n.textContent,i,e),a=["children",i]):typeof i=="number"&&n.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&oC(n.textContent,i,e),a=["children",""+i]):YS.hasOwnProperty(h)&&i!=null&&h==="onScroll"&&ho("scroll",n)}switch(r){case"input":KA(n),QW(n,l,!0);break;case"textarea":KA(n),tG(n);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(n.onclick=JP)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{h=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rK(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=h.createElement(r,{is:n.is}):(e=h.createElement(r),r==="select"&&(h=e,n.multiple?h.multiple=!0:n.size&&(h.size=n.size))):e=h.createElementNS(e,r),e[Ed]=t,e[aT]=n,AJ(e,t,!1,!1),t.stateNode=e;e:{switch(h=iz(r,n),r){case"dialog":ho("cancel",e),ho("close",e),a=n;break;case"iframe":case"object":case"embed":ho("load",e),a=n;break;case"video":case"audio":for(a=0;a<Hw.length;a++)ho(Hw[a],e);a=n;break;case"source":ho("error",e),a=n;break;case"img":case"image":case"link":ho("error",e),ho("load",e),a=n;break;case"details":ho("toggle",e),a=n;break;case"input":JW(e,n),a=JN(e,n),ho("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ro({},n,{value:void 0}),ho("invalid",e);break;case"textarea":eG(e,n),a=tz(e,n),ho("invalid",e);break;default:a=n}nz(r,a),i=a;for(l in i)if(i.hasOwnProperty(l)){var _=i[l];l==="style"?oK(e,_):l==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&nK(e,_)):l==="children"?typeof _=="string"?(r!=="textarea"||_!=="")&&KS(e,_):typeof _=="number"&&KS(e,""+_):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(YS.hasOwnProperty(l)?_!=null&&l==="onScroll"&&ho("scroll",e):_!=null&&uB(e,l,_,h))}switch(r){case"input":KA(e),QW(e,n,!1);break;case"textarea":KA(e),tG(e);break;case"option":n.value!=null&&e.setAttribute("value",""+mm(n.value));break;case"select":e.multiple=!!n.multiple,l=n.value,l!=null?g0(e,!!n.multiple,l,!1):n.defaultValue!=null&&g0(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=JP)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return os(t),null;case 6:if(e&&t.stateNode!=null)MJ(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pr(166));if(r=ey(lT.current),ey(Nd.current),aC(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ed]=t,(l=n.nodeValue!==r)&&(e=Jl,e!==null))switch(e.tag){case 3:oC(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&oC(n.nodeValue,r,(e.mode&1)!==0)}l&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ed]=t,t.stateNode=n}return os(t),null;case 13:if(mo(Po),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(xo&&Yl!==null&&t.mode&1&&!(t.flags&128))qK(),X0(),t.flags|=98560,l=!1;else if(l=aC(t),n!==null&&n.dehydrated!==null){if(e===null){if(!l)throw Error(pr(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(pr(317));l[Ed]=t}else X0(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;os(t),l=!1}else Su!==null&&(jz(Su),Su=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Po.current&1?Ea===0&&(Ea=3):qB())),t.updateQueue!==null&&(t.flags|=4),os(t),null);case 4:return K0(),Iz(e,t),e===null&&iT(t.stateNode.containerInfo),os(t),null;case 10:return PB(t.type._context),os(t),null;case 17:return Sl(t.type)&&QP(),os(t),null;case 19:if(mo(Po),l=t.memoizedState,l===null)return os(t),null;if(n=(t.flags&128)!==0,h=l.rendering,h===null)if(n)xw(l,!1);else{if(Ea!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=aI(e),h!==null){for(t.flags|=128,xw(l,!1),n=h.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)l=r,e=n,l.flags&=14680066,h=l.alternate,h===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=h.childLanes,l.lanes=h.lanes,l.child=h.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=h.memoizedProps,l.memoizedState=h.memoizedState,l.updateQueue=h.updateQueue,l.type=h.type,e=h.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return no(Po,Po.current&1|2),t.child}e=e.sibling}l.tail!==null&&Yo()>Q0&&(t.flags|=128,n=!0,xw(l,!1),t.lanes=4194304)}else{if(!n)if(e=aI(h),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),xw(l,!0),l.tail===null&&l.tailMode==="hidden"&&!h.alternate&&!xo)return os(t),null}else 2*Yo()-l.renderingStartTime>Q0&&r!==1073741824&&(t.flags|=128,n=!0,xw(l,!1),t.lanes=4194304);l.isBackwards?(h.sibling=t.child,t.child=h):(r=l.last,r!==null?r.sibling=h:t.child=h,l.last=h)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Yo(),t.sibling=null,r=Po.current,no(Po,n?r&1|2:r&1),t):(os(t),null);case 22:case 23:return GB(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Vl&1073741824&&(os(t),t.subtreeFlags&6&&(t.flags|=8192)):os(t),null;case 24:return null;case 25:return null}throw Error(pr(156,t.tag))}function dme(e,t){switch(EB(t),t.tag){case 1:return Sl(t.type)&&QP(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return K0(),mo(wl),mo(ps),DB(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return RB(t),null;case 13:if(mo(Po),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pr(340));X0()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return mo(Po),null;case 4:return K0(),null;case 10:return PB(t.type._context),null;case 22:case 23:return GB(),null;case 24:return null;default:return null}}var cC=!1,us=!1,hme=typeof WeakSet=="function"?WeakSet:Set,Br=null;function l0(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bo(e,t,n)}else r.current=null}function Oz(e,t,r){try{r()}catch(n){Bo(e,t,n)}}var WG=!1;function fme(e,t){if(pz=XP,e=RK(),SB(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var h=0,i=-1,_=-1,b=0,E=0,C=e,I=null;t:for(;;){for(var F;C!==r||a!==0&&C.nodeType!==3||(i=h+a),C!==l||n!==0&&C.nodeType!==3||(_=h+n),C.nodeType===3&&(h+=C.nodeValue.length),(F=C.firstChild)!==null;)I=C,C=F;for(;;){if(C===e)break t;if(I===r&&++b===a&&(i=h),I===l&&++E===n&&(_=h),(F=C.nextSibling)!==null)break;C=I,I=C.parentNode}C=F}r=i===-1||_===-1?null:{start:i,end:_}}else r=null}r=r||{start:0,end:0}}else r=null;for(mz={focusedElem:e,selectionRange:r},XP=!1,Br=t;Br!==null;)if(t=Br,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Br=e;else for(;Br!==null;){t=Br;try{var $=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if($!==null){var B=$.memoizedProps,q=$.memoizedState,G=t.stateNode,H=G.getSnapshotBeforeUpdate(t.elementType===t.type?B:gu(t.type,B),q);G.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var J=t.stateNode.containerInfo;J.nodeType===1?J.textContent="":J.nodeType===9&&J.documentElement&&J.removeChild(J.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pr(163))}}catch(Q){Bo(t,t.return,Q)}if(e=t.sibling,e!==null){e.return=t.return,Br=e;break}Br=t.return}return $=WG,WG=!1,$}function kS(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&Oz(t,r,l)}a=a.next}while(a!==n)}}function uk(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function kz(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function PJ(e){var t=e.alternate;t!==null&&(e.alternate=null,PJ(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ed],delete t[aT],delete t[vz],delete t[Xpe],delete t[Ype])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function IJ(e){return e.tag===5||e.tag===3||e.tag===4}function GG(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||IJ(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Rz(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=JP));else if(n!==4&&(e=e.child,e!==null))for(Rz(e,t,r),e=e.sibling;e!==null;)Rz(e,t,r),e=e.sibling}function Dz(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Dz(e,t,r),e=e.sibling;e!==null;)Dz(e,t,r),e=e.sibling}var qa=null,vu=!1;function fp(e,t,r){for(r=r.child;r!==null;)OJ(e,t,r),r=r.sibling}function OJ(e,t,r){if(Ld&&typeof Ld.onCommitFiberUnmount=="function")try{Ld.onCommitFiberUnmount(rk,r)}catch{}switch(r.tag){case 5:us||l0(r,t);case 6:var n=qa,a=vu;qa=null,fp(e,t,r),qa=n,vu=a,qa!==null&&(vu?(e=qa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):qa.removeChild(r.stateNode));break;case 18:qa!==null&&(vu?(e=qa,r=r.stateNode,e.nodeType===8?g3(e.parentNode,r):e.nodeType===1&&g3(e,r),tT(e)):g3(qa,r.stateNode));break;case 4:n=qa,a=vu,qa=r.stateNode.containerInfo,vu=!0,fp(e,t,r),qa=n,vu=a;break;case 0:case 11:case 14:case 15:if(!us&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var l=a,h=l.destroy;l=l.tag,h!==void 0&&(l&2||l&4)&&Oz(r,t,h),a=a.next}while(a!==n)}fp(e,t,r);break;case 1:if(!us&&(l0(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(i){Bo(r,t,i)}fp(e,t,r);break;case 21:fp(e,t,r);break;case 22:r.mode&1?(us=(n=us)||r.memoizedState!==null,fp(e,t,r),us=n):fp(e,t,r);break;default:fp(e,t,r)}}function qG(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new hme),t.forEach(function(n){var a=wme.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function du(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var l=e,h=t,i=h;e:for(;i!==null;){switch(i.tag){case 5:qa=i.stateNode,vu=!1;break e;case 3:qa=i.stateNode.containerInfo,vu=!0;break e;case 4:qa=i.stateNode.containerInfo,vu=!0;break e}i=i.return}if(qa===null)throw Error(pr(160));OJ(l,h,a),qa=null,vu=!1;var _=a.alternate;_!==null&&(_.return=null),a.return=null}catch(b){Bo(a,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kJ(t,e),t=t.sibling}function kJ(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(du(t,e),dd(e),n&4){try{kS(3,e,e.return),uk(3,e)}catch(B){Bo(e,e.return,B)}try{kS(5,e,e.return)}catch(B){Bo(e,e.return,B)}}break;case 1:du(t,e),dd(e),n&512&&r!==null&&l0(r,r.return);break;case 5:if(du(t,e),dd(e),n&512&&r!==null&&l0(r,r.return),e.flags&32){var a=e.stateNode;try{KS(a,"")}catch(B){Bo(e,e.return,B)}}if(n&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,h=r!==null?r.memoizedProps:l,i=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&eK(a,l),iz(i,h);var b=iz(i,l);for(h=0;h<_.length;h+=2){var E=_[h],C=_[h+1];E==="style"?oK(a,C):E==="dangerouslySetInnerHTML"?nK(a,C):E==="children"?KS(a,C):uB(a,E,C,b)}switch(i){case"input":QN(a,l);break;case"textarea":tK(a,l);break;case"select":var I=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var F=l.value;F!=null?g0(a,!!l.multiple,F,!1):I!==!!l.multiple&&(l.defaultValue!=null?g0(a,!!l.multiple,l.defaultValue,!0):g0(a,!!l.multiple,l.multiple?[]:"",!1))}a[aT]=l}catch(B){Bo(e,e.return,B)}}break;case 6:if(du(t,e),dd(e),n&4){if(e.stateNode===null)throw Error(pr(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(B){Bo(e,e.return,B)}}break;case 3:if(du(t,e),dd(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{tT(t.containerInfo)}catch(B){Bo(e,e.return,B)}break;case 4:du(t,e),dd(e);break;case 13:du(t,e),dd(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(VB=Yo())),n&4&&qG(e);break;case 22:if(E=r!==null&&r.memoizedState!==null,e.mode&1?(us=(b=us)||E,du(t,e),us=b):du(t,e),dd(e),n&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!E&&e.mode&1)for(Br=e,E=e.child;E!==null;){for(C=Br=E;Br!==null;){switch(I=Br,F=I.child,I.tag){case 0:case 11:case 14:case 15:kS(4,I,I.return);break;case 1:l0(I,I.return);var $=I.stateNode;if(typeof $.componentWillUnmount=="function"){n=I,r=I.return;try{t=n,$.props=t.memoizedProps,$.state=t.memoizedState,$.componentWillUnmount()}catch(B){Bo(n,r,B)}}break;case 5:l0(I,I.return);break;case 22:if(I.memoizedState!==null){ZG(C);continue}}F!==null?(F.return=I,Br=F):ZG(C)}E=E.sibling}e:for(E=null,C=e;;){if(C.tag===5){if(E===null){E=C;try{a=C.stateNode,b?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=C.stateNode,_=C.memoizedProps.style,h=_!=null&&_.hasOwnProperty("display")?_.display:null,i.style.display=iK("display",h))}catch(B){Bo(e,e.return,B)}}}else if(C.tag===6){if(E===null)try{C.stateNode.nodeValue=b?"":C.memoizedProps}catch(B){Bo(e,e.return,B)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===e)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===e)break e;for(;C.sibling===null;){if(C.return===null||C.return===e)break e;E===C&&(E=null),C=C.return}E===C&&(E=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:du(t,e),dd(e),n&4&&qG(e);break;case 21:break;default:du(t,e),dd(e)}}function dd(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(IJ(r)){var n=r;break e}r=r.return}throw Error(pr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(KS(a,""),n.flags&=-33);var l=GG(e);Dz(e,l,a);break;case 3:case 4:var h=n.stateNode.containerInfo,i=GG(e);Rz(e,i,h);break;default:throw Error(pr(161))}}catch(_){Bo(e,e.return,_)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pme(e,t,r){Br=e,RJ(e)}function RJ(e,t,r){for(var n=(e.mode&1)!==0;Br!==null;){var a=Br,l=a.child;if(a.tag===22&&n){var h=a.memoizedState!==null||cC;if(!h){var i=a.alternate,_=i!==null&&i.memoizedState!==null||us;i=cC;var b=us;if(cC=h,(us=_)&&!b)for(Br=a;Br!==null;)h=Br,_=h.child,h.tag===22&&h.memoizedState!==null?XG(a):_!==null?(_.return=h,Br=_):XG(a);for(;l!==null;)Br=l,RJ(l),l=l.sibling;Br=a,cC=i,us=b}HG(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,Br=l):HG(e)}}function HG(e){for(;Br!==null;){var t=Br;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:us||uk(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!us)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:gu(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&OG(t,l,n);break;case 3:var h=t.updateQueue;if(h!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}OG(t,h,r)}break;case 5:var i=t.stateNode;if(r===null&&t.flags&4){r=i;var _=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&r.focus();break;case"img":_.src&&(r.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var E=b.memoizedState;if(E!==null){var C=E.dehydrated;C!==null&&tT(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pr(163))}us||t.flags&512&&kz(t)}catch(I){Bo(t,t.return,I)}}if(t===e){Br=null;break}if(r=t.sibling,r!==null){r.return=t.return,Br=r;break}Br=t.return}}function ZG(e){for(;Br!==null;){var t=Br;if(t===e){Br=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Br=r;break}Br=t.return}}function XG(e){for(;Br!==null;){var t=Br;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{uk(4,t)}catch(_){Bo(t,r,_)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(_){Bo(t,a,_)}}var l=t.return;try{kz(t)}catch(_){Bo(t,l,_)}break;case 5:var h=t.return;try{kz(t)}catch(_){Bo(t,h,_)}}}catch(_){Bo(t,t.return,_)}if(t===e){Br=null;break}var i=t.sibling;if(i!==null){i.return=t.return,Br=i;break}Br=t.return}}var mme=Math.ceil,cI=sf.ReactCurrentDispatcher,$B=sf.ReactCurrentOwner,kc=sf.ReactCurrentBatchConfig,_i=0,za=null,aa=null,Xa=0,Vl=0,c0=Mm(0),Ea=0,hT=null,Py=0,dk=0,UB=0,RS=null,gl=null,VB=0,Q0=1/0,Eh=null,uI=!1,Lz=null,om=null,uC=!1,Xp=null,dI=0,DS=0,Nz=null,iM=-1,oM=0;function Bs(){return _i&6?Yo():iM!==-1?iM:iM=Yo()}function am(e){return e.mode&1?_i&2&&Xa!==0?Xa&-Xa:Jpe.transition!==null?(oM===0&&(oM=yK()),oM):(e=Ni,e!==0||(e=window.event,e=e===void 0?16:TK(e.type)),e):1}function Ou(e,t,r,n){if(50<DS)throw DS=0,Nz=null,Error(pr(185));TE(e,r,n),(!(_i&2)||e!==za)&&(e===za&&(!(_i&2)&&(dk|=r),Ea===4&&Rp(e,Xa)),Tl(e,n),r===1&&_i===0&&!(t.mode&1)&&(Q0=Yo()+500,sk&&Pm()))}function Tl(e,t){var r=e.callbackNode;Jfe(e,t);var n=ZP(e,e===za?Xa:0);if(n===0)r!==null&&iG(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&iG(r),t===1)e.tag===0?Kpe(YG.bind(null,e)):VK(YG.bind(null,e)),Hpe(function(){!(_i&6)&&Pm()}),r=null;else{switch(vK(n)){case 1:r=mB;break;case 4:r=mK;break;case 16:r=HP;break;case 536870912:r=gK;break;default:r=HP}r=$J(r,DJ.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function DJ(e,t){if(iM=-1,oM=0,_i&6)throw Error(pr(327));var r=e.callbackNode;if(b0()&&e.callbackNode!==r)return null;var n=ZP(e,e===za?Xa:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=hI(e,n);else{t=n;var a=_i;_i|=2;var l=NJ();(za!==e||Xa!==t)&&(Eh=null,Q0=Yo()+500,gy(e,t));do try{vme();break}catch(i){LJ(e,i)}while(!0);MB(),cI.current=l,_i=a,aa!==null?t=0:(za=null,Xa=0,t=Ea)}if(t!==0){if(t===2&&(a=cz(e),a!==0&&(n=a,t=zz(e,a))),t===1)throw r=hT,gy(e,0),Rp(e,n),Tl(e,Yo()),r;if(t===6)Rp(e,n);else{if(a=e.current.alternate,!(n&30)&&!gme(a)&&(t=hI(e,n),t===2&&(l=cz(e),l!==0&&(n=l,t=zz(e,l))),t===1))throw r=hT,gy(e,0),Rp(e,n),Tl(e,Yo()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(pr(345));case 2:Fg(e,gl,Eh);break;case 3:if(Rp(e,n),(n&130023424)===n&&(t=VB+500-Yo(),10<t)){if(ZP(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Bs(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=yz(Fg.bind(null,e,gl,Eh),t);break}Fg(e,gl,Eh);break;case 4:if(Rp(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var h=31-Iu(n);l=1<<h,h=t[h],h>a&&(a=h),n&=~l}if(n=a,n=Yo()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mme(n/1960))-n,10<n){e.timeoutHandle=yz(Fg.bind(null,e,gl,Eh),n);break}Fg(e,gl,Eh);break;case 5:Fg(e,gl,Eh);break;default:throw Error(pr(329))}}}return Tl(e,Yo()),e.callbackNode===r?DJ.bind(null,e):null}function zz(e,t){var r=RS;return e.current.memoizedState.isDehydrated&&(gy(e,t).flags|=256),e=hI(e,t),e!==2&&(t=gl,gl=r,t!==null&&jz(t)),e}function jz(e){gl===null?gl=e:gl.push.apply(gl,e)}function gme(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],l=a.getSnapshot;a=a.value;try{if(!Nu(l(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rp(e,t){for(t&=~UB,t&=~dk,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Iu(t),n=1<<r;e[r]=-1,t&=~n}}function YG(e){if(_i&6)throw Error(pr(327));b0();var t=ZP(e,0);if(!(t&1))return Tl(e,Yo()),null;var r=hI(e,t);if(e.tag!==0&&r===2){var n=cz(e);n!==0&&(t=n,r=zz(e,n))}if(r===1)throw r=hT,gy(e,0),Rp(e,t),Tl(e,Yo()),r;if(r===6)throw Error(pr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fg(e,gl,Eh),Tl(e,Yo()),null}function WB(e,t){var r=_i;_i|=1;try{return e(t)}finally{_i=r,_i===0&&(Q0=Yo()+500,sk&&Pm())}}function Iy(e){Xp!==null&&Xp.tag===0&&!(_i&6)&&b0();var t=_i;_i|=1;var r=kc.transition,n=Ni;try{if(kc.transition=null,Ni=1,e)return e()}finally{Ni=n,kc.transition=r,_i=t,!(_i&6)&&Pm()}}function GB(){Vl=c0.current,mo(c0)}function gy(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,qpe(r)),aa!==null)for(r=aa.return;r!==null;){var n=r;switch(EB(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&QP();break;case 3:K0(),mo(wl),mo(ps),DB();break;case 5:RB(n);break;case 4:K0();break;case 13:mo(Po);break;case 19:mo(Po);break;case 10:PB(n.type._context);break;case 22:case 23:GB()}r=r.return}if(za=e,aa=e=sm(e.current,null),Xa=Vl=t,Ea=0,hT=null,UB=dk=Py=0,gl=RS=null,Qg!==null){for(t=0;t<Qg.length;t++)if(r=Qg[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,l=r.pending;if(l!==null){var h=l.next;l.next=a,n.next=h}r.pending=n}Qg=null}return e}function LJ(e,t){do{var r=aa;try{if(MB(),tM.current=lI,sI){for(var n=Oo.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}sI=!1}if(My=0,La=Sa=Oo=null,OS=!1,cT=0,$B.current=null,r===null||r.return===null){Ea=1,hT=t,aa=null;break}e:{var l=e,h=r.return,i=r,_=t;if(t=Xa,i.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var b=_,E=i,C=E.tag;if(!(E.mode&1)&&(C===0||C===11||C===15)){var I=E.alternate;I?(E.updateQueue=I.updateQueue,E.memoizedState=I.memoizedState,E.lanes=I.lanes):(E.updateQueue=null,E.memoizedState=null)}var F=zG(h);if(F!==null){F.flags&=-257,jG(F,h,i,l,t),F.mode&1&&NG(l,b,t),t=F,_=b;var $=t.updateQueue;if($===null){var B=new Set;B.add(_),t.updateQueue=B}else $.add(_);break e}else{if(!(t&1)){NG(l,b,t),qB();break e}_=Error(pr(426))}}else if(xo&&i.mode&1){var q=zG(h);if(q!==null){!(q.flags&65536)&&(q.flags|=256),jG(q,h,i,l,t),AB(J0(_,i));break e}}l=_=J0(_,i),Ea!==4&&(Ea=2),RS===null?RS=[l]:RS.push(l),l=h;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var G=vJ(l,_,t);IG(l,G);break e;case 1:i=_;var H=l.type,J=l.stateNode;if(!(l.flags&128)&&(typeof H.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(om===null||!om.has(J)))){l.flags|=65536,t&=-t,l.lanes|=t;var Q=_J(l,i,t);IG(l,Q);break e}}l=l.return}while(l!==null)}jJ(r)}catch(oe){t=oe,aa===r&&r!==null&&(aa=r=r.return);continue}break}while(!0)}function NJ(){var e=cI.current;return cI.current=lI,e===null?lI:e}function qB(){(Ea===0||Ea===3||Ea===2)&&(Ea=4),za===null||!(Py&268435455)&&!(dk&268435455)||Rp(za,Xa)}function hI(e,t){var r=_i;_i|=2;var n=NJ();(za!==e||Xa!==t)&&(Eh=null,gy(e,t));do try{yme();break}catch(a){LJ(e,a)}while(!0);if(MB(),_i=r,cI.current=n,aa!==null)throw Error(pr(261));return za=null,Xa=0,Ea}function yme(){for(;aa!==null;)zJ(aa)}function vme(){for(;aa!==null&&!Vfe();)zJ(aa)}function zJ(e){var t=BJ(e.alternate,e,Vl);e.memoizedProps=e.pendingProps,t===null?jJ(e):aa=t,$B.current=null}function jJ(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=dme(r,t),r!==null){r.flags&=32767,aa=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ea=6,aa=null;return}}else if(r=ume(r,t,Vl),r!==null){aa=r;return}if(t=t.sibling,t!==null){aa=t;return}aa=t=e}while(t!==null);Ea===0&&(Ea=5)}function Fg(e,t,r){var n=Ni,a=kc.transition;try{kc.transition=null,Ni=1,_me(e,t,r,n)}finally{kc.transition=a,Ni=n}return null}function _me(e,t,r,n){do b0();while(Xp!==null);if(_i&6)throw Error(pr(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pr(177));e.callbackNode=null,e.callbackPriority=0;var l=r.lanes|r.childLanes;if(Qfe(e,l),e===za&&(aa=za=null,Xa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||uC||(uC=!0,$J(HP,function(){return b0(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=kc.transition,kc.transition=null;var h=Ni;Ni=1;var i=_i;_i|=4,$B.current=null,fme(e,r),kJ(r,e),Fpe(mz),XP=!!pz,mz=pz=null,e.current=r,pme(r),Wfe(),_i=i,Ni=h,kc.transition=l}else e.current=r;if(uC&&(uC=!1,Xp=e,dI=a),l=e.pendingLanes,l===0&&(om=null),Hfe(r.stateNode),Tl(e,Yo()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(uI)throw uI=!1,e=Lz,Lz=null,e;return dI&1&&e.tag!==0&&b0(),l=e.pendingLanes,l&1?e===Nz?DS++:(DS=0,Nz=e):DS=0,Pm(),null}function b0(){if(Xp!==null){var e=vK(dI),t=kc.transition,r=Ni;try{if(kc.transition=null,Ni=16>e?16:e,Xp===null)var n=!1;else{if(e=Xp,Xp=null,dI=0,_i&6)throw Error(pr(331));var a=_i;for(_i|=4,Br=e.current;Br!==null;){var l=Br,h=l.child;if(Br.flags&16){var i=l.deletions;if(i!==null){for(var _=0;_<i.length;_++){var b=i[_];for(Br=b;Br!==null;){var E=Br;switch(E.tag){case 0:case 11:case 15:kS(8,E,l)}var C=E.child;if(C!==null)C.return=E,Br=C;else for(;Br!==null;){E=Br;var I=E.sibling,F=E.return;if(PJ(E),E===b){Br=null;break}if(I!==null){I.return=F,Br=I;break}Br=F}}}var $=l.alternate;if($!==null){var B=$.child;if(B!==null){$.child=null;do{var q=B.sibling;B.sibling=null,B=q}while(B!==null)}}Br=l}}if(l.subtreeFlags&2064&&h!==null)h.return=l,Br=h;else e:for(;Br!==null;){if(l=Br,l.flags&2048)switch(l.tag){case 0:case 11:case 15:kS(9,l,l.return)}var G=l.sibling;if(G!==null){G.return=l.return,Br=G;break e}Br=l.return}}var H=e.current;for(Br=H;Br!==null;){h=Br;var J=h.child;if(h.subtreeFlags&2064&&J!==null)J.return=h,Br=J;else e:for(h=H;Br!==null;){if(i=Br,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:uk(9,i)}}catch(oe){Bo(i,i.return,oe)}if(i===h){Br=null;break e}var Q=i.sibling;if(Q!==null){Q.return=i.return,Br=Q;break e}Br=i.return}}if(_i=a,Pm(),Ld&&typeof Ld.onPostCommitFiberRoot=="function")try{Ld.onPostCommitFiberRoot(rk,e)}catch{}n=!0}return n}finally{Ni=r,kc.transition=t}}return!1}function KG(e,t,r){t=J0(r,t),t=vJ(e,t,1),e=im(e,t,1),t=Bs(),e!==null&&(TE(e,1,t),Tl(e,t))}function Bo(e,t,r){if(e.tag===3)KG(e,e,r);else for(;t!==null;){if(t.tag===3){KG(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(om===null||!om.has(n))){e=J0(r,e),e=_J(t,e,1),t=im(t,e,1),e=Bs(),t!==null&&(TE(t,1,e),Tl(t,e));break}}t=t.return}}function xme(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Bs(),e.pingedLanes|=e.suspendedLanes&r,za===e&&(Xa&r)===r&&(Ea===4||Ea===3&&(Xa&130023424)===Xa&&500>Yo()-VB?gy(e,0):UB|=r),Tl(e,t)}function FJ(e,t){t===0&&(e.mode&1?(t=eC,eC<<=1,!(eC&130023424)&&(eC=4194304)):t=1);var r=Bs();e=Zh(e,t),e!==null&&(TE(e,t,r),Tl(e,r))}function bme(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),FJ(e,r)}function wme(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pr(314))}n!==null&&n.delete(t),FJ(e,r)}var BJ;BJ=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||wl.current)vl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return vl=!1,cme(e,t,r);vl=!!(e.flags&131072)}else vl=!1,xo&&t.flags&1048576&&WK(t,rI,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;nM(e,t),e=t.pendingProps;var a=Z0(t,ps.current);x0(t,r),a=NB(null,t,n,e,a,r);var l=zB();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Sl(n)?(l=!0,eI(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,OB(t),a.updater=ck,t.stateNode=a,a._reactInternals=t,Tz(t,n,e,r),t=Cz(null,t,n,!0,l,r)):(t.tag=0,xo&&l&&TB(t),Ls(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(nM(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Tme(n),e=gu(n,e),a){case 0:t=Az(null,t,n,e,r);break e;case 1:t=$G(null,t,n,e,r);break e;case 11:t=FG(null,t,n,e,r);break e;case 14:t=BG(null,t,n,gu(n.type,e),r);break e}throw Error(pr(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gu(n,a),Az(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gu(n,a),$G(e,t,n,a,r);case 3:e:{if(SJ(t),e===null)throw Error(pr(387));n=t.pendingProps,l=t.memoizedState,a=l.element,YK(e,t),oI(t,n,null,r);var h=t.memoizedState;if(n=h.element,l.isDehydrated)if(l={element:n,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=J0(Error(pr(423)),t),t=UG(e,t,n,r,a);break e}else if(n!==a){a=J0(Error(pr(424)),t),t=UG(e,t,n,r,a);break e}else for(Yl=nm(t.stateNode.containerInfo.firstChild),Jl=t,xo=!0,Su=null,r=ZK(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(X0(),n===a){t=Xh(e,t,r);break e}Ls(e,t,n,r)}t=t.child}return t;case 5:return KK(t),e===null&&bz(t),n=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,h=a.children,gz(n,a)?h=null:l!==null&&gz(n,l)&&(t.flags|=32),wJ(e,t),Ls(e,t,h,r),t.child;case 6:return e===null&&bz(t),null;case 13:return TJ(e,t,r);case 4:return kB(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Y0(t,null,n,r):Ls(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gu(n,a),FG(e,t,n,a,r);case 7:return Ls(e,t,t.pendingProps,r),t.child;case 8:return Ls(e,t,t.pendingProps.children,r),t.child;case 12:return Ls(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,l=t.memoizedProps,h=a.value,no(nI,n._currentValue),n._currentValue=h,l!==null)if(Nu(l.value,h)){if(l.children===a.children&&!wl.current){t=Xh(e,t,r);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){h=l.child;for(var _=i.firstContext;_!==null;){if(_.context===n){if(l.tag===1){_=zh(-1,r&-r),_.tag=2;var b=l.updateQueue;if(b!==null){b=b.shared;var E=b.pending;E===null?_.next=_:(_.next=E.next,E.next=_),b.pending=_}}l.lanes|=r,_=l.alternate,_!==null&&(_.lanes|=r),wz(l.return,r,t),i.lanes|=r;break}_=_.next}}else if(l.tag===10)h=l.type===t.type?null:l.child;else if(l.tag===18){if(h=l.return,h===null)throw Error(pr(341));h.lanes|=r,i=h.alternate,i!==null&&(i.lanes|=r),wz(h,r,t),h=l.sibling}else h=l.child;if(h!==null)h.return=l;else for(h=l;h!==null;){if(h===t){h=null;break}if(l=h.sibling,l!==null){l.return=h.return,h=l;break}h=h.return}l=h}Ls(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,x0(t,r),a=Lc(a),n=n(a),t.flags|=1,Ls(e,t,n,r),t.child;case 14:return n=t.type,a=gu(n,t.pendingProps),a=gu(n.type,a),BG(e,t,n,a,r);case 15:return xJ(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gu(n,a),nM(e,t),t.tag=1,Sl(n)?(e=!0,eI(t)):e=!1,x0(t,r),yJ(t,n,a),Tz(t,n,a,r),Cz(null,t,n,!0,e,r);case 19:return EJ(e,t,r);case 22:return bJ(e,t,r)}throw Error(pr(156,t.tag))};function $J(e,t){return pK(e,t)}function Sme(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,r,n){return new Sme(e,t,r,n)}function HB(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Tme(e){if(typeof e=="function")return HB(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hB)return 11;if(e===fB)return 14}return 2}function sm(e,t){var r=e.alternate;return r===null?(r=Pc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function aM(e,t,r,n,a,l){var h=2;if(n=e,typeof e=="function")HB(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case Q_:return yy(r.children,a,l,t);case dB:h=8,a|=8;break;case ZN:return e=Pc(12,r,t,a|2),e.elementType=ZN,e.lanes=l,e;case XN:return e=Pc(13,r,t,a),e.elementType=XN,e.lanes=l,e;case YN:return e=Pc(19,r,t,a),e.elementType=YN,e.lanes=l,e;case KY:return hk(r,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XY:h=10;break e;case YY:h=9;break e;case hB:h=11;break e;case fB:h=14;break e;case Mp:h=16,n=null;break e}throw Error(pr(130,e==null?e:typeof e,""))}return t=Pc(h,r,t,a),t.elementType=e,t.type=n,t.lanes=l,t}function yy(e,t,r,n){return e=Pc(7,e,n,t),e.lanes=r,e}function hk(e,t,r,n){return e=Pc(22,e,n,t),e.elementType=KY,e.lanes=r,e.stateNode={isHidden:!1},e}function T3(e,t,r){return e=Pc(6,e,null,t),e.lanes=r,e}function E3(e,t,r){return t=Pc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Eme(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=o3(0),this.expirationTimes=o3(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=o3(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function ZB(e,t,r,n,a,l,h,i,_){return e=new Eme(e,t,r,i,_),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Pc(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},OB(l),e}function Ame(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J_,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function UJ(e){if(!e)return gm;e=e._reactInternals;e:{if(Hy(e)!==e||e.tag!==1)throw Error(pr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Sl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pr(171))}if(e.tag===1){var r=e.type;if(Sl(r))return UK(e,r,t)}return t}function VJ(e,t,r,n,a,l,h,i,_){return e=ZB(r,n,!0,e,a,l,h,i,_),e.context=UJ(null),r=e.current,n=Bs(),a=am(r),l=zh(n,a),l.callback=t??null,im(r,l,a),e.current.lanes=a,TE(e,a,n),Tl(e,n),e}function fk(e,t,r,n){var a=t.current,l=Bs(),h=am(a);return r=UJ(r),t.context===null?t.context=r:t.pendingContext=r,t=zh(l,h),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=im(a,t,h),e!==null&&(Ou(e,a,h,l),eM(e,a,h)),h}function fI(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function JG(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function XB(e,t){JG(e,t),(e=e.alternate)&&JG(e,t)}function Cme(){return null}var WJ=typeof reportError=="function"?reportError:function(e){console.error(e)};function YB(e){this._internalRoot=e}pk.prototype.render=YB.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pr(409));fk(e,t,null,null)};pk.prototype.unmount=YB.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Iy(function(){fk(null,e,null,null)}),t[Hh]=null}};function pk(e){this._internalRoot=e}pk.prototype.unstable_scheduleHydration=function(e){if(e){var t=bK();e={blockedOn:null,target:e,priority:t};for(var r=0;r<kp.length&&t!==0&&t<kp[r].priority;r++);kp.splice(r,0,e),r===0&&SK(e)}};function KB(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function mk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function QG(){}function Mme(e,t,r,n,a){if(a){if(typeof n=="function"){var l=n;n=function(){var b=fI(h);l.call(b)}}var h=VJ(t,n,e,0,null,!1,!1,"",QG);return e._reactRootContainer=h,e[Hh]=h.current,iT(e.nodeType===8?e.parentNode:e),Iy(),h}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var i=n;n=function(){var b=fI(_);i.call(b)}}var _=ZB(e,0,!1,null,null,!1,!1,"",QG);return e._reactRootContainer=_,e[Hh]=_.current,iT(e.nodeType===8?e.parentNode:e),Iy(function(){fk(t,_,r,n)}),_}function gk(e,t,r,n,a){var l=r._reactRootContainer;if(l){var h=l;if(typeof a=="function"){var i=a;a=function(){var _=fI(h);i.call(_)}}fk(t,h,e,a)}else h=Mme(r,t,e,a,n);return fI(h)}_K=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=qw(t.pendingLanes);r!==0&&(gB(t,r|1),Tl(t,Yo()),!(_i&6)&&(Q0=Yo()+500,Pm()))}break;case 13:Iy(function(){var n=Zh(e,1);if(n!==null){var a=Bs();Ou(n,e,1,a)}}),XB(e,1)}};yB=function(e){if(e.tag===13){var t=Zh(e,134217728);if(t!==null){var r=Bs();Ou(t,e,134217728,r)}XB(e,134217728)}};xK=function(e){if(e.tag===13){var t=am(e),r=Zh(e,t);if(r!==null){var n=Bs();Ou(r,e,t,n)}XB(e,t)}};bK=function(){return Ni};wK=function(e,t){var r=Ni;try{return Ni=e,t()}finally{Ni=r}};az=function(e,t,r){switch(t){case"input":if(QN(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=ak(n);if(!a)throw Error(pr(90));QY(n),QN(n,a)}}}break;case"textarea":tK(e,r);break;case"select":t=r.value,t!=null&&g0(e,!!r.multiple,t,!1)}};lK=WB;cK=Iy;var Pme={usingClientEntryPoint:!1,Events:[AE,n0,ak,aK,sK,WB]},bw={findFiberByHostInstance:Jg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ime={bundleType:bw.bundleType,version:bw.version,rendererPackageName:bw.rendererPackageName,rendererConfig:bw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hK(e),e===null?null:e.stateNode},findFiberByHostInstance:bw.findFiberByHostInstance||Cme,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dC.isDisabled&&dC.supportsFiber)try{rk=dC.inject(Ime),Ld=dC}catch{}}ac.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pme;ac.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!KB(t))throw Error(pr(200));return Ame(e,t,null,r)};ac.createRoot=function(e,t){if(!KB(e))throw Error(pr(299));var r=!1,n="",a=WJ;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=ZB(e,1,!1,null,null,r,!1,n,a),e[Hh]=t.current,iT(e.nodeType===8?e.parentNode:e),new YB(t)};ac.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pr(188)):(e=Object.keys(e).join(","),Error(pr(268,e)));return e=hK(t),e=e===null?null:e.stateNode,e};ac.flushSync=function(e){return Iy(e)};ac.hydrate=function(e,t,r){if(!mk(t))throw Error(pr(200));return gk(null,e,t,!0,r)};ac.hydrateRoot=function(e,t,r){if(!KB(e))throw Error(pr(405));var n=r!=null&&r.hydratedSources||null,a=!1,l="",h=WJ;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),t=VJ(t,null,e,1,r??null,a,!1,l,h),e[Hh]=t.current,iT(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new pk(t)};ac.render=function(e,t,r){if(!mk(t))throw Error(pr(200));return gk(null,e,t,!1,r)};ac.unmountComponentAtNode=function(e){if(!mk(e))throw Error(pr(40));return e._reactRootContainer?(Iy(function(){gk(null,null,e,!1,function(){e._reactRootContainer=null,e[Hh]=null})}),!0):!1};ac.unstable_batchedUpdates=WB;ac.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!mk(r))throw Error(pr(200));if(e==null||e._reactInternals===void 0)throw Error(pr(38));return gk(e,t,r,!1,n)};ac.version="18.3.1-next-f1338f8080-20240426";function GJ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(GJ)}catch(e){console.error(e)}}GJ(),GY.exports=ac;var Zy=GY.exports;const qJ=yi(Zy);var HJ,eq=Zy;HJ=eq.createRoot,eq.hydrateRoot;const Ome=1,kme=1e6;let A3=0;function Rme(){return A3=(A3+1)%Number.MAX_SAFE_INTEGER,A3.toString()}const C3=new Map,tq=e=>{if(C3.has(e))return;const t=setTimeout(()=>{C3.delete(e),LS({type:"REMOVE_TOAST",toastId:e})},kme);C3.set(e,t)},Dme=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,Ome)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?tq(r):e.toasts.forEach(n=>{tq(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},sM=[];let lM={toasts:[]};function LS(e){lM=Dme(lM,e),sM.forEach(t=>{t(lM)})}function pI({...e}){const t=Rme(),r=a=>LS({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>LS({type:"DISMISS_TOAST",toastId:t});return LS({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function Xy(){const[e,t]=ne.useState(lM);return ne.useEffect(()=>(sM.push(t),()=>{const r=sM.indexOf(t);r>-1&&sM.splice(r,1)}),[e]),{...e,toast:pI,dismiss:r=>LS({type:"DISMISS_TOAST",toastId:r})}}function Kr(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Lme(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function ZJ(...e){return t=>e.forEach(r=>Lme(r,t))}function Ci(...e){return ne.useCallback(ZJ(...e),e)}function Nme(e,t=[]){let r=[];function n(l,h){const i=ne.createContext(h),_=r.length;r=[...r,h];function b(C){const{scope:I,children:F,...$}=C,B=(I==null?void 0:I[e][_])||i,q=ne.useMemo(()=>$,Object.values($));return j.jsx(B.Provider,{value:q,children:F})}function E(C,I){const F=(I==null?void 0:I[e][_])||i,$=ne.useContext(F);if($)return $;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${l}\``)}return b.displayName=l+"Provider",[b,E]}const a=()=>{const l=r.map(h=>ne.createContext(h));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,zme(a,...t)]}function zme(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const h=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}var Yh=ne.forwardRef((e,t)=>{const{children:r,...n}=e,a=ne.Children.toArray(r),l=a.find(jme);if(l){const h=l.props.children,i=a.map(_=>_===l?ne.Children.count(h)>1?ne.Children.only(null):ne.isValidElement(h)?h.props.children:null:_);return j.jsx(Fz,{...n,ref:t,children:ne.isValidElement(h)?ne.cloneElement(h,void 0,i):null})}return j.jsx(Fz,{...n,ref:t,children:r})});Yh.displayName="Slot";var Fz=ne.forwardRef((e,t)=>{const{children:r,...n}=e;if(ne.isValidElement(r)){const a=Bme(r);return ne.cloneElement(r,{...Fme(n,r.props),ref:t?ZJ(t,a):a})}return ne.Children.count(r)>1?ne.Children.only(null):null});Fz.displayName="SlotClone";var XJ=({children:e})=>j.jsx(j.Fragment,{children:e});function jme(e){return ne.isValidElement(e)&&e.type===XJ}function Fme(e,t){const r={...t};for(const n in t){const a=e[n],l=t[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...i)=>{l(...i),a(...i)}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}function Bme(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function JB(e){const t=e+"CollectionProvider",[r,n]=Nme(t),[a,l]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=F=>{const{scope:$,children:B}=F,q=Ae.useRef(null),G=Ae.useRef(new Map).current;return j.jsx(a,{scope:$,itemMap:G,collectionRef:q,children:B})};h.displayName=t;const i=e+"CollectionSlot",_=Ae.forwardRef((F,$)=>{const{scope:B,children:q}=F,G=l(i,B),H=Ci($,G.collectionRef);return j.jsx(Yh,{ref:H,children:q})});_.displayName=i;const b=e+"CollectionItemSlot",E="data-radix-collection-item",C=Ae.forwardRef((F,$)=>{const{scope:B,children:q,...G}=F,H=Ae.useRef(null),J=Ci($,H),Q=l(b,B);return Ae.useEffect(()=>(Q.itemMap.set(H,{ref:H,...G}),()=>void Q.itemMap.delete(H))),j.jsx(Yh,{[E]:"",ref:J,children:q})});C.displayName=b;function I(F){const $=l(e+"CollectionConsumer",F);return Ae.useCallback(()=>{const q=$.collectionRef.current;if(!q)return[];const G=Array.from(q.querySelectorAll(`[${E}]`));return Array.from($.itemMap.values()).sort((Q,oe)=>G.indexOf(Q.ref.current)-G.indexOf(oe.ref.current))},[$.collectionRef,$.itemMap])}return[{Provider:h,Slot:_,ItemSlot:C},I,n]}function $me(e,t){const r=ne.createContext(t),n=l=>{const{children:h,...i}=l,_=ne.useMemo(()=>i,Object.values(i));return j.jsx(r.Provider,{value:_,children:h})};n.displayName=e+"Provider";function a(l){const h=ne.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[n,a]}function lf(e,t=[]){let r=[];function n(l,h){const i=ne.createContext(h),_=r.length;r=[...r,h];const b=C=>{var G;const{scope:I,children:F,...$}=C,B=((G=I==null?void 0:I[e])==null?void 0:G[_])||i,q=ne.useMemo(()=>$,Object.values($));return j.jsx(B.Provider,{value:q,children:F})};b.displayName=l+"Provider";function E(C,I){var B;const F=((B=I==null?void 0:I[e])==null?void 0:B[_])||i,$=ne.useContext(F);if($)return $;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${l}\``)}return[b,E]}const a=()=>{const l=r.map(h=>ne.createContext(h));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,Ume(a,...t)]}function Ume(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const h=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}var Vme=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Mn=Vme.reduce((e,t)=>{const r=ne.forwardRef((n,a)=>{const{asChild:l,...h}=n,i=l?Yh:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),j.jsx(i,{...h,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function YJ(e,t){e&&Zy.flushSync(()=>e.dispatchEvent(t))}function Al(e){const t=ne.useRef(e);return ne.useEffect(()=>{t.current=e}),ne.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Wme(e,t=globalThis==null?void 0:globalThis.document){const r=Al(e);ne.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Gme="DismissableLayer",Bz="dismissableLayer.update",qme="dismissableLayer.pointerDownOutside",Hme="dismissableLayer.focusOutside",rq,KJ=ne.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Vx=ne.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:h,onDismiss:i,..._}=e,b=ne.useContext(KJ),[E,C]=ne.useState(null),I=(E==null?void 0:E.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,F]=ne.useState({}),$=Ci(t,ae=>C(ae)),B=Array.from(b.layers),[q]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),G=B.indexOf(q),H=E?B.indexOf(E):-1,J=b.layersWithOutsidePointerEventsDisabled.size>0,Q=H>=G,oe=Xme(ae=>{const ve=ae.target,Fe=[...b.branches].some(ke=>ke.contains(ve));!Q||Fe||(a==null||a(ae),h==null||h(ae),ae.defaultPrevented||i==null||i())},I),de=Yme(ae=>{const ve=ae.target;[...b.branches].some(ke=>ke.contains(ve))||(l==null||l(ae),h==null||h(ae),ae.defaultPrevented||i==null||i())},I);return Wme(ae=>{H===b.layers.size-1&&(n==null||n(ae),!ae.defaultPrevented&&i&&(ae.preventDefault(),i()))},I),ne.useEffect(()=>{if(E)return r&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(rq=I.body.style.pointerEvents,I.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(E)),b.layers.add(E),nq(),()=>{r&&b.layersWithOutsidePointerEventsDisabled.size===1&&(I.body.style.pointerEvents=rq)}},[E,I,r,b]),ne.useEffect(()=>()=>{E&&(b.layers.delete(E),b.layersWithOutsidePointerEventsDisabled.delete(E),nq())},[E,b]),ne.useEffect(()=>{const ae=()=>F({});return document.addEventListener(Bz,ae),()=>document.removeEventListener(Bz,ae)},[]),j.jsx(Mn.div,{..._,ref:$,style:{pointerEvents:J?Q?"auto":"none":void 0,...e.style},onFocusCapture:Kr(e.onFocusCapture,de.onFocusCapture),onBlurCapture:Kr(e.onBlurCapture,de.onBlurCapture),onPointerDownCapture:Kr(e.onPointerDownCapture,oe.onPointerDownCapture)})});Vx.displayName=Gme;var Zme="DismissableLayerBranch",JJ=ne.forwardRef((e,t)=>{const r=ne.useContext(KJ),n=ne.useRef(null),a=Ci(t,n);return ne.useEffect(()=>{const l=n.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),j.jsx(Mn.div,{...e,ref:a})});JJ.displayName=Zme;function Xme(e,t=globalThis==null?void 0:globalThis.document){const r=Al(e),n=ne.useRef(!1),a=ne.useRef(()=>{});return ne.useEffect(()=>{const l=i=>{if(i.target&&!n.current){let _=function(){QJ(qme,r,b,{discrete:!0})};const b={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=_,t.addEventListener("click",a.current,{once:!0})):_()}else t.removeEventListener("click",a.current);n.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Yme(e,t=globalThis==null?void 0:globalThis.document){const r=Al(e),n=ne.useRef(!1);return ne.useEffect(()=>{const a=l=>{l.target&&!n.current&&QJ(Hme,r,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function nq(){const e=new CustomEvent(Bz);document.dispatchEvent(e)}function QJ(e,t,r,{discrete:n}){const a=r.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?YJ(a,l):a.dispatchEvent(l)}var Kme=Vx,Jme=JJ,ms=globalThis!=null&&globalThis.document?ne.useLayoutEffect:()=>{},Qme="Portal",ME=ne.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[a,l]=ne.useState(!1);ms(()=>l(!0),[]);const h=r||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return h?qJ.createPortal(j.jsx(Mn.div,{...n,ref:t}),h):null});ME.displayName=Qme;function ege(e,t){return ne.useReducer((r,n)=>t[r][n]??r,e)}var Gu=e=>{const{present:t,children:r}=e,n=tge(t),a=typeof r=="function"?r({present:n.isPresent}):ne.Children.only(r),l=Ci(n.ref,rge(a));return typeof r=="function"||n.isPresent?ne.cloneElement(a,{ref:l}):null};Gu.displayName="Presence";function tge(e){const[t,r]=ne.useState(),n=ne.useRef({}),a=ne.useRef(e),l=ne.useRef("none"),h=e?"mounted":"unmounted",[i,_]=ege(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return ne.useEffect(()=>{const b=hC(n.current);l.current=i==="mounted"?b:"none"},[i]),ms(()=>{const b=n.current,E=a.current;if(E!==e){const I=l.current,F=hC(b);e?_("MOUNT"):F==="none"||(b==null?void 0:b.display)==="none"?_("UNMOUNT"):_(E&&I!==F?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,_]),ms(()=>{if(t){let b;const E=t.ownerDocument.defaultView??window,C=F=>{const B=hC(n.current).includes(F.animationName);if(F.target===t&&B&&(_("ANIMATION_END"),!a.current)){const q=t.style.animationFillMode;t.style.animationFillMode="forwards",b=E.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=q)})}},I=F=>{F.target===t&&(l.current=hC(n.current))};return t.addEventListener("animationstart",I),t.addEventListener("animationcancel",C),t.addEventListener("animationend",C),()=>{E.clearTimeout(b),t.removeEventListener("animationstart",I),t.removeEventListener("animationcancel",C),t.removeEventListener("animationend",C)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:ne.useCallback(b=>{b&&(n.current=getComputedStyle(b)),r(b)},[])}}function hC(e){return(e==null?void 0:e.animationName)||"none"}function rge(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Kh({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=nge({defaultProp:t,onChange:r}),l=e!==void 0,h=l?e:n,i=Al(r),_=ne.useCallback(b=>{if(l){const C=typeof b=="function"?b(e):b;C!==e&&i(C)}else a(b)},[l,e,a,i]);return[h,_]}function nge({defaultProp:e,onChange:t}){const r=ne.useState(e),[n]=r,a=ne.useRef(n),l=Al(t);return ne.useEffect(()=>{a.current!==n&&(l(n),a.current=n)},[n,a,l]),r}var ige="VisuallyHidden",PE=ne.forwardRef((e,t)=>j.jsx(Mn.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));PE.displayName=ige;var oge=PE,QB="ToastProvider",[e5,age,sge]=JB("Toast"),[eQ,gQe]=lf("Toast",[sge]),[lge,yk]=eQ(QB),tQ=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:h}=e,[i,_]=ne.useState(null),[b,E]=ne.useState(0),C=ne.useRef(!1),I=ne.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${QB}\`. Expected non-empty \`string\`.`),j.jsx(e5.Provider,{scope:t,children:j.jsx(lge,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:l,toastCount:b,viewport:i,onViewportChange:_,onToastAdd:ne.useCallback(()=>E(F=>F+1),[]),onToastRemove:ne.useCallback(()=>E(F=>F-1),[]),isFocusedToastEscapeKeyDownRef:C,isClosePausedRef:I,children:h})})};tQ.displayName=QB;var rQ="ToastViewport",cge=["F8"],$z="toast.viewportPause",Uz="toast.viewportResume",nQ=ne.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=cge,label:a="Notifications ({hotkey})",...l}=e,h=yk(rQ,r),i=age(r),_=ne.useRef(null),b=ne.useRef(null),E=ne.useRef(null),C=ne.useRef(null),I=Ci(t,C,h.onViewportChange),F=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),$=h.toastCount>0;ne.useEffect(()=>{const q=G=>{var J;n.length!==0&&n.every(Q=>G[Q]||G.code===Q)&&((J=C.current)==null||J.focus())};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[n]),ne.useEffect(()=>{const q=_.current,G=C.current;if($&&q&&G){const H=()=>{if(!h.isClosePausedRef.current){const de=new CustomEvent($z);G.dispatchEvent(de),h.isClosePausedRef.current=!0}},J=()=>{if(h.isClosePausedRef.current){const de=new CustomEvent(Uz);G.dispatchEvent(de),h.isClosePausedRef.current=!1}},Q=de=>{!q.contains(de.relatedTarget)&&J()},oe=()=>{q.contains(document.activeElement)||J()};return q.addEventListener("focusin",H),q.addEventListener("focusout",Q),q.addEventListener("pointermove",H),q.addEventListener("pointerleave",oe),window.addEventListener("blur",H),window.addEventListener("focus",J),()=>{q.removeEventListener("focusin",H),q.removeEventListener("focusout",Q),q.removeEventListener("pointermove",H),q.removeEventListener("pointerleave",oe),window.removeEventListener("blur",H),window.removeEventListener("focus",J)}}},[$,h.isClosePausedRef]);const B=ne.useCallback(({tabbingDirection:q})=>{const H=i().map(J=>{const Q=J.ref.current,oe=[Q,...wge(Q)];return q==="forwards"?oe:oe.reverse()});return(q==="forwards"?H.reverse():H).flat()},[i]);return ne.useEffect(()=>{const q=C.current;if(q){const G=H=>{var oe,de,ae;const J=H.altKey||H.ctrlKey||H.metaKey;if(H.key==="Tab"&&!J){const ve=document.activeElement,Fe=H.shiftKey;if(H.target===q&&Fe){(oe=b.current)==null||oe.focus();return}const je=B({tabbingDirection:Fe?"backwards":"forwards"}),tt=je.findIndex(Ze=>Ze===ve);M3(je.slice(tt+1))?H.preventDefault():Fe?(de=b.current)==null||de.focus():(ae=E.current)==null||ae.focus()}};return q.addEventListener("keydown",G),()=>q.removeEventListener("keydown",G)}},[i,B]),j.jsxs(Jme,{ref:_,role:"region","aria-label":a.replace("{hotkey}",F),tabIndex:-1,style:{pointerEvents:$?void 0:"none"},children:[$&&j.jsx(Vz,{ref:b,onFocusFromOutsideViewport:()=>{const q=B({tabbingDirection:"forwards"});M3(q)}}),j.jsx(e5.Slot,{scope:r,children:j.jsx(Mn.ol,{tabIndex:-1,...l,ref:I})}),$&&j.jsx(Vz,{ref:E,onFocusFromOutsideViewport:()=>{const q=B({tabbingDirection:"backwards"});M3(q)}})]})});nQ.displayName=rQ;var iQ="ToastFocusProxy",Vz=ne.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,l=yk(iQ,r);return j.jsx(PE,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:h=>{var b;const i=h.relatedTarget;!((b=l.viewport)!=null&&b.contains(i))&&n()}})});Vz.displayName=iQ;var vk="Toast",uge="toast.swipeStart",dge="toast.swipeMove",hge="toast.swipeCancel",fge="toast.swipeEnd",oQ=ne.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:l,...h}=e,[i=!0,_]=Kh({prop:n,defaultProp:a,onChange:l});return j.jsx(Gu,{present:r||i,children:j.jsx(gge,{open:i,...h,ref:t,onClose:()=>_(!1),onPause:Al(e.onPause),onResume:Al(e.onResume),onSwipeStart:Kr(e.onSwipeStart,b=>{b.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Kr(e.onSwipeMove,b=>{const{x:E,y:C}=b.detail.delta;b.currentTarget.setAttribute("data-swipe","move"),b.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${E}px`),b.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${C}px`)}),onSwipeCancel:Kr(e.onSwipeCancel,b=>{b.currentTarget.setAttribute("data-swipe","cancel"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),b.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Kr(e.onSwipeEnd,b=>{const{x:E,y:C}=b.detail.delta;b.currentTarget.setAttribute("data-swipe","end"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),b.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${E}px`),b.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${C}px`),_(!1)})})})});oQ.displayName=vk;var[pge,mge]=eQ(vk,{onClose(){}}),gge=ne.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:l,onClose:h,onEscapeKeyDown:i,onPause:_,onResume:b,onSwipeStart:E,onSwipeMove:C,onSwipeCancel:I,onSwipeEnd:F,...$}=e,B=yk(vk,r),[q,G]=ne.useState(null),H=Ci(t,Ze=>G(Ze)),J=ne.useRef(null),Q=ne.useRef(null),oe=a||B.duration,de=ne.useRef(0),ae=ne.useRef(oe),ve=ne.useRef(0),{onToastAdd:Fe,onToastRemove:ke}=B,Ce=Al(()=>{var Qe;(q==null?void 0:q.contains(document.activeElement))&&((Qe=B.viewport)==null||Qe.focus()),h()}),je=ne.useCallback(Ze=>{!Ze||Ze===1/0||(window.clearTimeout(ve.current),de.current=new Date().getTime(),ve.current=window.setTimeout(Ce,Ze))},[Ce]);ne.useEffect(()=>{const Ze=B.viewport;if(Ze){const Qe=()=>{je(ae.current),b==null||b()},st=()=>{const ot=new Date().getTime()-de.current;ae.current=ae.current-ot,window.clearTimeout(ve.current),_==null||_()};return Ze.addEventListener($z,st),Ze.addEventListener(Uz,Qe),()=>{Ze.removeEventListener($z,st),Ze.removeEventListener(Uz,Qe)}}},[B.viewport,oe,_,b,je]),ne.useEffect(()=>{l&&!B.isClosePausedRef.current&&je(oe)},[l,oe,B.isClosePausedRef,je]),ne.useEffect(()=>(Fe(),()=>ke()),[Fe,ke]);const tt=ne.useMemo(()=>q?hQ(q):null,[q]);return B.viewport?j.jsxs(j.Fragment,{children:[tt&&j.jsx(yge,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:tt}),j.jsx(pge,{scope:r,onClose:Ce,children:Zy.createPortal(j.jsx(e5.ItemSlot,{scope:r,children:j.jsx(Kme,{asChild:!0,onEscapeKeyDown:Kr(i,()=>{B.isFocusedToastEscapeKeyDownRef.current||Ce(),B.isFocusedToastEscapeKeyDownRef.current=!1}),children:j.jsx(Mn.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":B.swipeDirection,...$,ref:H,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Kr(e.onKeyDown,Ze=>{Ze.key==="Escape"&&(i==null||i(Ze.nativeEvent),Ze.nativeEvent.defaultPrevented||(B.isFocusedToastEscapeKeyDownRef.current=!0,Ce()))}),onPointerDown:Kr(e.onPointerDown,Ze=>{Ze.button===0&&(J.current={x:Ze.clientX,y:Ze.clientY})}),onPointerMove:Kr(e.onPointerMove,Ze=>{if(!J.current)return;const Qe=Ze.clientX-J.current.x,st=Ze.clientY-J.current.y,ot=!!Q.current,Be=["left","right"].includes(B.swipeDirection),lt=["left","up"].includes(B.swipeDirection)?Math.min:Math.max,zt=Be?lt(0,Qe):0,Lt=Be?0:lt(0,st),Bt=Ze.pointerType==="touch"?10:2,ct={x:zt,y:Lt},nr={originalEvent:Ze,delta:ct};ot?(Q.current=ct,fC(dge,C,nr,{discrete:!1})):iq(ct,B.swipeDirection,Bt)?(Q.current=ct,fC(uge,E,nr,{discrete:!1}),Ze.target.setPointerCapture(Ze.pointerId)):(Math.abs(Qe)>Bt||Math.abs(st)>Bt)&&(J.current=null)}),onPointerUp:Kr(e.onPointerUp,Ze=>{const Qe=Q.current,st=Ze.target;if(st.hasPointerCapture(Ze.pointerId)&&st.releasePointerCapture(Ze.pointerId),Q.current=null,J.current=null,Qe){const ot=Ze.currentTarget,Be={originalEvent:Ze,delta:Qe};iq(Qe,B.swipeDirection,B.swipeThreshold)?fC(fge,F,Be,{discrete:!0}):fC(hge,I,Be,{discrete:!0}),ot.addEventListener("click",lt=>lt.preventDefault(),{once:!0})}})})})}),B.viewport)})]}):null}),yge=e=>{const{__scopeToast:t,children:r,...n}=e,a=yk(vk,t),[l,h]=ne.useState(!1),[i,_]=ne.useState(!1);return xge(()=>h(!0)),ne.useEffect(()=>{const b=window.setTimeout(()=>_(!0),1e3);return()=>window.clearTimeout(b)},[]),i?null:j.jsx(ME,{asChild:!0,children:j.jsx(PE,{...n,children:l&&j.jsxs(j.Fragment,{children:[a.label," ",r]})})})},vge="ToastTitle",aQ=ne.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return j.jsx(Mn.div,{...n,ref:t})});aQ.displayName=vge;var _ge="ToastDescription",sQ=ne.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return j.jsx(Mn.div,{...n,ref:t})});sQ.displayName=_ge;var lQ="ToastAction",cQ=ne.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?j.jsx(dQ,{altText:r,asChild:!0,children:j.jsx(t5,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${lQ}\`. Expected non-empty \`string\`.`),null)});cQ.displayName=lQ;var uQ="ToastClose",t5=ne.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=mge(uQ,r);return j.jsx(dQ,{asChild:!0,children:j.jsx(Mn.button,{type:"button",...n,ref:t,onClick:Kr(e.onClick,a.onClose)})})});t5.displayName=uQ;var dQ=ne.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return j.jsx(Mn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function hQ(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),bge(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",l=n.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const h=n.dataset.radixToastAnnounceAlt;h&&t.push(h)}else t.push(...hQ(n))}}),t}function fC(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,l=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?YJ(a,l):a.dispatchEvent(l)}var iq=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),l=n>a;return t==="left"||t==="right"?l&&n>r:!l&&a>r};function xge(e=()=>{}){const t=Al(e);ms(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function bge(e){return e.nodeType===e.ELEMENT_NODE}function wge(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function M3(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Sge=tQ,fQ=nQ,pQ=oQ,mQ=aQ,gQ=sQ,yQ=cQ,vQ=t5;function _Q(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=_Q(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function gi(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=_Q(e))&&(n&&(n+=" "),n+=t);return n}const oq=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,aq=gi,Wx=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return aq(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:l}=t,h=Object.keys(a).map(b=>{const E=r==null?void 0:r[b],C=l==null?void 0:l[b];if(E===null)return null;const I=oq(E)||oq(C);return a[b][I]}),i=r&&Object.entries(r).reduce((b,E)=>{let[C,I]=E;return I===void 0||(b[C]=I),b},{}),_=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((b,E)=>{let{class:C,className:I,...F}=E;return Object.entries(F).every($=>{let[B,q]=$;return Array.isArray(q)?q.includes({...l,...i}[B]):{...l,...i}[B]===q})?[...b,C,I]:b},[]);return aq(e,h,_,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tge=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xQ=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ege={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Age=ne.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:h,...i},_)=>ne.createElement("svg",{ref:_,...Ege,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:xQ("lucide",a),...i},[...h.map(([b,E])=>ne.createElement(b,E)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=(e,t)=>{const r=ne.forwardRef(({className:n,...a},l)=>ne.createElement(Age,{ref:l,iconNode:t,className:xQ(`lucide-${Tge(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=Dn("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=Dn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mge=Dn("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sq=Dn("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pge=Dn("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ige=Dn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bQ=Dn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oge=Dn("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wQ=Dn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=Dn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=Dn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=Dn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kge=Dn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SQ=Dn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rge=Dn("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dge=Dn("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lq=Dn("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lge=Dn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=Dn("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=Dn("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nge=Dn("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cq=Dn("FileBox",[["path",{d:"M14.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"16lz6z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 13.1a2 2 0 0 0-1 1.76v3.24a2 2 0 0 0 .97 1.78L6 21.7a2 2 0 0 0 2.03.01L11 19.9a2 2 0 0 0 1-1.76V14.9a2 2 0 0 0-.97-1.78L8 11.3a2 2 0 0 0-2.03-.01Z",key:"99pj1s"}],["path",{d:"M7 17v5",key:"1yj1jh"}],["path",{d:"M11.7 14.2 7 17l-4.7-2.8",key:"1yk8tc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uq=Dn("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TQ=Dn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EQ=Dn("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zge=Dn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dq=Dn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hq=Dn("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jge=Dn("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=Dn("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=Dn("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=Dn("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bge=Dn("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=Dn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=Dn("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=Dn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uge=Dn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vge=Dn("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wge=Dn("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fT=Dn("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fq=Dn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pq=Dn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=Dn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=Dn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),s5="-",Gge=e=>{const t=Hge(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:h=>{const i=h.split(s5);return i[0]===""&&i.length!==1&&i.shift(),AQ(i,t)||qge(h)},getConflictingClassGroupIds:(h,i)=>{const _=r[h]||[];return i&&n[h]?[..._,...n[h]]:_}}},AQ=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?AQ(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(s5);return(h=t.validators.find(({validator:i})=>i(l)))==null?void 0:h.classGroupId},mq=/^\[(.+)\]$/,qge=e=>{if(mq.test(e)){const t=mq.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Hge=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Xge(Object.entries(e.classGroups),r).forEach(([l,h])=>{qz(h,n,l,t)}),n},qz=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:gq(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(Zge(a)){qz(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,h])=>{qz(h,gq(t,l),r,n)})})},gq=(e,t)=>{let r=e;return t.split(s5).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Zge=e=>e.isThemeGetter,Xge=(e,t)=>t?e.map(([r,n])=>{const a=n.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([h,i])=>[t+h,i])):l);return[r,a]}):e,Yge=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(l,h)=>{r.set(l,h),t++,t>e&&(t=0,n=r,r=new Map)};return{get(l){let h=r.get(l);if(h!==void 0)return h;if((h=n.get(l))!==void 0)return a(l,h),h},set(l,h){r.has(l)?r.set(l,h):a(l,h)}}},CQ="!",Kge=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],l=t.length,h=i=>{const _=[];let b=0,E=0,C;for(let q=0;q<i.length;q++){let G=i[q];if(b===0){if(G===a&&(n||i.slice(q,q+l)===t)){_.push(i.slice(E,q)),E=q+l;continue}if(G==="/"){C=q;continue}}G==="["?b++:G==="]"&&b--}const I=_.length===0?i:i.substring(E),F=I.startsWith(CQ),$=F?I.substring(1):I,B=C&&C>E?C-E:void 0;return{modifiers:_,hasImportantModifier:F,baseClassName:$,maybePostfixModifierPosition:B}};return r?i=>r({className:i,parseClassName:h}):h},Jge=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Qge=e=>({cache:Yge(e.cacheSize),parseClassName:Kge(e),...Gge(e)}),eye=/\s+/,tye=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,l=[],h=e.trim().split(eye);let i="";for(let _=h.length-1;_>=0;_-=1){const b=h[_],{modifiers:E,hasImportantModifier:C,baseClassName:I,maybePostfixModifierPosition:F}=r(b);let $=!!F,B=n($?I.substring(0,F):I);if(!B){if(!$){i=b+(i.length>0?" "+i:i);continue}if(B=n(I),!B){i=b+(i.length>0?" "+i:i);continue}$=!1}const q=Jge(E).join(":"),G=C?q+CQ:q,H=G+B;if(l.includes(H))continue;l.push(H);const J=a(B,$);for(let Q=0;Q<J.length;++Q){const oe=J[Q];l.push(G+oe)}i=b+(i.length>0?" "+i:i)}return i};function rye(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=MQ(t))&&(n&&(n+=" "),n+=r);return n}const MQ=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=MQ(e[n]))&&(r&&(r+=" "),r+=t);return r};function nye(e,...t){let r,n,a,l=h;function h(_){const b=t.reduce((E,C)=>C(E),e());return r=Qge(b),n=r.cache.get,a=r.cache.set,l=i,i(_)}function i(_){const b=n(_);if(b)return b;const E=tye(_,r);return a(_,E),E}return function(){return l(rye.apply(null,arguments))}}const uo=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},PQ=/^\[(?:([a-z-]+):)?(.+)\]$/i,iye=/^\d+\/\d+$/,oye=new Set(["px","full","screen"]),aye=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sye=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,lye=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,cye=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,uye=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ph=e=>S0(e)||oye.has(e)||iye.test(e),pp=e=>Gx(e,"length",vye),S0=e=>!!e&&!Number.isNaN(Number(e)),P3=e=>Gx(e,"number",S0),ww=e=>!!e&&Number.isInteger(Number(e)),dye=e=>e.endsWith("%")&&S0(e.slice(0,-1)),zn=e=>PQ.test(e),mp=e=>aye.test(e),hye=new Set(["length","size","percentage"]),fye=e=>Gx(e,hye,IQ),pye=e=>Gx(e,"position",IQ),mye=new Set(["image","url"]),gye=e=>Gx(e,mye,xye),yye=e=>Gx(e,"",_ye),Sw=()=>!0,Gx=(e,t,r)=>{const n=PQ.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},vye=e=>sye.test(e)&&!lye.test(e),IQ=()=>!1,_ye=e=>cye.test(e),xye=e=>uye.test(e),bye=()=>{const e=uo("colors"),t=uo("spacing"),r=uo("blur"),n=uo("brightness"),a=uo("borderColor"),l=uo("borderRadius"),h=uo("borderSpacing"),i=uo("borderWidth"),_=uo("contrast"),b=uo("grayscale"),E=uo("hueRotate"),C=uo("invert"),I=uo("gap"),F=uo("gradientColorStops"),$=uo("gradientColorStopPositions"),B=uo("inset"),q=uo("margin"),G=uo("opacity"),H=uo("padding"),J=uo("saturate"),Q=uo("scale"),oe=uo("sepia"),de=uo("skew"),ae=uo("space"),ve=uo("translate"),Fe=()=>["auto","contain","none"],ke=()=>["auto","hidden","clip","visible","scroll"],Ce=()=>["auto",zn,t],je=()=>[zn,t],tt=()=>["",ph,pp],Ze=()=>["auto",S0,zn],Qe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],st=()=>["solid","dashed","dotted","double","none"],ot=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Be=()=>["start","end","center","between","around","evenly","stretch"],lt=()=>["","0",zn],zt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Lt=()=>[S0,zn];return{cacheSize:500,separator:":",theme:{colors:[Sw],spacing:[ph,pp],blur:["none","",mp,zn],brightness:Lt(),borderColor:[e],borderRadius:["none","","full",mp,zn],borderSpacing:je(),borderWidth:tt(),contrast:Lt(),grayscale:lt(),hueRotate:Lt(),invert:lt(),gap:je(),gradientColorStops:[e],gradientColorStopPositions:[dye,pp],inset:Ce(),margin:Ce(),opacity:Lt(),padding:je(),saturate:Lt(),scale:Lt(),sepia:lt(),skew:Lt(),space:je(),translate:je()},classGroups:{aspect:[{aspect:["auto","square","video",zn]}],container:["container"],columns:[{columns:[mp]}],"break-after":[{"break-after":zt()}],"break-before":[{"break-before":zt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Qe(),zn]}],overflow:[{overflow:ke()}],"overflow-x":[{"overflow-x":ke()}],"overflow-y":[{"overflow-y":ke()}],overscroll:[{overscroll:Fe()}],"overscroll-x":[{"overscroll-x":Fe()}],"overscroll-y":[{"overscroll-y":Fe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[B]}],"inset-x":[{"inset-x":[B]}],"inset-y":[{"inset-y":[B]}],start:[{start:[B]}],end:[{end:[B]}],top:[{top:[B]}],right:[{right:[B]}],bottom:[{bottom:[B]}],left:[{left:[B]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ww,zn]}],basis:[{basis:Ce()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",zn]}],grow:[{grow:lt()}],shrink:[{shrink:lt()}],order:[{order:["first","last","none",ww,zn]}],"grid-cols":[{"grid-cols":[Sw]}],"col-start-end":[{col:["auto",{span:["full",ww,zn]},zn]}],"col-start":[{"col-start":Ze()}],"col-end":[{"col-end":Ze()}],"grid-rows":[{"grid-rows":[Sw]}],"row-start-end":[{row:["auto",{span:[ww,zn]},zn]}],"row-start":[{"row-start":Ze()}],"row-end":[{"row-end":Ze()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",zn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",zn]}],gap:[{gap:[I]}],"gap-x":[{"gap-x":[I]}],"gap-y":[{"gap-y":[I]}],"justify-content":[{justify:["normal",...Be()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Be(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Be(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[H]}],px:[{px:[H]}],py:[{py:[H]}],ps:[{ps:[H]}],pe:[{pe:[H]}],pt:[{pt:[H]}],pr:[{pr:[H]}],pb:[{pb:[H]}],pl:[{pl:[H]}],m:[{m:[q]}],mx:[{mx:[q]}],my:[{my:[q]}],ms:[{ms:[q]}],me:[{me:[q]}],mt:[{mt:[q]}],mr:[{mr:[q]}],mb:[{mb:[q]}],ml:[{ml:[q]}],"space-x":[{"space-x":[ae]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ae]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",zn,t]}],"min-w":[{"min-w":[zn,t,"min","max","fit"]}],"max-w":[{"max-w":[zn,t,"none","full","min","max","fit","prose",{screen:[mp]},mp]}],h:[{h:[zn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[zn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[zn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[zn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",mp,pp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",P3]}],"font-family":[{font:[Sw]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",zn]}],"line-clamp":[{"line-clamp":["none",S0,P3]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ph,zn]}],"list-image":[{"list-image":["none",zn]}],"list-style-type":[{list:["none","disc","decimal",zn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[G]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[G]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...st(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ph,pp]}],"underline-offset":[{"underline-offset":["auto",ph,zn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:je()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",zn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",zn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[G]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Qe(),pye]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",fye]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},gye]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[$]}],"gradient-via-pos":[{via:[$]}],"gradient-to-pos":[{to:[$]}],"gradient-from":[{from:[F]}],"gradient-via":[{via:[F]}],"gradient-to":[{to:[F]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[G]}],"border-style":[{border:[...st(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[G]}],"divide-style":[{divide:st()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...st()]}],"outline-offset":[{"outline-offset":[ph,zn]}],"outline-w":[{outline:[ph,pp]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:tt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[G]}],"ring-offset-w":[{"ring-offset":[ph,pp]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",mp,yye]}],"shadow-color":[{shadow:[Sw]}],opacity:[{opacity:[G]}],"mix-blend":[{"mix-blend":[...ot(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ot()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[_]}],"drop-shadow":[{"drop-shadow":["","none",mp,zn]}],grayscale:[{grayscale:[b]}],"hue-rotate":[{"hue-rotate":[E]}],invert:[{invert:[C]}],saturate:[{saturate:[J]}],sepia:[{sepia:[oe]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[_]}],"backdrop-grayscale":[{"backdrop-grayscale":[b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[E]}],"backdrop-invert":[{"backdrop-invert":[C]}],"backdrop-opacity":[{"backdrop-opacity":[G]}],"backdrop-saturate":[{"backdrop-saturate":[J]}],"backdrop-sepia":[{"backdrop-sepia":[oe]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",zn]}],duration:[{duration:Lt()}],ease:[{ease:["linear","in","out","in-out",zn]}],delay:[{delay:Lt()}],animate:[{animate:["none","spin","ping","pulse","bounce",zn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Q]}],"scale-x":[{"scale-x":[Q]}],"scale-y":[{"scale-y":[Q]}],rotate:[{rotate:[ww,zn]}],"translate-x":[{"translate-x":[ve]}],"translate-y":[{"translate-y":[ve]}],"skew-x":[{"skew-x":[de]}],"skew-y":[{"skew-y":[de]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",zn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",zn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":je()}],"scroll-mx":[{"scroll-mx":je()}],"scroll-my":[{"scroll-my":je()}],"scroll-ms":[{"scroll-ms":je()}],"scroll-me":[{"scroll-me":je()}],"scroll-mt":[{"scroll-mt":je()}],"scroll-mr":[{"scroll-mr":je()}],"scroll-mb":[{"scroll-mb":je()}],"scroll-ml":[{"scroll-ml":je()}],"scroll-p":[{"scroll-p":je()}],"scroll-px":[{"scroll-px":je()}],"scroll-py":[{"scroll-py":je()}],"scroll-ps":[{"scroll-ps":je()}],"scroll-pe":[{"scroll-pe":je()}],"scroll-pt":[{"scroll-pt":je()}],"scroll-pr":[{"scroll-pr":je()}],"scroll-pb":[{"scroll-pb":je()}],"scroll-pl":[{"scroll-pl":je()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",zn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ph,pp,P3]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},wye=nye(bye);function Tr(...e){return wye(gi(e))}const Sye=Sge,OQ=ne.forwardRef(({className:e,...t},r)=>j.jsx(fQ,{ref:r,className:Tr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));OQ.displayName=fQ.displayName;const Tye=Wx("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),kQ=ne.forwardRef(({className:e,variant:t,...r},n)=>j.jsx(pQ,{ref:n,className:Tr(Tye({variant:t}),e),...r}));kQ.displayName=pQ.displayName;const Eye=ne.forwardRef(({className:e,...t},r)=>j.jsx(yQ,{ref:r,className:Tr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));Eye.displayName=yQ.displayName;const RQ=ne.forwardRef(({className:e,...t},r)=>j.jsx(vQ,{ref:r,className:Tr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:j.jsx(a5,{className:"h-4 w-4"})}));RQ.displayName=vQ.displayName;const DQ=ne.forwardRef(({className:e,...t},r)=>j.jsx(mQ,{ref:r,className:Tr("text-sm font-semibold",e),...t}));DQ.displayName=mQ.displayName;const LQ=ne.forwardRef(({className:e,...t},r)=>j.jsx(gQ,{ref:r,className:Tr("text-sm opacity-90",e),...t}));LQ.displayName=gQ.displayName;function Aye(){const{toasts:e}=Xy();return j.jsxs(Sye,{children:[e.map(function({id:t,title:r,description:n,action:a,...l}){return j.jsxs(kQ,{...l,children:[j.jsxs("div",{className:"grid gap-1",children:[r&&j.jsx(DQ,{children:r}),n&&j.jsx(LQ,{children:n})]}),a,j.jsx(RQ,{})]},t)}),j.jsx(OQ,{})]})}var yq=["light","dark"],Cye="(prefers-color-scheme: dark)",Mye=ne.createContext(void 0),Pye={setTheme:e=>{},themes:[]},Iye=()=>{var e;return(e=ne.useContext(Mye))!=null?e:Pye};ne.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:l,value:h,attrs:i,nonce:_})=>{let b=l==="system",E=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${i.map($=>`'${$}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,C=a?yq.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",I=($,B=!1,q=!0)=>{let G=h?h[$]:$,H=B?$+"|| ''":`'${G}'`,J="";return a&&q&&!B&&yq.includes($)&&(J+=`d.style.colorScheme = '${$}';`),r==="class"?B||G?J+=`c.add(${H})`:J+="null":G&&(J+=`d[s](n,${H})`),J},F=e?`!function(){${E}${I(e)}}()`:n?`!function(){try{${E}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${b})){var t='${Cye}',m=window.matchMedia(t);if(m.media!==t||m.matches){${I("dark")}}else{${I("light")}}}else if(e){${h?`var x=${JSON.stringify(h)};`:""}${I(h?"x[e]":"e",!0)}}${b?"":"else{"+I(l,!1,!1)+"}"}${C}}catch(e){}}()`:`!function(){try{${E}var e=localStorage.getItem('${t}');if(e){${h?`var x=${JSON.stringify(h)};`:""}${I(h?"x[e]":"e",!0)}}else{${I(l,!1,!1)};}${C}}catch(t){}}();`;return ne.createElement("script",{nonce:_,dangerouslySetInnerHTML:{__html:F}})});var Oye=e=>{switch(e){case"success":return Dye;case"info":return Nye;case"warning":return Lye;case"error":return zye;default:return null}},kye=Array(12).fill(0),Rye=({visible:e})=>Ae.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},Ae.createElement("div",{className:"sonner-spinner"},kye.map((t,r)=>Ae.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),Dye=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Lye=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Nye=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),zye=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),jye=()=>{let[e,t]=Ae.useState(document.hidden);return Ae.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Hz=1,Fye=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Hz++,l=this.toasts.find(i=>i.id===a),h=e.dismissible===void 0?!0:e.dismissible;return l?this.toasts=this.toasts.map(i=>i.id===a?(this.publish({...i,...e,id:a,title:r}),{...i,...e,id:a,dismissible:h,title:r}):i):this.addToast({title:r,...n,dismissible:h,id:a}),a},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),a=r!==void 0;return n.then(async l=>{if($ye(l)&&!l.ok){a=!1;let h=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,i=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:h,description:i})}else if(t.success!==void 0){a=!1;let h=typeof t.success=="function"?await t.success(l):t.success,i=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:h,description:i})}}).catch(async l=>{if(t.error!==void 0){a=!1;let h=typeof t.error=="function"?await t.error(l):t.error,i=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:h,description:i})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),r},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Hz++;return this.create({jsx:e(r),id:r,...t}),r},this.subscribers=[],this.toasts=[]}},Ul=new Fye,Bye=(e,t)=>{let r=(t==null?void 0:t.id)||Hz++;return Ul.addToast({title:e,...t,id:r}),r},$ye=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Uye=Bye,Vye=()=>Ul.toasts,Md=Object.assign(Uye,{success:Ul.success,info:Ul.info,warning:Ul.warning,error:Ul.error,custom:Ul.custom,message:Ul.message,promise:Ul.promise,dismiss:Ul.dismiss,loading:Ul.loading},{getHistory:Vye});function Wye(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Wye(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function pC(e){return e.label!==void 0}var Gye=3,qye="32px",Hye=4e3,Zye=356,Xye=14,Yye=20,Kye=200;function Jye(...e){return e.filter(Boolean).join(" ")}var Qye=e=>{var t,r,n,a,l,h,i,_,b,E;let{invert:C,toast:I,unstyled:F,interacting:$,setHeights:B,visibleToasts:q,heights:G,index:H,toasts:J,expanded:Q,removeToast:oe,defaultRichColors:de,closeButton:ae,style:ve,cancelButtonStyle:Fe,actionButtonStyle:ke,className:Ce="",descriptionClassName:je="",duration:tt,position:Ze,gap:Qe,loadingIcon:st,expandByDefault:ot,classNames:Be,icons:lt,closeButtonAriaLabel:zt="Close toast",pauseWhenPageIsHidden:Lt,cn:Bt}=e,[ct,nr]=Ae.useState(!1),[mr,ir]=Ae.useState(!1),[Ut,hr]=Ae.useState(!1),[Vt,ge]=Ae.useState(!1),[ur,Ot]=Ae.useState(0),[tr,xt]=Ae.useState(0),un=Ae.useRef(null),Fr=Ae.useRef(null),Ln=H===0,Ge=H+1<=q,vt=I.type,kt=I.dismissible!==!1,fr=I.className||"",dr=I.descriptionClassName||"",ar=Ae.useMemo(()=>G.findIndex(Wt=>Wt.toastId===I.id)||0,[G,I.id]),Yt=Ae.useMemo(()=>{var Wt;return(Wt=I.closeButton)!=null?Wt:ae},[I.closeButton,ae]),Zr=Ae.useMemo(()=>I.duration||tt||Hye,[I.duration,tt]),oi=Ae.useRef(0),Bn=Ae.useRef(0),Ti=Ae.useRef(0),So=Ae.useRef(null),[Wo,la]=Ze.split("-"),ys=Ae.useMemo(()=>G.reduce((Wt,Hr,Xr)=>Xr>=ar?Wt:Wt+Hr.height,0),[G,ar]),Ba=jye(),vs=I.invert||C,go=vt==="loading";Bn.current=Ae.useMemo(()=>ar*Qe+ys,[ar,ys]),Ae.useEffect(()=>{nr(!0)},[]),Ae.useLayoutEffect(()=>{if(!ct)return;let Wt=Fr.current,Hr=Wt.style.height;Wt.style.height="auto";let Xr=Wt.getBoundingClientRect().height;Wt.style.height=Hr,xt(Xr),B(cn=>cn.find(fn=>fn.toastId===I.id)?cn.map(fn=>fn.toastId===I.id?{...fn,height:Xr}:fn):[{toastId:I.id,height:Xr,position:I.position},...cn])},[ct,I.title,I.description,B,I.id]);let ca=Ae.useCallback(()=>{ir(!0),Ot(Bn.current),B(Wt=>Wt.filter(Hr=>Hr.toastId!==I.id)),setTimeout(()=>{oe(I)},Kye)},[I,oe,B,Bn]);Ae.useEffect(()=>{if(I.promise&&vt==="loading"||I.duration===1/0||I.type==="loading")return;let Wt,Hr=Zr;return Q||$||Lt&&Ba?(()=>{if(Ti.current<oi.current){let Xr=new Date().getTime()-oi.current;Hr=Hr-Xr}Ti.current=new Date().getTime()})():Hr!==1/0&&(oi.current=new Date().getTime(),Wt=setTimeout(()=>{var Xr;(Xr=I.onAutoClose)==null||Xr.call(I,I),ca()},Hr)),()=>clearTimeout(Wt)},[Q,$,ot,I,Zr,ca,I.promise,vt,Lt,Ba]),Ae.useEffect(()=>{let Wt=Fr.current;if(Wt){let Hr=Wt.getBoundingClientRect().height;return xt(Hr),B(Xr=>[{toastId:I.id,height:Hr,position:I.position},...Xr]),()=>B(Xr=>Xr.filter(cn=>cn.toastId!==I.id))}},[B,I.id]),Ae.useEffect(()=>{I.delete&&ca()},[ca,I.delete]);function ai(){return lt!=null&&lt.loading?Ae.createElement("div",{className:"sonner-loader","data-visible":vt==="loading"},lt.loading):st?Ae.createElement("div",{className:"sonner-loader","data-visible":vt==="loading"},st):Ae.createElement(Rye,{visible:vt==="loading"})}return Ae.createElement("li",{"aria-live":I.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Fr,className:Bt(Ce,fr,Be==null?void 0:Be.toast,(t=I==null?void 0:I.classNames)==null?void 0:t.toast,Be==null?void 0:Be.default,Be==null?void 0:Be[vt],(r=I==null?void 0:I.classNames)==null?void 0:r[vt]),"data-sonner-toast":"","data-rich-colors":(n=I.richColors)!=null?n:de,"data-styled":!(I.jsx||I.unstyled||F),"data-mounted":ct,"data-promise":!!I.promise,"data-removed":mr,"data-visible":Ge,"data-y-position":Wo,"data-x-position":la,"data-index":H,"data-front":Ln,"data-swiping":Ut,"data-dismissible":kt,"data-type":vt,"data-invert":vs,"data-swipe-out":Vt,"data-expanded":!!(Q||ot&&ct),style:{"--index":H,"--toasts-before":H,"--z-index":J.length-H,"--offset":`${mr?ur:Bn.current}px`,"--initial-height":ot?"auto":`${tr}px`,...ve,...I.style},onPointerDown:Wt=>{go||!kt||(un.current=new Date,Ot(Bn.current),Wt.target.setPointerCapture(Wt.pointerId),Wt.target.tagName!=="BUTTON"&&(hr(!0),So.current={x:Wt.clientX,y:Wt.clientY}))},onPointerUp:()=>{var Wt,Hr,Xr,cn;if(Vt||!kt)return;So.current=null;let fn=Number(((Wt=Fr.current)==null?void 0:Wt.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ao=new Date().getTime()-((Hr=un.current)==null?void 0:Hr.getTime()),Xi=Math.abs(fn)/ao;if(Math.abs(fn)>=Yye||Xi>.11){Ot(Bn.current),(Xr=I.onDismiss)==null||Xr.call(I,I),ca(),ge(!0);return}(cn=Fr.current)==null||cn.style.setProperty("--swipe-amount","0px"),hr(!1)},onPointerMove:Wt=>{var Hr;if(!So.current||!kt)return;let Xr=Wt.clientY-So.current.y,cn=Wt.clientX-So.current.x,fn=(Wo==="top"?Math.min:Math.max)(0,Xr),ao=Wt.pointerType==="touch"?10:2;Math.abs(fn)>ao?(Hr=Fr.current)==null||Hr.style.setProperty("--swipe-amount",`${Xr}px`):Math.abs(cn)>ao&&(So.current=null)}},Yt&&!I.jsx?Ae.createElement("button",{"aria-label":zt,"data-disabled":go,"data-close-button":!0,onClick:go||!kt?()=>{}:()=>{var Wt;ca(),(Wt=I.onDismiss)==null||Wt.call(I,I)},className:Bt(Be==null?void 0:Be.closeButton,(a=I==null?void 0:I.classNames)==null?void 0:a.closeButton)},Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ae.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ae.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,I.jsx||Ae.isValidElement(I.title)?I.jsx||I.title:Ae.createElement(Ae.Fragment,null,vt||I.icon||I.promise?Ae.createElement("div",{"data-icon":"",className:Bt(Be==null?void 0:Be.icon,(l=I==null?void 0:I.classNames)==null?void 0:l.icon)},I.promise||I.type==="loading"&&!I.icon?I.icon||ai():null,I.type!=="loading"?I.icon||(lt==null?void 0:lt[vt])||Oye(vt):null):null,Ae.createElement("div",{"data-content":"",className:Bt(Be==null?void 0:Be.content,(h=I==null?void 0:I.classNames)==null?void 0:h.content)},Ae.createElement("div",{"data-title":"",className:Bt(Be==null?void 0:Be.title,(i=I==null?void 0:I.classNames)==null?void 0:i.title)},I.title),I.description?Ae.createElement("div",{"data-description":"",className:Bt(je,dr,Be==null?void 0:Be.description,(_=I==null?void 0:I.classNames)==null?void 0:_.description)},I.description):null),Ae.isValidElement(I.cancel)?I.cancel:I.cancel&&pC(I.cancel)?Ae.createElement("button",{"data-button":!0,"data-cancel":!0,style:I.cancelButtonStyle||Fe,onClick:Wt=>{var Hr,Xr;pC(I.cancel)&&kt&&((Xr=(Hr=I.cancel).onClick)==null||Xr.call(Hr,Wt),ca())},className:Bt(Be==null?void 0:Be.cancelButton,(b=I==null?void 0:I.classNames)==null?void 0:b.cancelButton)},I.cancel.label):null,Ae.isValidElement(I.action)?I.action:I.action&&pC(I.action)?Ae.createElement("button",{"data-button":!0,"data-action":!0,style:I.actionButtonStyle||ke,onClick:Wt=>{var Hr,Xr;pC(I.action)&&(Wt.defaultPrevented||((Xr=(Hr=I.action).onClick)==null||Xr.call(Hr,Wt),ca()))},className:Bt(Be==null?void 0:Be.actionButton,(E=I==null?void 0:I.classNames)==null?void 0:E.actionButton)},I.action.label):null))};function vq(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var eve=e=>{let{invert:t,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:a,closeButton:l,className:h,offset:i,theme:_="light",richColors:b,duration:E,style:C,visibleToasts:I=Gye,toastOptions:F,dir:$=vq(),gap:B=Xye,loadingIcon:q,icons:G,containerAriaLabel:H="Notifications",pauseWhenPageIsHidden:J,cn:Q=Jye}=e,[oe,de]=Ae.useState([]),ae=Ae.useMemo(()=>Array.from(new Set([r].concat(oe.filter(Lt=>Lt.position).map(Lt=>Lt.position)))),[oe,r]),[ve,Fe]=Ae.useState([]),[ke,Ce]=Ae.useState(!1),[je,tt]=Ae.useState(!1),[Ze,Qe]=Ae.useState(_!=="system"?_:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),st=Ae.useRef(null),ot=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),Be=Ae.useRef(null),lt=Ae.useRef(!1),zt=Ae.useCallback(Lt=>{var Bt;(Bt=oe.find(ct=>ct.id===Lt.id))!=null&&Bt.delete||Ul.dismiss(Lt.id),de(ct=>ct.filter(({id:nr})=>nr!==Lt.id))},[oe]);return Ae.useEffect(()=>Ul.subscribe(Lt=>{if(Lt.dismiss){de(Bt=>Bt.map(ct=>ct.id===Lt.id?{...ct,delete:!0}:ct));return}setTimeout(()=>{qJ.flushSync(()=>{de(Bt=>{let ct=Bt.findIndex(nr=>nr.id===Lt.id);return ct!==-1?[...Bt.slice(0,ct),{...Bt[ct],...Lt},...Bt.slice(ct+1)]:[Lt,...Bt]})})})}),[]),Ae.useEffect(()=>{if(_!=="system"){Qe(_);return}_==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Qe("dark"):Qe("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:Lt})=>{Qe(Lt?"dark":"light")})},[_]),Ae.useEffect(()=>{oe.length<=1&&Ce(!1)},[oe]),Ae.useEffect(()=>{let Lt=Bt=>{var ct,nr;n.every(mr=>Bt[mr]||Bt.code===mr)&&(Ce(!0),(ct=st.current)==null||ct.focus()),Bt.code==="Escape"&&(document.activeElement===st.current||(nr=st.current)!=null&&nr.contains(document.activeElement))&&Ce(!1)};return document.addEventListener("keydown",Lt),()=>document.removeEventListener("keydown",Lt)},[n]),Ae.useEffect(()=>{if(st.current)return()=>{Be.current&&(Be.current.focus({preventScroll:!0}),Be.current=null,lt.current=!1)}},[st.current]),oe.length?Ae.createElement("section",{"aria-label":`${H} ${ot}`,tabIndex:-1},ae.map((Lt,Bt)=>{var ct;let[nr,mr]=Lt.split("-");return Ae.createElement("ol",{key:Lt,dir:$==="auto"?vq():$,tabIndex:-1,ref:st,className:h,"data-sonner-toaster":!0,"data-theme":Ze,"data-y-position":nr,"data-x-position":mr,style:{"--front-toast-height":`${((ct=ve[0])==null?void 0:ct.height)||0}px`,"--offset":typeof i=="number"?`${i}px`:i||qye,"--width":`${Zye}px`,"--gap":`${B}px`,...C},onBlur:ir=>{lt.current&&!ir.currentTarget.contains(ir.relatedTarget)&&(lt.current=!1,Be.current&&(Be.current.focus({preventScroll:!0}),Be.current=null))},onFocus:ir=>{ir.target instanceof HTMLElement&&ir.target.dataset.dismissible==="false"||lt.current||(lt.current=!0,Be.current=ir.relatedTarget)},onMouseEnter:()=>Ce(!0),onMouseMove:()=>Ce(!0),onMouseLeave:()=>{je||Ce(!1)},onPointerDown:ir=>{ir.target instanceof HTMLElement&&ir.target.dataset.dismissible==="false"||tt(!0)},onPointerUp:()=>tt(!1)},oe.filter(ir=>!ir.position&&Bt===0||ir.position===Lt).map((ir,Ut)=>{var hr,Vt;return Ae.createElement(Qye,{key:ir.id,icons:G,index:Ut,toast:ir,defaultRichColors:b,duration:(hr=F==null?void 0:F.duration)!=null?hr:E,className:F==null?void 0:F.className,descriptionClassName:F==null?void 0:F.descriptionClassName,invert:t,visibleToasts:I,closeButton:(Vt=F==null?void 0:F.closeButton)!=null?Vt:l,interacting:je,position:Lt,style:F==null?void 0:F.style,unstyled:F==null?void 0:F.unstyled,classNames:F==null?void 0:F.classNames,cancelButtonStyle:F==null?void 0:F.cancelButtonStyle,actionButtonStyle:F==null?void 0:F.actionButtonStyle,removeToast:zt,toasts:oe.filter(ge=>ge.position==ir.position),heights:ve.filter(ge=>ge.position==ir.position),setHeights:Fe,expandByDefault:a,gap:B,loadingIcon:q,expanded:ke,pauseWhenPageIsHidden:J,cn:Q})}))})):null};const tve=({...e})=>{const{theme:t="system"}=Iye();return j.jsx(eve,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var rve=tk.useId||(()=>{}),nve=0;function jh(e){const[t,r]=ne.useState(rve());return ms(()=>{r(n=>n??String(nve++))},[e]),t?`radix-${t}`:""}const ive=["top","right","bottom","left"],ym=Math.min,ql=Math.max,gI=Math.round,mC=Math.floor,vm=e=>({x:e,y:e}),ove={left:"right",right:"left",bottom:"top",top:"bottom"},ave={start:"end",end:"start"};function Zz(e,t,r){return ql(e,ym(t,r))}function Jh(e,t){return typeof e=="function"?e(t):e}function Qh(e){return e.split("-")[0]}function qx(e){return e.split("-")[1]}function l5(e){return e==="x"?"y":"x"}function c5(e){return e==="y"?"height":"width"}function _m(e){return["top","bottom"].includes(Qh(e))?"y":"x"}function u5(e){return l5(_m(e))}function sve(e,t,r){r===void 0&&(r=!1);const n=qx(e),a=u5(e),l=c5(a);let h=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(h=yI(h)),[h,yI(h)]}function lve(e){const t=yI(e);return[Xz(e),t,Xz(t)]}function Xz(e){return e.replace(/start|end/g,t=>ave[t])}function cve(e,t,r){const n=["left","right"],a=["right","left"],l=["top","bottom"],h=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?l:h;default:return[]}}function uve(e,t,r,n){const a=qx(e);let l=cve(Qh(e),r==="start",n);return a&&(l=l.map(h=>h+"-"+a),t&&(l=l.concat(l.map(Xz)))),l}function yI(e){return e.replace(/left|right|bottom|top/g,t=>ove[t])}function dve(e){return{top:0,right:0,bottom:0,left:0,...e}}function NQ(e){return typeof e!="number"?dve(e):{top:e,right:e,bottom:e,left:e}}function vI(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function _q(e,t,r){let{reference:n,floating:a}=e;const l=_m(t),h=u5(t),i=c5(h),_=Qh(t),b=l==="y",E=n.x+n.width/2-a.width/2,C=n.y+n.height/2-a.height/2,I=n[i]/2-a[i]/2;let F;switch(_){case"top":F={x:E,y:n.y-a.height};break;case"bottom":F={x:E,y:n.y+n.height};break;case"right":F={x:n.x+n.width,y:C};break;case"left":F={x:n.x-a.width,y:C};break;default:F={x:n.x,y:n.y}}switch(qx(t)){case"start":F[h]-=I*(r&&b?-1:1);break;case"end":F[h]+=I*(r&&b?-1:1);break}return F}const hve=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:h}=r,i=l.filter(Boolean),_=await(h.isRTL==null?void 0:h.isRTL(t));let b=await h.getElementRects({reference:e,floating:t,strategy:a}),{x:E,y:C}=_q(b,n,_),I=n,F={},$=0;for(let B=0;B<i.length;B++){const{name:q,fn:G}=i[B],{x:H,y:J,data:Q,reset:oe}=await G({x:E,y:C,initialPlacement:n,placement:I,strategy:a,middlewareData:F,rects:b,platform:h,elements:{reference:e,floating:t}});E=H??E,C=J??C,F={...F,[q]:{...F[q],...Q}},oe&&$<=50&&($++,typeof oe=="object"&&(oe.placement&&(I=oe.placement),oe.rects&&(b=oe.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:a}):oe.rects),{x:E,y:C}=_q(b,I,_)),B=-1)}return{x:E,y:C,placement:I,strategy:a,middlewareData:F}};async function pT(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:h,elements:i,strategy:_}=e,{boundary:b="clippingAncestors",rootBoundary:E="viewport",elementContext:C="floating",altBoundary:I=!1,padding:F=0}=Jh(t,e),$=NQ(F),q=i[I?C==="floating"?"reference":"floating":C],G=vI(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(q)))==null||r?q:q.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:b,rootBoundary:E,strategy:_})),H=C==="floating"?{x:n,y:a,width:h.floating.width,height:h.floating.height}:h.reference,J=await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),Q=await(l.isElement==null?void 0:l.isElement(J))?await(l.getScale==null?void 0:l.getScale(J))||{x:1,y:1}:{x:1,y:1},oe=vI(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:H,offsetParent:J,strategy:_}):H);return{top:(G.top-oe.top+$.top)/Q.y,bottom:(oe.bottom-G.bottom+$.bottom)/Q.y,left:(G.left-oe.left+$.left)/Q.x,right:(oe.right-G.right+$.right)/Q.x}}const fve=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:l,platform:h,elements:i,middlewareData:_}=t,{element:b,padding:E=0}=Jh(e,t)||{};if(b==null)return{};const C=NQ(E),I={x:r,y:n},F=u5(a),$=c5(F),B=await h.getDimensions(b),q=F==="y",G=q?"top":"left",H=q?"bottom":"right",J=q?"clientHeight":"clientWidth",Q=l.reference[$]+l.reference[F]-I[F]-l.floating[$],oe=I[F]-l.reference[F],de=await(h.getOffsetParent==null?void 0:h.getOffsetParent(b));let ae=de?de[J]:0;(!ae||!await(h.isElement==null?void 0:h.isElement(de)))&&(ae=i.floating[J]||l.floating[$]);const ve=Q/2-oe/2,Fe=ae/2-B[$]/2-1,ke=ym(C[G],Fe),Ce=ym(C[H],Fe),je=ke,tt=ae-B[$]-Ce,Ze=ae/2-B[$]/2+ve,Qe=Zz(je,Ze,tt),st=!_.arrow&&qx(a)!=null&&Ze!==Qe&&l.reference[$]/2-(Ze<je?ke:Ce)-B[$]/2<0,ot=st?Ze<je?Ze-je:Ze-tt:0;return{[F]:I[F]+ot,data:{[F]:Qe,centerOffset:Ze-Qe-ot,...st&&{alignmentOffset:ot}},reset:st}}}),pve=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:l,rects:h,initialPlacement:i,platform:_,elements:b}=t,{mainAxis:E=!0,crossAxis:C=!0,fallbackPlacements:I,fallbackStrategy:F="bestFit",fallbackAxisSideDirection:$="none",flipAlignment:B=!0,...q}=Jh(e,t);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const G=Qh(a),H=_m(i),J=Qh(i)===i,Q=await(_.isRTL==null?void 0:_.isRTL(b.floating)),oe=I||(J||!B?[yI(i)]:lve(i)),de=$!=="none";!I&&de&&oe.push(...uve(i,B,$,Q));const ae=[i,...oe],ve=await pT(t,q),Fe=[];let ke=((n=l.flip)==null?void 0:n.overflows)||[];if(E&&Fe.push(ve[G]),C){const Ze=sve(a,h,Q);Fe.push(ve[Ze[0]],ve[Ze[1]])}if(ke=[...ke,{placement:a,overflows:Fe}],!Fe.every(Ze=>Ze<=0)){var Ce,je;const Ze=(((Ce=l.flip)==null?void 0:Ce.index)||0)+1,Qe=ae[Ze];if(Qe)return{data:{index:Ze,overflows:ke},reset:{placement:Qe}};let st=(je=ke.filter(ot=>ot.overflows[0]<=0).sort((ot,Be)=>ot.overflows[1]-Be.overflows[1])[0])==null?void 0:je.placement;if(!st)switch(F){case"bestFit":{var tt;const ot=(tt=ke.filter(Be=>{if(de){const lt=_m(Be.placement);return lt===H||lt==="y"}return!0}).map(Be=>[Be.placement,Be.overflows.filter(lt=>lt>0).reduce((lt,zt)=>lt+zt,0)]).sort((Be,lt)=>Be[1]-lt[1])[0])==null?void 0:tt[0];ot&&(st=ot);break}case"initialPlacement":st=i;break}if(a!==st)return{reset:{placement:st}}}return{}}}};function xq(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function bq(e){return ive.some(t=>e[t]>=0)}const mve=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=Jh(e,t);switch(n){case"referenceHidden":{const l=await pT(t,{...a,elementContext:"reference"}),h=xq(l,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:bq(h)}}}case"escaped":{const l=await pT(t,{...a,altBoundary:!0}),h=xq(l,r.floating);return{data:{escapedOffsets:h,escaped:bq(h)}}}default:return{}}}}};async function gve(e,t){const{placement:r,platform:n,elements:a}=e,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),h=Qh(r),i=qx(r),_=_m(r)==="y",b=["left","top"].includes(h)?-1:1,E=l&&_?-1:1,C=Jh(t,e);let{mainAxis:I,crossAxis:F,alignmentAxis:$}=typeof C=="number"?{mainAxis:C,crossAxis:0,alignmentAxis:null}:{mainAxis:C.mainAxis||0,crossAxis:C.crossAxis||0,alignmentAxis:C.alignmentAxis};return i&&typeof $=="number"&&(F=i==="end"?$*-1:$),_?{x:F*E,y:I*b}:{x:I*b,y:F*E}}const yve=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:l,placement:h,middlewareData:i}=t,_=await gve(t,e);return h===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+_.x,y:l+_.y,data:{..._,placement:h}}}}},vve=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:l=!0,crossAxis:h=!1,limiter:i={fn:q=>{let{x:G,y:H}=q;return{x:G,y:H}}},..._}=Jh(e,t),b={x:r,y:n},E=await pT(t,_),C=_m(Qh(a)),I=l5(C);let F=b[I],$=b[C];if(l){const q=I==="y"?"top":"left",G=I==="y"?"bottom":"right",H=F+E[q],J=F-E[G];F=Zz(H,F,J)}if(h){const q=C==="y"?"top":"left",G=C==="y"?"bottom":"right",H=$+E[q],J=$-E[G];$=Zz(H,$,J)}const B=i.fn({...t,[I]:F,[C]:$});return{...B,data:{x:B.x-r,y:B.y-n,enabled:{[I]:l,[C]:h}}}}}},_ve=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:l,middlewareData:h}=t,{offset:i=0,mainAxis:_=!0,crossAxis:b=!0}=Jh(e,t),E={x:r,y:n},C=_m(a),I=l5(C);let F=E[I],$=E[C];const B=Jh(i,t),q=typeof B=="number"?{mainAxis:B,crossAxis:0}:{mainAxis:0,crossAxis:0,...B};if(_){const J=I==="y"?"height":"width",Q=l.reference[I]-l.floating[J]+q.mainAxis,oe=l.reference[I]+l.reference[J]-q.mainAxis;F<Q?F=Q:F>oe&&(F=oe)}if(b){var G,H;const J=I==="y"?"width":"height",Q=["top","left"].includes(Qh(a)),oe=l.reference[C]-l.floating[J]+(Q&&((G=h.offset)==null?void 0:G[C])||0)+(Q?0:q.crossAxis),de=l.reference[C]+l.reference[J]+(Q?0:((H=h.offset)==null?void 0:H[C])||0)-(Q?q.crossAxis:0);$<oe?$=oe:$>de&&($=de)}return{[I]:F,[C]:$}}}},xve=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:l,platform:h,elements:i}=t,{apply:_=()=>{},...b}=Jh(e,t),E=await pT(t,b),C=Qh(a),I=qx(a),F=_m(a)==="y",{width:$,height:B}=l.floating;let q,G;C==="top"||C==="bottom"?(q=C,G=I===(await(h.isRTL==null?void 0:h.isRTL(i.floating))?"start":"end")?"left":"right"):(G=C,q=I==="end"?"top":"bottom");const H=B-E.top-E.bottom,J=$-E.left-E.right,Q=ym(B-E[q],H),oe=ym($-E[G],J),de=!t.middlewareData.shift;let ae=Q,ve=oe;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ve=J),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(ae=H),de&&!I){const ke=ql(E.left,0),Ce=ql(E.right,0),je=ql(E.top,0),tt=ql(E.bottom,0);F?ve=$-2*(ke!==0||Ce!==0?ke+Ce:ql(E.left,E.right)):ae=B-2*(je!==0||tt!==0?je+tt:ql(E.top,E.bottom))}await _({...t,availableWidth:ve,availableHeight:ae});const Fe=await h.getDimensions(i.floating);return $!==Fe.width||B!==Fe.height?{reset:{rects:!0}}:{}}}};function xk(){return typeof window<"u"}function Hx(e){return zQ(e)?(e.nodeName||"").toLowerCase():"#document"}function Ql(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Hd(e){var t;return(t=(zQ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function zQ(e){return xk()?e instanceof Node||e instanceof Ql(e).Node:!1}function zu(e){return xk()?e instanceof Element||e instanceof Ql(e).Element:!1}function Bd(e){return xk()?e instanceof HTMLElement||e instanceof Ql(e).HTMLElement:!1}function wq(e){return!xk()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ql(e).ShadowRoot}function IE(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=ju(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function bve(e){return["table","td","th"].includes(Hx(e))}function bk(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function d5(e){const t=h5(),r=zu(e)?ju(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function wve(e){let t=xm(e);for(;Bd(t)&&!ex(t);){if(d5(t))return t;if(bk(t))return null;t=xm(t)}return null}function h5(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ex(e){return["html","body","#document"].includes(Hx(e))}function ju(e){return Ql(e).getComputedStyle(e)}function wk(e){return zu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function xm(e){if(Hx(e)==="html")return e;const t=e.assignedSlot||e.parentNode||wq(e)&&e.host||Hd(e);return wq(t)?t.host:t}function jQ(e){const t=xm(e);return ex(t)?e.ownerDocument?e.ownerDocument.body:e.body:Bd(t)&&IE(t)?t:jQ(t)}function mT(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=jQ(e),l=a===((n=e.ownerDocument)==null?void 0:n.body),h=Ql(a);if(l){const i=Yz(h);return t.concat(h,h.visualViewport||[],IE(a)?a:[],i&&r?mT(i):[])}return t.concat(a,mT(a,[],r))}function Yz(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function FQ(e){const t=ju(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Bd(e),l=a?e.offsetWidth:r,h=a?e.offsetHeight:n,i=gI(r)!==l||gI(n)!==h;return i&&(r=l,n=h),{width:r,height:n,$:i}}function f5(e){return zu(e)?e:e.contextElement}function T0(e){const t=f5(e);if(!Bd(t))return vm(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:l}=FQ(t);let h=(l?gI(r.width):r.width)/n,i=(l?gI(r.height):r.height)/a;return(!h||!Number.isFinite(h))&&(h=1),(!i||!Number.isFinite(i))&&(i=1),{x:h,y:i}}const Sve=vm(0);function BQ(e){const t=Ql(e);return!h5()||!t.visualViewport?Sve:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Tve(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ql(e)?!1:t}function Oy(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),l=f5(e);let h=vm(1);t&&(n?zu(n)&&(h=T0(n)):h=T0(e));const i=Tve(l,r,n)?BQ(l):vm(0);let _=(a.left+i.x)/h.x,b=(a.top+i.y)/h.y,E=a.width/h.x,C=a.height/h.y;if(l){const I=Ql(l),F=n&&zu(n)?Ql(n):n;let $=I,B=Yz($);for(;B&&n&&F!==$;){const q=T0(B),G=B.getBoundingClientRect(),H=ju(B),J=G.left+(B.clientLeft+parseFloat(H.paddingLeft))*q.x,Q=G.top+(B.clientTop+parseFloat(H.paddingTop))*q.y;_*=q.x,b*=q.y,E*=q.x,C*=q.y,_+=J,b+=Q,$=Ql(B),B=Yz($)}}return vI({width:E,height:C,x:_,y:b})}function Eve(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const l=a==="fixed",h=Hd(n),i=t?bk(t.floating):!1;if(n===h||i&&l)return r;let _={scrollLeft:0,scrollTop:0},b=vm(1);const E=vm(0),C=Bd(n);if((C||!C&&!l)&&((Hx(n)!=="body"||IE(h))&&(_=wk(n)),Bd(n))){const I=Oy(n);b=T0(n),E.x=I.x+n.clientLeft,E.y=I.y+n.clientTop}return{width:r.width*b.x,height:r.height*b.y,x:r.x*b.x-_.scrollLeft*b.x+E.x,y:r.y*b.y-_.scrollTop*b.y+E.y}}function Ave(e){return Array.from(e.getClientRects())}function Kz(e,t){const r=wk(e).scrollLeft;return t?t.left+r:Oy(Hd(e)).left+r}function Cve(e){const t=Hd(e),r=wk(e),n=e.ownerDocument.body,a=ql(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),l=ql(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let h=-r.scrollLeft+Kz(e);const i=-r.scrollTop;return ju(n).direction==="rtl"&&(h+=ql(t.clientWidth,n.clientWidth)-a),{width:a,height:l,x:h,y:i}}function Mve(e,t){const r=Ql(e),n=Hd(e),a=r.visualViewport;let l=n.clientWidth,h=n.clientHeight,i=0,_=0;if(a){l=a.width,h=a.height;const b=h5();(!b||b&&t==="fixed")&&(i=a.offsetLeft,_=a.offsetTop)}return{width:l,height:h,x:i,y:_}}function Pve(e,t){const r=Oy(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,l=Bd(e)?T0(e):vm(1),h=e.clientWidth*l.x,i=e.clientHeight*l.y,_=a*l.x,b=n*l.y;return{width:h,height:i,x:_,y:b}}function Sq(e,t,r){let n;if(t==="viewport")n=Mve(e,r);else if(t==="document")n=Cve(Hd(e));else if(zu(t))n=Pve(t,r);else{const a=BQ(e);n={...t,x:t.x-a.x,y:t.y-a.y}}return vI(n)}function $Q(e,t){const r=xm(e);return r===t||!zu(r)||ex(r)?!1:ju(r).position==="fixed"||$Q(r,t)}function Ive(e,t){const r=t.get(e);if(r)return r;let n=mT(e,[],!1).filter(i=>zu(i)&&Hx(i)!=="body"),a=null;const l=ju(e).position==="fixed";let h=l?xm(e):e;for(;zu(h)&&!ex(h);){const i=ju(h),_=d5(h);!_&&i.position==="fixed"&&(a=null),(l?!_&&!a:!_&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||IE(h)&&!_&&$Q(e,h))?n=n.filter(E=>E!==h):a=i,h=xm(h)}return t.set(e,n),n}function Ove(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const h=[...r==="clippingAncestors"?bk(t)?[]:Ive(t,this._c):[].concat(r),n],i=h[0],_=h.reduce((b,E)=>{const C=Sq(t,E,a);return b.top=ql(C.top,b.top),b.right=ym(C.right,b.right),b.bottom=ym(C.bottom,b.bottom),b.left=ql(C.left,b.left),b},Sq(t,i,a));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function kve(e){const{width:t,height:r}=FQ(e);return{width:t,height:r}}function Rve(e,t,r){const n=Bd(t),a=Hd(t),l=r==="fixed",h=Oy(e,!0,l,t);let i={scrollLeft:0,scrollTop:0};const _=vm(0);if(n||!n&&!l)if((Hx(t)!=="body"||IE(a))&&(i=wk(t)),n){const F=Oy(t,!0,l,t);_.x=F.x+t.clientLeft,_.y=F.y+t.clientTop}else a&&(_.x=Kz(a));let b=0,E=0;if(a&&!n&&!l){const F=a.getBoundingClientRect();E=F.top+i.scrollTop,b=F.left+i.scrollLeft-Kz(a,F)}const C=h.left+i.scrollLeft-_.x-b,I=h.top+i.scrollTop-_.y-E;return{x:C,y:I,width:h.width,height:h.height}}function I3(e){return ju(e).position==="static"}function Tq(e,t){if(!Bd(e)||ju(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Hd(e)===r&&(r=r.ownerDocument.body),r}function UQ(e,t){const r=Ql(e);if(bk(e))return r;if(!Bd(e)){let a=xm(e);for(;a&&!ex(a);){if(zu(a)&&!I3(a))return a;a=xm(a)}return r}let n=Tq(e,t);for(;n&&bve(n)&&I3(n);)n=Tq(n,t);return n&&ex(n)&&I3(n)&&!d5(n)?r:n||wve(e)||r}const Dve=async function(e){const t=this.getOffsetParent||UQ,r=this.getDimensions,n=await r(e.floating);return{reference:Rve(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Lve(e){return ju(e).direction==="rtl"}const Nve={convertOffsetParentRelativeRectToViewportRelativeRect:Eve,getDocumentElement:Hd,getClippingRect:Ove,getOffsetParent:UQ,getElementRects:Dve,getClientRects:Ave,getDimensions:kve,getScale:T0,isElement:zu,isRTL:Lve};function zve(e,t){let r=null,n;const a=Hd(e);function l(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function h(i,_){i===void 0&&(i=!1),_===void 0&&(_=1),l();const{left:b,top:E,width:C,height:I}=e.getBoundingClientRect();if(i||t(),!C||!I)return;const F=mC(E),$=mC(a.clientWidth-(b+C)),B=mC(a.clientHeight-(E+I)),q=mC(b),H={rootMargin:-F+"px "+-$+"px "+-B+"px "+-q+"px",threshold:ql(0,ym(1,_))||1};let J=!0;function Q(oe){const de=oe[0].intersectionRatio;if(de!==_){if(!J)return h();de?h(!1,de):n=setTimeout(()=>{h(!1,1e-7)},1e3)}J=!1}try{r=new IntersectionObserver(Q,{...H,root:a.ownerDocument})}catch{r=new IntersectionObserver(Q,H)}r.observe(e)}return h(!0),l}function jve(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:_=!1}=n,b=f5(e),E=a||l?[...b?mT(b):[],...mT(t)]:[];E.forEach(G=>{a&&G.addEventListener("scroll",r,{passive:!0}),l&&G.addEventListener("resize",r)});const C=b&&i?zve(b,r):null;let I=-1,F=null;h&&(F=new ResizeObserver(G=>{let[H]=G;H&&H.target===b&&F&&(F.unobserve(t),cancelAnimationFrame(I),I=requestAnimationFrame(()=>{var J;(J=F)==null||J.observe(t)})),r()}),b&&!_&&F.observe(b),F.observe(t));let $,B=_?Oy(e):null;_&&q();function q(){const G=Oy(e);B&&(G.x!==B.x||G.y!==B.y||G.width!==B.width||G.height!==B.height)&&r(),B=G,$=requestAnimationFrame(q)}return r(),()=>{var G;E.forEach(H=>{a&&H.removeEventListener("scroll",r),l&&H.removeEventListener("resize",r)}),C==null||C(),(G=F)==null||G.disconnect(),F=null,_&&cancelAnimationFrame($)}}const Fve=yve,Bve=vve,$ve=pve,Uve=xve,Vve=mve,Eq=fve,Wve=_ve,Gve=(e,t,r)=>{const n=new Map,a={platform:Nve,...r},l={...a.platform,_c:n};return hve(e,t,{...a,platform:l})};var uM=typeof document<"u"?ne.useLayoutEffect:ne.useEffect;function _I(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!_I(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const l=a[n];if(!(l==="_owner"&&e.$$typeof)&&!_I(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function VQ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Aq(e,t){const r=VQ(e);return Math.round(t*r)/r}function O3(e){const t=ne.useRef(e);return uM(()=>{t.current=e}),t}function qve(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:h}={},transform:i=!0,whileElementsMounted:_,open:b}=e,[E,C]=ne.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[I,F]=ne.useState(n);_I(I,n)||F(n);const[$,B]=ne.useState(null),[q,G]=ne.useState(null),H=ne.useCallback(Be=>{Be!==de.current&&(de.current=Be,B(Be))},[]),J=ne.useCallback(Be=>{Be!==ae.current&&(ae.current=Be,G(Be))},[]),Q=l||$,oe=h||q,de=ne.useRef(null),ae=ne.useRef(null),ve=ne.useRef(E),Fe=_!=null,ke=O3(_),Ce=O3(a),je=O3(b),tt=ne.useCallback(()=>{if(!de.current||!ae.current)return;const Be={placement:t,strategy:r,middleware:I};Ce.current&&(Be.platform=Ce.current),Gve(de.current,ae.current,Be).then(lt=>{const zt={...lt,isPositioned:je.current!==!1};Ze.current&&!_I(ve.current,zt)&&(ve.current=zt,Zy.flushSync(()=>{C(zt)}))})},[I,t,r,Ce,je]);uM(()=>{b===!1&&ve.current.isPositioned&&(ve.current.isPositioned=!1,C(Be=>({...Be,isPositioned:!1})))},[b]);const Ze=ne.useRef(!1);uM(()=>(Ze.current=!0,()=>{Ze.current=!1}),[]),uM(()=>{if(Q&&(de.current=Q),oe&&(ae.current=oe),Q&&oe){if(ke.current)return ke.current(Q,oe,tt);tt()}},[Q,oe,tt,ke,Fe]);const Qe=ne.useMemo(()=>({reference:de,floating:ae,setReference:H,setFloating:J}),[H,J]),st=ne.useMemo(()=>({reference:Q,floating:oe}),[Q,oe]),ot=ne.useMemo(()=>{const Be={position:r,left:0,top:0};if(!st.floating)return Be;const lt=Aq(st.floating,E.x),zt=Aq(st.floating,E.y);return i?{...Be,transform:"translate("+lt+"px, "+zt+"px)",...VQ(st.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:lt,top:zt}},[r,i,st.floating,E.x,E.y]);return ne.useMemo(()=>({...E,update:tt,refs:Qe,elements:st,floatingStyles:ot}),[E,tt,Qe,st,ot])}const Hve=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Eq({element:n.current,padding:a}).fn(r):{}:n?Eq({element:n,padding:a}).fn(r):{}}}},Zve=(e,t)=>({...Fve(e),options:[e,t]}),Xve=(e,t)=>({...Bve(e),options:[e,t]}),Yve=(e,t)=>({...Wve(e),options:[e,t]}),Kve=(e,t)=>({...$ve(e),options:[e,t]}),Jve=(e,t)=>({...Uve(e),options:[e,t]}),Qve=(e,t)=>({...Vve(e),options:[e,t]}),e_e=(e,t)=>({...Hve(e),options:[e,t]});var t_e="Arrow",WQ=ne.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...l}=e;return j.jsx(Mn.svg,{...l,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:j.jsx("polygon",{points:"0,0 30,0 15,10"})})});WQ.displayName=t_e;var r_e=WQ;function n_e(e,t=[]){let r=[];function n(l,h){const i=ne.createContext(h),_=r.length;r=[...r,h];function b(C){const{scope:I,children:F,...$}=C,B=(I==null?void 0:I[e][_])||i,q=ne.useMemo(()=>$,Object.values($));return j.jsx(B.Provider,{value:q,children:F})}function E(C,I){const F=(I==null?void 0:I[e][_])||i,$=ne.useContext(F);if($)return $;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${l}\``)}return b.displayName=l+"Provider",[b,E]}const a=()=>{const l=r.map(h=>ne.createContext(h));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,i_e(a,...t)]}function i_e(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const h=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function p5(e){const[t,r]=ne.useState(void 0);return ms(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let h,i;if("borderBoxSize"in l){const _=l.borderBoxSize,b=Array.isArray(_)?_[0]:_;h=b.inlineSize,i=b.blockSize}else h=e.offsetWidth,i=e.offsetHeight;r({width:h,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var m5="Popper",[GQ,Zx]=n_e(m5),[o_e,qQ]=GQ(m5),HQ=e=>{const{__scopePopper:t,children:r}=e,[n,a]=ne.useState(null);return j.jsx(o_e,{scope:t,anchor:n,onAnchorChange:a,children:r})};HQ.displayName=m5;var ZQ="PopperAnchor",XQ=ne.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,l=qQ(ZQ,r),h=ne.useRef(null),i=Ci(t,h);return ne.useEffect(()=>{l.onAnchorChange((n==null?void 0:n.current)||h.current)}),n?null:j.jsx(Mn.div,{...a,ref:i})});XQ.displayName=ZQ;var g5="PopperContent",[a_e,s_e]=GQ(g5),YQ=ne.forwardRef((e,t)=>{var Ut,hr,Vt,ge,ur,Ot;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:h=0,arrowPadding:i=0,avoidCollisions:_=!0,collisionBoundary:b=[],collisionPadding:E=0,sticky:C="partial",hideWhenDetached:I=!1,updatePositionStrategy:F="optimized",onPlaced:$,...B}=e,q=qQ(g5,r),[G,H]=ne.useState(null),J=Ci(t,tr=>H(tr)),[Q,oe]=ne.useState(null),de=p5(Q),ae=(de==null?void 0:de.width)??0,ve=(de==null?void 0:de.height)??0,Fe=n+(l!=="center"?"-"+l:""),ke=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},Ce=Array.isArray(b)?b:[b],je=Ce.length>0,tt={padding:ke,boundary:Ce.filter(c_e),altBoundary:je},{refs:Ze,floatingStyles:Qe,placement:st,isPositioned:ot,middlewareData:Be}=qve({strategy:"fixed",placement:Fe,whileElementsMounted:(...tr)=>jve(...tr,{animationFrame:F==="always"}),elements:{reference:q.anchor},middleware:[Zve({mainAxis:a+ve,alignmentAxis:h}),_&&Xve({mainAxis:!0,crossAxis:!1,limiter:C==="partial"?Yve():void 0,...tt}),_&&Kve({...tt}),Jve({...tt,apply:({elements:tr,rects:xt,availableWidth:un,availableHeight:Fr})=>{const{width:Ln,height:Ge}=xt.reference,vt=tr.floating.style;vt.setProperty("--radix-popper-available-width",`${un}px`),vt.setProperty("--radix-popper-available-height",`${Fr}px`),vt.setProperty("--radix-popper-anchor-width",`${Ln}px`),vt.setProperty("--radix-popper-anchor-height",`${Ge}px`)}}),Q&&e_e({element:Q,padding:i}),u_e({arrowWidth:ae,arrowHeight:ve}),I&&Qve({strategy:"referenceHidden",...tt})]}),[lt,zt]=QQ(st),Lt=Al($);ms(()=>{ot&&(Lt==null||Lt())},[ot,Lt]);const Bt=(Ut=Be.arrow)==null?void 0:Ut.x,ct=(hr=Be.arrow)==null?void 0:hr.y,nr=((Vt=Be.arrow)==null?void 0:Vt.centerOffset)!==0,[mr,ir]=ne.useState();return ms(()=>{G&&ir(window.getComputedStyle(G).zIndex)},[G]),j.jsx("div",{ref:Ze.setFloating,"data-radix-popper-content-wrapper":"",style:{...Qe,transform:ot?Qe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:mr,"--radix-popper-transform-origin":[(ge=Be.transformOrigin)==null?void 0:ge.x,(ur=Be.transformOrigin)==null?void 0:ur.y].join(" "),...((Ot=Be.hide)==null?void 0:Ot.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:j.jsx(a_e,{scope:r,placedSide:lt,onArrowChange:oe,arrowX:Bt,arrowY:ct,shouldHideArrow:nr,children:j.jsx(Mn.div,{"data-side":lt,"data-align":zt,...B,ref:J,style:{...B.style,animation:ot?void 0:"none"}})})})});YQ.displayName=g5;var KQ="PopperArrow",l_e={top:"bottom",right:"left",bottom:"top",left:"right"},JQ=ne.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,l=s_e(KQ,n),h=l_e[l.placedSide];return j.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:j.jsx(r_e,{...a,ref:r,style:{...a.style,display:"block"}})})});JQ.displayName=KQ;function c_e(e){return e!==null}var u_e=e=>({name:"transformOrigin",options:e,fn(t){var q,G,H;const{placement:r,rects:n,middlewareData:a}=t,h=((q=a.arrow)==null?void 0:q.centerOffset)!==0,i=h?0:e.arrowWidth,_=h?0:e.arrowHeight,[b,E]=QQ(r),C={start:"0%",center:"50%",end:"100%"}[E],I=(((G=a.arrow)==null?void 0:G.x)??0)+i/2,F=(((H=a.arrow)==null?void 0:H.y)??0)+_/2;let $="",B="";return b==="bottom"?($=h?C:`${I}px`,B=`${-_}px`):b==="top"?($=h?C:`${I}px`,B=`${n.floating.height+_}px`):b==="right"?($=`${-_}px`,B=h?C:`${F}px`):b==="left"&&($=`${n.floating.width+_}px`,B=h?C:`${F}px`),{data:{x:$,y:B}}}});function QQ(e){const[t,r="center"]=e.split("-");return[t,r]}var eee=HQ,Sk=XQ,y5=YQ,v5=JQ,[Tk,yQe]=lf("Tooltip",[Zx]),_5=Zx(),tee="TooltipProvider",d_e=700,Cq="tooltip.open",[h_e,ree]=Tk(tee),nee=e=>{const{__scopeTooltip:t,delayDuration:r=d_e,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:l}=e,[h,i]=ne.useState(!0),_=ne.useRef(!1),b=ne.useRef(0);return ne.useEffect(()=>{const E=b.current;return()=>window.clearTimeout(E)},[]),j.jsx(h_e,{scope:t,isOpenDelayed:h,delayDuration:r,onOpen:ne.useCallback(()=>{window.clearTimeout(b.current),i(!1)},[]),onClose:ne.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>i(!0),n)},[n]),isPointerInTransitRef:_,onPointerInTransitChange:ne.useCallback(E=>{_.current=E},[]),disableHoverableContent:a,children:l})};nee.displayName=tee;var iee="Tooltip",[vQe,Ek]=Tk(iee),Jz="TooltipTrigger",f_e=ne.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=Ek(Jz,r),l=ree(Jz,r),h=_5(r),i=ne.useRef(null),_=Ci(t,i,a.onTriggerChange),b=ne.useRef(!1),E=ne.useRef(!1),C=ne.useCallback(()=>b.current=!1,[]);return ne.useEffect(()=>()=>document.removeEventListener("pointerup",C),[C]),j.jsx(Sk,{asChild:!0,...h,children:j.jsx(Mn.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:_,onPointerMove:Kr(e.onPointerMove,I=>{I.pointerType!=="touch"&&!E.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),E.current=!0)}),onPointerLeave:Kr(e.onPointerLeave,()=>{a.onTriggerLeave(),E.current=!1}),onPointerDown:Kr(e.onPointerDown,()=>{b.current=!0,document.addEventListener("pointerup",C,{once:!0})}),onFocus:Kr(e.onFocus,()=>{b.current||a.onOpen()}),onBlur:Kr(e.onBlur,a.onClose),onClick:Kr(e.onClick,a.onClose)})})});f_e.displayName=Jz;var p_e="TooltipPortal",[_Qe,m_e]=Tk(p_e,{forceMount:void 0}),tx="TooltipContent",oee=ne.forwardRef((e,t)=>{const r=m_e(tx,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...l}=e,h=Ek(tx,e.__scopeTooltip);return j.jsx(Gu,{present:n||h.open,children:h.disableHoverableContent?j.jsx(aee,{side:a,...l,ref:t}):j.jsx(g_e,{side:a,...l,ref:t})})}),g_e=ne.forwardRef((e,t)=>{const r=Ek(tx,e.__scopeTooltip),n=ree(tx,e.__scopeTooltip),a=ne.useRef(null),l=Ci(t,a),[h,i]=ne.useState(null),{trigger:_,onClose:b}=r,E=a.current,{onPointerInTransitChange:C}=n,I=ne.useCallback(()=>{i(null),C(!1)},[C]),F=ne.useCallback(($,B)=>{const q=$.currentTarget,G={x:$.clientX,y:$.clientY},H=x_e(G,q.getBoundingClientRect()),J=b_e(G,H),Q=w_e(B.getBoundingClientRect()),oe=T_e([...J,...Q]);i(oe),C(!0)},[C]);return ne.useEffect(()=>()=>I(),[I]),ne.useEffect(()=>{if(_&&E){const $=q=>F(q,E),B=q=>F(q,_);return _.addEventListener("pointerleave",$),E.addEventListener("pointerleave",B),()=>{_.removeEventListener("pointerleave",$),E.removeEventListener("pointerleave",B)}}},[_,E,F,I]),ne.useEffect(()=>{if(h){const $=B=>{const q=B.target,G={x:B.clientX,y:B.clientY},H=(_==null?void 0:_.contains(q))||(E==null?void 0:E.contains(q)),J=!S_e(G,h);H?I():J&&(I(),b())};return document.addEventListener("pointermove",$),()=>document.removeEventListener("pointermove",$)}},[_,E,h,b,I]),j.jsx(aee,{...e,ref:l})}),[y_e,v_e]=Tk(iee,{isInside:!1}),aee=ne.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:h,...i}=e,_=Ek(tx,r),b=_5(r),{onClose:E}=_;return ne.useEffect(()=>(document.addEventListener(Cq,E),()=>document.removeEventListener(Cq,E)),[E]),ne.useEffect(()=>{if(_.trigger){const C=I=>{const F=I.target;F!=null&&F.contains(_.trigger)&&E()};return window.addEventListener("scroll",C,{capture:!0}),()=>window.removeEventListener("scroll",C,{capture:!0})}},[_.trigger,E]),j.jsx(Vx,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:h,onFocusOutside:C=>C.preventDefault(),onDismiss:E,children:j.jsxs(y5,{"data-state":_.stateAttribute,...b,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[j.jsx(XJ,{children:n}),j.jsx(y_e,{scope:r,isInside:!0,children:j.jsx(oge,{id:_.contentId,role:"tooltip",children:a||n})})]})})});oee.displayName=tx;var see="TooltipArrow",__e=ne.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=_5(r);return v_e(see,r).isInside?null:j.jsx(v5,{...a,...n,ref:t})});__e.displayName=see;function x_e(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(r,n,a,l)){case l:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function b_e(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function w_e(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function S_e(e,t){const{x:r,y:n}=e;let a=!1;for(let l=0,h=t.length-1;l<t.length;h=l++){const i=t[l].x,_=t[l].y,b=t[h].x,E=t[h].y;_>n!=E>n&&r<(b-i)*(n-_)/(E-_)+i&&(a=!a)}return a}function T_e(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),E_e(t)}function E_e(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const l=t[t.length-1],h=t[t.length-2];if((l.x-h.x)*(a.y-h.y)>=(l.y-h.y)*(a.x-h.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const l=r[r.length-1],h=r[r.length-2];if((l.x-h.x)*(a.y-h.y)>=(l.y-h.y)*(a.x-h.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var A_e=nee,lee=oee;const C_e=A_e,M_e=ne.forwardRef(({className:e,sideOffset:t=4,...r},n)=>j.jsx(lee,{ref:n,sideOffset:t,className:Tr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));M_e.displayName=lee.displayName;var Xx=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ky=typeof window>"u"||"Deno"in globalThis;function Sc(){}function P_e(e,t){return typeof e=="function"?e(t):e}function Qz(e){return typeof e=="number"&&e>=0&&e!==1/0}function cee(e,t){return Math.max(e+(t||0)-Date.now(),0)}function E0(e,t){return typeof e=="function"?e(t):e}function Tu(e,t){return typeof e=="function"?e(t):e}function Mq(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:l,queryKey:h,stale:i}=e;if(h){if(n){if(t.queryHash!==x5(h,t.options))return!1}else if(!gT(t.queryKey,h))return!1}if(r!=="all"){const _=t.isActive();if(r==="active"&&!_||r==="inactive"&&_)return!1}return!(typeof i=="boolean"&&t.isStale()!==i||a&&a!==t.state.fetchStatus||l&&!l(t))}function Pq(e,t){const{exact:r,status:n,predicate:a,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(Ry(t.options.mutationKey)!==Ry(l))return!1}else if(!gT(t.options.mutationKey,l))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function x5(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ry)(e)}function Ry(e){return JSON.stringify(e,(t,r)=>ej(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function gT(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!gT(e[r],t[r])):!1}function uee(e,t){if(e===t)return e;const r=Iq(e)&&Iq(t);if(r||ej(e)&&ej(t)){const n=r?e:Object.keys(e),a=n.length,l=r?t:Object.keys(t),h=l.length,i=r?[]:{};let _=0;for(let b=0;b<h;b++){const E=r?b:l[b];(!r&&n.includes(E)||r)&&e[E]===void 0&&t[E]===void 0?(i[E]=void 0,_++):(i[E]=uee(e[E],t[E]),i[E]===e[E]&&e[E]!==void 0&&_++)}return a===h&&_===a?e:i}return t}function xI(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Iq(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function ej(e){if(!Oq(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Oq(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Oq(e){return Object.prototype.toString.call(e)==="[object Object]"}function I_e(e){return new Promise(t=>{setTimeout(t,e)})}function tj(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?uee(e,t):t}function O_e(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function k_e(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var b5=Symbol();function dee(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===b5?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var cy,Fp,D0,TY,R_e=(TY=class extends Xx{constructor(){super();dn(this,cy);dn(this,Fp);dn(this,D0);zr(this,D0,t=>{if(!ky&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){mt(this,Fp)||this.setEventListener(mt(this,D0))}onUnsubscribe(){var t;this.hasListeners()||((t=mt(this,Fp))==null||t.call(this),zr(this,Fp,void 0))}setEventListener(t){var r;zr(this,D0,t),(r=mt(this,Fp))==null||r.call(this),zr(this,Fp,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){mt(this,cy)!==t&&(zr(this,cy,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof mt(this,cy)=="boolean"?mt(this,cy):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},cy=new WeakMap,Fp=new WeakMap,D0=new WeakMap,TY),w5=new R_e,L0,Bp,N0,EY,D_e=(EY=class extends Xx{constructor(){super();dn(this,L0,!0);dn(this,Bp);dn(this,N0);zr(this,N0,t=>{if(!ky&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){mt(this,Bp)||this.setEventListener(mt(this,N0))}onUnsubscribe(){var t;this.hasListeners()||((t=mt(this,Bp))==null||t.call(this),zr(this,Bp,void 0))}setEventListener(t){var r;zr(this,N0,t),(r=mt(this,Bp))==null||r.call(this),zr(this,Bp,t(this.setOnline.bind(this)))}setOnline(t){mt(this,L0)!==t&&(zr(this,L0,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return mt(this,L0)}},L0=new WeakMap,Bp=new WeakMap,N0=new WeakMap,EY),bI=new D_e;function rj(){let e,t;const r=new Promise((a,l)=>{e=a,t=l});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function L_e(e){return Math.min(1e3*2**e,3e4)}function hee(e){return(e??"online")==="online"?bI.isOnline():!0}var fee=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function k3(e){return e instanceof fee}function pee(e){let t=!1,r=0,n=!1,a;const l=rj(),h=B=>{var q;n||(I(new fee(B)),(q=e.abort)==null||q.call(e))},i=()=>{t=!0},_=()=>{t=!1},b=()=>w5.isFocused()&&(e.networkMode==="always"||bI.isOnline())&&e.canRun(),E=()=>hee(e.networkMode)&&e.canRun(),C=B=>{var q;n||(n=!0,(q=e.onSuccess)==null||q.call(e,B),a==null||a(),l.resolve(B))},I=B=>{var q;n||(n=!0,(q=e.onError)==null||q.call(e,B),a==null||a(),l.reject(B))},F=()=>new Promise(B=>{var q;a=G=>{(n||b())&&B(G)},(q=e.onPause)==null||q.call(e)}).then(()=>{var B;a=void 0,n||(B=e.onContinue)==null||B.call(e)}),$=()=>{if(n)return;let B;const q=r===0?e.initialPromise:void 0;try{B=q??e.fn()}catch(G){B=Promise.reject(G)}Promise.resolve(B).then(C).catch(G=>{var de;if(n)return;const H=e.retry??(ky?0:3),J=e.retryDelay??L_e,Q=typeof J=="function"?J(r,G):J,oe=H===!0||typeof H=="number"&&r<H||typeof H=="function"&&H(r,G);if(t||!oe){I(G);return}r++,(de=e.onFail)==null||de.call(e,r,G),I_e(Q).then(()=>b()?void 0:F()).then(()=>{t?I(G):$()})})};return{promise:l,cancel:h,continue:()=>(a==null||a(),l),cancelRetry:i,continueRetry:_,canStart:E,start:()=>(E()?$():F().then($),l)}}function N_e(){let e=[],t=0,r=i=>{i()},n=i=>{i()},a=i=>setTimeout(i,0);const l=i=>{t?e.push(i):a(()=>{r(i)})},h=()=>{const i=e;e=[],i.length&&a(()=>{n(()=>{i.forEach(_=>{r(_)})})})};return{batch:i=>{let _;t++;try{_=i()}finally{t--,t||h()}return _},batchCalls:i=>(..._)=>{l(()=>{i(..._)})},schedule:l,setNotifyFunction:i=>{r=i},setBatchNotifyFunction:i=>{n=i},setScheduler:i=>{a=i}}}var Ta=N_e(),uy,AY,mee=(AY=class{constructor(){dn(this,uy)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Qz(this.gcTime)&&zr(this,uy,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ky?1/0:5*60*1e3))}clearGcTimeout(){mt(this,uy)&&(clearTimeout(mt(this,uy)),zr(this,uy,void 0))}},uy=new WeakMap,AY),z0,j0,wc,ss,_E,dy,yu,vh,CY,z_e=(CY=class extends mee{constructor(t){super();dn(this,yu);dn(this,z0);dn(this,j0);dn(this,wc);dn(this,ss);dn(this,_E);dn(this,dy);zr(this,dy,!1),zr(this,_E,t.defaultOptions),this.setOptions(t.options),this.observers=[],zr(this,wc,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,zr(this,z0,j_e(this.options)),this.state=t.state??mt(this,z0),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=mt(this,ss))==null?void 0:t.promise}setOptions(t){this.options={...mt(this,_E),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&mt(this,wc).remove(this)}setData(t,r){const n=tj(this.state.data,t,this.options);return Vn(this,yu,vh).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Vn(this,yu,vh).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=mt(this,ss))==null?void 0:n.promise;return(a=mt(this,ss))==null||a.cancel(t),r?r.then(Sc).catch(Sc):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(mt(this,z0))}isActive(){return this.observers.some(t=>Tu(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===b5||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!cee(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=mt(this,ss))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=mt(this,ss))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),mt(this,wc).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(mt(this,ss)&&(mt(this,dy)?mt(this,ss).cancel({revert:!0}):mt(this,ss).cancelRetry()),this.scheduleGc()),mt(this,wc).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Vn(this,yu,vh).call(this,{type:"invalidate"})}fetch(t,r){var _,b,E;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(mt(this,ss))return mt(this,ss).continueRetry(),mt(this,ss).promise}if(t&&this.setOptions(t),!this.options.queryFn){const C=this.observers.find(I=>I.options.queryFn);C&&this.setOptions(C.options)}const n=new AbortController,a=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(zr(this,dy,!0),n.signal)})},l=()=>{const C=dee(this.options,r),I={queryKey:this.queryKey,meta:this.meta};return a(I),zr(this,dy,!1),this.options.persister?this.options.persister(C,I,this):C(I)},h={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:l};a(h),(_=this.options.behavior)==null||_.onFetch(h,this),zr(this,j0,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((b=h.fetchOptions)==null?void 0:b.meta))&&Vn(this,yu,vh).call(this,{type:"fetch",meta:(E=h.fetchOptions)==null?void 0:E.meta});const i=C=>{var I,F,$,B;k3(C)&&C.silent||Vn(this,yu,vh).call(this,{type:"error",error:C}),k3(C)||((F=(I=mt(this,wc).config).onError)==null||F.call(I,C,this),(B=($=mt(this,wc).config).onSettled)==null||B.call($,this.state.data,C,this)),this.scheduleGc()};return zr(this,ss,pee({initialPromise:r==null?void 0:r.initialPromise,fn:h.fetchFn,abort:n.abort.bind(n),onSuccess:C=>{var I,F,$,B;if(C===void 0){i(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(C)}catch(q){i(q);return}(F=(I=mt(this,wc).config).onSuccess)==null||F.call(I,C,this),(B=($=mt(this,wc).config).onSettled)==null||B.call($,C,this.state.error,this),this.scheduleGc()},onError:i,onFail:(C,I)=>{Vn(this,yu,vh).call(this,{type:"failed",failureCount:C,error:I})},onPause:()=>{Vn(this,yu,vh).call(this,{type:"pause"})},onContinue:()=>{Vn(this,yu,vh).call(this,{type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0})),mt(this,ss).start()}},z0=new WeakMap,j0=new WeakMap,wc=new WeakMap,ss=new WeakMap,_E=new WeakMap,dy=new WeakMap,yu=new WeakSet,vh=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...gee(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return k3(a)&&a.revert&&mt(this,j0)?{...mt(this,j0),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Ta.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),mt(this,wc).notify({query:this,type:"updated",action:t})})},CY);function gee(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hee(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function j_e(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var bd,MY,F_e=(MY=class extends Xx{constructor(t={}){super();dn(this,bd);this.config=t,zr(this,bd,new Map)}build(t,r,n){const a=r.queryKey,l=r.queryHash??x5(a,r);let h=this.get(l);return h||(h=new z_e({cache:this,queryKey:a,queryHash:l,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(h)),h}add(t){mt(this,bd).has(t.queryHash)||(mt(this,bd).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=mt(this,bd).get(t.queryHash);r&&(t.destroy(),r===t&&mt(this,bd).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ta.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return mt(this,bd).get(t)}getAll(){return[...mt(this,bd).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Mq(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>Mq(t,n)):r}notify(t){Ta.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ta.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ta.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},bd=new WeakMap,MY),wd,ks,hy,Sd,yp,PY,B_e=(PY=class extends mee{constructor(t){super();dn(this,Sd);dn(this,wd);dn(this,ks);dn(this,hy);this.mutationId=t.mutationId,zr(this,ks,t.mutationCache),zr(this,wd,[]),this.state=t.state||yee(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){mt(this,wd).includes(t)||(mt(this,wd).push(t),this.clearGcTimeout(),mt(this,ks).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){zr(this,wd,mt(this,wd).filter(r=>r!==t)),this.scheduleGc(),mt(this,ks).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){mt(this,wd).length||(this.state.status==="pending"?this.scheduleGc():mt(this,ks).remove(this))}continue(){var t;return((t=mt(this,hy))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var a,l,h,i,_,b,E,C,I,F,$,B,q,G,H,J,Q,oe,de,ae;zr(this,hy,pee({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(ve,Fe)=>{Vn(this,Sd,yp).call(this,{type:"failed",failureCount:ve,error:Fe})},onPause:()=>{Vn(this,Sd,yp).call(this,{type:"pause"})},onContinue:()=>{Vn(this,Sd,yp).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>mt(this,ks).canRun(this)}));const r=this.state.status==="pending",n=!mt(this,hy).canStart();try{if(!r){Vn(this,Sd,yp).call(this,{type:"pending",variables:t,isPaused:n}),await((l=(a=mt(this,ks).config).onMutate)==null?void 0:l.call(a,t,this));const Fe=await((i=(h=this.options).onMutate)==null?void 0:i.call(h,t));Fe!==this.state.context&&Vn(this,Sd,yp).call(this,{type:"pending",context:Fe,variables:t,isPaused:n})}const ve=await mt(this,hy).start();return await((b=(_=mt(this,ks).config).onSuccess)==null?void 0:b.call(_,ve,t,this.state.context,this)),await((C=(E=this.options).onSuccess)==null?void 0:C.call(E,ve,t,this.state.context)),await((F=(I=mt(this,ks).config).onSettled)==null?void 0:F.call(I,ve,null,this.state.variables,this.state.context,this)),await((B=($=this.options).onSettled)==null?void 0:B.call($,ve,null,t,this.state.context)),Vn(this,Sd,yp).call(this,{type:"success",data:ve}),ve}catch(ve){try{throw await((G=(q=mt(this,ks).config).onError)==null?void 0:G.call(q,ve,t,this.state.context,this)),await((J=(H=this.options).onError)==null?void 0:J.call(H,ve,t,this.state.context)),await((oe=(Q=mt(this,ks).config).onSettled)==null?void 0:oe.call(Q,void 0,ve,this.state.variables,this.state.context,this)),await((ae=(de=this.options).onSettled)==null?void 0:ae.call(de,void 0,ve,t,this.state.context)),ve}finally{Vn(this,Sd,yp).call(this,{type:"error",error:ve})}}finally{mt(this,ks).runNext(this)}}},wd=new WeakMap,ks=new WeakMap,hy=new WeakMap,Sd=new WeakSet,yp=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ta.batch(()=>{mt(this,wd).forEach(n=>{n.onMutationUpdate(t)}),mt(this,ks).notify({mutation:this,type:"updated",action:t})})},PY);function yee(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $l,xE,IY,$_e=(IY=class extends Xx{constructor(t={}){super();dn(this,$l);dn(this,xE);this.config=t,zr(this,$l,new Map),zr(this,xE,Date.now())}build(t,r,n){const a=new B_e({mutationCache:this,mutationId:++ZA(this,xE)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){const r=gC(t),n=mt(this,$l).get(r)??[];n.push(t),mt(this,$l).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=gC(t);if(mt(this,$l).has(r)){const a=(n=mt(this,$l).get(r))==null?void 0:n.filter(l=>l!==t);a&&(a.length===0?mt(this,$l).delete(r):mt(this,$l).set(r,a))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=mt(this,$l).get(gC(t)))==null?void 0:n.find(a=>a.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=mt(this,$l).get(gC(t)))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){Ta.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...mt(this,$l).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Pq(r,n))}findAll(t={}){return this.getAll().filter(r=>Pq(t,r))}notify(t){Ta.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ta.batch(()=>Promise.all(t.map(r=>r.continue().catch(Sc))))}},$l=new WeakMap,xE=new WeakMap,IY);function gC(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function kq(e){return{onFetch:(t,r)=>{var E,C,I,F,$;const n=t.options,a=(I=(C=(E=t.fetchOptions)==null?void 0:E.meta)==null?void 0:C.fetchMore)==null?void 0:I.direction,l=((F=t.state.data)==null?void 0:F.pages)||[],h=(($=t.state.data)==null?void 0:$.pageParams)||[];let i={pages:[],pageParams:[]},_=0;const b=async()=>{let B=!1;const q=J=>{Object.defineProperty(J,"signal",{enumerable:!0,get:()=>(t.signal.aborted?B=!0:t.signal.addEventListener("abort",()=>{B=!0}),t.signal)})},G=dee(t.options,t.fetchOptions),H=async(J,Q,oe)=>{if(B)return Promise.reject();if(Q==null&&J.pages.length)return Promise.resolve(J);const de={queryKey:t.queryKey,pageParam:Q,direction:oe?"backward":"forward",meta:t.options.meta};q(de);const ae=await G(de),{maxPages:ve}=t.options,Fe=oe?k_e:O_e;return{pages:Fe(J.pages,ae,ve),pageParams:Fe(J.pageParams,Q,ve)}};if(a&&l.length){const J=a==="backward",Q=J?U_e:Rq,oe={pages:l,pageParams:h},de=Q(n,oe);i=await H(oe,de,J)}else{const J=e??l.length;do{const Q=_===0?h[0]??n.initialPageParam:Rq(n,i);if(_>0&&Q==null)break;i=await H(i,Q),_++}while(_<J)}return i};t.options.persister?t.fetchFn=()=>{var B,q;return(q=(B=t.options).persister)==null?void 0:q.call(B,b,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=b}}}function Rq(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function U_e(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var jo,$p,Up,F0,B0,Vp,$0,U0,OY,V_e=(OY=class{constructor(e={}){dn(this,jo);dn(this,$p);dn(this,Up);dn(this,F0);dn(this,B0);dn(this,Vp);dn(this,$0);dn(this,U0);zr(this,jo,e.queryCache||new F_e),zr(this,$p,e.mutationCache||new $_e),zr(this,Up,e.defaultOptions||{}),zr(this,F0,new Map),zr(this,B0,new Map),zr(this,Vp,0)}mount(){ZA(this,Vp)._++,mt(this,Vp)===1&&(zr(this,$0,w5.subscribe(async e=>{e&&(await this.resumePausedMutations(),mt(this,jo).onFocus())})),zr(this,U0,bI.subscribe(async e=>{e&&(await this.resumePausedMutations(),mt(this,jo).onOnline())})))}unmount(){var e,t;ZA(this,Vp)._--,mt(this,Vp)===0&&((e=mt(this,$0))==null||e.call(this),zr(this,$0,void 0),(t=mt(this,U0))==null||t.call(this),zr(this,U0,void 0))}isFetching(e){return mt(this,jo).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return mt(this,$p).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=mt(this,jo).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=mt(this,jo).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(E0(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return mt(this,jo).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=mt(this,jo).get(n.queryHash),l=a==null?void 0:a.state.data,h=P_e(t,l);if(h!==void 0)return mt(this,jo).build(this,n).setData(h,{...r,manual:!0})}setQueriesData(e,t,r){return Ta.batch(()=>mt(this,jo).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=mt(this,jo).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=mt(this,jo);Ta.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=mt(this,jo),n={type:"active",...e};return Ta.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=Ta.batch(()=>mt(this,jo).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(Sc).catch(Sc)}invalidateQueries(e={},t={}){return Ta.batch(()=>{if(mt(this,jo).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=Ta.batch(()=>mt(this,jo).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let l=a.fetch(void 0,r);return r.throwOnError||(l=l.catch(Sc)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(n).then(Sc)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=mt(this,jo).build(this,t);return r.isStaleByTime(E0(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Sc).catch(Sc)}fetchInfiniteQuery(e){return e.behavior=kq(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Sc).catch(Sc)}ensureInfiniteQueryData(e){return e.behavior=kq(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return bI.isOnline()?mt(this,$p).resumePausedMutations():Promise.resolve()}getQueryCache(){return mt(this,jo)}getMutationCache(){return mt(this,$p)}getDefaultOptions(){return mt(this,Up)}setDefaultOptions(e){zr(this,Up,e)}setQueryDefaults(e,t){mt(this,F0).set(Ry(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...mt(this,F0).values()];let r={};return t.forEach(n=>{gT(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){mt(this,B0).set(Ry(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...mt(this,B0).values()];let r={};return t.forEach(n=>{gT(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...mt(this,Up).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=x5(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===b5&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...mt(this,Up).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){mt(this,jo).clear(),mt(this,$p).clear()}},jo=new WeakMap,$p=new WeakMap,Up=new WeakMap,F0=new WeakMap,B0=new WeakMap,Vp=new WeakMap,$0=new WeakMap,U0=new WeakMap,OY),dl,ci,bE,Rs,fy,V0,Wp,Td,wE,W0,G0,py,my,Gp,q0,ki,Zw,nj,ij,oj,aj,sj,lj,cj,vee,kY,W_e=(kY=class extends Xx{constructor(t,r){super();dn(this,ki);dn(this,dl);dn(this,ci);dn(this,bE);dn(this,Rs);dn(this,fy);dn(this,V0);dn(this,Wp);dn(this,Td);dn(this,wE);dn(this,W0);dn(this,G0);dn(this,py);dn(this,my);dn(this,Gp);dn(this,q0,new Set);this.options=r,zr(this,dl,t),zr(this,Td,null),zr(this,Wp,rj()),this.options.experimental_prefetchInRender||mt(this,Wp).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(mt(this,ci).addObserver(this),Dq(mt(this,ci),this.options)?Vn(this,ki,Zw).call(this):this.updateResult(),Vn(this,ki,aj).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return uj(mt(this,ci),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return uj(mt(this,ci),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Vn(this,ki,sj).call(this),Vn(this,ki,lj).call(this),mt(this,ci).removeObserver(this)}setOptions(t,r){const n=this.options,a=mt(this,ci);if(this.options=mt(this,dl).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Tu(this.options.enabled,mt(this,ci))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Vn(this,ki,cj).call(this),mt(this,ci).setOptions(this.options),n._defaulted&&!xI(this.options,n)&&mt(this,dl).getQueryCache().notify({type:"observerOptionsUpdated",query:mt(this,ci),observer:this});const l=this.hasListeners();l&&Lq(mt(this,ci),a,this.options,n)&&Vn(this,ki,Zw).call(this),this.updateResult(r),l&&(mt(this,ci)!==a||Tu(this.options.enabled,mt(this,ci))!==Tu(n.enabled,mt(this,ci))||E0(this.options.staleTime,mt(this,ci))!==E0(n.staleTime,mt(this,ci)))&&Vn(this,ki,nj).call(this);const h=Vn(this,ki,ij).call(this);l&&(mt(this,ci)!==a||Tu(this.options.enabled,mt(this,ci))!==Tu(n.enabled,mt(this,ci))||h!==mt(this,Gp))&&Vn(this,ki,oj).call(this,h)}getOptimisticResult(t){const r=mt(this,dl).getQueryCache().build(mt(this,dl),t),n=this.createResult(r,t);return q_e(this,n)&&(zr(this,Rs,n),zr(this,V0,this.options),zr(this,fy,mt(this,ci).state)),n}getCurrentResult(){return mt(this,Rs)}trackResult(t,r){const n={};return Object.keys(t).forEach(a=>{Object.defineProperty(n,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),r==null||r(a),t[a])})}),n}trackProp(t){mt(this,q0).add(t)}getCurrentQuery(){return mt(this,ci)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=mt(this,dl).defaultQueryOptions(t),n=mt(this,dl).getQueryCache().build(mt(this,dl),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Vn(this,ki,Zw).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),mt(this,Rs)))}createResult(t,r){var ve;const n=mt(this,ci),a=this.options,l=mt(this,Rs),h=mt(this,fy),i=mt(this,V0),b=t!==n?t.state:mt(this,bE),{state:E}=t;let C={...E},I=!1,F;if(r._optimisticResults){const Fe=this.hasListeners(),ke=!Fe&&Dq(t,r),Ce=Fe&&Lq(t,n,r,a);(ke||Ce)&&(C={...C,...gee(E.data,t.options)}),r._optimisticResults==="isRestoring"&&(C.fetchStatus="idle")}let{error:$,errorUpdatedAt:B,status:q}=C;if(r.select&&C.data!==void 0)if(l&&C.data===(h==null?void 0:h.data)&&r.select===mt(this,wE))F=mt(this,W0);else try{zr(this,wE,r.select),F=r.select(C.data),F=tj(l==null?void 0:l.data,F,r),zr(this,W0,F),zr(this,Td,null)}catch(Fe){zr(this,Td,Fe)}else F=C.data;if(r.placeholderData!==void 0&&F===void 0&&q==="pending"){let Fe;if(l!=null&&l.isPlaceholderData&&r.placeholderData===(i==null?void 0:i.placeholderData))Fe=l.data;else if(Fe=typeof r.placeholderData=="function"?r.placeholderData((ve=mt(this,G0))==null?void 0:ve.state.data,mt(this,G0)):r.placeholderData,r.select&&Fe!==void 0)try{Fe=r.select(Fe),zr(this,Td,null)}catch(ke){zr(this,Td,ke)}Fe!==void 0&&(q="success",F=tj(l==null?void 0:l.data,Fe,r),I=!0)}mt(this,Td)&&($=mt(this,Td),F=mt(this,W0),B=Date.now(),q="error");const G=C.fetchStatus==="fetching",H=q==="pending",J=q==="error",Q=H&&G,oe=F!==void 0,ae={status:q,fetchStatus:C.fetchStatus,isPending:H,isSuccess:q==="success",isError:J,isInitialLoading:Q,isLoading:Q,data:F,dataUpdatedAt:C.dataUpdatedAt,error:$,errorUpdatedAt:B,failureCount:C.fetchFailureCount,failureReason:C.fetchFailureReason,errorUpdateCount:C.errorUpdateCount,isFetched:C.dataUpdateCount>0||C.errorUpdateCount>0,isFetchedAfterMount:C.dataUpdateCount>b.dataUpdateCount||C.errorUpdateCount>b.errorUpdateCount,isFetching:G,isRefetching:G&&!H,isLoadingError:J&&!oe,isPaused:C.fetchStatus==="paused",isPlaceholderData:I,isRefetchError:J&&oe,isStale:S5(t,r),refetch:this.refetch,promise:mt(this,Wp)};if(this.options.experimental_prefetchInRender){const Fe=je=>{ae.status==="error"?je.reject(ae.error):ae.data!==void 0&&je.resolve(ae.data)},ke=()=>{const je=zr(this,Wp,ae.promise=rj());Fe(je)},Ce=mt(this,Wp);switch(Ce.status){case"pending":t.queryHash===n.queryHash&&Fe(Ce);break;case"fulfilled":(ae.status==="error"||ae.data!==Ce.value)&&ke();break;case"rejected":(ae.status!=="error"||ae.error!==Ce.reason)&&ke();break}}return ae}updateResult(t){const r=mt(this,Rs),n=this.createResult(mt(this,ci),this.options);if(zr(this,fy,mt(this,ci).state),zr(this,V0,this.options),mt(this,fy).data!==void 0&&zr(this,G0,mt(this,ci)),xI(n,r))return;zr(this,Rs,n);const a={},l=()=>{if(!r)return!0;const{notifyOnChangeProps:h}=this.options,i=typeof h=="function"?h():h;if(i==="all"||!i&&!mt(this,q0).size)return!0;const _=new Set(i??mt(this,q0));return this.options.throwOnError&&_.add("error"),Object.keys(mt(this,Rs)).some(b=>{const E=b;return mt(this,Rs)[E]!==r[E]&&_.has(E)})};(t==null?void 0:t.listeners)!==!1&&l()&&(a.listeners=!0),Vn(this,ki,vee).call(this,{...a,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Vn(this,ki,aj).call(this)}},dl=new WeakMap,ci=new WeakMap,bE=new WeakMap,Rs=new WeakMap,fy=new WeakMap,V0=new WeakMap,Wp=new WeakMap,Td=new WeakMap,wE=new WeakMap,W0=new WeakMap,G0=new WeakMap,py=new WeakMap,my=new WeakMap,Gp=new WeakMap,q0=new WeakMap,ki=new WeakSet,Zw=function(t){Vn(this,ki,cj).call(this);let r=mt(this,ci).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Sc)),r},nj=function(){Vn(this,ki,sj).call(this);const t=E0(this.options.staleTime,mt(this,ci));if(ky||mt(this,Rs).isStale||!Qz(t))return;const n=cee(mt(this,Rs).dataUpdatedAt,t)+1;zr(this,py,setTimeout(()=>{mt(this,Rs).isStale||this.updateResult()},n))},ij=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(mt(this,ci)):this.options.refetchInterval)??!1},oj=function(t){Vn(this,ki,lj).call(this),zr(this,Gp,t),!(ky||Tu(this.options.enabled,mt(this,ci))===!1||!Qz(mt(this,Gp))||mt(this,Gp)===0)&&zr(this,my,setInterval(()=>{(this.options.refetchIntervalInBackground||w5.isFocused())&&Vn(this,ki,Zw).call(this)},mt(this,Gp)))},aj=function(){Vn(this,ki,nj).call(this),Vn(this,ki,oj).call(this,Vn(this,ki,ij).call(this))},sj=function(){mt(this,py)&&(clearTimeout(mt(this,py)),zr(this,py,void 0))},lj=function(){mt(this,my)&&(clearInterval(mt(this,my)),zr(this,my,void 0))},cj=function(){const t=mt(this,dl).getQueryCache().build(mt(this,dl),this.options);if(t===mt(this,ci))return;const r=mt(this,ci);zr(this,ci,t),zr(this,bE,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},vee=function(t){Ta.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(mt(this,Rs))}),mt(this,dl).getQueryCache().notify({query:mt(this,ci),type:"observerResultsUpdated"})})},kY);function G_e(e,t){return Tu(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Dq(e,t){return G_e(e,t)||e.state.data!==void 0&&uj(e,t,t.refetchOnMount)}function uj(e,t,r){if(Tu(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&S5(e,t)}return!1}function Lq(e,t,r,n){return(e!==t||Tu(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&S5(e,r)}function S5(e,t){return Tu(t.enabled,e)!==!1&&e.isStaleByTime(E0(t.staleTime,e))}function q_e(e,t){return!xI(e.getCurrentResult(),t)}var qp,Hp,hl,Mh,Gh,dM,dj,RY,H_e=(RY=class extends Xx{constructor(r,n){super();dn(this,Gh);dn(this,qp);dn(this,Hp);dn(this,hl);dn(this,Mh);zr(this,qp,r),this.setOptions(n),this.bindMethods(),Vn(this,Gh,dM).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=mt(this,qp).defaultMutationOptions(r),xI(this.options,n)||mt(this,qp).getMutationCache().notify({type:"observerOptionsUpdated",mutation:mt(this,hl),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Ry(n.mutationKey)!==Ry(this.options.mutationKey)?this.reset():((a=mt(this,hl))==null?void 0:a.state.status)==="pending"&&mt(this,hl).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=mt(this,hl))==null||r.removeObserver(this)}onMutationUpdate(r){Vn(this,Gh,dM).call(this),Vn(this,Gh,dj).call(this,r)}getCurrentResult(){return mt(this,Hp)}reset(){var r;(r=mt(this,hl))==null||r.removeObserver(this),zr(this,hl,void 0),Vn(this,Gh,dM).call(this),Vn(this,Gh,dj).call(this)}mutate(r,n){var a;return zr(this,Mh,n),(a=mt(this,hl))==null||a.removeObserver(this),zr(this,hl,mt(this,qp).getMutationCache().build(mt(this,qp),this.options)),mt(this,hl).addObserver(this),mt(this,hl).execute(r)}},qp=new WeakMap,Hp=new WeakMap,hl=new WeakMap,Mh=new WeakMap,Gh=new WeakSet,dM=function(){var n;const r=((n=mt(this,hl))==null?void 0:n.state)??yee();zr(this,Hp,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},dj=function(r){Ta.batch(()=>{var n,a,l,h,i,_,b,E;if(mt(this,Mh)&&this.hasListeners()){const C=mt(this,Hp).variables,I=mt(this,Hp).context;(r==null?void 0:r.type)==="success"?((a=(n=mt(this,Mh)).onSuccess)==null||a.call(n,r.data,C,I),(h=(l=mt(this,Mh)).onSettled)==null||h.call(l,r.data,null,C,I)):(r==null?void 0:r.type)==="error"&&((_=(i=mt(this,Mh)).onError)==null||_.call(i,r.error,C,I),(E=(b=mt(this,Mh)).onSettled)==null||E.call(b,void 0,r.error,C,I))}this.listeners.forEach(C=>{C(mt(this,Hp))})})},RY),_ee=ne.createContext(void 0),T5=e=>{const t=ne.useContext(_ee);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Z_e=({client:e,children:t})=>(ne.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),j.jsx(_ee.Provider,{value:e,children:t})),xee=ne.createContext(!1),X_e=()=>ne.useContext(xee);xee.Provider;function Y_e(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var K_e=ne.createContext(Y_e()),J_e=()=>ne.useContext(K_e);function bee(e,t){return typeof e=="function"?e(...t):!!e}function wee(){}var Q_e=(e,t)=>{(e.suspense||e.throwOnError)&&(t.isReset()||(e.retryOnMount=!1))},e0e=e=>{ne.useEffect(()=>{e.clearReset()},[e])},t0e=({result:e,errorResetBoundary:t,throwOnError:r,query:n})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&bee(r,[e.error,n]),r0e=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},n0e=(e,t)=>e.isLoading&&e.isFetching&&!t,i0e=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Nq=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function o0e(e,t,r){var E,C,I,F,$;const n=T5(),a=X_e(),l=J_e(),h=n.defaultQueryOptions(e);(C=(E=n.getDefaultOptions().queries)==null?void 0:E._experimental_beforeQuery)==null||C.call(E,h),h._optimisticResults=a?"isRestoring":"optimistic",r0e(h),Q_e(h,l),e0e(l);const i=!n.getQueryCache().get(h.queryHash),[_]=ne.useState(()=>new t(n,h)),b=_.getOptimisticResult(h);if(ne.useSyncExternalStore(ne.useCallback(B=>{const q=a?()=>{}:_.subscribe(Ta.batchCalls(B));return _.updateResult(),q},[_,a]),()=>_.getCurrentResult(),()=>_.getCurrentResult()),ne.useEffect(()=>{_.setOptions(h,{listeners:!1})},[h,_]),i0e(h,b))throw Nq(h,_,l);if(t0e({result:b,errorResetBoundary:l,throwOnError:h.throwOnError,query:n.getQueryCache().get(h.queryHash)}))throw b.error;if((F=(I=n.getDefaultOptions().queries)==null?void 0:I._experimental_afterQuery)==null||F.call(I,h,b),h.experimental_prefetchInRender&&!ky&&n0e(b,a)){const B=i?Nq(h,_,l):($=n.getQueryCache().get(h.queryHash))==null?void 0:$.promise;B==null||B.catch(wee).finally(()=>{_.updateResult()})}return h.notifyOnChangeProps?b:_.trackResult(b)}function Yy(e,t){return o0e(e,W_e)}function a0e(e,t){const r=T5(),[n]=ne.useState(()=>new H_e(r,e));ne.useEffect(()=>{n.setOptions(e)},[n,e]);const a=ne.useSyncExternalStore(ne.useCallback(h=>n.subscribe(Ta.batchCalls(h)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),l=ne.useCallback((h,i)=>{n.mutate(h,i).catch(wee)},[n]);if(a.error&&bee(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yT(){return yT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yT.apply(this,arguments)}var Yp;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Yp||(Yp={}));const zq="popstate";function s0e(e){e===void 0&&(e={});function t(n,a){let{pathname:l,search:h,hash:i}=n.location;return hj("",{pathname:l,search:h,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:wI(a)}return c0e(t,r,null,e)}function ko(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function See(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function l0e(){return Math.random().toString(36).substr(2,8)}function jq(e,t){return{usr:e.state,key:e.key,idx:t}}function hj(e,t,r,n){return r===void 0&&(r=null),yT({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Yx(t):t,{state:r,key:t&&t.key||n||l0e()})}function wI(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Yx(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function c0e(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:l=!1}=n,h=a.history,i=Yp.Pop,_=null,b=E();b==null&&(b=0,h.replaceState(yT({},h.state,{idx:b}),""));function E(){return(h.state||{idx:null}).idx}function C(){i=Yp.Pop;let q=E(),G=q==null?null:q-b;b=q,_&&_({action:i,location:B.location,delta:G})}function I(q,G){i=Yp.Push;let H=hj(B.location,q,G);b=E()+1;let J=jq(H,b),Q=B.createHref(H);try{h.pushState(J,"",Q)}catch(oe){if(oe instanceof DOMException&&oe.name==="DataCloneError")throw oe;a.location.assign(Q)}l&&_&&_({action:i,location:B.location,delta:1})}function F(q,G){i=Yp.Replace;let H=hj(B.location,q,G);b=E();let J=jq(H,b),Q=B.createHref(H);h.replaceState(J,"",Q),l&&_&&_({action:i,location:B.location,delta:0})}function $(q){let G=a.location.origin!=="null"?a.location.origin:a.location.href,H=typeof q=="string"?q:wI(q);return H=H.replace(/ $/,"%20"),ko(G,"No window.location.(origin|href) available to create URL for href: "+H),new URL(H,G)}let B={get action(){return i},get location(){return e(a,h)},listen(q){if(_)throw new Error("A history only accepts one active listener");return a.addEventListener(zq,C),_=q,()=>{a.removeEventListener(zq,C),_=null}},createHref(q){return t(a,q)},createURL:$,encodeLocation(q){let G=$(q);return{pathname:G.pathname,search:G.search,hash:G.hash}},push:I,replace:F,go(q){return h.go(q)}};return B}var Fq;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Fq||(Fq={}));function u0e(e,t,r){return r===void 0&&(r="/"),d0e(e,t,r,!1)}function d0e(e,t,r,n){let a=typeof t=="string"?Yx(t):t,l=rx(a.pathname||"/",r);if(l==null)return null;let h=Tee(e);h0e(h);let i=null;for(let _=0;i==null&&_<h.length;++_){let b=S0e(l);i=b0e(h[_],b,n)}return i}function Tee(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(l,h,i)=>{let _={relativePath:i===void 0?l.path||"":i,caseSensitive:l.caseSensitive===!0,childrenIndex:h,route:l};_.relativePath.startsWith("/")&&(ko(_.relativePath.startsWith(n),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(n.length));let b=lm([n,_.relativePath]),E=r.concat(_);l.children&&l.children.length>0&&(ko(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),Tee(l.children,t,E,b)),!(l.path==null&&!l.index)&&t.push({path:b,score:_0e(b,l.index),routesMeta:E})};return e.forEach((l,h)=>{var i;if(l.path===""||!((i=l.path)!=null&&i.includes("?")))a(l,h);else for(let _ of Eee(l.path))a(l,h,_)}),t}function Eee(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let h=Eee(n.join("/")),i=[];return i.push(...h.map(_=>_===""?l:[l,_].join("/"))),a&&i.push(...h),i.map(_=>e.startsWith("/")&&_===""?"/":_)}function h0e(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:x0e(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const f0e=/^:[\w-]+$/,p0e=3,m0e=2,g0e=1,y0e=10,v0e=-2,Bq=e=>e==="*";function _0e(e,t){let r=e.split("/"),n=r.length;return r.some(Bq)&&(n+=v0e),t&&(n+=m0e),r.filter(a=>!Bq(a)).reduce((a,l)=>a+(f0e.test(l)?p0e:l===""?g0e:y0e),n)}function x0e(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function b0e(e,t,r){let{routesMeta:n}=e,a={},l="/",h=[];for(let i=0;i<n.length;++i){let _=n[i],b=i===n.length-1,E=l==="/"?t:t.slice(l.length)||"/",C=SI({path:_.relativePath,caseSensitive:_.caseSensitive,end:b},E),I=_.route;if(!C&&b&&r&&!n[n.length-1].route.index&&(C=SI({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},E)),!C)return null;Object.assign(a,C.params),h.push({params:a,pathname:lm([l,C.pathname]),pathnameBase:C0e(lm([l,C.pathnameBase])),route:I}),C.pathnameBase!=="/"&&(l=lm([l,C.pathnameBase]))}return h}function SI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=w0e(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let l=a[0],h=l.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((b,E,C)=>{let{paramName:I,isOptional:F}=E;if(I==="*"){let B=i[C]||"";h=l.slice(0,l.length-B.length).replace(/(.)\/+$/,"$1")}const $=i[C];return F&&!$?b[I]=void 0:b[I]=($||"").replace(/%2F/g,"/"),b},{}),pathname:l,pathnameBase:h,pattern:e}}function w0e(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),See(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,i,_)=>(n.push({paramName:i,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function S0e(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return See(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function rx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function T0e(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Yx(e):e;return{pathname:r?r.startsWith("/")?r:E0e(r,t):t,search:M0e(n),hash:P0e(a)}}function E0e(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function R3(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function A0e(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function E5(e,t){let r=A0e(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function A5(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Yx(e):(a=yT({},e),ko(!a.pathname||!a.pathname.includes("?"),R3("?","pathname","search",a)),ko(!a.pathname||!a.pathname.includes("#"),R3("#","pathname","hash",a)),ko(!a.search||!a.search.includes("#"),R3("#","search","hash",a)));let l=e===""||a.pathname==="",h=l?"/":a.pathname,i;if(h==null)i=r;else{let C=t.length-1;if(!n&&h.startsWith("..")){let I=h.split("/");for(;I[0]==="..";)I.shift(),C-=1;a.pathname=I.join("/")}i=C>=0?t[C]:"/"}let _=T0e(a,i),b=h&&h!=="/"&&h.endsWith("/"),E=(l||h===".")&&r.endsWith("/");return!_.pathname.endsWith("/")&&(b||E)&&(_.pathname+="/"),_}const lm=e=>e.join("/").replace(/\/\/+/g,"/"),C0e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),M0e=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,P0e=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function I0e(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Aee=["post","put","patch","delete"];new Set(Aee);const O0e=["get",...Aee];new Set(O0e);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vT(){return vT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vT.apply(this,arguments)}const Ak=ne.createContext(null),Cee=ne.createContext(null),cf=ne.createContext(null),Ck=ne.createContext(null),Zd=ne.createContext({outlet:null,matches:[],isDataRoute:!1}),Mee=ne.createContext(null);function k0e(e,t){let{relative:r}=t===void 0?{}:t;Kx()||ko(!1);let{basename:n,navigator:a}=ne.useContext(cf),{hash:l,pathname:h,search:i}=Mk(e,{relative:r}),_=h;return n!=="/"&&(_=h==="/"?n:lm([n,h])),a.createHref({pathname:_,search:i,hash:l})}function Kx(){return ne.useContext(Ck)!=null}function Ky(){return Kx()||ko(!1),ne.useContext(Ck).location}function Pee(e){ne.useContext(cf).static||ne.useLayoutEffect(e)}function Jy(){let{isDataRoute:e}=ne.useContext(Zd);return e?Z0e():R0e()}function R0e(){Kx()||ko(!1);let e=ne.useContext(Ak),{basename:t,future:r,navigator:n}=ne.useContext(cf),{matches:a}=ne.useContext(Zd),{pathname:l}=Ky(),h=JSON.stringify(E5(a,r.v7_relativeSplatPath)),i=ne.useRef(!1);return Pee(()=>{i.current=!0}),ne.useCallback(function(b,E){if(E===void 0&&(E={}),!i.current)return;if(typeof b=="number"){n.go(b);return}let C=A5(b,JSON.parse(h),l,E.relative==="path");e==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:lm([t,C.pathname])),(E.replace?n.replace:n.push)(C,E.state,E)},[t,n,h,l,e])}const D0e=ne.createContext(null);function L0e(e){let t=ne.useContext(Zd).outlet;return t&&ne.createElement(D0e.Provider,{value:e},t)}function N0e(){let{matches:e}=ne.useContext(Zd),t=e[e.length-1];return t?t.params:{}}function Mk(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=ne.useContext(cf),{matches:a}=ne.useContext(Zd),{pathname:l}=Ky(),h=JSON.stringify(E5(a,n.v7_relativeSplatPath));return ne.useMemo(()=>A5(e,JSON.parse(h),l,r==="path"),[e,h,l,r])}function z0e(e,t){return j0e(e,t)}function j0e(e,t,r,n){Kx()||ko(!1);let{navigator:a}=ne.useContext(cf),{matches:l}=ne.useContext(Zd),h=l[l.length-1],i=h?h.params:{};h&&h.pathname;let _=h?h.pathnameBase:"/";h&&h.route;let b=Ky(),E;if(t){var C;let q=typeof t=="string"?Yx(t):t;_==="/"||(C=q.pathname)!=null&&C.startsWith(_)||ko(!1),E=q}else E=b;let I=E.pathname||"/",F=I;if(_!=="/"){let q=_.replace(/^\//,"").split("/");F="/"+I.replace(/^\//,"").split("/").slice(q.length).join("/")}let $=u0e(e,{pathname:F}),B=V0e($&&$.map(q=>Object.assign({},q,{params:Object.assign({},i,q.params),pathname:lm([_,a.encodeLocation?a.encodeLocation(q.pathname).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?_:lm([_,a.encodeLocation?a.encodeLocation(q.pathnameBase).pathname:q.pathnameBase])})),l,r,n);return t&&B?ne.createElement(Ck.Provider,{value:{location:vT({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:Yp.Pop}},B):B}function F0e(){let e=H0e(),t=I0e(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},t),r?ne.createElement("pre",{style:a},r):null,null)}const B0e=ne.createElement(F0e,null);class $0e extends ne.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ne.createElement(Zd.Provider,{value:this.props.routeContext},ne.createElement(Mee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function U0e(e){let{routeContext:t,match:r,children:n}=e,a=ne.useContext(Ak);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),ne.createElement(Zd.Provider,{value:t},n)}function V0e(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var l;if(!r)return null;if(r.errors)e=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let h=e,i=(a=r)==null?void 0:a.errors;if(i!=null){let E=h.findIndex(C=>C.route.id&&(i==null?void 0:i[C.route.id])!==void 0);E>=0||ko(!1),h=h.slice(0,Math.min(h.length,E+1))}let _=!1,b=-1;if(r&&n&&n.v7_partialHydration)for(let E=0;E<h.length;E++){let C=h[E];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(b=E),C.route.id){let{loaderData:I,errors:F}=r,$=C.route.loader&&I[C.route.id]===void 0&&(!F||F[C.route.id]===void 0);if(C.route.lazy||$){_=!0,b>=0?h=h.slice(0,b+1):h=[h[0]];break}}}return h.reduceRight((E,C,I)=>{let F,$=!1,B=null,q=null;r&&(F=i&&C.route.id?i[C.route.id]:void 0,B=C.route.errorElement||B0e,_&&(b<0&&I===0?($=!0,q=null):b===I&&($=!0,q=C.route.hydrateFallbackElement||null)));let G=t.concat(h.slice(0,I+1)),H=()=>{let J;return F?J=B:$?J=q:C.route.Component?J=ne.createElement(C.route.Component,null):C.route.element?J=C.route.element:J=E,ne.createElement(U0e,{match:C,routeContext:{outlet:E,matches:G,isDataRoute:r!=null},children:J})};return r&&(C.route.ErrorBoundary||C.route.errorElement||I===0)?ne.createElement($0e,{location:r.location,revalidation:r.revalidation,component:B,error:F,children:H(),routeContext:{outlet:null,matches:G,isDataRoute:!0}}):H()},null)}var Iee=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Iee||{}),TI=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(TI||{});function W0e(e){let t=ne.useContext(Ak);return t||ko(!1),t}function G0e(e){let t=ne.useContext(Cee);return t||ko(!1),t}function q0e(e){let t=ne.useContext(Zd);return t||ko(!1),t}function Oee(e){let t=q0e(),r=t.matches[t.matches.length-1];return r.route.id||ko(!1),r.route.id}function H0e(){var e;let t=ne.useContext(Mee),r=G0e(TI.UseRouteError),n=Oee(TI.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Z0e(){let{router:e}=W0e(Iee.UseNavigateStable),t=Oee(TI.UseNavigateStable),r=ne.useRef(!1);return Pee(()=>{r.current=!0}),ne.useCallback(function(a,l){l===void 0&&(l={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,vT({fromRouteId:t},l)))},[e,t])}function X0e(e){let{to:t,replace:r,state:n,relative:a}=e;Kx()||ko(!1);let{future:l,static:h}=ne.useContext(cf),{matches:i}=ne.useContext(Zd),{pathname:_}=Ky(),b=Jy(),E=A5(t,E5(i,l.v7_relativeSplatPath),_,a==="path"),C=JSON.stringify(E);return ne.useEffect(()=>b(JSON.parse(C),{replace:r,state:n,relative:a}),[b,C,a,r,n]),null}function Y0e(e){return L0e(e.context)}function ia(e){ko(!1)}function K0e(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Yp.Pop,navigator:l,static:h=!1,future:i}=e;Kx()&&ko(!1);let _=t.replace(/^\/*/,"/"),b=ne.useMemo(()=>({basename:_,navigator:l,static:h,future:vT({v7_relativeSplatPath:!1},i)}),[_,i,l,h]);typeof n=="string"&&(n=Yx(n));let{pathname:E="/",search:C="",hash:I="",state:F=null,key:$="default"}=n,B=ne.useMemo(()=>{let q=rx(E,_);return q==null?null:{location:{pathname:q,search:C,hash:I,state:F,key:$},navigationType:a}},[_,E,C,I,F,$,a]);return B==null?null:ne.createElement(cf.Provider,{value:b},ne.createElement(Ck.Provider,{children:r,value:B}))}function J0e(e){let{children:t,location:r}=e;return z0e(fj(t),r)}new Promise(()=>{});function fj(e,t){t===void 0&&(t=[]);let r=[];return ne.Children.forEach(e,(n,a)=>{if(!ne.isValidElement(n))return;let l=[...t,a];if(n.type===ne.Fragment){r.push.apply(r,fj(n.props.children,l));return}n.type!==ia&&ko(!1),!n.props.index||!n.props.children||ko(!1);let h={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=fj(n.props.children,l)),r.push(h)}),r}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function EI(){return EI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EI.apply(this,arguments)}function kee(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Q0e(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function exe(e,t){return e.button===0&&(!t||t==="_self")&&!Q0e(e)}const txe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],rxe=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],nxe="6";try{window.__reactRouterVersion=nxe}catch{}const ixe=ne.createContext({isTransitioning:!1}),oxe="startTransition",$q=tk[oxe];function axe(e){let{basename:t,children:r,future:n,window:a}=e,l=ne.useRef();l.current==null&&(l.current=s0e({window:a,v5Compat:!0}));let h=l.current,[i,_]=ne.useState({action:h.action,location:h.location}),{v7_startTransition:b}=n||{},E=ne.useCallback(C=>{b&&$q?$q(()=>_(C)):_(C)},[_,b]);return ne.useLayoutEffect(()=>h.listen(E),[h,E]),ne.createElement(K0e,{basename:t,children:r,location:i.location,navigationType:i.action,navigator:h,future:n})}const sxe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lxe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vy=ne.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:l,replace:h,state:i,target:_,to:b,preventScrollReset:E,viewTransition:C}=t,I=kee(t,txe),{basename:F}=ne.useContext(cf),$,B=!1;if(typeof b=="string"&&lxe.test(b)&&($=b,sxe))try{let J=new URL(window.location.href),Q=b.startsWith("//")?new URL(J.protocol+b):new URL(b),oe=rx(Q.pathname,F);Q.origin===J.origin&&oe!=null?b=oe+Q.search+Q.hash:B=!0}catch{}let q=k0e(b,{relative:a}),G=dxe(b,{replace:h,state:i,target:_,preventScrollReset:E,relative:a,viewTransition:C});function H(J){n&&n(J),J.defaultPrevented||G(J)}return ne.createElement("a",EI({},I,{href:$||q,onClick:B||l?n:H,ref:r,target:_}))}),cxe=ne.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:l="",end:h=!1,style:i,to:_,viewTransition:b,children:E}=t,C=kee(t,rxe),I=Mk(_,{relative:C.relative}),F=Ky(),$=ne.useContext(Cee),{navigator:B,basename:q}=ne.useContext(cf),G=$!=null&&hxe(I)&&b===!0,H=B.encodeLocation?B.encodeLocation(I).pathname:I.pathname,J=F.pathname,Q=$&&$.navigation&&$.navigation.location?$.navigation.location.pathname:null;a||(J=J.toLowerCase(),Q=Q?Q.toLowerCase():null,H=H.toLowerCase()),Q&&q&&(Q=rx(Q,q)||Q);const oe=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let de=J===H||!h&&J.startsWith(H)&&J.charAt(oe)==="/",ae=Q!=null&&(Q===H||!h&&Q.startsWith(H)&&Q.charAt(H.length)==="/"),ve={isActive:de,isPending:ae,isTransitioning:G},Fe=de?n:void 0,ke;typeof l=="function"?ke=l(ve):ke=[l,de?"active":null,ae?"pending":null,G?"transitioning":null].filter(Boolean).join(" ");let Ce=typeof i=="function"?i(ve):i;return ne.createElement(vy,EI({},C,{"aria-current":Fe,className:ke,ref:r,style:Ce,to:_,viewTransition:b}),typeof E=="function"?E(ve):E)});var pj;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(pj||(pj={}));var Uq;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Uq||(Uq={}));function uxe(e){let t=ne.useContext(Ak);return t||ko(!1),t}function dxe(e,t){let{target:r,replace:n,state:a,preventScrollReset:l,relative:h,viewTransition:i}=t===void 0?{}:t,_=Jy(),b=Ky(),E=Mk(e,{relative:h});return ne.useCallback(C=>{if(exe(C,r)){C.preventDefault();let I=n!==void 0?n:wI(b)===wI(E);_(e,{replace:I,state:a,preventScrollReset:l,relative:h,viewTransition:i})}},[b,_,E,n,a,r,e,l,h,i])}function hxe(e,t){t===void 0&&(t={});let r=ne.useContext(ixe);r==null&&ko(!1);let{basename:n}=uxe(pj.useViewTransitionState),a=Mk(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=rx(r.currentLocation.pathname,n)||r.currentLocation.pathname,h=rx(r.nextLocation.pathname,n)||r.nextLocation.pathname;return SI(a.pathname,h)!=null||SI(a.pathname,l)!=null}const fxe="modulepreload",pxe=function(e){return"/r4logistica-demo/"+e},Vq={},nx=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),i=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));a=Promise.allSettled(r.map(_=>{if(_=pxe(_),_ in Vq)return;Vq[_]=!0;const b=_.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${E}`))return;const C=document.createElement("link");if(C.rel=b?"stylesheet":fxe,b||(C.as="script"),C.crossOrigin="",C.href=_,i&&C.setAttribute("nonce",i),document.head.appendChild(C),b)return new Promise((I,F)=>{C.addEventListener("load",I),C.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(h){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=h,window.dispatchEvent(i),!i.defaultPrevented)throw h}return a.then(h=>{for(const i of h||[])i.status==="rejected"&&l(i.reason);return t().catch(l)})},mxe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>nx(async()=>{const{default:n}=await Promise.resolve().then(()=>Jx);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class C5 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class gxe extends C5{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class yxe extends C5{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class vxe extends C5{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var mj;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(mj||(mj={}));var _xe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};class xxe{constructor(t,{headers:r={},customFetch:n,region:a=mj.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=mxe(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return _xe(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:h}=r;let i={},{region:_}=r;_||(_=this.region),_&&_!=="any"&&(i["x-region"]=_);let b;h&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",b=h):typeof h=="string"?(i["Content-Type"]="text/plain",b=h):typeof FormData<"u"&&h instanceof FormData?b=h:(i["Content-Type"]="application/json",b=JSON.stringify(h)));const E=yield this.fetch(`${this.url}/${t}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),a),body:b}).catch($=>{throw new gxe($)}),C=E.headers.get("x-relay-error");if(C&&C==="true")throw new yxe(E);if(!E.ok)throw new vxe(E);let I=((n=E.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),F;return I==="application/json"?F=yield E.json():I==="application/octet-stream"?F=yield E.blob():I==="text/event-stream"?F=E:I==="multipart/form-data"?F=yield E.formData():F=yield E.text(),{data:F,error:null}}catch(a){return{data:null,error:a}}})}}var yl={},M5={},Pk={},OE={},Ik={},Ok={},bxe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ix=bxe();const wxe=ix.fetch,Ree=ix.fetch.bind(ix),Dee=ix.Headers,Sxe=ix.Request,Txe=ix.Response,Jx=Object.freeze(Object.defineProperty({__proto__:null,Headers:Dee,Request:Sxe,Response:Txe,default:Ree,fetch:wxe},Symbol.toStringTag,{value:"Module"})),Exe=ofe(Jx);var kk={};Object.defineProperty(kk,"__esModule",{value:!0});let Axe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};kk.default=Axe;var Lee=Na&&Na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ok,"__esModule",{value:!0});const Cxe=Lee(Exe),Mxe=Lee(kk);let Pxe=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Cxe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var h,i,_;let b=null,E=null,C=null,I=l.status,F=l.statusText;if(l.ok){if(this.method!=="HEAD"){const G=await l.text();G===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=G:E=JSON.parse(G))}const B=(h=this.headers.Prefer)===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),q=(i=l.headers.get("content-range"))===null||i===void 0?void 0:i.split("/");B&&q&&q.length>1&&(C=parseInt(q[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(b={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,C=null,I=406,F="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const B=await l.text();try{b=JSON.parse(B),Array.isArray(b)&&l.status===404&&(E=[],b=null,I=200,F="OK")}catch{l.status===404&&B===""?(I=204,F="No Content"):b={message:B}}if(b&&this.isMaybeSingle&&(!((_=b==null?void 0:b.details)===null||_===void 0)&&_.includes("0 rows"))&&(b=null,I=200,F="OK"),b&&this.shouldThrowOnError)throw new Mxe.default(b)}return{error:b,data:E,count:C,status:I,statusText:F}});return this.shouldThrowOnError||(a=a.catch(l=>{var h,i,_;return{error:{message:`${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(i=l==null?void 0:l.stack)!==null&&i!==void 0?i:""}`,hint:"",code:`${(_=l==null?void 0:l.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Ok.default=Pxe;var Ixe=Na&&Na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ik,"__esModule",{value:!0});const Oxe=Ixe(Ok);let kxe=class extends Oxe.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:l=a}={}){const h=l?`${l}.order`:"order",i=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${i?`${i},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const l=typeof a>"u"?"offset":`${a}.offset`,h=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${t}`),this.url.searchParams.set(h,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:l=!1,format:h="text"}={}){var i;const _=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),b=(i=this.headers.Accept)!==null&&i!==void 0?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${b}"; options=${_};`,h==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ik.default=kxe;var Rxe=Na&&Na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(OE,"__esModule",{value:!0});const Dxe=Rxe(Ik);let Lxe=class extends Dxe.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const h=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${l}fts${h}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};OE.default=Lxe;var Nxe=Na&&Na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pk,"__esModule",{value:!0});const Tw=Nxe(OE);let zxe=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let l=!1;const h=(t??"*").split("").map(i=>/\s/.test(i)&&!l?"":(i==='"'&&(l=!l),i)).join("");return this.url.searchParams.set("select",h),n&&(this.headers.Prefer=`count=${n}`),new Tw.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),n||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const h=t.reduce((i,_)=>i.concat(Object.keys(_)),[]);if(h.length>0){const i=[...new Set(h)].map(_=>`"${_}"`);this.url.searchParams.set("columns",i.join(","))}}return new Tw.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:l=!0}={}){const h="POST",i=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&i.push(this.headers.Prefer),a&&i.push(`count=${a}`),l||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const _=t.reduce((b,E)=>b.concat(Object.keys(E)),[]);if(_.length>0){const b=[...new Set(_)].map(E=>`"${E}"`);this.url.searchParams.set("columns",b.join(","))}}return new Tw.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new Tw.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Tw.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Pk.default=zxe;var Rk={},Dk={};Object.defineProperty(Dk,"__esModule",{value:!0});Dk.version=void 0;Dk.version="0.0.0-automated";Object.defineProperty(Rk,"__esModule",{value:!0});Rk.DEFAULT_HEADERS=void 0;const jxe=Dk;Rk.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${jxe.version}`};var Nee=Na&&Na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(M5,"__esModule",{value:!0});const Fxe=Nee(Pk),Bxe=Nee(OE),$xe=Rk;let Uxe=class zee{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},$xe.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Fxe.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new zee(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:l}={}){let h;const i=new URL(`${this.url}/rpc/${t}`);let _;n||a?(h=n?"HEAD":"GET",Object.entries(r).filter(([E,C])=>C!==void 0).map(([E,C])=>[E,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([E,C])=>{i.searchParams.append(E,C)})):(h="POST",_=r);const b=Object.assign({},this.headers);return l&&(b.Prefer=`count=${l}`),new Bxe.default({method:h,url:i,headers:b,schema:this.schemaName,body:_,fetch:this.fetch,allowEmpty:!1})}};M5.default=Uxe;var Qx=Na&&Na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yl,"__esModule",{value:!0});yl.PostgrestError=yl.PostgrestBuilder=yl.PostgrestTransformBuilder=yl.PostgrestFilterBuilder=yl.PostgrestQueryBuilder=yl.PostgrestClient=void 0;const jee=Qx(M5);yl.PostgrestClient=jee.default;const Fee=Qx(Pk);yl.PostgrestQueryBuilder=Fee.default;const Bee=Qx(OE);yl.PostgrestFilterBuilder=Bee.default;const $ee=Qx(Ik);yl.PostgrestTransformBuilder=$ee.default;const Uee=Qx(Ok);yl.PostgrestBuilder=Uee.default;const Vee=Qx(kk);yl.PostgrestError=Vee.default;var Vxe=yl.default={PostgrestClient:jee.default,PostgrestQueryBuilder:Fee.default,PostgrestFilterBuilder:Bee.default,PostgrestTransformBuilder:$ee.default,PostgrestBuilder:Uee.default,PostgrestError:Vee.default};const{PostgrestClient:Wxe,PostgrestQueryBuilder:AQe,PostgrestFilterBuilder:CQe,PostgrestTransformBuilder:MQe,PostgrestBuilder:PQe,PostgrestError:IQe}=Vxe,Gxe="2.11.2",qxe={"X-Client-Info":`realtime-js/${Gxe}`},Hxe="1.0.0",Wee=1e4,Zxe=1e3;var A0;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(A0||(A0={}));var Fl;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Fl||(Fl={}));var _u;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_u||(_u={}));var gj;(function(e){e.websocket="websocket"})(gj||(gj={}));var Kg;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Kg||(Kg={}));class Xxe{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),l=r.getUint8(2);let h=this.HEADER_LENGTH+2;const i=n.decode(t.slice(h,h+a));h=h+a;const _=n.decode(t.slice(h,h+l));h=h+l;const b=JSON.parse(n.decode(t.slice(h,t.byteLength)));return{ref:null,topic:i,event:_,payload:b}}}class Gee{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var to;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(to||(to={}));const Wq=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((l,h)=>(l[h]=Yxe(h,e,t,a),l),{})},Yxe=(e,t,r,n)=>{const a=t.find(i=>i.name===e),l=a==null?void 0:a.type,h=r[e];return l&&!n.includes(l)?qee(l,h):yj(h)},qee=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return ebe(t,r)}switch(e){case to.bool:return Kxe(t);case to.float4:case to.float8:case to.int2:case to.int4:case to.int8:case to.numeric:case to.oid:return Jxe(t);case to.json:case to.jsonb:return Qxe(t);case to.timestamp:return tbe(t);case to.abstime:case to.date:case to.daterange:case to.int4range:case to.int8range:case to.money:case to.reltime:case to.text:case to.time:case to.timestamptz:case to.timetz:case to.tsrange:case to.tstzrange:return yj(t);default:return yj(t)}},yj=e=>e,Kxe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Jxe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Qxe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},ebe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const h=e.slice(1,r);try{l=JSON.parse("["+h+"]")}catch{l=h?h.split(","):[]}return l.map(i=>qee(t,i))}return e},tbe=e=>typeof e=="string"?e.replace(" ","T"):e,Hee=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class D3{constructor(t,r,n={},a=Wee){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gq;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gq||(Gq={}));class NS{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:h,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=NS.syncState(this.state,a,l,h),this.pendingDiffs.forEach(_=>{this.state=NS.syncDiff(this.state,_,l,h)}),this.pendingDiffs=[],i()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:h,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=NS.syncDiff(this.state,a,l,h),i())}),this.onJoin((a,l,h)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:h})}),this.onLeave((a,l,h)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const l=this.cloneDeep(t),h=this.transformState(r),i={},_={};return this.map(l,(b,E)=>{h[b]||(_[b]=E)}),this.map(h,(b,E)=>{const C=l[b];if(C){const I=E.map(q=>q.presence_ref),F=C.map(q=>q.presence_ref),$=E.filter(q=>F.indexOf(q.presence_ref)<0),B=C.filter(q=>I.indexOf(q.presence_ref)<0);$.length>0&&(i[b]=$),B.length>0&&(_[b]=B)}else i[b]=E}),this.syncDiff(l,{joins:i,leaves:_},n,a)}static syncDiff(t,r,n,a){const{joins:l,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(i,_)=>{var b;const E=(b=t[i])!==null&&b!==void 0?b:[];if(t[i]=this.cloneDeep(_),E.length>0){const C=t[i].map(F=>F.presence_ref),I=E.filter(F=>C.indexOf(F.presence_ref)<0);t[i].unshift(...I)}n(i,E,_)}),this.map(h,(i,_)=>{let b=t[i];if(!b)return;const E=_.map(C=>C.presence_ref);b=b.filter(C=>E.indexOf(C.presence_ref)<0),t[i]=b,a(i,b,_),b.length===0&&delete t[i]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qq;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(qq||(qq={}));var Hq;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Hq||(Hq={}));var Ah;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ah||(Ah={}));class P5{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Fl.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new D3(this,_u.join,this.params,this.timeout),this.rejoinTimer=new Gee(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Fl.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Fl.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Fl.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Fl.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_u.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new NS(this),this.broadcastEndpointURL=Hee(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:h,private:i}}=this.params;this._onError(E=>t==null?void 0:t(Ah.CHANNEL_ERROR,E)),this._onClose(()=>t==null?void 0:t(Ah.CLOSED));const _={},b={broadcast:l,presence:h,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(E=>E.filter))!==null&&a!==void 0?a:[],private:i};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:b},_)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:E})=>{var C;if(this.socket.setAuth(),E===void 0){t==null||t(Ah.SUBSCRIBED);return}else{const I=this.bindings.postgres_changes,F=(C=I==null?void 0:I.length)!==null&&C!==void 0?C:0,$=[];for(let B=0;B<F;B++){const q=I[B],{filter:{event:G,schema:H,table:J,filter:Q}}=q,oe=E&&E[B];if(oe&&oe.event===G&&oe.schema===H&&oe.table===J&&oe.filter===Q)$.push(Object.assign(Object.assign({},q),{id:oe.id}));else{this.unsubscribe(),t==null||t(Ah.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=$,t&&t(Ah.SUBSCRIBED);return}}).receive("error",E=>{t==null||t(Ah.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ah.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:h}=t,_={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:h,private:this.private}]})};try{const b=await this._fetchWithTimeout(this.broadcastEndpointURL,_,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=b.body)===null||a===void 0?void 0:a.cancel()),b.ok?"ok":"error"}catch(b){return b.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var h,i,_;const b=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((_=(i=(h=this.params)===null||h===void 0?void 0:h.config)===null||i===void 0?void 0:i.broadcast)===null||_===void 0)&&_.ack)&&l("ok"),b.receive("ok",()=>l("ok")),b.receive("error",()=>l("error")),b.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Fl.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_u.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new D3(this,_u.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),h=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(l),h}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new D3(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,l;const h=t.toLocaleLowerCase(),{close:i,error:_,leave:b,join:E}=_u;if(n&&[i,_,b,E].indexOf(h)>=0&&n!==this._joinRef())return;let I=this._onMessage(h,r,n);if(r&&!I)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(F=>{var $,B,q;return(($=F.filter)===null||$===void 0?void 0:$.event)==="*"||((q=(B=F.filter)===null||B===void 0?void 0:B.event)===null||q===void 0?void 0:q.toLocaleLowerCase())===h}).map(F=>F.callback(I,n)):(l=this.bindings[h])===null||l===void 0||l.filter(F=>{var $,B,q,G,H,J;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in F){const Q=F.id,oe=($=F.filter)===null||$===void 0?void 0:$.event;return Q&&((B=r.ids)===null||B===void 0?void 0:B.includes(Q))&&(oe==="*"||(oe==null?void 0:oe.toLocaleLowerCase())===((q=r.data)===null||q===void 0?void 0:q.type.toLocaleLowerCase()))}else{const Q=(H=(G=F==null?void 0:F.filter)===null||G===void 0?void 0:G.event)===null||H===void 0?void 0:H.toLocaleLowerCase();return Q==="*"||Q===((J=r==null?void 0:r.event)===null||J===void 0?void 0:J.toLocaleLowerCase())}else return F.type.toLocaleLowerCase()===h}).map(F=>{if(typeof I=="object"&&"ids"in I){const $=I.data,{schema:B,table:q,commit_timestamp:G,type:H,errors:J}=$;I=Object.assign(Object.assign({},{schema:B,table:q,commit_timestamp:G,eventType:H,new:{},old:{},errors:J}),this._getPayloadRecords($))}F.callback(I,n)})}_isClosed(){return this.state===Fl.closed}_isJoined(){return this.state===Fl.joined}_isJoining(){return this.state===Fl.joining}_isLeaving(){return this.state===Fl.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),l={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&P5.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_u.close,{},t)}_onError(t){this._on(_u.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Fl.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Wq(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Wq(t.columns,t.old_record)),r}}const rbe=()=>{},nbe=typeof WebSocket<"u",ibe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class obe{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=qxe,this.params={},this.timeout=Wee,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=rbe,this.conn=null,this.sendBuffer=[],this.serializer=new Xxe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let h;return l?h=l:typeof fetch>"u"?h=(...i)=>nx(async()=>{const{default:_}=await Promise.resolve().then(()=>Jx);return{default:_}},void 0).then(({default:_})=>_(...i)):h=fetch,(...i)=>h(...i)},this.endPoint=`${t}/${gj.websocket}`,this.httpEndpoint=Hee(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(l,h)=>h(JSON.stringify(l)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gee(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(nbe){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new abe(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),nx(async()=>{const{default:t}=await import("./browser-uv_rBAkB.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Hxe}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case A0.connecting:return Kg.Connecting;case A0.open:return Kg.Open;case A0.closing:return Kg.Closing;default:return Kg.Closed}}isConnected(){return this.connectionState()===Kg.Open}channel(t,r={config:{}}){const n=new P5(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:l}=t,h=()=>{this.encode(t,i=>{var _;(_=this.conn)===null||_===void 0||_.send(i)})};this.log("push",`${r} ${n} (${l})`,a),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(_u.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Zxe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:l,ref:h}=r;h&&h===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${n} ${a} ${h&&"("+h+")"||""}`,l),this.channels.filter(i=>i._isMember(n)).forEach(i=>i._trigger(a,l,h)),this.stateChangeCallbacks.message.forEach(i=>i(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(_u.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([ibe],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class abe{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=A0.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class I5 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ra(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class sbe extends I5{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class vj extends I5{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var lbe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const Zee=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>nx(async()=>{const{default:n}=await Promise.resolve().then(()=>Jx);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},cbe=()=>lbe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield nx(()=>Promise.resolve().then(()=>Jx),void 0)).Response:Response}),_j=e=>{if(Array.isArray(e))return e.map(r=>_j(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[a]=_j(n)}),t};var Qy=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const L3=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ube=(e,t,r)=>Qy(void 0,void 0,void 0,function*(){const n=yield cbe();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new sbe(L3(a),e.status||500))}).catch(a=>{t(new vj(L3(a),a))}):t(new vj(L3(e),e))}),dbe=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function kE(e,t,r,n,a,l){return Qy(this,void 0,void 0,function*(){return new Promise((h,i)=>{e(r,dbe(t,n,a,l)).then(_=>{if(!_.ok)throw _;return n!=null&&n.noResolveJson?_:_.json()}).then(_=>h(_)).catch(_=>ube(_,i,n))})})}function AI(e,t,r,n){return Qy(this,void 0,void 0,function*(){return kE(e,"GET",t,r,n)})}function Ip(e,t,r,n,a){return Qy(this,void 0,void 0,function*(){return kE(e,"POST",t,n,a,r)})}function hbe(e,t,r,n,a){return Qy(this,void 0,void 0,function*(){return kE(e,"PUT",t,n,a,r)})}function fbe(e,t,r,n){return Qy(this,void 0,void 0,function*(){return kE(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Xee(e,t,r,n,a){return Qy(this,void 0,void 0,function*(){return kE(e,"DELETE",t,n,a,r)})}var nl=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const pbe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zq={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class mbe{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Zee(a)}uploadOrUpdate(t,r,n,a){return nl(this,void 0,void 0,function*(){try{let l;const h=Object.assign(Object.assign({},Zq),a);let i=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(h.upsert)});const _=h.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",h.cacheControl),_&&l.append("metadata",this.encodeMetadata(_)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",h.cacheControl),_&&l.append("metadata",this.encodeMetadata(_))):(l=n,i["cache-control"]=`max-age=${h.cacheControl}`,i["content-type"]=h.contentType,_&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(_)))),a!=null&&a.headers&&(i=Object.assign(Object.assign({},i),a.headers));const b=this._removeEmptyFolders(r),E=this._getFinalPath(b),C=yield this.fetch(`${this.url}/object/${E}`,Object.assign({method:t,body:l,headers:i},h!=null&&h.duplex?{duplex:h.duplex}:{})),I=yield C.json();return C.ok?{data:{path:b,id:I.Id,fullPath:I.Key},error:null}:{data:null,error:I}}catch(l){if(Ra(l))return{data:null,error:l};throw l}})}upload(t,r,n){return nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return nl(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),h=this._getFinalPath(l),i=new URL(this.url+`/object/upload/sign/${h}`);i.searchParams.set("token",r);try{let _;const b=Object.assign({upsert:Zq.upsert},a),E=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});typeof Blob<"u"&&n instanceof Blob?(_=new FormData,_.append("cacheControl",b.cacheControl),_.append("",n)):typeof FormData<"u"&&n instanceof FormData?(_=n,_.append("cacheControl",b.cacheControl)):(_=n,E["cache-control"]=`max-age=${b.cacheControl}`,E["content-type"]=b.contentType);const C=yield this.fetch(i.toString(),{method:"PUT",body:_,headers:E}),I=yield C.json();return C.ok?{data:{path:l,fullPath:I.Key},error:null}:{data:null,error:I}}catch(_){if(Ra(_))return{data:null,error:_};throw _}})}createSignedUploadUrl(t,r){return nl(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const l=yield Ip(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),h=new URL(this.url+l.url),i=h.searchParams.get("token");if(!i)throw new I5("No token returned by API");return{data:{signedUrl:h.toString(),path:t,token:i},error:null}}catch(n){if(Ra(n))return{data:null,error:n};throw n}})}update(t,r,n){return nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return nl(this,void 0,void 0,function*(){try{return{data:yield Ip(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Ra(a))return{data:null,error:a};throw a}})}copy(t,r,n){return nl(this,void 0,void 0,function*(){try{return{data:{path:(yield Ip(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Ra(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return nl(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),l=yield Ip(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const h=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${h}`)},{data:l,error:null}}catch(a){if(Ra(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return nl(this,void 0,void 0,function*(){try{const a=yield Ip(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${l}`):null})),error:null}}catch(a){if(Ra(a))return{data:null,error:a};throw a}})}download(t,r){return nl(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),h=l?`?${l}`:"";try{const i=this._getFinalPath(t);return{data:yield(yield AI(this.fetch,`${this.url}/${a}/${i}${h}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(Ra(i))return{data:null,error:i};throw i}})}info(t){return nl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield AI(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:_j(n),error:null}}catch(n){if(Ra(n))return{data:null,error:n};throw n}})}exists(t){return nl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield fbe(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Ra(n)&&n instanceof vj){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&a.push(l);const i=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",_=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});_!==""&&a.push(_);let b=a.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${b}`)}}}remove(t){return nl(this,void 0,void 0,function*(){try{return{data:yield Xee(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Ra(r))return{data:null,error:r};throw r}})}list(t,r,n){return nl(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},pbe),r),{prefix:t||""});return{data:yield Ip(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Ra(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const gbe="2.7.1",ybe={"X-Client-Info":`storage-js/${gbe}`};var v_=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};class vbe{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},ybe),r),this.fetch=Zee(n)}listBuckets(){return v_(this,void 0,void 0,function*(){try{return{data:yield AI(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Ra(t))return{data:null,error:t};throw t}})}getBucket(t){return v_(this,void 0,void 0,function*(){try{return{data:yield AI(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Ra(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return v_(this,void 0,void 0,function*(){try{return{data:yield Ip(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ra(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return v_(this,void 0,void 0,function*(){try{return{data:yield hbe(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ra(n))return{data:null,error:n};throw n}})}emptyBucket(t){return v_(this,void 0,void 0,function*(){try{return{data:yield Ip(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Ra(r))return{data:null,error:r};throw r}})}deleteBucket(t){return v_(this,void 0,void 0,function*(){try{return{data:yield Xee(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Ra(r))return{data:null,error:r};throw r}})}}class _be extends vbe{constructor(t,r={},n){super(t,r,n)}from(t){return new mbe(this.url,this.headers,t,this.fetch)}}const xbe="2.49.4";let Xw="";typeof Deno<"u"?Xw="deno":typeof document<"u"?Xw="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xw="react-native":Xw="node";const bbe={"X-Client-Info":`supabase-js-${Xw}/${xbe}`},wbe={headers:bbe},Sbe={schema:"public"},Tbe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ebe={};var Abe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const Cbe=e=>{let t;return e?t=e:typeof fetch>"u"?t=Ree:t=fetch,(...r)=>t(...r)},Mbe=()=>typeof Headers>"u"?Dee:Headers,Pbe=(e,t,r)=>{const n=Cbe(r),a=Mbe();return(l,h)=>Abe(void 0,void 0,void 0,function*(){var i;const _=(i=yield t())!==null&&i!==void 0?i:e;let b=new a(h==null?void 0:h.headers);return b.has("apikey")||b.set("apikey",e),b.has("Authorization")||b.set("Authorization",`Bearer ${_}`),n(l,Object.assign(Object.assign({},h),{headers:b}))})};var Ibe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};function Obe(e){return e.replace(/\/$/,"")}function kbe(e,t){const{db:r,auth:n,realtime:a,global:l}=e,{db:h,auth:i,realtime:_,global:b}=t,E={db:Object.assign(Object.assign({},h),r),auth:Object.assign(Object.assign({},i),n),realtime:Object.assign(Object.assign({},_),a),global:Object.assign(Object.assign({},b),l),accessToken:()=>Ibe(this,void 0,void 0,function*(){return""})};return e.accessToken?E.accessToken=e.accessToken:delete E.accessToken,E}const Yee="2.69.1",k_=30*1e3,xj=3,N3=xj*k_,Rbe="http://localhost:9999",Dbe="supabase.auth.token",Lbe={"X-Client-Info":`gotrue-js/${Yee}`},bj="X-Supabase-Api-Version",Kee={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Nbe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,zbe=6e5;class O5 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Fn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class jbe extends O5{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Fbe(e){return Fn(e)&&e.name==="AuthApiError"}class Jee extends O5{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Im extends O5{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class vp extends Im{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Bbe(e){return Fn(e)&&e.name==="AuthSessionMissingError"}class z3 extends Im{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class yC extends Im{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class vC extends Im{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $be(e){return Fn(e)&&e.name==="AuthImplicitGrantRedirectError"}class Xq extends Im{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wj extends Im{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function j3(e){return Fn(e)&&e.name==="AuthRetryableFetchError"}class Yq extends Im{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class zS extends Im{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Kq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jq=` 	
\r=`.split(""),Ube=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Jq.length;t+=1)e[Jq[t].charCodeAt(0)]=-2;for(let t=0;t<Kq.length;t+=1)e[Kq[t].charCodeAt(0)]=t;return e})();function Qee(e,t,r){const n=Ube[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Qq(e){const t=[],r=h=>{t.push(String.fromCodePoint(h))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=h=>{Gbe(h,n,r)};for(let h=0;h<e.length;h+=1)Qee(e.charCodeAt(h),a,l);return t.join("")}function Vbe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Wbe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}Vbe(n,t)}}function Gbe(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function qbe(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Qee(e.charCodeAt(a),r,n);return new Uint8Array(t)}function Hbe(e){const t=[];return Wbe(e,r=>t.push(r)),new Uint8Array(t)}function Zbe(e){return Math.round(Date.now()/1e3)+e}function Xbe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const fd=()=>typeof window<"u"&&typeof document<"u",Dg={tested:!1,writable:!1},jS=()=>{if(!fd())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Dg.tested)return Dg.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Dg.tested=!0,Dg.writable=!0}catch{Dg.tested=!0,Dg.writable=!1}return Dg.writable};function Ybe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,l)=>{t[l]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const ete=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>nx(async()=>{const{default:n}=await Promise.resolve().then(()=>Jx);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Kbe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",tte=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},_C=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},xC=async(e,t)=>{await e.removeItem(t)};class Lk{constructor(){this.promise=new Lk.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Lk.promiseConstructor=Promise;function F3(e){const t=e.split(".");if(t.length!==3)throw new zS("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Nbe.test(t[n]))throw new zS("JWT not in base64url format");return{header:JSON.parse(Qq(t[0])),payload:JSON.parse(Qq(t[1])),signature:qbe(t[2]),raw:{header:t[0],payload:t[1]}}}async function Jbe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Qbe(e,t){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const h=await e(l);if(!t(l,null,h)){n(h);return}}catch(h){if(!t(l,h)){a(h);return}}})()})}function e1e(e){return("0"+e.toString(16)).substr(-2)}function t1e(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let l=0;l<56;l++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,e1e).join("")}async function r1e(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function n1e(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await r1e(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function __(e,t,r=!1){const n=t1e();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await tte(e,`${t}-code-verifier`,a);const l=await n1e(n);return[l,n===l?"plain":"s256"]}const i1e=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function o1e(e){const t=e.headers.get(bj);if(!t||!t.match(i1e))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function a1e(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function s1e(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var l1e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Bg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),c1e=[502,503,504];async function eH(e){var t;if(!Kbe(e))throw new wj(Bg(e),0);if(c1e.includes(e.status))throw new wj(Bg(e),e.status);let r;try{r=await e.json()}catch(l){throw new Jee(Bg(l),l)}let n;const a=o1e(e);if(a&&a.getTime()>=Kee["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Yq(Bg(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new vp}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,h)=>l&&typeof h=="string",!0))throw new Yq(Bg(r),e.status,r.weak_password.reasons);throw new jbe(Bg(r),e.status||500,n)}const u1e=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function ni(e,t,r,n){var a;const l=Object.assign({},n==null?void 0:n.headers);l[bj]||(l[bj]=Kee["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const h=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(h.redirect_to=n.redirectTo);const i=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",_=await d1e(e,t,r+i,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(_):{data:Object.assign({},_),error:null}}async function d1e(e,t,r,n,a,l){const h=u1e(t,n,a,l);let i;try{i=await e(r,Object.assign({},h))}catch(_){throw console.error(_),new wj(Bg(_),0)}if(i.ok||await eH(i),n!=null&&n.noResolveJson)return i;try{return await i.json()}catch(_){await eH(_)}}function _p(e){var t;let r=null;m1e(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Zbe(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function tH(e){const t=_p(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Dp(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function h1e(e){return{data:e,error:null}}function f1e(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l}=e,h=l1e(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l},_=Object.assign({},h);return{data:{properties:i,user:_},error:null}}function p1e(e){return e}function m1e(e){return e.access_token&&e.refresh_token&&e.expires_in}var g1e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class y1e{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=ete(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await ni(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ni(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Dp})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=g1e(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await ni(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:f1e,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Fn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ni(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Dp})}catch(r){if(Fn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,l,h,i,_;try{const b={nextPage:null,lastPage:0,total:0},E=await ni(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:p1e});if(E.error)throw E.error;const C=await E.json(),I=(h=E.headers.get("x-total-count"))!==null&&h!==void 0?h:0,F=(_=(i=E.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&_!==void 0?_:[];return F.length>0&&(F.forEach($=>{const B=parseInt($.split(";")[0].split("=")[1].substring(0,1)),q=JSON.parse($.split(";")[1].split("=")[1]);b[`${q}Page`]=B}),b.total=parseInt(I)),{data:Object.assign(Object.assign({},C),b),error:null}}catch(b){if(Fn(b))return{data:{users:[]},error:b};throw b}}async getUserById(t){try{return await ni(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Dp})}catch(r){if(Fn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await ni(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Dp})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await ni(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Dp})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await ni(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await ni(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}}}const v1e={getItem:e=>jS()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{jS()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{jS()&&globalThis.localStorage.removeItem(e)}};function rH(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function _1e(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const x_={debug:!!(globalThis&&jS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rte extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class x1e extends rte{}async function b1e(e,t,r){x_.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),x_.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){x_.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{x_.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw x_.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new x1e(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(x_.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}_1e();const w1e={url:Rbe,storageKey:Dbe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Lbe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function nH(e,t,r){return await r()}class _T{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_T.nextInstanceID,_T.nextInstanceID+=1,this.instanceID>0&&fd()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},w1e),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new y1e({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ete(a.fetch),this.lock=a.lock||nH,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:fd()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=b1e:this.lock=nH,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:jS()?this.storage=v1e:(this.memoryStorage={},this.storage=rH(this.memoryStorage)):(this.memoryStorage={},this.storage=rH(this.memoryStorage)),fd()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Yee}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Ybe(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),fd()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),$be(l)){const _=(t=l.details)===null||t===void 0?void 0:t.code;if(_==="identity_already_exists"||_==="identity_not_found"||_==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:h,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",h,"redirect type",i),await this._saveSession(h),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Fn(r)?{error:r}:{error:new Jee("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const l=await ni(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:_p}),{data:h,error:i}=l;if(i||!h)return{data:{user:null,session:null},error:i};const _=h.session,b=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(l){if(Fn(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var r,n,a;try{let l;if("email"in t){const{email:E,password:C,options:I}=t;let F=null,$=null;this.flowType==="pkce"&&([F,$]=await __(this.storage,this.storageKey)),l=await ni(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:I==null?void 0:I.emailRedirectTo,body:{email:E,password:C,data:(r=I==null?void 0:I.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken},code_challenge:F,code_challenge_method:$},xform:_p})}else if("phone"in t){const{phone:E,password:C,options:I}=t;l=await ni(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:E,password:C,data:(n=I==null?void 0:I.data)!==null&&n!==void 0?n:{},channel:(a=I==null?void 0:I.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken}},xform:_p})}else throw new yC("You must provide either an email or phone number and a password");const{data:h,error:i}=l;if(i||!h)return{data:{user:null,session:null},error:i};const _=h.session,b=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(l){if(Fn(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:h,options:i}=t;r=await ni(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:h,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:tH})}else if("phone"in t){const{phone:l,password:h,options:i}=t;r=await ni(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:h,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:tH})}else throw new yC("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new z3}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await _C(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:l,error:h}=await ni(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:_p});if(await xC(this.storage,`${this.storageKey}-code-verifier`),h)throw h;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new z3}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:h})}catch(l){if(Fn(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:l,nonce:h}=t,i=await ni(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:h,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:_p}),{data:_,error:b}=i;return b?{data:{user:null,session:null},error:b}:!_||!_.session||!_.user?{data:{user:null,session:null},error:new z3}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:_,error:b})}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,l,h;try{if("email"in t){const{email:i,options:_}=t;let b=null,E=null;this.flowType==="pkce"&&([b,E]=await __(this.storage,this.storageKey));const{error:C}=await ni(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},create_user:(n=_==null?void 0:_.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:b,code_challenge_method:E},redirectTo:_==null?void 0:_.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:i,options:_}=t,{data:b,error:E}=await ni(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(a=_==null?void 0:_.data)!==null&&a!==void 0?a:{},create_user:(l=_==null?void 0:_.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},channel:(h=_==null?void 0:_.channel)!==null&&h!==void 0?h:"sms"}});return{data:{user:null,session:null,messageId:b==null?void 0:b.message_id},error:E}}throw new yC("You must provide either an email or phone number.")}catch(i){if(Fn(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(t){var r,n;try{let a,l;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:h,error:i}=await ni(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:_p});if(i)throw i;if(!h)throw new Error("An error occurred on token verification.");const _=h.session,b=h.user;return _!=null&&_.access_token&&(await this._saveSession(_),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(a){if(Fn(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let l=null,h=null;return this.flowType==="pkce"&&([l,h]=await __(this.storage,this.storageKey)),await ni(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:h}),headers:this.headers,xform:h1e})}catch(l){if(Fn(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new vp;const{error:a}=await ni(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Fn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:l}=t,{error:h}=await ni(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}else if("phone"in t){const{phone:n,type:a,options:l}=t,{data:h,error:i}=await ni(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:i}}throw new yC("You must provide either an email or phone number and a type")}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await _C(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<N3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let h=this.suppressGetSessionWarning;t=new Proxy(t,{get:(_,b,E)=>(!h&&b==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),h=!0,this.suppressGetSessionWarning=!0),Reflect.get(_,b,E))})}return{data:{session:t},error:null}}const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ni(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Dp}):await this._useSession(async r=>{var n,a,l;const{data:h,error:i}=r;if(i)throw i;return!(!((n=h.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new vp}:await ni(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=h.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Dp})})}catch(r){if(Fn(r))return Bbe(r)&&(await this._removeSession(),await xC(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new vp;const h=a.session;let i=null,_=null;this.flowType==="pkce"&&t.email!=null&&([i,_]=await __(this.storage,this.storageKey));const{data:b,error:E}=await ni(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:i,code_challenge_method:_}),jwt:h.access_token,xform:Dp});if(E)throw E;return h.user=b.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),{data:{user:h.user},error:null}})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new vp;const r=Date.now()/1e3;let n=r,a=!0,l=null;const{payload:h}=F3(t.access_token);if(h.exp&&(n=h.exp,a=n<=r),a){const{session:i,error:_}=await this._callRefreshToken(t.refresh_token);if(_)return{data:{user:null,session:null},error:_};if(!i)return{data:{user:null,session:null},error:null};l=i}else{const{data:i,error:_}=await this._getUser(t.access_token);if(_)throw _;l={access_token:t.access_token,refresh_token:t.refresh_token,user:i.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(Fn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:h,error:i}=r;if(i)throw i;t=(n=h.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new vp;const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!fd())throw new vC("No browser detected.");if(t.error||t.error_description||t.error_code)throw new vC(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Xq("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new vC("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Xq("No code detected.");const{data:H,error:J}=await this._exchangeCodeForSession(t.code);if(J)throw J;const Q=new URL(window.location.href);return Q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Q.toString()),{data:{session:H.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:h,expires_in:i,expires_at:_,token_type:b}=t;if(!l||!i||!h||!b)throw new vC("No session defined in URL");const E=Math.round(Date.now()/1e3),C=parseInt(i);let I=E+C;_&&(I=parseInt(_));const F=I-E;F*1e3<=k_&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${F}s, should have been closer to ${C}s`);const $=I-C;E-$>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",$,I,E):E-$<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",$,I,E);const{data:B,error:q}=await this._getUser(l);if(q)throw q;const G={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:C,expires_at:I,refresh_token:h,token_type:b,user:B.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:G,redirectType:t.type},error:null}}catch(n){if(Fn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await _C(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return{error:l};const h=(n=a.session)===null||n===void 0?void 0:n.access_token;if(h){const{error:i}=await this.admin.signOut(h,t);if(i&&!(Fbe(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return t!=="others"&&(await this._removeSession(),await xC(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Xbe(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:l},error:h}=r;if(h)throw h;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await __(this.storage,this.storageKey,!0));try{return await ni(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(Fn(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async l=>{var h,i,_,b,E;const{data:C,error:I}=l;if(I)throw I;const F=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(h=t.options)===null||h===void 0?void 0:h.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(_=t.options)===null||_===void 0?void 0:_.queryParams,skipBrowserRedirect:!0});return await ni(this.fetch,"GET",F,{headers:this.headers,jwt:(E=(b=C.session)===null||b===void 0?void 0:b.access_token)!==null&&E!==void 0?E:void 0})});if(a)throw a;return fd()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Fn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:h}=r;if(h)throw h;return await ni(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Qbe(async a=>(a>0&&await Jbe(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await ni(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:_p})),(a,l)=>{const h=200*Math.pow(2,a);return l&&j3(l)&&Date.now()+h-n<k_})}catch(n){if(this._debug(r,"error",n),Fn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),fd()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await _C(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<N3;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${N3}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),j3(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new vp;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Lk;const{data:l,error:h}=await this._refreshAccessToken(t);if(h)throw h;if(!l.session)throw new vp;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const i={session:l.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(l){if(this._debug(a,"error",l),Fn(l)){const h={session:null,error:l};return j3(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],h=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(t,r)}catch(_){l.push(_)}});if(await Promise.all(h),l.length>0){for(let i=0;i<l.length;i+=1)console.error(l[i]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await tte(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await xC(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&fd()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),k_);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/k_);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${k_}ms, refresh threshold is ${xj} ticks`),a<=xj&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof rte)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fd()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,h]=await __(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(h)}`});a.push(i.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?{data:null,error:l}:await ni(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:h}=r;if(h)return{data:null,error:h};const i=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:_,error:b}=await ni(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return b?{data:null,error:b}:(t.factorType==="totp"&&(!((a=_==null?void 0:_.totp)===null||a===void 0)&&a.qr_code)&&(_.totp.qr_code=`data:image/svg+xml;utf-8,${_.totp.qr_code}`),{data:_,error:null})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return{data:null,error:l};const{data:h,error:i}=await ni(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:i})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?{data:null,error:l}:await ni(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(h=>h.factor_type==="totp"&&h.status==="verified"),l=n.filter(h=>h.factor_type==="phone"&&h.status==="verified");return{data:{all:n,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:l}=t;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=F3(a.access_token);let i=null;h.aal&&(i=h.aal);let _=i;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(C=>C.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(_="aal2");const E=h.amr||[];return{data:{currentLevel:i,nextLevel:_,currentAuthenticationMethods:E},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(h=>h.kid===t);if(n||(n=this.jwks.keys.find(h=>h.kid===t),n&&this.jwks_cached_at+zbe>Date.now()))return n;const{data:a,error:l}=await ni(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;if(!a.keys||a.keys.length===0)throw new zS("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(h=>h.kid===t),!n)throw new zS("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:F,error:$}=await this.getSession();if($||!F.session)return{data:null,error:$};n=F.session.access_token}const{header:a,payload:l,signature:h,raw:{header:i,payload:_}}=F3(n);if(a1e(l.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:F}=await this.getUser(n);if(F)throw F;return{data:{claims:l,header:a,signature:h},error:null}}const b=s1e(a.alg),E=await this.fetchJwk(a.kid,r),C=await crypto.subtle.importKey("jwk",E,b,!0,["verify"]);if(!await crypto.subtle.verify(b,C,h,Hbe(`${i}.${_}`)))throw new zS("Invalid JWT signature");return{data:{claims:l,header:a,signature:h},error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}}}_T.nextInstanceID=0;const S1e=_T;class T1e extends S1e{constructor(t){super(t)}}var E1e=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function i(E){try{b(n.next(E))}catch(C){h(C)}}function _(E){try{b(n.throw(E))}catch(C){h(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};class A1e{constructor(t,r,n){var a,l,h;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const i=Obe(t);this.realtimeUrl=`${i}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.functionsUrl=`${i}/functions/v1`;const _=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,b={db:Sbe,realtime:Ebe,auth:Object.assign(Object.assign({},Tbe),{storageKey:_}),global:wbe},E=kbe(n??{},b);this.storageKey=(a=E.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=E.global.headers)!==null&&l!==void 0?l:{},E.accessToken?(this.accessToken=E.accessToken,this.auth=new Proxy({},{get:(C,I)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(I)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=E.auth)!==null&&h!==void 0?h:{},this.headers,E.global.fetch),this.fetch=Pbe(r,this._getAccessToken.bind(this),E.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},E.realtime)),this.rest=new Wxe(`${i}/rest/v1`,{headers:this.headers,schema:E.db.schema,fetch:this.fetch}),E.accessToken||this._listenForAuthEvents()}get functions(){return new xxe(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new _be(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return E1e(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:l,flowType:h,lock:i,debug:_},b,E){const C={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new T1e({url:this.authUrl,headers:Object.assign(Object.assign({},C),b),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:h,lock:i,debug:_,fetch:E,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new obe(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const C1e=(e,t,r)=>new A1e(e,t,r),M1e="https://vjhouhxasitabbqooqqh.supabase.co",P1e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZqaG91aHhhc2l0YWJicW9vcXFoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3ODIxNzcsImV4cCI6MjA2MDM1ODE3N30.GJ7CV3J7IdyY7_A4a0CsxWxBQ7nHpLnGD8bVlbKxJs4",Oi=C1e(M1e,P1e),_o=({to:e,icon:t,label:r,exactMatch:n=!1})=>j.jsxs(cxe,{to:e,className:({isActive:a})=>Tr("flex items-center text-sidebar-foreground gap-2 py-2 px-3 my-1 rounded-md transition-colors","hover:bg-sidebar-accent/80 hover:text-sidebar-accent-foreground",a&&"active-nav-link"),end:n,children:[j.jsx(t,{className:"h-5 w-5"}),j.jsx("span",{children:r})]}),B3=({title:e,children:t,defaultOpen:r=!1})=>{const[n,a]=Ae.useState(r);return j.jsxs("div",{className:"mb-3",children:[j.jsxs("button",{onClick:()=>a(!n),className:"flex items-center justify-between w-full text-sidebar-foreground px-3 py-2 text-sm",children:[j.jsx("span",{className:"font-medium uppercase tracking-wider text-xs",children:e}),j.jsx(r5,{className:Tr("h-4 w-4 transition-transform",n&&"transform rotate-180")})]}),j.jsx("div",{className:Tr("space-y-1 overflow-hidden transition-all",n?"max-h-96":"max-h-0"),children:t})]})},I1e=()=>{const[e,t]=Ae.useState(!1);return j.jsxs("div",{className:Tr("bg-sidebar h-screen transition-all duration-300 flex flex-col border-r border-sidebar-border",e?"w-16":"w-64"),children:[j.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-sidebar-border",children:[!e&&j.jsxs("h1",{className:"text-xl font-bold text-white tracking-tight",children:[j.jsx("span",{className:"text-logistics-400",children:"4r"}),"logística"]}),e&&j.jsx("div",{className:"mx-auto",children:j.jsx("span",{className:"text-xl font-bold text-logistics-400",children:"4r"})}),j.jsx("button",{onClick:()=>t(!e),className:"text-sidebar-foreground hover:text-white p-1 rounded-md hover:bg-sidebar-accent/50 transition-colors",children:j.jsx(n5,{className:Tr("h-5 w-5 transition-transform",e&&"transform rotate-180")})})]}),j.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:e?j.jsxs("div",{className:"flex flex-col items-center space-y-4 mt-4",children:[j.jsx(_o,{to:"/admin",icon:hq,label:"",exactMatch:!0}),j.jsx(_o,{to:"/admin/orders",icon:lq,label:""}),j.jsx(_o,{to:"/admin/manual-order",icon:uq,label:""}),j.jsx(_o,{to:"/admin/routes",icon:u0,label:""}),j.jsx(_o,{to:"/admin/packages",icon:w0,label:""}),j.jsx(_o,{to:"/admin/inventory",icon:cq,label:""}),j.jsx(_o,{to:"/admin/fleet",icon:fT,label:""}),j.jsx(_o,{to:"/admin/operators",icon:cM,label:""}),j.jsx(_o,{to:"/admin/tms",icon:dq,label:""}),j.jsx(_o,{to:"/admin/tracking",icon:u0,label:""}),j.jsx(_o,{to:"/admin/documents",icon:sq,label:""}),j.jsx(_o,{to:"/admin/settings",icon:Wz,label:""})]}):j.jsxs(j.Fragment,{children:[j.jsx(_o,{to:"/admin",icon:hq,label:"Dashboard",exactMatch:!0}),j.jsxs(B3,{title:"Gestión",defaultOpen:!0,children:[j.jsx(_o,{to:"/admin/orders",icon:lq,label:"Órdenes"}),j.jsx(_o,{to:"/admin/manual-order",icon:uq,label:"Orden Manual"}),j.jsx(_o,{to:"/admin/routes",icon:u0,label:"Rutas"}),j.jsx(_o,{to:"/admin/packages",icon:w0,label:"Paquetes"})]}),j.jsxs(B3,{title:"Inventario y Flota",children:[j.jsx(_o,{to:"/admin/inventory",icon:cq,label:"Inventario"}),j.jsx(_o,{to:"/admin/fleet",icon:fT,label:"Flota"}),j.jsx(_o,{to:"/admin/operators",icon:cM,label:"Operadores"})]}),j.jsxs(B3,{title:"Operaciones",children:[j.jsx(_o,{to:"/admin/tms",icon:dq,label:"TMS"}),j.jsx(_o,{to:"/admin/tracking",icon:u0,label:"Tracking"}),j.jsx(_o,{to:"/admin/documents",icon:sq,label:"Documentación"})]}),j.jsx("div",{className:"mt-auto pt-4",children:j.jsx(_o,{to:"/admin/settings",icon:Wz,label:"Configuración"})})]})}),!e&&j.jsx("div",{className:"border-t border-sidebar-border p-4",children:j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 rounded-full bg-logistics-600 flex items-center justify-center text-white",children:j.jsx(cM,{className:"h-4 w-4"})}),j.jsxs("div",{children:[j.jsx("p",{className:"text-sm font-medium text-sidebar-foreground",children:"Admin User"}),j.jsx("p",{className:"text-xs text-sidebar-foreground/70",children:"administrator@swiftship.com"})]})]})})]})},O1e=()=>{const e=Jy();return ne.useEffect(()=>{(async()=>{const{data:{session:n}}=await Oi.auth.getSession();n||e("/login",{replace:!0})})();const{data:{subscription:r}}=Oi.auth.onAuthStateChange((n,a)=>{a||e("/login",{replace:!0})});return()=>r.unsubscribe()},[e]),j.jsxs("div",{className:"flex h-screen bg-background",children:[j.jsx(I1e,{}),j.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[j.jsxs("header",{className:"bg-white border-b h-16 flex items-center justify-between px-6",children:[j.jsx("div",{className:"flex items-center",children:j.jsxs("div",{className:"relative w-64",children:[j.jsx(_k,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),j.jsx("input",{type:"text",placeholder:"Buscar...",className:"border rounded-md pl-8 pr-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"})]})}),j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsxs("button",{className:"relative p-2 text-muted-foreground hover:text-foreground rounded-md hover:bg-gray-100 transition-colors",children:[j.jsx(Mge,{className:"h-5 w-5"}),j.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),j.jsx("button",{className:"relative p-2 text-muted-foreground hover:text-foreground rounded-md hover:bg-gray-100 transition-colors",children:j.jsx(Fge,{className:"h-5 w-5"})}),j.jsx("div",{className:"h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white",children:j.jsx("span",{className:"font-medium text-sm",children:"AD"})})]})]}),j.jsx("main",{className:"flex-1 overflow-y-auto bg-background p-6",children:j.jsx(Y0e,{})})]})]})},Sj=Wx("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Yn=ne.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},l)=>{const h=n?Yh:"button";return j.jsx(h,{className:Tr(Sj({variant:t,size:r,className:e})),ref:l,...a})});Yn.displayName="Button";const wi=ne.forwardRef(({className:e,type:t,...r},n)=>j.jsx("input",{type:t,className:Tr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));wi.displayName="Input";function k1e(){const e=Jy(),[t,r]=ne.useState(!1),[n,a]=ne.useState(""),[l,h]=ne.useState("");ne.useEffect(()=>{(async()=>{const{data:{session:b}}=await Oi.auth.getSession();b&&e("/admin",{replace:!0})})()},[e]);const i=async _=>{_.preventDefault(),r(!0);try{const{error:b}=await Oi.auth.signInWithPassword({email:n,password:l});if(b)throw b;e("/admin")}catch(b){pI({variant:"destructive",title:"Error al iniciar sesión",description:b.message})}finally{r(!1)}};return j.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:j.jsxs("div",{className:"max-w-md w-full space-y-8",children:[j.jsx("div",{children:j.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Iniciar Sesión"})}),j.jsxs("form",{className:"mt-8 space-y-6",onSubmit:i,children:[j.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[j.jsx("div",{children:j.jsx(wi,{type:"email",required:!0,value:n,onChange:_=>a(_.target.value),placeholder:"Correo electrónico"})}),j.jsx("div",{children:j.jsx(wi,{type:"password",required:!0,value:l,onChange:_=>h(_.target.value),placeholder:"Contraseña"})})]}),j.jsx("div",{children:j.jsx(Yn,{type:"submit",className:"w-full",disabled:t,children:t?"Iniciando sesión...":"Iniciar sesión"})})]})]})})}function R1e(){const[e,t]=ne.useState(!1),[r,n]=ne.useState(""),[a,l]=ne.useState(""),[h,i]=ne.useState(""),[_,b]=ne.useState(""),E=async C=>{C.preventDefault(),t(!0);try{const{data:{user:I},error:F}=await Oi.auth.admin.createUser({email:r,password:a,email_confirm:!0,user_metadata:{first_name:h,last_name:_}});if(F)throw F;pI({title:"Usuario creado",description:`Se ha creado el usuario ${r} exitosamente.`}),n(""),l(""),i(""),b("")}catch(I){pI({variant:"destructive",title:"Error al crear usuario",description:I.message})}finally{t(!1)}};return j.jsxs("div",{className:"container mx-auto px-4 py-8",children:[j.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),j.jsx("div",{className:"max-w-md",children:j.jsxs("form",{onSubmit:E,className:"space-y-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nombre"}),j.jsx(wi,{type:"text",value:h,onChange:C=>i(C.target.value),required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Apellido"}),j.jsx(wi,{type:"text",value:_,onChange:C=>b(C.target.value),required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Correo electrónico"}),j.jsx(wi,{type:"email",value:r,onChange:C=>n(C.target.value),required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contraseña"}),j.jsx(wi,{type:"password",value:a,onChange:C=>l(C.target.value),required:!0,minLength:6})]}),j.jsx(Yn,{type:"submit",className:"w-full",disabled:e,children:e?"Creando usuario...":"Crear usuario"})]})})]})}var D1e=Array.isArray,Ml=D1e,L1e=typeof Na=="object"&&Na&&Na.Object===Object&&Na,nte=L1e,N1e=nte,z1e=typeof self=="object"&&self&&self.Object===Object&&self,j1e=N1e||z1e||Function("return this")(),Xd=j1e,F1e=Xd,B1e=F1e.Symbol,RE=B1e,iH=RE,ite=Object.prototype,$1e=ite.hasOwnProperty,U1e=ite.toString,Ew=iH?iH.toStringTag:void 0;function V1e(e){var t=$1e.call(e,Ew),r=e[Ew];try{e[Ew]=void 0;var n=!0}catch{}var a=U1e.call(e);return n&&(t?e[Ew]=r:delete e[Ew]),a}var W1e=V1e,G1e=Object.prototype,q1e=G1e.toString;function H1e(e){return q1e.call(e)}var Z1e=H1e,oH=RE,X1e=W1e,Y1e=Z1e,K1e="[object Null]",J1e="[object Undefined]",aH=oH?oH.toStringTag:void 0;function Q1e(e){return e==null?e===void 0?J1e:K1e:aH&&aH in Object(e)?X1e(e):Y1e(e)}var uf=Q1e;function ewe(e){return e!=null&&typeof e=="object"}var df=ewe,twe=uf,rwe=df,nwe="[object Symbol]";function iwe(e){return typeof e=="symbol"||rwe(e)&&twe(e)==nwe}var eb=iwe,owe=Ml,awe=eb,swe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,lwe=/^\w*$/;function cwe(e,t){if(owe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||awe(e)?!0:lwe.test(e)||!swe.test(e)||t!=null&&e in Object(t)}var k5=cwe;function uwe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Om=uwe;const tb=yi(Om);var dwe=uf,hwe=Om,fwe="[object AsyncFunction]",pwe="[object Function]",mwe="[object GeneratorFunction]",gwe="[object Proxy]";function ywe(e){if(!hwe(e))return!1;var t=dwe(e);return t==pwe||t==mwe||t==fwe||t==gwe}var R5=ywe;const Xn=yi(R5);var vwe=Xd,_we=vwe["__core-js_shared__"],xwe=_we,$3=xwe,sH=function(){var e=/[^.]+$/.exec($3&&$3.keys&&$3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function bwe(e){return!!sH&&sH in e}var wwe=bwe,Swe=Function.prototype,Twe=Swe.toString;function Ewe(e){if(e!=null){try{return Twe.call(e)}catch{}try{return e+""}catch{}}return""}var ote=Ewe,Awe=R5,Cwe=wwe,Mwe=Om,Pwe=ote,Iwe=/[\\^$.*+?()[\]{}|]/g,Owe=/^\[object .+?Constructor\]$/,kwe=Function.prototype,Rwe=Object.prototype,Dwe=kwe.toString,Lwe=Rwe.hasOwnProperty,Nwe=RegExp("^"+Dwe.call(Lwe).replace(Iwe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zwe(e){if(!Mwe(e)||Cwe(e))return!1;var t=Awe(e)?Nwe:Owe;return t.test(Pwe(e))}var jwe=zwe;function Fwe(e,t){return e==null?void 0:e[t]}var Bwe=Fwe,$we=jwe,Uwe=Bwe;function Vwe(e,t){var r=Uwe(e,t);return $we(r)?r:void 0}var ev=Vwe,Wwe=ev,Gwe=Wwe(Object,"create"),Nk=Gwe,lH=Nk;function qwe(){this.__data__=lH?lH(null):{},this.size=0}var Hwe=qwe;function Zwe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Xwe=Zwe,Ywe=Nk,Kwe="__lodash_hash_undefined__",Jwe=Object.prototype,Qwe=Jwe.hasOwnProperty;function eSe(e){var t=this.__data__;if(Ywe){var r=t[e];return r===Kwe?void 0:r}return Qwe.call(t,e)?t[e]:void 0}var tSe=eSe,rSe=Nk,nSe=Object.prototype,iSe=nSe.hasOwnProperty;function oSe(e){var t=this.__data__;return rSe?t[e]!==void 0:iSe.call(t,e)}var aSe=oSe,sSe=Nk,lSe="__lodash_hash_undefined__";function cSe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=sSe&&t===void 0?lSe:t,this}var uSe=cSe,dSe=Hwe,hSe=Xwe,fSe=tSe,pSe=aSe,mSe=uSe;function rb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}rb.prototype.clear=dSe;rb.prototype.delete=hSe;rb.prototype.get=fSe;rb.prototype.has=pSe;rb.prototype.set=mSe;var gSe=rb;function ySe(){this.__data__=[],this.size=0}var vSe=ySe;function _Se(e,t){return e===t||e!==e&&t!==t}var D5=_Se,xSe=D5;function bSe(e,t){for(var r=e.length;r--;)if(xSe(e[r][0],t))return r;return-1}var zk=bSe,wSe=zk,SSe=Array.prototype,TSe=SSe.splice;function ESe(e){var t=this.__data__,r=wSe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():TSe.call(t,r,1),--this.size,!0}var ASe=ESe,CSe=zk;function MSe(e){var t=this.__data__,r=CSe(t,e);return r<0?void 0:t[r][1]}var PSe=MSe,ISe=zk;function OSe(e){return ISe(this.__data__,e)>-1}var kSe=OSe,RSe=zk;function DSe(e,t){var r=this.__data__,n=RSe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var LSe=DSe,NSe=vSe,zSe=ASe,jSe=PSe,FSe=kSe,BSe=LSe;function nb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}nb.prototype.clear=NSe;nb.prototype.delete=zSe;nb.prototype.get=jSe;nb.prototype.has=FSe;nb.prototype.set=BSe;var jk=nb,$Se=ev,USe=Xd,VSe=$Se(USe,"Map"),L5=VSe,cH=gSe,WSe=jk,GSe=L5;function qSe(){this.size=0,this.__data__={hash:new cH,map:new(GSe||WSe),string:new cH}}var HSe=qSe;function ZSe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var XSe=ZSe,YSe=XSe;function KSe(e,t){var r=e.__data__;return YSe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Fk=KSe,JSe=Fk;function QSe(e){var t=JSe(this,e).delete(e);return this.size-=t?1:0,t}var eTe=QSe,tTe=Fk;function rTe(e){return tTe(this,e).get(e)}var nTe=rTe,iTe=Fk;function oTe(e){return iTe(this,e).has(e)}var aTe=oTe,sTe=Fk;function lTe(e,t){var r=sTe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var cTe=lTe,uTe=HSe,dTe=eTe,hTe=nTe,fTe=aTe,pTe=cTe;function ib(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ib.prototype.clear=uTe;ib.prototype.delete=dTe;ib.prototype.get=hTe;ib.prototype.has=fTe;ib.prototype.set=pTe;var N5=ib,ate=N5,mTe="Expected a function";function z5(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(mTe);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],l=r.cache;if(l.has(a))return l.get(a);var h=e.apply(this,n);return r.cache=l.set(a,h)||l,h};return r.cache=new(z5.Cache||ate),r}z5.Cache=ate;var ste=z5;const gTe=yi(ste);var yTe=ste,vTe=500;function _Te(e){var t=yTe(e,function(n){return r.size===vTe&&r.clear(),n}),r=t.cache;return t}var xTe=_Te,bTe=xTe,wTe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,STe=/\\(\\)?/g,TTe=bTe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(wTe,function(r,n,a,l){t.push(a?l.replace(STe,"$1"):n||r)}),t}),ETe=TTe;function ATe(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var j5=ATe,uH=RE,CTe=j5,MTe=Ml,PTe=eb,ITe=1/0,dH=uH?uH.prototype:void 0,hH=dH?dH.toString:void 0;function lte(e){if(typeof e=="string")return e;if(MTe(e))return CTe(e,lte)+"";if(PTe(e))return hH?hH.call(e):"";var t=e+"";return t=="0"&&1/e==-ITe?"-0":t}var OTe=lte,kTe=OTe;function RTe(e){return e==null?"":kTe(e)}var cte=RTe,DTe=Ml,LTe=k5,NTe=ETe,zTe=cte;function jTe(e,t){return DTe(e)?e:LTe(e,t)?[e]:NTe(zTe(e))}var ute=jTe,FTe=eb,BTe=1/0;function $Te(e){if(typeof e=="string"||FTe(e))return e;var t=e+"";return t=="0"&&1/e==-BTe?"-0":t}var Bk=$Te,UTe=ute,VTe=Bk;function WTe(e,t){t=UTe(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[VTe(t[r++])];return r&&r==n?e:void 0}var F5=WTe,GTe=F5;function qTe(e,t,r){var n=e==null?void 0:GTe(e,t);return n===void 0?r:n}var dte=qTe;const Rc=yi(dte);function HTe(e){return e==null}var ZTe=HTe;const ui=yi(ZTe);var XTe=uf,YTe=Ml,KTe=df,JTe="[object String]";function QTe(e){return typeof e=="string"||!YTe(e)&&KTe(e)&&XTe(e)==JTe}var eEe=QTe;const DE=yi(eEe);var hte={exports:{}},zi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B5=Symbol.for("react.element"),$5=Symbol.for("react.portal"),$k=Symbol.for("react.fragment"),Uk=Symbol.for("react.strict_mode"),Vk=Symbol.for("react.profiler"),Wk=Symbol.for("react.provider"),Gk=Symbol.for("react.context"),tEe=Symbol.for("react.server_context"),qk=Symbol.for("react.forward_ref"),Hk=Symbol.for("react.suspense"),Zk=Symbol.for("react.suspense_list"),Xk=Symbol.for("react.memo"),Yk=Symbol.for("react.lazy"),rEe=Symbol.for("react.offscreen"),fte;fte=Symbol.for("react.module.reference");function Fc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case B5:switch(e=e.type,e){case $k:case Vk:case Uk:case Hk:case Zk:return e;default:switch(e=e&&e.$$typeof,e){case tEe:case Gk:case qk:case Yk:case Xk:case Wk:return e;default:return t}}case $5:return t}}}zi.ContextConsumer=Gk;zi.ContextProvider=Wk;zi.Element=B5;zi.ForwardRef=qk;zi.Fragment=$k;zi.Lazy=Yk;zi.Memo=Xk;zi.Portal=$5;zi.Profiler=Vk;zi.StrictMode=Uk;zi.Suspense=Hk;zi.SuspenseList=Zk;zi.isAsyncMode=function(){return!1};zi.isConcurrentMode=function(){return!1};zi.isContextConsumer=function(e){return Fc(e)===Gk};zi.isContextProvider=function(e){return Fc(e)===Wk};zi.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===B5};zi.isForwardRef=function(e){return Fc(e)===qk};zi.isFragment=function(e){return Fc(e)===$k};zi.isLazy=function(e){return Fc(e)===Yk};zi.isMemo=function(e){return Fc(e)===Xk};zi.isPortal=function(e){return Fc(e)===$5};zi.isProfiler=function(e){return Fc(e)===Vk};zi.isStrictMode=function(e){return Fc(e)===Uk};zi.isSuspense=function(e){return Fc(e)===Hk};zi.isSuspenseList=function(e){return Fc(e)===Zk};zi.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===$k||e===Vk||e===Uk||e===Hk||e===Zk||e===rEe||typeof e=="object"&&e!==null&&(e.$$typeof===Yk||e.$$typeof===Xk||e.$$typeof===Wk||e.$$typeof===Gk||e.$$typeof===qk||e.$$typeof===fte||e.getModuleId!==void 0)};zi.typeOf=Fc;hte.exports=zi;var pte=hte.exports,nEe=uf,iEe=df,oEe="[object Number]";function aEe(e){return typeof e=="number"||iEe(e)&&nEe(e)==oEe}var mte=aEe;const sEe=yi(mte);var lEe=mte;function cEe(e){return lEe(e)&&e!=+e}var uEe=cEe;const ob=yi(uEe);var Cu=function(t){return t===0?0:t>0?1:-1},ty=function(t){return DE(t)&&t.indexOf("%")===t.length-1},Sr=function(t){return sEe(t)&&!ob(t)},Aa=function(t){return Sr(t)||DE(t)},dEe=0,LE=function(t){var r=++dEe;return"".concat(t||"").concat(r)},Dy=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Sr(t)&&!DE(t))return n;var l;if(ty(t)){var h=t.indexOf("%");l=r*parseFloat(t.slice(0,h))/100}else l=+t;return ob(l)&&(l=n),a&&l>r&&(l=r),l},Lp=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},hEe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Cc=function(t,r){return Sr(t)&&Sr(r)?function(n){return t+n*(r-t)}:function(){return r}};function CI(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Rc(n,t))===r})}function C0(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function Tj(e){"@babel/helpers - typeof";return Tj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tj(e)}var fEe=["viewBox","children"],pEe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],fH=["points","pathLength"],U3={svg:fEe,polygon:fH,polyline:fH},U5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],MI=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(ne.isValidElement(t)&&(n=t.props),!tb(n))return null;var a={};return Object.keys(n).forEach(function(l){U5.includes(l)&&(a[l]=r||function(h){return n[l](n,h)})}),a},mEe=function(t,r,n){return function(a){return t(r,n,a),null}},PI=function(t,r,n){if(!tb(t)||Tj(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(l){var h=t[l];U5.includes(l)&&typeof h=="function"&&(a||(a={}),a[l]=mEe(h,r,n))}),a},gEe=["children"],yEe=["children"];function pH(e,t){if(e==null)return{};var r=vEe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Ej(e){"@babel/helpers - typeof";return Ej=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ej(e)}var mH={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Fh=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},gH=null,V3=null,V5=function e(t){if(t===gH&&Array.isArray(V3))return V3;var r=[];return ne.Children.forEach(t,function(n){ui(n)||(pte.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),V3=r,gH=t,r};function ku(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return Fh(a)}):n=[Fh(t)],V5(e).forEach(function(a){var l=Rc(a,"type.displayName")||Rc(a,"type.name");n.indexOf(l)!==-1&&r.push(a)}),r}function Wl(e,t){var r=ku(e,t);return r&&r[0]}var yH=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Sr(n)||n<=0||!Sr(a)||a<=0)},_Ee=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],xEe=function(t){return t&&t.type&&DE(t.type)&&_Ee.indexOf(t.type)>=0},bEe=function(t){return t&&Ej(t)==="object"&&"clipDot"in t},wEe=function(t,r,n,a){var l,h=(l=U3==null?void 0:U3[a])!==null&&l!==void 0?l:[];return!Xn(t)&&(a&&h.includes(r)||pEe.includes(r))||n&&U5.includes(r)},ti=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(ne.isValidElement(t)&&(a=t.props),!tb(a))return null;var l={};return Object.keys(a).forEach(function(h){var i;wEe((i=a)===null||i===void 0?void 0:i[h],h,r,n)&&(l[h]=a[h])}),l},Aj=function e(t,r){if(t===r)return!0;var n=ne.Children.count(t);if(n!==ne.Children.count(r))return!1;if(n===0)return!0;if(n===1)return vH(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var l=t[a],h=r[a];if(Array.isArray(l)||Array.isArray(h)){if(!e(l,h))return!1}else if(!vH(l,h))return!1}return!0},vH=function(t,r){if(ui(t)&&ui(r))return!0;if(!ui(t)&&!ui(r)){var n=t.props||{},a=n.children,l=pH(n,gEe),h=r.props||{},i=h.children,_=pH(h,yEe);return a&&i?C0(l,_)&&Aj(a,i):!a&&!i?C0(l,_):!1}return!1},_H=function(t,r){var n=[],a={};return V5(t).forEach(function(l,h){if(xEe(l))n.push(l);else if(l){var i=Fh(l.type),_=r[i]||{},b=_.handler,E=_.once;if(b&&(!E||!a[i])){var C=b(l,i,h);n.push(C),a[i]=!0}}}),n},SEe=function(t){var r=t&&t.type;return r&&mH[r]?mH[r]:null},TEe=function(t,r){return V5(r).indexOf(t)},EEe=["children","width","height","viewBox","className","style","title","desc"];function Cj(){return Cj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cj.apply(this,arguments)}function AEe(e,t){if(e==null)return{};var r=CEe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function CEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Mj(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,l=e.className,h=e.style,i=e.title,_=e.desc,b=AEe(e,EEe),E=a||{width:r,height:n,x:0,y:0},C=gi("recharts-surface",l);return Ae.createElement("svg",Cj({},ti(b,!0,"svg"),{className:C,width:r,height:n,style:h,viewBox:"".concat(E.x," ").concat(E.y," ").concat(E.width," ").concat(E.height)}),Ae.createElement("title",null,i),Ae.createElement("desc",null,_),t)}var MEe=["children","className"];function Pj(){return Pj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pj.apply(this,arguments)}function PEe(e,t){if(e==null)return{};var r=IEe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Io=Ae.forwardRef(function(e,t){var r=e.children,n=e.className,a=PEe(e,MEe),l=gi("recharts-layer",n);return Ae.createElement("g",Pj({className:l},ti(a,!0),{ref:t}),r)}),Bh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l]};function OEe(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var l=Array(a);++n<a;)l[n]=e[n+t];return l}var kEe=OEe,REe=kEe;function DEe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:REe(e,t,r)}var LEe=DEe,NEe="\\ud800-\\udfff",zEe="\\u0300-\\u036f",jEe="\\ufe20-\\ufe2f",FEe="\\u20d0-\\u20ff",BEe=zEe+jEe+FEe,$Ee="\\ufe0e\\ufe0f",UEe="\\u200d",VEe=RegExp("["+UEe+NEe+BEe+$Ee+"]");function WEe(e){return VEe.test(e)}var gte=WEe;function GEe(e){return e.split("")}var qEe=GEe,yte="\\ud800-\\udfff",HEe="\\u0300-\\u036f",ZEe="\\ufe20-\\ufe2f",XEe="\\u20d0-\\u20ff",YEe=HEe+ZEe+XEe,KEe="\\ufe0e\\ufe0f",JEe="["+yte+"]",Ij="["+YEe+"]",Oj="\\ud83c[\\udffb-\\udfff]",QEe="(?:"+Ij+"|"+Oj+")",vte="[^"+yte+"]",_te="(?:\\ud83c[\\udde6-\\uddff]){2}",xte="[\\ud800-\\udbff][\\udc00-\\udfff]",e2e="\\u200d",bte=QEe+"?",wte="["+KEe+"]?",t2e="(?:"+e2e+"(?:"+[vte,_te,xte].join("|")+")"+wte+bte+")*",r2e=wte+bte+t2e,n2e="(?:"+[vte+Ij+"?",Ij,_te,xte,JEe].join("|")+")",i2e=RegExp(Oj+"(?="+Oj+")|"+n2e+r2e,"g");function o2e(e){return e.match(i2e)||[]}var a2e=o2e,s2e=qEe,l2e=gte,c2e=a2e;function u2e(e){return l2e(e)?c2e(e):s2e(e)}var d2e=u2e,h2e=LEe,f2e=gte,p2e=d2e,m2e=cte;function g2e(e){return function(t){t=m2e(t);var r=f2e(t)?p2e(t):void 0,n=r?r[0]:t.charAt(0),a=r?h2e(r,1).join(""):t.slice(1);return n[e]()+a}}var y2e=g2e,v2e=y2e,_2e=v2e("toUpperCase"),x2e=_2e;const Kk=yi(x2e);function ro(e){return function(){return e}}const Ste=Math.cos,II=Math.sin,qu=Math.sqrt,OI=Math.PI,Jk=2*OI,kj=Math.PI,Rj=2*kj,$g=1e-6,b2e=Rj-$g;function Tte(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function w2e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Tte;const r=10**t;return function(n){this._+=n[0];for(let a=1,l=n.length;a<l;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class S2e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Tte:w2e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,l,h){this._append`C${+t},${+r},${+n},${+a},${this._x1=+l},${this._y1=+h}`}arcTo(t,r,n,a,l){if(t=+t,r=+r,n=+n,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let h=this._x1,i=this._y1,_=n-t,b=a-r,E=h-t,C=i-r,I=E*E+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(I>$g)if(!(Math.abs(C*_-b*E)>$g)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let F=n-h,$=a-i,B=_*_+b*b,q=F*F+$*$,G=Math.sqrt(B),H=Math.sqrt(I),J=l*Math.tan((kj-Math.acos((B+I-q)/(2*G*H)))/2),Q=J/H,oe=J/G;Math.abs(Q-1)>$g&&this._append`L${t+Q*E},${r+Q*C}`,this._append`A${l},${l},0,0,${+(C*F>E*$)},${this._x1=t+oe*_},${this._y1=r+oe*b}`}}arc(t,r,n,a,l,h){if(t=+t,r=+r,n=+n,h=!!h,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),_=n*Math.sin(a),b=t+i,E=r+_,C=1^h,I=h?a-l:l-a;this._x1===null?this._append`M${b},${E}`:(Math.abs(this._x1-b)>$g||Math.abs(this._y1-E)>$g)&&this._append`L${b},${E}`,n&&(I<0&&(I=I%Rj+Rj),I>b2e?this._append`A${n},${n},0,1,${C},${t-i},${r-_}A${n},${n},0,1,${C},${this._x1=b},${this._y1=E}`:I>$g&&this._append`A${n},${n},0,${+(I>=kj)},${C},${this._x1=t+n*Math.cos(l)},${this._y1=r+n*Math.sin(l)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function W5(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new S2e(t)}function G5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ete(e){this._context=e}Ete.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Qk(e){return new Ete(e)}function Ate(e){return e[0]}function Cte(e){return e[1]}function Mte(e,t){var r=ro(!0),n=null,a=Qk,l=null,h=W5(i);e=typeof e=="function"?e:e===void 0?Ate:ro(e),t=typeof t=="function"?t:t===void 0?Cte:ro(t);function i(_){var b,E=(_=G5(_)).length,C,I=!1,F;for(n==null&&(l=a(F=h())),b=0;b<=E;++b)!(b<E&&r(C=_[b],b,_))===I&&((I=!I)?l.lineStart():l.lineEnd()),I&&l.point(+e(C,b,_),+t(C,b,_));if(F)return l=null,F+""||null}return i.x=function(_){return arguments.length?(e=typeof _=="function"?_:ro(+_),i):e},i.y=function(_){return arguments.length?(t=typeof _=="function"?_:ro(+_),i):t},i.defined=function(_){return arguments.length?(r=typeof _=="function"?_:ro(!!_),i):r},i.curve=function(_){return arguments.length?(a=_,n!=null&&(l=a(n)),i):a},i.context=function(_){return arguments.length?(_==null?n=l=null:l=a(n=_),i):n},i}function bC(e,t,r){var n=null,a=ro(!0),l=null,h=Qk,i=null,_=W5(b);e=typeof e=="function"?e:e===void 0?Ate:ro(+e),t=typeof t=="function"?t:ro(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Cte:ro(+r);function b(C){var I,F,$,B=(C=G5(C)).length,q,G=!1,H,J=new Array(B),Q=new Array(B);for(l==null&&(i=h(H=_())),I=0;I<=B;++I){if(!(I<B&&a(q=C[I],I,C))===G)if(G=!G)F=I,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),$=I-1;$>=F;--$)i.point(J[$],Q[$]);i.lineEnd(),i.areaEnd()}G&&(J[I]=+e(q,I,C),Q[I]=+t(q,I,C),i.point(n?+n(q,I,C):J[I],r?+r(q,I,C):Q[I]))}if(H)return i=null,H+""||null}function E(){return Mte().defined(a).curve(h).context(l)}return b.x=function(C){return arguments.length?(e=typeof C=="function"?C:ro(+C),n=null,b):e},b.x0=function(C){return arguments.length?(e=typeof C=="function"?C:ro(+C),b):e},b.x1=function(C){return arguments.length?(n=C==null?null:typeof C=="function"?C:ro(+C),b):n},b.y=function(C){return arguments.length?(t=typeof C=="function"?C:ro(+C),r=null,b):t},b.y0=function(C){return arguments.length?(t=typeof C=="function"?C:ro(+C),b):t},b.y1=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:ro(+C),b):r},b.lineX0=b.lineY0=function(){return E().x(e).y(t)},b.lineY1=function(){return E().x(e).y(r)},b.lineX1=function(){return E().x(n).y(t)},b.defined=function(C){return arguments.length?(a=typeof C=="function"?C:ro(!!C),b):a},b.curve=function(C){return arguments.length?(h=C,l!=null&&(i=h(l)),b):h},b.context=function(C){return arguments.length?(C==null?l=i=null:i=h(l=C),b):l},b}class Pte{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function T2e(e){return new Pte(e,!0)}function E2e(e){return new Pte(e,!1)}const q5={draw(e,t){const r=qu(t/OI);e.moveTo(r,0),e.arc(0,0,r,0,Jk)}},A2e={draw(e,t){const r=qu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Ite=qu(1/3),C2e=Ite*2,M2e={draw(e,t){const r=qu(t/C2e),n=r*Ite;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},P2e={draw(e,t){const r=qu(t),n=-r/2;e.rect(n,n,r,r)}},I2e=.8908130915292852,Ote=II(OI/10)/II(7*OI/10),O2e=II(Jk/10)*Ote,k2e=-Ste(Jk/10)*Ote,R2e={draw(e,t){const r=qu(t*I2e),n=O2e*r,a=k2e*r;e.moveTo(0,-r),e.lineTo(n,a);for(let l=1;l<5;++l){const h=Jk*l/5,i=Ste(h),_=II(h);e.lineTo(_*r,-i*r),e.lineTo(i*n-_*a,_*n+i*a)}e.closePath()}},W3=qu(3),D2e={draw(e,t){const r=-qu(t/(W3*3));e.moveTo(0,r*2),e.lineTo(-W3*r,-r),e.lineTo(W3*r,-r),e.closePath()}},vc=-.5,_c=qu(3)/2,Dj=1/qu(12),L2e=(Dj/2+1)*3,N2e={draw(e,t){const r=qu(t/L2e),n=r/2,a=r*Dj,l=n,h=r*Dj+r,i=-l,_=h;e.moveTo(n,a),e.lineTo(l,h),e.lineTo(i,_),e.lineTo(vc*n-_c*a,_c*n+vc*a),e.lineTo(vc*l-_c*h,_c*l+vc*h),e.lineTo(vc*i-_c*_,_c*i+vc*_),e.lineTo(vc*n+_c*a,vc*a-_c*n),e.lineTo(vc*l+_c*h,vc*h-_c*l),e.lineTo(vc*i+_c*_,vc*_-_c*i),e.closePath()}};function z2e(e,t){let r=null,n=W5(a);e=typeof e=="function"?e:ro(e||q5),t=typeof t=="function"?t:ro(t===void 0?64:+t);function a(){let l;if(r||(r=l=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:ro(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:ro(+l),a):t},a.context=function(l){return arguments.length?(r=l??null,a):r},a}function kI(){}function RI(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function kte(e){this._context=e}kte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:RI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:RI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function j2e(e){return new kte(e)}function Rte(e){this._context=e}Rte.prototype={areaStart:kI,areaEnd:kI,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:RI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function F2e(e){return new Rte(e)}function Dte(e){this._context=e}Dte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:RI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function B2e(e){return new Dte(e)}function Lte(e){this._context=e}Lte.prototype={areaStart:kI,areaEnd:kI,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function $2e(e){return new Lte(e)}function xH(e){return e<0?-1:1}function bH(e,t,r){var n=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(n||a<0&&-0),h=(r-e._y1)/(a||n<0&&-0),i=(l*a+h*n)/(n+a);return(xH(l)+xH(h))*Math.min(Math.abs(l),Math.abs(h),.5*Math.abs(i))||0}function wH(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function G3(e,t,r){var n=e._x0,a=e._y0,l=e._x1,h=e._y1,i=(l-n)/3;e._context.bezierCurveTo(n+i,a+i*t,l-i,h-i*r,l,h)}function DI(e){this._context=e}DI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:G3(this,this._t0,wH(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,G3(this,wH(this,r=bH(this,e,t)),r);break;default:G3(this,this._t0,r=bH(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Nte(e){this._context=new zte(e)}(Nte.prototype=Object.create(DI.prototype)).point=function(e,t){DI.prototype.point.call(this,t,e)};function zte(e){this._context=e}zte.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,l){this._context.bezierCurveTo(t,e,n,r,l,a)}};function U2e(e){return new DI(e)}function V2e(e){return new Nte(e)}function jte(e){this._context=e}jte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=SH(e),a=SH(t),l=0,h=1;h<r;++l,++h)this._context.bezierCurveTo(n[0][l],a[0][l],n[1][l],a[1][l],e[h],t[h]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function SH(e){var t,r=e.length-1,n,a=new Array(r),l=new Array(r),h=new Array(r);for(a[0]=0,l[0]=2,h[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,l[t]=4,h[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,l[r-1]=7,h[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/l[t-1],l[t]-=n,h[t]-=n*h[t-1];for(a[r-1]=h[r-1]/l[r-1],t=r-2;t>=0;--t)a[t]=(h[t]-a[t+1])/l[t];for(l[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function W2e(e){return new jte(e)}function eR(e,t){this._context=e,this._t=t}eR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function G2e(e){return new eR(e,.5)}function q2e(e){return new eR(e,0)}function H2e(e){return new eR(e,1)}function ox(e,t){if((h=e.length)>1)for(var r=1,n,a,l=e[t[0]],h,i=l.length;r<h;++r)for(a=l,l=e[t[r]],n=0;n<i;++n)l[n][1]+=l[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Lj(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Z2e(e,t){return e[t]}function X2e(e){const t=[];return t.key=e,t}function Y2e(){var e=ro([]),t=Lj,r=ox,n=Z2e;function a(l){var h=Array.from(e.apply(this,arguments),X2e),i,_=h.length,b=-1,E;for(const C of l)for(i=0,++b;i<_;++i)(h[i][b]=[0,+n(C,h[i].key,b,l)]).data=C;for(i=0,E=G5(t(h));i<_;++i)h[E[i]].index=i;return r(h,E),h}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:ro(Array.from(l)),a):e},a.value=function(l){return arguments.length?(n=typeof l=="function"?l:ro(+l),a):n},a.order=function(l){return arguments.length?(t=l==null?Lj:typeof l=="function"?l:ro(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(r=l??ox,a):r},a}function K2e(e,t){if((n=e.length)>0){for(var r,n,a=0,l=e[0].length,h;a<l;++a){for(h=r=0;r<n;++r)h+=e[r][a][1]||0;if(h)for(r=0;r<n;++r)e[r][a][1]/=h}ox(e,t)}}function J2e(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,l=n.length;r<l;++r){for(var h=0,i=0;h<a;++h)i+=e[h][r][1]||0;n[r][1]+=n[r][0]=-i/2}ox(e,t)}}function Q2e(e,t){if(!(!((h=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,l,h;n<l;++n){for(var i=0,_=0,b=0;i<h;++i){for(var E=e[t[i]],C=E[n][1]||0,I=E[n-1][1]||0,F=(C-I)/2,$=0;$<i;++$){var B=e[t[$]],q=B[n][1]||0,G=B[n-1][1]||0;F+=q-G}_+=C,b+=F*C}a[n-1][1]+=a[n-1][0]=r,_&&(r-=b/_)}a[n-1][1]+=a[n-1][0]=r,ox(e,t)}}function xT(e){"@babel/helpers - typeof";return xT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xT(e)}var eAe=["type","size","sizeType"];function Nj(){return Nj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nj.apply(this,arguments)}function TH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TH(Object(r),!0).forEach(function(n){tAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tAe(e,t,r){return t=rAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rAe(e){var t=nAe(e,"string");return xT(t)=="symbol"?t:t+""}function nAe(e,t){if(xT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iAe(e,t){if(e==null)return{};var r=oAe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oAe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Fte={symbolCircle:q5,symbolCross:A2e,symbolDiamond:M2e,symbolSquare:P2e,symbolStar:R2e,symbolTriangle:D2e,symbolWye:N2e},aAe=Math.PI/180,sAe=function(t){var r="symbol".concat(Kk(t));return Fte[r]||q5},lAe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*aAe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},cAe=function(t,r){Fte["symbol".concat(Kk(t))]=r},H5=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,l=a===void 0?64:a,h=t.sizeType,i=h===void 0?"area":h,_=iAe(t,eAe),b=EH(EH({},_),{},{type:n,size:l,sizeType:i}),E=function(){var q=sAe(n),G=z2e().type(q).size(lAe(l,i,n));return G()},C=b.className,I=b.cx,F=b.cy,$=ti(b,!0);return I===+I&&F===+F&&l===+l?Ae.createElement("path",Nj({},$,{className:gi("recharts-symbols",C),transform:"translate(".concat(I,", ").concat(F,")"),d:E()})):null};H5.registerSymbol=cAe;function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function zj(){return zj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zj.apply(this,arguments)}function AH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uAe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AH(Object(r),!0).forEach(function(n){bT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$te(n.key),n)}}function fAe(e,t,r){return t&&hAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pAe(e,t,r){return t=LI(t),mAe(e,Bte()?Reflect.construct(t,r||[],LI(e).constructor):t.apply(e,r))}function mAe(e,t){if(t&&(ax(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gAe(e)}function gAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bte=function(){return!!e})()}function LI(e){return LI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LI(e)}function yAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jj(e,t)}function jj(e,t){return jj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jj(e,t)}function bT(e,t,r){return t=$te(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $te(e){var t=vAe(e,"string");return ax(t)=="symbol"?t:t+""}function vAe(e,t){if(ax(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ax(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xc=32,Z5=function(e){function t(){return dAe(this,t),pAe(this,t,arguments)}return yAe(t,e),fAe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,l=xc/2,h=xc/6,i=xc/3,_=n.inactive?a:n.color;if(n.type==="plainline")return Ae.createElement("line",{strokeWidth:4,fill:"none",stroke:_,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:l,x2:xc,y2:l,className:"recharts-legend-icon"});if(n.type==="line")return Ae.createElement("path",{strokeWidth:4,fill:"none",stroke:_,d:"M0,".concat(l,"h").concat(i,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*i,",").concat(l,`
            H`).concat(xc,"M").concat(2*i,",").concat(l,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(i,",").concat(l),className:"recharts-legend-icon"});if(n.type==="rect")return Ae.createElement("path",{stroke:"none",fill:_,d:"M0,".concat(xc/8,"h").concat(xc,"v").concat(xc*3/4,"h").concat(-xc,"z"),className:"recharts-legend-icon"});if(Ae.isValidElement(n.legendIcon)){var b=uAe({},n);return delete b.legendIcon,Ae.cloneElement(n.legendIcon,b)}return Ae.createElement(H5,{fill:_,cx:l,cy:l,size:xc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,l=a.payload,h=a.iconSize,i=a.layout,_=a.formatter,b=a.inactiveColor,E={x:0,y:0,width:xc,height:xc},C={display:i==="horizontal"?"inline-block":"block",marginRight:10},I={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(F,$){var B=F.formatter||_,q=gi(bT(bT({"recharts-legend-item":!0},"legend-item-".concat($),!0),"inactive",F.inactive));if(F.type==="none")return null;var G=Xn(F.value)?null:F.value;Bh(!Xn(F.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var H=F.inactive?b:F.color;return Ae.createElement("li",zj({className:q,style:C,key:"legend-item-".concat($)},PI(n.props,F,$)),Ae.createElement(Mj,{width:h,height:h,viewBox:E,style:I},n.renderIcon(F)),Ae.createElement("span",{className:"recharts-legend-item-text",style:{color:H}},B?B(G,F,$):G))})}},{key:"render",value:function(){var n=this.props,a=n.payload,l=n.layout,h=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:l==="horizontal"?h:"left"};return Ae.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(ne.PureComponent);bT(Z5,"displayName","Legend");bT(Z5,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var _Ae=jk;function xAe(){this.__data__=new _Ae,this.size=0}var bAe=xAe;function wAe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var SAe=wAe;function TAe(e){return this.__data__.get(e)}var EAe=TAe;function AAe(e){return this.__data__.has(e)}var CAe=AAe,MAe=jk,PAe=L5,IAe=N5,OAe=200;function kAe(e,t){var r=this.__data__;if(r instanceof MAe){var n=r.__data__;if(!PAe||n.length<OAe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new IAe(n)}return r.set(e,t),this.size=r.size,this}var RAe=kAe,DAe=jk,LAe=bAe,NAe=SAe,zAe=EAe,jAe=CAe,FAe=RAe;function ab(e){var t=this.__data__=new DAe(e);this.size=t.size}ab.prototype.clear=LAe;ab.prototype.delete=NAe;ab.prototype.get=zAe;ab.prototype.has=jAe;ab.prototype.set=FAe;var Ute=ab,BAe="__lodash_hash_undefined__";function $Ae(e){return this.__data__.set(e,BAe),this}var UAe=$Ae;function VAe(e){return this.__data__.has(e)}var WAe=VAe,GAe=N5,qAe=UAe,HAe=WAe;function NI(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new GAe;++t<r;)this.add(e[t])}NI.prototype.add=NI.prototype.push=qAe;NI.prototype.has=HAe;var Vte=NI;function ZAe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Wte=ZAe;function XAe(e,t){return e.has(t)}var Gte=XAe,YAe=Vte,KAe=Wte,JAe=Gte,QAe=1,eCe=2;function tCe(e,t,r,n,a,l){var h=r&QAe,i=e.length,_=t.length;if(i!=_&&!(h&&_>i))return!1;var b=l.get(e),E=l.get(t);if(b&&E)return b==t&&E==e;var C=-1,I=!0,F=r&eCe?new YAe:void 0;for(l.set(e,t),l.set(t,e);++C<i;){var $=e[C],B=t[C];if(n)var q=h?n(B,$,C,t,e,l):n($,B,C,e,t,l);if(q!==void 0){if(q)continue;I=!1;break}if(F){if(!KAe(t,function(G,H){if(!JAe(F,H)&&($===G||a($,G,r,n,l)))return F.push(H)})){I=!1;break}}else if(!($===B||a($,B,r,n,l))){I=!1;break}}return l.delete(e),l.delete(t),I}var qte=tCe,rCe=Xd,nCe=rCe.Uint8Array,iCe=nCe;function oCe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var aCe=oCe;function sCe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var X5=sCe,CH=RE,MH=iCe,lCe=D5,cCe=qte,uCe=aCe,dCe=X5,hCe=1,fCe=2,pCe="[object Boolean]",mCe="[object Date]",gCe="[object Error]",yCe="[object Map]",vCe="[object Number]",_Ce="[object RegExp]",xCe="[object Set]",bCe="[object String]",wCe="[object Symbol]",SCe="[object ArrayBuffer]",TCe="[object DataView]",PH=CH?CH.prototype:void 0,q3=PH?PH.valueOf:void 0;function ECe(e,t,r,n,a,l,h){switch(r){case TCe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case SCe:return!(e.byteLength!=t.byteLength||!l(new MH(e),new MH(t)));case pCe:case mCe:case vCe:return lCe(+e,+t);case gCe:return e.name==t.name&&e.message==t.message;case _Ce:case bCe:return e==t+"";case yCe:var i=uCe;case xCe:var _=n&hCe;if(i||(i=dCe),e.size!=t.size&&!_)return!1;var b=h.get(e);if(b)return b==t;n|=fCe,h.set(e,t);var E=cCe(i(e),i(t),n,a,l,h);return h.delete(e),E;case wCe:if(q3)return q3.call(e)==q3.call(t)}return!1}var ACe=ECe;function CCe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var Hte=CCe,MCe=Hte,PCe=Ml;function ICe(e,t,r){var n=t(e);return PCe(e)?n:MCe(n,r(e))}var OCe=ICe;function kCe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,l=[];++r<n;){var h=e[r];t(h,r,e)&&(l[a++]=h)}return l}var RCe=kCe;function DCe(){return[]}var LCe=DCe,NCe=RCe,zCe=LCe,jCe=Object.prototype,FCe=jCe.propertyIsEnumerable,IH=Object.getOwnPropertySymbols,BCe=IH?function(e){return e==null?[]:(e=Object(e),NCe(IH(e),function(t){return FCe.call(e,t)}))}:zCe,$Ce=BCe;function UCe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var VCe=UCe,WCe=uf,GCe=df,qCe="[object Arguments]";function HCe(e){return GCe(e)&&WCe(e)==qCe}var ZCe=HCe,OH=ZCe,XCe=df,Zte=Object.prototype,YCe=Zte.hasOwnProperty,KCe=Zte.propertyIsEnumerable,JCe=OH(function(){return arguments}())?OH:function(e){return XCe(e)&&YCe.call(e,"callee")&&!KCe.call(e,"callee")},Y5=JCe,zI={exports:{}};function QCe(){return!1}var eMe=QCe;zI.exports;(function(e,t){var r=Xd,n=eMe,a=t&&!t.nodeType&&t,l=a&&!0&&e&&!e.nodeType&&e,h=l&&l.exports===a,i=h?r.Buffer:void 0,_=i?i.isBuffer:void 0,b=_||n;e.exports=b})(zI,zI.exports);var Xte=zI.exports,tMe=9007199254740991,rMe=/^(?:0|[1-9]\d*)$/;function nMe(e,t){var r=typeof e;return t=t??tMe,!!t&&(r=="number"||r!="symbol"&&rMe.test(e))&&e>-1&&e%1==0&&e<t}var K5=nMe,iMe=9007199254740991;function oMe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=iMe}var J5=oMe,aMe=uf,sMe=J5,lMe=df,cMe="[object Arguments]",uMe="[object Array]",dMe="[object Boolean]",hMe="[object Date]",fMe="[object Error]",pMe="[object Function]",mMe="[object Map]",gMe="[object Number]",yMe="[object Object]",vMe="[object RegExp]",_Me="[object Set]",xMe="[object String]",bMe="[object WeakMap]",wMe="[object ArrayBuffer]",SMe="[object DataView]",TMe="[object Float32Array]",EMe="[object Float64Array]",AMe="[object Int8Array]",CMe="[object Int16Array]",MMe="[object Int32Array]",PMe="[object Uint8Array]",IMe="[object Uint8ClampedArray]",OMe="[object Uint16Array]",kMe="[object Uint32Array]",fo={};fo[TMe]=fo[EMe]=fo[AMe]=fo[CMe]=fo[MMe]=fo[PMe]=fo[IMe]=fo[OMe]=fo[kMe]=!0;fo[cMe]=fo[uMe]=fo[wMe]=fo[dMe]=fo[SMe]=fo[hMe]=fo[fMe]=fo[pMe]=fo[mMe]=fo[gMe]=fo[yMe]=fo[vMe]=fo[_Me]=fo[xMe]=fo[bMe]=!1;function RMe(e){return lMe(e)&&sMe(e.length)&&!!fo[aMe(e)]}var DMe=RMe;function LMe(e){return function(t){return e(t)}}var Yte=LMe,jI={exports:{}};jI.exports;(function(e,t){var r=nte,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,l=a&&a.exports===n,h=l&&r.process,i=function(){try{var _=a&&a.require&&a.require("util").types;return _||h&&h.binding&&h.binding("util")}catch{}}();e.exports=i})(jI,jI.exports);var NMe=jI.exports,zMe=DMe,jMe=Yte,kH=NMe,RH=kH&&kH.isTypedArray,FMe=RH?jMe(RH):zMe,Kte=FMe,BMe=VCe,$Me=Y5,UMe=Ml,VMe=Xte,WMe=K5,GMe=Kte,qMe=Object.prototype,HMe=qMe.hasOwnProperty;function ZMe(e,t){var r=UMe(e),n=!r&&$Me(e),a=!r&&!n&&VMe(e),l=!r&&!n&&!a&&GMe(e),h=r||n||a||l,i=h?BMe(e.length,String):[],_=i.length;for(var b in e)(t||HMe.call(e,b))&&!(h&&(b=="length"||a&&(b=="offset"||b=="parent")||l&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||WMe(b,_)))&&i.push(b);return i}var XMe=ZMe,YMe=Object.prototype;function KMe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||YMe;return e===r}var JMe=KMe;function QMe(e,t){return function(r){return e(t(r))}}var Jte=QMe,ePe=Jte,tPe=ePe(Object.keys,Object),rPe=tPe,nPe=JMe,iPe=rPe,oPe=Object.prototype,aPe=oPe.hasOwnProperty;function sPe(e){if(!nPe(e))return iPe(e);var t=[];for(var r in Object(e))aPe.call(e,r)&&r!="constructor"&&t.push(r);return t}var lPe=sPe,cPe=R5,uPe=J5;function dPe(e){return e!=null&&uPe(e.length)&&!cPe(e)}var NE=dPe,hPe=XMe,fPe=lPe,pPe=NE;function mPe(e){return pPe(e)?hPe(e):fPe(e)}var tR=mPe,gPe=OCe,yPe=$Ce,vPe=tR;function _Pe(e){return gPe(e,vPe,yPe)}var xPe=_Pe,DH=xPe,bPe=1,wPe=Object.prototype,SPe=wPe.hasOwnProperty;function TPe(e,t,r,n,a,l){var h=r&bPe,i=DH(e),_=i.length,b=DH(t),E=b.length;if(_!=E&&!h)return!1;for(var C=_;C--;){var I=i[C];if(!(h?I in t:SPe.call(t,I)))return!1}var F=l.get(e),$=l.get(t);if(F&&$)return F==t&&$==e;var B=!0;l.set(e,t),l.set(t,e);for(var q=h;++C<_;){I=i[C];var G=e[I],H=t[I];if(n)var J=h?n(H,G,I,t,e,l):n(G,H,I,e,t,l);if(!(J===void 0?G===H||a(G,H,r,n,l):J)){B=!1;break}q||(q=I=="constructor")}if(B&&!q){var Q=e.constructor,oe=t.constructor;Q!=oe&&"constructor"in e&&"constructor"in t&&!(typeof Q=="function"&&Q instanceof Q&&typeof oe=="function"&&oe instanceof oe)&&(B=!1)}return l.delete(e),l.delete(t),B}var EPe=TPe,APe=ev,CPe=Xd,MPe=APe(CPe,"DataView"),PPe=MPe,IPe=ev,OPe=Xd,kPe=IPe(OPe,"Promise"),RPe=kPe,DPe=ev,LPe=Xd,NPe=DPe(LPe,"Set"),Qte=NPe,zPe=ev,jPe=Xd,FPe=zPe(jPe,"WeakMap"),BPe=FPe,Fj=PPe,Bj=L5,$j=RPe,Uj=Qte,Vj=BPe,ere=uf,sb=ote,LH="[object Map]",$Pe="[object Object]",NH="[object Promise]",zH="[object Set]",jH="[object WeakMap]",FH="[object DataView]",UPe=sb(Fj),VPe=sb(Bj),WPe=sb($j),GPe=sb(Uj),qPe=sb(Vj),Ug=ere;(Fj&&Ug(new Fj(new ArrayBuffer(1)))!=FH||Bj&&Ug(new Bj)!=LH||$j&&Ug($j.resolve())!=NH||Uj&&Ug(new Uj)!=zH||Vj&&Ug(new Vj)!=jH)&&(Ug=function(e){var t=ere(e),r=t==$Pe?e.constructor:void 0,n=r?sb(r):"";if(n)switch(n){case UPe:return FH;case VPe:return LH;case WPe:return NH;case GPe:return zH;case qPe:return jH}return t});var HPe=Ug,H3=Ute,ZPe=qte,XPe=ACe,YPe=EPe,BH=HPe,$H=Ml,UH=Xte,KPe=Kte,JPe=1,VH="[object Arguments]",WH="[object Array]",wC="[object Object]",QPe=Object.prototype,GH=QPe.hasOwnProperty;function eIe(e,t,r,n,a,l){var h=$H(e),i=$H(t),_=h?WH:BH(e),b=i?WH:BH(t);_=_==VH?wC:_,b=b==VH?wC:b;var E=_==wC,C=b==wC,I=_==b;if(I&&UH(e)){if(!UH(t))return!1;h=!0,E=!1}if(I&&!E)return l||(l=new H3),h||KPe(e)?ZPe(e,t,r,n,a,l):XPe(e,t,_,r,n,a,l);if(!(r&JPe)){var F=E&&GH.call(e,"__wrapped__"),$=C&&GH.call(t,"__wrapped__");if(F||$){var B=F?e.value():e,q=$?t.value():t;return l||(l=new H3),a(B,q,r,n,l)}}return I?(l||(l=new H3),YPe(e,t,r,n,a,l)):!1}var tIe=eIe,rIe=tIe,qH=df;function tre(e,t,r,n,a){return e===t?!0:e==null||t==null||!qH(e)&&!qH(t)?e!==e&&t!==t:rIe(e,t,r,n,tre,a)}var Q5=tre,nIe=Ute,iIe=Q5,oIe=1,aIe=2;function sIe(e,t,r,n){var a=r.length,l=a,h=!n;if(e==null)return!l;for(e=Object(e);a--;){var i=r[a];if(h&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++a<l;){i=r[a];var _=i[0],b=e[_],E=i[1];if(h&&i[2]){if(b===void 0&&!(_ in e))return!1}else{var C=new nIe;if(n)var I=n(b,E,_,e,t,C);if(!(I===void 0?iIe(E,b,oIe|aIe,n,C):I))return!1}}return!0}var lIe=sIe,cIe=Om;function uIe(e){return e===e&&!cIe(e)}var rre=uIe,dIe=rre,hIe=tR;function fIe(e){for(var t=hIe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,dIe(a)]}return t}var pIe=fIe;function mIe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var nre=mIe,gIe=lIe,yIe=pIe,vIe=nre;function _Ie(e){var t=yIe(e);return t.length==1&&t[0][2]?vIe(t[0][0],t[0][1]):function(r){return r===e||gIe(r,e,t)}}var xIe=_Ie;function bIe(e,t){return e!=null&&t in Object(e)}var wIe=bIe,SIe=ute,TIe=Y5,EIe=Ml,AIe=K5,CIe=J5,MIe=Bk;function PIe(e,t,r){t=SIe(t,e);for(var n=-1,a=t.length,l=!1;++n<a;){var h=MIe(t[n]);if(!(l=e!=null&&r(e,h)))break;e=e[h]}return l||++n!=a?l:(a=e==null?0:e.length,!!a&&CIe(a)&&AIe(h,a)&&(EIe(e)||TIe(e)))}var IIe=PIe,OIe=wIe,kIe=IIe;function RIe(e,t){return e!=null&&kIe(e,t,OIe)}var DIe=RIe,LIe=Q5,NIe=dte,zIe=DIe,jIe=k5,FIe=rre,BIe=nre,$Ie=Bk,UIe=1,VIe=2;function WIe(e,t){return jIe(e)&&FIe(t)?BIe($Ie(e),t):function(r){var n=NIe(r,e);return n===void 0&&n===t?zIe(r,e):LIe(t,n,UIe|VIe)}}var GIe=WIe;function qIe(e){return e}var lb=qIe;function HIe(e){return function(t){return t==null?void 0:t[e]}}var ZIe=HIe,XIe=F5;function YIe(e){return function(t){return XIe(t,e)}}var KIe=YIe,JIe=ZIe,QIe=KIe,eOe=k5,tOe=Bk;function rOe(e){return eOe(e)?JIe(tOe(e)):QIe(e)}var nOe=rOe,iOe=xIe,oOe=GIe,aOe=lb,sOe=Ml,lOe=nOe;function cOe(e){return typeof e=="function"?e:e==null?aOe:typeof e=="object"?sOe(e)?oOe(e[0],e[1]):iOe(e):lOe(e)}var km=cOe;function uOe(e,t,r,n){for(var a=e.length,l=r+(n?1:-1);n?l--:++l<a;)if(t(e[l],l,e))return l;return-1}var ire=uOe;function dOe(e){return e!==e}var hOe=dOe;function fOe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var pOe=fOe,mOe=ire,gOe=hOe,yOe=pOe;function vOe(e,t,r){return t===t?yOe(e,t,r):mOe(e,gOe,r)}var _Oe=vOe,xOe=_Oe;function bOe(e,t){var r=e==null?0:e.length;return!!r&&xOe(e,t,0)>-1}var wOe=bOe;function SOe(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var TOe=SOe;function EOe(){}var AOe=EOe,Z3=Qte,COe=AOe,MOe=X5,POe=1/0,IOe=Z3&&1/MOe(new Z3([,-0]))[1]==POe?function(e){return new Z3(e)}:COe,OOe=IOe,kOe=Vte,ROe=wOe,DOe=TOe,LOe=Gte,NOe=OOe,zOe=X5,jOe=200;function FOe(e,t,r){var n=-1,a=ROe,l=e.length,h=!0,i=[],_=i;if(r)h=!1,a=DOe;else if(l>=jOe){var b=t?null:NOe(e);if(b)return zOe(b);h=!1,a=LOe,_=new kOe}else _=t?[]:i;e:for(;++n<l;){var E=e[n],C=t?t(E):E;if(E=r||E!==0?E:0,h&&C===C){for(var I=_.length;I--;)if(_[I]===C)continue e;t&&_.push(C),i.push(E)}else a(_,C,r)||(_!==i&&_.push(C),i.push(E))}return i}var BOe=FOe,$Oe=km,UOe=BOe;function VOe(e,t){return e&&e.length?UOe(e,$Oe(t)):[]}var WOe=VOe;const HH=yi(WOe);function ore(e,t,r){return t===!0?HH(e,r):Xn(t)?HH(e,t):e}function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}var GOe=["ref"];function ZH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZH(Object(r),!0).forEach(function(n){rR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sre(n.key),n)}}function HOe(e,t,r){return t&&XH(e.prototype,t),r&&XH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZOe(e,t,r){return t=FI(t),XOe(e,are()?Reflect.construct(t,r||[],FI(e).constructor):t.apply(e,r))}function XOe(e,t){if(t&&(sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YOe(e)}function YOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function are(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(are=function(){return!!e})()}function FI(e){return FI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FI(e)}function KOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wj(e,t)}function Wj(e,t){return Wj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Wj(e,t)}function rR(e,t,r){return t=sre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sre(e){var t=JOe(e,"string");return sx(t)=="symbol"?t:t+""}function JOe(e,t){if(sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QOe(e,t){if(e==null)return{};var r=eke(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function tke(e){return e.value}function rke(e,t){if(Ae.isValidElement(e))return Ae.cloneElement(e,t);if(typeof e=="function")return Ae.createElement(e,t);t.ref;var r=QOe(t,GOe);return Ae.createElement(Z5,r)}var YH=1,_y=function(e){function t(){var r;qOe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=ZOe(this,t,[].concat(a)),rR(r,"lastBoundingBox",{width:-1,height:-1}),r}return KOe(t,e),HOe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>YH||Math.abs(a.height-this.lastBoundingBox.height)>YH)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?mh({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,l=a.layout,h=a.align,i=a.verticalAlign,_=a.margin,b=a.chartWidth,E=a.chartHeight,C,I;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(h==="center"&&l==="vertical"){var F=this.getBBoxSnapshot();C={left:((b||0)-F.width)/2}}else C=h==="right"?{right:_&&_.right||0}:{left:_&&_.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var $=this.getBBoxSnapshot();I={top:((E||0)-$.height)/2}}else I=i==="bottom"?{bottom:_&&_.bottom||0}:{top:_&&_.top||0};return mh(mh({},C),I)}},{key:"render",value:function(){var n=this,a=this.props,l=a.content,h=a.width,i=a.height,_=a.wrapperStyle,b=a.payloadUniqBy,E=a.payload,C=mh(mh({position:"absolute",width:h||"auto",height:i||"auto"},this.getDefaultPosition(_)),_);return Ae.createElement("div",{className:"recharts-legend-wrapper",style:C,ref:function(F){n.wrapperNode=F}},rke(l,mh(mh({},this.props),{},{payload:ore(E,b,tke)})))}}],[{key:"getWithHeight",value:function(n,a){var l=mh(mh({},this.defaultProps),n.props),h=l.layout;return h==="vertical"&&Sr(n.props.height)?{height:n.props.height}:h==="horizontal"?{width:n.props.width||a}:null}}])}(ne.PureComponent);rR(_y,"displayName","Legend");rR(_y,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var KH=RE,nke=Y5,ike=Ml,JH=KH?KH.isConcatSpreadable:void 0;function oke(e){return ike(e)||nke(e)||!!(JH&&e&&e[JH])}var ake=oke,ske=Hte,lke=ake;function lre(e,t,r,n,a){var l=-1,h=e.length;for(r||(r=lke),a||(a=[]);++l<h;){var i=e[l];t>0&&r(i)?t>1?lre(i,t-1,r,n,a):ske(a,i):n||(a[a.length]=i)}return a}var cre=lre;function cke(e){return function(t,r,n){for(var a=-1,l=Object(t),h=n(t),i=h.length;i--;){var _=h[e?i:++a];if(r(l[_],_,l)===!1)break}return t}}var uke=cke,dke=uke,hke=dke(),fke=hke,pke=fke,mke=tR;function gke(e,t){return e&&pke(e,t,mke)}var ure=gke,yke=NE;function vke(e,t){return function(r,n){if(r==null)return r;if(!yke(r))return e(r,n);for(var a=r.length,l=t?a:-1,h=Object(r);(t?l--:++l<a)&&n(h[l],l,h)!==!1;);return r}}var _ke=vke,xke=ure,bke=_ke,wke=bke(xke),e$=wke,Ske=e$,Tke=NE;function Eke(e,t){var r=-1,n=Tke(e)?Array(e.length):[];return Ske(e,function(a,l,h){n[++r]=t(a,l,h)}),n}var dre=Eke;function Ake(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var Cke=Ake,QH=eb;function Mke(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,l=QH(e),h=t!==void 0,i=t===null,_=t===t,b=QH(t);if(!i&&!b&&!l&&e>t||l&&h&&_&&!i&&!b||n&&h&&_||!r&&_||!a)return 1;if(!n&&!l&&!b&&e<t||b&&r&&a&&!n&&!l||i&&r&&a||!h&&a||!_)return-1}return 0}var Pke=Mke,Ike=Pke;function Oke(e,t,r){for(var n=-1,a=e.criteria,l=t.criteria,h=a.length,i=r.length;++n<h;){var _=Ike(a[n],l[n]);if(_){if(n>=i)return _;var b=r[n];return _*(b=="desc"?-1:1)}}return e.index-t.index}var kke=Oke,X3=j5,Rke=F5,Dke=km,Lke=dre,Nke=Cke,zke=Yte,jke=kke,Fke=lb,Bke=Ml;function $ke(e,t,r){t.length?t=X3(t,function(l){return Bke(l)?function(h){return Rke(h,l.length===1?l[0]:l)}:l}):t=[Fke];var n=-1;t=X3(t,zke(Dke));var a=Lke(e,function(l,h,i){var _=X3(t,function(b){return b(l)});return{criteria:_,index:++n,value:l}});return Nke(a,function(l,h){return jke(l,h,r)})}var Uke=$ke;function Vke(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Wke=Vke,Gke=Wke,e7=Math.max;function qke(e,t,r){return t=e7(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,l=e7(n.length-t,0),h=Array(l);++a<l;)h[a]=n[t+a];a=-1;for(var i=Array(t+1);++a<t;)i[a]=n[a];return i[t]=r(h),Gke(e,this,i)}}var Hke=qke;function Zke(e){return function(){return e}}var Xke=Zke,Yke=ev,Kke=function(){try{var e=Yke(Object,"defineProperty");return e({},"",{}),e}catch{}}(),hre=Kke,Jke=Xke,t7=hre,Qke=lb,eRe=t7?function(e,t){return t7(e,"toString",{configurable:!0,enumerable:!1,value:Jke(t),writable:!0})}:Qke,tRe=eRe,rRe=800,nRe=16,iRe=Date.now;function oRe(e){var t=0,r=0;return function(){var n=iRe(),a=nRe-(n-r);if(r=n,a>0){if(++t>=rRe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var aRe=oRe,sRe=tRe,lRe=aRe,cRe=lRe(sRe),uRe=cRe,dRe=lb,hRe=Hke,fRe=uRe;function pRe(e,t){return fRe(hRe(e,t,dRe),e+"")}var mRe=pRe,gRe=D5,yRe=NE,vRe=K5,_Re=Om;function xRe(e,t,r){if(!_Re(r))return!1;var n=typeof t;return(n=="number"?yRe(r)&&vRe(t,r.length):n=="string"&&t in r)?gRe(r[t],e):!1}var nR=xRe,bRe=cre,wRe=Uke,SRe=mRe,r7=nR,TRe=SRe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&r7(e,t[0],t[1])?t=[]:r>2&&r7(t[0],t[1],t[2])&&(t=[t[0]]),wRe(e,bRe(t,1),[])}),ERe=TRe;const t$=yi(ERe);function wT(e){"@babel/helpers - typeof";return wT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wT(e)}function Gj(){return Gj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gj.apply(this,arguments)}function ARe(e,t){return IRe(e)||PRe(e,t)||MRe(e,t)||CRe()}function CRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MRe(e,t){if(e){if(typeof e=="string")return n7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n7(e,t)}}function n7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function IRe(e){if(Array.isArray(e))return e}function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){ORe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ORe(e,t,r){return t=kRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kRe(e){var t=RRe(e,"string");return wT(t)=="symbol"?t:t+""}function RRe(e,t){if(wT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DRe(e){return Array.isArray(e)&&Aa(e[0])&&Aa(e[1])?e.join(" ~ "):e}var LRe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,l=a===void 0?{}:a,h=t.itemStyle,i=h===void 0?{}:h,_=t.labelStyle,b=_===void 0?{}:_,E=t.payload,C=t.formatter,I=t.itemSorter,F=t.wrapperClassName,$=t.labelClassName,B=t.label,q=t.labelFormatter,G=t.accessibilityLayer,H=G===void 0?!1:G,J=function(){if(E&&E.length){var je={padding:0,margin:0},tt=(I?t$(E,I):E).map(function(Ze,Qe){if(Ze.type==="none")return null;var st=Y3({display:"block",paddingTop:4,paddingBottom:4,color:Ze.color||"#000"},i),ot=Ze.formatter||C||DRe,Be=Ze.value,lt=Ze.name,zt=Be,Lt=lt;if(ot&&zt!=null&&Lt!=null){var Bt=ot(Be,lt,Ze,Qe,E);if(Array.isArray(Bt)){var ct=ARe(Bt,2);zt=ct[0],Lt=ct[1]}else zt=Bt}return Ae.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Qe),style:st},Aa(Lt)?Ae.createElement("span",{className:"recharts-tooltip-item-name"},Lt):null,Aa(Lt)?Ae.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Ae.createElement("span",{className:"recharts-tooltip-item-value"},zt),Ae.createElement("span",{className:"recharts-tooltip-item-unit"},Ze.unit||""))});return Ae.createElement("ul",{className:"recharts-tooltip-item-list",style:je},tt)}return null},Q=Y3({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),oe=Y3({margin:0},b),de=!ui(B),ae=de?B:"",ve=gi("recharts-default-tooltip",F),Fe=gi("recharts-tooltip-label",$);de&&q&&E!==void 0&&E!==null&&(ae=q(B,E));var ke=H?{role:"status","aria-live":"assertive"}:{};return Ae.createElement("div",Gj({className:ve,style:Q},ke),Ae.createElement("p",{className:Fe,style:oe},Ae.isValidElement(ae)?ae:"".concat(ae)),J())};function ST(e){"@babel/helpers - typeof";return ST=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ST(e)}function SC(e,t,r){return t=NRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NRe(e){var t=zRe(e,"string");return ST(t)=="symbol"?t:t+""}function zRe(e,t){if(ST(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ST(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aw="recharts-tooltip-wrapper",jRe={visibility:"hidden"};function FRe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return gi(Aw,SC(SC(SC(SC({},"".concat(Aw,"-right"),Sr(r)&&t&&Sr(t.x)&&r>=t.x),"".concat(Aw,"-left"),Sr(r)&&t&&Sr(t.x)&&r<t.x),"".concat(Aw,"-bottom"),Sr(n)&&t&&Sr(t.y)&&n>=t.y),"".concat(Aw,"-top"),Sr(n)&&t&&Sr(t.y)&&n<t.y))}function o7(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,l=e.position,h=e.reverseDirection,i=e.tooltipDimension,_=e.viewBox,b=e.viewBoxDimension;if(l&&Sr(l[n]))return l[n];var E=r[n]-i-a,C=r[n]+a;if(t[n])return h[n]?E:C;if(h[n]){var I=E,F=_[n];return I<F?Math.max(C,_[n]):Math.max(E,_[n])}var $=C+i,B=_[n]+b;return $>B?Math.max(E,_[n]):Math.max(C,_[n])}function BRe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function $Re(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,l=e.reverseDirection,h=e.tooltipBox,i=e.useTranslate3d,_=e.viewBox,b,E,C;return h.height>0&&h.width>0&&r?(E=o7({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:h.width,viewBox:_,viewBoxDimension:_.width}),C=o7({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:h.height,viewBox:_,viewBoxDimension:_.height}),b=BRe({translateX:E,translateY:C,useTranslate3d:i})):b=jRe,{cssProperties:b,cssClasses:FRe({translateX:E,translateY:C,coordinate:r})}}function lx(e){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(e)}function a7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a7(Object(r),!0).forEach(function(n){Hj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function URe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pre(n.key),n)}}function WRe(e,t,r){return t&&VRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GRe(e,t,r){return t=BI(t),qRe(e,fre()?Reflect.construct(t,r||[],BI(e).constructor):t.apply(e,r))}function qRe(e,t){if(t&&(lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HRe(e)}function HRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fre(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fre=function(){return!!e})()}function BI(e){return BI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BI(e)}function ZRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qj(e,t)}function qj(e,t){return qj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qj(e,t)}function Hj(e,t,r){return t=pre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pre(e){var t=XRe(e,"string");return lx(t)=="symbol"?t:t+""}function XRe(e,t){if(lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l7=1,YRe=function(e){function t(){var r;URe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=GRe(this,t,[].concat(a)),Hj(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Hj(r,"handleKeyDown",function(h){if(h.key==="Escape"){var i,_,b,E;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(_=r.props.coordinate)===null||_===void 0?void 0:_.x)!==null&&i!==void 0?i:0,y:(b=(E=r.props.coordinate)===null||E===void 0?void 0:E.y)!==null&&b!==void 0?b:0}})}}),r}return ZRe(t,e),WRe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>l7||Math.abs(n.height-this.state.lastBoundingBox.height)>l7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,l=a.active,h=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,b=a.children,E=a.coordinate,C=a.hasPayload,I=a.isAnimationActive,F=a.offset,$=a.position,B=a.reverseDirection,q=a.useTranslate3d,G=a.viewBox,H=a.wrapperStyle,J=$Re({allowEscapeViewBox:h,coordinate:E,offsetTopLeft:F,position:$,reverseDirection:B,tooltipBox:this.state.lastBoundingBox,useTranslate3d:q,viewBox:G}),Q=J.cssClasses,oe=J.cssProperties,de=s7(s7({transition:I&&l?"transform ".concat(i,"ms ").concat(_):void 0},oe),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&C?"visible":"hidden",position:"absolute",top:0,left:0},H);return Ae.createElement("div",{tabIndex:-1,className:Q,style:de,ref:function(ve){n.wrapperNode=ve}},b)}}])}(ne.PureComponent),KRe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},$h={isSsr:KRe(),get:function(t){return $h[t]},set:function(t,r){if(typeof t=="string")$h[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){$h[a]=t[a]})}}};function cx(e){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(e)}function c7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c7(Object(r),!0).forEach(function(n){r$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gre(n.key),n)}}function eDe(e,t,r){return t&&QRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tDe(e,t,r){return t=$I(t),rDe(e,mre()?Reflect.construct(t,r||[],$I(e).constructor):t.apply(e,r))}function rDe(e,t){if(t&&(cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nDe(e)}function nDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mre(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mre=function(){return!!e})()}function $I(e){return $I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$I(e)}function iDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zj(e,t)}function Zj(e,t){return Zj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Zj(e,t)}function r$(e,t,r){return t=gre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gre(e){var t=oDe(e,"string");return cx(t)=="symbol"?t:t+""}function oDe(e,t){if(cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aDe(e){return e.dataKey}function sDe(e,t){return Ae.isValidElement(e)?Ae.cloneElement(e,t):typeof e=="function"?Ae.createElement(e,t):Ae.createElement(LRe,t)}var xu=function(e){function t(){return JRe(this,t),tDe(this,t,arguments)}return iDe(t,e),eDe(t,[{key:"render",value:function(){var n=this,a=this.props,l=a.active,h=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,b=a.content,E=a.coordinate,C=a.filterNull,I=a.isAnimationActive,F=a.offset,$=a.payload,B=a.payloadUniqBy,q=a.position,G=a.reverseDirection,H=a.useTranslate3d,J=a.viewBox,Q=a.wrapperStyle,oe=$??[];C&&oe.length&&(oe=ore($.filter(function(ae){return ae.value!=null&&(ae.hide!==!0||n.props.includeHidden)}),B,aDe));var de=oe.length>0;return Ae.createElement(YRe,{allowEscapeViewBox:h,animationDuration:i,animationEasing:_,isAnimationActive:I,active:l,coordinate:E,hasPayload:de,offset:F,position:q,reverseDirection:G,useTranslate3d:H,viewBox:J,wrapperStyle:Q},sDe(b,u7(u7({},this.props),{},{payload:oe})))}}])}(ne.PureComponent);r$(xu,"displayName","Tooltip");r$(xu,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!$h.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var lDe=Xd,cDe=function(){return lDe.Date.now()},uDe=cDe,dDe=/\s/;function hDe(e){for(var t=e.length;t--&&dDe.test(e.charAt(t)););return t}var fDe=hDe,pDe=fDe,mDe=/^\s+/;function gDe(e){return e&&e.slice(0,pDe(e)+1).replace(mDe,"")}var yDe=gDe,vDe=yDe,d7=Om,_De=eb,h7=NaN,xDe=/^[-+]0x[0-9a-f]+$/i,bDe=/^0b[01]+$/i,wDe=/^0o[0-7]+$/i,SDe=parseInt;function TDe(e){if(typeof e=="number")return e;if(_De(e))return h7;if(d7(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=d7(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=vDe(e);var r=bDe.test(e);return r||wDe.test(e)?SDe(e.slice(2),r?2:8):xDe.test(e)?h7:+e}var yre=TDe,EDe=Om,K3=uDe,f7=yre,ADe="Expected a function",CDe=Math.max,MDe=Math.min;function PDe(e,t,r){var n,a,l,h,i,_,b=0,E=!1,C=!1,I=!0;if(typeof e!="function")throw new TypeError(ADe);t=f7(t)||0,EDe(r)&&(E=!!r.leading,C="maxWait"in r,l=C?CDe(f7(r.maxWait)||0,t):l,I="trailing"in r?!!r.trailing:I);function F(de){var ae=n,ve=a;return n=a=void 0,b=de,h=e.apply(ve,ae),h}function $(de){return b=de,i=setTimeout(G,t),E?F(de):h}function B(de){var ae=de-_,ve=de-b,Fe=t-ae;return C?MDe(Fe,l-ve):Fe}function q(de){var ae=de-_,ve=de-b;return _===void 0||ae>=t||ae<0||C&&ve>=l}function G(){var de=K3();if(q(de))return H(de);i=setTimeout(G,B(de))}function H(de){return i=void 0,I&&n?F(de):(n=a=void 0,h)}function J(){i!==void 0&&clearTimeout(i),b=0,n=_=a=i=void 0}function Q(){return i===void 0?h:H(K3())}function oe(){var de=K3(),ae=q(de);if(n=arguments,a=this,_=de,ae){if(i===void 0)return $(_);if(C)return clearTimeout(i),i=setTimeout(G,t),F(_)}return i===void 0&&(i=setTimeout(G,t)),h}return oe.cancel=J,oe.flush=Q,oe}var IDe=PDe,ODe=IDe,kDe=Om,RDe="Expected a function";function DDe(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(RDe);return kDe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),ODe(e,t,{leading:n,maxWait:t,trailing:a})}var LDe=DDe;const vre=yi(LDe);function TT(e){"@babel/helpers - typeof";return TT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TT(e)}function p7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function TC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p7(Object(r),!0).forEach(function(n){NDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NDe(e,t,r){return t=zDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zDe(e){var t=jDe(e,"string");return TT(t)=="symbol"?t:t+""}function jDe(e,t){if(TT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(TT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FDe(e,t){return VDe(e)||UDe(e,t)||$De(e,t)||BDe()}function BDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $De(e,t){if(e){if(typeof e=="string")return m7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m7(e,t)}}function m7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function VDe(e){if(Array.isArray(e))return e}var g7=ne.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,l=e.width,h=l===void 0?"100%":l,i=e.height,_=i===void 0?"100%":i,b=e.minWidth,E=b===void 0?0:b,C=e.minHeight,I=e.maxHeight,F=e.children,$=e.debounce,B=$===void 0?0:$,q=e.id,G=e.className,H=e.onResize,J=e.style,Q=J===void 0?{}:J,oe=ne.useRef(null),de=ne.useRef();de.current=H,ne.useImperativeHandle(t,function(){return Object.defineProperty(oe.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),oe.current},configurable:!0})});var ae=ne.useState({containerWidth:a.width,containerHeight:a.height}),ve=FDe(ae,2),Fe=ve[0],ke=ve[1],Ce=ne.useCallback(function(tt,Ze){ke(function(Qe){var st=Math.round(tt),ot=Math.round(Ze);return Qe.containerWidth===st&&Qe.containerHeight===ot?Qe:{containerWidth:st,containerHeight:ot}})},[]);ne.useEffect(function(){var tt=function(lt){var zt,Lt=lt[0].contentRect,Bt=Lt.width,ct=Lt.height;Ce(Bt,ct),(zt=de.current)===null||zt===void 0||zt.call(de,Bt,ct)};B>0&&(tt=vre(tt,B,{trailing:!0,leading:!1}));var Ze=new ResizeObserver(tt),Qe=oe.current.getBoundingClientRect(),st=Qe.width,ot=Qe.height;return Ce(st,ot),Ze.observe(oe.current),function(){Ze.disconnect()}},[Ce,B]);var je=ne.useMemo(function(){var tt=Fe.containerWidth,Ze=Fe.containerHeight;if(tt<0||Ze<0)return null;Bh(ty(h)||ty(_),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,_),Bh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Qe=ty(h)?tt:h,st=ty(_)?Ze:_;r&&r>0&&(Qe?st=Qe/r:st&&(Qe=st*r),I&&st>I&&(st=I)),Bh(Qe>0||st>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Qe,st,h,_,E,C,r);var ot=!Array.isArray(F)&&Fh(F.type).endsWith("Chart");return Ae.Children.map(F,function(Be){return pte.isElement(Be)?ne.cloneElement(Be,TC({width:Qe,height:st},ot?{style:TC({height:"100%",width:"100%",maxHeight:st,maxWidth:Qe},Be.props.style)}:{})):Be})},[r,F,_,I,C,E,Fe,h]);return Ae.createElement("div",{id:q?"".concat(q):void 0,className:gi("recharts-responsive-container",G),style:TC(TC({},Q),{},{width:h,height:_,minWidth:E,minHeight:C,maxHeight:I}),ref:oe},je)}),_re=function(t){return null};_re.displayName="Cell";function ET(e){"@babel/helpers - typeof";return ET=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ET(e)}function y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y7(Object(r),!0).forEach(function(n){WDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WDe(e,t,r){return t=GDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GDe(e){var t=qDe(e,"string");return ET(t)=="symbol"?t:t+""}function qDe(e,t){if(ET(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ET(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b_={widthCache:{},cacheCount:0},HDe=2e3,ZDe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},v7="recharts_measurement_span";function XDe(e){var t=Xj({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var FS=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||$h.isSsr)return{width:0,height:0};var n=XDe(r),a=JSON.stringify({text:t,copyStyle:n});if(b_.widthCache[a])return b_.widthCache[a];try{var l=document.getElementById(v7);l||(l=document.createElement("span"),l.setAttribute("id",v7),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var h=Xj(Xj({},ZDe),n);Object.assign(l.style,h),l.textContent="".concat(t);var i=l.getBoundingClientRect(),_={width:i.width,height:i.height};return b_.widthCache[a]=_,++b_.cacheCount>HDe&&(b_.cacheCount=0,b_.widthCache={}),_}catch{return{width:0,height:0}}},YDe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function AT(e){"@babel/helpers - typeof";return AT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AT(e)}function UI(e,t){return eLe(e)||QDe(e,t)||JDe(e,t)||KDe()}function KDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JDe(e,t){if(e){if(typeof e=="string")return _7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _7(e,t)}}function _7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function eLe(e){if(Array.isArray(e))return e}function tLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nLe(n.key),n)}}function rLe(e,t,r){return t&&x7(e.prototype,t),r&&x7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nLe(e){var t=iLe(e,"string");return AT(t)=="symbol"?t:t+""}function iLe(e,t){if(AT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(AT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var b7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,w7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,oLe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,aLe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,xre={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},sLe=Object.keys(xre),d0="NaN";function lLe(e,t){return e*xre[t]}var EC=function(){function e(t,r){tLe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!oLe.test(r)&&(this.num=NaN,this.unit=""),sLe.includes(r)&&(this.num=lLe(t,r),this.unit="px")}return rLe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=aLe.exec(r))!==null&&n!==void 0?n:[],l=UI(a,3),h=l[1],i=l[2];return new e(parseFloat(h),i??"")}}])}();function bre(e){if(e.includes(d0))return d0;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=b7.exec(t))!==null&&r!==void 0?r:[],a=UI(n,4),l=a[1],h=a[2],i=a[3],_=EC.parse(l??""),b=EC.parse(i??""),E=h==="*"?_.multiply(b):_.divide(b);if(E.isNaN())return d0;t=t.replace(b7,E.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var C,I=(C=w7.exec(t))!==null&&C!==void 0?C:[],F=UI(I,4),$=F[1],B=F[2],q=F[3],G=EC.parse($??""),H=EC.parse(q??""),J=B==="+"?G.add(H):G.subtract(H);if(J.isNaN())return d0;t=t.replace(w7,J.toString())}return t}var S7=/\(([^()]*)\)/;function cLe(e){for(var t=e;t.includes("(");){var r=S7.exec(t),n=UI(r,2),a=n[1];t=t.replace(S7,bre(a))}return t}function uLe(e){var t=e.replace(/\s+/g,"");return t=cLe(t),t=bre(t),t}function dLe(e){try{return uLe(e)}catch{return d0}}function J3(e){var t=dLe(e.slice(5,-1));return t===d0?"":t}var hLe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],fLe=["dx","dy","angle","className","breakAll"];function Yj(){return Yj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yj.apply(this,arguments)}function T7(e,t){if(e==null)return{};var r=pLe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function E7(e,t){return vLe(e)||yLe(e,t)||gLe(e,t)||mLe()}function mLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gLe(e,t){if(e){if(typeof e=="string")return A7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A7(e,t)}}function A7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function vLe(e){if(Array.isArray(e))return e}var wre=/[ \f\n\r\t\v\u2028\u2029]+/,Sre=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var l=[];ui(r)||(n?l=r.toString().split(""):l=r.toString().split(wre));var h=l.map(function(_){return{word:_,width:FS(_,a).width}}),i=n?0:FS(" ",a).width;return{wordsWithComputedWidth:h,spaceWidth:i}}catch{return null}},_Le=function(t,r,n,a,l){var h=t.maxLines,i=t.children,_=t.style,b=t.breakAll,E=Sr(h),C=i,I=function(){var Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Qe.reduce(function(st,ot){var Be=ot.word,lt=ot.width,zt=st[st.length-1];if(zt&&(a==null||l||zt.width+lt+n<Number(a)))zt.words.push(Be),zt.width+=lt+n;else{var Lt={words:[Be],width:lt};st.push(Lt)}return st},[])},F=I(r),$=function(Qe){return Qe.reduce(function(st,ot){return st.width>ot.width?st:ot})};if(!E)return F;for(var B="…",q=function(Qe){var st=C.slice(0,Qe),ot=Sre({breakAll:b,style:_,children:st+B}).wordsWithComputedWidth,Be=I(ot),lt=Be.length>h||$(Be).width>Number(a);return[lt,Be]},G=0,H=C.length-1,J=0,Q;G<=H&&J<=C.length-1;){var oe=Math.floor((G+H)/2),de=oe-1,ae=q(de),ve=E7(ae,2),Fe=ve[0],ke=ve[1],Ce=q(oe),je=E7(Ce,1),tt=je[0];if(!Fe&&!tt&&(G=oe+1),Fe&&tt&&(H=oe-1),!Fe&&tt){Q=ke;break}J++}return Q||F},C7=function(t){var r=ui(t)?[]:t.toString().split(wre);return[{words:r}]},xLe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,l=t.style,h=t.breakAll,i=t.maxLines;if((r||n)&&!$h.isSsr){var _,b,E=Sre({breakAll:h,children:a,style:l});if(E){var C=E.wordsWithComputedWidth,I=E.spaceWidth;_=C,b=I}else return C7(a);return _Le({breakAll:h,children:a,maxLines:i,style:l},_,b,r,n)}return C7(a)},M7="#808080",VI=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,h=t.lineHeight,i=h===void 0?"1em":h,_=t.capHeight,b=_===void 0?"0.71em":_,E=t.scaleToFit,C=E===void 0?!1:E,I=t.textAnchor,F=I===void 0?"start":I,$=t.verticalAnchor,B=$===void 0?"end":$,q=t.fill,G=q===void 0?M7:q,H=T7(t,hLe),J=ne.useMemo(function(){return xLe({breakAll:H.breakAll,children:H.children,maxLines:H.maxLines,scaleToFit:C,style:H.style,width:H.width})},[H.breakAll,H.children,H.maxLines,C,H.style,H.width]),Q=H.dx,oe=H.dy,de=H.angle,ae=H.className,ve=H.breakAll,Fe=T7(H,fLe);if(!Aa(n)||!Aa(l))return null;var ke=n+(Sr(Q)?Q:0),Ce=l+(Sr(oe)?oe:0),je;switch(B){case"start":je=J3("calc(".concat(b,")"));break;case"middle":je=J3("calc(".concat((J.length-1)/2," * -").concat(i," + (").concat(b," / 2))"));break;default:je=J3("calc(".concat(J.length-1," * -").concat(i,")"));break}var tt=[];if(C){var Ze=J[0].width,Qe=H.width;tt.push("scale(".concat((Sr(Qe)?Qe/Ze:1)/Ze,")"))}return de&&tt.push("rotate(".concat(de,", ").concat(ke,", ").concat(Ce,")")),tt.length&&(Fe.transform=tt.join(" ")),Ae.createElement("text",Yj({},ti(Fe,!0),{x:ke,y:Ce,className:gi("recharts-text",ae),textAnchor:F,fill:G.includes("url")?M7:G}),J.map(function(st,ot){var Be=st.words.join(ve?"":" ");return Ae.createElement("tspan",{x:ke,dy:ot===0?je:i,key:"".concat(Be,"-").concat(ot)},Be)}))};function cm(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function bLe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n$(e){let t,r,n;e.length!==2?(t=cm,r=(i,_)=>cm(e(i),_),n=(i,_)=>e(i)-_):(t=e===cm||e===bLe?e:wLe,r=e,n=e);function a(i,_,b=0,E=i.length){if(b<E){if(t(_,_)!==0)return E;do{const C=b+E>>>1;r(i[C],_)<0?b=C+1:E=C}while(b<E)}return b}function l(i,_,b=0,E=i.length){if(b<E){if(t(_,_)!==0)return E;do{const C=b+E>>>1;r(i[C],_)<=0?b=C+1:E=C}while(b<E)}return b}function h(i,_,b=0,E=i.length){const C=a(i,_,b,E-1);return C>b&&n(i[C-1],_)>-n(i[C],_)?C-1:C}return{left:a,center:h,right:l}}function wLe(){return 0}function Tre(e){return e===null?NaN:+e}function*SLe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const TLe=n$(cm),zE=TLe.right;n$(Tre).center;class P7 extends Map{constructor(t,r=CLe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(I7(this,t))}has(t){return super.has(I7(this,t))}set(t,r){return super.set(ELe(this,t),r)}delete(t){return super.delete(ALe(this,t))}}function I7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function ELe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function ALe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function CLe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function MLe(e=cm){if(e===cm)return Ere;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function Ere(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const PLe=Math.sqrt(50),ILe=Math.sqrt(10),OLe=Math.sqrt(2);function WI(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),l=n/Math.pow(10,a),h=l>=PLe?10:l>=ILe?5:l>=OLe?2:1;let i,_,b;return a<0?(b=Math.pow(10,-a)/h,i=Math.round(e*b),_=Math.round(t*b),i/b<e&&++i,_/b>t&&--_,b=-b):(b=Math.pow(10,a)*h,i=Math.round(e/b),_=Math.round(t/b),i*b<e&&++i,_*b>t&&--_),_<i&&.5<=r&&r<2?WI(e,t,r*2):[i,_,b]}function Kj(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,l,h]=n?WI(t,e,r):WI(e,t,r);if(!(l>=a))return[];const i=l-a+1,_=new Array(i);if(n)if(h<0)for(let b=0;b<i;++b)_[b]=(l-b)/-h;else for(let b=0;b<i;++b)_[b]=(l-b)*h;else if(h<0)for(let b=0;b<i;++b)_[b]=(a+b)/-h;else for(let b=0;b<i;++b)_[b]=(a+b)*h;return _}function Jj(e,t,r){return t=+t,e=+e,r=+r,WI(e,t,r)[2]}function Qj(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Jj(t,e,r):Jj(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function O7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function k7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Are(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?Ere:MLe(a);n>r;){if(n-r>600){const _=n-r+1,b=t-r+1,E=Math.log(_),C=.5*Math.exp(2*E/3),I=.5*Math.sqrt(E*C*(_-C)/_)*(b-_/2<0?-1:1),F=Math.max(r,Math.floor(t-b*C/_+I)),$=Math.min(n,Math.floor(t+(_-b)*C/_+I));Are(e,t,F,$,a)}const l=e[t];let h=r,i=n;for(Cw(e,r,t),a(e[n],l)>0&&Cw(e,r,n);h<i;){for(Cw(e,h,i),++h,--i;a(e[h],l)<0;)++h;for(;a(e[i],l)>0;)--i}a(e[r],l)===0?Cw(e,r,i):(++i,Cw(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function Cw(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function kLe(e,t,r){if(e=Float64Array.from(SLe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return k7(e);if(t>=1)return O7(e);var n,a=(n-1)*t,l=Math.floor(a),h=O7(Are(e,l).subarray(0,l+1)),i=k7(e.subarray(l+1));return h+(i-h)*(a-l)}}function RLe(e,t,r=Tre){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,l=Math.floor(a),h=+r(e[l],l,e),i=+r(e[l+1],l+1,e);return h+(i-h)*(a-l)}}function DLe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(a);++n<a;)l[n]=e+n*r;return l}function Bc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function hf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const eF=Symbol("implicit");function i$(){var e=new P7,t=[],r=[],n=eF;function a(l){let h=e.get(l);if(h===void 0){if(n!==eF)return n;e.set(l,h=t.push(l)-1)}return r[h%r.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new P7;for(const h of l)e.has(h)||e.set(h,t.push(h)-1);return a},a.range=function(l){return arguments.length?(r=Array.from(l),a):r.slice()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return i$(t,r).unknown(n)},Bc.apply(a,arguments),a}function CT(){var e=i$().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,l,h,i=!1,_=0,b=0,E=.5;delete e.unknown;function C(){var I=t().length,F=a<n,$=F?a:n,B=F?n:a;l=(B-$)/Math.max(1,I-_+b*2),i&&(l=Math.floor(l)),$+=(B-$-l*(I-_))*E,h=l*(1-_),i&&($=Math.round($),h=Math.round(h));var q=DLe(I).map(function(G){return $+l*G});return r(F?q.reverse():q)}return e.domain=function(I){return arguments.length?(t(I),C()):t()},e.range=function(I){return arguments.length?([n,a]=I,n=+n,a=+a,C()):[n,a]},e.rangeRound=function(I){return[n,a]=I,n=+n,a=+a,i=!0,C()},e.bandwidth=function(){return h},e.step=function(){return l},e.round=function(I){return arguments.length?(i=!!I,C()):i},e.padding=function(I){return arguments.length?(_=Math.min(1,b=+I),C()):_},e.paddingInner=function(I){return arguments.length?(_=Math.min(1,I),C()):_},e.paddingOuter=function(I){return arguments.length?(b=+I,C()):b},e.align=function(I){return arguments.length?(E=Math.max(0,Math.min(1,I)),C()):E},e.copy=function(){return CT(t(),[n,a]).round(i).paddingInner(_).paddingOuter(b).align(E)},Bc.apply(C(),arguments)}function Cre(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Cre(t())},e}function BS(){return Cre(CT.apply(null,arguments).paddingInner(1))}function o$(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Mre(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function jE(){}var MT=.7,GI=1/MT,M0="\\s*([+-]?\\d+)\\s*",PT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",LLe=/^#([0-9a-f]{3,8})$/,NLe=new RegExp(`^rgb\\(${M0},${M0},${M0}\\)$`),zLe=new RegExp(`^rgb\\(${zd},${zd},${zd}\\)$`),jLe=new RegExp(`^rgba\\(${M0},${M0},${M0},${PT}\\)$`),FLe=new RegExp(`^rgba\\(${zd},${zd},${zd},${PT}\\)$`),BLe=new RegExp(`^hsl\\(${PT},${zd},${zd}\\)$`),$Le=new RegExp(`^hsla\\(${PT},${zd},${zd},${PT}\\)$`),R7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};o$(jE,IT,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:D7,formatHex:D7,formatHex8:ULe,formatHsl:VLe,formatRgb:L7,toString:L7});function D7(){return this.rgb().formatHex()}function ULe(){return this.rgb().formatHex8()}function VLe(){return Pre(this).formatHsl()}function L7(){return this.rgb().formatRgb()}function IT(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=LLe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?N7(t):r===3?new _l(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?AC(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?AC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=NLe.exec(e))?new _l(t[1],t[2],t[3],1):(t=zLe.exec(e))?new _l(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=jLe.exec(e))?AC(t[1],t[2],t[3],t[4]):(t=FLe.exec(e))?AC(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=BLe.exec(e))?F7(t[1],t[2]/100,t[3]/100,1):(t=$Le.exec(e))?F7(t[1],t[2]/100,t[3]/100,t[4]):R7.hasOwnProperty(e)?N7(R7[e]):e==="transparent"?new _l(NaN,NaN,NaN,0):null}function N7(e){return new _l(e>>16&255,e>>8&255,e&255,1)}function AC(e,t,r,n){return n<=0&&(e=t=r=NaN),new _l(e,t,r,n)}function WLe(e){return e instanceof jE||(e=IT(e)),e?(e=e.rgb(),new _l(e.r,e.g,e.b,e.opacity)):new _l}function tF(e,t,r,n){return arguments.length===1?WLe(e):new _l(e,t,r,n??1)}function _l(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}o$(_l,tF,Mre(jE,{brighter(e){return e=e==null?GI:Math.pow(GI,e),new _l(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?MT:Math.pow(MT,e),new _l(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _l(xy(this.r),xy(this.g),xy(this.b),qI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:z7,formatHex:z7,formatHex8:GLe,formatRgb:j7,toString:j7}));function z7(){return`#${ry(this.r)}${ry(this.g)}${ry(this.b)}`}function GLe(){return`#${ry(this.r)}${ry(this.g)}${ry(this.b)}${ry((isNaN(this.opacity)?1:this.opacity)*255)}`}function j7(){const e=qI(this.opacity);return`${e===1?"rgb(":"rgba("}${xy(this.r)}, ${xy(this.g)}, ${xy(this.b)}${e===1?")":`, ${e})`}`}function qI(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ry(e){return e=xy(e),(e<16?"0":"")+e.toString(16)}function F7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Eu(e,t,r,n)}function Pre(e){if(e instanceof Eu)return new Eu(e.h,e.s,e.l,e.opacity);if(e instanceof jE||(e=IT(e)),!e)return new Eu;if(e instanceof Eu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),l=Math.max(t,r,n),h=NaN,i=l-a,_=(l+a)/2;return i?(t===l?h=(r-n)/i+(r<n)*6:r===l?h=(n-t)/i+2:h=(t-r)/i+4,i/=_<.5?l+a:2-l-a,h*=60):i=_>0&&_<1?0:h,new Eu(h,i,_,e.opacity)}function qLe(e,t,r,n){return arguments.length===1?Pre(e):new Eu(e,t,r,n??1)}function Eu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}o$(Eu,qLe,Mre(jE,{brighter(e){return e=e==null?GI:Math.pow(GI,e),new Eu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?MT:Math.pow(MT,e),new Eu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new _l(Q3(e>=240?e-240:e+120,a,n),Q3(e,a,n),Q3(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Eu(B7(this.h),CC(this.s),CC(this.l),qI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=qI(this.opacity);return`${e===1?"hsl(":"hsla("}${B7(this.h)}, ${CC(this.s)*100}%, ${CC(this.l)*100}%${e===1?")":`, ${e})`}`}}));function B7(e){return e=(e||0)%360,e<0?e+360:e}function CC(e){return Math.max(0,Math.min(1,e||0))}function Q3(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const a$=e=>()=>e;function HLe(e,t){return function(r){return e+r*t}}function ZLe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function XLe(e){return(e=+e)==1?Ire:function(t,r){return r-t?ZLe(t,r,e):a$(isNaN(t)?r:t)}}function Ire(e,t){var r=t-e;return r?HLe(e,r):a$(isNaN(e)?t:e)}const $7=function e(t){var r=XLe(t);function n(a,l){var h=r((a=tF(a)).r,(l=tF(l)).r),i=r(a.g,l.g),_=r(a.b,l.b),b=Ire(a.opacity,l.opacity);return function(E){return a.r=h(E),a.g=i(E),a.b=_(E),a.opacity=b(E),a+""}}return n.gamma=e,n}(1);function YLe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(l){for(a=0;a<r;++a)n[a]=e[a]*(1-l)+t[a]*l;return n}}function KLe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function JLe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),l=new Array(r),h;for(h=0;h<n;++h)a[h]=cb(e[h],t[h]);for(;h<r;++h)l[h]=t[h];return function(i){for(h=0;h<n;++h)l[h]=a[h](i);return l}}function QLe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function HI(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function e3e(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=cb(e[a],t[a]):n[a]=t[a];return function(l){for(a in r)n[a]=r[a](l);return n}}var rF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eN=new RegExp(rF.source,"g");function t3e(e){return function(){return e}}function r3e(e){return function(t){return e(t)+""}}function n3e(e,t){var r=rF.lastIndex=eN.lastIndex=0,n,a,l,h=-1,i=[],_=[];for(e=e+"",t=t+"";(n=rF.exec(e))&&(a=eN.exec(t));)(l=a.index)>r&&(l=t.slice(r,l),i[h]?i[h]+=l:i[++h]=l),(n=n[0])===(a=a[0])?i[h]?i[h]+=a:i[++h]=a:(i[++h]=null,_.push({i:h,x:HI(n,a)})),r=eN.lastIndex;return r<t.length&&(l=t.slice(r),i[h]?i[h]+=l:i[++h]=l),i.length<2?_[0]?r3e(_[0].x):t3e(t):(t=_.length,function(b){for(var E=0,C;E<t;++E)i[(C=_[E]).i]=C.x(b);return i.join("")})}function cb(e,t){var r=typeof t,n;return t==null||r==="boolean"?a$(t):(r==="number"?HI:r==="string"?(n=IT(t))?(t=n,$7):n3e:t instanceof IT?$7:t instanceof Date?QLe:KLe(t)?YLe:Array.isArray(t)?JLe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?e3e:HI)(e,t)}function s$(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function i3e(e,t){t===void 0&&(t=e,e=cb);for(var r=0,n=t.length-1,a=t[0],l=new Array(n<0?0:n);r<n;)l[r]=e(a,a=t[++r]);return function(h){var i=Math.max(0,Math.min(n-1,Math.floor(h*=n)));return l[i](h-i)}}function o3e(e){return function(){return e}}function ZI(e){return+e}var U7=[0,1];function Fs(e){return e}function nF(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:o3e(isNaN(t)?NaN:.5)}function a3e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function s3e(e,t,r){var n=e[0],a=e[1],l=t[0],h=t[1];return a<n?(n=nF(a,n),l=r(h,l)):(n=nF(n,a),l=r(l,h)),function(i){return l(n(i))}}function l3e(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),l=new Array(n),h=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<n;)a[h]=nF(e[h],e[h+1]),l[h]=r(t[h],t[h+1]);return function(i){var _=zE(e,i,1,n)-1;return l[_](a[_](i))}}function FE(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function iR(){var e=U7,t=U7,r=cb,n,a,l,h=Fs,i,_,b;function E(){var I=Math.min(e.length,t.length);return h!==Fs&&(h=a3e(e[0],e[I-1])),i=I>2?l3e:s3e,_=b=null,C}function C(I){return I==null||isNaN(I=+I)?l:(_||(_=i(e.map(n),t,r)))(n(h(I)))}return C.invert=function(I){return h(a((b||(b=i(t,e.map(n),HI)))(I)))},C.domain=function(I){return arguments.length?(e=Array.from(I,ZI),E()):e.slice()},C.range=function(I){return arguments.length?(t=Array.from(I),E()):t.slice()},C.rangeRound=function(I){return t=Array.from(I),r=s$,E()},C.clamp=function(I){return arguments.length?(h=I?!0:Fs,E()):h!==Fs},C.interpolate=function(I){return arguments.length?(r=I,E()):r},C.unknown=function(I){return arguments.length?(l=I,C):l},function(I,F){return n=I,a=F,E()}}function l$(){return iR()(Fs,Fs)}function c3e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function XI(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ux(e){return e=XI(Math.abs(e)),e?e[1]:NaN}function u3e(e,t){return function(r,n){for(var a=r.length,l=[],h=0,i=e[0],_=0;a>0&&i>0&&(_+i+1>n&&(i=Math.max(1,n-_)),l.push(r.substring(a-=i,a+i)),!((_+=i+1)>n));)i=e[h=(h+1)%e.length];return l.reverse().join(t)}}function d3e(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var h3e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function OT(e){if(!(t=h3e.exec(e)))throw new Error("invalid format: "+e);var t;return new c$({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}OT.prototype=c$.prototype;function c$(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}c$.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function f3e(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Ore;function p3e(e,t){var r=XI(e,t);if(!r)return e+"";var n=r[0],a=r[1],l=a-(Ore=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,h=n.length;return l===h?n:l>h?n+new Array(l-h+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+XI(e,Math.max(0,t+l-1))[0]}function V7(e,t){var r=XI(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const W7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:c3e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>V7(e*100,t),r:V7,s:p3e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function G7(e){return e}var q7=Array.prototype.map,H7=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m3e(e){var t=e.grouping===void 0||e.thousands===void 0?G7:u3e(q7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?G7:d3e(q7.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"−":e.minus+"",_=e.nan===void 0?"NaN":e.nan+"";function b(C){C=OT(C);var I=C.fill,F=C.align,$=C.sign,B=C.symbol,q=C.zero,G=C.width,H=C.comma,J=C.precision,Q=C.trim,oe=C.type;oe==="n"?(H=!0,oe="g"):W7[oe]||(J===void 0&&(J=12),Q=!0,oe="g"),(q||I==="0"&&F==="=")&&(q=!0,I="0",F="=");var de=B==="$"?r:B==="#"&&/[boxX]/.test(oe)?"0"+oe.toLowerCase():"",ae=B==="$"?n:/[%p]/.test(oe)?h:"",ve=W7[oe],Fe=/[defgprs%]/.test(oe);J=J===void 0?6:/[gprs]/.test(oe)?Math.max(1,Math.min(21,J)):Math.max(0,Math.min(20,J));function ke(Ce){var je=de,tt=ae,Ze,Qe,st;if(oe==="c")tt=ve(Ce)+tt,Ce="";else{Ce=+Ce;var ot=Ce<0||1/Ce<0;if(Ce=isNaN(Ce)?_:ve(Math.abs(Ce),J),Q&&(Ce=f3e(Ce)),ot&&+Ce==0&&$!=="+"&&(ot=!1),je=(ot?$==="("?$:i:$==="-"||$==="("?"":$)+je,tt=(oe==="s"?H7[8+Ore/3]:"")+tt+(ot&&$==="("?")":""),Fe){for(Ze=-1,Qe=Ce.length;++Ze<Qe;)if(st=Ce.charCodeAt(Ze),48>st||st>57){tt=(st===46?a+Ce.slice(Ze+1):Ce.slice(Ze))+tt,Ce=Ce.slice(0,Ze);break}}}H&&!q&&(Ce=t(Ce,1/0));var Be=je.length+Ce.length+tt.length,lt=Be<G?new Array(G-Be+1).join(I):"";switch(H&&q&&(Ce=t(lt+Ce,lt.length?G-tt.length:1/0),lt=""),F){case"<":Ce=je+Ce+tt+lt;break;case"=":Ce=je+lt+Ce+tt;break;case"^":Ce=lt.slice(0,Be=lt.length>>1)+je+Ce+tt+lt.slice(Be);break;default:Ce=lt+je+Ce+tt;break}return l(Ce)}return ke.toString=function(){return C+""},ke}function E(C,I){var F=b((C=OT(C),C.type="f",C)),$=Math.max(-8,Math.min(8,Math.floor(ux(I)/3)))*3,B=Math.pow(10,-$),q=H7[8+$/3];return function(G){return F(B*G)+q}}return{format:b,formatPrefix:E}}var MC,u$,kre;g3e({thousands:",",grouping:[3],currency:["$",""]});function g3e(e){return MC=m3e(e),u$=MC.format,kre=MC.formatPrefix,MC}function y3e(e){return Math.max(0,-ux(Math.abs(e)))}function v3e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ux(t)/3)))*3-ux(Math.abs(e)))}function _3e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ux(t)-ux(e))+1}function Rre(e,t,r,n){var a=Qj(e,t,r),l;switch(n=OT(n??",f"),n.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(l=v3e(a,h))&&(n.precision=l),kre(n,h)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=_3e(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=y3e(a))&&(n.precision=l-(n.type==="%")*2);break}}return u$(n)}function Rm(e){var t=e.domain;return e.ticks=function(r){var n=t();return Kj(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return Rre(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,l=n.length-1,h=n[a],i=n[l],_,b,E=10;for(i<h&&(b=h,h=i,i=b,b=a,a=l,l=b);E-- >0;){if(b=Jj(h,i,r),b===_)return n[a]=h,n[l]=i,t(n);if(b>0)h=Math.floor(h/b)*b,i=Math.ceil(i/b)*b;else if(b<0)h=Math.ceil(h*b)/b,i=Math.floor(i*b)/b;else break;_=b}return e},e}function YI(){var e=l$();return e.copy=function(){return FE(e,YI())},Bc.apply(e,arguments),Rm(e)}function Dre(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,ZI),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return Dre(e).unknown(t)},e=arguments.length?Array.from(e,ZI):[0,1],Rm(r)}function Lre(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],l=e[n],h;return l<a&&(h=r,r=n,n=h,h=a,a=l,l=h),e[r]=t.floor(a),e[n]=t.ceil(l),e}function Z7(e){return Math.log(e)}function X7(e){return Math.exp(e)}function x3e(e){return-Math.log(-e)}function b3e(e){return-Math.exp(-e)}function w3e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function S3e(e){return e===10?w3e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function T3e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Y7(e){return(t,r)=>-e(-t,r)}function d$(e){const t=e(Z7,X7),r=t.domain;let n=10,a,l;function h(){return a=T3e(n),l=S3e(n),r()[0]<0?(a=Y7(a),l=Y7(l),e(x3e,b3e)):e(Z7,X7),t}return t.base=function(i){return arguments.length?(n=+i,h()):n},t.domain=function(i){return arguments.length?(r(i),h()):r()},t.ticks=i=>{const _=r();let b=_[0],E=_[_.length-1];const C=E<b;C&&([b,E]=[E,b]);let I=a(b),F=a(E),$,B;const q=i==null?10:+i;let G=[];if(!(n%1)&&F-I<q){if(I=Math.floor(I),F=Math.ceil(F),b>0){for(;I<=F;++I)for($=1;$<n;++$)if(B=I<0?$/l(-I):$*l(I),!(B<b)){if(B>E)break;G.push(B)}}else for(;I<=F;++I)for($=n-1;$>=1;--$)if(B=I>0?$/l(-I):$*l(I),!(B<b)){if(B>E)break;G.push(B)}G.length*2<q&&(G=Kj(b,E,q))}else G=Kj(I,F,Math.min(F-I,q)).map(l);return C?G.reverse():G},t.tickFormat=(i,_)=>{if(i==null&&(i=10),_==null&&(_=n===10?"s":","),typeof _!="function"&&(!(n%1)&&(_=OT(_)).precision==null&&(_.trim=!0),_=u$(_)),i===1/0)return _;const b=Math.max(1,n*i/t.ticks().length);return E=>{let C=E/l(Math.round(a(E)));return C*n<n-.5&&(C*=n),C<=b?_(E):""}},t.nice=()=>r(Lre(r(),{floor:i=>l(Math.floor(a(i))),ceil:i=>l(Math.ceil(a(i)))})),t}function Nre(){const e=d$(iR()).domain([1,10]);return e.copy=()=>FE(e,Nre()).base(e.base()),Bc.apply(e,arguments),e}function K7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function J7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function h$(e){var t=1,r=e(K7(t),J7(t));return r.constant=function(n){return arguments.length?e(K7(t=+n),J7(t)):t},Rm(r)}function zre(){var e=h$(iR());return e.copy=function(){return FE(e,zre()).constant(e.constant())},Bc.apply(e,arguments)}function Q7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function E3e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function A3e(e){return e<0?-e*e:e*e}function f$(e){var t=e(Fs,Fs),r=1;function n(){return r===1?e(Fs,Fs):r===.5?e(E3e,A3e):e(Q7(r),Q7(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Rm(t)}function p$(){var e=f$(iR());return e.copy=function(){return FE(e,p$()).exponent(e.exponent())},Bc.apply(e,arguments),e}function C3e(){return p$.apply(null,arguments).exponent(.5)}function e9(e){return Math.sign(e)*e*e}function M3e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function jre(){var e=l$(),t=[0,1],r=!1,n;function a(l){var h=M3e(e(l));return isNaN(h)?n:r?Math.round(h):h}return a.invert=function(l){return e.invert(e9(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,ZI)).map(e9)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(r=!!l,a):r},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return jre(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Bc.apply(a,arguments),Rm(a)}function Fre(){var e=[],t=[],r=[],n;function a(){var h=0,i=Math.max(1,t.length);for(r=new Array(i-1);++h<i;)r[h-1]=RLe(e,h/i);return l}function l(h){return h==null||isNaN(h=+h)?n:t[zE(r,h)]}return l.invertExtent=function(h){var i=t.indexOf(h);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},l.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let i of h)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(cm),a()},l.range=function(h){return arguments.length?(t=Array.from(h),a()):t.slice()},l.unknown=function(h){return arguments.length?(n=h,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return Fre().domain(e).range(t).unknown(n)},Bc.apply(l,arguments)}function Bre(){var e=0,t=1,r=1,n=[.5],a=[0,1],l;function h(_){return _!=null&&_<=_?a[zE(n,_,0,r)]:l}function i(){var _=-1;for(n=new Array(r);++_<r;)n[_]=((_+1)*t-(_-r)*e)/(r+1);return h}return h.domain=function(_){return arguments.length?([e,t]=_,e=+e,t=+t,i()):[e,t]},h.range=function(_){return arguments.length?(r=(a=Array.from(_)).length-1,i()):a.slice()},h.invertExtent=function(_){var b=a.indexOf(_);return b<0?[NaN,NaN]:b<1?[e,n[0]]:b>=r?[n[r-1],t]:[n[b-1],n[b]]},h.unknown=function(_){return arguments.length&&(l=_),h},h.thresholds=function(){return n.slice()},h.copy=function(){return Bre().domain([e,t]).range(a).unknown(l)},Bc.apply(Rm(h),arguments)}function $re(){var e=[.5],t=[0,1],r,n=1;function a(l){return l!=null&&l<=l?t[zE(e,l,0,n)]:r}return a.domain=function(l){return arguments.length?(e=Array.from(l),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var h=t.indexOf(l);return[e[h-1],e[h]]},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return $re().domain(e).range(t).unknown(r)},Bc.apply(a,arguments)}const tN=new Date,rN=new Date;function Ca(e,t,r,n){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const h=a(l),i=a.ceil(l);return l-h<i-l?h:i},a.offset=(l,h)=>(t(l=new Date(+l),h==null?1:Math.floor(h)),l),a.range=(l,h,i)=>{const _=[];if(l=a.ceil(l),i=i==null?1:Math.floor(i),!(l<h)||!(i>0))return _;let b;do _.push(b=new Date(+l)),t(l,i),e(l);while(b<l&&l<h);return _},a.filter=l=>Ca(h=>{if(h>=h)for(;e(h),!l(h);)h.setTime(h-1)},(h,i)=>{if(h>=h)if(i<0)for(;++i<=0;)for(;t(h,-1),!l(h););else for(;--i>=0;)for(;t(h,1),!l(h););}),r&&(a.count=(l,h)=>(tN.setTime(+l),rN.setTime(+h),e(tN),e(rN),Math.floor(r(tN,rN))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(n?h=>n(h)%l===0:h=>a.count(0,h)%l===0):a)),a}const KI=Ca(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);KI.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ca(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):KI);KI.range;const kh=1e3,Ic=kh*60,Rh=Ic*60,ef=Rh*24,m$=ef*7,t9=ef*30,nN=ef*365,ny=Ca(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*kh)},(e,t)=>(t-e)/kh,e=>e.getUTCSeconds());ny.range;const g$=Ca(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*kh)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getMinutes());g$.range;const y$=Ca(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getUTCMinutes());y$.range;const v$=Ca(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*kh-e.getMinutes()*Ic)},(e,t)=>{e.setTime(+e+t*Rh)},(e,t)=>(t-e)/Rh,e=>e.getHours());v$.range;const _$=Ca(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Rh)},(e,t)=>(t-e)/Rh,e=>e.getUTCHours());_$.range;const BE=Ca(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ic)/ef,e=>e.getDate()-1);BE.range;const oR=Ca(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ef,e=>e.getUTCDate()-1);oR.range;const Ure=Ca(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ef,e=>Math.floor(e/ef));Ure.range;function tv(e){return Ca(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ic)/m$)}const aR=tv(0),JI=tv(1),P3e=tv(2),I3e=tv(3),dx=tv(4),O3e=tv(5),k3e=tv(6);aR.range;JI.range;P3e.range;I3e.range;dx.range;O3e.range;k3e.range;function rv(e){return Ca(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/m$)}const sR=rv(0),QI=rv(1),R3e=rv(2),D3e=rv(3),hx=rv(4),L3e=rv(5),N3e=rv(6);sR.range;QI.range;R3e.range;D3e.range;hx.range;L3e.range;N3e.range;const x$=Ca(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());x$.range;const b$=Ca(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());b$.range;const tf=Ca(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());tf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ca(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});tf.range;const rf=Ca(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());rf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ca(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});rf.range;function Vre(e,t,r,n,a,l){const h=[[ny,1,kh],[ny,5,5*kh],[ny,15,15*kh],[ny,30,30*kh],[l,1,Ic],[l,5,5*Ic],[l,15,15*Ic],[l,30,30*Ic],[a,1,Rh],[a,3,3*Rh],[a,6,6*Rh],[a,12,12*Rh],[n,1,ef],[n,2,2*ef],[r,1,m$],[t,1,t9],[t,3,3*t9],[e,1,nN]];function i(b,E,C){const I=E<b;I&&([b,E]=[E,b]);const F=C&&typeof C.range=="function"?C:_(b,E,C),$=F?F.range(b,+E+1):[];return I?$.reverse():$}function _(b,E,C){const I=Math.abs(E-b)/C,F=n$(([,,q])=>q).right(h,I);if(F===h.length)return e.every(Qj(b/nN,E/nN,C));if(F===0)return KI.every(Math.max(Qj(b,E,C),1));const[$,B]=h[I/h[F-1][2]<h[F][2]/I?F-1:F];return $.every(B)}return[i,_]}const[z3e,j3e]=Vre(rf,b$,sR,Ure,_$,y$),[F3e,B3e]=Vre(tf,x$,aR,BE,v$,g$);function iN(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function oN(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Mw(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function $3e(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,l=e.days,h=e.shortDays,i=e.months,_=e.shortMonths,b=Pw(a),E=Iw(a),C=Pw(l),I=Iw(l),F=Pw(h),$=Iw(h),B=Pw(i),q=Iw(i),G=Pw(_),H=Iw(_),J={a:ot,A:Be,b:lt,B:zt,c:null,d:s9,e:s9,f:uNe,g:xNe,G:wNe,H:sNe,I:lNe,j:cNe,L:Wre,m:dNe,M:hNe,p:Lt,q:Bt,Q:u9,s:d9,S:fNe,u:pNe,U:mNe,V:gNe,w:yNe,W:vNe,x:null,X:null,y:_Ne,Y:bNe,Z:SNe,"%":c9},Q={a:ct,A:nr,b:mr,B:ir,c:null,d:l9,e:l9,f:CNe,g:zNe,G:FNe,H:TNe,I:ENe,j:ANe,L:qre,m:MNe,M:PNe,p:Ut,q:hr,Q:u9,s:d9,S:INe,u:ONe,U:kNe,V:RNe,w:DNe,W:LNe,x:null,X:null,y:NNe,Y:jNe,Z:BNe,"%":c9},oe={a:ke,A:Ce,b:je,B:tt,c:Ze,d:o9,e:o9,f:nNe,g:i9,G:n9,H:a9,I:a9,j:Q3e,L:rNe,m:J3e,M:eNe,p:Fe,q:K3e,Q:oNe,s:aNe,S:tNe,u:q3e,U:H3e,V:Z3e,w:G3e,W:X3e,x:Qe,X:st,y:i9,Y:n9,Z:Y3e,"%":iNe};J.x=de(r,J),J.X=de(n,J),J.c=de(t,J),Q.x=de(r,Q),Q.X=de(n,Q),Q.c=de(t,Q);function de(Vt,ge){return function(ur){var Ot=[],tr=-1,xt=0,un=Vt.length,Fr,Ln,Ge;for(ur instanceof Date||(ur=new Date(+ur));++tr<un;)Vt.charCodeAt(tr)===37&&(Ot.push(Vt.slice(xt,tr)),(Ln=r9[Fr=Vt.charAt(++tr)])!=null?Fr=Vt.charAt(++tr):Ln=Fr==="e"?" ":"0",(Ge=ge[Fr])&&(Fr=Ge(ur,Ln)),Ot.push(Fr),xt=tr+1);return Ot.push(Vt.slice(xt,tr)),Ot.join("")}}function ae(Vt,ge){return function(ur){var Ot=Mw(1900,void 0,1),tr=ve(Ot,Vt,ur+="",0),xt,un;if(tr!=ur.length)return null;if("Q"in Ot)return new Date(Ot.Q);if("s"in Ot)return new Date(Ot.s*1e3+("L"in Ot?Ot.L:0));if(ge&&!("Z"in Ot)&&(Ot.Z=0),"p"in Ot&&(Ot.H=Ot.H%12+Ot.p*12),Ot.m===void 0&&(Ot.m="q"in Ot?Ot.q:0),"V"in Ot){if(Ot.V<1||Ot.V>53)return null;"w"in Ot||(Ot.w=1),"Z"in Ot?(xt=oN(Mw(Ot.y,0,1)),un=xt.getUTCDay(),xt=un>4||un===0?QI.ceil(xt):QI(xt),xt=oR.offset(xt,(Ot.V-1)*7),Ot.y=xt.getUTCFullYear(),Ot.m=xt.getUTCMonth(),Ot.d=xt.getUTCDate()+(Ot.w+6)%7):(xt=iN(Mw(Ot.y,0,1)),un=xt.getDay(),xt=un>4||un===0?JI.ceil(xt):JI(xt),xt=BE.offset(xt,(Ot.V-1)*7),Ot.y=xt.getFullYear(),Ot.m=xt.getMonth(),Ot.d=xt.getDate()+(Ot.w+6)%7)}else("W"in Ot||"U"in Ot)&&("w"in Ot||(Ot.w="u"in Ot?Ot.u%7:"W"in Ot?1:0),un="Z"in Ot?oN(Mw(Ot.y,0,1)).getUTCDay():iN(Mw(Ot.y,0,1)).getDay(),Ot.m=0,Ot.d="W"in Ot?(Ot.w+6)%7+Ot.W*7-(un+5)%7:Ot.w+Ot.U*7-(un+6)%7);return"Z"in Ot?(Ot.H+=Ot.Z/100|0,Ot.M+=Ot.Z%100,oN(Ot)):iN(Ot)}}function ve(Vt,ge,ur,Ot){for(var tr=0,xt=ge.length,un=ur.length,Fr,Ln;tr<xt;){if(Ot>=un)return-1;if(Fr=ge.charCodeAt(tr++),Fr===37){if(Fr=ge.charAt(tr++),Ln=oe[Fr in r9?ge.charAt(tr++):Fr],!Ln||(Ot=Ln(Vt,ur,Ot))<0)return-1}else if(Fr!=ur.charCodeAt(Ot++))return-1}return Ot}function Fe(Vt,ge,ur){var Ot=b.exec(ge.slice(ur));return Ot?(Vt.p=E.get(Ot[0].toLowerCase()),ur+Ot[0].length):-1}function ke(Vt,ge,ur){var Ot=F.exec(ge.slice(ur));return Ot?(Vt.w=$.get(Ot[0].toLowerCase()),ur+Ot[0].length):-1}function Ce(Vt,ge,ur){var Ot=C.exec(ge.slice(ur));return Ot?(Vt.w=I.get(Ot[0].toLowerCase()),ur+Ot[0].length):-1}function je(Vt,ge,ur){var Ot=G.exec(ge.slice(ur));return Ot?(Vt.m=H.get(Ot[0].toLowerCase()),ur+Ot[0].length):-1}function tt(Vt,ge,ur){var Ot=B.exec(ge.slice(ur));return Ot?(Vt.m=q.get(Ot[0].toLowerCase()),ur+Ot[0].length):-1}function Ze(Vt,ge,ur){return ve(Vt,t,ge,ur)}function Qe(Vt,ge,ur){return ve(Vt,r,ge,ur)}function st(Vt,ge,ur){return ve(Vt,n,ge,ur)}function ot(Vt){return h[Vt.getDay()]}function Be(Vt){return l[Vt.getDay()]}function lt(Vt){return _[Vt.getMonth()]}function zt(Vt){return i[Vt.getMonth()]}function Lt(Vt){return a[+(Vt.getHours()>=12)]}function Bt(Vt){return 1+~~(Vt.getMonth()/3)}function ct(Vt){return h[Vt.getUTCDay()]}function nr(Vt){return l[Vt.getUTCDay()]}function mr(Vt){return _[Vt.getUTCMonth()]}function ir(Vt){return i[Vt.getUTCMonth()]}function Ut(Vt){return a[+(Vt.getUTCHours()>=12)]}function hr(Vt){return 1+~~(Vt.getUTCMonth()/3)}return{format:function(Vt){var ge=de(Vt+="",J);return ge.toString=function(){return Vt},ge},parse:function(Vt){var ge=ae(Vt+="",!1);return ge.toString=function(){return Vt},ge},utcFormat:function(Vt){var ge=de(Vt+="",Q);return ge.toString=function(){return Vt},ge},utcParse:function(Vt){var ge=ae(Vt+="",!0);return ge.toString=function(){return Vt},ge}}}var r9={"-":"",_:" ",0:"0"},Fa=/^\s*\d+/,U3e=/^%/,V3e=/[\\^$*+?|[\]().{}]/g;function Si(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",l=a.length;return n+(l<r?new Array(r-l+1).join(t)+a:a)}function W3e(e){return e.replace(V3e,"\\$&")}function Pw(e){return new RegExp("^(?:"+e.map(W3e).join("|")+")","i")}function Iw(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function G3e(e,t,r){var n=Fa.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function q3e(e,t,r){var n=Fa.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function H3e(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Z3e(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function X3e(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function n9(e,t,r){var n=Fa.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function i9(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Y3e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function K3e(e,t,r){var n=Fa.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function J3e(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function o9(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Q3e(e,t,r){var n=Fa.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function a9(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function eNe(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function tNe(e,t,r){var n=Fa.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function rNe(e,t,r){var n=Fa.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function nNe(e,t,r){var n=Fa.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function iNe(e,t,r){var n=U3e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function oNe(e,t,r){var n=Fa.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function aNe(e,t,r){var n=Fa.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function s9(e,t){return Si(e.getDate(),t,2)}function sNe(e,t){return Si(e.getHours(),t,2)}function lNe(e,t){return Si(e.getHours()%12||12,t,2)}function cNe(e,t){return Si(1+BE.count(tf(e),e),t,3)}function Wre(e,t){return Si(e.getMilliseconds(),t,3)}function uNe(e,t){return Wre(e,t)+"000"}function dNe(e,t){return Si(e.getMonth()+1,t,2)}function hNe(e,t){return Si(e.getMinutes(),t,2)}function fNe(e,t){return Si(e.getSeconds(),t,2)}function pNe(e){var t=e.getDay();return t===0?7:t}function mNe(e,t){return Si(aR.count(tf(e)-1,e),t,2)}function Gre(e){var t=e.getDay();return t>=4||t===0?dx(e):dx.ceil(e)}function gNe(e,t){return e=Gre(e),Si(dx.count(tf(e),e)+(tf(e).getDay()===4),t,2)}function yNe(e){return e.getDay()}function vNe(e,t){return Si(JI.count(tf(e)-1,e),t,2)}function _Ne(e,t){return Si(e.getFullYear()%100,t,2)}function xNe(e,t){return e=Gre(e),Si(e.getFullYear()%100,t,2)}function bNe(e,t){return Si(e.getFullYear()%1e4,t,4)}function wNe(e,t){var r=e.getDay();return e=r>=4||r===0?dx(e):dx.ceil(e),Si(e.getFullYear()%1e4,t,4)}function SNe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Si(t/60|0,"0",2)+Si(t%60,"0",2)}function l9(e,t){return Si(e.getUTCDate(),t,2)}function TNe(e,t){return Si(e.getUTCHours(),t,2)}function ENe(e,t){return Si(e.getUTCHours()%12||12,t,2)}function ANe(e,t){return Si(1+oR.count(rf(e),e),t,3)}function qre(e,t){return Si(e.getUTCMilliseconds(),t,3)}function CNe(e,t){return qre(e,t)+"000"}function MNe(e,t){return Si(e.getUTCMonth()+1,t,2)}function PNe(e,t){return Si(e.getUTCMinutes(),t,2)}function INe(e,t){return Si(e.getUTCSeconds(),t,2)}function ONe(e){var t=e.getUTCDay();return t===0?7:t}function kNe(e,t){return Si(sR.count(rf(e)-1,e),t,2)}function Hre(e){var t=e.getUTCDay();return t>=4||t===0?hx(e):hx.ceil(e)}function RNe(e,t){return e=Hre(e),Si(hx.count(rf(e),e)+(rf(e).getUTCDay()===4),t,2)}function DNe(e){return e.getUTCDay()}function LNe(e,t){return Si(QI.count(rf(e)-1,e),t,2)}function NNe(e,t){return Si(e.getUTCFullYear()%100,t,2)}function zNe(e,t){return e=Hre(e),Si(e.getUTCFullYear()%100,t,2)}function jNe(e,t){return Si(e.getUTCFullYear()%1e4,t,4)}function FNe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?hx(e):hx.ceil(e),Si(e.getUTCFullYear()%1e4,t,4)}function BNe(){return"+0000"}function c9(){return"%"}function u9(e){return+e}function d9(e){return Math.floor(+e/1e3)}var w_,Zre,Xre;$Ne({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $Ne(e){return w_=$3e(e),Zre=w_.format,w_.parse,Xre=w_.utcFormat,w_.utcParse,w_}function UNe(e){return new Date(e)}function VNe(e){return e instanceof Date?+e:+new Date(+e)}function w$(e,t,r,n,a,l,h,i,_,b){var E=l$(),C=E.invert,I=E.domain,F=b(".%L"),$=b(":%S"),B=b("%I:%M"),q=b("%I %p"),G=b("%a %d"),H=b("%b %d"),J=b("%B"),Q=b("%Y");function oe(de){return(_(de)<de?F:i(de)<de?$:h(de)<de?B:l(de)<de?q:n(de)<de?a(de)<de?G:H:r(de)<de?J:Q)(de)}return E.invert=function(de){return new Date(C(de))},E.domain=function(de){return arguments.length?I(Array.from(de,VNe)):I().map(UNe)},E.ticks=function(de){var ae=I();return e(ae[0],ae[ae.length-1],de??10)},E.tickFormat=function(de,ae){return ae==null?oe:b(ae)},E.nice=function(de){var ae=I();return(!de||typeof de.range!="function")&&(de=t(ae[0],ae[ae.length-1],de??10)),de?I(Lre(ae,de)):E},E.copy=function(){return FE(E,w$(e,t,r,n,a,l,h,i,_,b))},E}function WNe(){return Bc.apply(w$(F3e,B3e,tf,x$,aR,BE,v$,g$,ny,Zre).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function GNe(){return Bc.apply(w$(z3e,j3e,rf,b$,sR,oR,_$,y$,ny,Xre).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function lR(){var e=0,t=1,r,n,a,l,h=Fs,i=!1,_;function b(C){return C==null||isNaN(C=+C)?_:h(a===0?.5:(C=(l(C)-r)*a,i?Math.max(0,Math.min(1,C)):C))}b.domain=function(C){return arguments.length?([e,t]=C,r=l(e=+e),n=l(t=+t),a=r===n?0:1/(n-r),b):[e,t]},b.clamp=function(C){return arguments.length?(i=!!C,b):i},b.interpolator=function(C){return arguments.length?(h=C,b):h};function E(C){return function(I){var F,$;return arguments.length?([F,$]=I,h=C(F,$),b):[h(0),h(1)]}}return b.range=E(cb),b.rangeRound=E(s$),b.unknown=function(C){return arguments.length?(_=C,b):_},function(C){return l=C,r=C(e),n=C(t),a=r===n?0:1/(n-r),b}}function Dm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Yre(){var e=Rm(lR()(Fs));return e.copy=function(){return Dm(e,Yre())},hf.apply(e,arguments)}function Kre(){var e=d$(lR()).domain([1,10]);return e.copy=function(){return Dm(e,Kre()).base(e.base())},hf.apply(e,arguments)}function Jre(){var e=h$(lR());return e.copy=function(){return Dm(e,Jre()).constant(e.constant())},hf.apply(e,arguments)}function S$(){var e=f$(lR());return e.copy=function(){return Dm(e,S$()).exponent(e.exponent())},hf.apply(e,arguments)}function qNe(){return S$.apply(null,arguments).exponent(.5)}function Qre(){var e=[],t=Fs;function r(n){if(n!=null&&!isNaN(n=+n))return t((zE(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(cm),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,l)=>kLe(e,l/n))},r.copy=function(){return Qre(t).domain(e)},hf.apply(r,arguments)}function cR(){var e=0,t=.5,r=1,n=1,a,l,h,i,_,b=Fs,E,C=!1,I;function F(B){return isNaN(B=+B)?I:(B=.5+((B=+E(B))-l)*(n*B<n*l?i:_),b(C?Math.max(0,Math.min(1,B)):B))}F.domain=function(B){return arguments.length?([e,t,r]=B,a=E(e=+e),l=E(t=+t),h=E(r=+r),i=a===l?0:.5/(l-a),_=l===h?0:.5/(h-l),n=l<a?-1:1,F):[e,t,r]},F.clamp=function(B){return arguments.length?(C=!!B,F):C},F.interpolator=function(B){return arguments.length?(b=B,F):b};function $(B){return function(q){var G,H,J;return arguments.length?([G,H,J]=q,b=i3e(B,[G,H,J]),F):[b(0),b(.5),b(1)]}}return F.range=$(cb),F.rangeRound=$(s$),F.unknown=function(B){return arguments.length?(I=B,F):I},function(B){return E=B,a=B(e),l=B(t),h=B(r),i=a===l?0:.5/(l-a),_=l===h?0:.5/(h-l),n=l<a?-1:1,F}}function ene(){var e=Rm(cR()(Fs));return e.copy=function(){return Dm(e,ene())},hf.apply(e,arguments)}function tne(){var e=d$(cR()).domain([.1,1,10]);return e.copy=function(){return Dm(e,tne()).base(e.base())},hf.apply(e,arguments)}function rne(){var e=h$(cR());return e.copy=function(){return Dm(e,rne()).constant(e.constant())},hf.apply(e,arguments)}function T$(){var e=f$(cR());return e.copy=function(){return Dm(e,T$()).exponent(e.exponent())},hf.apply(e,arguments)}function HNe(){return T$.apply(null,arguments).exponent(.5)}const h9=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:CT,scaleDiverging:ene,scaleDivergingLog:tne,scaleDivergingPow:T$,scaleDivergingSqrt:HNe,scaleDivergingSymlog:rne,scaleIdentity:Dre,scaleImplicit:eF,scaleLinear:YI,scaleLog:Nre,scaleOrdinal:i$,scalePoint:BS,scalePow:p$,scaleQuantile:Fre,scaleQuantize:Bre,scaleRadial:jre,scaleSequential:Yre,scaleSequentialLog:Kre,scaleSequentialPow:S$,scaleSequentialQuantile:Qre,scaleSequentialSqrt:qNe,scaleSequentialSymlog:Jre,scaleSqrt:C3e,scaleSymlog:zre,scaleThreshold:$re,scaleTime:WNe,scaleUtc:GNe,tickFormat:Rre},Symbol.toStringTag,{value:"Module"}));var ZNe=eb;function XNe(e,t,r){for(var n=-1,a=e.length;++n<a;){var l=e[n],h=t(l);if(h!=null&&(i===void 0?h===h&&!ZNe(h):r(h,i)))var i=h,_=l}return _}var nne=XNe;function YNe(e,t){return e>t}var KNe=YNe,JNe=nne,QNe=KNe,eze=lb;function tze(e){return e&&e.length?JNe(e,eze,QNe):void 0}var rze=tze;const Kp=yi(rze);function nze(e,t){return e<t}var ize=nze,oze=nne,aze=ize,sze=lb;function lze(e){return e&&e.length?oze(e,sze,aze):void 0}var cze=lze;const uR=yi(cze);var uze=j5,dze=km,hze=dre,fze=Ml;function pze(e,t){var r=fze(e)?uze:hze;return r(e,dze(t))}var mze=pze,gze=cre,yze=mze;function vze(e,t){return gze(yze(e,t),1)}var _ze=vze;const xze=yi(_ze);var bze=Q5;function wze(e,t){return bze(e,t)}var Sze=wze;const kT=yi(Sze);var ub=1e9,Tze={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},A$,bo=!0,zc="[DecimalError] ",by=zc+"Invalid argument: ",E$=zc+"Exponent out of range: ",db=Math.floor,Vg=Math.pow,Eze=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Xl,Da=1e7,po=7,ine=9007199254740991,eO=db(ine/po),$r={};$r.absoluteValue=$r.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};$r.comparedTo=$r.cmp=function(e){var t,r,n,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(n=l.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return n===a?0:n>a^l.s<0?1:-1};$r.decimalPlaces=$r.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*po;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};$r.dividedBy=$r.div=function(e){return Uh(this,new this.constructor(e))};$r.dividedToIntegerBy=$r.idiv=function(e){var t=this,r=t.constructor;return qi(Uh(t,new r(e),0,1),r.precision)};$r.equals=$r.eq=function(e){return!this.cmp(e)};$r.exponent=function(){return sa(this)};$r.greaterThan=$r.gt=function(e){return this.cmp(e)>0};$r.greaterThanOrEqualTo=$r.gte=function(e){return this.cmp(e)>=0};$r.isInteger=$r.isint=function(){return this.e>this.d.length-2};$r.isNegative=$r.isneg=function(){return this.s<0};$r.isPositive=$r.ispos=function(){return this.s>0};$r.isZero=function(){return this.s===0};$r.lessThan=$r.lt=function(e){return this.cmp(e)<0};$r.lessThanOrEqualTo=$r.lte=function(e){return this.cmp(e)<1};$r.logarithm=$r.log=function(e){var t,r=this,n=r.constructor,a=n.precision,l=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Xl))throw Error(zc+"NaN");if(r.s<1)throw Error(zc+(r.s?"NaN":"-Infinity"));return r.eq(Xl)?new n(0):(bo=!1,t=Uh(RT(r,l),RT(e,l),l),bo=!0,qi(t,a))};$r.minus=$r.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?sne(t,e):one(t,(e.s=-e.s,e))};$r.modulo=$r.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(zc+"NaN");return r.s?(bo=!1,t=Uh(r,e,0,1).times(e),bo=!0,r.minus(t)):qi(new n(r),a)};$r.naturalExponential=$r.exp=function(){return ane(this)};$r.naturalLogarithm=$r.ln=function(){return RT(this)};$r.negated=$r.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};$r.plus=$r.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?one(t,e):sne(t,(e.s=-e.s,e))};$r.precision=$r.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(by+e);if(t=sa(a)+1,n=a.d.length-1,r=n*po+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};$r.squareRoot=$r.sqrt=function(){var e,t,r,n,a,l,h,i=this,_=i.constructor;if(i.s<1){if(!i.s)return new _(0);throw Error(zc+"NaN")}for(e=sa(i),bo=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=Pd(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=db((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new _(t)):n=new _(a.toString()),r=_.precision,a=h=r+3;;)if(l=n,n=l.plus(Uh(i,l,h+2)).times(.5),Pd(l.d).slice(0,h)===(t=Pd(n.d)).slice(0,h)){if(t=t.slice(h-3,h+1),a==h&&t=="4999"){if(qi(l,r+1,0),l.times(l).eq(i)){n=l;break}}else if(t!="9999")break;h+=4}return bo=!0,qi(n,r)};$r.times=$r.mul=function(e){var t,r,n,a,l,h,i,_,b,E=this,C=E.constructor,I=E.d,F=(e=new C(e)).d;if(!E.s||!e.s)return new C(0);for(e.s*=E.s,r=E.e+e.e,_=I.length,b=F.length,_<b&&(l=I,I=F,F=l,h=_,_=b,b=h),l=[],h=_+b,n=h;n--;)l.push(0);for(n=b;--n>=0;){for(t=0,a=_+n;a>n;)i=l[a]+F[n]*I[a-n-1]+t,l[a--]=i%Da|0,t=i/Da|0;l[a]=(l[a]+t)%Da|0}for(;!l[--h];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,bo?qi(e,C.precision):e};$r.toDecimalPlaces=$r.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:($d(e,0,ub),t===void 0?t=n.rounding:$d(t,0,8),qi(r,e+sa(r)+1,t))};$r.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Ly(n,!0):($d(e,0,ub),t===void 0?t=a.rounding:$d(t,0,8),n=qi(new a(n),e+1,t),r=Ly(n,!0,e+1)),r};$r.toFixed=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?Ly(a):($d(e,0,ub),t===void 0?t=l.rounding:$d(t,0,8),n=qi(new l(a),e+sa(a)+1,t),r=Ly(n.abs(),!1,e+sa(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};$r.toInteger=$r.toint=function(){var e=this,t=e.constructor;return qi(new t(e),sa(e)+1,t.rounding)};$r.toNumber=function(){return+this};$r.toPower=$r.pow=function(e){var t,r,n,a,l,h,i=this,_=i.constructor,b=12,E=+(e=new _(e));if(!e.s)return new _(Xl);if(i=new _(i),!i.s){if(e.s<1)throw Error(zc+"Infinity");return i}if(i.eq(Xl))return i;if(n=_.precision,e.eq(Xl))return qi(i,n);if(t=e.e,r=e.d.length-1,h=t>=r,l=i.s,h){if((r=E<0?-E:E)<=ine){for(a=new _(Xl),t=Math.ceil(n/po+4),bo=!1;r%2&&(a=a.times(i),p9(a.d,t)),r=db(r/2),r!==0;)i=i.times(i),p9(i.d,t);return bo=!0,e.s<0?new _(Xl).div(a):qi(a,n)}}else if(l<0)throw Error(zc+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,bo=!1,a=e.times(RT(i,n+b)),bo=!0,a=ane(a),a.s=l,a};$r.toPrecision=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?(r=sa(a),n=Ly(a,r<=l.toExpNeg||r>=l.toExpPos)):($d(e,1,ub),t===void 0?t=l.rounding:$d(t,0,8),a=qi(new l(a),e,t),r=sa(a),n=Ly(a,e<=r||r<=l.toExpNeg,e)),n};$r.toSignificantDigits=$r.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):($d(e,1,ub),t===void 0?t=n.rounding:$d(t,0,8)),qi(new n(r),e,t)};$r.toString=$r.valueOf=$r.val=$r.toJSON=$r[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=sa(e),r=e.constructor;return Ly(e,t<=r.toExpNeg||t>=r.toExpPos)};function one(e,t){var r,n,a,l,h,i,_,b,E=e.constructor,C=E.precision;if(!e.s||!t.s)return t.s||(t=new E(e)),bo?qi(t,C):t;if(_=e.d,b=t.d,h=e.e,a=t.e,_=_.slice(),l=h-a,l){for(l<0?(n=_,l=-l,i=b.length):(n=b,a=h,i=_.length),h=Math.ceil(C/po),i=h>i?h+1:i+1,l>i&&(l=i,n.length=1),n.reverse();l--;)n.push(0);n.reverse()}for(i=_.length,l=b.length,i-l<0&&(l=i,n=b,b=_,_=n),r=0;l;)r=(_[--l]=_[l]+b[l]+r)/Da|0,_[l]%=Da;for(r&&(_.unshift(r),++a),i=_.length;_[--i]==0;)_.pop();return t.d=_,t.e=a,bo?qi(t,C):t}function $d(e,t,r){if(e!==~~e||e<t||e>r)throw Error(by+e)}function Pd(e){var t,r,n,a=e.length-1,l="",h=e[0];if(a>0){for(l+=h,t=1;t<a;t++)n=e[t]+"",r=po-n.length,r&&(l+=Op(r)),l+=n;h=e[t],n=h+"",r=po-n.length,r&&(l+=Op(r))}else if(h===0)return"0";for(;h%10===0;)h/=10;return l+h}var Uh=function(){function e(n,a){var l,h=0,i=n.length;for(n=n.slice();i--;)l=n[i]*a+h,n[i]=l%Da|0,h=l/Da|0;return h&&n.unshift(h),n}function t(n,a,l,h){var i,_;if(l!=h)_=l>h?1:-1;else for(i=_=0;i<l;i++)if(n[i]!=a[i]){_=n[i]>a[i]?1:-1;break}return _}function r(n,a,l){for(var h=0;l--;)n[l]-=h,h=n[l]<a[l]?1:0,n[l]=h*Da+n[l]-a[l];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,l,h){var i,_,b,E,C,I,F,$,B,q,G,H,J,Q,oe,de,ae,ve,Fe=n.constructor,ke=n.s==a.s?1:-1,Ce=n.d,je=a.d;if(!n.s)return new Fe(n);if(!a.s)throw Error(zc+"Division by zero");for(_=n.e-a.e,ae=je.length,oe=Ce.length,F=new Fe(ke),$=F.d=[],b=0;je[b]==(Ce[b]||0);)++b;if(je[b]>(Ce[b]||0)&&--_,l==null?H=l=Fe.precision:h?H=l+(sa(n)-sa(a))+1:H=l,H<0)return new Fe(0);if(H=H/po+2|0,b=0,ae==1)for(E=0,je=je[0],H++;(b<oe||E)&&H--;b++)J=E*Da+(Ce[b]||0),$[b]=J/je|0,E=J%je|0;else{for(E=Da/(je[0]+1)|0,E>1&&(je=e(je,E),Ce=e(Ce,E),ae=je.length,oe=Ce.length),Q=ae,B=Ce.slice(0,ae),q=B.length;q<ae;)B[q++]=0;ve=je.slice(),ve.unshift(0),de=je[0],je[1]>=Da/2&&++de;do E=0,i=t(je,B,ae,q),i<0?(G=B[0],ae!=q&&(G=G*Da+(B[1]||0)),E=G/de|0,E>1?(E>=Da&&(E=Da-1),C=e(je,E),I=C.length,q=B.length,i=t(C,B,I,q),i==1&&(E--,r(C,ae<I?ve:je,I))):(E==0&&(i=E=1),C=je.slice()),I=C.length,I<q&&C.unshift(0),r(B,C,q),i==-1&&(q=B.length,i=t(je,B,ae,q),i<1&&(E++,r(B,ae<q?ve:je,q))),q=B.length):i===0&&(E++,B=[0]),$[b++]=E,i&&B[0]?B[q++]=Ce[Q]||0:(B=[Ce[Q]],q=1);while((Q++<oe||B[0]!==void 0)&&H--)}return $[0]||$.shift(),F.e=_,qi(F,h?l+sa(F)+1:l)}}();function ane(e,t){var r,n,a,l,h,i,_=0,b=0,E=e.constructor,C=E.precision;if(sa(e)>16)throw Error(E$+sa(e));if(!e.s)return new E(Xl);for(t==null?(bo=!1,i=C):i=t,h=new E(.03125);e.abs().gte(.1);)e=e.times(h),b+=5;for(n=Math.log(Vg(2,b))/Math.LN10*2+5|0,i+=n,r=a=l=new E(Xl),E.precision=i;;){if(a=qi(a.times(e),i),r=r.times(++_),h=l.plus(Uh(a,r,i)),Pd(h.d).slice(0,i)===Pd(l.d).slice(0,i)){for(;b--;)l=qi(l.times(l),i);return E.precision=C,t==null?(bo=!0,qi(l,C)):l}l=h}}function sa(e){for(var t=e.e*po,r=e.d[0];r>=10;r/=10)t++;return t}function aN(e,t,r){if(t>e.LN10.sd())throw bo=!0,r&&(e.precision=r),Error(zc+"LN10 precision limit exceeded");return qi(new e(e.LN10),t)}function Op(e){for(var t="";e--;)t+="0";return t}function RT(e,t){var r,n,a,l,h,i,_,b,E,C=1,I=10,F=e,$=F.d,B=F.constructor,q=B.precision;if(F.s<1)throw Error(zc+(F.s?"NaN":"-Infinity"));if(F.eq(Xl))return new B(0);if(t==null?(bo=!1,b=q):b=t,F.eq(10))return t==null&&(bo=!0),aN(B,b);if(b+=I,B.precision=b,r=Pd($),n=r.charAt(0),l=sa(F),Math.abs(l)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)F=F.times(e),r=Pd(F.d),n=r.charAt(0),C++;l=sa(F),n>1?(F=new B("0."+r),l++):F=new B(n+"."+r.slice(1))}else return _=aN(B,b+2,q).times(l+""),F=RT(new B(n+"."+r.slice(1)),b-I).plus(_),B.precision=q,t==null?(bo=!0,qi(F,q)):F;for(i=h=F=Uh(F.minus(Xl),F.plus(Xl),b),E=qi(F.times(F),b),a=3;;){if(h=qi(h.times(E),b),_=i.plus(Uh(h,new B(a),b)),Pd(_.d).slice(0,b)===Pd(i.d).slice(0,b))return i=i.times(2),l!==0&&(i=i.plus(aN(B,b+2,q).times(l+""))),i=Uh(i,new B(C),b),B.precision=q,t==null?(bo=!0,qi(i,q)):i;i=_,a+=2}}function f9(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=db(r/po),e.d=[],n=(r+1)%po,r<0&&(n+=po),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=po;n<a;)e.d.push(+t.slice(n,n+=po));t=t.slice(n),n=po-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),bo&&(e.e>eO||e.e<-eO))throw Error(E$+r)}else e.s=0,e.e=0,e.d=[0];return e}function qi(e,t,r){var n,a,l,h,i,_,b,E,C=e.d;for(h=1,l=C[0];l>=10;l/=10)h++;if(n=t-h,n<0)n+=po,a=t,b=C[E=0];else{if(E=Math.ceil((n+1)/po),l=C.length,E>=l)return e;for(b=l=C[E],h=1;l>=10;l/=10)h++;n%=po,a=n-po+h}if(r!==void 0&&(l=Vg(10,h-a-1),i=b/l%10|0,_=t<0||C[E+1]!==void 0||b%l,_=r<4?(i||_)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||_||r==6&&(n>0?a>0?b/Vg(10,h-a):0:C[E-1])%10&1||r==(e.s<0?8:7))),t<1||!C[0])return _?(l=sa(e),C.length=1,t=t-l-1,C[0]=Vg(10,(po-t%po)%po),e.e=db(-t/po)||0):(C.length=1,C[0]=e.e=e.s=0),e;if(n==0?(C.length=E,l=1,E--):(C.length=E+1,l=Vg(10,po-n),C[E]=a>0?(b/Vg(10,h-a)%Vg(10,a)|0)*l:0),_)for(;;)if(E==0){(C[0]+=l)==Da&&(C[0]=1,++e.e);break}else{if(C[E]+=l,C[E]!=Da)break;C[E--]=0,l=1}for(n=C.length;C[--n]===0;)C.pop();if(bo&&(e.e>eO||e.e<-eO))throw Error(E$+sa(e));return e}function sne(e,t){var r,n,a,l,h,i,_,b,E,C,I=e.constructor,F=I.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new I(e),bo?qi(t,F):t;if(_=e.d,C=t.d,n=t.e,b=e.e,_=_.slice(),h=b-n,h){for(E=h<0,E?(r=_,h=-h,i=C.length):(r=C,n=b,i=_.length),a=Math.max(Math.ceil(F/po),i)+2,h>a&&(h=a,r.length=1),r.reverse(),a=h;a--;)r.push(0);r.reverse()}else{for(a=_.length,i=C.length,E=a<i,E&&(i=a),a=0;a<i;a++)if(_[a]!=C[a]){E=_[a]<C[a];break}h=0}for(E&&(r=_,_=C,C=r,t.s=-t.s),i=_.length,a=C.length-i;a>0;--a)_[i++]=0;for(a=C.length;a>h;){if(_[--a]<C[a]){for(l=a;l&&_[--l]===0;)_[l]=Da-1;--_[l],_[a]+=Da}_[a]-=C[a]}for(;_[--i]===0;)_.pop();for(;_[0]===0;_.shift())--n;return _[0]?(t.d=_,t.e=n,bo?qi(t,F):t):new I(0)}function Ly(e,t,r){var n,a=sa(e),l=Pd(e.d),h=l.length;return t?(r&&(n=r-h)>0?l=l.charAt(0)+"."+l.slice(1)+Op(n):h>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+Op(-a-1)+l,r&&(n=r-h)>0&&(l+=Op(n))):a>=h?(l+=Op(a+1-h),r&&(n=r-a-1)>0&&(l=l+"."+Op(n))):((n=a+1)<h&&(l=l.slice(0,n)+"."+l.slice(n)),r&&(n=r-h)>0&&(a+1===h&&(l+="."),l+=Op(n))),e.s<0?"-"+l:l}function p9(e,t){if(e.length>t)return e.length=t,!0}function lne(e){var t,r,n;function a(l){var h=this;if(!(h instanceof a))return new a(l);if(h.constructor=a,l instanceof a){h.s=l.s,h.e=l.e,h.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(by+l);if(l>0)h.s=1;else if(l<0)l=-l,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(l===~~l&&l<1e7){h.e=0,h.d=[l];return}return f9(h,l.toString())}else if(typeof l!="string")throw Error(by+l);if(l.charCodeAt(0)===45?(l=l.slice(1),h.s=-1):h.s=1,Eze.test(l))f9(h,l);else throw Error(by+l)}if(a.prototype=$r,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=lne,a.config=a.set=Aze,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function Aze(e){if(!e||typeof e!="object")throw Error(zc+"Object expected");var t,r,n,a=["precision",1,ub,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(db(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(by+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(by+r+": "+n);return this}var A$=lne(Tze);Xl=new A$(1);const $i=A$;function Cze(e){return Oze(e)||Ize(e)||Pze(e)||Mze()}function Mze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pze(e,t){if(e){if(typeof e=="string")return iF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iF(e,t)}}function Ize(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Oze(e){if(Array.isArray(e))return iF(e)}function iF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var kze=function(t){return t},cne={"@@functional/placeholder":!0},une=function(t){return t===cne},m9=function(t){return function r(){return arguments.length===0||arguments.length===1&&une(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},Rze=function e(t,r){return t===1?r:m9(function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var h=a.filter(function(i){return i!==cne}).length;return h>=t?r.apply(void 0,a):e(t-h,m9(function(){for(var i=arguments.length,_=new Array(i),b=0;b<i;b++)_[b]=arguments[b];var E=a.map(function(C){return une(C)?_.shift():C});return r.apply(void 0,Cze(E).concat(_))}))})},dR=function(t){return Rze(t.length,t)},oF=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},Dze=dR(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),Lze=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return kze;var a=r.reverse(),l=a[0],h=a.slice(1);return function(){return h.reduce(function(i,_){return _(i)},l.apply(void 0,arguments))}},aF=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},dne=function(t){var r=null,n=null;return function(){for(var a=arguments.length,l=new Array(a),h=0;h<a;h++)l[h]=arguments[h];return r&&l.every(function(i,_){return i===r[_]})||(r=l,n=t.apply(void 0,l)),n}};function Nze(e){var t;return e===0?t=1:t=Math.floor(new $i(e).abs().log(10).toNumber())+1,t}function zze(e,t,r){for(var n=new $i(e),a=0,l=[];n.lt(t)&&a<1e5;)l.push(n.toNumber()),n=n.add(r),a++;return l}var jze=dR(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),Fze=dR(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),Bze=dR(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const hR={rangeStep:zze,getDigitCount:Nze,interpolateNumber:jze,uninterpolateNumber:Fze,uninterpolateTruncation:Bze};function sF(e){return Vze(e)||Uze(e)||hne(e)||$ze()}function $ze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uze(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Vze(e){if(Array.isArray(e))return lF(e)}function DT(e,t){return qze(e)||Gze(e,t)||hne(e,t)||Wze()}function Wze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hne(e,t){if(e){if(typeof e=="string")return lF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lF(e,t)}}function lF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gze(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,l=void 0;try{for(var h=e[Symbol.iterator](),i;!(n=(i=h.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(_){a=!0,l=_}finally{try{!n&&h.return!=null&&h.return()}finally{if(a)throw l}}return r}}function qze(e){if(Array.isArray(e))return e}function fne(e){var t=DT(e,2),r=t[0],n=t[1],a=r,l=n;return r>n&&(a=n,l=r),[a,l]}function pne(e,t,r){if(e.lte(0))return new $i(0);var n=hR.getDigitCount(e.toNumber()),a=new $i(10).pow(n),l=e.div(a),h=n!==1?.05:.1,i=new $i(Math.ceil(l.div(h).toNumber())).add(r).mul(h),_=i.mul(a);return t?_:new $i(Math.ceil(_))}function Hze(e,t,r){var n=1,a=new $i(e);if(!a.isint()&&r){var l=Math.abs(e);l<1?(n=new $i(10).pow(hR.getDigitCount(e)-1),a=new $i(Math.floor(a.div(n).toNumber())).mul(n)):l>1&&(a=new $i(Math.floor(e)))}else e===0?a=new $i(Math.floor((t-1)/2)):r||(a=new $i(Math.floor(e)));var h=Math.floor((t-1)/2),i=Lze(Dze(function(_){return a.add(new $i(_-h).mul(n)).toNumber()}),oF);return i(0,t)}function mne(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new $i(0),tickMin:new $i(0),tickMax:new $i(0)};var l=pne(new $i(t).sub(e).div(r-1),n,a),h;e<=0&&t>=0?h=new $i(0):(h=new $i(e).add(t).div(2),h=h.sub(new $i(h).mod(l)));var i=Math.ceil(h.sub(e).div(l).toNumber()),_=Math.ceil(new $i(t).sub(h).div(l).toNumber()),b=i+_+1;return b>r?mne(e,t,r,n,a+1):(b<r&&(_=t>0?_+(r-b):_,i=t>0?i:i+(r-b)),{step:l,tickMin:h.sub(new $i(i).mul(l)),tickMax:h.add(new $i(_).mul(l))})}function Zze(e){var t=DT(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(a,2),i=fne([r,n]),_=DT(i,2),b=_[0],E=_[1];if(b===-1/0||E===1/0){var C=E===1/0?[b].concat(sF(oF(0,a-1).map(function(){return 1/0}))):[].concat(sF(oF(0,a-1).map(function(){return-1/0})),[E]);return r>n?aF(C):C}if(b===E)return Hze(b,a,l);var I=mne(b,E,h,l),F=I.step,$=I.tickMin,B=I.tickMax,q=hR.rangeStep($,B.add(new $i(.1).mul(F)),F);return r>n?aF(q):q}function Xze(e,t){var r=DT(e,2),n=r[0],a=r[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=fne([n,a]),i=DT(h,2),_=i[0],b=i[1];if(_===-1/0||b===1/0)return[n,a];if(_===b)return[_];var E=Math.max(t,2),C=pne(new $i(b).sub(_).div(E-1),l,0),I=[].concat(sF(hR.rangeStep(new $i(_),new $i(b).sub(new $i(.99).mul(C)),C)),[b]);return n>a?aF(I):I}var Yze=dne(Zze),Kze=dne(Xze),Jze="Invariant failed";function Ny(e,t){throw new Error(Jze)}var Qze=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function fx(e){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(e)}function tO(){return tO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tO.apply(this,arguments)}function eje(e,t){return ije(e)||nje(e,t)||rje(e,t)||tje()}function tje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rje(e,t){if(e){if(typeof e=="string")return g9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g9(e,t)}}function g9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function ije(e){if(Array.isArray(e))return e}function oje(e,t){if(e==null)return{};var r=aje(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lje(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vne(n.key),n)}}function cje(e,t,r){return t&&lje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uje(e,t,r){return t=rO(t),dje(e,gne()?Reflect.construct(t,r||[],rO(e).constructor):t.apply(e,r))}function dje(e,t){if(t&&(fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hje(e)}function hje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gne=function(){return!!e})()}function rO(e){return rO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rO(e)}function fje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cF(e,t)}function cF(e,t){return cF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},cF(e,t)}function yne(e,t,r){return t=vne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vne(e){var t=pje(e,"string");return fx(t)=="symbol"?t:t+""}function pje(e,t){if(fx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fR=function(e){function t(){return sje(this,t),uje(this,t,arguments)}return fje(t,e),cje(t,[{key:"render",value:function(){var n=this.props,a=n.offset,l=n.layout,h=n.width,i=n.dataKey,_=n.data,b=n.dataPointFormatter,E=n.xAxis,C=n.yAxis,I=oje(n,Qze),F=ti(I,!1);this.props.direction==="x"&&E.type!=="number"&&Ny();var $=_.map(function(B){var q=b(B,i),G=q.x,H=q.y,J=q.value,Q=q.errorVal;if(!Q)return null;var oe=[],de,ae;if(Array.isArray(Q)){var ve=eje(Q,2);de=ve[0],ae=ve[1]}else de=ae=Q;if(l==="vertical"){var Fe=E.scale,ke=H+a,Ce=ke+h,je=ke-h,tt=Fe(J-de),Ze=Fe(J+ae);oe.push({x1:Ze,y1:Ce,x2:Ze,y2:je}),oe.push({x1:tt,y1:ke,x2:Ze,y2:ke}),oe.push({x1:tt,y1:Ce,x2:tt,y2:je})}else if(l==="horizontal"){var Qe=C.scale,st=G+a,ot=st-h,Be=st+h,lt=Qe(J-de),zt=Qe(J+ae);oe.push({x1:ot,y1:zt,x2:Be,y2:zt}),oe.push({x1:st,y1:lt,x2:st,y2:zt}),oe.push({x1:ot,y1:lt,x2:Be,y2:lt})}return Ae.createElement(Io,tO({className:"recharts-errorBar",key:"bar-".concat(oe.map(function(Lt){return"".concat(Lt.x1,"-").concat(Lt.x2,"-").concat(Lt.y1,"-").concat(Lt.y2)}))},F),oe.map(function(Lt){return Ae.createElement("line",tO({},Lt,{key:"line-".concat(Lt.x1,"-").concat(Lt.x2,"-").concat(Lt.y1,"-").concat(Lt.y2)}))}))});return Ae.createElement(Io,{className:"recharts-errorBars"},$)}}])}(Ae.Component);yne(fR,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});yne(fR,"displayName","ErrorBar");function LT(e){"@babel/helpers - typeof";return LT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LT(e)}function y9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y9(Object(r),!0).forEach(function(n){mje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mje(e,t,r){return t=gje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gje(e){var t=yje(e,"string");return LT(t)=="symbol"?t:t+""}function yje(e,t){if(LT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(LT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ne=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,l=t.legendContent,h=Wl(r,_y);if(!h)return null;var i=_y.defaultProps,_=i!==void 0?Lg(Lg({},i),h.props):{},b;return h.props&&h.props.payload?b=h.props&&h.props.payload:l==="children"?b=(n||[]).reduce(function(E,C){var I=C.item,F=C.props,$=F.sectors||F.data||[];return E.concat($.map(function(B){return{type:h.props.iconType||I.props.legendType,value:B.name,color:B.fill,payload:B}}))},[]):b=(n||[]).map(function(E){var C=E.item,I=C.type.defaultProps,F=I!==void 0?Lg(Lg({},I),C.props):{},$=F.dataKey,B=F.name,q=F.legendType,G=F.hide;return{inactive:G,dataKey:$,type:_.iconType||q||"square",color:C$(C),value:B||$,payload:F}}),Lg(Lg(Lg({},_),_y.getWithHeight(h,a)),{},{payload:b,item:h})};function NT(e){"@babel/helpers - typeof";return NT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NT(e)}function v9(e){return bje(e)||xje(e)||_je(e)||vje()}function vje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _je(e,t){if(e){if(typeof e=="string")return uF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uF(e,t)}}function xje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bje(e){if(Array.isArray(e))return uF(e)}function uF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_9(Object(r),!0).forEach(function(n){P0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P0(e,t,r){return t=wje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wje(e){var t=Sje(e,"string");return NT(t)=="symbol"?t:t+""}function Sje(e,t){if(NT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(NT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nc(e,t,r){return ui(e)||ui(t)?r:Aa(t)?Rc(e,t,r):Xn(t)?t(e):r}function $S(e,t,r,n){var a=xze(e,function(i){return nc(i,t)});if(r==="number"){var l=a.filter(function(i){return Sr(i)||parseFloat(i)});return l.length?[uR(l),Kp(l)]:[1/0,-1/0]}var h=n?a.filter(function(i){return!ui(i)}):a;return h.map(function(i){return Aa(i)||i instanceof Date?i:""})}var Tje=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,h=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var _=l.range,b=0;b<i;b++){var E=b>0?a[b-1].coordinate:a[i-1].coordinate,C=a[b].coordinate,I=b>=i-1?a[0].coordinate:a[b+1].coordinate,F=void 0;if(Cu(C-E)!==Cu(I-C)){var $=[];if(Cu(I-C)===Cu(_[1]-_[0])){F=I;var B=C+_[1]-_[0];$[0]=Math.min(B,(B+E)/2),$[1]=Math.max(B,(B+E)/2)}else{F=E;var q=I+_[1]-_[0];$[0]=Math.min(C,(q+C)/2),$[1]=Math.max(C,(q+C)/2)}var G=[Math.min(C,(F+C)/2),Math.max(C,(F+C)/2)];if(t>G[0]&&t<=G[1]||t>=$[0]&&t<=$[1]){h=a[b].index;break}}else{var H=Math.min(E,I),J=Math.max(E,I);if(t>(H+C)/2&&t<=(J+C)/2){h=a[b].index;break}}}else for(var Q=0;Q<i;Q++)if(Q===0&&t<=(n[Q].coordinate+n[Q+1].coordinate)/2||Q>0&&Q<i-1&&t>(n[Q].coordinate+n[Q-1].coordinate)/2&&t<=(n[Q].coordinate+n[Q+1].coordinate)/2||Q===i-1&&t>(n[Q].coordinate+n[Q-1].coordinate)/2){h=n[Q].index;break}return h},C$=function(t){var r,n=t,a=n.type.displayName,l=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Uo(Uo({},t.type.defaultProps),t.props):t.props,h=l.stroke,i=l.fill,_;switch(a){case"Line":_=h;break;case"Area":case"Radar":_=h&&h!=="none"?h:i;break;default:_=i;break}return _},Eje=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,l=a===void 0?{}:a;if(!l)return{};for(var h={},i=Object.keys(l),_=0,b=i.length;_<b;_++)for(var E=l[i[_]].stackGroups,C=Object.keys(E),I=0,F=C.length;I<F;I++){var $=E[C[I]],B=$.items,q=$.cateAxisId,G=B.filter(function(ae){return Fh(ae.type).indexOf("Bar")>=0});if(G&&G.length){var H=G[0].type.defaultProps,J=H!==void 0?Uo(Uo({},H),G[0].props):G[0].props,Q=J.barSize,oe=J[q];h[oe]||(h[oe]=[]);var de=ui(Q)?r:Q;h[oe].push({item:G[0],stackList:G.slice(1),barSize:ui(de)?void 0:Dy(de,n,0)})}}return h},Aje=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,l=t.sizeList,h=l===void 0?[]:l,i=t.maxBarSize,_=h.length;if(_<1)return null;var b=Dy(r,a,0,!0),E,C=[];if(h[0].barSize===+h[0].barSize){var I=!1,F=a/_,$=h.reduce(function(Q,oe){return Q+oe.barSize||0},0);$+=(_-1)*b,$>=a&&($-=(_-1)*b,b=0),$>=a&&F>0&&(I=!0,F*=.9,$=_*F);var B=(a-$)/2>>0,q={offset:B-b,size:0};E=h.reduce(function(Q,oe){var de={item:oe.item,position:{offset:q.offset+q.size+b,size:I?F:oe.barSize}},ae=[].concat(v9(Q),[de]);return q=ae[ae.length-1].position,oe.stackList&&oe.stackList.length&&oe.stackList.forEach(function(ve){ae.push({item:ve,position:q})}),ae},C)}else{var G=Dy(n,a,0,!0);a-2*G-(_-1)*b<=0&&(b=0);var H=(a-2*G-(_-1)*b)/_;H>1&&(H>>=0);var J=i===+i?Math.min(H,i):H;E=h.reduce(function(Q,oe,de){var ae=[].concat(v9(Q),[{item:oe.item,position:{offset:G+(H+b)*de+(H-J)/2,size:J}}]);return oe.stackList&&oe.stackList.length&&oe.stackList.forEach(function(ve){ae.push({item:ve,position:ae[ae.length-1].position})}),ae},C)}return E},Cje=function(t,r,n,a){var l=n.children,h=n.width,i=n.margin,_=h-(i.left||0)-(i.right||0),b=_ne({children:l,legendWidth:_});if(b){var E=a||{},C=E.width,I=E.height,F=b.align,$=b.verticalAlign,B=b.layout;if((B==="vertical"||B==="horizontal"&&$==="middle")&&F!=="center"&&Sr(t[F]))return Uo(Uo({},t),{},P0({},F,t[F]+(C||0)));if((B==="horizontal"||B==="vertical"&&F==="center")&&$!=="middle"&&Sr(t[$]))return Uo(Uo({},t),{},P0({},$,t[$]+(I||0)))}return t},Mje=function(t,r,n){return ui(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},xne=function(t,r,n,a,l){var h=r.props.children,i=ku(h,fR).filter(function(b){return Mje(a,l,b.props.direction)});if(i&&i.length){var _=i.map(function(b){return b.props.dataKey});return t.reduce(function(b,E){var C=nc(E,n);if(ui(C))return b;var I=Array.isArray(C)?[uR(C),Kp(C)]:[C,C],F=_.reduce(function($,B){var q=nc(E,B,0),G=I[0]-Math.abs(Array.isArray(q)?q[0]:q),H=I[1]+Math.abs(Array.isArray(q)?q[1]:q);return[Math.min(G,$[0]),Math.max(H,$[1])]},[1/0,-1/0]);return[Math.min(F[0],b[0]),Math.max(F[1],b[1])]},[1/0,-1/0])}return null},Pje=function(t,r,n,a,l){var h=r.map(function(i){return xne(t,i,n,l,a)}).filter(function(i){return!ui(i)});return h&&h.length?h.reduce(function(i,_){return[Math.min(i[0],_[0]),Math.max(i[1],_[1])]},[1/0,-1/0]):null},bne=function(t,r,n,a,l){var h=r.map(function(_){var b=_.props.dataKey;return n==="number"&&b&&xne(t,_,b,a)||$S(t,b,n,l)});if(n==="number")return h.reduce(function(_,b){return[Math.min(_[0],b[0]),Math.max(_[1],b[1])]},[1/0,-1/0]);var i={};return h.reduce(function(_,b){for(var E=0,C=b.length;E<C;E++)i[b[E]]||(i[b[E]]=!0,_.push(b[E]));return _},[])},wne=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},Sne=function(t,r,n,a){if(a)return t.map(function(_){return _.coordinate});var l,h,i=t.map(function(_){return _.coordinate===r&&(l=!0),_.coordinate===n&&(h=!0),_.coordinate});return l||i.push(r),h||i.push(n),i},Dh=function(t,r,n){if(!t)return null;var a=t.scale,l=t.duplicateDomain,h=t.type,i=t.range,_=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,b=(r||n)&&h==="category"&&a.bandwidth?a.bandwidth()/_:0;if(b=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?Cu(i[0]-i[1])*2*b:b,r&&(t.ticks||t.niceTicks)){var E=(t.ticks||t.niceTicks).map(function(C){var I=l?l.indexOf(C):C;return{coordinate:a(I)+b,value:C,offset:b}});return E.filter(function(C){return!ob(C.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(C,I){return{coordinate:a(C)+b,value:C,index:I,offset:b}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(C){return{coordinate:a(C)+b,value:C,offset:b}}):a.domain().map(function(C,I){return{coordinate:a(C)+b,value:l?l[C]:C,index:I,offset:b}})},sN=new WeakMap,PC=function(t,r){if(typeof r!="function")return t;sN.has(t)||sN.set(t,new WeakMap);var n=sN.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},Ije=function(t,r,n){var a=t.scale,l=t.type,h=t.layout,i=t.axisType;if(a==="auto")return h==="radial"&&i==="radiusAxis"?{scale:CT(),realScaleType:"band"}:h==="radial"&&i==="angleAxis"?{scale:YI(),realScaleType:"linear"}:l==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:BS(),realScaleType:"point"}:l==="category"?{scale:CT(),realScaleType:"band"}:{scale:YI(),realScaleType:"linear"};if(DE(a)){var _="scale".concat(Kk(a));return{scale:(h9[_]||BS)(),realScaleType:h9[_]?_:"point"}}return Xn(a)?{scale:a}:{scale:BS(),realScaleType:"point"}},x9=1e-4,Oje=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),l=Math.min(a[0],a[1])-x9,h=Math.max(a[0],a[1])+x9,i=t(r[0]),_=t(r[n-1]);(i<l||i>h||_<l||_>h)&&t.domain([r[0],r[n-1]])}},kje=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},Rje=function(t,r){if(!r||r.length!==2||!Sr(r[0])||!Sr(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[t[0],t[1]];return(!Sr(t[0])||t[0]<n)&&(l[0]=n),(!Sr(t[1])||t[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},Dje=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,h=0,i=0;i<r;++i){var _=ob(t[i][n][1])?t[i][n][0]:t[i][n][1];_>=0?(t[i][n][0]=l,t[i][n][1]=l+_,l=t[i][n][1]):(t[i][n][0]=h,t[i][n][1]=h+_,h=t[i][n][1])}},Lje=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,h=0;h<r;++h){var i=ob(t[h][n][1])?t[h][n][0]:t[h][n][1];i>=0?(t[h][n][0]=l,t[h][n][1]=l+i,l=t[h][n][1]):(t[h][n][0]=0,t[h][n][1]=0)}},Nje={sign:Dje,expand:K2e,none:ox,silhouette:J2e,wiggle:Q2e,positive:Lje},zje=function(t,r,n){var a=r.map(function(i){return i.props.dataKey}),l=Nje[n],h=Y2e().keys(a).value(function(i,_){return+nc(i,_,0)}).order(Lj).offset(l);return h(t)},jje=function(t,r,n,a,l,h){if(!t)return null;var i=h?r.reverse():r,_={},b=i.reduce(function(C,I){var F,$=(F=I.type)!==null&&F!==void 0&&F.defaultProps?Uo(Uo({},I.type.defaultProps),I.props):I.props,B=$.stackId,q=$.hide;if(q)return C;var G=$[n],H=C[G]||{hasStack:!1,stackGroups:{}};if(Aa(B)){var J=H.stackGroups[B]||{numericAxisId:n,cateAxisId:a,items:[]};J.items.push(I),H.hasStack=!0,H.stackGroups[B]=J}else H.stackGroups[LE("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[I]};return Uo(Uo({},C),{},P0({},G,H))},_),E={};return Object.keys(b).reduce(function(C,I){var F=b[I];if(F.hasStack){var $={};F.stackGroups=Object.keys(F.stackGroups).reduce(function(B,q){var G=F.stackGroups[q];return Uo(Uo({},B),{},P0({},q,{numericAxisId:n,cateAxisId:a,items:G.items,stackedData:zje(t,G.items,l)}))},$)}return Uo(Uo({},C),{},P0({},I,F))},E)},Fje=function(t,r){var n=r.realScaleType,a=r.type,l=r.tickCount,h=r.originalDomain,i=r.allowDecimals,_=n||r.scale;if(_!=="auto"&&_!=="linear")return null;if(l&&a==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var b=t.domain();if(!b.length)return null;var E=Yze(b,l,i);return t.domain([uR(E),Kp(E)]),{niceTicks:E}}if(l&&a==="number"){var C=t.domain(),I=Kze(C,l,i);return{niceTicks:I}}return null};function b9(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,l=e.index,h=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!ui(a[t.dataKey])){var i=CI(r,"value",a[t.dataKey]);if(i)return i.coordinate+n/2}return r[l]?r[l].coordinate+n/2:null}var _=nc(a,ui(h)?t.dataKey:h);return ui(_)?null:t.scale(_)}var w9=function(t){var r=t.axis,n=t.ticks,a=t.offset,l=t.bandSize,h=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+a:null;var _=nc(h,r.dataKey,r.domain[i]);return ui(_)?null:r.scale(_)-l/2+a},Bje=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},$je=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Uo(Uo({},t.type.defaultProps),t.props):t.props,l=a.stackId;if(Aa(l)){var h=r[l];if(h){var i=h.items.indexOf(t);return i>=0?h.stackedData[i]:null}}return null},Uje=function(t){return t.reduce(function(r,n){return[uR(n.concat([r[0]]).filter(Sr)),Kp(n.concat([r[1]]).filter(Sr))]},[1/0,-1/0])},Tne=function(t,r,n){return Object.keys(t).reduce(function(a,l){var h=t[l],i=h.stackedData,_=i.reduce(function(b,E){var C=Uje(E.slice(r,n+1));return[Math.min(b[0],C[0]),Math.max(b[1],C[1])]},[1/0,-1/0]);return[Math.min(_[0],a[0]),Math.max(_[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},S9=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,T9=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,dF=function(t,r,n){if(Xn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Sr(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(S9.test(t[0])){var l=+S9.exec(t[0])[1];a[0]=r[0]-l}else Xn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Sr(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(T9.test(t[1])){var h=+T9.exec(t[1])[1];a[1]=r[1]+h}else Xn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},nO=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var l=t$(r,function(C){return C.coordinate}),h=1/0,i=1,_=l.length;i<_;i++){var b=l[i],E=l[i-1];h=Math.min((b.coordinate||0)-(E.coordinate||0),h)}return h===1/0?0:h}return n?void 0:0},E9=function(t,r,n){return!t||!t.length||kT(t,Rc(n,"type.defaultProps.domain"))?r:t},Ene=function(t,r){var n=t.type.defaultProps?Uo(Uo({},t.type.defaultProps),t.props):t.props,a=n.dataKey,l=n.name,h=n.unit,i=n.formatter,_=n.tooltipType,b=n.chartType,E=n.hide;return Uo(Uo({},ti(t,!1)),{},{dataKey:a,unit:h,formatter:i,name:l||a,color:C$(t),value:nc(r,a),type:_,payload:r,chartType:b,hide:E})};function zT(e){"@babel/helpers - typeof";return zT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zT(e)}function A9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A9(Object(r),!0).forEach(function(n){Vje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vje(e,t,r){return t=Wje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wje(e){var t=Gje(e,"string");return zT(t)=="symbol"?t:t+""}function Gje(e,t){if(zT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iO=Math.PI/180,qje=function(t){return t*180/Math.PI},Za=function(t,r,n,a){return{x:t+Math.cos(-iO*a)*n,y:r+Math.sin(-iO*a)*n}},Hje=function(t,r){var n=t.x,a=t.y,l=r.x,h=r.y;return Math.sqrt(Math.pow(n-l,2)+Math.pow(a-h,2))},Zje=function(t,r){var n=t.x,a=t.y,l=r.cx,h=r.cy,i=Hje({x:n,y:a},{x:l,y:h});if(i<=0)return{radius:i};var _=(n-l)/i,b=Math.acos(_);return a>h&&(b=2*Math.PI-b),{radius:i,angle:qje(b),angleInRadian:b}},Xje=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),l=Math.floor(n/360),h=Math.min(a,l);return{startAngle:r-h*360,endAngle:n-h*360}},Yje=function(t,r){var n=r.startAngle,a=r.endAngle,l=Math.floor(n/360),h=Math.floor(a/360),i=Math.min(l,h);return t+i*360},M9=function(t,r){var n=t.x,a=t.y,l=Zje({x:n,y:a},r),h=l.radius,i=l.angle,_=r.innerRadius,b=r.outerRadius;if(h<_||h>b)return!1;if(h===0)return!0;var E=Xje(r),C=E.startAngle,I=E.endAngle,F=i,$;if(C<=I){for(;F>I;)F-=360;for(;F<C;)F+=360;$=F>=C&&F<=I}else{for(;F>C;)F-=360;for(;F<I;)F+=360;$=F>=I&&F<=C}return $?C9(C9({},r),{},{radius:h,angle:Yje(F,r)}):null};function jT(e){"@babel/helpers - typeof";return jT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jT(e)}var Kje=["offset"];function Jje(e){return rFe(e)||tFe(e)||eFe(e)||Qje()}function Qje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eFe(e,t){if(e){if(typeof e=="string")return hF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hF(e,t)}}function tFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rFe(e){if(Array.isArray(e))return hF(e)}function hF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nFe(e,t){if(e==null)return{};var r=iFe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function P9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ga(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P9(Object(r),!0).forEach(function(n){oFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oFe(e,t,r){return t=aFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aFe(e){var t=sFe(e,"string");return jT(t)=="symbol"?t:t+""}function sFe(e,t){if(jT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FT(){return FT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FT.apply(this,arguments)}var lFe=function(t){var r=t.value,n=t.formatter,a=ui(t.children)?r:t.children;return Xn(n)?n(a):a},cFe=function(t,r){var n=Cu(r-t),a=Math.min(Math.abs(r-t),360);return n*a},uFe=function(t,r,n){var a=t.position,l=t.viewBox,h=t.offset,i=t.className,_=l,b=_.cx,E=_.cy,C=_.innerRadius,I=_.outerRadius,F=_.startAngle,$=_.endAngle,B=_.clockWise,q=(C+I)/2,G=cFe(F,$),H=G>=0?1:-1,J,Q;a==="insideStart"?(J=F+H*h,Q=B):a==="insideEnd"?(J=$-H*h,Q=!B):a==="end"&&(J=$+H*h,Q=B),Q=G<=0?Q:!Q;var oe=Za(b,E,q,J),de=Za(b,E,q,J+(Q?1:-1)*359),ae="M".concat(oe.x,",").concat(oe.y,`
    A`).concat(q,",").concat(q,",0,1,").concat(Q?0:1,`,
    `).concat(de.x,",").concat(de.y),ve=ui(t.id)?LE("recharts-radial-line-"):t.id;return Ae.createElement("text",FT({},n,{dominantBaseline:"central",className:gi("recharts-radial-bar-label",i)}),Ae.createElement("defs",null,Ae.createElement("path",{id:ve,d:ae})),Ae.createElement("textPath",{xlinkHref:"#".concat(ve)},r))},dFe=function(t){var r=t.viewBox,n=t.offset,a=t.position,l=r,h=l.cx,i=l.cy,_=l.innerRadius,b=l.outerRadius,E=l.startAngle,C=l.endAngle,I=(E+C)/2;if(a==="outside"){var F=Za(h,i,b+n,I),$=F.x,B=F.y;return{x:$,y:B,textAnchor:$>=h?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"end"};var q=(_+b)/2,G=Za(h,i,q,I),H=G.x,J=G.y;return{x:H,y:J,textAnchor:"middle",verticalAnchor:"middle"}},hFe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,l=t.position,h=r,i=h.x,_=h.y,b=h.width,E=h.height,C=E>=0?1:-1,I=C*a,F=C>0?"end":"start",$=C>0?"start":"end",B=b>=0?1:-1,q=B*a,G=B>0?"end":"start",H=B>0?"start":"end";if(l==="top"){var J={x:i+b/2,y:_-C*a,textAnchor:"middle",verticalAnchor:F};return ga(ga({},J),n?{height:Math.max(_-n.y,0),width:b}:{})}if(l==="bottom"){var Q={x:i+b/2,y:_+E+I,textAnchor:"middle",verticalAnchor:$};return ga(ga({},Q),n?{height:Math.max(n.y+n.height-(_+E),0),width:b}:{})}if(l==="left"){var oe={x:i-q,y:_+E/2,textAnchor:G,verticalAnchor:"middle"};return ga(ga({},oe),n?{width:Math.max(oe.x-n.x,0),height:E}:{})}if(l==="right"){var de={x:i+b+q,y:_+E/2,textAnchor:H,verticalAnchor:"middle"};return ga(ga({},de),n?{width:Math.max(n.x+n.width-de.x,0),height:E}:{})}var ae=n?{width:b,height:E}:{};return l==="insideLeft"?ga({x:i+q,y:_+E/2,textAnchor:H,verticalAnchor:"middle"},ae):l==="insideRight"?ga({x:i+b-q,y:_+E/2,textAnchor:G,verticalAnchor:"middle"},ae):l==="insideTop"?ga({x:i+b/2,y:_+I,textAnchor:"middle",verticalAnchor:$},ae):l==="insideBottom"?ga({x:i+b/2,y:_+E-I,textAnchor:"middle",verticalAnchor:F},ae):l==="insideTopLeft"?ga({x:i+q,y:_+I,textAnchor:H,verticalAnchor:$},ae):l==="insideTopRight"?ga({x:i+b-q,y:_+I,textAnchor:G,verticalAnchor:$},ae):l==="insideBottomLeft"?ga({x:i+q,y:_+E-I,textAnchor:H,verticalAnchor:F},ae):l==="insideBottomRight"?ga({x:i+b-q,y:_+E-I,textAnchor:G,verticalAnchor:F},ae):tb(l)&&(Sr(l.x)||ty(l.x))&&(Sr(l.y)||ty(l.y))?ga({x:i+Dy(l.x,b),y:_+Dy(l.y,E),textAnchor:"end",verticalAnchor:"end"},ae):ga({x:i+b/2,y:_+E/2,textAnchor:"middle",verticalAnchor:"middle"},ae)},fFe=function(t){return"cx"in t&&Sr(t.cx)};function ds(e){var t=e.offset,r=t===void 0?5:t,n=nFe(e,Kje),a=ga({offset:r},n),l=a.viewBox,h=a.position,i=a.value,_=a.children,b=a.content,E=a.className,C=E===void 0?"":E,I=a.textBreakAll;if(!l||ui(i)&&ui(_)&&!ne.isValidElement(b)&&!Xn(b))return null;if(ne.isValidElement(b))return ne.cloneElement(b,a);var F;if(Xn(b)){if(F=ne.createElement(b,a),ne.isValidElement(F))return F}else F=lFe(a);var $=fFe(l),B=ti(a,!0);if($&&(h==="insideStart"||h==="insideEnd"||h==="end"))return uFe(a,F,B);var q=$?dFe(a):hFe(a);return Ae.createElement(VI,FT({className:gi("recharts-label",C)},B,q,{breakAll:I}),F)}ds.displayName="Label";var Ane=function(t){var r=t.cx,n=t.cy,a=t.angle,l=t.startAngle,h=t.endAngle,i=t.r,_=t.radius,b=t.innerRadius,E=t.outerRadius,C=t.x,I=t.y,F=t.top,$=t.left,B=t.width,q=t.height,G=t.clockWise,H=t.labelViewBox;if(H)return H;if(Sr(B)&&Sr(q)){if(Sr(C)&&Sr(I))return{x:C,y:I,width:B,height:q};if(Sr(F)&&Sr($))return{x:F,y:$,width:B,height:q}}return Sr(C)&&Sr(I)?{x:C,y:I,width:0,height:0}:Sr(r)&&Sr(n)?{cx:r,cy:n,startAngle:l||a||0,endAngle:h||a||0,innerRadius:b||0,outerRadius:E||_||i||0,clockWise:G}:t.viewBox?t.viewBox:{}},pFe=function(t,r){return t?t===!0?Ae.createElement(ds,{key:"label-implicit",viewBox:r}):Aa(t)?Ae.createElement(ds,{key:"label-implicit",viewBox:r,value:t}):ne.isValidElement(t)?t.type===ds?ne.cloneElement(t,{key:"label-implicit",viewBox:r}):Ae.createElement(ds,{key:"label-implicit",content:t,viewBox:r}):Xn(t)?Ae.createElement(ds,{key:"label-implicit",content:t,viewBox:r}):tb(t)?Ae.createElement(ds,FT({viewBox:r},t,{key:"label-implicit"})):null:null},mFe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,l=Ane(t),h=ku(a,ds).map(function(_,b){return ne.cloneElement(_,{viewBox:r||l,key:"label-".concat(b)})});if(!n)return h;var i=pFe(t.label,r||l);return[i].concat(Jje(h))};ds.parseViewBox=Ane;ds.renderCallByParent=mFe;function gFe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var yFe=gFe;const vFe=yi(yFe);function BT(e){"@babel/helpers - typeof";return BT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BT(e)}var _Fe=["valueAccessor"],xFe=["data","dataKey","clockWise","id","textBreakAll"];function bFe(e){return EFe(e)||TFe(e)||SFe(e)||wFe()}function wFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SFe(e,t){if(e){if(typeof e=="string")return fF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fF(e,t)}}function TFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EFe(e){if(Array.isArray(e))return fF(e)}function fF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oO(){return oO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oO.apply(this,arguments)}function I9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I9(Object(r),!0).forEach(function(n){AFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AFe(e,t,r){return t=CFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CFe(e){var t=MFe(e,"string");return BT(t)=="symbol"?t:t+""}function MFe(e,t){if(BT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(BT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k9(e,t){if(e==null)return{};var r=PFe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function PFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var IFe=function(t){return Array.isArray(t.value)?vFe(t.value):t.value};function um(e){var t=e.valueAccessor,r=t===void 0?IFe:t,n=k9(e,_Fe),a=n.data,l=n.dataKey,h=n.clockWise,i=n.id,_=n.textBreakAll,b=k9(n,xFe);return!a||!a.length?null:Ae.createElement(Io,{className:"recharts-label-list"},a.map(function(E,C){var I=ui(l)?r(E,C):nc(E&&E.payload,l),F=ui(i)?{}:{id:"".concat(i,"-").concat(C)};return Ae.createElement(ds,oO({},ti(E,!0),b,F,{parentViewBox:E.parentViewBox,value:I,textBreakAll:_,viewBox:ds.parseViewBox(ui(h)?E:O9(O9({},E),{},{clockWise:h})),key:"label-".concat(C),index:C}))}))}um.displayName="LabelList";function OFe(e,t){return e?e===!0?Ae.createElement(um,{key:"labelList-implicit",data:t}):Ae.isValidElement(e)||Xn(e)?Ae.createElement(um,{key:"labelList-implicit",data:t,content:e}):tb(e)?Ae.createElement(um,oO({data:t},e,{key:"labelList-implicit"})):null:null}function kFe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=ku(n,um).map(function(h,i){return ne.cloneElement(h,{data:t,key:"labelList-".concat(i)})});if(!r)return a;var l=OFe(e.label,t);return[l].concat(bFe(a))}um.renderCallByParent=kFe;function $T(e){"@babel/helpers - typeof";return $T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$T(e)}function pF(){return pF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pF.apply(this,arguments)}function R9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R9(Object(r),!0).forEach(function(n){RFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RFe(e,t,r){return t=DFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DFe(e){var t=LFe(e,"string");return $T(t)=="symbol"?t:t+""}function LFe(e,t){if($T(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($T(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NFe=function(t,r){var n=Cu(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},IC=function(t){var r=t.cx,n=t.cy,a=t.radius,l=t.angle,h=t.sign,i=t.isExternal,_=t.cornerRadius,b=t.cornerIsExternal,E=_*(i?1:-1)+a,C=Math.asin(_/E)/iO,I=b?l:l+h*C,F=Za(r,n,E,I),$=Za(r,n,a,I),B=b?l-h*C:l,q=Za(r,n,E*Math.cos(C*iO),B);return{center:F,circleTangency:$,lineTangency:q,theta:C}},Cne=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,h=t.startAngle,i=t.endAngle,_=NFe(h,i),b=h+_,E=Za(r,n,l,h),C=Za(r,n,l,b),I="M ".concat(E.x,",").concat(E.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(_)>180),",").concat(+(h>b),`,
    `).concat(C.x,",").concat(C.y,`
  `);if(a>0){var F=Za(r,n,a,h),$=Za(r,n,a,b);I+="L ".concat($.x,",").concat($.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(_)>180),",").concat(+(h<=b),`,
            `).concat(F.x,",").concat(F.y," Z")}else I+="L ".concat(r,",").concat(n," Z");return I},zFe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,h=t.cornerRadius,i=t.forceCornerRadius,_=t.cornerIsExternal,b=t.startAngle,E=t.endAngle,C=Cu(E-b),I=IC({cx:r,cy:n,radius:l,angle:b,sign:C,cornerRadius:h,cornerIsExternal:_}),F=I.circleTangency,$=I.lineTangency,B=I.theta,q=IC({cx:r,cy:n,radius:l,angle:E,sign:-C,cornerRadius:h,cornerIsExternal:_}),G=q.circleTangency,H=q.lineTangency,J=q.theta,Q=_?Math.abs(b-E):Math.abs(b-E)-B-J;if(Q<0)return i?"M ".concat($.x,",").concat($.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):Cne({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:b,endAngle:E});var oe="M ".concat($.x,",").concat($.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(F.x,",").concat(F.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(Q>180),",").concat(+(C<0),",").concat(G.x,",").concat(G.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(H.x,",").concat(H.y,`
  `);if(a>0){var de=IC({cx:r,cy:n,radius:a,angle:b,sign:C,isExternal:!0,cornerRadius:h,cornerIsExternal:_}),ae=de.circleTangency,ve=de.lineTangency,Fe=de.theta,ke=IC({cx:r,cy:n,radius:a,angle:E,sign:-C,isExternal:!0,cornerRadius:h,cornerIsExternal:_}),Ce=ke.circleTangency,je=ke.lineTangency,tt=ke.theta,Ze=_?Math.abs(b-E):Math.abs(b-E)-Fe-tt;if(Ze<0&&h===0)return"".concat(oe,"L").concat(r,",").concat(n,"Z");oe+="L".concat(je.x,",").concat(je.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(Ce.x,",").concat(Ce.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Ze>180),",").concat(+(C>0),",").concat(ae.x,",").concat(ae.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(ve.x,",").concat(ve.y,"Z")}else oe+="L".concat(r,",").concat(n,"Z");return oe},jFe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Mne=function(t){var r=D9(D9({},jFe),t),n=r.cx,a=r.cy,l=r.innerRadius,h=r.outerRadius,i=r.cornerRadius,_=r.forceCornerRadius,b=r.cornerIsExternal,E=r.startAngle,C=r.endAngle,I=r.className;if(h<l||E===C)return null;var F=gi("recharts-sector",I),$=h-l,B=Dy(i,$,0,!0),q;return B>0&&Math.abs(E-C)<360?q=zFe({cx:n,cy:a,innerRadius:l,outerRadius:h,cornerRadius:Math.min(B,$/2),forceCornerRadius:_,cornerIsExternal:b,startAngle:E,endAngle:C}):q=Cne({cx:n,cy:a,innerRadius:l,outerRadius:h,startAngle:E,endAngle:C}),Ae.createElement("path",pF({},ti(r,!0),{className:F,d:q,role:"img"}))};function UT(e){"@babel/helpers - typeof";return UT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UT(e)}function mF(){return mF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mF.apply(this,arguments)}function L9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L9(Object(r),!0).forEach(function(n){FFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FFe(e,t,r){return t=BFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BFe(e){var t=$Fe(e,"string");return UT(t)=="symbol"?t:t+""}function $Fe(e,t){if(UT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(UT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z9={curveBasisClosed:F2e,curveBasisOpen:B2e,curveBasis:j2e,curveBumpX:T2e,curveBumpY:E2e,curveLinearClosed:$2e,curveLinear:Qk,curveMonotoneX:U2e,curveMonotoneY:V2e,curveNatural:W2e,curveStep:G2e,curveStepAfter:H2e,curveStepBefore:q2e},OC=function(t){return t.x===+t.x&&t.y===+t.y},Ow=function(t){return t.x},kw=function(t){return t.y},UFe=function(t,r){if(Xn(t))return t;var n="curve".concat(Kk(t));return(n==="curveMonotone"||n==="curveBump")&&r?z9["".concat(n).concat(r==="vertical"?"Y":"X")]:z9[n]||Qk},VFe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,l=a===void 0?[]:a,h=t.baseLine,i=t.layout,_=t.connectNulls,b=_===void 0?!1:_,E=UFe(n,i),C=b?l.filter(function(B){return OC(B)}):l,I;if(Array.isArray(h)){var F=b?h.filter(function(B){return OC(B)}):h,$=C.map(function(B,q){return N9(N9({},B),{},{base:F[q]})});return i==="vertical"?I=bC().y(kw).x1(Ow).x0(function(B){return B.base.x}):I=bC().x(Ow).y1(kw).y0(function(B){return B.base.y}),I.defined(OC).curve(E),I($)}return i==="vertical"&&Sr(h)?I=bC().y(kw).x1(Ow).x0(h):Sr(h)?I=bC().x(Ow).y1(kw).y0(h):I=Mte().x(Ow).y(kw),I.defined(OC).curve(E),I(C)},US=function(t){var r=t.className,n=t.points,a=t.path,l=t.pathRef;if((!n||!n.length)&&!a)return null;var h=n&&n.length?VFe(t):a;return Ae.createElement("path",mF({},ti(t,!1),MI(t),{className:gi("recharts-curve",r),d:h,ref:l}))},Pne={exports:{}},WFe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",GFe=WFe,qFe=GFe;function Ine(){}function One(){}One.resetWarningCache=Ine;var HFe=function(){function e(n,a,l,h,i,_){if(_!==qFe){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:One,resetWarningCache:Ine};return r.PropTypes=r,r};Pne.exports=HFe();var ZFe=Pne.exports;const jn=yi(ZFe);var XFe=Object.getOwnPropertyNames,YFe=Object.getOwnPropertySymbols,KFe=Object.prototype.hasOwnProperty;function j9(e,t){return function(n,a,l){return e(n,a,l)&&t(n,a,l)}}function kC(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var l=a.cache,h=l.get(r),i=l.get(n);if(h&&i)return h===n&&i===r;l.set(r,n),l.set(n,r);var _=e(r,n,a);return l.delete(r),l.delete(n),_}}function F9(e){return XFe(e).concat(YFe(e))}var kne=Object.hasOwn||function(e,t){return KFe.call(e,t)};function hb(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Rne="_owner",B9=Object.getOwnPropertyDescriptor,$9=Object.keys;function JFe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function QFe(e,t){return hb(e.getTime(),t.getTime())}function U9(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.entries(),l=0,h,i;(h=a.next())&&!h.done;){for(var _=t.entries(),b=!1,E=0;(i=_.next())&&!i.done;){var C=h.value,I=C[0],F=C[1],$=i.value,B=$[0],q=$[1];!b&&!n[E]&&(b=r.equals(I,B,l,E,e,t,r)&&r.equals(F,q,I,B,e,t,r))&&(n[E]=!0),E++}if(!b)return!1;l++}return!0}function e4e(e,t,r){var n=$9(e),a=n.length;if($9(t).length!==a)return!1;for(var l;a-- >0;)if(l=n[a],l===Rne&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!kne(t,l)||!r.equals(e[l],t[l],l,l,e,t,r))return!1;return!0}function Rw(e,t,r){var n=F9(e),a=n.length;if(F9(t).length!==a)return!1;for(var l,h,i;a-- >0;)if(l=n[a],l===Rne&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!kne(t,l)||!r.equals(e[l],t[l],l,l,e,t,r)||(h=B9(e,l),i=B9(t,l),(h||i)&&(!h||!i||h.configurable!==i.configurable||h.enumerable!==i.enumerable||h.writable!==i.writable)))return!1;return!0}function t4e(e,t){return hb(e.valueOf(),t.valueOf())}function r4e(e,t){return e.source===t.source&&e.flags===t.flags}function V9(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.values(),l,h;(l=a.next())&&!l.done;){for(var i=t.values(),_=!1,b=0;(h=i.next())&&!h.done;)!_&&!n[b]&&(_=r.equals(l.value,h.value,l.value,h.value,e,t,r))&&(n[b]=!0),b++;if(!_)return!1}return!0}function n4e(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var i4e="[object Arguments]",o4e="[object Boolean]",a4e="[object Date]",s4e="[object Map]",l4e="[object Number]",c4e="[object Object]",u4e="[object RegExp]",d4e="[object Set]",h4e="[object String]",f4e=Array.isArray,W9=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,G9=Object.assign,p4e=Object.prototype.toString.call.bind(Object.prototype.toString);function m4e(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,a=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,h=e.areRegExpsEqual,i=e.areSetsEqual,_=e.areTypedArraysEqual;return function(E,C,I){if(E===C)return!0;if(E==null||C==null||typeof E!="object"||typeof C!="object")return E!==E&&C!==C;var F=E.constructor;if(F!==C.constructor)return!1;if(F===Object)return a(E,C,I);if(f4e(E))return t(E,C,I);if(W9!=null&&W9(E))return _(E,C,I);if(F===Date)return r(E,C,I);if(F===RegExp)return h(E,C,I);if(F===Map)return n(E,C,I);if(F===Set)return i(E,C,I);var $=p4e(E);return $===a4e?r(E,C,I):$===u4e?h(E,C,I):$===s4e?n(E,C,I):$===d4e?i(E,C,I):$===c4e?typeof E.then!="function"&&typeof C.then!="function"&&a(E,C,I):$===i4e?a(E,C,I):$===o4e||$===l4e||$===h4e?l(E,C,I):!1}}function g4e(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Rw:JFe,areDatesEqual:QFe,areMapsEqual:n?j9(U9,Rw):U9,areObjectsEqual:n?Rw:e4e,arePrimitiveWrappersEqual:t4e,areRegExpsEqual:r4e,areSetsEqual:n?j9(V9,Rw):V9,areTypedArraysEqual:n?Rw:n4e};if(r&&(a=G9({},a,r(a))),t){var l=kC(a.areArraysEqual),h=kC(a.areMapsEqual),i=kC(a.areObjectsEqual),_=kC(a.areSetsEqual);a=G9({},a,{areArraysEqual:l,areMapsEqual:h,areObjectsEqual:i,areSetsEqual:_})}return a}function y4e(e){return function(t,r,n,a,l,h,i){return e(t,r,i)}}function v4e(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,l=e.strict;if(n)return function(_,b){var E=n(),C=E.cache,I=C===void 0?t?new WeakMap:void 0:C,F=E.meta;return r(_,b,{cache:I,equals:a,meta:F,strict:l})};if(t)return function(_,b){return r(_,b,{cache:new WeakMap,equals:a,meta:void 0,strict:l})};var h={cache:void 0,equals:a,meta:void 0,strict:l};return function(_,b){return r(_,b,h)}}var _4e=Lm();Lm({strict:!0});Lm({circular:!0});Lm({circular:!0,strict:!0});Lm({createInternalComparator:function(){return hb}});Lm({strict:!0,createInternalComparator:function(){return hb}});Lm({circular:!0,createInternalComparator:function(){return hb}});Lm({circular:!0,createInternalComparator:function(){return hb},strict:!0});function Lm(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,l=e.strict,h=l===void 0?!1:l,i=g4e(e),_=m4e(i),b=n?n(_):y4e(_);return v4e({circular:r,comparator:_,createState:a,equals:b,strict:h})}function x4e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function q9(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(l){r<0&&(r=l),l-r>t?(e(l),r=-1):x4e(a)};requestAnimationFrame(n)}function gF(e){"@babel/helpers - typeof";return gF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gF(e)}function b4e(e){return E4e(e)||T4e(e)||S4e(e)||w4e()}function w4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S4e(e,t){if(e){if(typeof e=="string")return H9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H9(e,t)}}function H9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function E4e(e){if(Array.isArray(e))return e}function A4e(){var e={},t=function(){return null},r=!1,n=function a(l){if(!r){if(Array.isArray(l)){if(!l.length)return;var h=l,i=b4e(h),_=i[0],b=i.slice(1);if(typeof _=="number"){q9(a.bind(null,b),_);return}a(_),q9(a.bind(null,b));return}gF(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){r=!0},start:function(l){r=!1,n(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function VT(e){"@babel/helpers - typeof";return VT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VT(e)}function Z9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function X9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z9(Object(r),!0).forEach(function(n){Dne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dne(e,t,r){return t=C4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C4e(e){var t=M4e(e,"string");return VT(t)==="symbol"?t:String(t)}function M4e(e,t){if(VT(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(VT(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P4e=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(l){return a.includes(l)})})},I4e=function(t){return t},O4e=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},VS=function(t,r){return Object.keys(r).reduce(function(n,a){return X9(X9({},n),{},Dne({},a,t(a,r[a])))},{})},Y9=function(t,r,n){return t.map(function(a){return"".concat(O4e(a)," ").concat(r,"ms ").concat(n)}).join(",")};function k4e(e,t){return L4e(e)||D4e(e,t)||Lne(e,t)||R4e()}function R4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function L4e(e){if(Array.isArray(e))return e}function N4e(e){return F4e(e)||j4e(e)||Lne(e)||z4e()}function z4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lne(e,t){if(e){if(typeof e=="string")return yF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yF(e,t)}}function j4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function F4e(e){if(Array.isArray(e))return yF(e)}function yF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var aO=1e-4,Nne=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},zne=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},K9=function(t,r){return function(n){var a=Nne(t,r);return zne(a,n)}},B4e=function(t,r){return function(n){var a=Nne(t,r),l=[].concat(N4e(a.map(function(h,i){return h*i}).slice(1)),[0]);return zne(l,n)}},J9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],l=r[1],h=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,l=0,h=1,i=1;break;case"ease":a=.25,l=.1,h=.25,i=1;break;case"ease-in":a=.42,l=0,h=1,i=1;break;case"ease-out":a=.42,l=0,h=.58,i=1;break;case"ease-in-out":a=0,l=0,h=.58,i=1;break;default:{var _=r[0].split("(");if(_[0]==="cubic-bezier"&&_[1].split(")")[0].split(",").length===4){var b=_[1].split(")")[0].split(",").map(function(q){return parseFloat(q)}),E=k4e(b,4);a=E[0],l=E[1],h=E[2],i=E[3]}}}var C=K9(a,h),I=K9(l,i),F=B4e(a,h),$=function(G){return G>1?1:G<0?0:G},B=function(G){for(var H=G>1?1:G,J=H,Q=0;Q<8;++Q){var oe=C(J)-H,de=F(J);if(Math.abs(oe-H)<aO||de<aO)return I(J);J=$(J-oe/de)}return I(J)};return B.isStepper=!1,B},$4e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,l=a===void 0?8:a,h=t.dt,i=h===void 0?17:h,_=function(E,C,I){var F=-(E-C)*n,$=I*l,B=I+(F-$)*i/1e3,q=I*i/1e3+E;return Math.abs(q-C)<aO&&Math.abs(B)<aO?[C,0]:[q,B]};return _.isStepper=!0,_.dt=i,_},U4e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return J9(a);case"spring":return $4e();default:if(a.split("(")[0]==="cubic-bezier")return J9(a)}return typeof a=="function"?a:null};function WT(e){"@babel/helpers - typeof";return WT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WT(e)}function Q9(e){return G4e(e)||W4e(e)||jne(e)||V4e()}function V4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G4e(e){if(Array.isArray(e))return _F(e)}function eZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ga(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eZ(Object(r),!0).forEach(function(n){vF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vF(e,t,r){return t=q4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q4e(e){var t=H4e(e,"string");return WT(t)==="symbol"?t:String(t)}function H4e(e,t){if(WT(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(WT(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z4e(e,t){return K4e(e)||Y4e(e,t)||jne(e,t)||X4e()}function X4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jne(e,t){if(e){if(typeof e=="string")return _F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _F(e,t)}}function _F(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function K4e(e){if(Array.isArray(e))return e}var sO=function(t,r,n){return t+(r-t)*n},xF=function(t){var r=t.from,n=t.to;return r!==n},J4e=function e(t,r,n){var a=VS(function(l,h){if(xF(h)){var i=t(h.from,h.to,h.velocity),_=Z4e(i,2),b=_[0],E=_[1];return Ga(Ga({},h),{},{from:b,velocity:E})}return h},r);return n<1?VS(function(l,h){return xF(h)?Ga(Ga({},h),{},{velocity:sO(h.velocity,a[l].velocity,n),from:sO(h.from,a[l].from,n)}):h},r):e(t,a,n-1)};const Q4e=function(e,t,r,n,a){var l=P4e(e,t),h=l.reduce(function(q,G){return Ga(Ga({},q),{},vF({},G,[e[G],t[G]]))},{}),i=l.reduce(function(q,G){return Ga(Ga({},q),{},vF({},G,{from:e[G],velocity:0,to:t[G]}))},{}),_=-1,b,E,C=function(){return null},I=function(){return VS(function(G,H){return H.from},i)},F=function(){return!Object.values(i).filter(xF).length},$=function(G){b||(b=G);var H=G-b,J=H/r.dt;i=J4e(r,i,J),a(Ga(Ga(Ga({},e),t),I())),b=G,F()||(_=requestAnimationFrame(C))},B=function(G){E||(E=G);var H=(G-E)/n,J=VS(function(oe,de){return sO.apply(void 0,Q9(de).concat([r(H)]))},h);if(a(Ga(Ga(Ga({},e),t),J)),H<1)_=requestAnimationFrame(C);else{var Q=VS(function(oe,de){return sO.apply(void 0,Q9(de).concat([r(1)]))},h);a(Ga(Ga(Ga({},e),t),Q))}};return C=r.isStepper?$:B,function(){return requestAnimationFrame(C),function(){cancelAnimationFrame(_)}}};function px(e){"@babel/helpers - typeof";return px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},px(e)}var eBe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function tBe(e,t){if(e==null)return{};var r=rBe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rBe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function lN(e){return aBe(e)||oBe(e)||iBe(e)||nBe()}function nBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iBe(e,t){if(e){if(typeof e=="string")return bF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bF(e,t)}}function oBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aBe(e){if(Array.isArray(e))return bF(e)}function bF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tZ(Object(r),!0).forEach(function(n){Yw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yw(e,t,r){return t=Fne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lBe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fne(n.key),n)}}function cBe(e,t,r){return t&&lBe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fne(e){var t=uBe(e,"string");return px(t)==="symbol"?t:String(t)}function uBe(e,t){if(px(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(px(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wF(e,t)}function wF(e,t){return wF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},wF(e,t)}function hBe(e){var t=fBe();return function(){var n=lO(e),a;if(t){var l=lO(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return SF(this,a)}}function SF(e,t){if(t&&(px(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TF(e)}function TF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lO(e){return lO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lO(e)}var nf=function(e){dBe(r,e);var t=hBe(r);function r(n,a){var l;sBe(this,r),l=t.call(this,n,a);var h=l.props,i=h.isActive,_=h.attributeName,b=h.from,E=h.to,C=h.steps,I=h.children,F=h.duration;if(l.handleStyleChange=l.handleStyleChange.bind(TF(l)),l.changeStyle=l.changeStyle.bind(TF(l)),!i||F<=0)return l.state={style:{}},typeof I=="function"&&(l.state={style:E}),SF(l);if(C&&C.length)l.state={style:C[0].style};else if(b){if(typeof I=="function")return l.state={style:b},SF(l);l.state={style:_?Yw({},_,b):b}}else l.state={style:{}};return l}return cBe(r,[{key:"componentDidMount",value:function(){var a=this.props,l=a.isActive,h=a.canBegin;this.mounted=!0,!(!l||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var l=this.props,h=l.isActive,i=l.canBegin,_=l.attributeName,b=l.shouldReAnimate,E=l.to,C=l.from,I=this.state.style;if(i){if(!h){var F={style:_?Yw({},_,E):E};this.state&&I&&(_&&I[_]!==E||!_&&I!==E)&&this.setState(F);return}if(!(_4e(a.to,E)&&a.canBegin&&a.isActive)){var $=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var B=$||b?C:a.to;if(this.state&&I){var q={style:_?Yw({},_,B):B};(_&&I[_]!==B||!_&&I!==B)&&this.setState(q)}this.runAnimation(hu(hu({},this.props),{},{from:B,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var l=this,h=a.from,i=a.to,_=a.duration,b=a.easing,E=a.begin,C=a.onAnimationEnd,I=a.onAnimationStart,F=Q4e(h,i,U4e(b),_,this.changeStyle),$=function(){l.stopJSAnimation=F()};this.manager.start([I,E,$,_,C])}},{key:"runStepAnimation",value:function(a){var l=this,h=a.steps,i=a.begin,_=a.onAnimationStart,b=h[0],E=b.style,C=b.duration,I=C===void 0?0:C,F=function(B,q,G){if(G===0)return B;var H=q.duration,J=q.easing,Q=J===void 0?"ease":J,oe=q.style,de=q.properties,ae=q.onAnimationEnd,ve=G>0?h[G-1]:q,Fe=de||Object.keys(oe);if(typeof Q=="function"||Q==="spring")return[].concat(lN(B),[l.runJSAnimation.bind(l,{from:ve.style,to:oe,duration:H,easing:Q}),H]);var ke=Y9(Fe,H,Q),Ce=hu(hu(hu({},ve.style),oe),{},{transition:ke});return[].concat(lN(B),[Ce,H,ae]).filter(I4e)};return this.manager.start([_].concat(lN(h.reduce(F,[E,Math.max(I,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=A4e());var l=a.begin,h=a.duration,i=a.attributeName,_=a.to,b=a.easing,E=a.onAnimationStart,C=a.onAnimationEnd,I=a.steps,F=a.children,$=this.manager;if(this.unSubscribe=$.subscribe(this.handleStyleChange),typeof b=="function"||typeof F=="function"||b==="spring"){this.runJSAnimation(a);return}if(I.length>1){this.runStepAnimation(a);return}var B=i?Yw({},i,_):_,q=Y9(Object.keys(B),h,b);$.start([E,l,hu(hu({},B),{},{transition:q}),h,C])}},{key:"render",value:function(){var a=this.props,l=a.children;a.begin;var h=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var _=tBe(a,eBe),b=ne.Children.count(l),E=this.state.style;if(typeof l=="function")return l(E);if(!i||b===0||h<=0)return l;var C=function(F){var $=F.props,B=$.style,q=B===void 0?{}:B,G=$.className,H=ne.cloneElement(F,hu(hu({},_),{},{style:hu(hu({},q),E),className:G}));return H};return b===1?C(ne.Children.only(l)):Ae.createElement("div",null,ne.Children.map(l,function(I){return C(I)}))}}]),r}(ne.PureComponent);nf.displayName="Animate";nf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};nf.propTypes={from:jn.oneOfType([jn.object,jn.string]),to:jn.oneOfType([jn.object,jn.string]),attributeName:jn.string,duration:jn.number,begin:jn.number,easing:jn.oneOfType([jn.string,jn.func]),steps:jn.arrayOf(jn.shape({duration:jn.number.isRequired,style:jn.object.isRequired,easing:jn.oneOfType([jn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),jn.func]),properties:jn.arrayOf("string"),onAnimationEnd:jn.func})),children:jn.oneOfType([jn.node,jn.func]),isActive:jn.bool,canBegin:jn.bool,onAnimationEnd:jn.func,shouldReAnimate:jn.bool,onAnimationStart:jn.func,onAnimationReStart:jn.func};jn.object,jn.object,jn.object,jn.element;jn.object,jn.object,jn.object,jn.oneOfType([jn.array,jn.element]),jn.any;function GT(e){"@babel/helpers - typeof";return GT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GT(e)}function cO(){return cO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cO.apply(this,arguments)}function pBe(e,t){return vBe(e)||yBe(e,t)||gBe(e,t)||mBe()}function mBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gBe(e,t){if(e){if(typeof e=="string")return rZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rZ(e,t)}}function rZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function vBe(e){if(Array.isArray(e))return e}function nZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(r),!0).forEach(function(n){_Be(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Be(e,t,r){return t=xBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xBe(e){var t=bBe(e,"string");return GT(t)=="symbol"?t:t+""}function bBe(e,t){if(GT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(GT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oZ=function(t,r,n,a,l){var h=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,_=n>=0?1:-1,b=a>=0&&n>=0||a<0&&n<0?1:0,E;if(h>0&&l instanceof Array){for(var C=[0,0,0,0],I=0,F=4;I<F;I++)C[I]=l[I]>h?h:l[I];E="M".concat(t,",").concat(r+i*C[0]),C[0]>0&&(E+="A ".concat(C[0],",").concat(C[0],",0,0,").concat(b,",").concat(t+_*C[0],",").concat(r)),E+="L ".concat(t+n-_*C[1],",").concat(r),C[1]>0&&(E+="A ".concat(C[1],",").concat(C[1],",0,0,").concat(b,`,
        `).concat(t+n,",").concat(r+i*C[1])),E+="L ".concat(t+n,",").concat(r+a-i*C[2]),C[2]>0&&(E+="A ".concat(C[2],",").concat(C[2],",0,0,").concat(b,`,
        `).concat(t+n-_*C[2],",").concat(r+a)),E+="L ".concat(t+_*C[3],",").concat(r+a),C[3]>0&&(E+="A ".concat(C[3],",").concat(C[3],",0,0,").concat(b,`,
        `).concat(t,",").concat(r+a-i*C[3])),E+="Z"}else if(h>0&&l===+l&&l>0){var $=Math.min(h,l);E="M ".concat(t,",").concat(r+i*$,`
            A `).concat($,",").concat($,",0,0,").concat(b,",").concat(t+_*$,",").concat(r,`
            L `).concat(t+n-_*$,",").concat(r,`
            A `).concat($,",").concat($,",0,0,").concat(b,",").concat(t+n,",").concat(r+i*$,`
            L `).concat(t+n,",").concat(r+a-i*$,`
            A `).concat($,",").concat($,",0,0,").concat(b,",").concat(t+n-_*$,",").concat(r+a,`
            L `).concat(t+_*$,",").concat(r+a,`
            A `).concat($,",").concat($,",0,0,").concat(b,",").concat(t,",").concat(r+a-i*$," Z")}else E="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return E},wBe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,l=r.x,h=r.y,i=r.width,_=r.height;if(Math.abs(i)>0&&Math.abs(_)>0){var b=Math.min(l,l+i),E=Math.max(l,l+i),C=Math.min(h,h+_),I=Math.max(h,h+_);return n>=b&&n<=E&&a>=C&&a<=I}return!1},SBe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},M$=function(t){var r=iZ(iZ({},SBe),t),n=ne.useRef(),a=ne.useState(-1),l=pBe(a,2),h=l[0],i=l[1];ne.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var Q=n.current.getTotalLength();Q&&i(Q)}catch{}},[]);var _=r.x,b=r.y,E=r.width,C=r.height,I=r.radius,F=r.className,$=r.animationEasing,B=r.animationDuration,q=r.animationBegin,G=r.isAnimationActive,H=r.isUpdateAnimationActive;if(_!==+_||b!==+b||E!==+E||C!==+C||E===0||C===0)return null;var J=gi("recharts-rectangle",F);return H?Ae.createElement(nf,{canBegin:h>0,from:{width:E,height:C,x:_,y:b},to:{width:E,height:C,x:_,y:b},duration:B,animationEasing:$,isActive:H},function(Q){var oe=Q.width,de=Q.height,ae=Q.x,ve=Q.y;return Ae.createElement(nf,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:q,duration:B,isActive:G,easing:$},Ae.createElement("path",cO({},ti(r,!0),{className:J,d:oZ(ae,ve,oe,de,I),ref:n})))}):Ae.createElement("path",cO({},ti(r,!0),{className:J,d:oZ(_,b,E,C,I)}))};function EF(){return EF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EF.apply(this,arguments)}var P$=function(t){var r=t.cx,n=t.cy,a=t.r,l=t.className,h=gi("recharts-dot",l);return r===+r&&n===+n&&a===+a?Ae.createElement("circle",EF({},ti(t,!1),MI(t),{className:h,cx:r,cy:n,r:a})):null};function qT(e){"@babel/helpers - typeof";return qT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qT(e)}var TBe=["x","y","top","left","width","height","className"];function AF(){return AF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AF.apply(this,arguments)}function aZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EBe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aZ(Object(r),!0).forEach(function(n){ABe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ABe(e,t,r){return t=CBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CBe(e){var t=MBe(e,"string");return qT(t)=="symbol"?t:t+""}function MBe(e,t){if(qT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PBe(e,t){if(e==null)return{};var r=IBe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var OBe=function(t,r,n,a,l,h){return"M".concat(t,",").concat(l,"v").concat(a,"M").concat(h,",").concat(r,"h").concat(n)},kBe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,h=t.top,i=h===void 0?0:h,_=t.left,b=_===void 0?0:_,E=t.width,C=E===void 0?0:E,I=t.height,F=I===void 0?0:I,$=t.className,B=PBe(t,TBe),q=EBe({x:n,y:l,top:i,left:b,width:C,height:F},B);return!Sr(n)||!Sr(l)||!Sr(C)||!Sr(F)||!Sr(i)||!Sr(b)?null:Ae.createElement("path",AF({},ti(q,!0),{className:gi("recharts-cross",$),d:OBe(n,l,C,F,i,b)}))},RBe=Jte,DBe=RBe(Object.getPrototypeOf,Object),LBe=DBe,NBe=uf,zBe=LBe,jBe=df,FBe="[object Object]",BBe=Function.prototype,$Be=Object.prototype,Bne=BBe.toString,UBe=$Be.hasOwnProperty,VBe=Bne.call(Object);function WBe(e){if(!jBe(e)||NBe(e)!=FBe)return!1;var t=zBe(e);if(t===null)return!0;var r=UBe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Bne.call(r)==VBe}var GBe=WBe;const qBe=yi(GBe);var HBe=uf,ZBe=df,XBe="[object Boolean]";function YBe(e){return e===!0||e===!1||ZBe(e)&&HBe(e)==XBe}var KBe=YBe;const JBe=yi(KBe);function HT(e){"@babel/helpers - typeof";return HT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HT(e)}function uO(){return uO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uO.apply(this,arguments)}function QBe(e,t){return n5e(e)||r5e(e,t)||t5e(e,t)||e5e()}function e5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t5e(e,t){if(e){if(typeof e=="string")return sZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sZ(e,t)}}function sZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function n5e(e){if(Array.isArray(e))return e}function lZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lZ(Object(r),!0).forEach(function(n){i5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i5e(e,t,r){return t=o5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o5e(e){var t=a5e(e,"string");return HT(t)=="symbol"?t:t+""}function a5e(e,t){if(HT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(HT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uZ=function(t,r,n,a,l){var h=n-a,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-h/2,",").concat(r+l),i+="L ".concat(t+n-h/2-a,",").concat(r+l),i+="L ".concat(t,",").concat(r," Z"),i},s5e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},l5e=function(t){var r=cZ(cZ({},s5e),t),n=ne.useRef(),a=ne.useState(-1),l=QBe(a,2),h=l[0],i=l[1];ne.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var J=n.current.getTotalLength();J&&i(J)}catch{}},[]);var _=r.x,b=r.y,E=r.upperWidth,C=r.lowerWidth,I=r.height,F=r.className,$=r.animationEasing,B=r.animationDuration,q=r.animationBegin,G=r.isUpdateAnimationActive;if(_!==+_||b!==+b||E!==+E||C!==+C||I!==+I||E===0&&C===0||I===0)return null;var H=gi("recharts-trapezoid",F);return G?Ae.createElement(nf,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:I,x:_,y:b},to:{upperWidth:E,lowerWidth:C,height:I,x:_,y:b},duration:B,animationEasing:$,isActive:G},function(J){var Q=J.upperWidth,oe=J.lowerWidth,de=J.height,ae=J.x,ve=J.y;return Ae.createElement(nf,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:q,duration:B,easing:$},Ae.createElement("path",uO({},ti(r,!0),{className:H,d:uZ(ae,ve,Q,oe,de),ref:n})))}):Ae.createElement("g",null,Ae.createElement("path",uO({},ti(r,!0),{className:H,d:uZ(_,b,E,C,I)})))},c5e=["option","shapeType","propTransformer","activeClassName","isActive"];function ZT(e){"@babel/helpers - typeof";return ZT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZT(e)}function u5e(e,t){if(e==null)return{};var r=d5e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function dZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dZ(Object(r),!0).forEach(function(n){h5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h5e(e,t,r){return t=f5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f5e(e){var t=p5e(e,"string");return ZT(t)=="symbol"?t:t+""}function p5e(e,t){if(ZT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ZT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m5e(e,t){return dO(dO({},t),e)}function g5e(e,t){return e==="symbols"}function hZ(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Ae.createElement(M$,r);case"trapezoid":return Ae.createElement(l5e,r);case"sector":return Ae.createElement(Mne,r);case"symbols":if(g5e(t))return Ae.createElement(H5,r);break;default:return null}}function y5e(e){return ne.isValidElement(e)?e.props:e}function v5e(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?m5e:n,l=e.activeClassName,h=l===void 0?"recharts-active-shape":l,i=e.isActive,_=u5e(e,c5e),b;if(ne.isValidElement(t))b=ne.cloneElement(t,dO(dO({},_),y5e(t)));else if(Xn(t))b=t(_);else if(qBe(t)&&!JBe(t)){var E=a(t,_);b=Ae.createElement(hZ,{shapeType:r,elementProps:E})}else{var C=_;b=Ae.createElement(hZ,{shapeType:r,elementProps:C})}return i?Ae.createElement(Io,{className:h},b):b}function pR(e,t){return t!=null&&"trapezoids"in e.props}function mR(e,t){return t!=null&&"sectors"in e.props}function XT(e,t){return t!=null&&"points"in e.props}function _5e(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,l=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&l}function x5e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function b5e(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function w5e(e,t){var r;return pR(e,t)?r=_5e:mR(e,t)?r=x5e:XT(e,t)&&(r=b5e),r}function S5e(e,t){var r;return pR(e,t)?r="trapezoids":mR(e,t)?r="sectors":XT(e,t)&&(r="points"),r}function T5e(e,t){if(pR(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(mR(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return XT(e,t)?t.payload:{}}function E5e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=S5e(r,t),l=T5e(r,t),h=n.filter(function(_,b){var E=kT(l,_),C=r.props[a].filter(function($){var B=w5e(r,t);return B($,t)}),I=r.props[a].indexOf(C[C.length-1]),F=b===I;return E&&F}),i=n.indexOf(h[h.length-1]);return i}var A5e=Math.ceil,C5e=Math.max;function M5e(e,t,r,n){for(var a=-1,l=C5e(A5e((t-e)/(r||1)),0),h=Array(l);l--;)h[n?l:++a]=e,e+=r;return h}var P5e=M5e,I5e=yre,fZ=1/0,O5e=17976931348623157e292;function k5e(e){if(!e)return e===0?e:0;if(e=I5e(e),e===fZ||e===-fZ){var t=e<0?-1:1;return t*O5e}return e===e?e:0}var $ne=k5e,R5e=P5e,D5e=nR,cN=$ne;function L5e(e){return function(t,r,n){return n&&typeof n!="number"&&D5e(t,r,n)&&(r=n=void 0),t=cN(t),r===void 0?(r=t,t=0):r=cN(r),n=n===void 0?t<r?1:-1:cN(n),R5e(t,r,n,e)}}var N5e=L5e,z5e=N5e,j5e=z5e(),F5e=j5e;const hO=yi(F5e);function YT(e){"@babel/helpers - typeof";return YT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YT(e)}function pZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pZ(Object(r),!0).forEach(function(n){Une(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Une(e,t,r){return t=B5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B5e(e){var t=$5e(e,"string");return YT(t)=="symbol"?t:t+""}function $5e(e,t){if(YT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(YT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U5e=["Webkit","Moz","O","ms"],V5e=function(t,r){var n=t.replace(/(\w)/,function(l){return l.toUpperCase()}),a=U5e.reduce(function(l,h){return mZ(mZ({},l),{},Une({},h+n,r))},{});return a[t]=r,a};function mx(e){"@babel/helpers - typeof";return mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mx(e)}function fO(){return fO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fO.apply(this,arguments)}function gZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gZ(Object(r),!0).forEach(function(n){Bl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wne(n.key),n)}}function G5e(e,t,r){return t&&yZ(e.prototype,t),r&&yZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q5e(e,t,r){return t=pO(t),H5e(e,Vne()?Reflect.construct(t,r||[],pO(e).constructor):t.apply(e,r))}function H5e(e,t){if(t&&(mx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z5e(e)}function Z5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vne=function(){return!!e})()}function pO(e){return pO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pO(e)}function X5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CF(e,t)}function CF(e,t){return CF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},CF(e,t)}function Bl(e,t,r){return t=Wne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wne(e){var t=Y5e(e,"string");return mx(t)=="symbol"?t:t+""}function Y5e(e,t){if(mx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K5e=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,l=t.x,h=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var _=r.length,b=BS().domain(hO(0,_)).range([l,l+h-i]),E=b.domain().map(function(C){return b(C)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:b(n),endX:b(a),scale:b,scaleValues:E}},vZ=function(t){return t.changedTouches&&!!t.changedTouches.length},gx=function(e){function t(r){var n;return W5e(this,t),n=q5e(this,t,[r]),Bl(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Bl(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Bl(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,l=a.endIndex,h=a.onDragEnd,i=a.startIndex;h==null||h({endIndex:l,startIndex:i})}),n.detachDragEndListener()}),Bl(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Bl(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Bl(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Bl(n,"handleSlideDragStart",function(a){var l=vZ(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return X5e(t,e),G5e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,l=n.endX,h=this.state.scaleValues,i=this.props,_=i.gap,b=i.data,E=b.length-1,C=Math.min(a,l),I=Math.max(a,l),F=t.getIndexInRange(h,C),$=t.getIndexInRange(h,I);return{startIndex:F-F%_,endIndex:$===E?E:$-$%_}}},{key:"getTextOfTick",value:function(n){var a=this.props,l=a.data,h=a.tickFormatter,i=a.dataKey,_=nc(l[n],i,n);return Xn(h)?h(_,n):_}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,l=a.slideMoveStartX,h=a.startX,i=a.endX,_=this.props,b=_.x,E=_.width,C=_.travellerWidth,I=_.startIndex,F=_.endIndex,$=_.onChange,B=n.pageX-l;B>0?B=Math.min(B,b+E-C-i,b+E-C-h):B<0&&(B=Math.max(B,b-h,b-i));var q=this.getIndex({startX:h+B,endX:i+B});(q.startIndex!==I||q.endIndex!==F)&&$&&$(q),this.setState({startX:h+B,endX:i+B,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var l=vZ(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,l=a.brushMoveStartX,h=a.movingTravellerId,i=a.endX,_=a.startX,b=this.state[h],E=this.props,C=E.x,I=E.width,F=E.travellerWidth,$=E.onChange,B=E.gap,q=E.data,G={startX:this.state.startX,endX:this.state.endX},H=n.pageX-l;H>0?H=Math.min(H,C+I-F-b):H<0&&(H=Math.max(H,C-b)),G[h]=b+H;var J=this.getIndex(G),Q=J.startIndex,oe=J.endIndex,de=function(){var ve=q.length-1;return h==="startX"&&(i>_?Q%B===0:oe%B===0)||i<_&&oe===ve||h==="endX"&&(i>_?oe%B===0:Q%B===0)||i>_&&oe===ve};this.setState(Bl(Bl({},h,b+H),"brushMoveStartX",n.pageX),function(){$&&de()&&$(J)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var l=this,h=this.state,i=h.scaleValues,_=h.startX,b=h.endX,E=this.state[a],C=i.indexOf(E);if(C!==-1){var I=C+n;if(!(I===-1||I>=i.length)){var F=i[I];a==="startX"&&F>=b||a==="endX"&&F<=_||this.setState(Bl({},a,F),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,l=n.y,h=n.width,i=n.height,_=n.fill,b=n.stroke;return Ae.createElement("rect",{stroke:b,fill:_,x:a,y:l,width:h,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,l=n.y,h=n.width,i=n.height,_=n.data,b=n.children,E=n.padding,C=ne.Children.only(b);return C?Ae.cloneElement(C,{x:a,y:l,width:h,height:i,margin:E,compact:!0,data:_}):null}},{key:"renderTravellerLayer",value:function(n,a){var l,h,i=this,_=this.props,b=_.y,E=_.travellerWidth,C=_.height,I=_.traveller,F=_.ariaLabel,$=_.data,B=_.startIndex,q=_.endIndex,G=Math.max(n,this.props.x),H=uN(uN({},ti(this.props,!1)),{},{x:G,y:b,width:E,height:C}),J=F||"Min value: ".concat((l=$[B])===null||l===void 0?void 0:l.name,", Max value: ").concat((h=$[q])===null||h===void 0?void 0:h.name);return Ae.createElement(Io,{tabIndex:0,role:"slider","aria-label":J,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(oe){["ArrowLeft","ArrowRight"].includes(oe.key)&&(oe.preventDefault(),oe.stopPropagation(),i.handleTravellerMoveKeyboard(oe.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(I,H))}},{key:"renderSlide",value:function(n,a){var l=this.props,h=l.y,i=l.height,_=l.stroke,b=l.travellerWidth,E=Math.min(n,a)+b,C=Math.max(Math.abs(a-n)-b,0);return Ae.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:_,fillOpacity:.2,x:E,y:h,width:C,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,l=n.endIndex,h=n.y,i=n.height,_=n.travellerWidth,b=n.stroke,E=this.state,C=E.startX,I=E.endX,F=5,$={pointerEvents:"none",fill:b};return Ae.createElement(Io,{className:"recharts-brush-texts"},Ae.createElement(VI,fO({textAnchor:"end",verticalAnchor:"middle",x:Math.min(C,I)-F,y:h+i/2},$),this.getTextOfTick(a)),Ae.createElement(VI,fO({textAnchor:"start",verticalAnchor:"middle",x:Math.max(C,I)+_+F,y:h+i/2},$),this.getTextOfTick(l)))}},{key:"render",value:function(){var n=this.props,a=n.data,l=n.className,h=n.children,i=n.x,_=n.y,b=n.width,E=n.height,C=n.alwaysShowText,I=this.state,F=I.startX,$=I.endX,B=I.isTextActive,q=I.isSlideMoving,G=I.isTravellerMoving,H=I.isTravellerFocused;if(!a||!a.length||!Sr(i)||!Sr(_)||!Sr(b)||!Sr(E)||b<=0||E<=0)return null;var J=gi("recharts-brush",l),Q=Ae.Children.count(h)===1,oe=V5e("userSelect","none");return Ae.createElement(Io,{className:J,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:oe},this.renderBackground(),Q&&this.renderPanorama(),this.renderSlide(F,$),this.renderTravellerLayer(F,"startX"),this.renderTravellerLayer($,"endX"),(B||q||G||H||C)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,l=n.y,h=n.width,i=n.height,_=n.stroke,b=Math.floor(l+i/2)-1;return Ae.createElement(Ae.Fragment,null,Ae.createElement("rect",{x:a,y:l,width:h,height:i,fill:_,stroke:"none"}),Ae.createElement("line",{x1:a+1,y1:b,x2:a+h-1,y2:b,fill:"none",stroke:"#fff"}),Ae.createElement("line",{x1:a+1,y1:b+2,x2:a+h-1,y2:b+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var l;return Ae.isValidElement(n)?l=Ae.cloneElement(n,a):Xn(n)?l=n(a):l=t.renderDefaultTraveller(a),l}},{key:"getDerivedStateFromProps",value:function(n,a){var l=n.data,h=n.width,i=n.x,_=n.travellerWidth,b=n.updateId,E=n.startIndex,C=n.endIndex;if(l!==a.prevData||b!==a.prevUpdateId)return uN({prevData:l,prevTravellerWidth:_,prevUpdateId:b,prevX:i,prevWidth:h},l&&l.length?K5e({data:l,width:h,x:i,travellerWidth:_,startIndex:E,endIndex:C}):{scale:null,scaleValues:null});if(a.scale&&(h!==a.prevWidth||i!==a.prevX||_!==a.prevTravellerWidth)){a.scale.range([i,i+h-_]);var I=a.scale.domain().map(function(F){return a.scale(F)});return{prevData:l,prevTravellerWidth:_,prevUpdateId:b,prevX:i,prevWidth:h,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:I}}return null}},{key:"getIndexInRange",value:function(n,a){for(var l=n.length,h=0,i=l-1;i-h>1;){var _=Math.floor((h+i)/2);n[_]>a?i=_:h=_}return a>=n[i]?i:h}}])}(ne.PureComponent);Bl(gx,"displayName","Brush");Bl(gx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var J5e=e$;function Q5e(e,t){var r;return J5e(e,function(n,a,l){return r=t(n,a,l),!r}),!!r}var e$e=Q5e,t$e=Wte,r$e=km,n$e=e$e,i$e=Ml,o$e=nR;function a$e(e,t,r){var n=i$e(e)?t$e:n$e;return r&&o$e(e,t,r)&&(t=void 0),n(e,r$e(t))}var s$e=a$e;const l$e=yi(s$e);var jd=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},_Z=hre;function c$e(e,t,r){t=="__proto__"&&_Z?_Z(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var u$e=c$e,d$e=u$e,h$e=ure,f$e=km;function p$e(e,t){var r={};return t=f$e(t),h$e(e,function(n,a,l){d$e(r,a,t(n,a,l))}),r}var m$e=p$e;const g$e=yi(m$e);function y$e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var v$e=y$e,_$e=e$;function x$e(e,t){var r=!0;return _$e(e,function(n,a,l){return r=!!t(n,a,l),r}),r}var b$e=x$e,w$e=v$e,S$e=b$e,T$e=km,E$e=Ml,A$e=nR;function C$e(e,t,r){var n=E$e(e)?w$e:S$e;return r&&A$e(e,t,r)&&(t=void 0),n(e,T$e(t))}var M$e=C$e;const Gne=yi(M$e);var P$e=["x","y"];function KT(e){"@babel/helpers - typeof";return KT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KT(e)}function MF(){return MF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MF.apply(this,arguments)}function xZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xZ(Object(r),!0).forEach(function(n){I$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I$e(e,t,r){return t=O$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O$e(e){var t=k$e(e,"string");return KT(t)=="symbol"?t:t+""}function k$e(e,t){if(KT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(KT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R$e(e,t){if(e==null)return{};var r=D$e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function L$e(e,t){var r=e.x,n=e.y,a=R$e(e,P$e),l="".concat(r),h=parseInt(l,10),i="".concat(n),_=parseInt(i,10),b="".concat(t.height||a.height),E=parseInt(b,10),C="".concat(t.width||a.width),I=parseInt(C,10);return Dw(Dw(Dw(Dw(Dw({},t),a),h?{x:h}:{}),_?{y:_}:{}),{},{height:E,width:I,name:t.name,radius:t.radius})}function bZ(e){return Ae.createElement(v5e,MF({shapeType:"rectangle",propTransformer:L$e,activeClassName:"recharts-active-bar"},e))}var N$e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var l=typeof n=="number";return l?t(n,a):(l||Ny(),r)}},z$e=["value","background"],qne;function yx(e){"@babel/helpers - typeof";return yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yx(e)}function j$e(e,t){if(e==null)return{};var r=F$e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mO(){return mO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mO.apply(this,arguments)}function wZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wZ(Object(r),!0).forEach(function(n){Jp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zne(n.key),n)}}function $$e(e,t,r){return t&&SZ(e.prototype,t),r&&SZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U$e(e,t,r){return t=gO(t),V$e(e,Hne()?Reflect.construct(t,r||[],gO(e).constructor):t.apply(e,r))}function V$e(e,t){if(t&&(yx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W$e(e)}function W$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hne=function(){return!!e})()}function gO(e){return gO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gO(e)}function G$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PF(e,t)}function PF(e,t){return PF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},PF(e,t)}function Jp(e,t,r){return t=Zne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zne(e){var t=q$e(e,"string");return yx(t)=="symbol"?t:t+""}function q$e(e,t){if(yx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bm=function(e){function t(){var r;B$e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=U$e(this,t,[].concat(a)),Jp(r,"state",{isAnimationFinished:!1}),Jp(r,"id",LE("recharts-bar-")),Jp(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),h&&h()}),Jp(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),h&&h()}),r}return G$e(t,e),$$e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,l=this.props,h=l.shape,i=l.dataKey,_=l.activeIndex,b=l.activeBar,E=ti(this.props,!1);return n&&n.map(function(C,I){var F=I===_,$=F?b:h,B=oa(oa(oa({},E),C),{},{isActive:F,option:$,index:I,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Ae.createElement(Io,mO({className:"recharts-bar-rectangle"},PI(a.props,C,I),{key:"rectangle-".concat(C==null?void 0:C.x,"-").concat(C==null?void 0:C.y,"-").concat(C==null?void 0:C.value)}),Ae.createElement(bZ,B))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,l=a.data,h=a.layout,i=a.isAnimationActive,_=a.animationBegin,b=a.animationDuration,E=a.animationEasing,C=a.animationId,I=this.state.prevData;return Ae.createElement(nf,{begin:_,duration:b,isActive:i,easing:E,from:{t:0},to:{t:1},key:"bar-".concat(C),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(F){var $=F.t,B=l.map(function(q,G){var H=I&&I[G];if(H){var J=Cc(H.x,q.x),Q=Cc(H.y,q.y),oe=Cc(H.width,q.width),de=Cc(H.height,q.height);return oa(oa({},q),{},{x:J($),y:Q($),width:oe($),height:de($)})}if(h==="horizontal"){var ae=Cc(0,q.height),ve=ae($);return oa(oa({},q),{},{y:q.y+q.height-ve,height:ve})}var Fe=Cc(0,q.width),ke=Fe($);return oa(oa({},q),{},{width:ke})});return Ae.createElement(Io,null,n.renderRectanglesStatically(B))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,l=n.isAnimationActive,h=this.state.prevData;return l&&a&&a.length&&(!h||!kT(h,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,l=a.data,h=a.dataKey,i=a.activeIndex,_=ti(this.props.background,!1);return l.map(function(b,E){b.value;var C=b.background,I=j$e(b,z$e);if(!C)return null;var F=oa(oa(oa(oa(oa({},I),{},{fill:"#eee"},C),_),PI(n.props,b,E)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:h,index:E,className:"recharts-bar-background-rectangle"});return Ae.createElement(bZ,mO({key:"background-bar-".concat(E),option:n.props.background,isActive:E===i},F))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,h=l.data,i=l.xAxis,_=l.yAxis,b=l.layout,E=l.children,C=ku(E,fR);if(!C)return null;var I=b==="vertical"?h[0].height/2:h[0].width/2,F=function(q,G){var H=Array.isArray(q.value)?q.value[1]:q.value;return{x:q.x,y:q.y,value:H,errorVal:nc(q,G)}},$={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Ae.createElement(Io,$,C.map(function(B){return Ae.cloneElement(B,{key:"error-bar-".concat(a,"-").concat(B.props.dataKey),data:h,xAxis:i,yAxis:_,layout:b,offset:I,dataPointFormatter:F})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.data,h=n.className,i=n.xAxis,_=n.yAxis,b=n.left,E=n.top,C=n.width,I=n.height,F=n.isAnimationActive,$=n.background,B=n.id;if(a||!l||!l.length)return null;var q=this.state.isAnimationFinished,G=gi("recharts-bar",h),H=i&&i.allowDataOverflow,J=_&&_.allowDataOverflow,Q=H||J,oe=ui(B)?this.id:B;return Ae.createElement(Io,{className:G},H||J?Ae.createElement("defs",null,Ae.createElement("clipPath",{id:"clipPath-".concat(oe)},Ae.createElement("rect",{x:H?b:b-C/2,y:J?E:E-I/2,width:H?C:C*2,height:J?I:I*2}))):null,Ae.createElement(Io,{className:"recharts-bar-rectangles",clipPath:Q?"url(#clipPath-".concat(oe,")"):null},$?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(Q,oe),(!F||q)&&um.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(ne.PureComponent);qne=bm;Jp(bm,"displayName","Bar");Jp(bm,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!$h.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Jp(bm,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,l=e.xAxis,h=e.yAxis,i=e.xAxisTicks,_=e.yAxisTicks,b=e.stackedData,E=e.dataStartIndex,C=e.displayedData,I=e.offset,F=kje(n,r);if(!F)return null;var $=t.layout,B=r.type.defaultProps,q=B!==void 0?oa(oa({},B),r.props):r.props,G=q.dataKey,H=q.children,J=q.minPointSize,Q=$==="horizontal"?h:l,oe=b?Q.scale.domain():null,de=Bje({numericAxis:Q}),ae=ku(H,_re),ve=C.map(function(Fe,ke){var Ce,je,tt,Ze,Qe,st;b?Ce=Rje(b[E+ke],oe):(Ce=nc(Fe,G),Array.isArray(Ce)||(Ce=[de,Ce]));var ot=N$e(J,qne.defaultProps.minPointSize)(Ce[1],ke);if($==="horizontal"){var Be,lt=[h.scale(Ce[0]),h.scale(Ce[1])],zt=lt[0],Lt=lt[1];je=w9({axis:l,ticks:i,bandSize:a,offset:F.offset,entry:Fe,index:ke}),tt=(Be=Lt??zt)!==null&&Be!==void 0?Be:void 0,Ze=F.size;var Bt=zt-Lt;if(Qe=Number.isNaN(Bt)?0:Bt,st={x:je,y:h.y,width:Ze,height:h.height},Math.abs(ot)>0&&Math.abs(Qe)<Math.abs(ot)){var ct=Cu(Qe||ot)*(Math.abs(ot)-Math.abs(Qe));tt-=ct,Qe+=ct}}else{var nr=[l.scale(Ce[0]),l.scale(Ce[1])],mr=nr[0],ir=nr[1];if(je=mr,tt=w9({axis:h,ticks:_,bandSize:a,offset:F.offset,entry:Fe,index:ke}),Ze=ir-mr,Qe=F.size,st={x:l.x,y:tt,width:l.width,height:Qe},Math.abs(ot)>0&&Math.abs(Ze)<Math.abs(ot)){var Ut=Cu(Ze||ot)*(Math.abs(ot)-Math.abs(Ze));Ze+=Ut}}return oa(oa(oa({},Fe),{},{x:je,y:tt,width:Ze,height:Qe,value:b?Ce:Ce[1],payload:Fe,background:st},ae&&ae[ke]&&ae[ke].props),{},{tooltipPayload:[Ene(r,Fe)],tooltipPosition:{x:je+Ze/2,y:tt+Qe/2}})});return oa({data:ve,layout:$},I)});function JT(e){"@babel/helpers - typeof";return JT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JT(e)}function H$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xne(n.key),n)}}function Z$e(e,t,r){return t&&TZ(e.prototype,t),r&&TZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EZ(Object(r),!0).forEach(function(n){gR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gR(e,t,r){return t=Xne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xne(e){var t=X$e(e,"string");return JT(t)=="symbol"?t:t+""}function X$e(e,t){if(JT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(JT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yne=function(t,r,n,a,l){var h=t.width,i=t.height,_=t.layout,b=t.children,E=Object.keys(r),C={left:n.left,leftMirror:n.left,right:h-n.right,rightMirror:h-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},I=!!Wl(b,bm);return E.reduce(function(F,$){var B=r[$],q=B.orientation,G=B.domain,H=B.padding,J=H===void 0?{}:H,Q=B.mirror,oe=B.reversed,de="".concat(q).concat(Q?"Mirror":""),ae,ve,Fe,ke,Ce;if(B.type==="number"&&(B.padding==="gap"||B.padding==="no-gap")){var je=G[1]-G[0],tt=1/0,Ze=B.categoricalDomain.sort();if(Ze.forEach(function(nr,mr){mr>0&&(tt=Math.min((nr||0)-(Ze[mr-1]||0),tt))}),Number.isFinite(tt)){var Qe=tt/je,st=B.layout==="vertical"?n.height:n.width;if(B.padding==="gap"&&(ae=Qe*st/2),B.padding==="no-gap"){var ot=Dy(t.barCategoryGap,Qe*st),Be=Qe*st/2;ae=Be-ot-(Be-ot)/st*ot}}}a==="xAxis"?ve=[n.left+(J.left||0)+(ae||0),n.left+n.width-(J.right||0)-(ae||0)]:a==="yAxis"?ve=_==="horizontal"?[n.top+n.height-(J.bottom||0),n.top+(J.top||0)]:[n.top+(J.top||0)+(ae||0),n.top+n.height-(J.bottom||0)-(ae||0)]:ve=B.range,oe&&(ve=[ve[1],ve[0]]);var lt=Ije(B,l,I),zt=lt.scale,Lt=lt.realScaleType;zt.domain(G).range(ve),Oje(zt);var Bt=Fje(zt,bu(bu({},B),{},{realScaleType:Lt}));a==="xAxis"?(Ce=q==="top"&&!Q||q==="bottom"&&Q,Fe=n.left,ke=C[de]-Ce*B.height):a==="yAxis"&&(Ce=q==="left"&&!Q||q==="right"&&Q,Fe=C[de]-Ce*B.width,ke=n.top);var ct=bu(bu(bu({},B),Bt),{},{realScaleType:Lt,x:Fe,y:ke,scale:zt,width:a==="xAxis"?n.width:B.width,height:a==="yAxis"?n.height:B.height});return ct.bandSize=nO(ct,Bt),!B.hide&&a==="xAxis"?C[de]+=(Ce?-1:1)*ct.height:B.hide||(C[de]+=(Ce?-1:1)*ct.width),bu(bu({},F),{},gR({},$,ct))},{})},Kne=function(t,r){var n=t.x,a=t.y,l=r.x,h=r.y;return{x:Math.min(n,l),y:Math.min(a,h),width:Math.abs(l-n),height:Math.abs(h-a)}},Y$e=function(t){var r=t.x1,n=t.y1,a=t.x2,l=t.y2;return Kne({x:r,y:n},{x:a,y:l})},Jne=function(){function e(t){H$e(this,e),this.scale=t}return Z$e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,l=n.position;if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+h}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(a){var _=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+_}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],l=n[n.length-1];return a<=l?r>=a&&r<=l:r>=l&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();gR(Jne,"EPS",1e-4);var I$=function(t){var r=Object.keys(t).reduce(function(n,a){return bu(bu({},n),{},gR({},a,Jne.create(t[a])))},{});return bu(bu({},r),{},{apply:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=l.bandAware,i=l.position;return g$e(a,function(_,b){return r[b].apply(_,{bandAware:h,position:i})})},isInRange:function(a){return Gne(a,function(l,h){return r[h].isInRange(l)})}})};function K$e(e){return(e%180+180)%180}var J$e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=K$e(a),h=l*Math.PI/180,i=Math.atan(n/r),_=h>i&&h<Math.PI-i?n/Math.sin(h):r/Math.cos(h);return Math.abs(_)},Q$e=km,eUe=NE,tUe=tR;function rUe(e){return function(t,r,n){var a=Object(t);if(!eUe(t)){var l=Q$e(r);t=tUe(t),r=function(i){return l(a[i],i,a)}}var h=e(t,r,n);return h>-1?a[l?t[h]:h]:void 0}}var nUe=rUe,iUe=$ne;function oUe(e){var t=iUe(e),r=t%1;return t===t?r?t-r:t:0}var aUe=oUe,sUe=ire,lUe=km,cUe=aUe,uUe=Math.max;function dUe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:cUe(r);return a<0&&(a=uUe(n+a,0)),sUe(e,lUe(t),a)}var hUe=dUe,fUe=nUe,pUe=hUe,mUe=fUe(pUe),gUe=mUe;const yUe=yi(gUe);var vUe=gTe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),O$=ne.createContext(void 0),k$=ne.createContext(void 0),Qne=ne.createContext(void 0),eie=ne.createContext({}),tie=ne.createContext(void 0),rie=ne.createContext(0),nie=ne.createContext(0),AZ=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,l=r.offset,h=t.clipPathId,i=t.children,_=t.width,b=t.height,E=vUe(l);return Ae.createElement(O$.Provider,{value:n},Ae.createElement(k$.Provider,{value:a},Ae.createElement(eie.Provider,{value:l},Ae.createElement(Qne.Provider,{value:E},Ae.createElement(tie.Provider,{value:h},Ae.createElement(rie.Provider,{value:b},Ae.createElement(nie.Provider,{value:_},i)))))))},_Ue=function(){return ne.useContext(tie)},iie=function(t){var r=ne.useContext(O$);r==null&&Ny();var n=r[t];return n==null&&Ny(),n},xUe=function(){var t=ne.useContext(O$);return Lp(t)},bUe=function(){var t=ne.useContext(k$),r=yUe(t,function(n){return Gne(n.domain,Number.isFinite)});return r||Lp(t)},oie=function(t){var r=ne.useContext(k$);r==null&&Ny();var n=r[t];return n==null&&Ny(),n},wUe=function(){var t=ne.useContext(Qne);return t},SUe=function(){return ne.useContext(eie)},R$=function(){return ne.useContext(nie)},D$=function(){return ne.useContext(rie)};function vx(e){"@babel/helpers - typeof";return vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vx(e)}function TUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EUe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sie(n.key),n)}}function AUe(e,t,r){return t&&EUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function CUe(e,t,r){return t=yO(t),MUe(e,aie()?Reflect.construct(t,r||[],yO(e).constructor):t.apply(e,r))}function MUe(e,t){if(t&&(vx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PUe(e)}function PUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aie=function(){return!!e})()}function yO(e){return yO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yO(e)}function IUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IF(e,t)}function IF(e,t){return IF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},IF(e,t)}function CZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CZ(Object(r),!0).forEach(function(n){L$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L$(e,t,r){return t=sie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sie(e){var t=OUe(e,"string");return vx(t)=="symbol"?t:t+""}function OUe(e,t){if(vx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kUe(e,t){return NUe(e)||LUe(e,t)||DUe(e,t)||RUe()}function RUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DUe(e,t){if(e){if(typeof e=="string")return PZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PZ(e,t)}}function PZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function NUe(e){if(Array.isArray(e))return e}function OF(){return OF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OF.apply(this,arguments)}var zUe=function(t,r){var n;return Ae.isValidElement(t)?n=Ae.cloneElement(t,r):Xn(t)?n=t(r):n=Ae.createElement("line",OF({},r,{className:"recharts-reference-line-line"})),n},jUe=function(t,r,n,a,l,h,i,_,b){var E=l.x,C=l.y,I=l.width,F=l.height;if(n){var $=b.y,B=t.y.apply($,{position:h});if(jd(b,"discard")&&!t.y.isInRange(B))return null;var q=[{x:E+I,y:B},{x:E,y:B}];return _==="left"?q.reverse():q}if(r){var G=b.x,H=t.x.apply(G,{position:h});if(jd(b,"discard")&&!t.x.isInRange(H))return null;var J=[{x:H,y:C+F},{x:H,y:C}];return i==="top"?J.reverse():J}if(a){var Q=b.segment,oe=Q.map(function(de){return t.apply(de,{position:h})});return jd(b,"discard")&&l$e(oe,function(de){return!t.isInRange(de)})?null:oe}return null};function FUe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,l=e.yAxisId,h=e.shape,i=e.className,_=e.alwaysShow,b=_Ue(),E=iie(a),C=oie(l),I=wUe();if(!b||!I)return null;Bh(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var F=I$({x:E.scale,y:C.scale}),$=Aa(t),B=Aa(r),q=n&&n.length===2,G=jUe(F,$,B,q,I,e.position,E.orientation,C.orientation,e);if(!G)return null;var H=kUe(G,2),J=H[0],Q=J.x,oe=J.y,de=H[1],ae=de.x,ve=de.y,Fe=jd(e,"hidden")?"url(#".concat(b,")"):void 0,ke=MZ(MZ({clipPath:Fe},ti(e,!0)),{},{x1:Q,y1:oe,x2:ae,y2:ve});return Ae.createElement(Io,{className:gi("recharts-reference-line",i)},zUe(h,ke),ds.renderCallByParent(e,Y$e({x1:Q,y1:oe,x2:ae,y2:ve})))}var N$=function(e){function t(){return TUe(this,t),CUe(this,t,arguments)}return IUe(t,e),AUe(t,[{key:"render",value:function(){return Ae.createElement(FUe,this.props)}}])}(Ae.Component);L$(N$,"displayName","ReferenceLine");L$(N$,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function kF(){return kF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kF.apply(this,arguments)}function _x(e){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_x(e)}function IZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IZ(Object(r),!0).forEach(function(n){yR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cie(n.key),n)}}function UUe(e,t,r){return t&&$Ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function VUe(e,t,r){return t=vO(t),WUe(e,lie()?Reflect.construct(t,r||[],vO(e).constructor):t.apply(e,r))}function WUe(e,t){if(t&&(_x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GUe(e)}function GUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lie=function(){return!!e})()}function vO(e){return vO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vO(e)}function qUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RF(e,t)}function RF(e,t){return RF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},RF(e,t)}function yR(e,t,r){return t=cie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cie(e){var t=HUe(e,"string");return _x(t)=="symbol"?t:t+""}function HUe(e,t){if(_x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZUe=function(t){var r=t.x,n=t.y,a=t.xAxis,l=t.yAxis,h=I$({x:a.scale,y:l.scale}),i=h.apply({x:r,y:n},{bandAware:!0});return jd(t,"discard")&&!h.isInRange(i)?null:i},vR=function(e){function t(){return BUe(this,t),VUe(this,t,arguments)}return qUe(t,e),UUe(t,[{key:"render",value:function(){var n=this.props,a=n.x,l=n.y,h=n.r,i=n.alwaysShow,_=n.clipPathId,b=Aa(a),E=Aa(l);if(Bh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!b||!E)return null;var C=ZUe(this.props);if(!C)return null;var I=C.x,F=C.y,$=this.props,B=$.shape,q=$.className,G=jd(this.props,"hidden")?"url(#".concat(_,")"):void 0,H=OZ(OZ({clipPath:G},ti(this.props,!0)),{},{cx:I,cy:F});return Ae.createElement(Io,{className:gi("recharts-reference-dot",q)},t.renderDot(B,H),ds.renderCallByParent(this.props,{x:I-h,y:F-h,width:2*h,height:2*h}))}}])}(Ae.Component);yR(vR,"displayName","ReferenceDot");yR(vR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});yR(vR,"renderDot",function(e,t){var r;return Ae.isValidElement(e)?r=Ae.cloneElement(e,t):Xn(e)?r=e(t):r=Ae.createElement(P$,kF({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function DF(){return DF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DF.apply(this,arguments)}function xx(e){"@babel/helpers - typeof";return xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xx(e)}function kZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kZ(Object(r),!0).forEach(function(n){_R(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YUe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,die(n.key),n)}}function KUe(e,t,r){return t&&YUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JUe(e,t,r){return t=_O(t),QUe(e,uie()?Reflect.construct(t,r||[],_O(e).constructor):t.apply(e,r))}function QUe(e,t){if(t&&(xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e6e(e)}function e6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uie=function(){return!!e})()}function _O(e){return _O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_O(e)}function t6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LF(e,t)}function LF(e,t){return LF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LF(e,t)}function _R(e,t,r){return t=die(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function die(e){var t=r6e(e,"string");return xx(t)=="symbol"?t:t+""}function r6e(e,t){if(xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n6e=function(t,r,n,a,l){var h=l.x1,i=l.x2,_=l.y1,b=l.y2,E=l.xAxis,C=l.yAxis;if(!E||!C)return null;var I=I$({x:E.scale,y:C.scale}),F={x:t?I.x.apply(h,{position:"start"}):I.x.rangeMin,y:n?I.y.apply(_,{position:"start"}):I.y.rangeMin},$={x:r?I.x.apply(i,{position:"end"}):I.x.rangeMax,y:a?I.y.apply(b,{position:"end"}):I.y.rangeMax};return jd(l,"discard")&&(!I.isInRange(F)||!I.isInRange($))?null:Kne(F,$)},xR=function(e){function t(){return XUe(this,t),JUe(this,t,arguments)}return t6e(t,e),KUe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,l=n.x2,h=n.y1,i=n.y2,_=n.className,b=n.alwaysShow,E=n.clipPathId;Bh(b===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=Aa(a),I=Aa(l),F=Aa(h),$=Aa(i),B=this.props.shape;if(!C&&!I&&!F&&!$&&!B)return null;var q=n6e(C,I,F,$,this.props);if(!q&&!B)return null;var G=jd(this.props,"hidden")?"url(#".concat(E,")"):void 0;return Ae.createElement(Io,{className:gi("recharts-reference-area",_)},t.renderRect(B,RZ(RZ({clipPath:G},ti(this.props,!0)),q)),ds.renderCallByParent(this.props,q))}}])}(Ae.Component);_R(xR,"displayName","ReferenceArea");_R(xR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});_R(xR,"renderRect",function(e,t){var r;return Ae.isValidElement(e)?r=Ae.cloneElement(e,t):Xn(e)?r=e(t):r=Ae.createElement(M$,DF({},t,{className:"recharts-reference-area-rect"})),r});function hie(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function i6e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return J$e(n,r)}function o6e(e,t,r){var n=r==="width",a=e.x,l=e.y,h=e.width,i=e.height;return t===1?{start:n?a:l,end:n?a+h:l+i}:{start:n?a+h:l+i,end:n?a:l}}function xO(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var l=r();return e*(t-e*l/2-n)>=0&&e*(t+e*l/2-a)<=0}function a6e(e,t){return hie(e,t+1)}function s6e(e,t,r,n,a){for(var l=(n||[]).slice(),h=t.start,i=t.end,_=0,b=1,E=h,C=function(){var $=n==null?void 0:n[_];if($===void 0)return{v:hie(n,b)};var B=_,q,G=function(){return q===void 0&&(q=r($,B)),q},H=$.coordinate,J=_===0||xO(e,H,G,E,i);J||(_=0,E=h,b+=1),J&&(E=H+e*(G()/2+a),_+=b)},I;b<=l.length;)if(I=C(),I)return I.v;return[]}function QT(e){"@babel/helpers - typeof";return QT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QT(e)}function DZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DZ(Object(r),!0).forEach(function(n){l6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l6e(e,t,r){return t=c6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c6e(e){var t=u6e(e,"string");return QT(t)=="symbol"?t:t+""}function u6e(e,t){if(QT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(QT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d6e(e,t,r,n,a){for(var l=(n||[]).slice(),h=l.length,i=t.start,_=t.end,b=function(I){var F=l[I],$,B=function(){return $===void 0&&($=r(F,I)),$};if(I===h-1){var q=e*(F.coordinate+e*B()/2-_);l[I]=F=ls(ls({},F),{},{tickCoord:q>0?F.coordinate-q*e:F.coordinate})}else l[I]=F=ls(ls({},F),{},{tickCoord:F.coordinate});var G=xO(e,F.tickCoord,B,i,_);G&&(_=F.tickCoord-e*(B()/2+a),l[I]=ls(ls({},F),{},{isShow:!0}))},E=h-1;E>=0;E--)b(E);return l}function h6e(e,t,r,n,a,l){var h=(n||[]).slice(),i=h.length,_=t.start,b=t.end;if(l){var E=n[i-1],C=r(E,i-1),I=e*(E.coordinate+e*C/2-b);h[i-1]=E=ls(ls({},E),{},{tickCoord:I>0?E.coordinate-I*e:E.coordinate});var F=xO(e,E.tickCoord,function(){return C},_,b);F&&(b=E.tickCoord-e*(C/2+a),h[i-1]=ls(ls({},E),{},{isShow:!0}))}for(var $=l?i-1:i,B=function(H){var J=h[H],Q,oe=function(){return Q===void 0&&(Q=r(J,H)),Q};if(H===0){var de=e*(J.coordinate-e*oe()/2-_);h[H]=J=ls(ls({},J),{},{tickCoord:de<0?J.coordinate-de*e:J.coordinate})}else h[H]=J=ls(ls({},J),{},{tickCoord:J.coordinate});var ae=xO(e,J.tickCoord,oe,_,b);ae&&(_=J.tickCoord+e*(oe()/2+a),h[H]=ls(ls({},J),{},{isShow:!0}))},q=0;q<$;q++)B(q);return h}function z$(e,t,r){var n=e.tick,a=e.ticks,l=e.viewBox,h=e.minTickGap,i=e.orientation,_=e.interval,b=e.tickFormatter,E=e.unit,C=e.angle;if(!a||!a.length||!n)return[];if(Sr(_)||$h.isSsr)return a6e(a,typeof _=="number"&&Sr(_)?_:0);var I=[],F=i==="top"||i==="bottom"?"width":"height",$=E&&F==="width"?FS(E,{fontSize:t,letterSpacing:r}):{width:0,height:0},B=function(J,Q){var oe=Xn(b)?b(J.value,Q):J.value;return F==="width"?i6e(FS(oe,{fontSize:t,letterSpacing:r}),$,C):FS(oe,{fontSize:t,letterSpacing:r})[F]},q=a.length>=2?Cu(a[1].coordinate-a[0].coordinate):1,G=o6e(l,q,F);return _==="equidistantPreserveStart"?s6e(q,G,B,a,h):(_==="preserveStart"||_==="preserveStartEnd"?I=h6e(q,G,B,a,h,_==="preserveStartEnd"):I=d6e(q,G,B,a,h),I.filter(function(H){return H.isShow}))}var f6e=["viewBox"],p6e=["viewBox"],m6e=["ticks"];function bx(e){"@babel/helpers - typeof";return bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bx(e)}function h0(){return h0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h0.apply(this,arguments)}function LZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LZ(Object(r),!0).forEach(function(n){j$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dN(e,t){if(e==null)return{};var r=g6e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function y6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pie(n.key),n)}}function v6e(e,t,r){return t&&NZ(e.prototype,t),r&&NZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _6e(e,t,r){return t=bO(t),x6e(e,fie()?Reflect.construct(t,r||[],bO(e).constructor):t.apply(e,r))}function x6e(e,t){if(t&&(bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b6e(e)}function b6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fie=function(){return!!e})()}function bO(e){return bO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bO(e)}function w6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NF(e,t)}function NF(e,t){return NF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},NF(e,t)}function j$(e,t,r){return t=pie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pie(e){var t=S6e(e,"string");return bx(t)=="symbol"?t:t+""}function S6e(e,t){if(bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fb=function(e){function t(r){var n;return y6e(this,t),n=_6e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return w6e(t,e),v6e(t,[{key:"shouldComponentUpdate",value:function(n,a){var l=n.viewBox,h=dN(n,f6e),i=this.props,_=i.viewBox,b=dN(i,p6e);return!C0(l,_)||!C0(h,b)||!C0(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,l=a.x,h=a.y,i=a.width,_=a.height,b=a.orientation,E=a.tickSize,C=a.mirror,I=a.tickMargin,F,$,B,q,G,H,J=C?-1:1,Q=n.tickSize||E,oe=Sr(n.tickCoord)?n.tickCoord:n.coordinate;switch(b){case"top":F=$=n.coordinate,q=h+ +!C*_,B=q-J*Q,H=B-J*I,G=oe;break;case"left":B=q=n.coordinate,$=l+ +!C*i,F=$-J*Q,G=F-J*I,H=oe;break;case"right":B=q=n.coordinate,$=l+ +C*i,F=$+J*Q,G=F+J*I,H=oe;break;default:F=$=n.coordinate,q=h+ +C*_,B=q+J*Q,H=B+J*I,G=oe;break}return{line:{x1:F,y1:B,x2:$,y2:q},tick:{x:G,y:H}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,h;switch(a){case"left":h=l?"start":"end";break;case"right":h=l?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,h="end";switch(a){case"left":case"right":h="middle";break;case"top":h=l?"start":"end";break;default:h=l?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,l=n.y,h=n.width,i=n.height,_=n.orientation,b=n.mirror,E=n.axisLine,C=Is(Is(Is({},ti(this.props,!1)),ti(E,!1)),{},{fill:"none"});if(_==="top"||_==="bottom"){var I=+(_==="top"&&!b||_==="bottom"&&b);C=Is(Is({},C),{},{x1:a,y1:l+I*i,x2:a+h,y2:l+I*i})}else{var F=+(_==="left"&&!b||_==="right"&&b);C=Is(Is({},C),{},{x1:a+F*h,y1:l,x2:a+F*h,y2:l+i})}return Ae.createElement("line",h0({},C,{className:gi("recharts-cartesian-axis-line",Rc(E,"className"))}))}},{key:"renderTicks",value:function(n,a,l){var h=this,i=this.props,_=i.tickLine,b=i.stroke,E=i.tick,C=i.tickFormatter,I=i.unit,F=z$(Is(Is({},this.props),{},{ticks:n}),a,l),$=this.getTickTextAnchor(),B=this.getTickVerticalAnchor(),q=ti(this.props,!1),G=ti(E,!1),H=Is(Is({},q),{},{fill:"none"},ti(_,!1)),J=F.map(function(Q,oe){var de=h.getTickLineCoord(Q),ae=de.line,ve=de.tick,Fe=Is(Is(Is(Is({textAnchor:$,verticalAnchor:B},q),{},{stroke:"none",fill:b},G),ve),{},{index:oe,payload:Q,visibleTicksCount:F.length,tickFormatter:C});return Ae.createElement(Io,h0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Q.value,"-").concat(Q.coordinate,"-").concat(Q.tickCoord)},PI(h.props,Q,oe)),_&&Ae.createElement("line",h0({},H,ae,{className:gi("recharts-cartesian-axis-tick-line",Rc(_,"className"))})),E&&t.renderTickItem(E,Fe,"".concat(Xn(C)?C(Q.value,oe):Q.value).concat(I||"")))});return Ae.createElement("g",{className:"recharts-cartesian-axis-ticks"},J)}},{key:"render",value:function(){var n=this,a=this.props,l=a.axisLine,h=a.width,i=a.height,_=a.ticksGenerator,b=a.className,E=a.hide;if(E)return null;var C=this.props,I=C.ticks,F=dN(C,m6e),$=I;return Xn(_)&&($=I&&I.length>0?_(this.props):_(F)),h<=0||i<=0||!$||!$.length?null:Ae.createElement(Io,{className:gi("recharts-cartesian-axis",b),ref:function(q){n.layerReference=q}},l&&this.renderAxisLine(),this.renderTicks($,this.state.fontSize,this.state.letterSpacing),ds.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,l){var h;return Ae.isValidElement(n)?h=Ae.cloneElement(n,a):Xn(n)?h=n(a):h=Ae.createElement(VI,h0({},a,{className:"recharts-cartesian-axis-tick-value"}),l),h}}])}(ne.Component);j$(fb,"displayName","CartesianAxis");j$(fb,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var T6e=["x1","y1","x2","y2","key"],E6e=["offset"];function zy(e){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zy(e)}function zZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zZ(Object(r),!0).forEach(function(n){A6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A6e(e,t,r){return t=C6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C6e(e){var t=M6e(e,"string");return zy(t)=="symbol"?t:t+""}function M6e(e,t){if(zy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iy(){return iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iy.apply(this,arguments)}function jZ(e,t){if(e==null)return{};var r=P6e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function P6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var I6e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,l=t.y,h=t.width,i=t.height,_=t.ry;return Ae.createElement("rect",{x:a,y:l,ry:_,width:h,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function mie(e,t){var r;if(Ae.isValidElement(e))r=Ae.cloneElement(e,t);else if(Xn(e))r=e(t);else{var n=t.x1,a=t.y1,l=t.x2,h=t.y2,i=t.key,_=jZ(t,T6e),b=ti(_,!1);b.offset;var E=jZ(b,E6e);r=Ae.createElement("line",iy({},E,{x1:n,y1:a,x2:l,y2:h,fill:"none",key:i}))}return r}function O6e(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,l=e.horizontalPoints;if(!a||!l||!l.length)return null;var h=l.map(function(i,_){var b=hs(hs({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(_),index:_});return mie(a,b)});return Ae.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function k6e(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,l=e.verticalPoints;if(!a||!l||!l.length)return null;var h=l.map(function(i,_){var b=hs(hs({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(_),index:_});return mie(a,b)});return Ae.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function R6e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,l=e.width,h=e.height,i=e.horizontalPoints,_=e.horizontal,b=_===void 0?!0:_;if(!b||!t||!t.length)return null;var E=i.map(function(I){return Math.round(I+a-a)}).sort(function(I,F){return I-F});a!==E[0]&&E.unshift(0);var C=E.map(function(I,F){var $=!E[F+1],B=$?a+h-I:E[F+1]-I;if(B<=0)return null;var q=F%t.length;return Ae.createElement("rect",{key:"react-".concat(F),y:I,x:n,height:B,width:l,stroke:"none",fill:t[q],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Ae.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},C)}function D6e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,l=e.x,h=e.y,i=e.width,_=e.height,b=e.verticalPoints;if(!r||!n||!n.length)return null;var E=b.map(function(I){return Math.round(I+l-l)}).sort(function(I,F){return I-F});l!==E[0]&&E.unshift(0);var C=E.map(function(I,F){var $=!E[F+1],B=$?l+i-I:E[F+1]-I;if(B<=0)return null;var q=F%n.length;return Ae.createElement("rect",{key:"react-".concat(F),x:I,y:h,width:B,height:_,stroke:"none",fill:n[q],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Ae.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},C)}var L6e=function(t,r){var n=t.xAxis,a=t.width,l=t.height,h=t.offset;return Sne(z$(hs(hs(hs({},fb.defaultProps),n),{},{ticks:Dh(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),h.left,h.left+h.width,r)},N6e=function(t,r){var n=t.yAxis,a=t.width,l=t.height,h=t.offset;return Sne(z$(hs(hs(hs({},fb.defaultProps),n),{},{ticks:Dh(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),h.top,h.top+h.height,r)},S_={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function zF(e){var t,r,n,a,l,h,i=R$(),_=D$(),b=SUe(),E=hs(hs({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:S_.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:S_.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:S_.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:S_.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:S_.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:S_.verticalFill,x:Sr(e.x)?e.x:b.left,y:Sr(e.y)?e.y:b.top,width:Sr(e.width)?e.width:b.width,height:Sr(e.height)?e.height:b.height}),C=E.x,I=E.y,F=E.width,$=E.height,B=E.syncWithTicks,q=E.horizontalValues,G=E.verticalValues,H=xUe(),J=bUe();if(!Sr(F)||F<=0||!Sr($)||$<=0||!Sr(C)||C!==+C||!Sr(I)||I!==+I)return null;var Q=E.verticalCoordinatesGenerator||L6e,oe=E.horizontalCoordinatesGenerator||N6e,de=E.horizontalPoints,ae=E.verticalPoints;if((!de||!de.length)&&Xn(oe)){var ve=q&&q.length,Fe=oe({yAxis:J?hs(hs({},J),{},{ticks:ve?q:J.ticks}):void 0,width:i,height:_,offset:b},ve?!0:B);Bh(Array.isArray(Fe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(zy(Fe),"]")),Array.isArray(Fe)&&(de=Fe)}if((!ae||!ae.length)&&Xn(Q)){var ke=G&&G.length,Ce=Q({xAxis:H?hs(hs({},H),{},{ticks:ke?G:H.ticks}):void 0,width:i,height:_,offset:b},ke?!0:B);Bh(Array.isArray(Ce),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(zy(Ce),"]")),Array.isArray(Ce)&&(ae=Ce)}return Ae.createElement("g",{className:"recharts-cartesian-grid"},Ae.createElement(I6e,{fill:E.fill,fillOpacity:E.fillOpacity,x:E.x,y:E.y,width:E.width,height:E.height,ry:E.ry}),Ae.createElement(O6e,iy({},E,{offset:b,horizontalPoints:de,xAxis:H,yAxis:J})),Ae.createElement(k6e,iy({},E,{offset:b,verticalPoints:ae,xAxis:H,yAxis:J})),Ae.createElement(R6e,iy({},E,{horizontalPoints:de})),Ae.createElement(D6e,iy({},E,{verticalPoints:ae})))}zF.displayName="CartesianGrid";var z6e=["layout","type","stroke","connectNulls","isRange","ref"],j6e=["key"],gie;function wx(e){"@babel/helpers - typeof";return wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wx(e)}function yie(e,t){if(e==null)return{};var r=F6e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oy(){return oy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oy.apply(this,arguments)}function FZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FZ(Object(r),!0).forEach(function(n){Id(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ie(n.key),n)}}function $6e(e,t,r){return t&&BZ(e.prototype,t),r&&BZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U6e(e,t,r){return t=wO(t),V6e(e,vie()?Reflect.construct(t,r||[],wO(e).constructor):t.apply(e,r))}function V6e(e,t){if(t&&(wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W6e(e)}function W6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vie=function(){return!!e})()}function wO(e){return wO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wO(e)}function G6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jF(e,t)}function jF(e,t){return jF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jF(e,t)}function Id(e,t,r){return t=_ie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ie(e){var t=q6e(e,"string");return wx(t)=="symbol"?t:t+""}function q6e(e,t){if(wx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var of=function(e){function t(){var r;B6e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=U6e(this,t,[].concat(a)),Id(r,"state",{isAnimationFinished:!0}),Id(r,"id",LE("recharts-area-")),Id(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Xn(h)&&h()}),Id(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Xn(h)&&h()}),r}return G6e(t,e),$6e(t,[{key:"renderDots",value:function(n,a,l){var h=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(h&&!i)return null;var _=this.props,b=_.dot,E=_.points,C=_.dataKey,I=ti(this.props,!1),F=ti(b,!0),$=E.map(function(q,G){var H=xp(xp(xp({key:"dot-".concat(G),r:3},I),F),{},{index:G,cx:q.x,cy:q.y,dataKey:C,value:q.value,payload:q.payload,points:E});return t.renderDotItem(b,H)}),B={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return Ae.createElement(Io,oy({className:"recharts-area-dots"},B),$)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,l=a.baseLine,h=a.points,i=a.strokeWidth,_=h[0].x,b=h[h.length-1].x,E=n*Math.abs(_-b),C=Kp(h.map(function(I){return I.y||0}));return Sr(l)&&typeof l=="number"?C=Math.max(l,C):l&&Array.isArray(l)&&l.length&&(C=Math.max(Kp(l.map(function(I){return I.y||0})),C)),Sr(C)?Ae.createElement("rect",{x:_<b?_:_-E,y:0,width:E,height:Math.floor(C+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,l=a.baseLine,h=a.points,i=a.strokeWidth,_=h[0].y,b=h[h.length-1].y,E=n*Math.abs(_-b),C=Kp(h.map(function(I){return I.x||0}));return Sr(l)&&typeof l=="number"?C=Math.max(l,C):l&&Array.isArray(l)&&l.length&&(C=Math.max(Kp(l.map(function(I){return I.x||0})),C)),Sr(C)?Ae.createElement("rect",{x:0,y:_<b?_:_-E,width:C+(i?parseInt("".concat(i),10):1),height:Math.floor(E)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,l,h){var i=this.props,_=i.layout,b=i.type,E=i.stroke,C=i.connectNulls,I=i.isRange;i.ref;var F=yie(i,z6e);return Ae.createElement(Io,{clipPath:l?"url(#clipPath-".concat(h,")"):null},Ae.createElement(US,oy({},ti(F,!0),{points:n,connectNulls:C,type:b,baseLine:a,layout:_,stroke:"none",className:"recharts-area-area"})),E!=="none"&&Ae.createElement(US,oy({},ti(this.props,!1),{className:"recharts-area-curve",layout:_,type:b,connectNulls:C,fill:"none",points:n})),E!=="none"&&I&&Ae.createElement(US,oy({},ti(this.props,!1),{className:"recharts-area-curve",layout:_,type:b,connectNulls:C,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var l=this,h=this.props,i=h.points,_=h.baseLine,b=h.isAnimationActive,E=h.animationBegin,C=h.animationDuration,I=h.animationEasing,F=h.animationId,$=this.state,B=$.prevPoints,q=$.prevBaseLine;return Ae.createElement(nf,{begin:E,duration:C,isActive:b,easing:I,from:{t:0},to:{t:1},key:"area-".concat(F),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(G){var H=G.t;if(B){var J=B.length/i.length,Q=i.map(function(ve,Fe){var ke=Math.floor(Fe*J);if(B[ke]){var Ce=B[ke],je=Cc(Ce.x,ve.x),tt=Cc(Ce.y,ve.y);return xp(xp({},ve),{},{x:je(H),y:tt(H)})}return ve}),oe;if(Sr(_)&&typeof _=="number"){var de=Cc(q,_);oe=de(H)}else if(ui(_)||ob(_)){var ae=Cc(q,0);oe=ae(H)}else oe=_.map(function(ve,Fe){var ke=Math.floor(Fe*J);if(q[ke]){var Ce=q[ke],je=Cc(Ce.x,ve.x),tt=Cc(Ce.y,ve.y);return xp(xp({},ve),{},{x:je(H),y:tt(H)})}return ve});return l.renderAreaStatically(Q,oe,n,a)}return Ae.createElement(Io,null,Ae.createElement("defs",null,Ae.createElement("clipPath",{id:"animationClipPath-".concat(a)},l.renderClipRect(H))),Ae.createElement(Io,{clipPath:"url(#animationClipPath-".concat(a,")")},l.renderAreaStatically(i,_,n,a)))})}},{key:"renderArea",value:function(n,a){var l=this.props,h=l.points,i=l.baseLine,_=l.isAnimationActive,b=this.state,E=b.prevPoints,C=b.prevBaseLine,I=b.totalLength;return _&&h&&h.length&&(!E&&I>0||!kT(E,h)||!kT(C,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(h,i,n,a)}},{key:"render",value:function(){var n,a=this.props,l=a.hide,h=a.dot,i=a.points,_=a.className,b=a.top,E=a.left,C=a.xAxis,I=a.yAxis,F=a.width,$=a.height,B=a.isAnimationActive,q=a.id;if(l||!i||!i.length)return null;var G=this.state.isAnimationFinished,H=i.length===1,J=gi("recharts-area",_),Q=C&&C.allowDataOverflow,oe=I&&I.allowDataOverflow,de=Q||oe,ae=ui(q)?this.id:q,ve=(n=ti(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Fe=ve.r,ke=Fe===void 0?3:Fe,Ce=ve.strokeWidth,je=Ce===void 0?2:Ce,tt=bEe(h)?h:{},Ze=tt.clipDot,Qe=Ze===void 0?!0:Ze,st=ke*2+je;return Ae.createElement(Io,{className:J},Q||oe?Ae.createElement("defs",null,Ae.createElement("clipPath",{id:"clipPath-".concat(ae)},Ae.createElement("rect",{x:Q?E:E-F/2,y:oe?b:b-$/2,width:Q?F:F*2,height:oe?$:$*2})),!Qe&&Ae.createElement("clipPath",{id:"clipPath-dots-".concat(ae)},Ae.createElement("rect",{x:E-st/2,y:b-st/2,width:F+st,height:$+st}))):null,H?null:this.renderArea(de,ae),(h||H)&&this.renderDots(de,Qe,ae),(!B||G)&&um.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(ne.PureComponent);gie=of;Id(of,"displayName","Area");Id(of,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!$h.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Id(of,"getBaseValue",function(e,t,r,n){var a=e.layout,l=e.baseValue,h=t.props.baseValue,i=h??l;if(Sr(i)&&typeof i=="number")return i;var _=a==="horizontal"?n:r,b=_.scale.domain();if(_.type==="number"){var E=Math.max(b[0],b[1]),C=Math.min(b[0],b[1]);return i==="dataMin"?C:i==="dataMax"||E<0?E:Math.max(Math.min(b[0],b[1]),0)}return i==="dataMin"?b[0]:i==="dataMax"?b[1]:b[0]});Id(of,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,l=e.xAxisTicks,h=e.yAxisTicks,i=e.bandSize,_=e.dataKey,b=e.stackedData,E=e.dataStartIndex,C=e.displayedData,I=e.offset,F=t.layout,$=b&&b.length,B=gie.getBaseValue(t,r,n,a),q=F==="horizontal",G=!1,H=C.map(function(Q,oe){var de;$?de=b[E+oe]:(de=nc(Q,_),Array.isArray(de)?G=!0:de=[B,de]);var ae=de[1]==null||$&&nc(Q,_)==null;return q?{x:b9({axis:n,ticks:l,bandSize:i,entry:Q,index:oe}),y:ae?null:a.scale(de[1]),value:de,payload:Q}:{x:ae?null:n.scale(de[1]),y:b9({axis:a,ticks:h,bandSize:i,entry:Q,index:oe}),value:de,payload:Q}}),J;return $||G?J=H.map(function(Q){var oe=Array.isArray(Q.value)?Q.value[0]:null;return q?{x:Q.x,y:oe!=null&&Q.y!=null?a.scale(oe):null}:{x:oe!=null?n.scale(oe):null,y:Q.y}}):J=q?a.scale(B):n.scale(B),xp({points:H,baseLine:J,layout:F,isRange:G},I)});Id(of,"renderDotItem",function(e,t){var r;if(Ae.isValidElement(e))r=Ae.cloneElement(e,t);else if(Xn(e))r=e(t);else{var n=gi("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,l=yie(t,j6e);r=Ae.createElement(P$,oy({},l,{key:a,className:n}))}return r});function Sx(e){"@babel/helpers - typeof";return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sx(e)}function H6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z6e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wie(n.key),n)}}function X6e(e,t,r){return t&&Z6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y6e(e,t,r){return t=SO(t),K6e(e,xie()?Reflect.construct(t,r||[],SO(e).constructor):t.apply(e,r))}function K6e(e,t){if(t&&(Sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J6e(e)}function J6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xie=function(){return!!e})()}function SO(e){return SO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SO(e)}function Q6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FF(e,t)}function FF(e,t){return FF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},FF(e,t)}function bie(e,t,r){return t=wie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wie(e){var t=eVe(e,"string");return Sx(t)=="symbol"?t:t+""}function eVe(e,t){if(Sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BF(){return BF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BF.apply(this,arguments)}function tVe(e){var t=e.xAxisId,r=R$(),n=D$(),a=iie(t);return a==null?null:Ae.createElement(fb,BF({},a,{className:gi("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(h){return Dh(h,!0)}}))}var Tx=function(e){function t(){return H6e(this,t),Y6e(this,t,arguments)}return Q6e(t,e),X6e(t,[{key:"render",value:function(){return Ae.createElement(tVe,this.props)}}])}(Ae.Component);bie(Tx,"displayName","XAxis");bie(Tx,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function rVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nVe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eie(n.key),n)}}function iVe(e,t,r){return t&&nVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oVe(e,t,r){return t=TO(t),aVe(e,Sie()?Reflect.construct(t,r||[],TO(e).constructor):t.apply(e,r))}function aVe(e,t){if(t&&(Ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sVe(e)}function sVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sie=function(){return!!e})()}function TO(e){return TO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TO(e)}function lVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$F(e,t)}function $F(e,t){return $F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$F(e,t)}function Tie(e,t,r){return t=Eie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eie(e){var t=cVe(e,"string");return Ex(t)=="symbol"?t:t+""}function cVe(e,t){if(Ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UF(){return UF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UF.apply(this,arguments)}var uVe=function(t){var r=t.yAxisId,n=R$(),a=D$(),l=oie(r);return l==null?null:Ae.createElement(fb,UF({},l,{className:gi("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return Dh(i,!0)}}))},Ax=function(e){function t(){return rVe(this,t),oVe(this,t,arguments)}return lVe(t,e),iVe(t,[{key:"render",value:function(){return Ae.createElement(uVe,this.props)}}])}(Ae.Component);Tie(Ax,"displayName","YAxis");Tie(Ax,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function $Z(e){return pVe(e)||fVe(e)||hVe(e)||dVe()}function dVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hVe(e,t){if(e){if(typeof e=="string")return VF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VF(e,t)}}function fVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pVe(e){if(Array.isArray(e))return VF(e)}function VF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var WF=function(t,r,n,a,l){var h=ku(t,N$),i=ku(t,vR),_=[].concat($Z(h),$Z(i)),b=ku(t,xR),E="".concat(a,"Id"),C=a[0],I=r;if(_.length&&(I=_.reduce(function(B,q){if(q.props[E]===n&&jd(q.props,"extendDomain")&&Sr(q.props[C])){var G=q.props[C];return[Math.min(B[0],G),Math.max(B[1],G)]}return B},I)),b.length){var F="".concat(C,"1"),$="".concat(C,"2");I=b.reduce(function(B,q){if(q.props[E]===n&&jd(q.props,"extendDomain")&&Sr(q.props[F])&&Sr(q.props[$])){var G=q.props[F],H=q.props[$];return[Math.min(B[0],G,H),Math.max(B[1],G,H)]}return B},I)}return l&&l.length&&(I=l.reduce(function(B,q){return Sr(q)?[Math.min(B[0],q),Math.max(B[1],q)]:B},I)),I},Aie={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(_,b,E){this.fn=_,this.context=b,this.once=E||!1}function l(_,b,E,C,I){if(typeof E!="function")throw new TypeError("The listener must be a function");var F=new a(E,C||_,I),$=r?r+b:b;return _._events[$]?_._events[$].fn?_._events[$]=[_._events[$],F]:_._events[$].push(F):(_._events[$]=F,_._eventsCount++),_}function h(_,b){--_._eventsCount===0?_._events=new n:delete _._events[b]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var b=[],E,C;if(this._eventsCount===0)return b;for(C in E=this._events)t.call(E,C)&&b.push(r?C.slice(1):C);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(E)):b},i.prototype.listeners=function(b){var E=r?r+b:b,C=this._events[E];if(!C)return[];if(C.fn)return[C.fn];for(var I=0,F=C.length,$=new Array(F);I<F;I++)$[I]=C[I].fn;return $},i.prototype.listenerCount=function(b){var E=r?r+b:b,C=this._events[E];return C?C.fn?1:C.length:0},i.prototype.emit=function(b,E,C,I,F,$){var B=r?r+b:b;if(!this._events[B])return!1;var q=this._events[B],G=arguments.length,H,J;if(q.fn){switch(q.once&&this.removeListener(b,q.fn,void 0,!0),G){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,E),!0;case 3:return q.fn.call(q.context,E,C),!0;case 4:return q.fn.call(q.context,E,C,I),!0;case 5:return q.fn.call(q.context,E,C,I,F),!0;case 6:return q.fn.call(q.context,E,C,I,F,$),!0}for(J=1,H=new Array(G-1);J<G;J++)H[J-1]=arguments[J];q.fn.apply(q.context,H)}else{var Q=q.length,oe;for(J=0;J<Q;J++)switch(q[J].once&&this.removeListener(b,q[J].fn,void 0,!0),G){case 1:q[J].fn.call(q[J].context);break;case 2:q[J].fn.call(q[J].context,E);break;case 3:q[J].fn.call(q[J].context,E,C);break;case 4:q[J].fn.call(q[J].context,E,C,I);break;default:if(!H)for(oe=1,H=new Array(G-1);oe<G;oe++)H[oe-1]=arguments[oe];q[J].fn.apply(q[J].context,H)}}return!0},i.prototype.on=function(b,E,C){return l(this,b,E,C,!1)},i.prototype.once=function(b,E,C){return l(this,b,E,C,!0)},i.prototype.removeListener=function(b,E,C,I){var F=r?r+b:b;if(!this._events[F])return this;if(!E)return h(this,F),this;var $=this._events[F];if($.fn)$.fn===E&&(!I||$.once)&&(!C||$.context===C)&&h(this,F);else{for(var B=0,q=[],G=$.length;B<G;B++)($[B].fn!==E||I&&!$[B].once||C&&$[B].context!==C)&&q.push($[B]);q.length?this._events[F]=q.length===1?q[0]:q:h(this,F)}return this},i.prototype.removeAllListeners=function(b){var E;return b?(E=r?r+b:b,this._events[E]&&h(this,E)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i})(Aie);var mVe=Aie.exports;const gVe=yi(mVe);var hN=new gVe,fN="recharts.syncMouseEvents";function eE(e){"@babel/helpers - typeof";return eE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eE(e)}function yVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vVe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cie(n.key),n)}}function _Ve(e,t,r){return t&&vVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pN(e,t,r){return t=Cie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cie(e){var t=xVe(e,"string");return eE(t)=="symbol"?t:t+""}function xVe(e,t){if(eE(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(eE(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var bVe=function(){function e(){yVe(this,e),pN(this,"activeIndex",0),pN(this,"coordinateList",[]),pN(this,"layout","horizontal")}return _Ve(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,l=a===void 0?null:a,h=r.container,i=h===void 0?null:h,_=r.layout,b=_===void 0?null:_,E=r.offset,C=E===void 0?null:E,I=r.mouseHandlerCallback,F=I===void 0?null:I;this.coordinateList=(n=l??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=b??this.layout,this.offset=C??this.offset,this.mouseHandlerCallback=F??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),l=a.x,h=a.y,i=a.height,_=this.coordinateList[this.activeIndex].coordinate,b=((r=window)===null||r===void 0?void 0:r.scrollX)||0,E=((n=window)===null||n===void 0?void 0:n.scrollY)||0,C=l+_+b,I=h+this.offset.top+i/2+E;this.mouseHandlerCallback({pageX:C,pageY:I})}}}])}();function wVe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Sr(n)&&Sr(a))return!0}return!1}function SVe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Mie(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,l=e.endAngle,h=Za(t,r,n,a),i=Za(t,r,n,l);return{points:[h,i],cx:t,cy:r,radius:n,startAngle:a,endAngle:l}}function TVe(e,t,r){var n,a,l,h;if(e==="horizontal")n=t.x,l=n,a=r.top,h=r.top+r.height;else if(e==="vertical")a=t.y,h=a,n=r.left,l=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,_=t.cy,b=t.innerRadius,E=t.outerRadius,C=t.angle,I=Za(i,_,b,C),F=Za(i,_,E,C);n=I.x,a=I.y,l=F.x,h=F.y}else return Mie(t);return[{x:n,y:a},{x:l,y:h}]}function tE(e){"@babel/helpers - typeof";return tE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tE(e)}function UZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UZ(Object(r),!0).forEach(function(n){EVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EVe(e,t,r){return t=AVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AVe(e){var t=CVe(e,"string");return tE(t)=="symbol"?t:t+""}function CVe(e,t){if(tE(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tE(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MVe(e){var t,r,n=e.element,a=e.tooltipEventType,l=e.isActive,h=e.activeCoordinate,i=e.activePayload,_=e.offset,b=e.activeTooltipIndex,E=e.tooltipAxisBandSize,C=e.layout,I=e.chartName,F=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!F||!l||!h||I!=="ScatterChart"&&a!=="axis")return null;var $,B=US;if(I==="ScatterChart")$=h,B=kBe;else if(I==="BarChart")$=SVe(C,h,_,E),B=M$;else if(C==="radial"){var q=Mie(h),G=q.cx,H=q.cy,J=q.radius,Q=q.startAngle,oe=q.endAngle;$={cx:G,cy:H,startAngle:Q,endAngle:oe,innerRadius:J,outerRadius:J},B=Mne}else $={points:TVe(C,h,_)},B=US;var de=RC(RC(RC(RC({stroke:"#ccc",pointerEvents:"none"},_),$),ti(F,!1)),{},{payload:i,payloadIndex:b,className:gi("recharts-tooltip-cursor",F.className)});return ne.isValidElement(F)?ne.cloneElement(F,de):ne.createElement(B,de)}var PVe=["item"],IVe=["children","className","width","height","style","compact","title","desc"];function Cx(e){"@babel/helpers - typeof";return Cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(e)}function WS(){return WS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WS.apply(this,arguments)}function VZ(e,t){return RVe(e)||kVe(e,t)||Iie(e,t)||OVe()}function OVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(b)throw a}}return i}}function RVe(e){if(Array.isArray(e))return e}function WZ(e,t){if(e==null)return{};var r=DVe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DVe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function LVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NVe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oie(n.key),n)}}function zVe(e,t,r){return t&&NVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jVe(e,t,r){return t=EO(t),FVe(e,Pie()?Reflect.construct(t,r||[],EO(e).constructor):t.apply(e,r))}function FVe(e,t){if(t&&(Cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BVe(e)}function BVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pie=function(){return!!e})()}function EO(e){return EO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},EO(e)}function $Ve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GF(e,t)}function GF(e,t){return GF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},GF(e,t)}function Mx(e){return WVe(e)||VVe(e)||Iie(e)||UVe()}function UVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iie(e,t){if(e){if(typeof e=="string")return qF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qF(e,t)}}function VVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WVe(e){if(Array.isArray(e))return qF(e)}function qF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GZ(Object(r),!0).forEach(function(n){Tn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tn(e,t,r){return t=Oie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oie(e){var t=GVe(e,"string");return Cx(t)=="symbol"?t:t+""}function GVe(e,t){if(Cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qVe={xAxis:["bottom","top"],yAxis:["left","right"]},HVe={width:"100%",height:"100%"},kie={x:0,y:0};function DC(e){return e}var ZVe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},XVe=function(t,r,n,a){var l=r.find(function(E){return E&&E.index===n});if(l){if(t==="horizontal")return{x:l.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:l.coordinate};if(t==="centric"){var h=l.coordinate,i=a.radius;return Ht(Ht(Ht({},a),Za(a.cx,a.cy,i,h)),{},{angle:h,radius:i})}var _=l.coordinate,b=a.angle;return Ht(Ht(Ht({},a),Za(a.cx,a.cy,_,b)),{},{angle:b,radius:_})}return kie},bR=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,l=r.dataEndIndex,h=(n??[]).reduce(function(i,_){var b=_.props.data;return b&&b.length?[].concat(Mx(i),Mx(b)):i},[]);return h.length>0?h:t&&t.length&&Sr(a)&&Sr(l)?t.slice(a,l+1):[]};function Rie(e){return e==="number"?[0,"auto"]:void 0}var HF=function(t,r,n,a){var l=t.graphicalItems,h=t.tooltipAxis,i=bR(r,t);return n<0||!l||!l.length||n>=i.length?null:l.reduce(function(_,b){var E,C=(E=b.props.data)!==null&&E!==void 0?E:r;C&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(C=C.slice(t.dataStartIndex,t.dataEndIndex+1));var I;if(h.dataKey&&!h.allowDuplicatedCategory){var F=C===void 0?i:C;I=CI(F,h.dataKey,a)}else I=C&&C[n]||i[n];return I?[].concat(Mx(_),[Ene(b,I)]):_},[])},qZ=function(t,r,n,a){var l=a||{x:t.chartX,y:t.chartY},h=ZVe(l,n),i=t.orderedTooltipTicks,_=t.tooltipAxis,b=t.tooltipTicks,E=Tje(h,i,b,_);if(E>=0&&b){var C=b[E]&&b[E].value,I=HF(t,r,E,C),F=XVe(n,i,E,l);return{activeTooltipIndex:E,activeLabel:C,activePayload:I,activeCoordinate:F}}return null},YVe=function(t,r){var n=r.axes,a=r.graphicalItems,l=r.axisType,h=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,b=r.dataEndIndex,E=t.layout,C=t.children,I=t.stackOffset,F=wne(E,l);return n.reduce(function($,B){var q,G=B.type.defaultProps!==void 0?Ht(Ht({},B.type.defaultProps),B.props):B.props,H=G.type,J=G.dataKey,Q=G.allowDataOverflow,oe=G.allowDuplicatedCategory,de=G.scale,ae=G.ticks,ve=G.includeHidden,Fe=G[h];if($[Fe])return $;var ke=bR(t.data,{graphicalItems:a.filter(function(Bt){var ct,nr=h in Bt.props?Bt.props[h]:(ct=Bt.type.defaultProps)===null||ct===void 0?void 0:ct[h];return nr===Fe}),dataStartIndex:_,dataEndIndex:b}),Ce=ke.length,je,tt,Ze;wVe(G.domain,Q,H)&&(je=dF(G.domain,null,Q),F&&(H==="number"||de!=="auto")&&(Ze=$S(ke,J,"category")));var Qe=Rie(H);if(!je||je.length===0){var st,ot=(st=G.domain)!==null&&st!==void 0?st:Qe;if(J){if(je=$S(ke,J,H),H==="category"&&F){var Be=hEe(je);oe&&Be?(tt=je,je=hO(0,Ce)):oe||(je=E9(ot,je,B).reduce(function(Bt,ct){return Bt.indexOf(ct)>=0?Bt:[].concat(Mx(Bt),[ct])},[]))}else if(H==="category")oe?je=je.filter(function(Bt){return Bt!==""&&!ui(Bt)}):je=E9(ot,je,B).reduce(function(Bt,ct){return Bt.indexOf(ct)>=0||ct===""||ui(ct)?Bt:[].concat(Mx(Bt),[ct])},[]);else if(H==="number"){var lt=Pje(ke,a.filter(function(Bt){var ct,nr,mr=h in Bt.props?Bt.props[h]:(ct=Bt.type.defaultProps)===null||ct===void 0?void 0:ct[h],ir="hide"in Bt.props?Bt.props.hide:(nr=Bt.type.defaultProps)===null||nr===void 0?void 0:nr.hide;return mr===Fe&&(ve||!ir)}),J,l,E);lt&&(je=lt)}F&&(H==="number"||de!=="auto")&&(Ze=$S(ke,J,"category"))}else F?je=hO(0,Ce):i&&i[Fe]&&i[Fe].hasStack&&H==="number"?je=I==="expand"?[0,1]:Tne(i[Fe].stackGroups,_,b):je=bne(ke,a.filter(function(Bt){var ct=h in Bt.props?Bt.props[h]:Bt.type.defaultProps[h],nr="hide"in Bt.props?Bt.props.hide:Bt.type.defaultProps.hide;return ct===Fe&&(ve||!nr)}),H,E,!0);if(H==="number")je=WF(C,je,Fe,l,ae),ot&&(je=dF(ot,je,Q));else if(H==="category"&&ot){var zt=ot,Lt=je.every(function(Bt){return zt.indexOf(Bt)>=0});Lt&&(je=zt)}}return Ht(Ht({},$),{},Tn({},Fe,Ht(Ht({},G),{},{axisType:l,domain:je,categoricalDomain:Ze,duplicateDomain:tt,originalDomain:(q=G.domain)!==null&&q!==void 0?q:Qe,isCategorical:F,layout:E})))},{})},KVe=function(t,r){var n=r.graphicalItems,a=r.Axis,l=r.axisType,h=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,b=r.dataEndIndex,E=t.layout,C=t.children,I=bR(t.data,{graphicalItems:n,dataStartIndex:_,dataEndIndex:b}),F=I.length,$=wne(E,l),B=-1;return n.reduce(function(q,G){var H=G.type.defaultProps!==void 0?Ht(Ht({},G.type.defaultProps),G.props):G.props,J=H[h],Q=Rie("number");if(!q[J]){B++;var oe;return $?oe=hO(0,F):i&&i[J]&&i[J].hasStack?(oe=Tne(i[J].stackGroups,_,b),oe=WF(C,oe,J,l)):(oe=dF(Q,bne(I,n.filter(function(de){var ae,ve,Fe=h in de.props?de.props[h]:(ae=de.type.defaultProps)===null||ae===void 0?void 0:ae[h],ke="hide"in de.props?de.props.hide:(ve=de.type.defaultProps)===null||ve===void 0?void 0:ve.hide;return Fe===J&&!ke}),"number",E),a.defaultProps.allowDataOverflow),oe=WF(C,oe,J,l)),Ht(Ht({},q),{},Tn({},J,Ht(Ht({axisType:l},a.defaultProps),{},{hide:!0,orientation:Rc(qVe,"".concat(l,".").concat(B%2),null),domain:oe,originalDomain:Q,isCategorical:$,layout:E})))}return q},{})},JVe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,l=r.AxisComp,h=r.graphicalItems,i=r.stackGroups,_=r.dataStartIndex,b=r.dataEndIndex,E=t.children,C="".concat(a,"Id"),I=ku(E,l),F={};return I&&I.length?F=YVe(t,{axes:I,graphicalItems:h,axisType:a,axisIdKey:C,stackGroups:i,dataStartIndex:_,dataEndIndex:b}):h&&h.length&&(F=KVe(t,{Axis:l,graphicalItems:h,axisType:a,axisIdKey:C,stackGroups:i,dataStartIndex:_,dataEndIndex:b})),F},QVe=function(t){var r=Lp(t),n=Dh(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:t$(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:nO(r,n)}},HZ=function(t){var r=t.children,n=t.defaultShowTooltip,a=Wl(r,gx),l=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(l=a.props.startIndex),a.props.endIndex>=0&&(h=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!n}},e8e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Fh(r&&r.type);return n&&n.indexOf("Bar")>=0})},ZZ=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},t8e=function(t,r){var n=t.props,a=t.graphicalItems,l=t.xAxisMap,h=l===void 0?{}:l,i=t.yAxisMap,_=i===void 0?{}:i,b=n.width,E=n.height,C=n.children,I=n.margin||{},F=Wl(C,gx),$=Wl(C,_y),B=Object.keys(_).reduce(function(oe,de){var ae=_[de],ve=ae.orientation;return!ae.mirror&&!ae.hide?Ht(Ht({},oe),{},Tn({},ve,oe[ve]+ae.width)):oe},{left:I.left||0,right:I.right||0}),q=Object.keys(h).reduce(function(oe,de){var ae=h[de],ve=ae.orientation;return!ae.mirror&&!ae.hide?Ht(Ht({},oe),{},Tn({},ve,Rc(oe,"".concat(ve))+ae.height)):oe},{top:I.top||0,bottom:I.bottom||0}),G=Ht(Ht({},q),B),H=G.bottom;F&&(G.bottom+=F.props.height||gx.defaultProps.height),$&&r&&(G=Cje(G,a,n,r));var J=b-G.left-G.right,Q=E-G.top-G.bottom;return Ht(Ht({brushBottom:H},G),{},{width:Math.max(J,0),height:Math.max(Q,0)})},r8e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Die=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,l=a===void 0?"axis":a,h=t.validateTooltipEventTypes,i=h===void 0?["axis"]:h,_=t.axisComponents,b=t.legendContent,E=t.formatAxisMap,C=t.defaultProps,I=function(q,G){var H=G.graphicalItems,J=G.stackGroups,Q=G.offset,oe=G.updateId,de=G.dataStartIndex,ae=G.dataEndIndex,ve=q.barSize,Fe=q.layout,ke=q.barGap,Ce=q.barCategoryGap,je=q.maxBarSize,tt=ZZ(Fe),Ze=tt.numericAxisName,Qe=tt.cateAxisName,st=e8e(H),ot=[];return H.forEach(function(Be,lt){var zt=bR(q.data,{graphicalItems:[Be],dataStartIndex:de,dataEndIndex:ae}),Lt=Be.type.defaultProps!==void 0?Ht(Ht({},Be.type.defaultProps),Be.props):Be.props,Bt=Lt.dataKey,ct=Lt.maxBarSize,nr=Lt["".concat(Ze,"Id")],mr=Lt["".concat(Qe,"Id")],ir={},Ut=_.reduce(function(kt,fr){var dr=G["".concat(fr.axisType,"Map")],ar=Lt["".concat(fr.axisType,"Id")];dr&&dr[ar]||fr.axisType==="zAxis"||Ny();var Yt=dr[ar];return Ht(Ht({},kt),{},Tn(Tn({},fr.axisType,Yt),"".concat(fr.axisType,"Ticks"),Dh(Yt)))},ir),hr=Ut[Qe],Vt=Ut["".concat(Qe,"Ticks")],ge=J&&J[nr]&&J[nr].hasStack&&$je(Be,J[nr].stackGroups),ur=Fh(Be.type).indexOf("Bar")>=0,Ot=nO(hr,Vt),tr=[],xt=st&&Eje({barSize:ve,stackGroups:J,totalSize:r8e(Ut,Qe)});if(ur){var un,Fr,Ln=ui(ct)?je:ct,Ge=(un=(Fr=nO(hr,Vt,!0))!==null&&Fr!==void 0?Fr:Ln)!==null&&un!==void 0?un:0;tr=Aje({barGap:ke,barCategoryGap:Ce,bandSize:Ge!==Ot?Ge:Ot,sizeList:xt[mr],maxBarSize:Ln}),Ge!==Ot&&(tr=tr.map(function(kt){return Ht(Ht({},kt),{},{position:Ht(Ht({},kt.position),{},{offset:kt.position.offset-Ge/2})})}))}var vt=Be&&Be.type&&Be.type.getComposedData;vt&&ot.push({props:Ht(Ht({},vt(Ht(Ht({},Ut),{},{displayedData:zt,props:q,dataKey:Bt,item:Be,bandSize:Ot,barPosition:tr,offset:Q,stackedData:ge,layout:Fe,dataStartIndex:de,dataEndIndex:ae}))),{},Tn(Tn(Tn({key:Be.key||"item-".concat(lt)},Ze,Ut[Ze]),Qe,Ut[Qe]),"animationId",oe)),childIndex:TEe(Be,q.children),item:Be})}),ot},F=function(q,G){var H=q.props,J=q.dataStartIndex,Q=q.dataEndIndex,oe=q.updateId;if(!yH({props:H}))return null;var de=H.children,ae=H.layout,ve=H.stackOffset,Fe=H.data,ke=H.reverseStackOrder,Ce=ZZ(ae),je=Ce.numericAxisName,tt=Ce.cateAxisName,Ze=ku(de,n),Qe=jje(Fe,Ze,"".concat(je,"Id"),"".concat(tt,"Id"),ve,ke),st=_.reduce(function(Lt,Bt){var ct="".concat(Bt.axisType,"Map");return Ht(Ht({},Lt),{},Tn({},ct,JVe(H,Ht(Ht({},Bt),{},{graphicalItems:Ze,stackGroups:Bt.axisType===je&&Qe,dataStartIndex:J,dataEndIndex:Q}))))},{}),ot=t8e(Ht(Ht({},st),{},{props:H,graphicalItems:Ze}),G==null?void 0:G.legendBBox);Object.keys(st).forEach(function(Lt){st[Lt]=E(H,st[Lt],ot,Lt.replace("Map",""),r)});var Be=st["".concat(tt,"Map")],lt=QVe(Be),zt=I(H,Ht(Ht({},st),{},{dataStartIndex:J,dataEndIndex:Q,updateId:oe,graphicalItems:Ze,stackGroups:Qe,offset:ot}));return Ht(Ht({formattedGraphicalItems:zt,graphicalItems:Ze,offset:ot,stackGroups:Qe},lt),st)},$=function(B){function q(G){var H,J,Q;return LVe(this,q),Q=jVe(this,q,[G]),Tn(Q,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Tn(Q,"accessibilityManager",new bVe),Tn(Q,"handleLegendBBoxUpdate",function(oe){if(oe){var de=Q.state,ae=de.dataStartIndex,ve=de.dataEndIndex,Fe=de.updateId;Q.setState(Ht({legendBBox:oe},F({props:Q.props,dataStartIndex:ae,dataEndIndex:ve,updateId:Fe},Ht(Ht({},Q.state),{},{legendBBox:oe}))))}}),Tn(Q,"handleReceiveSyncEvent",function(oe,de,ae){if(Q.props.syncId===oe){if(ae===Q.eventEmitterSymbol&&typeof Q.props.syncMethod!="function")return;Q.applySyncEvent(de)}}),Tn(Q,"handleBrushChange",function(oe){var de=oe.startIndex,ae=oe.endIndex;if(de!==Q.state.dataStartIndex||ae!==Q.state.dataEndIndex){var ve=Q.state.updateId;Q.setState(function(){return Ht({dataStartIndex:de,dataEndIndex:ae},F({props:Q.props,dataStartIndex:de,dataEndIndex:ae,updateId:ve},Q.state))}),Q.triggerSyncEvent({dataStartIndex:de,dataEndIndex:ae})}}),Tn(Q,"handleMouseEnter",function(oe){var de=Q.getMouseInfo(oe);if(de){var ae=Ht(Ht({},de),{},{isTooltipActive:!0});Q.setState(ae),Q.triggerSyncEvent(ae);var ve=Q.props.onMouseEnter;Xn(ve)&&ve(ae,oe)}}),Tn(Q,"triggeredAfterMouseMove",function(oe){var de=Q.getMouseInfo(oe),ae=de?Ht(Ht({},de),{},{isTooltipActive:!0}):{isTooltipActive:!1};Q.setState(ae),Q.triggerSyncEvent(ae);var ve=Q.props.onMouseMove;Xn(ve)&&ve(ae,oe)}),Tn(Q,"handleItemMouseEnter",function(oe){Q.setState(function(){return{isTooltipActive:!0,activeItem:oe,activePayload:oe.tooltipPayload,activeCoordinate:oe.tooltipPosition||{x:oe.cx,y:oe.cy}}})}),Tn(Q,"handleItemMouseLeave",function(){Q.setState(function(){return{isTooltipActive:!1}})}),Tn(Q,"handleMouseMove",function(oe){oe.persist(),Q.throttleTriggeredAfterMouseMove(oe)}),Tn(Q,"handleMouseLeave",function(oe){Q.throttleTriggeredAfterMouseMove.cancel();var de={isTooltipActive:!1};Q.setState(de),Q.triggerSyncEvent(de);var ae=Q.props.onMouseLeave;Xn(ae)&&ae(de,oe)}),Tn(Q,"handleOuterEvent",function(oe){var de=SEe(oe),ae=Rc(Q.props,"".concat(de));if(de&&Xn(ae)){var ve,Fe;/.*touch.*/i.test(de)?Fe=Q.getMouseInfo(oe.changedTouches[0]):Fe=Q.getMouseInfo(oe),ae((ve=Fe)!==null&&ve!==void 0?ve:{},oe)}}),Tn(Q,"handleClick",function(oe){var de=Q.getMouseInfo(oe);if(de){var ae=Ht(Ht({},de),{},{isTooltipActive:!0});Q.setState(ae),Q.triggerSyncEvent(ae);var ve=Q.props.onClick;Xn(ve)&&ve(ae,oe)}}),Tn(Q,"handleMouseDown",function(oe){var de=Q.props.onMouseDown;if(Xn(de)){var ae=Q.getMouseInfo(oe);de(ae,oe)}}),Tn(Q,"handleMouseUp",function(oe){var de=Q.props.onMouseUp;if(Xn(de)){var ae=Q.getMouseInfo(oe);de(ae,oe)}}),Tn(Q,"handleTouchMove",function(oe){oe.changedTouches!=null&&oe.changedTouches.length>0&&Q.throttleTriggeredAfterMouseMove(oe.changedTouches[0])}),Tn(Q,"handleTouchStart",function(oe){oe.changedTouches!=null&&oe.changedTouches.length>0&&Q.handleMouseDown(oe.changedTouches[0])}),Tn(Q,"handleTouchEnd",function(oe){oe.changedTouches!=null&&oe.changedTouches.length>0&&Q.handleMouseUp(oe.changedTouches[0])}),Tn(Q,"triggerSyncEvent",function(oe){Q.props.syncId!==void 0&&hN.emit(fN,Q.props.syncId,oe,Q.eventEmitterSymbol)}),Tn(Q,"applySyncEvent",function(oe){var de=Q.props,ae=de.layout,ve=de.syncMethod,Fe=Q.state.updateId,ke=oe.dataStartIndex,Ce=oe.dataEndIndex;if(oe.dataStartIndex!==void 0||oe.dataEndIndex!==void 0)Q.setState(Ht({dataStartIndex:ke,dataEndIndex:Ce},F({props:Q.props,dataStartIndex:ke,dataEndIndex:Ce,updateId:Fe},Q.state)));else if(oe.activeTooltipIndex!==void 0){var je=oe.chartX,tt=oe.chartY,Ze=oe.activeTooltipIndex,Qe=Q.state,st=Qe.offset,ot=Qe.tooltipTicks;if(!st)return;if(typeof ve=="function")Ze=ve(ot,oe);else if(ve==="value"){Ze=-1;for(var Be=0;Be<ot.length;Be++)if(ot[Be].value===oe.activeLabel){Ze=Be;break}}var lt=Ht(Ht({},st),{},{x:st.left,y:st.top}),zt=Math.min(je,lt.x+lt.width),Lt=Math.min(tt,lt.y+lt.height),Bt=ot[Ze]&&ot[Ze].value,ct=HF(Q.state,Q.props.data,Ze),nr=ot[Ze]?{x:ae==="horizontal"?ot[Ze].coordinate:zt,y:ae==="horizontal"?Lt:ot[Ze].coordinate}:kie;Q.setState(Ht(Ht({},oe),{},{activeLabel:Bt,activeCoordinate:nr,activePayload:ct,activeTooltipIndex:Ze}))}else Q.setState(oe)}),Tn(Q,"renderCursor",function(oe){var de,ae=Q.state,ve=ae.isTooltipActive,Fe=ae.activeCoordinate,ke=ae.activePayload,Ce=ae.offset,je=ae.activeTooltipIndex,tt=ae.tooltipAxisBandSize,Ze=Q.getTooltipEventType(),Qe=(de=oe.props.active)!==null&&de!==void 0?de:ve,st=Q.props.layout,ot=oe.key||"_recharts-cursor";return Ae.createElement(MVe,{key:ot,activeCoordinate:Fe,activePayload:ke,activeTooltipIndex:je,chartName:r,element:oe,isActive:Qe,layout:st,offset:Ce,tooltipAxisBandSize:tt,tooltipEventType:Ze})}),Tn(Q,"renderPolarAxis",function(oe,de,ae){var ve=Rc(oe,"type.axisType"),Fe=Rc(Q.state,"".concat(ve,"Map")),ke=oe.type.defaultProps,Ce=ke!==void 0?Ht(Ht({},ke),oe.props):oe.props,je=Fe&&Fe[Ce["".concat(ve,"Id")]];return ne.cloneElement(oe,Ht(Ht({},je),{},{className:gi(ve,je.className),key:oe.key||"".concat(de,"-").concat(ae),ticks:Dh(je,!0)}))}),Tn(Q,"renderPolarGrid",function(oe){var de=oe.props,ae=de.radialLines,ve=de.polarAngles,Fe=de.polarRadius,ke=Q.state,Ce=ke.radiusAxisMap,je=ke.angleAxisMap,tt=Lp(Ce),Ze=Lp(je),Qe=Ze.cx,st=Ze.cy,ot=Ze.innerRadius,Be=Ze.outerRadius;return ne.cloneElement(oe,{polarAngles:Array.isArray(ve)?ve:Dh(Ze,!0).map(function(lt){return lt.coordinate}),polarRadius:Array.isArray(Fe)?Fe:Dh(tt,!0).map(function(lt){return lt.coordinate}),cx:Qe,cy:st,innerRadius:ot,outerRadius:Be,key:oe.key||"polar-grid",radialLines:ae})}),Tn(Q,"renderLegend",function(){var oe=Q.state.formattedGraphicalItems,de=Q.props,ae=de.children,ve=de.width,Fe=de.height,ke=Q.props.margin||{},Ce=ve-(ke.left||0)-(ke.right||0),je=_ne({children:ae,formattedGraphicalItems:oe,legendWidth:Ce,legendContent:b});if(!je)return null;var tt=je.item,Ze=WZ(je,PVe);return ne.cloneElement(tt,Ht(Ht({},Ze),{},{chartWidth:ve,chartHeight:Fe,margin:ke,onBBoxUpdate:Q.handleLegendBBoxUpdate}))}),Tn(Q,"renderTooltip",function(){var oe,de=Q.props,ae=de.children,ve=de.accessibilityLayer,Fe=Wl(ae,xu);if(!Fe)return null;var ke=Q.state,Ce=ke.isTooltipActive,je=ke.activeCoordinate,tt=ke.activePayload,Ze=ke.activeLabel,Qe=ke.offset,st=(oe=Fe.props.active)!==null&&oe!==void 0?oe:Ce;return ne.cloneElement(Fe,{viewBox:Ht(Ht({},Qe),{},{x:Qe.left,y:Qe.top}),active:st,label:Ze,payload:st?tt:[],coordinate:je,accessibilityLayer:ve})}),Tn(Q,"renderBrush",function(oe){var de=Q.props,ae=de.margin,ve=de.data,Fe=Q.state,ke=Fe.offset,Ce=Fe.dataStartIndex,je=Fe.dataEndIndex,tt=Fe.updateId;return ne.cloneElement(oe,{key:oe.key||"_recharts-brush",onChange:PC(Q.handleBrushChange,oe.props.onChange),data:ve,x:Sr(oe.props.x)?oe.props.x:ke.left,y:Sr(oe.props.y)?oe.props.y:ke.top+ke.height+ke.brushBottom-(ae.bottom||0),width:Sr(oe.props.width)?oe.props.width:ke.width,startIndex:Ce,endIndex:je,updateId:"brush-".concat(tt)})}),Tn(Q,"renderReferenceElement",function(oe,de,ae){if(!oe)return null;var ve=Q,Fe=ve.clipPathId,ke=Q.state,Ce=ke.xAxisMap,je=ke.yAxisMap,tt=ke.offset,Ze=oe.type.defaultProps||{},Qe=oe.props,st=Qe.xAxisId,ot=st===void 0?Ze.xAxisId:st,Be=Qe.yAxisId,lt=Be===void 0?Ze.yAxisId:Be;return ne.cloneElement(oe,{key:oe.key||"".concat(de,"-").concat(ae),xAxis:Ce[ot],yAxis:je[lt],viewBox:{x:tt.left,y:tt.top,width:tt.width,height:tt.height},clipPathId:Fe})}),Tn(Q,"renderActivePoints",function(oe){var de=oe.item,ae=oe.activePoint,ve=oe.basePoint,Fe=oe.childIndex,ke=oe.isRange,Ce=[],je=de.props.key,tt=de.item.type.defaultProps!==void 0?Ht(Ht({},de.item.type.defaultProps),de.item.props):de.item.props,Ze=tt.activeDot,Qe=tt.dataKey,st=Ht(Ht({index:Fe,dataKey:Qe,cx:ae.x,cy:ae.y,r:4,fill:C$(de.item),strokeWidth:2,stroke:"#fff",payload:ae.payload,value:ae.value},ti(Ze,!1)),MI(Ze));return Ce.push(q.renderActiveDot(Ze,st,"".concat(je,"-activePoint-").concat(Fe))),ve?Ce.push(q.renderActiveDot(Ze,Ht(Ht({},st),{},{cx:ve.x,cy:ve.y}),"".concat(je,"-basePoint-").concat(Fe))):ke&&Ce.push(null),Ce}),Tn(Q,"renderGraphicChild",function(oe,de,ae){var ve=Q.filterFormatItem(oe,de,ae);if(!ve)return null;var Fe=Q.getTooltipEventType(),ke=Q.state,Ce=ke.isTooltipActive,je=ke.tooltipAxis,tt=ke.activeTooltipIndex,Ze=ke.activeLabel,Qe=Q.props.children,st=Wl(Qe,xu),ot=ve.props,Be=ot.points,lt=ot.isRange,zt=ot.baseLine,Lt=ve.item.type.defaultProps!==void 0?Ht(Ht({},ve.item.type.defaultProps),ve.item.props):ve.item.props,Bt=Lt.activeDot,ct=Lt.hide,nr=Lt.activeBar,mr=Lt.activeShape,ir=!!(!ct&&Ce&&st&&(Bt||nr||mr)),Ut={};Fe!=="axis"&&st&&st.props.trigger==="click"?Ut={onClick:PC(Q.handleItemMouseEnter,oe.props.onClick)}:Fe!=="axis"&&(Ut={onMouseLeave:PC(Q.handleItemMouseLeave,oe.props.onMouseLeave),onMouseEnter:PC(Q.handleItemMouseEnter,oe.props.onMouseEnter)});var hr=ne.cloneElement(oe,Ht(Ht({},ve.props),Ut));function Vt(fr){return typeof je.dataKey=="function"?je.dataKey(fr.payload):null}if(ir)if(tt>=0){var ge,ur;if(je.dataKey&&!je.allowDuplicatedCategory){var Ot=typeof je.dataKey=="function"?Vt:"payload.".concat(je.dataKey.toString());ge=CI(Be,Ot,Ze),ur=lt&&zt&&CI(zt,Ot,Ze)}else ge=Be==null?void 0:Be[tt],ur=lt&&zt&&zt[tt];if(mr||nr){var tr=oe.props.activeIndex!==void 0?oe.props.activeIndex:tt;return[ne.cloneElement(oe,Ht(Ht(Ht({},ve.props),Ut),{},{activeIndex:tr})),null,null]}if(!ui(ge))return[hr].concat(Mx(Q.renderActivePoints({item:ve,activePoint:ge,basePoint:ur,childIndex:tt,isRange:lt})))}else{var xt,un=(xt=Q.getItemByXY(Q.state.activeCoordinate))!==null&&xt!==void 0?xt:{graphicalItem:hr},Fr=un.graphicalItem,Ln=Fr.item,Ge=Ln===void 0?oe:Ln,vt=Fr.childIndex,kt=Ht(Ht(Ht({},ve.props),Ut),{},{activeIndex:vt});return[ne.cloneElement(Ge,kt),null,null]}return lt?[hr,null,null]:[hr,null]}),Tn(Q,"renderCustomized",function(oe,de,ae){return ne.cloneElement(oe,Ht(Ht({key:"recharts-customized-".concat(ae)},Q.props),Q.state))}),Tn(Q,"renderMap",{CartesianGrid:{handler:DC,once:!0},ReferenceArea:{handler:Q.renderReferenceElement},ReferenceLine:{handler:DC},ReferenceDot:{handler:Q.renderReferenceElement},XAxis:{handler:DC},YAxis:{handler:DC},Brush:{handler:Q.renderBrush,once:!0},Bar:{handler:Q.renderGraphicChild},Line:{handler:Q.renderGraphicChild},Area:{handler:Q.renderGraphicChild},Radar:{handler:Q.renderGraphicChild},RadialBar:{handler:Q.renderGraphicChild},Scatter:{handler:Q.renderGraphicChild},Pie:{handler:Q.renderGraphicChild},Funnel:{handler:Q.renderGraphicChild},Tooltip:{handler:Q.renderCursor,once:!0},PolarGrid:{handler:Q.renderPolarGrid,once:!0},PolarAngleAxis:{handler:Q.renderPolarAxis},PolarRadiusAxis:{handler:Q.renderPolarAxis},Customized:{handler:Q.renderCustomized}}),Q.clipPathId="".concat((H=G.id)!==null&&H!==void 0?H:LE("recharts"),"-clip"),Q.throttleTriggeredAfterMouseMove=vre(Q.triggeredAfterMouseMove,(J=G.throttleDelay)!==null&&J!==void 0?J:1e3/60),Q.state={},Q}return $Ve(q,B),zVe(q,[{key:"componentDidMount",value:function(){var H,J;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(H=this.props.margin.left)!==null&&H!==void 0?H:0,top:(J=this.props.margin.top)!==null&&J!==void 0?J:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var H=this.props,J=H.children,Q=H.data,oe=H.height,de=H.layout,ae=Wl(J,xu);if(ae){var ve=ae.props.defaultIndex;if(!(typeof ve!="number"||ve<0||ve>this.state.tooltipTicks.length-1)){var Fe=this.state.tooltipTicks[ve]&&this.state.tooltipTicks[ve].value,ke=HF(this.state,Q,ve,Fe),Ce=this.state.tooltipTicks[ve].coordinate,je=(this.state.offset.top+oe)/2,tt=de==="horizontal",Ze=tt?{x:Ce,y:je}:{y:Ce,x:je},Qe=this.state.formattedGraphicalItems.find(function(ot){var Be=ot.item;return Be.type.name==="Scatter"});Qe&&(Ze=Ht(Ht({},Ze),Qe.props.points[ve].tooltipPosition),ke=Qe.props.points[ve].tooltipPayload);var st={activeTooltipIndex:ve,isTooltipActive:!0,activeLabel:Fe,activePayload:ke,activeCoordinate:Ze};this.setState(st),this.renderCursor(ae),this.accessibilityManager.setIndex(ve)}}}},{key:"getSnapshotBeforeUpdate",value:function(H,J){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==J.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==H.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==H.margin){var Q,oe;this.accessibilityManager.setDetails({offset:{left:(Q=this.props.margin.left)!==null&&Q!==void 0?Q:0,top:(oe=this.props.margin.top)!==null&&oe!==void 0?oe:0}})}return null}},{key:"componentDidUpdate",value:function(H){Aj([Wl(H.children,xu)],[Wl(this.props.children,xu)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var H=Wl(this.props.children,xu);if(H&&typeof H.props.shared=="boolean"){var J=H.props.shared?"axis":"item";return i.indexOf(J)>=0?J:l}return l}},{key:"getMouseInfo",value:function(H){if(!this.container)return null;var J=this.container,Q=J.getBoundingClientRect(),oe=YDe(Q),de={chartX:Math.round(H.pageX-oe.left),chartY:Math.round(H.pageY-oe.top)},ae=Q.width/J.offsetWidth||1,ve=this.inRange(de.chartX,de.chartY,ae);if(!ve)return null;var Fe=this.state,ke=Fe.xAxisMap,Ce=Fe.yAxisMap,je=this.getTooltipEventType();if(je!=="axis"&&ke&&Ce){var tt=Lp(ke).scale,Ze=Lp(Ce).scale,Qe=tt&&tt.invert?tt.invert(de.chartX):null,st=Ze&&Ze.invert?Ze.invert(de.chartY):null;return Ht(Ht({},de),{},{xValue:Qe,yValue:st})}var ot=qZ(this.state,this.props.data,this.props.layout,ve);return ot?Ht(Ht({},de),ot):null}},{key:"inRange",value:function(H,J){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,oe=this.props.layout,de=H/Q,ae=J/Q;if(oe==="horizontal"||oe==="vertical"){var ve=this.state.offset,Fe=de>=ve.left&&de<=ve.left+ve.width&&ae>=ve.top&&ae<=ve.top+ve.height;return Fe?{x:de,y:ae}:null}var ke=this.state,Ce=ke.angleAxisMap,je=ke.radiusAxisMap;if(Ce&&je){var tt=Lp(Ce);return M9({x:de,y:ae},tt)}return null}},{key:"parseEventsOfWrapper",value:function(){var H=this.props.children,J=this.getTooltipEventType(),Q=Wl(H,xu),oe={};Q&&J==="axis"&&(Q.props.trigger==="click"?oe={onClick:this.handleClick}:oe={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var de=MI(this.props,this.handleOuterEvent);return Ht(Ht({},de),oe)}},{key:"addListener",value:function(){hN.on(fN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){hN.removeListener(fN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(H,J,Q){for(var oe=this.state.formattedGraphicalItems,de=0,ae=oe.length;de<ae;de++){var ve=oe[de];if(ve.item===H||ve.props.key===H.key||J===Fh(ve.item.type)&&Q===ve.childIndex)return ve}return null}},{key:"renderClipPath",value:function(){var H=this.clipPathId,J=this.state.offset,Q=J.left,oe=J.top,de=J.height,ae=J.width;return Ae.createElement("defs",null,Ae.createElement("clipPath",{id:H},Ae.createElement("rect",{x:Q,y:oe,height:de,width:ae})))}},{key:"getXScales",value:function(){var H=this.state.xAxisMap;return H?Object.entries(H).reduce(function(J,Q){var oe=VZ(Q,2),de=oe[0],ae=oe[1];return Ht(Ht({},J),{},Tn({},de,ae.scale))},{}):null}},{key:"getYScales",value:function(){var H=this.state.yAxisMap;return H?Object.entries(H).reduce(function(J,Q){var oe=VZ(Q,2),de=oe[0],ae=oe[1];return Ht(Ht({},J),{},Tn({},de,ae.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(H){var J;return(J=this.state.xAxisMap)===null||J===void 0||(J=J[H])===null||J===void 0?void 0:J.scale}},{key:"getYScaleByAxisId",value:function(H){var J;return(J=this.state.yAxisMap)===null||J===void 0||(J=J[H])===null||J===void 0?void 0:J.scale}},{key:"getItemByXY",value:function(H){var J=this.state,Q=J.formattedGraphicalItems,oe=J.activeItem;if(Q&&Q.length)for(var de=0,ae=Q.length;de<ae;de++){var ve=Q[de],Fe=ve.props,ke=ve.item,Ce=ke.type.defaultProps!==void 0?Ht(Ht({},ke.type.defaultProps),ke.props):ke.props,je=Fh(ke.type);if(je==="Bar"){var tt=(Fe.data||[]).find(function(ot){return wBe(H,ot)});if(tt)return{graphicalItem:ve,payload:tt}}else if(je==="RadialBar"){var Ze=(Fe.data||[]).find(function(ot){return M9(H,ot)});if(Ze)return{graphicalItem:ve,payload:Ze}}else if(pR(ve,oe)||mR(ve,oe)||XT(ve,oe)){var Qe=E5e({graphicalItem:ve,activeTooltipItem:oe,itemData:Ce.data}),st=Ce.activeIndex===void 0?Qe:Ce.activeIndex;return{graphicalItem:Ht(Ht({},ve),{},{childIndex:st}),payload:XT(ve,oe)?Ce.data[Qe]:ve.props.data[Qe]}}}return null}},{key:"render",value:function(){var H=this;if(!yH(this))return null;var J=this.props,Q=J.children,oe=J.className,de=J.width,ae=J.height,ve=J.style,Fe=J.compact,ke=J.title,Ce=J.desc,je=WZ(J,IVe),tt=ti(je,!1);if(Fe)return Ae.createElement(AZ,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ae.createElement(Mj,WS({},tt,{width:de,height:ae,title:ke,desc:Ce}),this.renderClipPath(),_H(Q,this.renderMap)));if(this.props.accessibilityLayer){var Ze,Qe;tt.tabIndex=(Ze=this.props.tabIndex)!==null&&Ze!==void 0?Ze:0,tt.role=(Qe=this.props.role)!==null&&Qe!==void 0?Qe:"application",tt.onKeyDown=function(ot){H.accessibilityManager.keyboardEvent(ot)},tt.onFocus=function(){H.accessibilityManager.focus()}}var st=this.parseEventsOfWrapper();return Ae.createElement(AZ,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ae.createElement("div",WS({className:gi("recharts-wrapper",oe),style:Ht({position:"relative",cursor:"default",width:de,height:ae},ve)},st,{ref:function(Be){H.container=Be}}),Ae.createElement(Mj,WS({},tt,{width:de,height:ae,title:ke,desc:Ce,style:HVe}),this.renderClipPath(),_H(Q,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(ne.Component);return Tn($,"displayName",r),Tn($,"defaultProps",Ht({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},C)),Tn($,"getDerivedStateFromProps",function(B,q){var G=B.dataKey,H=B.data,J=B.children,Q=B.width,oe=B.height,de=B.layout,ae=B.stackOffset,ve=B.margin,Fe=q.dataStartIndex,ke=q.dataEndIndex;if(q.updateId===void 0){var Ce=HZ(B);return Ht(Ht(Ht({},Ce),{},{updateId:0},F(Ht(Ht({props:B},Ce),{},{updateId:0}),q)),{},{prevDataKey:G,prevData:H,prevWidth:Q,prevHeight:oe,prevLayout:de,prevStackOffset:ae,prevMargin:ve,prevChildren:J})}if(G!==q.prevDataKey||H!==q.prevData||Q!==q.prevWidth||oe!==q.prevHeight||de!==q.prevLayout||ae!==q.prevStackOffset||!C0(ve,q.prevMargin)){var je=HZ(B),tt={chartX:q.chartX,chartY:q.chartY,isTooltipActive:q.isTooltipActive},Ze=Ht(Ht({},qZ(q,H,de)),{},{updateId:q.updateId+1}),Qe=Ht(Ht(Ht({},je),tt),Ze);return Ht(Ht(Ht({},Qe),F(Ht({props:B},Qe),q)),{},{prevDataKey:G,prevData:H,prevWidth:Q,prevHeight:oe,prevLayout:de,prevStackOffset:ae,prevMargin:ve,prevChildren:J})}if(!Aj(J,q.prevChildren)){var st,ot,Be,lt,zt=Wl(J,gx),Lt=zt&&(st=(ot=zt.props)===null||ot===void 0?void 0:ot.startIndex)!==null&&st!==void 0?st:Fe,Bt=zt&&(Be=(lt=zt.props)===null||lt===void 0?void 0:lt.endIndex)!==null&&Be!==void 0?Be:ke,ct=Lt!==Fe||Bt!==ke,nr=!ui(H),mr=nr&&!ct?q.updateId:q.updateId+1;return Ht(Ht({updateId:mr},F(Ht(Ht({props:B},q),{},{updateId:mr,dataStartIndex:Lt,dataEndIndex:Bt}),q)),{},{prevChildren:J,dataStartIndex:Lt,dataEndIndex:Bt})}return null}),Tn($,"renderActiveDot",function(B,q,G){var H;return ne.isValidElement(B)?H=ne.cloneElement(B,q):Xn(B)?H=B(q):H=Ae.createElement(P$,q),Ae.createElement(Io,{className:"recharts-active-dot",key:G},H)}),function(q){return Ae.createElement($,q)}},n8e=Die({chartName:"BarChart",GraphicalChild:bm,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Tx},{axisType:"yAxis",AxisComp:Ax}],formatAxisMap:Yne}),i8e=Die({chartName:"AreaChart",GraphicalChild:of,axisComponents:[{axisType:"xAxis",AxisComp:Tx},{axisType:"yAxis",AxisComp:Ax}],formatAxisMap:Yne});const LC=({title:e,value:t,icon:r,change:n,changeType:a="neutral",variant:l="default",className:h})=>j.jsxs("div",{className:Tr("stats-card flex items-start",l==="outline"&&"border-2",h),children:[j.jsxs("div",{className:"flex-1",children:[j.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:e}),j.jsxs("div",{className:"mt-1 flex items-baseline",children:[j.jsx("p",{className:"text-2xl font-semibold",children:t}),n&&j.jsx("span",{className:Tr("ml-2 text-sm",a==="positive"&&"text-green-600",a==="negative"&&"text-red-600",a==="neutral"&&"text-gray-500"),children:n})]})]}),j.jsx("div",{className:Tr("rounded-md p-2",l==="default"&&"bg-primary/10 text-primary"),children:j.jsx(r,{className:"h-5 w-5"})})]}),NC=({icon:e,title:t,description:r,time:n,status:a="default"})=>j.jsxs("div",{className:"flex items-start space-x-3 py-3",children:[j.jsx("div",{className:Tr("rounded-full p-2 flex-shrink-0",a==="default"&&"bg-primary/10 text-primary",a==="success"&&"bg-green-100 text-green-600",a==="warning"&&"bg-amber-100 text-amber-600",a==="error"&&"bg-red-100 text-red-600"),children:j.jsx(e,{className:"h-4 w-4"})}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsx("p",{className:"text-sm font-medium",children:t}),j.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:r})]}),j.jsx("div",{className:"text-xs text-muted-foreground",children:n})]}),o8e={pending:{icon:Lge,bgColor:"bg-amber-100",textColor:"text-amber-600"},active:{icon:SQ,bgColor:"bg-red-100",textColor:"text-red-600"},resolved:{icon:Rge,bgColor:"bg-green-100",textColor:"text-green-600"}},zC=({title:e,message:t,time:r,status:n})=>{const{icon:a,bgColor:l,textColor:h}=o8e[n];return j.jsxs("div",{className:"flex items-start space-x-3 py-3",children:[j.jsx("div",{className:Tr("rounded-full p-2 flex-shrink-0",l,h),children:j.jsx(a,{className:"h-4 w-4"})}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("p",{className:"text-sm font-medium",children:e}),j.jsx("span",{className:Tr("text-xs px-2 py-0.5 rounded",n==="pending"&&"bg-amber-100 text-amber-600",n==="active"&&"bg-red-100 text-red-600",n==="resolved"&&"bg-green-100 text-green-600"),children:n.charAt(0).toUpperCase()+n.slice(1)})]}),j.jsx("p",{className:"text-sm text-muted-foreground",children:t}),j.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r})]})]})},a8e=[{name:"Lun",orders:40,deliveries:24},{name:"Mar",orders:30,deliveries:28},{name:"Mie",orders:20,deliveries:19},{name:"Jue",orders:27,deliveries:25},{name:"Vie",orders:18,deliveries:15},{name:"Sab",orders:23,deliveries:20},{name:"Dom",orders:34,deliveries:30}],s8e=[{name:"Conductor A",entregas:95,meta:85},{name:"Conductor B",entregas:75,meta:85},{name:"Conductor C",entregas:90,meta:85},{name:"Conductor D",entregas:100,meta:85},{name:"Conductor E",entregas:82,meta:85}],l8e=()=>j.jsxs("div",{className:"space-y-6 animate-fade-in",children:[j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard"}),j.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[j.jsx(Pge,{className:"h-4 w-4"}),j.jsx("span",{children:new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[j.jsx(LC,{title:"Órdenes totales",value:"1,349",icon:w0,change:"+12.5%",changeType:"positive"}),j.jsx(LC,{title:"Entregas completadas",value:"892",icon:fT,change:"+8.2%",changeType:"positive"}),j.jsx(LC,{title:"Conductores activos",value:"18",icon:pq,change:"-2",changeType:"negative"}),j.jsx(LC,{title:"Alertas activas",value:"5",icon:Wge,change:"+3",changeType:"negative"})]}),j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[j.jsxs("div",{className:"chart-container",children:[j.jsx("h2",{className:"text-lg font-medium mb-3",children:"Órdenes vs Entregas"}),j.jsx("div",{className:"h-64",children:j.jsx(g7,{width:"100%",height:"100%",children:j.jsxs(i8e,{data:a8e,margin:{top:10,right:30,left:0,bottom:0},children:[j.jsx(zF,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),j.jsx(Tx,{dataKey:"name"}),j.jsx(Ax,{}),j.jsx(xu,{}),j.jsx(of,{type:"monotone",dataKey:"orders",stackId:"1",stroke:"#3b82f6",fill:"#93c5fd"}),j.jsx(of,{type:"monotone",dataKey:"deliveries",stackId:"2",stroke:"#059669",fill:"#6ee7b7"})]})})})]}),j.jsxs("div",{className:"chart-container",children:[j.jsx("h2",{className:"text-lg font-medium mb-3",children:"Desempeño de Conductores"}),j.jsx("div",{className:"h-64",children:j.jsx(g7,{width:"100%",height:"100%",children:j.jsxs(n8e,{data:s8e,margin:{top:10,right:30,left:0,bottom:0},children:[j.jsx(zF,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),j.jsx(Tx,{dataKey:"name"}),j.jsx(Ax,{}),j.jsx(xu,{}),j.jsx(_y,{}),j.jsx(bm,{dataKey:"entregas",fill:"#3b82f6"}),j.jsx(bm,{dataKey:"meta",fill:"#e11d48"})]})})})]})]}),j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[j.jsxs("div",{className:"stats-card",children:[j.jsxs("div",{className:"flex items-center justify-between mb-4",children:[j.jsx("h2",{className:"text-lg font-medium",children:"Actividad Reciente"}),j.jsxs("button",{className:"text-primary text-sm hover:underline flex items-center",children:["Ver todo ",j.jsx(i5,{className:"h-4 w-4 ml-1"})]})]}),j.jsxs("div",{className:"divide-y",children:[j.jsx(NC,{icon:w0,title:"Nueva orden creada",description:"Pedido #12458 - Cliente: Comercial XYZ",time:"Hace 10 min",status:"default"}),j.jsx(NC,{icon:fT,title:"Entrega completada",description:"Pedido #12445 - Entregado por Juan Pérez",time:"Hace 25 min",status:"success"}),j.jsx(NC,{icon:pq,title:"Conductor asignado",description:"María López asignada a Ruta #R-124",time:"Hace 40 min",status:"default"}),j.jsx(NC,{icon:w0,title:"Paquete en ruta",description:"Pedido #12452 - En camino a destino",time:"Hace 1 hora",status:"default"})]})]}),j.jsxs("div",{className:"stats-card",children:[j.jsxs("div",{className:"flex items-center justify-between mb-4",children:[j.jsx("h2",{className:"text-lg font-medium",children:"Alertas Activas"}),j.jsx("span",{className:"bg-red-100 text-red-600 text-xs px-2 py-1 rounded-full",children:"5 alertas"})]}),j.jsxs("div",{className:"divide-y",children:[j.jsx(zC,{title:"Retraso en entrega",message:"Pedido #12449 retrasado por más de 1 hora",time:"Hace 35 min",status:"active"}),j.jsx(zC,{title:"Bajo inventario",message:"Producto SKU-45678 por debajo del nivel mínimo",time:"Hace 1 hora",status:"pending"}),j.jsx(zC,{title:"Vehículo detenido",message:"Unidad VH-003 detenida por más de 30 min",time:"Hace 50 min",status:"active"}),j.jsx(zC,{title:"Conductor fuera de ruta",message:"Conductor ID-78 se ha desviado de la ruta asignada",time:"Hace 15 min",status:"active"})]})]})]})]}),F$=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{className:"relative w-full overflow-auto",children:j.jsx("table",{ref:r,className:Tr("w-full caption-bottom text-sm",e),...t})}));F$.displayName="Table";const B$=ne.forwardRef(({className:e,...t},r)=>j.jsx("thead",{ref:r,className:Tr("[&_tr]:border-b",e),...t}));B$.displayName="TableHeader";const $$=ne.forwardRef(({className:e,...t},r)=>j.jsx("tbody",{ref:r,className:Tr("[&_tr:last-child]:border-0",e),...t}));$$.displayName="TableBody";const c8e=ne.forwardRef(({className:e,...t},r)=>j.jsx("tfoot",{ref:r,className:Tr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));c8e.displayName="TableFooter";const ay=ne.forwardRef(({className:e,...t},r)=>j.jsx("tr",{ref:r,className:Tr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ay.displayName="TableRow";const Hl=ne.forwardRef(({className:e,...t},r)=>j.jsx("th",{ref:r,className:Tr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Hl.displayName="TableHead";const Ns=ne.forwardRef(({className:e,...t},r)=>j.jsx("td",{ref:r,className:Tr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ns.displayName="TableCell";const u8e=ne.forwardRef(({className:e,...t},r)=>j.jsx("caption",{ref:r,className:Tr("mt-4 text-sm text-muted-foreground",e),...t}));u8e.displayName="TableCaption";function XZ(e,[t,r]){return Math.min(r,Math.max(t,e))}var d8e=ne.createContext(void 0);function wR(e){const t=ne.useContext(d8e);return e||t||"ltr"}var mN=0;function U$(){ne.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??YZ()),document.body.insertAdjacentElement("beforeend",e[1]??YZ()),mN++,()=>{mN===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),mN--}},[])}function YZ(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var gN="focusScope.autoFocusOnMount",yN="focusScope.autoFocusOnUnmount",KZ={bubbles:!1,cancelable:!0},h8e="FocusScope",SR=ne.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...h}=e,[i,_]=ne.useState(null),b=Al(a),E=Al(l),C=ne.useRef(null),I=Ci(t,B=>_(B)),F=ne.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;ne.useEffect(()=>{if(n){let B=function(J){if(F.paused||!i)return;const Q=J.target;i.contains(Q)?C.current=Q:bp(C.current,{select:!0})},q=function(J){if(F.paused||!i)return;const Q=J.relatedTarget;Q!==null&&(i.contains(Q)||bp(C.current,{select:!0}))},G=function(J){if(document.activeElement===document.body)for(const oe of J)oe.removedNodes.length>0&&bp(i)};document.addEventListener("focusin",B),document.addEventListener("focusout",q);const H=new MutationObserver(G);return i&&H.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",B),document.removeEventListener("focusout",q),H.disconnect()}}},[n,i,F.paused]),ne.useEffect(()=>{if(i){QZ.add(F);const B=document.activeElement;if(!i.contains(B)){const G=new CustomEvent(gN,KZ);i.addEventListener(gN,b),i.dispatchEvent(G),G.defaultPrevented||(f8e(v8e(Lie(i)),{select:!0}),document.activeElement===B&&bp(i))}return()=>{i.removeEventListener(gN,b),setTimeout(()=>{const G=new CustomEvent(yN,KZ);i.addEventListener(yN,E),i.dispatchEvent(G),G.defaultPrevented||bp(B??document.body,{select:!0}),i.removeEventListener(yN,E),QZ.remove(F)},0)}}},[i,b,E,F]);const $=ne.useCallback(B=>{if(!r&&!n||F.paused)return;const q=B.key==="Tab"&&!B.altKey&&!B.ctrlKey&&!B.metaKey,G=document.activeElement;if(q&&G){const H=B.currentTarget,[J,Q]=p8e(H);J&&Q?!B.shiftKey&&G===Q?(B.preventDefault(),r&&bp(J,{select:!0})):B.shiftKey&&G===J&&(B.preventDefault(),r&&bp(Q,{select:!0})):G===H&&B.preventDefault()}},[r,n,F.paused]);return j.jsx(Mn.div,{tabIndex:-1,...h,ref:I,onKeyDown:$})});SR.displayName=h8e;function f8e(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(bp(n,{select:t}),document.activeElement!==r)return}function p8e(e){const t=Lie(e),r=JZ(t,e),n=JZ(t.reverse(),e);return[r,n]}function Lie(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function JZ(e,t){for(const r of e)if(!m8e(r,{upTo:t}))return r}function m8e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function g8e(e){return e instanceof HTMLInputElement&&"select"in e}function bp(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&g8e(e)&&t&&e.select()}}var QZ=y8e();function y8e(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=eX(e,t),e.unshift(t)},remove(t){var r;e=eX(e,t),(r=e[0])==null||r.resume()}}}function eX(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function v8e(e){return e.filter(t=>t.tagName!=="A")}function V$(e){const t=ne.useRef({value:e,previous:e});return ne.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var _8e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},T_=new WeakMap,jC=new WeakMap,FC={},vN=0,Nie=function(e){return e&&(e.host||Nie(e.parentNode))},x8e=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=Nie(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},b8e=function(e,t,r,n){var a=x8e(t,Array.isArray(e)?e:[e]);FC[r]||(FC[r]=new WeakMap);var l=FC[r],h=[],i=new Set,_=new Set(a),b=function(C){!C||i.has(C)||(i.add(C),b(C.parentNode))};a.forEach(b);var E=function(C){!C||_.has(C)||Array.prototype.forEach.call(C.children,function(I){if(i.has(I))E(I);else try{var F=I.getAttribute(n),$=F!==null&&F!=="false",B=(T_.get(I)||0)+1,q=(l.get(I)||0)+1;T_.set(I,B),l.set(I,q),h.push(I),B===1&&$&&jC.set(I,!0),q===1&&I.setAttribute(r,"true"),$||I.setAttribute(n,"true")}catch(G){console.error("aria-hidden: cannot operate on ",I,G)}})};return E(t),i.clear(),vN++,function(){h.forEach(function(C){var I=T_.get(C)-1,F=l.get(C)-1;T_.set(C,I),l.set(C,F),I||(jC.has(C)||C.removeAttribute(n),jC.delete(C)),F||C.removeAttribute(r)}),vN--,vN||(T_=new WeakMap,T_=new WeakMap,jC=new WeakMap,FC={})}},W$=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=_8e(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),b8e(n,a,r,"aria-hidden")):function(){return null}},Ad=function(){return Ad=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Ad.apply(this,arguments)};function zie(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function w8e(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var hM="right-scroll-bar-position",fM="width-before-scroll-bar",S8e="with-scroll-bars-hidden",T8e="--removed-body-scroll-bar-size";function _N(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function E8e(e,t){var r=ne.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var A8e=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,tX=new WeakMap;function C8e(e,t){var r=E8e(null,function(n){return e.forEach(function(a){return _N(a,n)})});return A8e(function(){var n=tX.get(r);if(n){var a=new Set(n),l=new Set(e),h=r.current;a.forEach(function(i){l.has(i)||_N(i,null)}),l.forEach(function(i){a.has(i)||_N(i,h)})}tX.set(r,e)},[e]),r}function M8e(e){return e}function P8e(e,t){t===void 0&&(t=M8e);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(l){var h=t(l,n);return r.push(h),function(){r=r.filter(function(i){return i!==h})}},assignSyncMedium:function(l){for(n=!0;r.length;){var h=r;r=[],h.forEach(l)}r={push:function(i){return l(i)},filter:function(){return r}}},assignMedium:function(l){n=!0;var h=[];if(r.length){var i=r;r=[],i.forEach(l),h=r}var _=function(){var E=h;h=[],E.forEach(l)},b=function(){return Promise.resolve().then(_)};b(),r={push:function(E){h.push(E),b()},filter:function(E){return h=h.filter(E),r}}}};return a}function I8e(e){e===void 0&&(e={});var t=P8e(null);return t.options=Ad({async:!0,ssr:!1},e),t}var jie=function(e){var t=e.sideCar,r=zie(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return ne.createElement(n,Ad({},r))};jie.isSideCarExport=!0;function O8e(e,t){return e.useMedium(t),jie}var Fie=I8e(),xN=function(){},TR=ne.forwardRef(function(e,t){var r=ne.useRef(null),n=ne.useState({onScrollCapture:xN,onWheelCapture:xN,onTouchMoveCapture:xN}),a=n[0],l=n[1],h=e.forwardProps,i=e.children,_=e.className,b=e.removeScrollBar,E=e.enabled,C=e.shards,I=e.sideCar,F=e.noIsolation,$=e.inert,B=e.allowPinchZoom,q=e.as,G=q===void 0?"div":q,H=e.gapMode,J=zie(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Q=I,oe=C8e([r,t]),de=Ad(Ad({},J),a);return ne.createElement(ne.Fragment,null,E&&ne.createElement(Q,{sideCar:Fie,removeScrollBar:b,shards:C,noIsolation:F,inert:$,setCallbacks:l,allowPinchZoom:!!B,lockRef:r,gapMode:H}),h?ne.cloneElement(ne.Children.only(i),Ad(Ad({},de),{ref:oe})):ne.createElement(G,Ad({},de,{className:_,ref:oe}),i))});TR.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};TR.classNames={fullWidth:fM,zeroRight:hM};var k8e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function R8e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=k8e();return t&&e.setAttribute("nonce",t),e}function D8e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function L8e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var N8e=function(){var e=0,t=null;return{add:function(r){e==0&&(t=R8e())&&(D8e(t,r),L8e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},z8e=function(){var e=N8e();return function(t,r){ne.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Bie=function(){var e=z8e(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},j8e={left:0,top:0,right:0,gap:0},bN=function(e){return parseInt(e||"",10)||0},F8e=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[bN(r),bN(n),bN(a)]},B8e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return j8e;var t=F8e(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},$8e=Bie(),I0="data-scroll-locked",U8e=function(e,t,r,n){var a=e.left,l=e.top,h=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(S8e,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(I0,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hM,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(fM,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(hM," .").concat(hM,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(fM," .").concat(fM,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(I0,`] {
    `).concat(T8e,": ").concat(i,`px;
  }
`)},rX=function(){var e=parseInt(document.body.getAttribute(I0)||"0",10);return isFinite(e)?e:0},V8e=function(){ne.useEffect(function(){return document.body.setAttribute(I0,(rX()+1).toString()),function(){var e=rX()-1;e<=0?document.body.removeAttribute(I0):document.body.setAttribute(I0,e.toString())}},[])},W8e=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;V8e();var l=ne.useMemo(function(){return B8e(a)},[a]);return ne.createElement($8e,{styles:U8e(l,!t,a,r?"":"!important")})},ZF=!1;if(typeof window<"u")try{var BC=Object.defineProperty({},"passive",{get:function(){return ZF=!0,!0}});window.addEventListener("test",BC,BC),window.removeEventListener("test",BC,BC)}catch{ZF=!1}var E_=ZF?{passive:!1}:!1,G8e=function(e){return e.tagName==="TEXTAREA"},$ie=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!G8e(e)&&r[t]==="visible")},q8e=function(e){return $ie(e,"overflowY")},H8e=function(e){return $ie(e,"overflowX")},nX=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=Uie(e,n);if(a){var l=Vie(e,n),h=l[1],i=l[2];if(h>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Z8e=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},X8e=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Uie=function(e,t){return e==="v"?q8e(t):H8e(t)},Vie=function(e,t){return e==="v"?Z8e(t):X8e(t)},Y8e=function(e,t){return e==="h"&&t==="rtl"?-1:1},K8e=function(e,t,r,n,a){var l=Y8e(e,window.getComputedStyle(t).direction),h=l*n,i=r.target,_=t.contains(i),b=!1,E=h>0,C=0,I=0;do{var F=Vie(e,i),$=F[0],B=F[1],q=F[2],G=B-q-l*$;($||G)&&Uie(e,i)&&(C+=G,I+=$),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!_&&i!==document.body||_&&(t.contains(i)||t===i));return(E&&(Math.abs(C)<1||!a)||!E&&(Math.abs(I)<1||!a))&&(b=!0),b},$C=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},iX=function(e){return[e.deltaX,e.deltaY]},oX=function(e){return e&&"current"in e?e.current:e},J8e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Q8e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},eWe=0,A_=[];function tWe(e){var t=ne.useRef([]),r=ne.useRef([0,0]),n=ne.useRef(),a=ne.useState(eWe++)[0],l=ne.useState(Bie)[0],h=ne.useRef(e);ne.useEffect(function(){h.current=e},[e]),ne.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var B=w8e([e.lockRef.current],(e.shards||[]).map(oX),!0).filter(Boolean);return B.forEach(function(q){return q.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),B.forEach(function(q){return q.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=ne.useCallback(function(B,q){if("touches"in B&&B.touches.length===2||B.type==="wheel"&&B.ctrlKey)return!h.current.allowPinchZoom;var G=$C(B),H=r.current,J="deltaX"in B?B.deltaX:H[0]-G[0],Q="deltaY"in B?B.deltaY:H[1]-G[1],oe,de=B.target,ae=Math.abs(J)>Math.abs(Q)?"h":"v";if("touches"in B&&ae==="h"&&de.type==="range")return!1;var ve=nX(ae,de);if(!ve)return!0;if(ve?oe=ae:(oe=ae==="v"?"h":"v",ve=nX(ae,de)),!ve)return!1;if(!n.current&&"changedTouches"in B&&(J||Q)&&(n.current=oe),!oe)return!0;var Fe=n.current||oe;return K8e(Fe,q,B,Fe==="h"?J:Q,!0)},[]),_=ne.useCallback(function(B){var q=B;if(!(!A_.length||A_[A_.length-1]!==l)){var G="deltaY"in q?iX(q):$C(q),H=t.current.filter(function(oe){return oe.name===q.type&&(oe.target===q.target||q.target===oe.shadowParent)&&J8e(oe.delta,G)})[0];if(H&&H.should){q.cancelable&&q.preventDefault();return}if(!H){var J=(h.current.shards||[]).map(oX).filter(Boolean).filter(function(oe){return oe.contains(q.target)}),Q=J.length>0?i(q,J[0]):!h.current.noIsolation;Q&&q.cancelable&&q.preventDefault()}}},[]),b=ne.useCallback(function(B,q,G,H){var J={name:B,delta:q,target:G,should:H,shadowParent:rWe(G)};t.current.push(J),setTimeout(function(){t.current=t.current.filter(function(Q){return Q!==J})},1)},[]),E=ne.useCallback(function(B){r.current=$C(B),n.current=void 0},[]),C=ne.useCallback(function(B){b(B.type,iX(B),B.target,i(B,e.lockRef.current))},[]),I=ne.useCallback(function(B){b(B.type,$C(B),B.target,i(B,e.lockRef.current))},[]);ne.useEffect(function(){return A_.push(l),e.setCallbacks({onScrollCapture:C,onWheelCapture:C,onTouchMoveCapture:I}),document.addEventListener("wheel",_,E_),document.addEventListener("touchmove",_,E_),document.addEventListener("touchstart",E,E_),function(){A_=A_.filter(function(B){return B!==l}),document.removeEventListener("wheel",_,E_),document.removeEventListener("touchmove",_,E_),document.removeEventListener("touchstart",E,E_)}},[]);var F=e.removeScrollBar,$=e.inert;return ne.createElement(ne.Fragment,null,$?ne.createElement(l,{styles:Q8e(a)}):null,F?ne.createElement(W8e,{gapMode:e.gapMode}):null)}function rWe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const nWe=O8e(Fie,tWe);var ER=ne.forwardRef(function(e,t){return ne.createElement(TR,Ad({},e,{ref:t,sideCar:nWe}))});ER.classNames=TR.classNames;var iWe=[" ","Enter","ArrowUp","ArrowDown"],oWe=[" ","Enter"],$E="Select",[AR,CR,aWe]=JB($E),[pb,OQe]=lf($E,[aWe,Zx]),MR=Zx(),[sWe,Nm]=pb($E),[lWe,cWe]=pb($E),Wie=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:l,value:h,defaultValue:i,onValueChange:_,dir:b,name:E,autoComplete:C,disabled:I,required:F,form:$}=e,B=MR(t),[q,G]=ne.useState(null),[H,J]=ne.useState(null),[Q,oe]=ne.useState(!1),de=wR(b),[ae=!1,ve]=Kh({prop:n,defaultProp:a,onChange:l}),[Fe,ke]=Kh({prop:h,defaultProp:i,onChange:_}),Ce=ne.useRef(null),je=q?$||!!q.closest("form"):!0,[tt,Ze]=ne.useState(new Set),Qe=Array.from(tt).map(st=>st.props.value).join(";");return j.jsx(eee,{...B,children:j.jsxs(sWe,{required:F,scope:t,trigger:q,onTriggerChange:G,valueNode:H,onValueNodeChange:J,valueNodeHasChildren:Q,onValueNodeHasChildrenChange:oe,contentId:jh(),value:Fe,onValueChange:ke,open:ae,onOpenChange:ve,dir:de,triggerPointerDownPosRef:Ce,disabled:I,children:[j.jsx(AR.Provider,{scope:t,children:j.jsx(lWe,{scope:e.__scopeSelect,onNativeOptionAdd:ne.useCallback(st=>{Ze(ot=>new Set(ot).add(st))},[]),onNativeOptionRemove:ne.useCallback(st=>{Ze(ot=>{const Be=new Set(ot);return Be.delete(st),Be})},[]),children:r})}),je?j.jsxs(moe,{"aria-hidden":!0,required:F,tabIndex:-1,name:E,autoComplete:C,value:Fe,onChange:st=>ke(st.target.value),disabled:I,form:$,children:[Fe===void 0?j.jsx("option",{value:""}):null,Array.from(tt)]},Qe):null]})})};Wie.displayName=$E;var Gie="SelectTrigger",qie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,l=MR(r),h=Nm(Gie,r),i=h.disabled||n,_=Ci(t,h.onTriggerChange),b=CR(r),E=ne.useRef("touch"),[C,I,F]=goe(B=>{const q=b().filter(J=>!J.disabled),G=q.find(J=>J.value===h.value),H=yoe(q,B,G);H!==void 0&&h.onValueChange(H.value)}),$=B=>{i||(h.onOpenChange(!0),F()),B&&(h.triggerPointerDownPosRef.current={x:Math.round(B.pageX),y:Math.round(B.pageY)})};return j.jsx(Sk,{asChild:!0,...l,children:j.jsx(Mn.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":poe(h.value)?"":void 0,...a,ref:_,onClick:Kr(a.onClick,B=>{B.currentTarget.focus(),E.current!=="mouse"&&$(B)}),onPointerDown:Kr(a.onPointerDown,B=>{E.current=B.pointerType;const q=B.target;q.hasPointerCapture(B.pointerId)&&q.releasePointerCapture(B.pointerId),B.button===0&&B.ctrlKey===!1&&B.pointerType==="mouse"&&($(B),B.preventDefault())}),onKeyDown:Kr(a.onKeyDown,B=>{const q=C.current!=="";!(B.ctrlKey||B.altKey||B.metaKey)&&B.key.length===1&&I(B.key),!(q&&B.key===" ")&&iWe.includes(B.key)&&($(),B.preventDefault())})})})});qie.displayName=Gie;var Hie="SelectValue",Zie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:l,placeholder:h="",...i}=e,_=Nm(Hie,r),{onValueNodeHasChildrenChange:b}=_,E=l!==void 0,C=Ci(t,_.onValueNodeChange);return ms(()=>{b(E)},[b,E]),j.jsx(Mn.span,{...i,ref:C,style:{pointerEvents:"none"},children:poe(_.value)?j.jsx(j.Fragment,{children:h}):l})});Zie.displayName=Hie;var uWe="SelectIcon",Xie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return j.jsx(Mn.span,{"aria-hidden":!0,...a,ref:t,children:n||"▼"})});Xie.displayName=uWe;var dWe="SelectPortal",Yie=e=>j.jsx(ME,{asChild:!0,...e});Yie.displayName=dWe;var jy="SelectContent",Kie=ne.forwardRef((e,t)=>{const r=Nm(jy,e.__scopeSelect),[n,a]=ne.useState();if(ms(()=>{a(new DocumentFragment)},[]),!r.open){const l=n;return l?Zy.createPortal(j.jsx(Jie,{scope:e.__scopeSelect,children:j.jsx(AR.Slot,{scope:e.__scopeSelect,children:j.jsx("div",{children:e.children})})}),l):null}return j.jsx(Qie,{...e,ref:t})});Kie.displayName=jy;var mu=10,[Jie,zm]=pb(jy),hWe="SelectContentImpl",Qie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:h,side:i,sideOffset:_,align:b,alignOffset:E,arrowPadding:C,collisionBoundary:I,collisionPadding:F,sticky:$,hideWhenDetached:B,avoidCollisions:q,...G}=e,H=Nm(jy,r),[J,Q]=ne.useState(null),[oe,de]=ne.useState(null),ae=Ci(t,Ut=>Q(Ut)),[ve,Fe]=ne.useState(null),[ke,Ce]=ne.useState(null),je=CR(r),[tt,Ze]=ne.useState(!1),Qe=ne.useRef(!1);ne.useEffect(()=>{if(J)return W$(J)},[J]),U$();const st=ne.useCallback(Ut=>{const[hr,...Vt]=je().map(Ot=>Ot.ref.current),[ge]=Vt.slice(-1),ur=document.activeElement;for(const Ot of Ut)if(Ot===ur||(Ot==null||Ot.scrollIntoView({block:"nearest"}),Ot===hr&&oe&&(oe.scrollTop=0),Ot===ge&&oe&&(oe.scrollTop=oe.scrollHeight),Ot==null||Ot.focus(),document.activeElement!==ur))return},[je,oe]),ot=ne.useCallback(()=>st([ve,J]),[st,ve,J]);ne.useEffect(()=>{tt&&ot()},[tt,ot]);const{onOpenChange:Be,triggerPointerDownPosRef:lt}=H;ne.useEffect(()=>{if(J){let Ut={x:0,y:0};const hr=ge=>{var ur,Ot;Ut={x:Math.abs(Math.round(ge.pageX)-(((ur=lt.current)==null?void 0:ur.x)??0)),y:Math.abs(Math.round(ge.pageY)-(((Ot=lt.current)==null?void 0:Ot.y)??0))}},Vt=ge=>{Ut.x<=10&&Ut.y<=10?ge.preventDefault():J.contains(ge.target)||Be(!1),document.removeEventListener("pointermove",hr),lt.current=null};return lt.current!==null&&(document.addEventListener("pointermove",hr),document.addEventListener("pointerup",Vt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",hr),document.removeEventListener("pointerup",Vt,{capture:!0})}}},[J,Be,lt]),ne.useEffect(()=>{const Ut=()=>Be(!1);return window.addEventListener("blur",Ut),window.addEventListener("resize",Ut),()=>{window.removeEventListener("blur",Ut),window.removeEventListener("resize",Ut)}},[Be]);const[zt,Lt]=goe(Ut=>{const hr=je().filter(ur=>!ur.disabled),Vt=hr.find(ur=>ur.ref.current===document.activeElement),ge=yoe(hr,Ut,Vt);ge&&setTimeout(()=>ge.ref.current.focus())}),Bt=ne.useCallback((Ut,hr,Vt)=>{const ge=!Qe.current&&!Vt;(H.value!==void 0&&H.value===hr||ge)&&(Fe(Ut),ge&&(Qe.current=!0))},[H.value]),ct=ne.useCallback(()=>J==null?void 0:J.focus(),[J]),nr=ne.useCallback((Ut,hr,Vt)=>{const ge=!Qe.current&&!Vt;(H.value!==void 0&&H.value===hr||ge)&&Ce(Ut)},[H.value]),mr=n==="popper"?XF:eoe,ir=mr===XF?{side:i,sideOffset:_,align:b,alignOffset:E,arrowPadding:C,collisionBoundary:I,collisionPadding:F,sticky:$,hideWhenDetached:B,avoidCollisions:q}:{};return j.jsx(Jie,{scope:r,content:J,viewport:oe,onViewportChange:de,itemRefCallback:Bt,selectedItem:ve,onItemLeave:ct,itemTextRefCallback:nr,focusSelectedItem:ot,selectedItemText:ke,position:n,isPositioned:tt,searchRef:zt,children:j.jsx(ER,{as:Yh,allowPinchZoom:!0,children:j.jsx(SR,{asChild:!0,trapped:H.open,onMountAutoFocus:Ut=>{Ut.preventDefault()},onUnmountAutoFocus:Kr(a,Ut=>{var hr;(hr=H.trigger)==null||hr.focus({preventScroll:!0}),Ut.preventDefault()}),children:j.jsx(Vx,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:h,onFocusOutside:Ut=>Ut.preventDefault(),onDismiss:()=>H.onOpenChange(!1),children:j.jsx(mr,{role:"listbox",id:H.contentId,"data-state":H.open?"open":"closed",dir:H.dir,onContextMenu:Ut=>Ut.preventDefault(),...G,...ir,onPlaced:()=>Ze(!0),ref:ae,style:{display:"flex",flexDirection:"column",outline:"none",...G.style},onKeyDown:Kr(G.onKeyDown,Ut=>{const hr=Ut.ctrlKey||Ut.altKey||Ut.metaKey;if(Ut.key==="Tab"&&Ut.preventDefault(),!hr&&Ut.key.length===1&&Lt(Ut.key),["ArrowUp","ArrowDown","Home","End"].includes(Ut.key)){let ge=je().filter(ur=>!ur.disabled).map(ur=>ur.ref.current);if(["ArrowUp","End"].includes(Ut.key)&&(ge=ge.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ut.key)){const ur=Ut.target,Ot=ge.indexOf(ur);ge=ge.slice(Ot+1)}setTimeout(()=>st(ge)),Ut.preventDefault()}})})})})})})});Qie.displayName=hWe;var fWe="SelectItemAlignedPosition",eoe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,l=Nm(jy,r),h=zm(jy,r),[i,_]=ne.useState(null),[b,E]=ne.useState(null),C=Ci(t,ae=>E(ae)),I=CR(r),F=ne.useRef(!1),$=ne.useRef(!0),{viewport:B,selectedItem:q,selectedItemText:G,focusSelectedItem:H}=h,J=ne.useCallback(()=>{if(l.trigger&&l.valueNode&&i&&b&&B&&q&&G){const ae=l.trigger.getBoundingClientRect(),ve=b.getBoundingClientRect(),Fe=l.valueNode.getBoundingClientRect(),ke=G.getBoundingClientRect();if(l.dir!=="rtl"){const ur=ke.left-ve.left,Ot=Fe.left-ur,tr=ae.left-Ot,xt=ae.width+tr,un=Math.max(xt,ve.width),Fr=window.innerWidth-mu,Ln=XZ(Ot,[mu,Math.max(mu,Fr-un)]);i.style.minWidth=xt+"px",i.style.left=Ln+"px"}else{const ur=ve.right-ke.right,Ot=window.innerWidth-Fe.right-ur,tr=window.innerWidth-ae.right-Ot,xt=ae.width+tr,un=Math.max(xt,ve.width),Fr=window.innerWidth-mu,Ln=XZ(Ot,[mu,Math.max(mu,Fr-un)]);i.style.minWidth=xt+"px",i.style.right=Ln+"px"}const Ce=I(),je=window.innerHeight-mu*2,tt=B.scrollHeight,Ze=window.getComputedStyle(b),Qe=parseInt(Ze.borderTopWidth,10),st=parseInt(Ze.paddingTop,10),ot=parseInt(Ze.borderBottomWidth,10),Be=parseInt(Ze.paddingBottom,10),lt=Qe+st+tt+Be+ot,zt=Math.min(q.offsetHeight*5,lt),Lt=window.getComputedStyle(B),Bt=parseInt(Lt.paddingTop,10),ct=parseInt(Lt.paddingBottom,10),nr=ae.top+ae.height/2-mu,mr=je-nr,ir=q.offsetHeight/2,Ut=q.offsetTop+ir,hr=Qe+st+Ut,Vt=lt-hr;if(hr<=nr){const ur=Ce.length>0&&q===Ce[Ce.length-1].ref.current;i.style.bottom="0px";const Ot=b.clientHeight-B.offsetTop-B.offsetHeight,tr=Math.max(mr,ir+(ur?ct:0)+Ot+ot),xt=hr+tr;i.style.height=xt+"px"}else{const ur=Ce.length>0&&q===Ce[0].ref.current;i.style.top="0px";const tr=Math.max(nr,Qe+B.offsetTop+(ur?Bt:0)+ir)+Vt;i.style.height=tr+"px",B.scrollTop=hr-nr+B.offsetTop}i.style.margin=`${mu}px 0`,i.style.minHeight=zt+"px",i.style.maxHeight=je+"px",n==null||n(),requestAnimationFrame(()=>F.current=!0)}},[I,l.trigger,l.valueNode,i,b,B,q,G,l.dir,n]);ms(()=>J(),[J]);const[Q,oe]=ne.useState();ms(()=>{b&&oe(window.getComputedStyle(b).zIndex)},[b]);const de=ne.useCallback(ae=>{ae&&$.current===!0&&(J(),H==null||H(),$.current=!1)},[J,H]);return j.jsx(mWe,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:F,onScrollButtonChange:de,children:j.jsx("div",{ref:_,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:Q},children:j.jsx(Mn.div,{...a,ref:C,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});eoe.displayName=fWe;var pWe="SelectPopperPosition",XF=ne.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=mu,...l}=e,h=MR(r);return j.jsx(y5,{...h,...l,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});XF.displayName=pWe;var[mWe,G$]=pb(jy,{}),YF="SelectViewport",toe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,l=zm(YF,r),h=G$(YF,r),i=Ci(t,l.onViewportChange),_=ne.useRef(0);return j.jsxs(j.Fragment,{children:[j.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),j.jsx(AR.Slot,{scope:r,children:j.jsx(Mn.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Kr(a.onScroll,b=>{const E=b.currentTarget,{contentWrapper:C,shouldExpandOnScrollRef:I}=h;if(I!=null&&I.current&&C){const F=Math.abs(_.current-E.scrollTop);if(F>0){const $=window.innerHeight-mu*2,B=parseFloat(C.style.minHeight),q=parseFloat(C.style.height),G=Math.max(B,q);if(G<$){const H=G+F,J=Math.min($,H),Q=H-J;C.style.height=J+"px",C.style.bottom==="0px"&&(E.scrollTop=Q>0?Q:0,C.style.justifyContent="flex-end")}}}_.current=E.scrollTop})})})]})});toe.displayName=YF;var roe="SelectGroup",[gWe,yWe]=pb(roe),vWe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=jh();return j.jsx(gWe,{scope:r,id:a,children:j.jsx(Mn.div,{role:"group","aria-labelledby":a,...n,ref:t})})});vWe.displayName=roe;var noe="SelectLabel",ioe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=yWe(noe,r);return j.jsx(Mn.div,{id:a.id,...n,ref:t})});ioe.displayName=noe;var AO="SelectItem",[_We,ooe]=pb(AO),aoe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:l,...h}=e,i=Nm(AO,r),_=zm(AO,r),b=i.value===n,[E,C]=ne.useState(l??""),[I,F]=ne.useState(!1),$=Ci(t,H=>{var J;return(J=_.itemRefCallback)==null?void 0:J.call(_,H,n,a)}),B=jh(),q=ne.useRef("touch"),G=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return j.jsx(_We,{scope:r,value:n,disabled:a,textId:B,isSelected:b,onItemTextChange:ne.useCallback(H=>{C(J=>J||((H==null?void 0:H.textContent)??"").trim())},[]),children:j.jsx(AR.ItemSlot,{scope:r,value:n,disabled:a,textValue:E,children:j.jsx(Mn.div,{role:"option","aria-labelledby":B,"data-highlighted":I?"":void 0,"aria-selected":b&&I,"data-state":b?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...h,ref:$,onFocus:Kr(h.onFocus,()=>F(!0)),onBlur:Kr(h.onBlur,()=>F(!1)),onClick:Kr(h.onClick,()=>{q.current!=="mouse"&&G()}),onPointerUp:Kr(h.onPointerUp,()=>{q.current==="mouse"&&G()}),onPointerDown:Kr(h.onPointerDown,H=>{q.current=H.pointerType}),onPointerMove:Kr(h.onPointerMove,H=>{var J;q.current=H.pointerType,a?(J=_.onItemLeave)==null||J.call(_):q.current==="mouse"&&H.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Kr(h.onPointerLeave,H=>{var J;H.currentTarget===document.activeElement&&((J=_.onItemLeave)==null||J.call(_))}),onKeyDown:Kr(h.onKeyDown,H=>{var Q;((Q=_.searchRef)==null?void 0:Q.current)!==""&&H.key===" "||(oWe.includes(H.key)&&G(),H.key===" "&&H.preventDefault())})})})})});aoe.displayName=AO;var Kw="SelectItemText",soe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...l}=e,h=Nm(Kw,r),i=zm(Kw,r),_=ooe(Kw,r),b=cWe(Kw,r),[E,C]=ne.useState(null),I=Ci(t,G=>C(G),_.onItemTextChange,G=>{var H;return(H=i.itemTextRefCallback)==null?void 0:H.call(i,G,_.value,_.disabled)}),F=E==null?void 0:E.textContent,$=ne.useMemo(()=>j.jsx("option",{value:_.value,disabled:_.disabled,children:F},_.value),[_.disabled,_.value,F]),{onNativeOptionAdd:B,onNativeOptionRemove:q}=b;return ms(()=>(B($),()=>q($)),[B,q,$]),j.jsxs(j.Fragment,{children:[j.jsx(Mn.span,{id:_.textId,...l,ref:I}),_.isSelected&&h.valueNode&&!h.valueNodeHasChildren?Zy.createPortal(l.children,h.valueNode):null]})});soe.displayName=Kw;var loe="SelectItemIndicator",coe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return ooe(loe,r).isSelected?j.jsx(Mn.span,{"aria-hidden":!0,...n,ref:t}):null});coe.displayName=loe;var KF="SelectScrollUpButton",uoe=ne.forwardRef((e,t)=>{const r=zm(KF,e.__scopeSelect),n=G$(KF,e.__scopeSelect),[a,l]=ne.useState(!1),h=Ci(t,n.onScrollButtonChange);return ms(()=>{if(r.viewport&&r.isPositioned){let i=function(){const b=_.scrollTop>0;l(b)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?j.jsx(hoe,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop-_.offsetHeight)}}):null});uoe.displayName=KF;var JF="SelectScrollDownButton",doe=ne.forwardRef((e,t)=>{const r=zm(JF,e.__scopeSelect),n=G$(JF,e.__scopeSelect),[a,l]=ne.useState(!1),h=Ci(t,n.onScrollButtonChange);return ms(()=>{if(r.viewport&&r.isPositioned){let i=function(){const b=_.scrollHeight-_.clientHeight,E=Math.ceil(_.scrollTop)<b;l(E)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?j.jsx(hoe,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop+_.offsetHeight)}}):null});doe.displayName=JF;var hoe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,l=zm("SelectScrollButton",r),h=ne.useRef(null),i=CR(r),_=ne.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return ne.useEffect(()=>()=>_(),[_]),ms(()=>{var E;const b=i().find(C=>C.ref.current===document.activeElement);(E=b==null?void 0:b.ref.current)==null||E.scrollIntoView({block:"nearest"})},[i]),j.jsx(Mn.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Kr(a.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(n,50))}),onPointerMove:Kr(a.onPointerMove,()=>{var b;(b=l.onItemLeave)==null||b.call(l),h.current===null&&(h.current=window.setInterval(n,50))}),onPointerLeave:Kr(a.onPointerLeave,()=>{_()})})}),xWe="SelectSeparator",foe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return j.jsx(Mn.div,{"aria-hidden":!0,...n,ref:t})});foe.displayName=xWe;var QF="SelectArrow",bWe=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=MR(r),l=Nm(QF,r),h=zm(QF,r);return l.open&&h.position==="popper"?j.jsx(v5,{...a,...n,ref:t}):null});bWe.displayName=QF;function poe(e){return e===""||e===void 0}var moe=ne.forwardRef((e,t)=>{const{value:r,...n}=e,a=ne.useRef(null),l=Ci(t,a),h=V$(r);return ne.useEffect(()=>{const i=a.current,_=window.HTMLSelectElement.prototype,E=Object.getOwnPropertyDescriptor(_,"value").set;if(h!==r&&E){const C=new Event("change",{bubbles:!0});E.call(i,r),i.dispatchEvent(C)}},[h,r]),j.jsx(PE,{asChild:!0,children:j.jsx("select",{...n,ref:l,defaultValue:r})})});moe.displayName="BubbleSelect";function goe(e){const t=Al(e),r=ne.useRef(""),n=ne.useRef(0),a=ne.useCallback(h=>{const i=r.current+h;t(i),function _(b){r.current=b,window.clearTimeout(n.current),b!==""&&(n.current=window.setTimeout(()=>_(""),1e3))}(i)},[t]),l=ne.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return ne.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,l]}function yoe(e,t,r){const a=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let h=wWe(e,Math.max(l,0));a.length===1&&(h=h.filter(b=>b!==r));const _=h.find(b=>b.textValue.toLowerCase().startsWith(a.toLowerCase()));return _!==r?_:void 0}function wWe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var SWe=Wie,voe=qie,TWe=Zie,EWe=Xie,AWe=Yie,_oe=Kie,CWe=toe,xoe=ioe,boe=aoe,MWe=soe,PWe=coe,woe=uoe,Soe=doe,Toe=foe;const Eoe=SWe,Aoe=TWe,q$=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(voe,{ref:n,className:Tr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,j.jsx(EWe,{asChild:!0,children:j.jsx(r5,{className:"h-4 w-4 opacity-50"})})]}));q$.displayName=voe.displayName;const Coe=ne.forwardRef(({className:e,...t},r)=>j.jsx(woe,{ref:r,className:Tr("flex cursor-default items-center justify-center py-1",e),...t,children:j.jsx(kge,{className:"h-4 w-4"})}));Coe.displayName=woe.displayName;const Moe=ne.forwardRef(({className:e,...t},r)=>j.jsx(Soe,{ref:r,className:Tr("flex cursor-default items-center justify-center py-1",e),...t,children:j.jsx(r5,{className:"h-4 w-4"})}));Moe.displayName=Soe.displayName;const H$=ne.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>j.jsx(AWe,{children:j.jsxs(_oe,{ref:a,className:Tr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[j.jsx(Coe,{}),j.jsx(CWe,{className:Tr("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),j.jsx(Moe,{})]})}));H$.displayName=_oe.displayName;const IWe=ne.forwardRef(({className:e,...t},r)=>j.jsx(xoe,{ref:r,className:Tr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));IWe.displayName=xoe.displayName;const Cd=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(boe,{ref:n,className:Tr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[j.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:j.jsx(PWe,{children:j.jsx(wQ,{className:"h-4 w-4"})})}),j.jsx(MWe,{children:t})]}));Cd.displayName=boe.displayName;const OWe=ne.forwardRef(({className:e,...t},r)=>j.jsx(Toe,{ref:r,className:Tr("-mx-1 my-1 h-px bg-muted",e),...t}));OWe.displayName=Toe.displayName;const kWe=Wx("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function e4({className:e,variant:t,...r}){return j.jsx("div",{className:Tr(kWe({variant:t}),e),...r})}function RWe(e,t=[]){let r=[];function n(l,h){const i=ne.createContext(h),_=r.length;r=[...r,h];function b(C){const{scope:I,children:F,...$}=C,B=(I==null?void 0:I[e][_])||i,q=ne.useMemo(()=>$,Object.values($));return j.jsx(B.Provider,{value:q,children:F})}function E(C,I){const F=(I==null?void 0:I[e][_])||i,$=ne.useContext(F);if($)return $;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${l}\``)}return b.displayName=l+"Provider",[b,E]}const a=()=>{const l=r.map(h=>ne.createContext(h));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,DWe(a,...t)]}function DWe(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const h=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}var wN="rovingFocusGroup.onEntryFocus",LWe={bubbles:!1,cancelable:!0},PR="RovingFocusGroup",[t4,Poe,NWe]=JB(PR),[zWe,IR]=RWe(PR,[NWe]),[jWe,FWe]=zWe(PR),Ioe=ne.forwardRef((e,t)=>j.jsx(t4.Provider,{scope:e.__scopeRovingFocusGroup,children:j.jsx(t4.Slot,{scope:e.__scopeRovingFocusGroup,children:j.jsx(BWe,{...e,ref:t})})}));Ioe.displayName=PR;var BWe=ne.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:l,currentTabStopId:h,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:_,onEntryFocus:b,preventScrollOnEntryFocus:E=!1,...C}=e,I=ne.useRef(null),F=Ci(t,I),$=wR(l),[B=null,q]=Kh({prop:h,defaultProp:i,onChange:_}),[G,H]=ne.useState(!1),J=Al(b),Q=Poe(r),oe=ne.useRef(!1),[de,ae]=ne.useState(0);return ne.useEffect(()=>{const ve=I.current;if(ve)return ve.addEventListener(wN,J),()=>ve.removeEventListener(wN,J)},[J]),j.jsx(jWe,{scope:r,orientation:n,dir:$,loop:a,currentTabStopId:B,onItemFocus:ne.useCallback(ve=>q(ve),[q]),onItemShiftTab:ne.useCallback(()=>H(!0),[]),onFocusableItemAdd:ne.useCallback(()=>ae(ve=>ve+1),[]),onFocusableItemRemove:ne.useCallback(()=>ae(ve=>ve-1),[]),children:j.jsx(Mn.div,{tabIndex:G||de===0?-1:0,"data-orientation":n,...C,ref:F,style:{outline:"none",...e.style},onMouseDown:Kr(e.onMouseDown,()=>{oe.current=!0}),onFocus:Kr(e.onFocus,ve=>{const Fe=!oe.current;if(ve.target===ve.currentTarget&&Fe&&!G){const ke=new CustomEvent(wN,LWe);if(ve.currentTarget.dispatchEvent(ke),!ke.defaultPrevented){const Ce=Q().filter(st=>st.focusable),je=Ce.find(st=>st.active),tt=Ce.find(st=>st.id===B),Qe=[je,tt,...Ce].filter(Boolean).map(st=>st.ref.current);Roe(Qe,E)}}oe.current=!1}),onBlur:Kr(e.onBlur,()=>H(!1))})})}),Ooe="RovingFocusGroupItem",koe=ne.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:l,...h}=e,i=jh(),_=l||i,b=FWe(Ooe,r),E=b.currentTabStopId===_,C=Poe(r),{onFocusableItemAdd:I,onFocusableItemRemove:F}=b;return ne.useEffect(()=>{if(n)return I(),()=>F()},[n,I,F]),j.jsx(t4.ItemSlot,{scope:r,id:_,focusable:n,active:a,children:j.jsx(Mn.span,{tabIndex:E?0:-1,"data-orientation":b.orientation,...h,ref:t,onMouseDown:Kr(e.onMouseDown,$=>{n?b.onItemFocus(_):$.preventDefault()}),onFocus:Kr(e.onFocus,()=>b.onItemFocus(_)),onKeyDown:Kr(e.onKeyDown,$=>{if($.key==="Tab"&&$.shiftKey){b.onItemShiftTab();return}if($.target!==$.currentTarget)return;const B=VWe($,b.orientation,b.dir);if(B!==void 0){if($.metaKey||$.ctrlKey||$.altKey||$.shiftKey)return;$.preventDefault();let G=C().filter(H=>H.focusable).map(H=>H.ref.current);if(B==="last")G.reverse();else if(B==="prev"||B==="next"){B==="prev"&&G.reverse();const H=G.indexOf($.currentTarget);G=b.loop?WWe(G,H+1):G.slice(H+1)}setTimeout(()=>Roe(G))}})})})});koe.displayName=Ooe;var $We={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function UWe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function VWe(e,t,r){const n=UWe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return $We[n]}function Roe(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function WWe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Doe=Ioe,Loe=koe,Z$="Tabs",[GWe,kQe]=lf(Z$,[IR]),Noe=IR(),[qWe,X$]=GWe(Z$),zoe=ne.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:l,orientation:h="horizontal",dir:i,activationMode:_="automatic",...b}=e,E=wR(i),[C,I]=Kh({prop:n,onChange:a,defaultProp:l});return j.jsx(qWe,{scope:r,baseId:jh(),value:C,onValueChange:I,orientation:h,dir:E,activationMode:_,children:j.jsx(Mn.div,{dir:E,"data-orientation":h,...b,ref:t})})});zoe.displayName=Z$;var joe="TabsList",Foe=ne.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,l=X$(joe,r),h=Noe(r);return j.jsx(Doe,{asChild:!0,...h,orientation:l.orientation,dir:l.dir,loop:n,children:j.jsx(Mn.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:t})})});Foe.displayName=joe;var Boe="TabsTrigger",$oe=ne.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...l}=e,h=X$(Boe,r),i=Noe(r),_=Woe(h.baseId,n),b=Goe(h.baseId,n),E=n===h.value;return j.jsx(Loe,{asChild:!0,...i,focusable:!a,active:E,children:j.jsx(Mn.button,{type:"button",role:"tab","aria-selected":E,"aria-controls":b,"data-state":E?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:_,...l,ref:t,onMouseDown:Kr(e.onMouseDown,C=>{!a&&C.button===0&&C.ctrlKey===!1?h.onValueChange(n):C.preventDefault()}),onKeyDown:Kr(e.onKeyDown,C=>{[" ","Enter"].includes(C.key)&&h.onValueChange(n)}),onFocus:Kr(e.onFocus,()=>{const C=h.activationMode!=="manual";!E&&!a&&C&&h.onValueChange(n)})})})});$oe.displayName=Boe;var Uoe="TabsContent",Voe=ne.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:l,...h}=e,i=X$(Uoe,r),_=Woe(i.baseId,n),b=Goe(i.baseId,n),E=n===i.value,C=ne.useRef(E);return ne.useEffect(()=>{const I=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(I)},[]),j.jsx(Gu,{present:a||E,children:({present:I})=>j.jsx(Mn.div,{"data-state":E?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":_,hidden:!I,id:b,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:C.current?"0s":void 0},children:I&&l})})});Voe.displayName=Uoe;function Woe(e,t){return`${e}-trigger-${t}`}function Goe(e,t){return`${e}-content-${t}`}var HWe=zoe,qoe=Foe,Hoe=$oe,Zoe=Voe;const Y$=HWe,OR=ne.forwardRef(({className:e,...t},r)=>j.jsx(qoe,{ref:r,className:Tr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));OR.displayName=qoe.displayName;const Mu=ne.forwardRef(({className:e,...t},r)=>j.jsx(Hoe,{ref:r,className:Tr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Mu.displayName=Hoe.displayName;const dm=ne.forwardRef(({className:e,...t},r)=>j.jsx(Zoe,{ref:r,className:Tr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));dm.displayName=Zoe.displayName;var K$="Dialog",[Xoe,RQe]=lf(K$),[ZWe,Hu]=Xoe(K$),Yoe=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:h=!0}=e,i=ne.useRef(null),_=ne.useRef(null),[b=!1,E]=Kh({prop:n,defaultProp:a,onChange:l});return j.jsx(ZWe,{scope:t,triggerRef:i,contentRef:_,contentId:jh(),titleId:jh(),descriptionId:jh(),open:b,onOpenChange:E,onOpenToggle:ne.useCallback(()=>E(C=>!C),[E]),modal:h,children:r})};Yoe.displayName=K$;var Koe="DialogTrigger",Joe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Hu(Koe,r),l=Ci(t,a.triggerRef);return j.jsx(Mn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":eU(a.open),...n,ref:l,onClick:Kr(e.onClick,a.onOpenToggle)})});Joe.displayName=Koe;var J$="DialogPortal",[XWe,Qoe]=Xoe(J$,{forceMount:void 0}),eae=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,l=Hu(J$,t);return j.jsx(XWe,{scope:t,forceMount:r,children:ne.Children.map(n,h=>j.jsx(Gu,{present:r||l.open,children:j.jsx(ME,{asChild:!0,container:a,children:h})}))})};eae.displayName=J$;var CO="DialogOverlay",tae=ne.forwardRef((e,t)=>{const r=Qoe(CO,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=Hu(CO,e.__scopeDialog);return l.modal?j.jsx(Gu,{present:n||l.open,children:j.jsx(YWe,{...a,ref:t})}):null});tae.displayName=CO;var YWe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Hu(CO,r);return j.jsx(ER,{as:Yh,allowPinchZoom:!0,shards:[a.contentRef],children:j.jsx(Mn.div,{"data-state":eU(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Fy="DialogContent",rae=ne.forwardRef((e,t)=>{const r=Qoe(Fy,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=Hu(Fy,e.__scopeDialog);return j.jsx(Gu,{present:n||l.open,children:l.modal?j.jsx(KWe,{...a,ref:t}):j.jsx(JWe,{...a,ref:t})})});rae.displayName=Fy;var KWe=ne.forwardRef((e,t)=>{const r=Hu(Fy,e.__scopeDialog),n=ne.useRef(null),a=Ci(t,r.contentRef,n);return ne.useEffect(()=>{const l=n.current;if(l)return W$(l)},[]),j.jsx(nae,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kr(e.onCloseAutoFocus,l=>{var h;l.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Kr(e.onPointerDownOutside,l=>{const h=l.detail.originalEvent,i=h.button===0&&h.ctrlKey===!0;(h.button===2||i)&&l.preventDefault()}),onFocusOutside:Kr(e.onFocusOutside,l=>l.preventDefault())})}),JWe=ne.forwardRef((e,t)=>{const r=Hu(Fy,e.__scopeDialog),n=ne.useRef(!1),a=ne.useRef(!1);return j.jsx(nae,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=l.target;((b=r.triggerRef.current)==null?void 0:b.contains(h))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),nae=ne.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...h}=e,i=Hu(Fy,r),_=ne.useRef(null),b=Ci(t,_);return U$(),j.jsxs(j.Fragment,{children:[j.jsx(SR,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:j.jsx(Vx,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":eU(i.open),...h,ref:b,onDismiss:()=>i.onOpenChange(!1)})}),j.jsxs(j.Fragment,{children:[j.jsx(QWe,{titleId:i.titleId}),j.jsx(tGe,{contentRef:_,descriptionId:i.descriptionId})]})]})}),Q$="DialogTitle",iae=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Hu(Q$,r);return j.jsx(Mn.h2,{id:a.titleId,...n,ref:t})});iae.displayName=Q$;var oae="DialogDescription",aae=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Hu(oae,r);return j.jsx(Mn.p,{id:a.descriptionId,...n,ref:t})});aae.displayName=oae;var sae="DialogClose",lae=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Hu(sae,r);return j.jsx(Mn.button,{type:"button",...n,ref:t,onClick:Kr(e.onClick,()=>a.onOpenChange(!1))})});lae.displayName=sae;function eU(e){return e?"open":"closed"}var cae="DialogTitleWarning",[DQe,uae]=$me(cae,{contentName:Fy,titleName:Q$,docsSlug:"dialog"}),QWe=({titleId:e})=>{const t=uae(cae),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return ne.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},eGe="DialogDescriptionWarning",tGe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${uae(eGe).contentName}}.`;return ne.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},tU=Yoe,rU=Joe,nU=eae,UE=tae,VE=rae,WE=iae,GE=aae,iU=lae;const dae=tU,rGe=rU,nGe=nU,hae=ne.forwardRef(({className:e,...t},r)=>j.jsx(UE,{ref:r,className:Tr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));hae.displayName=UE.displayName;const oU=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(nGe,{children:[j.jsx(hae,{}),j.jsxs(VE,{ref:n,className:Tr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,j.jsxs(iU,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[j.jsx(a5,{className:"h-4 w-4"}),j.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));oU.displayName=VE.displayName;const aU=({className:e,...t})=>j.jsx("div",{className:Tr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});aU.displayName="DialogHeader";const sU=ne.forwardRef(({className:e,...t},r)=>j.jsx(WE,{ref:r,className:Tr("text-lg font-semibold leading-none tracking-tight",e),...t}));sU.displayName=WE.displayName;const fae=ne.forwardRef(({className:e,...t},r)=>j.jsx(GE,{ref:r,className:Tr("text-sm text-muted-foreground",e),...t}));fae.displayName=GE.displayName;const iGe=Wx("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),pae=ne.forwardRef(({className:e,variant:t,...r},n)=>j.jsx("div",{ref:n,role:"alert",className:Tr(iGe({variant:t}),e),...r}));pae.displayName="Alert";const oGe=ne.forwardRef(({className:e,...t},r)=>j.jsx("h5",{ref:r,className:Tr("mb-1 font-medium leading-none tracking-tight",e),...t}));oGe.displayName="AlertTitle";const mae=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tr("text-sm [&_p]:leading-relaxed",e),...t}));mae.displayName="AlertDescription";const aGe=()=>{const[e,t]=ne.useState(!1),r=()=>{const l=[["street","number","int_number","neighborhood","postal_code","administrative_area","sub_administrative_area","reference","notes"].join(","),"Av Insurgentes,123,2B,Condesa,06140,CDMX,Ciudad de México,Edificio gris,Entregar en recepción","Calle Durango,45,,Roma Norte,06700,CDMX,Ciudad de México,Casa azul,Tocar timbre"].join(`
`),h=new Blob([l],{type:"text/csv"}),i=window.URL.createObjectURL(h),_=document.createElement("a");_.href=i,_.download="ordenes_template.csv",_.click(),window.URL.revokeObjectURL(i)},n=async a=>{var i;const l=(i=a.target.files)==null?void 0:i[0];if(!l)return;t(!0);const h=new FileReader;h.onload=async _=>{var b;try{const C=((b=_.target)==null?void 0:b.result).split(`
`).filter(G=>G.trim()),I=C[0].split(","),F=C.slice(1,501).map(G=>{const H=G.split(","),J={is_manual:!0,country:"MX"};return I.forEach((Q,oe)=>{var de;J[Q.trim()]=((de=H[oe])==null?void 0:de.trim())||null}),J});if(F.length>500){Md.error("El archivo excede el límite de 500 órdenes");return}const{data:$}=await Oi.auth.getUser();if(!$.user){Md.error("Usuario no autenticado");return}let B=0,q=0;for(const G of F){const H={...G,user_id:$.user.id,street:G.street||"",number:G.number||"",neighborhood:G.neighborhood||"",postal_code:G.postal_code||"",administrative_area:G.administrative_area||"",sub_administrative_area:G.sub_administrative_area||""};if(!H.street||!H.number||!H.neighborhood||!H.postal_code||!H.administrative_area||!H.sub_administrative_area){console.error("Missing required fields for order:",H),q++;continue}const{error:J}=await Oi.from("orders").insert(H);J?(console.error("Error importing order:",J),q++):B++}Md.success(`Importación completada: ${B} órdenes creadas, ${q} errores`)}catch(E){console.error("Error processing file:",E),Md.error("Error al procesar el archivo")}finally{t(!1)}},h.readAsText(l)};return j.jsxs(dae,{children:[j.jsx(rGe,{asChild:!0,children:j.jsxs(Yn,{variant:"outline",size:"sm",children:[j.jsx(fq,{className:"h-4 w-4 mr-2"}),"Importar CSV"]})}),j.jsxs(oU,{children:[j.jsxs(aU,{children:[j.jsx(sU,{children:"Importar órdenes desde CSV"}),j.jsx(fae,{children:"Sube un archivo CSV con las órdenes que deseas importar. Límite: 500 órdenes por archivo."})]}),j.jsxs(pae,{children:[j.jsx(SQ,{className:"h-4 w-4"}),j.jsx(mae,{children:"Descarga la plantilla CSV para asegurar el formato correcto."})]}),j.jsxs("div",{className:"flex flex-col gap-4",children:[j.jsxs(Yn,{variant:"outline",onClick:r,children:[j.jsx(o5,{className:"h-4 w-4 mr-2"}),"Descargar plantilla"]}),j.jsx("input",{type:"file",accept:".csv",onChange:n,className:"hidden",id:"csv-upload"}),j.jsxs(Yn,{onClick:()=>{var a;return(a=document.getElementById("csv-upload"))==null?void 0:a.click()},disabled:e,children:[j.jsx(fq,{className:"h-4 w-4 mr-2"}),e?"Importando...":"Subir CSV"]})]})]})]})},sGe=()=>{const[e,t]=ne.useState(""),{data:r,isLoading:n}=Yy({queryKey:["orders"],queryFn:async()=>{const{data:l,error:h}=await Oi.from("orders").select("*").order("created_at",{ascending:!1});if(h)throw h;return l}}),a=r==null?void 0:r.filter(l=>l.street.toLowerCase().includes(e.toLowerCase())||l.postal_code.includes(e)||l.neighborhood.toLowerCase().includes(e.toLowerCase()));return j.jsxs("div",{className:"animate-fade-in",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsx("h1",{className:"text-2xl font-bold",children:"Órdenes"}),j.jsxs("div",{className:"flex space-x-2",children:[j.jsx(aGe,{}),j.jsxs(Yn,{variant:"outline",size:"sm",children:[j.jsx(o5,{className:"h-4 w-4 mr-2"}),"Exportar"]}),j.jsxs(Yn,{size:"sm",children:[j.jsx(Gz,{className:"h-4 w-4 mr-2"}),"Nueva orden"]})]})]}),j.jsxs(Y$,{defaultValue:"todas",className:"mb-6",children:[j.jsxs(OR,{children:[j.jsx(Mu,{value:"todas",children:"Todas"}),j.jsx(Mu,{value:"manuales",children:"Manuales"}),j.jsx(Mu,{value:"automaticas",children:"Automáticas"})]}),j.jsx(dm,{value:"todas",children:j.jsx(SN,{orders:a,isLoading:n,searchTerm:e,setSearchTerm:t})}),j.jsx(dm,{value:"manuales",children:j.jsx(SN,{orders:a==null?void 0:a.filter(l=>l.is_manual),isLoading:n,searchTerm:e,setSearchTerm:t})}),j.jsx(dm,{value:"automaticas",children:j.jsx(SN,{orders:a==null?void 0:a.filter(l=>!l.is_manual),isLoading:n,searchTerm:e,setSearchTerm:t})})]})]})},SN=({orders:e=[],isLoading:t,searchTerm:r,setSearchTerm:n})=>j.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[j.jsx("div",{className:"p-4 border-b",children:j.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[j.jsxs("div",{className:"relative w-full sm:w-64",children:[j.jsx(_k,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),j.jsx(wi,{placeholder:"Buscar órdenes...",className:"pl-8",value:r,onChange:a=>n(a.target.value)})]}),j.jsxs("div",{className:"flex flex-wrap gap-2",children:[j.jsxs(Yn,{variant:"outline",size:"sm",children:[j.jsx(EQ,{className:"h-4 w-4 mr-2"}),"Filtros"]}),j.jsxs(Eoe,{defaultValue:"7d",children:[j.jsx(q$,{className:"w-36 h-9",children:j.jsx(Aoe,{placeholder:"Periodo"})}),j.jsxs(H$,{children:[j.jsx(Cd,{value:"24h",children:"Últimas 24h"}),j.jsx(Cd,{value:"7d",children:"Últimos 7 días"}),j.jsx(Cd,{value:"30d",children:"Últimos 30 días"}),j.jsx(Cd,{value:"custom",children:"Personalizado"})]})]}),j.jsxs(Yn,{variant:"outline",size:"sm",children:[j.jsx(o5,{className:"h-4 w-4 mr-2"}),"Exportar"]})]})]})}),j.jsx("div",{className:"overflow-x-auto",children:j.jsxs(F$,{children:[j.jsx(B$,{children:j.jsxs(ay,{children:[j.jsx(Hl,{children:"ID"}),j.jsx(Hl,{children:"Dirección"}),j.jsx(Hl,{children:"Tipo"}),j.jsx(Hl,{children:"Fecha"}),j.jsx(Hl,{children:"Estado"}),j.jsx(Hl,{className:"text-right",children:"Acciones"})]})}),j.jsx($$,{children:t?j.jsx(ay,{children:j.jsx(Ns,{colSpan:6,className:"text-center py-8",children:"Cargando órdenes..."})}):e.length===0?j.jsx(ay,{children:j.jsx(Ns,{colSpan:6,className:"text-center py-8",children:"No hay órdenes para mostrar"})}):e.map(a=>j.jsxs(ay,{children:[j.jsx(Ns,{className:"font-medium",children:a.id.slice(0,8)}),j.jsxs(Ns,{children:[a.street," ",a.number,a.int_number&&`, Int. ${a.int_number}`,j.jsx("br",{}),j.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.neighborhood,", ",a.postal_code]})]}),j.jsx(Ns,{children:j.jsx(e4,{variant:a.is_manual?"default":"secondary",children:a.is_manual?"Manual":"Automática"})}),j.jsx(Ns,{children:new Date(a.created_at).toLocaleDateString("es-MX")}),j.jsx(Ns,{children:j.jsx(e4,{children:"Pendiente"})}),j.jsxs(Ns,{className:"text-right",children:[j.jsx(Yn,{variant:"ghost",size:"sm",children:"Ver"}),j.jsx(Yn,{variant:"ghost",size:"sm",children:"Editar"})]})]},a.id))})]})}),j.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[j.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",e.length," órdenes"]}),j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx(Yn,{variant:"outline",size:"sm",children:j.jsx(n5,{className:"h-4 w-4"})}),j.jsx(Yn,{variant:"outline",size:"sm",children:j.jsx(i5,{className:"h-4 w-4"})})]})]})]}),lGe=tU,cGe=rU,uGe=nU,gae=ne.forwardRef(({className:e,...t},r)=>j.jsx(UE,{className:Tr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));gae.displayName=UE.displayName;const dGe=Wx("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),yae=ne.forwardRef(({side:e="right",className:t,children:r,...n},a)=>j.jsxs(uGe,{children:[j.jsx(gae,{}),j.jsxs(VE,{ref:a,className:Tr(dGe({side:e}),t),...n,children:[r,j.jsxs(iU,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[j.jsx(a5,{className:"h-4 w-4"}),j.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));yae.displayName=VE.displayName;const vae=({className:e,...t})=>j.jsx("div",{className:Tr("flex flex-col space-y-2 text-center sm:text-left",e),...t});vae.displayName="SheetHeader";const _ae=ne.forwardRef(({className:e,...t},r)=>j.jsx(WE,{ref:r,className:Tr("text-lg font-semibold text-foreground",e),...t}));_ae.displayName=WE.displayName;const hGe=ne.forwardRef(({className:e,...t},r)=>j.jsx(GE,{ref:r,className:Tr("text-sm text-muted-foreground",e),...t}));hGe.displayName=GE.displayName;var fGe="Label",xae=ne.forwardRef((e,t)=>j.jsx(Mn.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));xae.displayName=fGe;var bae=xae;const pGe=Wx("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),MO=ne.forwardRef(({className:e,...t},r)=>j.jsx(bae,{ref:r,className:Tr(pGe(),e),...t}));MO.displayName=bae.displayName;var lU="Checkbox",[mGe,LQe]=lf(lU),[gGe,yGe]=mGe(lU),wae=ne.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:l,required:h,disabled:i,value:_="on",onCheckedChange:b,form:E,...C}=e,[I,F]=ne.useState(null),$=Ci(t,Q=>F(Q)),B=ne.useRef(!1),q=I?E||!!I.closest("form"):!0,[G=!1,H]=Kh({prop:a,defaultProp:l,onChange:b}),J=ne.useRef(G);return ne.useEffect(()=>{const Q=I==null?void 0:I.form;if(Q){const oe=()=>H(J.current);return Q.addEventListener("reset",oe),()=>Q.removeEventListener("reset",oe)}},[I,H]),j.jsxs(gGe,{scope:r,state:G,disabled:i,children:[j.jsx(Mn.button,{type:"button",role:"checkbox","aria-checked":hm(G)?"mixed":G,"aria-required":h,"data-state":Eae(G),"data-disabled":i?"":void 0,disabled:i,value:_,...C,ref:$,onKeyDown:Kr(e.onKeyDown,Q=>{Q.key==="Enter"&&Q.preventDefault()}),onClick:Kr(e.onClick,Q=>{H(oe=>hm(oe)?!0:!oe),q&&(B.current=Q.isPropagationStopped(),B.current||Q.stopPropagation())})}),q&&j.jsx(vGe,{control:I,bubbles:!B.current,name:n,value:_,checked:G,required:h,disabled:i,form:E,style:{transform:"translateX(-100%)"},defaultChecked:hm(l)?!1:l})]})});wae.displayName=lU;var Sae="CheckboxIndicator",Tae=ne.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,l=yGe(Sae,r);return j.jsx(Gu,{present:n||hm(l.state)||l.state===!0,children:j.jsx(Mn.span,{"data-state":Eae(l.state),"data-disabled":l.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});Tae.displayName=Sae;var vGe=e=>{const{control:t,checked:r,bubbles:n=!0,defaultChecked:a,...l}=e,h=ne.useRef(null),i=V$(r),_=p5(t);ne.useEffect(()=>{const E=h.current,C=window.HTMLInputElement.prototype,F=Object.getOwnPropertyDescriptor(C,"checked").set;if(i!==r&&F){const $=new Event("click",{bubbles:n});E.indeterminate=hm(r),F.call(E,hm(r)?!1:r),E.dispatchEvent($)}},[i,r,n]);const b=ne.useRef(hm(r)?!1:r);return j.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??b.current,...l,tabIndex:-1,ref:h,style:{...e.style,..._,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function hm(e){return e==="indeterminate"}function Eae(e){return hm(e)?"indeterminate":e?"checked":"unchecked"}var Aae=wae,_Ge=Tae;const Cae=ne.forwardRef(({className:e,...t},r)=>j.jsx(Aae,{ref:r,className:Tr("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:j.jsx(_Ge,{className:Tr("flex items-center justify-center text-current"),children:j.jsx(wQ,{className:"h-4 w-4"})})}));Cae.displayName=Aae.displayName;const xGe=()=>{const[e,t]=ne.useState(!1),[r,n]=ne.useState(""),[a,l]=ne.useState([]),h=T5(),{data:i,isLoading:_}=Yy({queryKey:["unassigned-orders"],queryFn:async()=>{const{data:I,error:F}=await Oi.from("orders").select("*").eq("route_assigned",!1).order("created_at",{ascending:!1});if(F)throw F;return I}}),b=a0e({mutationFn:async()=>{if(!a.length)throw new Error("Selecciona al menos una orden");if(!r.trim())throw new Error("El alias es requerido");const{data:I,error:F}=await Oi.from("routes").insert([{alias:r}]).select().single();if(F)throw F;const $=a.map((q,G)=>({route_id:I.id,order_id:q,sequence_number:G+1})),{error:B}=await Oi.from("route_orders").insert($);if(B)throw B;return I},onSuccess:()=>{h.invalidateQueries({queryKey:["routes"]}),h.invalidateQueries({queryKey:["unassigned-orders"]}),Md.success("Ruta creada exitosamente"),t(!1),n(""),l([])},onError:I=>{Md.error(I.message)}}),E=async()=>{b.mutate()},C=I=>{l(F=>F.includes(I)?F.filter($=>$!==I):[...F,I])};return j.jsxs(lGe,{open:e,onOpenChange:t,children:[j.jsx(cGe,{asChild:!0,children:j.jsx(Yn,{children:"Nueva ruta"})}),j.jsxs(yae,{className:"w-[400px] sm:w-[540px] md:w-[750px]",children:[j.jsx(vae,{children:j.jsx(_ae,{children:"Crear nueva ruta"})}),j.jsxs("div",{className:"mt-6 space-y-6",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsx(MO,{htmlFor:"alias",children:"Alias de la ruta"}),j.jsx(wi,{id:"alias",value:r,onChange:I=>n(I.target.value),placeholder:"Ej: Zona Norte - Mañana"})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsx(MO,{children:"Selecciona las órdenes para esta ruta"}),_?j.jsx("div",{children:"Cargando órdenes..."}):i!=null&&i.length?j.jsx("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:i.map(I=>j.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[j.jsx(Cae,{id:I.id,checked:a.includes(I.id),onCheckedChange:()=>C(I.id)}),j.jsxs("div",{className:"space-y-1",children:[j.jsxs("label",{htmlFor:I.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[I.street," ",I.number,I.int_number&&`, Int. ${I.int_number}`]}),j.jsxs("p",{className:"text-sm text-muted-foreground",children:[I.neighborhood,", ",I.postal_code]})]})]},I.id))}):j.jsx("div",{className:"text-sm text-muted-foreground",children:"No hay órdenes disponibles para asignar"})]}),j.jsxs("div",{className:"flex justify-end space-x-2",children:[j.jsx(Yn,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),j.jsx(Yn,{onClick:E,disabled:!a.length||!r.trim()||b.isPending,children:"Crear ruta"})]})]})]})]})},Yd=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Yd.displayName="Card";const mb=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tr("flex flex-col space-y-1.5 p-6",e),...t}));mb.displayName="CardHeader";const gb=ne.forwardRef(({className:e,...t},r)=>j.jsx("h3",{ref:r,className:Tr("text-2xl font-semibold leading-none tracking-tight",e),...t}));gb.displayName="CardTitle";const qE=ne.forwardRef(({className:e,...t},r)=>j.jsx("p",{ref:r,className:Tr("text-sm text-muted-foreground",e),...t}));qE.displayName="CardDescription";const jm=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tr("p-6 pt-0",e),...t}));jm.displayName="CardContent";const Mae=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tr("flex items-center p-6 pt-0",e),...t}));Mae.displayName="CardFooter";const bGe=({status:e})=>{const r={pending:{label:"Pendiente",variant:"secondary"},active:{label:"En Progreso",variant:"default"},completed:{label:"Completada",variant:"outline"}}[e];return j.jsx(e4,{variant:r.variant,children:r.label})};function wGe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const Pae=Ae.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),yb=()=>{const e=Ae.useContext(Pae);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};wGe(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const SGe=24,TGe=typeof window<"u"?ne.useLayoutEffect:ne.useEffect;function aX(...e){return(...t)=>{for(let r of e)typeof r=="function"&&r(...t)}}function EGe(){return cU(/^Mac/)}function AGe(){return cU(/^iPhone/)}function sX(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function CGe(){return cU(/^iPad/)||EGe()&&navigator.maxTouchPoints>1}function Iae(){return AGe()||CGe()}function cU(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const TN=typeof document<"u"&&window.visualViewport;function lX(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function Oae(e){for(lX(e)&&(e=e.parentElement);e&&!lX(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const MGe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let UC=0,EN;function PGe(e={}){let{isDisabled:t}=e;TGe(()=>{if(!t)return UC++,UC===1&&Iae()&&(EN=IGe()),()=>{UC--,UC===0&&(EN==null||EN())}},[t])}function IGe(){let e,t=0,r=C=>{e=Oae(C.target),!(e===document.documentElement&&e===document.body)&&(t=C.changedTouches[0].pageY)},n=C=>{if(!e||e===document.documentElement||e===document.body){C.preventDefault();return}let I=C.changedTouches[0].pageY,F=e.scrollTop,$=e.scrollHeight-e.clientHeight;$!==0&&((F<=0&&I>t||F>=$&&I<t)&&C.preventDefault(),t=I)},a=C=>{let I=C.target;r4(I)&&I!==document.activeElement&&(C.preventDefault(),I.style.transform="translateY(-2000px)",I.focus(),requestAnimationFrame(()=>{I.style.transform=""}))},l=C=>{let I=C.target;r4(I)&&(I.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{I.style.transform="",TN&&(TN.height<window.innerHeight?requestAnimationFrame(()=>{cX(I)}):TN.addEventListener("resize",()=>cX(I),{once:!0}))}))},h=()=>{window.scrollTo(0,0)},i=window.pageXOffset,_=window.pageYOffset,b=aX(OGe(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let E=aX(Lw(document,"touchstart",r,{passive:!1,capture:!0}),Lw(document,"touchmove",n,{passive:!1,capture:!0}),Lw(document,"touchend",a,{passive:!1,capture:!0}),Lw(document,"focus",l,!0),Lw(window,"scroll",h));return()=>{b(),E(),window.scrollTo(i,_)}}function OGe(e,t,r){let n=e.style[t];return e.style[t]=r,()=>{e.style[t]=n}}function Lw(e,t,r,n){return e.addEventListener(t,r,n),()=>{e.removeEventListener(t,r,n)}}function cX(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let r=Oae(e);if(r!==document.documentElement&&r!==document.body&&r!==e){let n=r.getBoundingClientRect().top,a=e.getBoundingClientRect().top,l=e.getBoundingClientRect().bottom;const h=r.getBoundingClientRect().bottom+SGe;l>h&&(r.scrollTop+=a-n)}e=r.parentElement}}function r4(e){return e instanceof HTMLInputElement&&!MGe.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function kGe(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function RGe(...e){return t=>e.forEach(r=>kGe(r,t))}function kae(...e){return ne.useCallback(RGe(...e),e)}const Rae=new WeakMap;function va(e,t,r=!1){if(!e||!(e instanceof HTMLElement))return;let n={};Object.entries(t).forEach(([a,l])=>{if(a.startsWith("--")){e.style.setProperty(a,l);return}n[a]=e.style[a],e.style[a]=l}),!r&&Rae.set(e,n)}function DGe(e,t){if(!e||!(e instanceof HTMLElement))return;let r=Rae.get(e);r&&(e.style[t]=r[t])}const wa=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function VC(e,t){if(!e)return null;const r=window.getComputedStyle(e),n=r.transform||r.webkitTransform||r.mozTransform;let a=n.match(/^matrix3d\((.+)\)$/);return a?parseFloat(a[1].split(", ")[wa(t)?13:12]):(a=n.match(/^matrix\((.+)\)$/),a?parseFloat(a[1].split(", ")[wa(t)?5:4]):null)}function LGe(e){return 8*(Math.log(e+1)-2)}function AN(e,t){if(!e)return()=>{};const r=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=r}}function NGe(...e){return(...t)=>{for(const r of e)typeof r=="function"&&r(...t)}}const Co={DURATION:.5,EASE:[.32,.72,0,1]},Dae=.4,zGe=.25,jGe=100,Lae=8,Ng=16,n4=26,CN="vaul-dragging";function Nae(e){const t=Ae.useRef(e);return Ae.useEffect(()=>{t.current=e}),Ae.useMemo(()=>(...r)=>t.current==null?void 0:t.current.call(t,...r),[])}function FGe({defaultProp:e,onChange:t}){const r=Ae.useState(e),[n]=r,a=Ae.useRef(n),l=Nae(t);return Ae.useEffect(()=>{a.current!==n&&(l(n),a.current=n)},[n,a,l]),r}function zae({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=FGe({defaultProp:t,onChange:r}),l=e!==void 0,h=l?e:n,i=Nae(r),_=Ae.useCallback(b=>{if(l){const C=typeof b=="function"?b(e):b;C!==e&&i(C)}else a(b)},[l,e,a,i]);return[h,_]}function BGe({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:r,drawerRef:n,overlayRef:a,fadeFromIndex:l,onSnapPointChange:h,direction:i="bottom",container:_,snapToSequentialPoint:b}){const[E,C]=zae({prop:e,defaultProp:r==null?void 0:r[0],onChange:t}),[I,F]=Ae.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);Ae.useEffect(()=>{function ae(){F({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",ae),()=>window.removeEventListener("resize",ae)},[]);const $=Ae.useMemo(()=>E===(r==null?void 0:r[r.length-1])||null,[r,E]),B=Ae.useMemo(()=>r==null?void 0:r.findIndex(ae=>ae===E),[r,E]),q=r&&r.length>0&&(l||l===0)&&!Number.isNaN(l)&&r[l]===E||!r,G=Ae.useMemo(()=>{const ae=_?{width:_.getBoundingClientRect().width,height:_.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var ve;return(ve=r==null?void 0:r.map(Fe=>{const ke=typeof Fe=="string";let Ce=0;if(ke&&(Ce=parseInt(Fe,10)),wa(i)){const tt=ke?Ce:I?Fe*ae.height:0;return I?i==="bottom"?ae.height-tt:-ae.height+tt:tt}const je=ke?Ce:I?Fe*ae.width:0;return I?i==="right"?ae.width-je:-ae.width+je:je}))!=null?ve:[]},[r,I,_]),H=Ae.useMemo(()=>B!==null?G==null?void 0:G[B]:null,[G,B]),J=Ae.useCallback(ae=>{var ve;const Fe=(ve=G==null?void 0:G.findIndex(ke=>ke===ae))!=null?ve:null;h(Fe),va(n.current,{transition:`transform ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`,transform:wa(i)?`translate3d(0, ${ae}px, 0)`:`translate3d(${ae}px, 0, 0)`}),G&&Fe!==G.length-1&&Fe!==l&&Fe<l?va(a.current,{transition:`opacity ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`,opacity:"0"}):va(a.current,{transition:`opacity ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`,opacity:"1"}),C(r==null?void 0:r[Math.max(Fe,0)])},[n.current,r,G,l,a,C]);Ae.useEffect(()=>{if(E||e){var ae;const ve=(ae=r==null?void 0:r.findIndex(Fe=>Fe===e||Fe===E))!=null?ae:-1;G&&ve!==-1&&typeof G[ve]=="number"&&J(G[ve])}},[E,e,r,G,J]);function Q({draggedDistance:ae,closeDrawer:ve,velocity:Fe,dismissible:ke}){if(l===void 0)return;const Ce=i==="bottom"||i==="right"?(H??0)-ae:(H??0)+ae,je=B===l-1,tt=B===0,Ze=ae>0;if(je&&va(a.current,{transition:`opacity ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`}),!b&&Fe>2&&!Ze){ke?ve():J(G[0]);return}if(!b&&Fe>2&&Ze&&G&&r){J(G[r.length-1]);return}const Qe=G==null?void 0:G.reduce((ot,Be)=>typeof ot!="number"||typeof Be!="number"?ot:Math.abs(Be-Ce)<Math.abs(ot-Ce)?Be:ot),st=wa(i)?window.innerHeight:window.innerWidth;if(Fe>Dae&&Math.abs(ae)<st*.4){const ot=Ze?1:-1;if(ot>0&&$){J(G[r.length-1]);return}if(tt&&ot<0&&ke&&ve(),B===null)return;J(G[B+ot]);return}J(Qe)}function oe({draggedDistance:ae}){if(H===null)return;const ve=i==="bottom"||i==="right"?H-ae:H+ae;(i==="bottom"||i==="right")&&ve<G[G.length-1]||(i==="top"||i==="left")&&ve>G[G.length-1]||va(n.current,{transform:wa(i)?`translate3d(0, ${ve}px, 0)`:`translate3d(${ve}px, 0, 0)`})}function de(ae,ve){if(!r||typeof B!="number"||!G||l===void 0)return null;const Fe=B===l-1;if(B>=l&&ve)return 0;if(Fe&&!ve)return 1;if(!q&&!Fe)return null;const Ce=Fe?B+1:B-1,je=Fe?G[Ce]-G[Ce-1]:G[Ce+1]-G[Ce],tt=ae/Math.abs(je);return Fe?1-tt:tt}return{isLastSnapPoint:$,activeSnapPoint:E,shouldFade:q,getPercentageDragged:de,setActiveSnapPoint:C,activeSnapPointIndex:B,onRelease:Q,onDrag:oe,snapPointsOffset:G}}const $Ge=()=>()=>{};function UGe(){const{direction:e,isOpen:t,shouldScaleBackground:r,setBackgroundColorOnScale:n,noBodyStyles:a}=yb(),l=Ae.useRef(null),h=ne.useMemo(()=>document.body.style.backgroundColor,[]);function i(){return(window.innerWidth-n4)/window.innerWidth}Ae.useEffect(()=>{if(t&&r){l.current&&clearTimeout(l.current);const _=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!_)return;NGe(n&&!a?AN(document.body,{background:"black"}):$Ge,AN(_,{transformOrigin:wa(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${Co.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Co.EASE.join(",")})`}));const b=AN(_,{borderRadius:`${Lae}px`,overflow:"hidden",...wa(e)?{transform:`scale(${i()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${i()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{b(),l.current=window.setTimeout(()=>{h?document.body.style.background=h:document.body.style.removeProperty("background")},Co.DURATION*1e3)}}},[t,r,h])}let Nw=null;function VGe({isOpen:e,modal:t,nested:r,hasBeenOpened:n,preventScrollRestoration:a,noBodyStyles:l}){const[h,i]=Ae.useState(()=>typeof window<"u"?window.location.href:""),_=Ae.useRef(0),b=Ae.useCallback(()=>{if(sX()&&Nw===null&&e&&!l){Nw={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:C,innerHeight:I}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-_.current}px`,left:`${-C}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const F=I-window.innerHeight;F&&_.current>=I&&(document.body.style.top=`${-(_.current+F)}px`)}),300)}},[e]),E=Ae.useCallback(()=>{if(sX()&&Nw!==null&&!l){const C=-parseInt(document.body.style.top,10),I=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Nw),window.requestAnimationFrame(()=>{if(a&&h!==window.location.href){i(window.location.href);return}window.scrollTo(I,C)}),Nw=null}},[h]);return Ae.useEffect(()=>{function C(){_.current=window.scrollY}return C(),window.addEventListener("scroll",C),()=>{window.removeEventListener("scroll",C)}},[]),Ae.useEffect(()=>{r||!n||(e?(!window.matchMedia("(display-mode: standalone)").matches&&b(),t||window.setTimeout(()=>{E()},500)):E())},[e,n,h,t,r,b,E]),{restorePositionSetting:E}}function jae({open:e,onOpenChange:t,children:r,onDrag:n,onRelease:a,snapPoints:l,shouldScaleBackground:h=!1,setBackgroundColorOnScale:i=!0,closeThreshold:_=zGe,scrollLockTimeout:b=jGe,dismissible:E=!0,handleOnly:C=!1,fadeFromIndex:I=l&&l.length-1,activeSnapPoint:F,setActiveSnapPoint:$,fixed:B,modal:q=!0,onClose:G,nested:H,noBodyStyles:J,direction:Q="bottom",defaultOpen:oe=!1,disablePreventScroll:de=!0,snapToSequentialPoint:ae=!1,preventScrollRestoration:ve=!1,repositionInputs:Fe=!0,onAnimationEnd:ke,container:Ce,autoFocus:je=!1}){var tt,Ze;const[Qe=!1,st]=zae({defaultProp:oe,prop:e,onChange:Wt=>{t==null||t(Wt),!Wt&&!H&&oi(),setTimeout(()=>{ke==null||ke(Wt)},Co.DURATION*1e3),Wt&&!q&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),Wt||(document.body.style.pointerEvents="auto")}}),[ot,Be]=Ae.useState(!1),[lt,zt]=Ae.useState(!1),[Lt,Bt]=Ae.useState(!1),ct=Ae.useRef(null),nr=Ae.useRef(null),mr=Ae.useRef(null),ir=Ae.useRef(null),Ut=Ae.useRef(null),hr=Ae.useRef(!1),Vt=Ae.useRef(null),ge=Ae.useRef(0),ur=Ae.useRef(!1),Ot=Ae.useRef(0),tr=Ae.useRef(null),xt=Ae.useRef(((tt=tr.current)==null?void 0:tt.getBoundingClientRect().height)||0),un=Ae.useRef(((Ze=tr.current)==null?void 0:Ze.getBoundingClientRect().width)||0),Fr=Ae.useRef(0),Ln=Ae.useCallback(Wt=>{l&&Wt===dr.length-1&&(nr.current=new Date)},[]),{activeSnapPoint:Ge,activeSnapPointIndex:vt,setActiveSnapPoint:kt,onRelease:fr,snapPointsOffset:dr,onDrag:ar,shouldFade:Yt,getPercentageDragged:Zr}=BGe({snapPoints:l,activeSnapPointProp:F,setActiveSnapPointProp:$,drawerRef:tr,fadeFromIndex:I,overlayRef:ct,onSnapPointChange:Ln,direction:Q,container:Ce,snapToSequentialPoint:ae});PGe({isDisabled:!Qe||lt||!q||Lt||!ot||!Fe||!de});const{restorePositionSetting:oi}=VGe({isOpen:Qe,modal:q,nested:H,hasBeenOpened:ot,preventScrollRestoration:ve,noBodyStyles:J});function Bn(){return(window.innerWidth-n4)/window.innerWidth}function Ti(Wt){var Hr,Xr;!E&&!l||tr.current&&!tr.current.contains(Wt.target)||(xt.current=((Hr=tr.current)==null?void 0:Hr.getBoundingClientRect().height)||0,un.current=((Xr=tr.current)==null?void 0:Xr.getBoundingClientRect().width)||0,zt(!0),mr.current=new Date,Iae()&&window.addEventListener("touchend",()=>hr.current=!1,{once:!0}),Wt.target.setPointerCapture(Wt.pointerId),ge.current=wa(Q)?Wt.pageY:Wt.pageX)}function So(Wt,Hr){var Xr,cn;let fn=Wt;const ao=(Xr=window.getSelection())==null?void 0:Xr.toString(),Xi=tr.current?VC(tr.current,Q):null,Jo=new Date;if(fn.hasAttribute("data-vaul-no-drag")||fn.closest("[data-vaul-no-drag]"))return!1;if(Q==="right"||Q==="left")return!0;if(nr.current&&Jo.getTime()-nr.current.getTime()<500)return!1;if(Xi!==null&&(Q==="bottom"?Xi>0:Xi<0))return!0;if(ao&&ao.length>0)return!1;if(Jo.getTime()-((cn=Ut.current)==null?void 0:cn.getTime())<b&&Xi===0||Hr)return Ut.current=Jo,!1;for(;fn;){if(fn.scrollHeight>fn.clientHeight){if(fn.scrollTop!==0)return Ut.current=new Date,!1;if(fn.getAttribute("role")==="dialog")return!0}fn=fn.parentNode}return!0}function Wo(Wt){if(tr.current&&lt){const Hr=Q==="bottom"||Q==="right"?1:-1,Xr=(ge.current-(wa(Q)?Wt.pageY:Wt.pageX))*Hr,cn=Xr>0,fn=l&&!E&&!cn;if(fn&&vt===0)return;const ao=Math.abs(Xr),Xi=document.querySelector("[data-vaul-drawer-wrapper]"),Jo=Q==="bottom"||Q==="top"?xt.current:un.current;let Ma=ao/Jo;const _s=Zr(ao,cn);if(_s!==null&&(Ma=_s),fn&&Ma>=1||!hr.current&&!So(Wt.target,cn))return;if(tr.current.classList.add(CN),hr.current=!0,va(tr.current,{transition:"none"}),va(ct.current,{transition:"none"}),l&&ar({draggedDistance:Xr}),cn&&!l){const fe=LGe(Xr),ye=Math.min(fe*-1,0)*Hr;va(tr.current,{transform:wa(Q)?`translate3d(0, ${ye}px, 0)`:`translate3d(${ye}px, 0, 0)`});return}const ft=1-Ma;if((Yt||I&&vt===I-1)&&(n==null||n(Wt,Ma),va(ct.current,{opacity:`${ft}`,transition:"none"},!0)),Xi&&ct.current&&h){const fe=Math.min(Bn()+Ma*(1-Bn()),1),ye=8-Ma*8,Me=Math.max(0,14-Ma*14);va(Xi,{borderRadius:`${ye}px`,transform:wa(Q)?`scale(${fe}) translate3d(0, ${Me}px, 0)`:`scale(${fe}) translate3d(${Me}px, 0, 0)`,transition:"none"},!0)}if(!l){const fe=ao*Hr;va(tr.current,{transform:wa(Q)?`translate3d(0, ${fe}px, 0)`:`translate3d(${fe}px, 0, 0)`})}}}Ae.useEffect(()=>{var Wt;function Hr(){if(!tr.current||!Fe)return;const Xr=document.activeElement;if(r4(Xr)||ur.current){var cn;const fn=((cn=window.visualViewport)==null?void 0:cn.height)||0,ao=window.innerHeight;let Xi=ao-fn;const Jo=tr.current.getBoundingClientRect().height||0,Ma=Jo>ao*.8;Fr.current||(Fr.current=Jo);const _s=tr.current.getBoundingClientRect().top;if(Math.abs(Ot.current-Xi)>60&&(ur.current=!ur.current),l&&l.length>0&&dr&&vt){const ft=dr[vt]||0;Xi+=ft}if(Ot.current=Xi,Jo>fn||ur.current){const ft=tr.current.getBoundingClientRect().height;let fe=ft;ft>fn&&(fe=fn-(Ma?_s:n4)),B?tr.current.style.height=`${ft-Math.max(Xi,0)}px`:tr.current.style.height=`${Math.max(fe,fn-_s)}px`}else tr.current.style.height=`${Fr.current}px`;l&&l.length>0&&!ur.current?tr.current.style.bottom="0px":tr.current.style.bottom=`${Math.max(Xi,0)}px`}}return(Wt=window.visualViewport)==null||Wt.addEventListener("resize",Hr),()=>{var Xr;return(Xr=window.visualViewport)==null?void 0:Xr.removeEventListener("resize",Hr)}},[vt,l,dr]);function la(Wt){Ba(),G==null||G(),Wt||st(!1),setTimeout(()=>{l&&kt(l[0])},Co.DURATION*1e3)}function ys(){if(!tr.current)return;const Wt=document.querySelector("[data-vaul-drawer-wrapper]"),Hr=VC(tr.current,Q);va(tr.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`}),va(ct.current,{transition:`opacity ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`,opacity:"1"}),h&&Hr&&Hr>0&&Qe&&va(Wt,{borderRadius:`${Lae}px`,overflow:"hidden",...wa(Q)?{transform:`scale(${Bn()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Bn()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${Co.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Co.EASE.join(",")})`},!0)}function Ba(){!lt||!tr.current||(tr.current.classList.remove(CN),hr.current=!1,zt(!1),ir.current=new Date)}function vs(Wt){if(!lt||!tr.current)return;tr.current.classList.remove(CN),hr.current=!1,zt(!1),ir.current=new Date;const Hr=VC(tr.current,Q);if(!So(Wt.target,!1)||!Hr||Number.isNaN(Hr)||mr.current===null)return;const Xr=ir.current.getTime()-mr.current.getTime(),cn=ge.current-(wa(Q)?Wt.pageY:Wt.pageX),fn=Math.abs(cn)/Xr;if(fn>.05&&(Bt(!0),setTimeout(()=>{Bt(!1)},200)),l){fr({draggedDistance:cn*(Q==="bottom"||Q==="right"?1:-1),closeDrawer:la,velocity:fn,dismissible:E}),a==null||a(Wt,!0);return}if(Q==="bottom"||Q==="right"?cn>0:cn<0){ys(),a==null||a(Wt,!0);return}if(fn>Dae){la(),a==null||a(Wt,!1);return}var ao;const Xi=Math.min((ao=tr.current.getBoundingClientRect().height)!=null?ao:0,window.innerHeight);var Jo;const Ma=Math.min((Jo=tr.current.getBoundingClientRect().width)!=null?Jo:0,window.innerWidth),_s=Q==="left"||Q==="right";if(Math.abs(Hr)>=(_s?Ma:Xi)*_){la(),a==null||a(Wt,!1);return}a==null||a(Wt,!0),ys()}Ae.useEffect(()=>(Qe&&(va(document.documentElement,{scrollBehavior:"auto"}),nr.current=new Date),()=>{DGe(document.documentElement,"scrollBehavior")}),[Qe]);function go(Wt){const Hr=Wt?(window.innerWidth-Ng)/window.innerWidth:1,Xr=Wt?-Ng:0;Vt.current&&window.clearTimeout(Vt.current),va(tr.current,{transition:`transform ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`,transform:`scale(${Hr}) translate3d(0, ${Xr}px, 0)`}),!Wt&&tr.current&&(Vt.current=setTimeout(()=>{const cn=VC(tr.current,Q);va(tr.current,{transition:"none",transform:wa(Q)?`translate3d(0, ${cn}px, 0)`:`translate3d(${cn}px, 0, 0)`})},500))}function ca(Wt,Hr){if(Hr<0)return;const Xr=(window.innerWidth-Ng)/window.innerWidth,cn=Xr+Hr*(1-Xr),fn=-Ng+Hr*Ng;va(tr.current,{transform:wa(Q)?`scale(${cn}) translate3d(0, ${fn}px, 0)`:`scale(${cn}) translate3d(${fn}px, 0, 0)`,transition:"none"})}function ai(Wt,Hr){const Xr=wa(Q)?window.innerHeight:window.innerWidth,cn=Hr?(Xr-Ng)/Xr:1,fn=Hr?-Ng:0;Hr&&va(tr.current,{transition:`transform ${Co.DURATION}s cubic-bezier(${Co.EASE.join(",")})`,transform:wa(Q)?`scale(${cn}) translate3d(0, ${fn}px, 0)`:`scale(${cn}) translate3d(${fn}px, 0, 0)`})}return Ae.createElement(tU,{defaultOpen:oe,onOpenChange:Wt=>{!E&&!Wt||(Wt?Be(!0):la(!0),st(Wt))},open:Qe},Ae.createElement(Pae.Provider,{value:{activeSnapPoint:Ge,snapPoints:l,setActiveSnapPoint:kt,drawerRef:tr,overlayRef:ct,onOpenChange:t,onPress:Ti,onRelease:vs,onDrag:Wo,dismissible:E,handleOnly:C,isOpen:Qe,isDragging:lt,shouldFade:Yt,closeDrawer:la,onNestedDrag:ca,onNestedOpenChange:go,onNestedRelease:ai,keyboardIsOpen:ur,modal:q,snapPointsOffset:dr,direction:Q,shouldScaleBackground:h,setBackgroundColorOnScale:i,noBodyStyles:J,container:Ce,autoFocus:je}},r))}const Fae=Ae.forwardRef(function({...e},t){const{overlayRef:r,snapPoints:n,onRelease:a,shouldFade:l,isOpen:h,modal:i}=yb(),_=kae(t,r),b=n&&n.length>0;return i?Ae.createElement(UE,{onMouseUp:a,ref:_,"data-vaul-overlay":"","data-vaul-snap-points":h&&b?"true":"false","data-vaul-snap-points-overlay":h&&l?"true":"false",...e}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});Fae.displayName="Drawer.Overlay";const Bae=Ae.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:r,...n},a){const{drawerRef:l,onPress:h,onRelease:i,onDrag:_,keyboardIsOpen:b,snapPointsOffset:E,modal:C,isOpen:I,direction:F,snapPoints:$,container:B,handleOnly:q,autoFocus:G}=yb(),[H,J]=Ae.useState(!1),Q=kae(a,l),oe=Ae.useRef(null),de=Ae.useRef(null),ae=Ae.useRef(!1),ve=$&&$.length>0;UGe();const Fe=(Ce,je,tt=0)=>{if(ae.current)return!0;const Ze=Math.abs(Ce.y),Qe=Math.abs(Ce.x),st=Qe>Ze,ot=["bottom","right"].includes(je)?1:-1;if(je==="left"||je==="right"){if(!(Ce.x*ot<0)&&Qe>=0&&Qe<=tt)return st}else if(!(Ce.y*ot<0)&&Ze>=0&&Ze<=tt)return!st;return ae.current=!0,!0};Ae.useEffect(()=>{ve&&window.requestAnimationFrame(()=>{J(!0)})},[]);function ke(Ce){oe.current=null,ae.current=!1,i(Ce)}return Ae.createElement(VE,{"data-vaul-drawer-direction":F,"data-vaul-drawer":"","data-vaul-delayed-snap-points":H?"true":"false","data-vaul-snap-points":I&&ve?"true":"false","data-vaul-custom-container":B?"true":"false",...n,ref:Q,style:E&&E.length>0?{"--snap-point-height":`${E[0]}px`,...t}:t,onPointerDown:Ce=>{q||(n.onPointerDown==null||n.onPointerDown.call(n,Ce),oe.current={x:Ce.pageX,y:Ce.pageY},h(Ce))},onOpenAutoFocus:Ce=>{r==null||r(Ce),G||Ce.preventDefault()},onPointerDownOutside:Ce=>{if(e==null||e(Ce),!C||Ce.defaultPrevented){Ce.preventDefault();return}b.current&&(b.current=!1)},onFocusOutside:Ce=>{if(!C){Ce.preventDefault();return}},onPointerMove:Ce=>{if(de.current=Ce,q||(n.onPointerMove==null||n.onPointerMove.call(n,Ce),!oe.current))return;const je=Ce.pageY-oe.current.y,tt=Ce.pageX-oe.current.x,Ze=Ce.pointerType==="touch"?10:2;Fe({x:tt,y:je},F,Ze)?_(Ce):(Math.abs(tt)>Ze||Math.abs(je)>Ze)&&(oe.current=null)},onPointerUp:Ce=>{n.onPointerUp==null||n.onPointerUp.call(n,Ce),oe.current=null,ae.current=!1,i(Ce)},onPointerOut:Ce=>{n.onPointerOut==null||n.onPointerOut.call(n,Ce),ke(de.current)},onContextMenu:Ce=>{n.onContextMenu==null||n.onContextMenu.call(n,Ce),ke(de.current)}})});Bae.displayName="Drawer.Content";const WGe=250,GGe=120,$ae=Ae.forwardRef(function({preventCycle:e=!1,children:t,...r},n){const{closeDrawer:a,isDragging:l,snapPoints:h,activeSnapPoint:i,setActiveSnapPoint:_,dismissible:b,handleOnly:E,isOpen:C,onPress:I,onDrag:F}=yb(),$=Ae.useRef(null),B=Ae.useRef(!1);function q(){if(B.current){J();return}window.setTimeout(()=>{G()},GGe)}function G(){if(l||e||B.current){J();return}if(J(),(!h||h.length===0)&&b){a();return}if(i===h[h.length-1]&&b){a();return}const oe=h.findIndex(ae=>ae===i);if(oe===-1)return;const de=h[oe+1];_(de)}function H(){$.current=window.setTimeout(()=>{B.current=!0},WGe)}function J(){window.clearTimeout($.current),B.current=!1}return Ae.createElement("div",{onClick:q,onPointerCancel:J,onPointerDown:Q=>{E&&I(Q),H()},onPointerMove:Q=>{E&&F(Q)},ref:n,"data-vaul-drawer-visible":C?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},Ae.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});$ae.displayName="Drawer.Handle";function qGe({onDrag:e,onOpenChange:t,...r}){const{onNestedDrag:n,onNestedOpenChange:a,onNestedRelease:l}=yb();if(!n)throw new Error("Drawer.NestedRoot must be placed in another drawer");return Ae.createElement(jae,{nested:!0,onClose:()=>{a(!1)},onDrag:(h,i)=>{n(h,i),e==null||e(h,i)},onOpenChange:h=>{h&&a(h)},onRelease:l,...r})}function HGe(e){const t=yb(),{container:r=t.container,...n}=e;return Ae.createElement(nU,{container:r,...n})}const ff={Root:jae,NestedRoot:qGe,Content:Bae,Overlay:Fae,Trigger:rU,Portal:HGe,Handle:$ae,Close:iU,Title:WE,Description:GE},Uae=({shouldScaleBackground:e=!0,...t})=>j.jsx(ff.Root,{shouldScaleBackground:e,...t});Uae.displayName="Drawer";const ZGe=ff.Portal,Vae=ne.forwardRef(({className:e,...t},r)=>j.jsx(ff.Overlay,{ref:r,className:Tr("fixed inset-0 z-50 bg-black/80",e),...t}));Vae.displayName=ff.Overlay.displayName;const Wae=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(ZGe,{children:[j.jsx(Vae,{}),j.jsxs(ff.Content,{ref:n,className:Tr("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",e),...r,children:[j.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));Wae.displayName="DrawerContent";const Gae=({className:e,...t})=>j.jsx("div",{className:Tr("grid gap-1.5 p-4 text-center sm:text-left",e),...t});Gae.displayName="DrawerHeader";const qae=ne.forwardRef(({className:e,...t},r)=>j.jsx(ff.Title,{ref:r,className:Tr("text-lg font-semibold leading-none tracking-tight",e),...t}));qae.displayName=ff.Title.displayName;const XGe=ne.forwardRef(({className:e,...t},r)=>j.jsx(ff.Description,{ref:r,className:Tr("text-sm text-muted-foreground",e),...t}));XGe.displayName=ff.Description.displayName;const YGe=({routeId:e,isOpen:t,onClose:r})=>{const{data:n,isLoading:a}=Yy({queryKey:["route-orders",e],queryFn:async()=>{const{data:l,error:h}=await Oi.from("route_orders").select("order_id, sequence_number").eq("route_id",e).order("sequence_number");if(h)throw h;const{data:i,error:_}=await Oi.from("orders").select("*").in("id",(l==null?void 0:l.map(E=>E.order_id))||[]);if(_)throw _;return i==null?void 0:i.map(E=>{var C;return{...E,sequence_number:(C=l==null?void 0:l.find(I=>I.order_id===E.id))==null?void 0:C.sequence_number}}).sort((E,C)=>(E.sequence_number||0)-(C.sequence_number||0))},enabled:t&&!!e});return j.jsx(Uae,{open:t,onOpenChange:r,children:j.jsxs(Wae,{children:[j.jsx(Gae,{className:"border-b",children:j.jsx(qae,{children:"Detalle de la Ruta"})}),j.jsx("div",{className:"p-4",children:a?j.jsx("div",{className:"text-center py-4",children:"Cargando órdenes..."}):n!=null&&n.length?j.jsx("div",{className:"space-y-4",children:n.map((l,h)=>j.jsx("div",{className:"border rounded-lg p-4",children:j.jsx("div",{className:"flex items-start justify-between",children:j.jsxs("div",{children:[j.jsxs("div",{className:"text-sm font-medium mb-1",children:["Orden #",l.sequence_number]}),j.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[l.street," ",l.number,l.int_number&&`, Int. ${l.int_number}`]}),j.jsxs("div",{className:"text-sm text-muted-foreground",children:[l.neighborhood,", ",l.postal_code]}),l.reference&&j.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:["Referencia: ",l.reference]}),l.notes&&j.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["Notas: ",l.notes]})]})})},l.id))}):j.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No hay órdenes asignadas a esta ruta"})})]})})},KGe=({route:e})=>{const[t,r]=ne.useState(!1);return j.jsxs(j.Fragment,{children:[j.jsxs(Yd,{className:"overflow-hidden",children:[j.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[j.jsxs("div",{children:[j.jsx("h3",{className:"font-medium",children:e.alias}),j.jsx("p",{className:"text-sm text-muted-foreground",children:e.id.slice(0,8)})]}),j.jsx(bGe,{status:e.status})]}),j.jsxs(jm,{className:"p-4",children:[j.jsx("div",{className:"mb-4",children:j.jsx("div",{className:"flex justify-between mt-1 text-sm text-muted-foreground",children:j.jsxs("span",{children:[e.route_orders.length," órdenes"]})})}),j.jsx("div",{className:"space-y-2",children:e.operators&&j.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[j.jsx(cM,{className:"h-4 w-4 text-muted-foreground"}),j.jsx("span",{className:"text-muted-foreground",children:"Operador:"}),j.jsxs("span",{className:"font-medium",children:[e.operators.name," ",e.operators.lastname]})]})}),j.jsxs("div",{className:"mt-4 pt-4 border-t flex justify-end gap-2",children:[j.jsx(Yn,{variant:"outline",size:"sm",onClick:()=>r(!0),children:"Ver detalle"}),!e.operator_id&&j.jsx(Yn,{size:"sm",children:"Asignar operador"})]})]})]},e.id),j.jsx(YGe,{routeId:e.id,isOpen:t,onClose:()=>r(!1)})]})},JGe=e=>e==="pending"||e==="active"||e==="completed"?e:"pending",QGe=({activeTab:e})=>{const{data:t,isLoading:r}=Yy({queryKey:["routes",e],queryFn:async()=>{const n=Oi.from("routes").select(`
          *,
          route_orders(
            order_id,
            sequence_number
          ),
          operators:operator_id(
            name,
            lastname
          )
        `).order("created_at",{ascending:!1});e!=="todas"&&n.eq("status",e);const{data:a,error:l}=await n;if(l)throw l;return a}});return r?j.jsx("div",{className:"w-full text-center py-4",children:"Cargando rutas..."}):t!=null&&t.length?j.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(n=>j.jsx(KGe,{route:{...n,status:JGe(n.status)}},n.id))}):j.jsx("div",{className:"w-full text-center py-8 text-muted-foreground",children:"No hay rutas para mostrar"})},eqe=()=>{const[e,t]=ne.useState("todas");return j.jsxs("div",{className:"animate-fade-in bg-gray-50 p-4 rounded-lg shadow-sm",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Rutas"}),j.jsx(xGe,{})]}),j.jsxs(Y$,{value:e,onValueChange:r=>t(r),className:"mb-6",children:[j.jsxs(OR,{className:"mb-4",children:[j.jsx(Mu,{value:"todas",children:"Todas"}),j.jsx(Mu,{value:"active",children:"En Progreso"}),j.jsx(Mu,{value:"pending",children:"Pendientes"}),j.jsx(Mu,{value:"completed",children:"Completadas"})]}),j.jsx(dm,{value:e,children:j.jsx(QGe,{activeTab:e})})]})]})};var Hae={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Na,function(){var r,n,a;function l(i,_){if(!r)r=_;else if(!n)n=_;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",E={};r(E),a=_(E),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}l(["exports"],function(i){function _(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var b,E={},C={};function I(){if(b)return C;b=1,Object.defineProperty(C,"__esModule",{value:!0}),C.setMatrixArrayType=function(m){C.ARRAY_TYPE=o=m},C.toRadian=function(m){return m*f},C.equals=function(m,p){return Math.abs(m-p)<=d*Math.max(1,Math.abs(m),Math.abs(p))},C.RANDOM=C.ARRAY_TYPE=C.EPSILON=void 0;var d=1e-6;C.EPSILON=d;var o=typeof Float32Array<"u"?Float32Array:Array;C.ARRAY_TYPE=o;var c=Math.random;C.RANDOM=c;var f=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,p=arguments.length;p--;)m+=arguments[p]*arguments[p];return Math.sqrt(m)}),C}var F,$={};function B(){if(F)return $;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},d(p)}F=1,Object.defineProperty($,"__esModule",{value:!0}),$.create=function(){var p=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p},$.clone=function(p){var v=new o.ARRAY_TYPE(4);return v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v},$.copy=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[3],p},$.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p},$.fromValues=function(p,v,T,M){var k=new o.ARRAY_TYPE(4);return k[0]=p,k[1]=v,k[2]=T,k[3]=M,k},$.set=function(p,v,T,M,k){return p[0]=v,p[1]=T,p[2]=M,p[3]=k,p},$.transpose=function(p,v){if(p===v){var T=v[1];p[1]=v[2],p[2]=T}else p[0]=v[0],p[1]=v[2],p[2]=v[1],p[3]=v[3];return p},$.invert=function(p,v){var T=v[0],M=v[1],k=v[2],w=v[3],P=T*w-k*M;return P?(p[0]=w*(P=1/P),p[1]=-M*P,p[2]=-k*P,p[3]=T*P,p):null},$.adjoint=function(p,v){var T=v[0];return p[0]=v[3],p[1]=-v[1],p[2]=-v[2],p[3]=T,p},$.determinant=function(p){return p[0]*p[3]-p[2]*p[1]},$.multiply=f,$.rotate=function(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=Math.sin(T),O=Math.cos(T);return p[0]=M*O+w*D,p[1]=k*O+P*D,p[2]=M*-D+w*O,p[3]=k*-D+P*O,p},$.scale=function(p,v,T){var M=v[1],k=v[2],w=v[3],P=T[0],D=T[1];return p[0]=v[0]*P,p[1]=M*P,p[2]=k*D,p[3]=w*D,p},$.fromRotation=function(p,v){var T=Math.sin(v),M=Math.cos(v);return p[0]=M,p[1]=T,p[2]=-T,p[3]=M,p},$.fromScaling=function(p,v){return p[0]=v[0],p[1]=0,p[2]=0,p[3]=v[1],p},$.str=function(p){return"mat2("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+")"},$.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3])},$.LDU=function(p,v,T,M){return p[2]=M[2]/M[0],T[0]=M[0],T[1]=M[1],T[3]=M[3]-p[2]*T[1],[p,v,T]},$.add=function(p,v,T){return p[0]=v[0]+T[0],p[1]=v[1]+T[1],p[2]=v[2]+T[2],p[3]=v[3]+T[3],p},$.subtract=m,$.exactEquals=function(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]&&p[3]===v[3]},$.equals=function(p,v){var T=p[0],M=p[1],k=p[2],w=p[3],P=v[0],D=v[1],O=v[2],R=v[3];return Math.abs(T-P)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(P))&&Math.abs(M-D)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(k-O)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(O))&&Math.abs(w-R)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(R))},$.multiplyScalar=function(p,v,T){return p[0]=v[0]*T,p[1]=v[1]*T,p[2]=v[2]*T,p[3]=v[3]*T,p},$.multiplyScalarAndAdd=function(p,v,T,M){return p[0]=v[0]+T[0]*M,p[1]=v[1]+T[1]*M,p[2]=v[2]+T[2]*M,p[3]=v[3]+T[3]*M,p},$.sub=$.mul=void 0;var o=function(p,v){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var T=c(void 0);if(T&&T.has(p))return T.get(p);var M={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if(w!=="default"&&Object.prototype.hasOwnProperty.call(p,w)){var P=k?Object.getOwnPropertyDescriptor(p,w):null;P&&(P.get||P.set)?Object.defineProperty(M,w,P):M[w]=p[w]}return M.default=p,T&&T.set(p,M),M}(I());function c(p){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(c=function(M){return M?T:v})(p)}function f(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=T[0],O=T[1],R=T[2],N=T[3];return p[0]=M*D+w*O,p[1]=k*D+P*O,p[2]=M*R+w*N,p[3]=k*R+P*N,p}function m(p,v,T){return p[0]=v[0]-T[0],p[1]=v[1]-T[1],p[2]=v[2]-T[2],p[3]=v[3]-T[3],p}return $.mul=f,$.sub=m,$}var q,G={};function H(){if(q)return G;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},d(p)}q=1,Object.defineProperty(G,"__esModule",{value:!0}),G.create=function(){var p=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[4]=0,p[5]=0),p[0]=1,p[3]=1,p},G.clone=function(p){var v=new o.ARRAY_TYPE(6);return v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v[4]=p[4],v[5]=p[5],v},G.copy=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[3],p[4]=v[4],p[5]=v[5],p},G.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=0,p[5]=0,p},G.fromValues=function(p,v,T,M,k,w){var P=new o.ARRAY_TYPE(6);return P[0]=p,P[1]=v,P[2]=T,P[3]=M,P[4]=k,P[5]=w,P},G.set=function(p,v,T,M,k,w,P){return p[0]=v,p[1]=T,p[2]=M,p[3]=k,p[4]=w,p[5]=P,p},G.invert=function(p,v){var T=v[0],M=v[1],k=v[2],w=v[3],P=v[4],D=v[5],O=T*w-M*k;return O?(p[0]=w*(O=1/O),p[1]=-M*O,p[2]=-k*O,p[3]=T*O,p[4]=(k*D-w*P)*O,p[5]=(M*P-T*D)*O,p):null},G.determinant=function(p){return p[0]*p[3]-p[1]*p[2]},G.multiply=f,G.rotate=function(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=v[4],O=v[5],R=Math.sin(T),N=Math.cos(T);return p[0]=M*N+w*R,p[1]=k*N+P*R,p[2]=M*-R+w*N,p[3]=k*-R+P*N,p[4]=D,p[5]=O,p},G.scale=function(p,v,T){var M=v[1],k=v[2],w=v[3],P=v[4],D=v[5],O=T[0],R=T[1];return p[0]=v[0]*O,p[1]=M*O,p[2]=k*R,p[3]=w*R,p[4]=P,p[5]=D,p},G.translate=function(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=v[4],O=v[5],R=T[0],N=T[1];return p[0]=M,p[1]=k,p[2]=w,p[3]=P,p[4]=M*R+w*N+D,p[5]=k*R+P*N+O,p},G.fromRotation=function(p,v){var T=Math.sin(v),M=Math.cos(v);return p[0]=M,p[1]=T,p[2]=-T,p[3]=M,p[4]=0,p[5]=0,p},G.fromScaling=function(p,v){return p[0]=v[0],p[1]=0,p[2]=0,p[3]=v[1],p[4]=0,p[5]=0,p},G.fromTranslation=function(p,v){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=v[0],p[5]=v[1],p},G.str=function(p){return"mat2d("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+")"},G.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],1)},G.add=function(p,v,T){return p[0]=v[0]+T[0],p[1]=v[1]+T[1],p[2]=v[2]+T[2],p[3]=v[3]+T[3],p[4]=v[4]+T[4],p[5]=v[5]+T[5],p},G.subtract=m,G.multiplyScalar=function(p,v,T){return p[0]=v[0]*T,p[1]=v[1]*T,p[2]=v[2]*T,p[3]=v[3]*T,p[4]=v[4]*T,p[5]=v[5]*T,p},G.multiplyScalarAndAdd=function(p,v,T,M){return p[0]=v[0]+T[0]*M,p[1]=v[1]+T[1]*M,p[2]=v[2]+T[2]*M,p[3]=v[3]+T[3]*M,p[4]=v[4]+T[4]*M,p[5]=v[5]+T[5]*M,p},G.exactEquals=function(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]&&p[3]===v[3]&&p[4]===v[4]&&p[5]===v[5]},G.equals=function(p,v){var T=p[0],M=p[1],k=p[2],w=p[3],P=p[4],D=p[5],O=v[0],R=v[1],N=v[2],W=v[3],Z=v[4],te=v[5];return Math.abs(T-O)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(O))&&Math.abs(M-R)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(k-N)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(N))&&Math.abs(w-W)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(W))&&Math.abs(P-Z)<=o.EPSILON*Math.max(1,Math.abs(P),Math.abs(Z))&&Math.abs(D-te)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(te))},G.sub=G.mul=void 0;var o=function(p,v){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var T=c(void 0);if(T&&T.has(p))return T.get(p);var M={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if(w!=="default"&&Object.prototype.hasOwnProperty.call(p,w)){var P=k?Object.getOwnPropertyDescriptor(p,w):null;P&&(P.get||P.set)?Object.defineProperty(M,w,P):M[w]=p[w]}return M.default=p,T&&T.set(p,M),M}(I());function c(p){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(c=function(M){return M?T:v})(p)}function f(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=v[4],O=v[5],R=T[0],N=T[1],W=T[2],Z=T[3],te=T[4],ee=T[5];return p[0]=M*R+w*N,p[1]=k*R+P*N,p[2]=M*W+w*Z,p[3]=k*W+P*Z,p[4]=M*te+w*ee+D,p[5]=k*te+P*ee+O,p}function m(p,v,T){return p[0]=v[0]-T[0],p[1]=v[1]-T[1],p[2]=v[2]-T[2],p[3]=v[3]-T[3],p[4]=v[4]-T[4],p[5]=v[5]-T[5],p}return G.mul=f,G.sub=m,G}var J,Q={};function oe(){if(J)return Q;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},d(p)}J=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.create=function(){var p=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p},Q.fromMat4=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[4],p[4]=v[5],p[5]=v[6],p[6]=v[8],p[7]=v[9],p[8]=v[10],p},Q.clone=function(p){var v=new o.ARRAY_TYPE(9);return v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v[4]=p[4],v[5]=p[5],v[6]=p[6],v[7]=p[7],v[8]=p[8],v},Q.copy=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[3],p[4]=v[4],p[5]=v[5],p[6]=v[6],p[7]=v[7],p[8]=v[8],p},Q.fromValues=function(p,v,T,M,k,w,P,D,O){var R=new o.ARRAY_TYPE(9);return R[0]=p,R[1]=v,R[2]=T,R[3]=M,R[4]=k,R[5]=w,R[6]=P,R[7]=D,R[8]=O,R},Q.set=function(p,v,T,M,k,w,P,D,O,R){return p[0]=v,p[1]=T,p[2]=M,p[3]=k,p[4]=w,p[5]=P,p[6]=D,p[7]=O,p[8]=R,p},Q.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},Q.transpose=function(p,v){if(p===v){var T=v[1],M=v[2],k=v[5];p[1]=v[3],p[2]=v[6],p[3]=T,p[5]=v[7],p[6]=M,p[7]=k}else p[0]=v[0],p[1]=v[3],p[2]=v[6],p[3]=v[1],p[4]=v[4],p[5]=v[7],p[6]=v[2],p[7]=v[5],p[8]=v[8];return p},Q.invert=function(p,v){var T=v[0],M=v[1],k=v[2],w=v[3],P=v[4],D=v[5],O=v[6],R=v[7],N=v[8],W=N*P-D*R,Z=-N*w+D*O,te=R*w-P*O,ee=T*W+M*Z+k*te;return ee?(p[0]=W*(ee=1/ee),p[1]=(-N*M+k*R)*ee,p[2]=(D*M-k*P)*ee,p[3]=Z*ee,p[4]=(N*T-k*O)*ee,p[5]=(-D*T+k*w)*ee,p[6]=te*ee,p[7]=(-R*T+M*O)*ee,p[8]=(P*T-M*w)*ee,p):null},Q.adjoint=function(p,v){var T=v[0],M=v[1],k=v[2],w=v[3],P=v[4],D=v[5],O=v[6],R=v[7],N=v[8];return p[0]=P*N-D*R,p[1]=k*R-M*N,p[2]=M*D-k*P,p[3]=D*O-w*N,p[4]=T*N-k*O,p[5]=k*w-T*D,p[6]=w*R-P*O,p[7]=M*O-T*R,p[8]=T*P-M*w,p},Q.determinant=function(p){var v=p[3],T=p[4],M=p[5],k=p[6],w=p[7],P=p[8];return p[0]*(P*T-M*w)+p[1]*(-P*v+M*k)+p[2]*(w*v-T*k)},Q.multiply=f,Q.translate=function(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=v[4],O=v[5],R=v[6],N=v[7],W=v[8],Z=T[0],te=T[1];return p[0]=M,p[1]=k,p[2]=w,p[3]=P,p[4]=D,p[5]=O,p[6]=Z*M+te*P+R,p[7]=Z*k+te*D+N,p[8]=Z*w+te*O+W,p},Q.rotate=function(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=v[4],O=v[5],R=v[6],N=v[7],W=v[8],Z=Math.sin(T),te=Math.cos(T);return p[0]=te*M+Z*P,p[1]=te*k+Z*D,p[2]=te*w+Z*O,p[3]=te*P-Z*M,p[4]=te*D-Z*k,p[5]=te*O-Z*w,p[6]=R,p[7]=N,p[8]=W,p},Q.scale=function(p,v,T){var M=T[0],k=T[1];return p[0]=M*v[0],p[1]=M*v[1],p[2]=M*v[2],p[3]=k*v[3],p[4]=k*v[4],p[5]=k*v[5],p[6]=v[6],p[7]=v[7],p[8]=v[8],p},Q.fromTranslation=function(p,v){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=v[0],p[7]=v[1],p[8]=1,p},Q.fromRotation=function(p,v){var T=Math.sin(v),M=Math.cos(v);return p[0]=M,p[1]=T,p[2]=0,p[3]=-T,p[4]=M,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},Q.fromScaling=function(p,v){return p[0]=v[0],p[1]=0,p[2]=0,p[3]=0,p[4]=v[1],p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},Q.fromMat2d=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=0,p[3]=v[2],p[4]=v[3],p[5]=0,p[6]=v[4],p[7]=v[5],p[8]=1,p},Q.fromQuat=function(p,v){var T=v[0],M=v[1],k=v[2],w=v[3],P=T+T,D=M+M,O=k+k,R=T*P,N=M*P,W=M*D,Z=k*P,te=k*D,ee=k*O,K=w*P,ie=w*D,le=w*O;return p[0]=1-W-ee,p[3]=N-le,p[6]=Z+ie,p[1]=N+le,p[4]=1-R-ee,p[7]=te-K,p[2]=Z-ie,p[5]=te+K,p[8]=1-R-W,p},Q.normalFromMat4=function(p,v){var T=v[0],M=v[1],k=v[2],w=v[3],P=v[4],D=v[5],O=v[6],R=v[7],N=v[8],W=v[9],Z=v[10],te=v[11],ee=v[12],K=v[13],ie=v[14],le=v[15],he=T*D-M*P,we=T*O-k*P,_e=T*R-w*P,xe=M*O-k*D,De=M*R-w*D,Se=k*R-w*O,Le=N*K-W*ee,We=N*ie-Z*ee,Ue=N*le-te*ee,Xe=W*ie-Z*K,He=W*le-te*K,nt=Z*le-te*ie,Je=he*nt-we*He+_e*Xe+xe*Ue-De*We+Se*Le;return Je?(p[0]=(D*nt-O*He+R*Xe)*(Je=1/Je),p[1]=(O*Ue-P*nt-R*We)*Je,p[2]=(P*He-D*Ue+R*Le)*Je,p[3]=(k*He-M*nt-w*Xe)*Je,p[4]=(T*nt-k*Ue+w*We)*Je,p[5]=(M*Ue-T*He-w*Le)*Je,p[6]=(K*Se-ie*De+le*xe)*Je,p[7]=(ie*_e-ee*Se-le*we)*Je,p[8]=(ee*De-K*_e+le*he)*Je,p):null},Q.projection=function(p,v,T){return p[0]=2/v,p[1]=0,p[2]=0,p[3]=0,p[4]=-2/T,p[5]=0,p[6]=-1,p[7]=1,p[8]=1,p},Q.str=function(p){return"mat3("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+")"},Q.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},Q.add=function(p,v,T){return p[0]=v[0]+T[0],p[1]=v[1]+T[1],p[2]=v[2]+T[2],p[3]=v[3]+T[3],p[4]=v[4]+T[4],p[5]=v[5]+T[5],p[6]=v[6]+T[6],p[7]=v[7]+T[7],p[8]=v[8]+T[8],p},Q.subtract=m,Q.multiplyScalar=function(p,v,T){return p[0]=v[0]*T,p[1]=v[1]*T,p[2]=v[2]*T,p[3]=v[3]*T,p[4]=v[4]*T,p[5]=v[5]*T,p[6]=v[6]*T,p[7]=v[7]*T,p[8]=v[8]*T,p},Q.multiplyScalarAndAdd=function(p,v,T,M){return p[0]=v[0]+T[0]*M,p[1]=v[1]+T[1]*M,p[2]=v[2]+T[2]*M,p[3]=v[3]+T[3]*M,p[4]=v[4]+T[4]*M,p[5]=v[5]+T[5]*M,p[6]=v[6]+T[6]*M,p[7]=v[7]+T[7]*M,p[8]=v[8]+T[8]*M,p},Q.exactEquals=function(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]&&p[3]===v[3]&&p[4]===v[4]&&p[5]===v[5]&&p[6]===v[6]&&p[7]===v[7]&&p[8]===v[8]},Q.equals=function(p,v){var T=p[0],M=p[1],k=p[2],w=p[3],P=p[4],D=p[5],O=p[6],R=p[7],N=p[8],W=v[0],Z=v[1],te=v[2],ee=v[3],K=v[4],ie=v[5],le=v[6],he=v[7],we=v[8];return Math.abs(T-W)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(M-Z)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(Z))&&Math.abs(k-te)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(te))&&Math.abs(w-ee)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(ee))&&Math.abs(P-K)<=o.EPSILON*Math.max(1,Math.abs(P),Math.abs(K))&&Math.abs(D-ie)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(ie))&&Math.abs(O-le)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(le))&&Math.abs(R-he)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(he))&&Math.abs(N-we)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(we))},Q.sub=Q.mul=void 0;var o=function(p,v){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var T=c(void 0);if(T&&T.has(p))return T.get(p);var M={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if(w!=="default"&&Object.prototype.hasOwnProperty.call(p,w)){var P=k?Object.getOwnPropertyDescriptor(p,w):null;P&&(P.get||P.set)?Object.defineProperty(M,w,P):M[w]=p[w]}return M.default=p,T&&T.set(p,M),M}(I());function c(p){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(c=function(M){return M?T:v})(p)}function f(p,v,T){var M=v[0],k=v[1],w=v[2],P=v[3],D=v[4],O=v[5],R=v[6],N=v[7],W=v[8],Z=T[0],te=T[1],ee=T[2],K=T[3],ie=T[4],le=T[5],he=T[6],we=T[7],_e=T[8];return p[0]=Z*M+te*P+ee*R,p[1]=Z*k+te*D+ee*N,p[2]=Z*w+te*O+ee*W,p[3]=K*M+ie*P+le*R,p[4]=K*k+ie*D+le*N,p[5]=K*w+ie*O+le*W,p[6]=he*M+we*P+_e*R,p[7]=he*k+we*D+_e*N,p[8]=he*w+we*O+_e*W,p}function m(p,v,T){return p[0]=v[0]-T[0],p[1]=v[1]-T[1],p[2]=v[2]-T[2],p[3]=v[3]-T[3],p[4]=v[4]-T[4],p[5]=v[5]-T[5],p[6]=v[6]-T[6],p[7]=v[7]-T[7],p[8]=v[8]-T[8],p}return Q.mul=f,Q.sub=m,Q}var de,ae={};function ve(){if(de)return ae;function d(w){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},d(w)}de=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=function(){var w=new o.ARRAY_TYPE(16);return o.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},ae.clone=function(w){var P=new o.ARRAY_TYPE(16);return P[0]=w[0],P[1]=w[1],P[2]=w[2],P[3]=w[3],P[4]=w[4],P[5]=w[5],P[6]=w[6],P[7]=w[7],P[8]=w[8],P[9]=w[9],P[10]=w[10],P[11]=w[11],P[12]=w[12],P[13]=w[13],P[14]=w[14],P[15]=w[15],P},ae.copy=function(w,P){return w[0]=P[0],w[1]=P[1],w[2]=P[2],w[3]=P[3],w[4]=P[4],w[5]=P[5],w[6]=P[6],w[7]=P[7],w[8]=P[8],w[9]=P[9],w[10]=P[10],w[11]=P[11],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15],w},ae.fromValues=function(w,P,D,O,R,N,W,Z,te,ee,K,ie,le,he,we,_e){var xe=new o.ARRAY_TYPE(16);return xe[0]=w,xe[1]=P,xe[2]=D,xe[3]=O,xe[4]=R,xe[5]=N,xe[6]=W,xe[7]=Z,xe[8]=te,xe[9]=ee,xe[10]=K,xe[11]=ie,xe[12]=le,xe[13]=he,xe[14]=we,xe[15]=_e,xe},ae.set=function(w,P,D,O,R,N,W,Z,te,ee,K,ie,le,he,we,_e,xe){return w[0]=P,w[1]=D,w[2]=O,w[3]=R,w[4]=N,w[5]=W,w[6]=Z,w[7]=te,w[8]=ee,w[9]=K,w[10]=ie,w[11]=le,w[12]=he,w[13]=we,w[14]=_e,w[15]=xe,w},ae.identity=f,ae.transpose=function(w,P){if(w===P){var D=P[1],O=P[2],R=P[3],N=P[6],W=P[7],Z=P[11];w[1]=P[4],w[2]=P[8],w[3]=P[12],w[4]=D,w[6]=P[9],w[7]=P[13],w[8]=O,w[9]=N,w[11]=P[14],w[12]=R,w[13]=W,w[14]=Z}else w[0]=P[0],w[1]=P[4],w[2]=P[8],w[3]=P[12],w[4]=P[1],w[5]=P[5],w[6]=P[9],w[7]=P[13],w[8]=P[2],w[9]=P[6],w[10]=P[10],w[11]=P[14],w[12]=P[3],w[13]=P[7],w[14]=P[11],w[15]=P[15];return w},ae.invert=function(w,P){var D=P[0],O=P[1],R=P[2],N=P[3],W=P[4],Z=P[5],te=P[6],ee=P[7],K=P[8],ie=P[9],le=P[10],he=P[11],we=P[12],_e=P[13],xe=P[14],De=P[15],Se=D*Z-O*W,Le=D*te-R*W,We=D*ee-N*W,Ue=O*te-R*Z,Xe=O*ee-N*Z,He=R*ee-N*te,nt=K*_e-ie*we,Je=K*xe-le*we,it=K*De-he*we,Mt=ie*xe-le*_e,At=ie*De-he*_e,er=le*De-he*xe,Rt=Se*er-Le*At+We*Mt+Ue*it-Xe*Je+He*nt;return Rt?(w[0]=(Z*er-te*At+ee*Mt)*(Rt=1/Rt),w[1]=(R*At-O*er-N*Mt)*Rt,w[2]=(_e*He-xe*Xe+De*Ue)*Rt,w[3]=(le*Xe-ie*He-he*Ue)*Rt,w[4]=(te*it-W*er-ee*Je)*Rt,w[5]=(D*er-R*it+N*Je)*Rt,w[6]=(xe*We-we*He-De*Le)*Rt,w[7]=(K*He-le*We+he*Le)*Rt,w[8]=(W*At-Z*it+ee*nt)*Rt,w[9]=(O*it-D*At-N*nt)*Rt,w[10]=(we*Xe-_e*We+De*Se)*Rt,w[11]=(ie*We-K*Xe-he*Se)*Rt,w[12]=(Z*Je-W*Mt-te*nt)*Rt,w[13]=(D*Mt-O*Je+R*nt)*Rt,w[14]=(_e*Le-we*Ue-xe*Se)*Rt,w[15]=(K*Ue-ie*Le+le*Se)*Rt,w):null},ae.adjoint=function(w,P){var D=P[0],O=P[1],R=P[2],N=P[3],W=P[4],Z=P[5],te=P[6],ee=P[7],K=P[8],ie=P[9],le=P[10],he=P[11],we=P[12],_e=P[13],xe=P[14],De=P[15];return w[0]=Z*(le*De-he*xe)-ie*(te*De-ee*xe)+_e*(te*he-ee*le),w[1]=-(O*(le*De-he*xe)-ie*(R*De-N*xe)+_e*(R*he-N*le)),w[2]=O*(te*De-ee*xe)-Z*(R*De-N*xe)+_e*(R*ee-N*te),w[3]=-(O*(te*he-ee*le)-Z*(R*he-N*le)+ie*(R*ee-N*te)),w[4]=-(W*(le*De-he*xe)-K*(te*De-ee*xe)+we*(te*he-ee*le)),w[5]=D*(le*De-he*xe)-K*(R*De-N*xe)+we*(R*he-N*le),w[6]=-(D*(te*De-ee*xe)-W*(R*De-N*xe)+we*(R*ee-N*te)),w[7]=D*(te*he-ee*le)-W*(R*he-N*le)+K*(R*ee-N*te),w[8]=W*(ie*De-he*_e)-K*(Z*De-ee*_e)+we*(Z*he-ee*ie),w[9]=-(D*(ie*De-he*_e)-K*(O*De-N*_e)+we*(O*he-N*ie)),w[10]=D*(Z*De-ee*_e)-W*(O*De-N*_e)+we*(O*ee-N*Z),w[11]=-(D*(Z*he-ee*ie)-W*(O*he-N*ie)+K*(O*ee-N*Z)),w[12]=-(W*(ie*xe-le*_e)-K*(Z*xe-te*_e)+we*(Z*le-te*ie)),w[13]=D*(ie*xe-le*_e)-K*(O*xe-R*_e)+we*(O*le-R*ie),w[14]=-(D*(Z*xe-te*_e)-W*(O*xe-R*_e)+we*(O*te-R*Z)),w[15]=D*(Z*le-te*ie)-W*(O*le-R*ie)+K*(O*te-R*Z),w},ae.determinant=function(w){var P=w[0],D=w[1],O=w[2],R=w[3],N=w[4],W=w[5],Z=w[6],te=w[7],ee=w[8],K=w[9],ie=w[10],le=w[11],he=w[12],we=w[13],_e=w[14],xe=w[15];return(P*W-D*N)*(ie*xe-le*_e)-(P*Z-O*N)*(K*xe-le*we)+(P*te-R*N)*(K*_e-ie*we)+(D*Z-O*W)*(ee*xe-le*he)-(D*te-R*W)*(ee*_e-ie*he)+(O*te-R*Z)*(ee*we-K*he)},ae.multiply=m,ae.translate=function(w,P,D){var O,R,N,W,Z,te,ee,K,ie,le,he,we,_e=D[0],xe=D[1],De=D[2];return P===w?(w[12]=P[0]*_e+P[4]*xe+P[8]*De+P[12],w[13]=P[1]*_e+P[5]*xe+P[9]*De+P[13],w[14]=P[2]*_e+P[6]*xe+P[10]*De+P[14],w[15]=P[3]*_e+P[7]*xe+P[11]*De+P[15]):(R=P[1],N=P[2],W=P[3],Z=P[4],te=P[5],ee=P[6],K=P[7],ie=P[8],le=P[9],he=P[10],we=P[11],w[0]=O=P[0],w[1]=R,w[2]=N,w[3]=W,w[4]=Z,w[5]=te,w[6]=ee,w[7]=K,w[8]=ie,w[9]=le,w[10]=he,w[11]=we,w[12]=O*_e+Z*xe+ie*De+P[12],w[13]=R*_e+te*xe+le*De+P[13],w[14]=N*_e+ee*xe+he*De+P[14],w[15]=W*_e+K*xe+we*De+P[15]),w},ae.scale=function(w,P,D){var O=D[0],R=D[1],N=D[2];return w[0]=P[0]*O,w[1]=P[1]*O,w[2]=P[2]*O,w[3]=P[3]*O,w[4]=P[4]*R,w[5]=P[5]*R,w[6]=P[6]*R,w[7]=P[7]*R,w[8]=P[8]*N,w[9]=P[9]*N,w[10]=P[10]*N,w[11]=P[11]*N,w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15],w},ae.rotate=function(w,P,D,O){var R,N,W,Z,te,ee,K,ie,le,he,we,_e,xe,De,Se,Le,We,Ue,Xe,He,nt,Je,it,Mt,At=O[0],er=O[1],Rt=O[2],Ft=Math.hypot(At,er,Rt);return Ft<o.EPSILON?null:(At*=Ft=1/Ft,er*=Ft,Rt*=Ft,R=Math.sin(D),N=Math.cos(D),te=P[1],ee=P[2],K=P[3],le=P[5],he=P[6],we=P[7],xe=P[9],De=P[10],Se=P[11],Le=At*At*(W=1-N)+N,Xe=At*er*W-Rt*R,He=er*er*W+N,nt=Rt*er*W+At*R,Je=At*Rt*W+er*R,it=er*Rt*W-At*R,Mt=Rt*Rt*W+N,w[0]=(Z=P[0])*Le+(ie=P[4])*(We=er*At*W+Rt*R)+(_e=P[8])*(Ue=Rt*At*W-er*R),w[1]=te*Le+le*We+xe*Ue,w[2]=ee*Le+he*We+De*Ue,w[3]=K*Le+we*We+Se*Ue,w[4]=Z*Xe+ie*He+_e*nt,w[5]=te*Xe+le*He+xe*nt,w[6]=ee*Xe+he*He+De*nt,w[7]=K*Xe+we*He+Se*nt,w[8]=Z*Je+ie*it+_e*Mt,w[9]=te*Je+le*it+xe*Mt,w[10]=ee*Je+he*it+De*Mt,w[11]=K*Je+we*it+Se*Mt,P!==w&&(w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w)},ae.rotateX=function(w,P,D){var O=Math.sin(D),R=Math.cos(D),N=P[4],W=P[5],Z=P[6],te=P[7],ee=P[8],K=P[9],ie=P[10],le=P[11];return P!==w&&(w[0]=P[0],w[1]=P[1],w[2]=P[2],w[3]=P[3],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w[4]=N*R+ee*O,w[5]=W*R+K*O,w[6]=Z*R+ie*O,w[7]=te*R+le*O,w[8]=ee*R-N*O,w[9]=K*R-W*O,w[10]=ie*R-Z*O,w[11]=le*R-te*O,w},ae.rotateY=function(w,P,D){var O=Math.sin(D),R=Math.cos(D),N=P[0],W=P[1],Z=P[2],te=P[3],ee=P[8],K=P[9],ie=P[10],le=P[11];return P!==w&&(w[4]=P[4],w[5]=P[5],w[6]=P[6],w[7]=P[7],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w[0]=N*R-ee*O,w[1]=W*R-K*O,w[2]=Z*R-ie*O,w[3]=te*R-le*O,w[8]=N*O+ee*R,w[9]=W*O+K*R,w[10]=Z*O+ie*R,w[11]=te*O+le*R,w},ae.rotateZ=function(w,P,D){var O=Math.sin(D),R=Math.cos(D),N=P[0],W=P[1],Z=P[2],te=P[3],ee=P[4],K=P[5],ie=P[6],le=P[7];return P!==w&&(w[8]=P[8],w[9]=P[9],w[10]=P[10],w[11]=P[11],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w[0]=N*R+ee*O,w[1]=W*R+K*O,w[2]=Z*R+ie*O,w[3]=te*R+le*O,w[4]=ee*R-N*O,w[5]=K*R-W*O,w[6]=ie*R-Z*O,w[7]=le*R-te*O,w},ae.fromTranslation=function(w,P){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=P[0],w[13]=P[1],w[14]=P[2],w[15]=1,w},ae.fromScaling=function(w,P){return w[0]=P[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=P[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=P[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},ae.fromRotation=function(w,P,D){var O,R,N,W=D[0],Z=D[1],te=D[2],ee=Math.hypot(W,Z,te);return ee<o.EPSILON?null:(W*=ee=1/ee,Z*=ee,te*=ee,O=Math.sin(P),R=Math.cos(P),w[0]=W*W*(N=1-R)+R,w[1]=Z*W*N+te*O,w[2]=te*W*N-Z*O,w[3]=0,w[4]=W*Z*N-te*O,w[5]=Z*Z*N+R,w[6]=te*Z*N+W*O,w[7]=0,w[8]=W*te*N+Z*O,w[9]=Z*te*N-W*O,w[10]=te*te*N+R,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},ae.fromXRotation=function(w,P){var D=Math.sin(P),O=Math.cos(P);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=O,w[6]=D,w[7]=0,w[8]=0,w[9]=-D,w[10]=O,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},ae.fromYRotation=function(w,P){var D=Math.sin(P),O=Math.cos(P);return w[0]=O,w[1]=0,w[2]=-D,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=D,w[9]=0,w[10]=O,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},ae.fromZRotation=function(w,P){var D=Math.sin(P),O=Math.cos(P);return w[0]=O,w[1]=D,w[2]=0,w[3]=0,w[4]=-D,w[5]=O,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},ae.fromRotationTranslation=p,ae.fromQuat2=function(w,P){var D=new o.ARRAY_TYPE(3),O=-P[0],R=-P[1],N=-P[2],W=P[3],Z=P[4],te=P[5],ee=P[6],K=P[7],ie=O*O+R*R+N*N+W*W;return ie>0?(D[0]=2*(Z*W+K*O+te*N-ee*R)/ie,D[1]=2*(te*W+K*R+ee*O-Z*N)/ie,D[2]=2*(ee*W+K*N+Z*R-te*O)/ie):(D[0]=2*(Z*W+K*O+te*N-ee*R),D[1]=2*(te*W+K*R+ee*O-Z*N),D[2]=2*(ee*W+K*N+Z*R-te*O)),p(w,P,D),w},ae.getTranslation=function(w,P){return w[0]=P[12],w[1]=P[13],w[2]=P[14],w},ae.getScaling=v,ae.getRotation=function(w,P){var D=new o.ARRAY_TYPE(3);v(D,P);var O=1/D[0],R=1/D[1],N=1/D[2],W=P[0]*O,Z=P[1]*R,te=P[2]*N,ee=P[4]*O,K=P[5]*R,ie=P[6]*N,le=P[8]*O,he=P[9]*R,we=P[10]*N,_e=W+K+we,xe=0;return _e>0?(xe=2*Math.sqrt(_e+1),w[3]=.25*xe,w[0]=(ie-he)/xe,w[1]=(le-te)/xe,w[2]=(Z-ee)/xe):W>K&&W>we?(xe=2*Math.sqrt(1+W-K-we),w[3]=(ie-he)/xe,w[0]=.25*xe,w[1]=(Z+ee)/xe,w[2]=(le+te)/xe):K>we?(xe=2*Math.sqrt(1+K-W-we),w[3]=(le-te)/xe,w[0]=(Z+ee)/xe,w[1]=.25*xe,w[2]=(ie+he)/xe):(xe=2*Math.sqrt(1+we-W-K),w[3]=(Z-ee)/xe,w[0]=(le+te)/xe,w[1]=(ie+he)/xe,w[2]=.25*xe),w},ae.fromRotationTranslationScale=function(w,P,D,O){var R=P[0],N=P[1],W=P[2],Z=P[3],te=R+R,ee=N+N,K=W+W,ie=R*te,le=R*ee,he=R*K,we=N*ee,_e=N*K,xe=W*K,De=Z*te,Se=Z*ee,Le=Z*K,We=O[0],Ue=O[1],Xe=O[2];return w[0]=(1-(we+xe))*We,w[1]=(le+Le)*We,w[2]=(he-Se)*We,w[3]=0,w[4]=(le-Le)*Ue,w[5]=(1-(ie+xe))*Ue,w[6]=(_e+De)*Ue,w[7]=0,w[8]=(he+Se)*Xe,w[9]=(_e-De)*Xe,w[10]=(1-(ie+we))*Xe,w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w},ae.fromRotationTranslationScaleOrigin=function(w,P,D,O,R){var N=P[0],W=P[1],Z=P[2],te=P[3],ee=N+N,K=W+W,ie=Z+Z,le=N*ee,he=N*K,we=N*ie,_e=W*K,xe=W*ie,De=Z*ie,Se=te*ee,Le=te*K,We=te*ie,Ue=O[0],Xe=O[1],He=O[2],nt=R[0],Je=R[1],it=R[2],Mt=(1-(_e+De))*Ue,At=(he+We)*Ue,er=(we-Le)*Ue,Rt=(he-We)*Xe,Ft=(1-(le+De))*Xe,It=(xe+Se)*Xe,_r=(we+Le)*He,Xt=(xe-Se)*He,or=(1-(le+_e))*He;return w[0]=Mt,w[1]=At,w[2]=er,w[3]=0,w[4]=Rt,w[5]=Ft,w[6]=It,w[7]=0,w[8]=_r,w[9]=Xt,w[10]=or,w[11]=0,w[12]=D[0]+nt-(Mt*nt+Rt*Je+_r*it),w[13]=D[1]+Je-(At*nt+Ft*Je+Xt*it),w[14]=D[2]+it-(er*nt+It*Je+or*it),w[15]=1,w},ae.fromQuat=function(w,P){var D=P[0],O=P[1],R=P[2],N=P[3],W=D+D,Z=O+O,te=R+R,ee=D*W,K=O*W,ie=O*Z,le=R*W,he=R*Z,we=R*te,_e=N*W,xe=N*Z,De=N*te;return w[0]=1-ie-we,w[1]=K+De,w[2]=le-xe,w[3]=0,w[4]=K-De,w[5]=1-ee-we,w[6]=he+_e,w[7]=0,w[8]=le+xe,w[9]=he-_e,w[10]=1-ee-ie,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},ae.frustum=function(w,P,D,O,R,N,W){var Z=1/(D-P),te=1/(R-O),ee=1/(N-W);return w[0]=2*N*Z,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*N*te,w[6]=0,w[7]=0,w[8]=(D+P)*Z,w[9]=(R+O)*te,w[10]=(W+N)*ee,w[11]=-1,w[12]=0,w[13]=0,w[14]=W*N*2*ee,w[15]=0,w},ae.perspectiveNO=T,ae.perspectiveZO=function(w,P,D,O,R){var N,W=1/Math.tan(P/2);return w[0]=W/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,R!=null&&R!==1/0?(w[10]=R*(N=1/(O-R)),w[14]=R*O*N):(w[10]=-1,w[14]=-O),w},ae.perspectiveFromFieldOfView=function(w,P,D,O){var R=Math.tan(P.upDegrees*Math.PI/180),N=Math.tan(P.downDegrees*Math.PI/180),W=Math.tan(P.leftDegrees*Math.PI/180),Z=Math.tan(P.rightDegrees*Math.PI/180),te=2/(W+Z),ee=2/(R+N);return w[0]=te,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=ee,w[6]=0,w[7]=0,w[8]=-(W-Z)*te*.5,w[9]=(R-N)*ee*.5,w[10]=O/(D-O),w[11]=-1,w[12]=0,w[13]=0,w[14]=O*D/(D-O),w[15]=0,w},ae.orthoNO=M,ae.orthoZO=function(w,P,D,O,R,N,W){var Z=1/(P-D),te=1/(O-R),ee=1/(N-W);return w[0]=-2*Z,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*te,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=ee,w[11]=0,w[12]=(P+D)*Z,w[13]=(R+O)*te,w[14]=N*ee,w[15]=1,w},ae.lookAt=function(w,P,D,O){var R,N,W,Z,te,ee,K,ie,le,he,we=P[0],_e=P[1],xe=P[2],De=O[0],Se=O[1],Le=O[2],We=D[0],Ue=D[1],Xe=D[2];return Math.abs(we-We)<o.EPSILON&&Math.abs(_e-Ue)<o.EPSILON&&Math.abs(xe-Xe)<o.EPSILON?f(w):(K=we-We,ie=_e-Ue,le=xe-Xe,R=Se*(le*=he=1/Math.hypot(K,ie,le))-Le*(ie*=he),N=Le*(K*=he)-De*le,W=De*ie-Se*K,(he=Math.hypot(R,N,W))?(R*=he=1/he,N*=he,W*=he):(R=0,N=0,W=0),Z=ie*W-le*N,te=le*R-K*W,ee=K*N-ie*R,(he=Math.hypot(Z,te,ee))?(Z*=he=1/he,te*=he,ee*=he):(Z=0,te=0,ee=0),w[0]=R,w[1]=Z,w[2]=K,w[3]=0,w[4]=N,w[5]=te,w[6]=ie,w[7]=0,w[8]=W,w[9]=ee,w[10]=le,w[11]=0,w[12]=-(R*we+N*_e+W*xe),w[13]=-(Z*we+te*_e+ee*xe),w[14]=-(K*we+ie*_e+le*xe),w[15]=1,w)},ae.targetTo=function(w,P,D,O){var R=P[0],N=P[1],W=P[2],Z=O[0],te=O[1],ee=O[2],K=R-D[0],ie=N-D[1],le=W-D[2],he=K*K+ie*ie+le*le;he>0&&(K*=he=1/Math.sqrt(he),ie*=he,le*=he);var we=te*le-ee*ie,_e=ee*K-Z*le,xe=Z*ie-te*K;return(he=we*we+_e*_e+xe*xe)>0&&(we*=he=1/Math.sqrt(he),_e*=he,xe*=he),w[0]=we,w[1]=_e,w[2]=xe,w[3]=0,w[4]=ie*xe-le*_e,w[5]=le*we-K*xe,w[6]=K*_e-ie*we,w[7]=0,w[8]=K,w[9]=ie,w[10]=le,w[11]=0,w[12]=R,w[13]=N,w[14]=W,w[15]=1,w},ae.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},ae.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},ae.add=function(w,P,D){return w[0]=P[0]+D[0],w[1]=P[1]+D[1],w[2]=P[2]+D[2],w[3]=P[3]+D[3],w[4]=P[4]+D[4],w[5]=P[5]+D[5],w[6]=P[6]+D[6],w[7]=P[7]+D[7],w[8]=P[8]+D[8],w[9]=P[9]+D[9],w[10]=P[10]+D[10],w[11]=P[11]+D[11],w[12]=P[12]+D[12],w[13]=P[13]+D[13],w[14]=P[14]+D[14],w[15]=P[15]+D[15],w},ae.subtract=k,ae.multiplyScalar=function(w,P,D){return w[0]=P[0]*D,w[1]=P[1]*D,w[2]=P[2]*D,w[3]=P[3]*D,w[4]=P[4]*D,w[5]=P[5]*D,w[6]=P[6]*D,w[7]=P[7]*D,w[8]=P[8]*D,w[9]=P[9]*D,w[10]=P[10]*D,w[11]=P[11]*D,w[12]=P[12]*D,w[13]=P[13]*D,w[14]=P[14]*D,w[15]=P[15]*D,w},ae.multiplyScalarAndAdd=function(w,P,D,O){return w[0]=P[0]+D[0]*O,w[1]=P[1]+D[1]*O,w[2]=P[2]+D[2]*O,w[3]=P[3]+D[3]*O,w[4]=P[4]+D[4]*O,w[5]=P[5]+D[5]*O,w[6]=P[6]+D[6]*O,w[7]=P[7]+D[7]*O,w[8]=P[8]+D[8]*O,w[9]=P[9]+D[9]*O,w[10]=P[10]+D[10]*O,w[11]=P[11]+D[11]*O,w[12]=P[12]+D[12]*O,w[13]=P[13]+D[13]*O,w[14]=P[14]+D[14]*O,w[15]=P[15]+D[15]*O,w},ae.exactEquals=function(w,P){return w[0]===P[0]&&w[1]===P[1]&&w[2]===P[2]&&w[3]===P[3]&&w[4]===P[4]&&w[5]===P[5]&&w[6]===P[6]&&w[7]===P[7]&&w[8]===P[8]&&w[9]===P[9]&&w[10]===P[10]&&w[11]===P[11]&&w[12]===P[12]&&w[13]===P[13]&&w[14]===P[14]&&w[15]===P[15]},ae.equals=function(w,P){var D=w[0],O=w[1],R=w[2],N=w[3],W=w[4],Z=w[5],te=w[6],ee=w[7],K=w[8],ie=w[9],le=w[10],he=w[11],we=w[12],_e=w[13],xe=w[14],De=w[15],Se=P[0],Le=P[1],We=P[2],Ue=P[3],Xe=P[4],He=P[5],nt=P[6],Je=P[7],it=P[8],Mt=P[9],At=P[10],er=P[11],Rt=P[12],Ft=P[13],It=P[14],_r=P[15];return Math.abs(D-Se)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(Se))&&Math.abs(O-Le)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(Le))&&Math.abs(R-We)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(We))&&Math.abs(N-Ue)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(Ue))&&Math.abs(W-Xe)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(Xe))&&Math.abs(Z-He)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(He))&&Math.abs(te-nt)<=o.EPSILON*Math.max(1,Math.abs(te),Math.abs(nt))&&Math.abs(ee-Je)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(Je))&&Math.abs(K-it)<=o.EPSILON*Math.max(1,Math.abs(K),Math.abs(it))&&Math.abs(ie-Mt)<=o.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Mt))&&Math.abs(le-At)<=o.EPSILON*Math.max(1,Math.abs(le),Math.abs(At))&&Math.abs(he-er)<=o.EPSILON*Math.max(1,Math.abs(he),Math.abs(er))&&Math.abs(we-Rt)<=o.EPSILON*Math.max(1,Math.abs(we),Math.abs(Rt))&&Math.abs(_e-Ft)<=o.EPSILON*Math.max(1,Math.abs(_e),Math.abs(Ft))&&Math.abs(xe-It)<=o.EPSILON*Math.max(1,Math.abs(xe),Math.abs(It))&&Math.abs(De-_r)<=o.EPSILON*Math.max(1,Math.abs(De),Math.abs(_r))},ae.sub=ae.mul=ae.ortho=ae.perspective=void 0;var o=function(w,P){if(w&&w.__esModule)return w;if(w===null||d(w)!=="object"&&typeof w!="function")return{default:w};var D=c(void 0);if(D&&D.has(w))return D.get(w);var O={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in w)if(N!=="default"&&Object.prototype.hasOwnProperty.call(w,N)){var W=R?Object.getOwnPropertyDescriptor(w,N):null;W&&(W.get||W.set)?Object.defineProperty(O,N,W):O[N]=w[N]}return O.default=w,D&&D.set(w,O),O}(I());function c(w){if(typeof WeakMap!="function")return null;var P=new WeakMap,D=new WeakMap;return(c=function(O){return O?D:P})(w)}function f(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function m(w,P,D){var O=P[0],R=P[1],N=P[2],W=P[3],Z=P[4],te=P[5],ee=P[6],K=P[7],ie=P[8],le=P[9],he=P[10],we=P[11],_e=P[12],xe=P[13],De=P[14],Se=P[15],Le=D[0],We=D[1],Ue=D[2],Xe=D[3];return w[0]=Le*O+We*Z+Ue*ie+Xe*_e,w[1]=Le*R+We*te+Ue*le+Xe*xe,w[2]=Le*N+We*ee+Ue*he+Xe*De,w[3]=Le*W+We*K+Ue*we+Xe*Se,w[4]=(Le=D[4])*O+(We=D[5])*Z+(Ue=D[6])*ie+(Xe=D[7])*_e,w[5]=Le*R+We*te+Ue*le+Xe*xe,w[6]=Le*N+We*ee+Ue*he+Xe*De,w[7]=Le*W+We*K+Ue*we+Xe*Se,w[8]=(Le=D[8])*O+(We=D[9])*Z+(Ue=D[10])*ie+(Xe=D[11])*_e,w[9]=Le*R+We*te+Ue*le+Xe*xe,w[10]=Le*N+We*ee+Ue*he+Xe*De,w[11]=Le*W+We*K+Ue*we+Xe*Se,w[12]=(Le=D[12])*O+(We=D[13])*Z+(Ue=D[14])*ie+(Xe=D[15])*_e,w[13]=Le*R+We*te+Ue*le+Xe*xe,w[14]=Le*N+We*ee+Ue*he+Xe*De,w[15]=Le*W+We*K+Ue*we+Xe*Se,w}function p(w,P,D){var O=P[0],R=P[1],N=P[2],W=P[3],Z=O+O,te=R+R,ee=N+N,K=O*Z,ie=O*te,le=O*ee,he=R*te,we=R*ee,_e=N*ee,xe=W*Z,De=W*te,Se=W*ee;return w[0]=1-(he+_e),w[1]=ie+Se,w[2]=le-De,w[3]=0,w[4]=ie-Se,w[5]=1-(K+_e),w[6]=we+xe,w[7]=0,w[8]=le+De,w[9]=we-xe,w[10]=1-(K+he),w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w}function v(w,P){var D=P[4],O=P[5],R=P[6],N=P[8],W=P[9],Z=P[10];return w[0]=Math.hypot(P[0],P[1],P[2]),w[1]=Math.hypot(D,O,R),w[2]=Math.hypot(N,W,Z),w}function T(w,P,D,O,R){var N,W=1/Math.tan(P/2);return w[0]=W/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,R!=null&&R!==1/0?(w[10]=(R+O)*(N=1/(O-R)),w[14]=2*R*O*N):(w[10]=-1,w[14]=-2*O),w}function M(w,P,D,O,R,N,W){var Z=1/(P-D),te=1/(O-R),ee=1/(N-W);return w[0]=-2*Z,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*te,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*ee,w[11]=0,w[12]=(P+D)*Z,w[13]=(R+O)*te,w[14]=(W+N)*ee,w[15]=1,w}function k(w,P,D){return w[0]=P[0]-D[0],w[1]=P[1]-D[1],w[2]=P[2]-D[2],w[3]=P[3]-D[3],w[4]=P[4]-D[4],w[5]=P[5]-D[5],w[6]=P[6]-D[6],w[7]=P[7]-D[7],w[8]=P[8]-D[8],w[9]=P[9]-D[9],w[10]=P[10]-D[10],w[11]=P[11]-D[11],w[12]=P[12]-D[12],w[13]=P[13]-D[13],w[14]=P[14]-D[14],w[15]=P[15]-D[15],w}return ae.perspective=T,ae.ortho=M,ae.mul=m,ae.sub=k,ae}var Fe,ke={},Ce={};function je(){if(Fe)return Ce;function d(R){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},d(R)}Fe=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.create=f,Ce.clone=function(R){var N=new o.ARRAY_TYPE(3);return N[0]=R[0],N[1]=R[1],N[2]=R[2],N},Ce.length=m,Ce.fromValues=function(R,N,W){var Z=new o.ARRAY_TYPE(3);return Z[0]=R,Z[1]=N,Z[2]=W,Z},Ce.copy=function(R,N){return R[0]=N[0],R[1]=N[1],R[2]=N[2],R},Ce.set=function(R,N,W,Z){return R[0]=N,R[1]=W,R[2]=Z,R},Ce.add=function(R,N,W){return R[0]=N[0]+W[0],R[1]=N[1]+W[1],R[2]=N[2]+W[2],R},Ce.subtract=p,Ce.multiply=v,Ce.divide=T,Ce.ceil=function(R,N){return R[0]=Math.ceil(N[0]),R[1]=Math.ceil(N[1]),R[2]=Math.ceil(N[2]),R},Ce.floor=function(R,N){return R[0]=Math.floor(N[0]),R[1]=Math.floor(N[1]),R[2]=Math.floor(N[2]),R},Ce.min=function(R,N,W){return R[0]=Math.min(N[0],W[0]),R[1]=Math.min(N[1],W[1]),R[2]=Math.min(N[2],W[2]),R},Ce.max=function(R,N,W){return R[0]=Math.max(N[0],W[0]),R[1]=Math.max(N[1],W[1]),R[2]=Math.max(N[2],W[2]),R},Ce.round=function(R,N){return R[0]=Math.round(N[0]),R[1]=Math.round(N[1]),R[2]=Math.round(N[2]),R},Ce.scale=function(R,N,W){return R[0]=N[0]*W,R[1]=N[1]*W,R[2]=N[2]*W,R},Ce.scaleAndAdd=function(R,N,W,Z){return R[0]=N[0]+W[0]*Z,R[1]=N[1]+W[1]*Z,R[2]=N[2]+W[2]*Z,R},Ce.distance=M,Ce.squaredDistance=k,Ce.squaredLength=w,Ce.negate=function(R,N){return R[0]=-N[0],R[1]=-N[1],R[2]=-N[2],R},Ce.inverse=function(R,N){return R[0]=1/N[0],R[1]=1/N[1],R[2]=1/N[2],R},Ce.normalize=function(R,N){var W=N[0],Z=N[1],te=N[2],ee=W*W+Z*Z+te*te;return ee>0&&(ee=1/Math.sqrt(ee)),R[0]=N[0]*ee,R[1]=N[1]*ee,R[2]=N[2]*ee,R},Ce.dot=P,Ce.cross=function(R,N,W){var Z=N[0],te=N[1],ee=N[2],K=W[0],ie=W[1],le=W[2];return R[0]=te*le-ee*ie,R[1]=ee*K-Z*le,R[2]=Z*ie-te*K,R},Ce.lerp=function(R,N,W,Z){var te=N[0],ee=N[1],K=N[2];return R[0]=te+Z*(W[0]-te),R[1]=ee+Z*(W[1]-ee),R[2]=K+Z*(W[2]-K),R},Ce.hermite=function(R,N,W,Z,te,ee){var K=ee*ee,ie=K*(2*ee-3)+1,le=K*(ee-2)+ee,he=K*(ee-1),we=K*(3-2*ee);return R[0]=N[0]*ie+W[0]*le+Z[0]*he+te[0]*we,R[1]=N[1]*ie+W[1]*le+Z[1]*he+te[1]*we,R[2]=N[2]*ie+W[2]*le+Z[2]*he+te[2]*we,R},Ce.bezier=function(R,N,W,Z,te,ee){var K=1-ee,ie=K*K,le=ee*ee,he=ie*K,we=3*ee*ie,_e=3*le*K,xe=le*ee;return R[0]=N[0]*he+W[0]*we+Z[0]*_e+te[0]*xe,R[1]=N[1]*he+W[1]*we+Z[1]*_e+te[1]*xe,R[2]=N[2]*he+W[2]*we+Z[2]*_e+te[2]*xe,R},Ce.random=function(R,N){N=N||1;var W=2*o.RANDOM()*Math.PI,Z=2*o.RANDOM()-1,te=Math.sqrt(1-Z*Z)*N;return R[0]=Math.cos(W)*te,R[1]=Math.sin(W)*te,R[2]=Z*N,R},Ce.transformMat4=function(R,N,W){var Z=N[0],te=N[1],ee=N[2],K=W[3]*Z+W[7]*te+W[11]*ee+W[15];return R[0]=(W[0]*Z+W[4]*te+W[8]*ee+W[12])/(K=K||1),R[1]=(W[1]*Z+W[5]*te+W[9]*ee+W[13])/K,R[2]=(W[2]*Z+W[6]*te+W[10]*ee+W[14])/K,R},Ce.transformMat3=function(R,N,W){var Z=N[0],te=N[1],ee=N[2];return R[0]=Z*W[0]+te*W[3]+ee*W[6],R[1]=Z*W[1]+te*W[4]+ee*W[7],R[2]=Z*W[2]+te*W[5]+ee*W[8],R},Ce.transformQuat=function(R,N,W){var Z=W[0],te=W[1],ee=W[2],K=N[0],ie=N[1],le=N[2],he=te*le-ee*ie,we=ee*K-Z*le,_e=Z*ie-te*K,xe=te*_e-ee*we,De=ee*he-Z*_e,Se=Z*we-te*he,Le=2*W[3];return we*=Le,_e*=Le,De*=2,Se*=2,R[0]=K+(he*=Le)+(xe*=2),R[1]=ie+we+De,R[2]=le+_e+Se,R},Ce.rotateX=function(R,N,W,Z){var te=[],ee=[];return te[0]=N[0]-W[0],te[1]=N[1]-W[1],te[2]=N[2]-W[2],ee[0]=te[0],ee[1]=te[1]*Math.cos(Z)-te[2]*Math.sin(Z),ee[2]=te[1]*Math.sin(Z)+te[2]*Math.cos(Z),R[0]=ee[0]+W[0],R[1]=ee[1]+W[1],R[2]=ee[2]+W[2],R},Ce.rotateY=function(R,N,W,Z){var te=[],ee=[];return te[0]=N[0]-W[0],te[1]=N[1]-W[1],te[2]=N[2]-W[2],ee[0]=te[2]*Math.sin(Z)+te[0]*Math.cos(Z),ee[1]=te[1],ee[2]=te[2]*Math.cos(Z)-te[0]*Math.sin(Z),R[0]=ee[0]+W[0],R[1]=ee[1]+W[1],R[2]=ee[2]+W[2],R},Ce.rotateZ=function(R,N,W,Z){var te=[],ee=[];return te[0]=N[0]-W[0],te[1]=N[1]-W[1],te[2]=N[2]-W[2],ee[0]=te[0]*Math.cos(Z)-te[1]*Math.sin(Z),ee[1]=te[0]*Math.sin(Z)+te[1]*Math.cos(Z),ee[2]=te[2],R[0]=ee[0]+W[0],R[1]=ee[1]+W[1],R[2]=ee[2]+W[2],R},Ce.angle=function(R,N){var W=R[0],Z=R[1],te=R[2],ee=N[0],K=N[1],ie=N[2],le=Math.sqrt(W*W+Z*Z+te*te)*Math.sqrt(ee*ee+K*K+ie*ie),he=le&&P(R,N)/le;return Math.acos(Math.min(Math.max(he,-1),1))},Ce.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},Ce.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},Ce.exactEquals=function(R,N){return R[0]===N[0]&&R[1]===N[1]&&R[2]===N[2]},Ce.equals=function(R,N){var W=R[0],Z=R[1],te=R[2],ee=N[0],K=N[1],ie=N[2];return Math.abs(W-ee)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(ee))&&Math.abs(Z-K)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(K))&&Math.abs(te-ie)<=o.EPSILON*Math.max(1,Math.abs(te),Math.abs(ie))},Ce.forEach=Ce.sqrLen=Ce.len=Ce.sqrDist=Ce.dist=Ce.div=Ce.mul=Ce.sub=void 0;var o=function(R,N){if(R&&R.__esModule)return R;if(R===null||d(R)!=="object"&&typeof R!="function")return{default:R};var W=c(void 0);if(W&&W.has(R))return W.get(R);var Z={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in R)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(R,ee)){var K=te?Object.getOwnPropertyDescriptor(R,ee):null;K&&(K.get||K.set)?Object.defineProperty(Z,ee,K):Z[ee]=R[ee]}return Z.default=R,W&&W.set(R,Z),Z}(I());function c(R){if(typeof WeakMap!="function")return null;var N=new WeakMap,W=new WeakMap;return(c=function(Z){return Z?W:N})(R)}function f(){var R=new o.ARRAY_TYPE(3);return o.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function m(R){return Math.hypot(R[0],R[1],R[2])}function p(R,N,W){return R[0]=N[0]-W[0],R[1]=N[1]-W[1],R[2]=N[2]-W[2],R}function v(R,N,W){return R[0]=N[0]*W[0],R[1]=N[1]*W[1],R[2]=N[2]*W[2],R}function T(R,N,W){return R[0]=N[0]/W[0],R[1]=N[1]/W[1],R[2]=N[2]/W[2],R}function M(R,N){return Math.hypot(N[0]-R[0],N[1]-R[1],N[2]-R[2])}function k(R,N){var W=N[0]-R[0],Z=N[1]-R[1],te=N[2]-R[2];return W*W+Z*Z+te*te}function w(R){var N=R[0],W=R[1],Z=R[2];return N*N+W*W+Z*Z}function P(R,N){return R[0]*N[0]+R[1]*N[1]+R[2]*N[2]}Ce.sub=p,Ce.mul=v,Ce.div=T,Ce.dist=M,Ce.sqrDist=k,Ce.len=m,Ce.sqrLen=w;var D,O=(D=f(),function(R,N,W,Z,te,ee){var K,ie;for(N||(N=3),W||(W=0),ie=Z?Math.min(Z*N+W,R.length):R.length,K=W;K<ie;K+=N)D[0]=R[K],D[1]=R[K+1],D[2]=R[K+2],te(D,D,ee),R[K]=D[0],R[K+1]=D[1],R[K+2]=D[2];return R});return Ce.forEach=O,Ce}var tt,Ze,Qe={};function st(){if(tt)return Qe;function d(O){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},d(O)}tt=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.create=f,Qe.clone=function(O){var R=new o.ARRAY_TYPE(4);return R[0]=O[0],R[1]=O[1],R[2]=O[2],R[3]=O[3],R},Qe.fromValues=function(O,R,N,W){var Z=new o.ARRAY_TYPE(4);return Z[0]=O,Z[1]=R,Z[2]=N,Z[3]=W,Z},Qe.copy=function(O,R){return O[0]=R[0],O[1]=R[1],O[2]=R[2],O[3]=R[3],O},Qe.set=function(O,R,N,W,Z){return O[0]=R,O[1]=N,O[2]=W,O[3]=Z,O},Qe.add=function(O,R,N){return O[0]=R[0]+N[0],O[1]=R[1]+N[1],O[2]=R[2]+N[2],O[3]=R[3]+N[3],O},Qe.subtract=m,Qe.multiply=p,Qe.divide=v,Qe.ceil=function(O,R){return O[0]=Math.ceil(R[0]),O[1]=Math.ceil(R[1]),O[2]=Math.ceil(R[2]),O[3]=Math.ceil(R[3]),O},Qe.floor=function(O,R){return O[0]=Math.floor(R[0]),O[1]=Math.floor(R[1]),O[2]=Math.floor(R[2]),O[3]=Math.floor(R[3]),O},Qe.min=function(O,R,N){return O[0]=Math.min(R[0],N[0]),O[1]=Math.min(R[1],N[1]),O[2]=Math.min(R[2],N[2]),O[3]=Math.min(R[3],N[3]),O},Qe.max=function(O,R,N){return O[0]=Math.max(R[0],N[0]),O[1]=Math.max(R[1],N[1]),O[2]=Math.max(R[2],N[2]),O[3]=Math.max(R[3],N[3]),O},Qe.round=function(O,R){return O[0]=Math.round(R[0]),O[1]=Math.round(R[1]),O[2]=Math.round(R[2]),O[3]=Math.round(R[3]),O},Qe.scale=function(O,R,N){return O[0]=R[0]*N,O[1]=R[1]*N,O[2]=R[2]*N,O[3]=R[3]*N,O},Qe.scaleAndAdd=function(O,R,N,W){return O[0]=R[0]+N[0]*W,O[1]=R[1]+N[1]*W,O[2]=R[2]+N[2]*W,O[3]=R[3]+N[3]*W,O},Qe.distance=T,Qe.squaredDistance=M,Qe.length=k,Qe.squaredLength=w,Qe.negate=function(O,R){return O[0]=-R[0],O[1]=-R[1],O[2]=-R[2],O[3]=-R[3],O},Qe.inverse=function(O,R){return O[0]=1/R[0],O[1]=1/R[1],O[2]=1/R[2],O[3]=1/R[3],O},Qe.normalize=function(O,R){var N=R[0],W=R[1],Z=R[2],te=R[3],ee=N*N+W*W+Z*Z+te*te;return ee>0&&(ee=1/Math.sqrt(ee)),O[0]=N*ee,O[1]=W*ee,O[2]=Z*ee,O[3]=te*ee,O},Qe.dot=function(O,R){return O[0]*R[0]+O[1]*R[1]+O[2]*R[2]+O[3]*R[3]},Qe.cross=function(O,R,N,W){var Z=N[0]*W[1]-N[1]*W[0],te=N[0]*W[2]-N[2]*W[0],ee=N[0]*W[3]-N[3]*W[0],K=N[1]*W[2]-N[2]*W[1],ie=N[1]*W[3]-N[3]*W[1],le=N[2]*W[3]-N[3]*W[2],he=R[0],we=R[1],_e=R[2],xe=R[3];return O[0]=we*le-_e*ie+xe*K,O[1]=-he*le+_e*ee-xe*te,O[2]=he*ie-we*ee+xe*Z,O[3]=-he*K+we*te-_e*Z,O},Qe.lerp=function(O,R,N,W){var Z=R[0],te=R[1],ee=R[2],K=R[3];return O[0]=Z+W*(N[0]-Z),O[1]=te+W*(N[1]-te),O[2]=ee+W*(N[2]-ee),O[3]=K+W*(N[3]-K),O},Qe.random=function(O,R){var N,W,Z,te,ee,K;R=R||1;do ee=(N=2*o.RANDOM()-1)*N+(W=2*o.RANDOM()-1)*W;while(ee>=1);do K=(Z=2*o.RANDOM()-1)*Z+(te=2*o.RANDOM()-1)*te;while(K>=1);var ie=Math.sqrt((1-ee)/K);return O[0]=R*N,O[1]=R*W,O[2]=R*Z*ie,O[3]=R*te*ie,O},Qe.transformMat4=function(O,R,N){var W=R[0],Z=R[1],te=R[2],ee=R[3];return O[0]=N[0]*W+N[4]*Z+N[8]*te+N[12]*ee,O[1]=N[1]*W+N[5]*Z+N[9]*te+N[13]*ee,O[2]=N[2]*W+N[6]*Z+N[10]*te+N[14]*ee,O[3]=N[3]*W+N[7]*Z+N[11]*te+N[15]*ee,O},Qe.transformQuat=function(O,R,N){var W=R[0],Z=R[1],te=R[2],ee=N[0],K=N[1],ie=N[2],le=N[3],he=le*W+K*te-ie*Z,we=le*Z+ie*W-ee*te,_e=le*te+ee*Z-K*W,xe=-ee*W-K*Z-ie*te;return O[0]=he*le+xe*-ee+we*-ie-_e*-K,O[1]=we*le+xe*-K+_e*-ee-he*-ie,O[2]=_e*le+xe*-ie+he*-K-we*-ee,O[3]=R[3],O},Qe.zero=function(O){return O[0]=0,O[1]=0,O[2]=0,O[3]=0,O},Qe.str=function(O){return"vec4("+O[0]+", "+O[1]+", "+O[2]+", "+O[3]+")"},Qe.exactEquals=function(O,R){return O[0]===R[0]&&O[1]===R[1]&&O[2]===R[2]&&O[3]===R[3]},Qe.equals=function(O,R){var N=O[0],W=O[1],Z=O[2],te=O[3],ee=R[0],K=R[1],ie=R[2],le=R[3];return Math.abs(N-ee)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(ee))&&Math.abs(W-K)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(K))&&Math.abs(Z-ie)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(ie))&&Math.abs(te-le)<=o.EPSILON*Math.max(1,Math.abs(te),Math.abs(le))},Qe.forEach=Qe.sqrLen=Qe.len=Qe.sqrDist=Qe.dist=Qe.div=Qe.mul=Qe.sub=void 0;var o=function(O,R){if(O&&O.__esModule)return O;if(O===null||d(O)!=="object"&&typeof O!="function")return{default:O};var N=c(void 0);if(N&&N.has(O))return N.get(O);var W={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in O)if(te!=="default"&&Object.prototype.hasOwnProperty.call(O,te)){var ee=Z?Object.getOwnPropertyDescriptor(O,te):null;ee&&(ee.get||ee.set)?Object.defineProperty(W,te,ee):W[te]=O[te]}return W.default=O,N&&N.set(O,W),W}(I());function c(O){if(typeof WeakMap!="function")return null;var R=new WeakMap,N=new WeakMap;return(c=function(W){return W?N:R})(O)}function f(){var O=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[3]=0),O}function m(O,R,N){return O[0]=R[0]-N[0],O[1]=R[1]-N[1],O[2]=R[2]-N[2],O[3]=R[3]-N[3],O}function p(O,R,N){return O[0]=R[0]*N[0],O[1]=R[1]*N[1],O[2]=R[2]*N[2],O[3]=R[3]*N[3],O}function v(O,R,N){return O[0]=R[0]/N[0],O[1]=R[1]/N[1],O[2]=R[2]/N[2],O[3]=R[3]/N[3],O}function T(O,R){return Math.hypot(R[0]-O[0],R[1]-O[1],R[2]-O[2],R[3]-O[3])}function M(O,R){var N=R[0]-O[0],W=R[1]-O[1],Z=R[2]-O[2],te=R[3]-O[3];return N*N+W*W+Z*Z+te*te}function k(O){return Math.hypot(O[0],O[1],O[2],O[3])}function w(O){var R=O[0],N=O[1],W=O[2],Z=O[3];return R*R+N*N+W*W+Z*Z}Qe.sub=m,Qe.mul=p,Qe.div=v,Qe.dist=T,Qe.sqrDist=M,Qe.len=k,Qe.sqrLen=w;var P,D=(P=f(),function(O,R,N,W,Z,te){var ee,K;for(R||(R=4),N||(N=0),K=W?Math.min(W*R+N,O.length):O.length,ee=N;ee<K;ee+=R)P[0]=O[ee],P[1]=O[ee+1],P[2]=O[ee+2],P[3]=O[ee+3],Z(P,P,te),O[ee]=P[0],O[ee+1]=P[1],O[ee+2]=P[2],O[ee+3]=P[3];return O});return Qe.forEach=D,Qe}function ot(){if(Ze)return ke;function d(Se){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Le){return typeof Le}:function(Le){return Le&&typeof Symbol=="function"&&Le.constructor===Symbol&&Le!==Symbol.prototype?"symbol":typeof Le},d(Se)}Ze=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.create=T,ke.identity=function(Se){return Se[0]=0,Se[1]=0,Se[2]=0,Se[3]=1,Se},ke.setAxisAngle=M,ke.getAxisAngle=function(Se,Le){var We=2*Math.acos(Le[3]),Ue=Math.sin(We/2);return Ue>o.EPSILON?(Se[0]=Le[0]/Ue,Se[1]=Le[1]/Ue,Se[2]=Le[2]/Ue):(Se[0]=1,Se[1]=0,Se[2]=0),We},ke.getAngle=function(Se,Le){var We=N(Se,Le);return Math.acos(2*We*We-1)},ke.multiply=k,ke.rotateX=function(Se,Le,We){We*=.5;var Ue=Le[0],Xe=Le[1],He=Le[2],nt=Le[3],Je=Math.sin(We),it=Math.cos(We);return Se[0]=Ue*it+nt*Je,Se[1]=Xe*it+He*Je,Se[2]=He*it-Xe*Je,Se[3]=nt*it-Ue*Je,Se},ke.rotateY=function(Se,Le,We){We*=.5;var Ue=Le[0],Xe=Le[1],He=Le[2],nt=Le[3],Je=Math.sin(We),it=Math.cos(We);return Se[0]=Ue*it-He*Je,Se[1]=Xe*it+nt*Je,Se[2]=He*it+Ue*Je,Se[3]=nt*it-Xe*Je,Se},ke.rotateZ=function(Se,Le,We){We*=.5;var Ue=Le[0],Xe=Le[1],He=Le[2],nt=Le[3],Je=Math.sin(We),it=Math.cos(We);return Se[0]=Ue*it+Xe*Je,Se[1]=Xe*it-Ue*Je,Se[2]=He*it+nt*Je,Se[3]=nt*it-He*Je,Se},ke.calculateW=function(Se,Le){var We=Le[0],Ue=Le[1],Xe=Le[2];return Se[0]=We,Se[1]=Ue,Se[2]=Xe,Se[3]=Math.sqrt(Math.abs(1-We*We-Ue*Ue-Xe*Xe)),Se},ke.exp=w,ke.ln=P,ke.pow=function(Se,Le,We){return P(Se,Le),R(Se,Se,We),w(Se,Se),Se},ke.slerp=D,ke.random=function(Se){var Le=o.RANDOM(),We=o.RANDOM(),Ue=o.RANDOM(),Xe=Math.sqrt(1-Le),He=Math.sqrt(Le);return Se[0]=Xe*Math.sin(2*Math.PI*We),Se[1]=Xe*Math.cos(2*Math.PI*We),Se[2]=He*Math.sin(2*Math.PI*Ue),Se[3]=He*Math.cos(2*Math.PI*Ue),Se},ke.invert=function(Se,Le){var We=Le[0],Ue=Le[1],Xe=Le[2],He=Le[3],nt=We*We+Ue*Ue+Xe*Xe+He*He,Je=nt?1/nt:0;return Se[0]=-We*Je,Se[1]=-Ue*Je,Se[2]=-Xe*Je,Se[3]=He*Je,Se},ke.conjugate=function(Se,Le){return Se[0]=-Le[0],Se[1]=-Le[1],Se[2]=-Le[2],Se[3]=Le[3],Se},ke.fromMat3=O,ke.fromEuler=function(Se,Le,We,Ue){var Xe=.5*Math.PI/180;Le*=Xe,We*=Xe,Ue*=Xe;var He=Math.sin(Le),nt=Math.cos(Le),Je=Math.sin(We),it=Math.cos(We),Mt=Math.sin(Ue),At=Math.cos(Ue);return Se[0]=He*it*At-nt*Je*Mt,Se[1]=nt*Je*At+He*it*Mt,Se[2]=nt*it*Mt-He*Je*At,Se[3]=nt*it*At+He*Je*Mt,Se},ke.str=function(Se){return"quat("+Se[0]+", "+Se[1]+", "+Se[2]+", "+Se[3]+")"},ke.setAxes=ke.sqlerp=ke.rotationTo=ke.equals=ke.exactEquals=ke.normalize=ke.sqrLen=ke.squaredLength=ke.len=ke.length=ke.lerp=ke.dot=ke.scale=ke.mul=ke.add=ke.set=ke.copy=ke.fromValues=ke.clone=void 0;var o=v(I()),c=v(oe()),f=v(je()),m=v(st());function p(Se){if(typeof WeakMap!="function")return null;var Le=new WeakMap,We=new WeakMap;return(p=function(Ue){return Ue?We:Le})(Se)}function v(Se,Le){if(Se&&Se.__esModule)return Se;if(Se===null||d(Se)!=="object"&&typeof Se!="function")return{default:Se};var We=p(Le);if(We&&We.has(Se))return We.get(Se);var Ue={},Xe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var He in Se)if(He!=="default"&&Object.prototype.hasOwnProperty.call(Se,He)){var nt=Xe?Object.getOwnPropertyDescriptor(Se,He):null;nt&&(nt.get||nt.set)?Object.defineProperty(Ue,He,nt):Ue[He]=Se[He]}return Ue.default=Se,We&&We.set(Se,Ue),Ue}function T(){var Se=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0),Se[3]=1,Se}function M(Se,Le,We){We*=.5;var Ue=Math.sin(We);return Se[0]=Ue*Le[0],Se[1]=Ue*Le[1],Se[2]=Ue*Le[2],Se[3]=Math.cos(We),Se}function k(Se,Le,We){var Ue=Le[0],Xe=Le[1],He=Le[2],nt=Le[3],Je=We[0],it=We[1],Mt=We[2],At=We[3];return Se[0]=Ue*At+nt*Je+Xe*Mt-He*it,Se[1]=Xe*At+nt*it+He*Je-Ue*Mt,Se[2]=He*At+nt*Mt+Ue*it-Xe*Je,Se[3]=nt*At-Ue*Je-Xe*it-He*Mt,Se}function w(Se,Le){var We=Le[0],Ue=Le[1],Xe=Le[2],He=Le[3],nt=Math.sqrt(We*We+Ue*Ue+Xe*Xe),Je=Math.exp(He),it=nt>0?Je*Math.sin(nt)/nt:0;return Se[0]=We*it,Se[1]=Ue*it,Se[2]=Xe*it,Se[3]=Je*Math.cos(nt),Se}function P(Se,Le){var We=Le[0],Ue=Le[1],Xe=Le[2],He=Le[3],nt=Math.sqrt(We*We+Ue*Ue+Xe*Xe),Je=nt>0?Math.atan2(nt,He)/nt:0;return Se[0]=We*Je,Se[1]=Ue*Je,Se[2]=Xe*Je,Se[3]=.5*Math.log(We*We+Ue*Ue+Xe*Xe+He*He),Se}function D(Se,Le,We,Ue){var Xe,He,nt,Je,it,Mt=Le[0],At=Le[1],er=Le[2],Rt=Le[3],Ft=We[0],It=We[1],_r=We[2],Xt=We[3];return(He=Mt*Ft+At*It+er*_r+Rt*Xt)<0&&(He=-He,Ft=-Ft,It=-It,_r=-_r,Xt=-Xt),1-He>o.EPSILON?(Xe=Math.acos(He),nt=Math.sin(Xe),Je=Math.sin((1-Ue)*Xe)/nt,it=Math.sin(Ue*Xe)/nt):(Je=1-Ue,it=Ue),Se[0]=Je*Mt+it*Ft,Se[1]=Je*At+it*It,Se[2]=Je*er+it*_r,Se[3]=Je*Rt+it*Xt,Se}function O(Se,Le){var We,Ue=Le[0]+Le[4]+Le[8];if(Ue>0)We=Math.sqrt(Ue+1),Se[3]=.5*We,Se[0]=(Le[5]-Le[7])*(We=.5/We),Se[1]=(Le[6]-Le[2])*We,Se[2]=(Le[1]-Le[3])*We;else{var Xe=0;Le[4]>Le[0]&&(Xe=1),Le[8]>Le[3*Xe+Xe]&&(Xe=2);var He=(Xe+1)%3,nt=(Xe+2)%3;We=Math.sqrt(Le[3*Xe+Xe]-Le[3*He+He]-Le[3*nt+nt]+1),Se[Xe]=.5*We,Se[3]=(Le[3*He+nt]-Le[3*nt+He])*(We=.5/We),Se[He]=(Le[3*He+Xe]+Le[3*Xe+He])*We,Se[nt]=(Le[3*nt+Xe]+Le[3*Xe+nt])*We}return Se}ke.clone=m.clone,ke.fromValues=m.fromValues,ke.copy=m.copy,ke.set=m.set,ke.add=m.add,ke.mul=k;var R=m.scale;ke.scale=R;var N=m.dot;ke.dot=N,ke.lerp=m.lerp;var W=m.length;ke.length=W,ke.len=W;var Z=m.squaredLength;ke.squaredLength=Z,ke.sqrLen=Z;var te=m.normalize;ke.normalize=te,ke.exactEquals=m.exactEquals,ke.equals=m.equals;var ee,K,ie,le=(ee=f.create(),K=f.fromValues(1,0,0),ie=f.fromValues(0,1,0),function(Se,Le,We){var Ue=f.dot(Le,We);return Ue<-.999999?(f.cross(ee,K,Le),f.len(ee)<1e-6&&f.cross(ee,ie,Le),f.normalize(ee,ee),M(Se,ee,Math.PI),Se):Ue>.999999?(Se[0]=0,Se[1]=0,Se[2]=0,Se[3]=1,Se):(f.cross(ee,Le,We),Se[0]=ee[0],Se[1]=ee[1],Se[2]=ee[2],Se[3]=1+Ue,te(Se,Se))});ke.rotationTo=le;var he,we,_e=(he=T(),we=T(),function(Se,Le,We,Ue,Xe,He){return D(he,Le,Xe,He),D(we,We,Ue,He),D(Se,he,we,2*He*(1-He)),Se});ke.sqlerp=_e;var xe,De=(xe=c.create(),function(Se,Le,We,Ue){return xe[0]=We[0],xe[3]=We[1],xe[6]=We[2],xe[1]=Ue[0],xe[4]=Ue[1],xe[7]=Ue[2],xe[2]=-Le[0],xe[5]=-Le[1],xe[8]=-Le[2],te(Se,O(Se,xe))});return ke.setAxes=De,ke}var Be,lt={};function zt(){if(Be)return lt;function d(D){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},d(D)}Be=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=function(){var D=new o.ARRAY_TYPE(8);return o.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D},lt.clone=function(D){var O=new o.ARRAY_TYPE(8);return O[0]=D[0],O[1]=D[1],O[2]=D[2],O[3]=D[3],O[4]=D[4],O[5]=D[5],O[6]=D[6],O[7]=D[7],O},lt.fromValues=function(D,O,R,N,W,Z,te,ee){var K=new o.ARRAY_TYPE(8);return K[0]=D,K[1]=O,K[2]=R,K[3]=N,K[4]=W,K[5]=Z,K[6]=te,K[7]=ee,K},lt.fromRotationTranslationValues=function(D,O,R,N,W,Z,te){var ee=new o.ARRAY_TYPE(8);ee[0]=D,ee[1]=O,ee[2]=R,ee[3]=N;var K=.5*W,ie=.5*Z,le=.5*te;return ee[4]=K*N+ie*R-le*O,ee[5]=ie*N+le*D-K*R,ee[6]=le*N+K*O-ie*D,ee[7]=-K*D-ie*O-le*R,ee},lt.fromRotationTranslation=v,lt.fromTranslation=function(D,O){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=.5*O[0],D[5]=.5*O[1],D[6]=.5*O[2],D[7]=0,D},lt.fromRotation=function(D,O){return D[0]=O[0],D[1]=O[1],D[2]=O[2],D[3]=O[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},lt.fromMat4=function(D,O){var R=c.create();f.getRotation(R,O);var N=new o.ARRAY_TYPE(3);return f.getTranslation(N,O),v(D,R,N),D},lt.copy=T,lt.identity=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},lt.set=function(D,O,R,N,W,Z,te,ee,K){return D[0]=O,D[1]=R,D[2]=N,D[3]=W,D[4]=Z,D[5]=te,D[6]=ee,D[7]=K,D},lt.getDual=function(D,O){return D[0]=O[4],D[1]=O[5],D[2]=O[6],D[3]=O[7],D},lt.setDual=function(D,O){return D[4]=O[0],D[5]=O[1],D[6]=O[2],D[7]=O[3],D},lt.getTranslation=function(D,O){var R=O[4],N=O[5],W=O[6],Z=O[7],te=-O[0],ee=-O[1],K=-O[2],ie=O[3];return D[0]=2*(R*ie+Z*te+N*K-W*ee),D[1]=2*(N*ie+Z*ee+W*te-R*K),D[2]=2*(W*ie+Z*K+R*ee-N*te),D},lt.translate=function(D,O,R){var N=O[0],W=O[1],Z=O[2],te=O[3],ee=.5*R[0],K=.5*R[1],ie=.5*R[2],le=O[4],he=O[5],we=O[6],_e=O[7];return D[0]=N,D[1]=W,D[2]=Z,D[3]=te,D[4]=te*ee+W*ie-Z*K+le,D[5]=te*K+Z*ee-N*ie+he,D[6]=te*ie+N*K-W*ee+we,D[7]=-N*ee-W*K-Z*ie+_e,D},lt.rotateX=function(D,O,R){var N=-O[0],W=-O[1],Z=-O[2],te=O[3],ee=O[4],K=O[5],ie=O[6],le=O[7],he=ee*te+le*N+K*Z-ie*W,we=K*te+le*W+ie*N-ee*Z,_e=ie*te+le*Z+ee*W-K*N,xe=le*te-ee*N-K*W-ie*Z;return c.rotateX(D,O,R),D[4]=he*(te=D[3])+xe*(N=D[0])+we*(Z=D[2])-_e*(W=D[1]),D[5]=we*te+xe*W+_e*N-he*Z,D[6]=_e*te+xe*Z+he*W-we*N,D[7]=xe*te-he*N-we*W-_e*Z,D},lt.rotateY=function(D,O,R){var N=-O[0],W=-O[1],Z=-O[2],te=O[3],ee=O[4],K=O[5],ie=O[6],le=O[7],he=ee*te+le*N+K*Z-ie*W,we=K*te+le*W+ie*N-ee*Z,_e=ie*te+le*Z+ee*W-K*N,xe=le*te-ee*N-K*W-ie*Z;return c.rotateY(D,O,R),D[4]=he*(te=D[3])+xe*(N=D[0])+we*(Z=D[2])-_e*(W=D[1]),D[5]=we*te+xe*W+_e*N-he*Z,D[6]=_e*te+xe*Z+he*W-we*N,D[7]=xe*te-he*N-we*W-_e*Z,D},lt.rotateZ=function(D,O,R){var N=-O[0],W=-O[1],Z=-O[2],te=O[3],ee=O[4],K=O[5],ie=O[6],le=O[7],he=ee*te+le*N+K*Z-ie*W,we=K*te+le*W+ie*N-ee*Z,_e=ie*te+le*Z+ee*W-K*N,xe=le*te-ee*N-K*W-ie*Z;return c.rotateZ(D,O,R),D[4]=he*(te=D[3])+xe*(N=D[0])+we*(Z=D[2])-_e*(W=D[1]),D[5]=we*te+xe*W+_e*N-he*Z,D[6]=_e*te+xe*Z+he*W-we*N,D[7]=xe*te-he*N-we*W-_e*Z,D},lt.rotateByQuatAppend=function(D,O,R){var N=R[0],W=R[1],Z=R[2],te=R[3],ee=O[0],K=O[1],ie=O[2],le=O[3];return D[0]=ee*te+le*N+K*Z-ie*W,D[1]=K*te+le*W+ie*N-ee*Z,D[2]=ie*te+le*Z+ee*W-K*N,D[3]=le*te-ee*N-K*W-ie*Z,D[4]=(ee=O[4])*te+(le=O[7])*N+(K=O[5])*Z-(ie=O[6])*W,D[5]=K*te+le*W+ie*N-ee*Z,D[6]=ie*te+le*Z+ee*W-K*N,D[7]=le*te-ee*N-K*W-ie*Z,D},lt.rotateByQuatPrepend=function(D,O,R){var N=O[0],W=O[1],Z=O[2],te=O[3],ee=R[0],K=R[1],ie=R[2],le=R[3];return D[0]=N*le+te*ee+W*ie-Z*K,D[1]=W*le+te*K+Z*ee-N*ie,D[2]=Z*le+te*ie+N*K-W*ee,D[3]=te*le-N*ee-W*K-Z*ie,D[4]=N*(le=R[7])+te*(ee=R[4])+W*(ie=R[6])-Z*(K=R[5]),D[5]=W*le+te*K+Z*ee-N*ie,D[6]=Z*le+te*ie+N*K-W*ee,D[7]=te*le-N*ee-W*K-Z*ie,D},lt.rotateAroundAxis=function(D,O,R,N){if(Math.abs(N)<o.EPSILON)return T(D,O);var W=Math.hypot(R[0],R[1],R[2]);N*=.5;var Z=Math.sin(N),te=Z*R[0]/W,ee=Z*R[1]/W,K=Z*R[2]/W,ie=Math.cos(N),le=O[0],he=O[1],we=O[2],_e=O[3];D[0]=le*ie+_e*te+he*K-we*ee,D[1]=he*ie+_e*ee+we*te-le*K,D[2]=we*ie+_e*K+le*ee-he*te,D[3]=_e*ie-le*te-he*ee-we*K;var xe=O[4],De=O[5],Se=O[6],Le=O[7];return D[4]=xe*ie+Le*te+De*K-Se*ee,D[5]=De*ie+Le*ee+Se*te-xe*K,D[6]=Se*ie+Le*K+xe*ee-De*te,D[7]=Le*ie-xe*te-De*ee-Se*K,D},lt.add=function(D,O,R){return D[0]=O[0]+R[0],D[1]=O[1]+R[1],D[2]=O[2]+R[2],D[3]=O[3]+R[3],D[4]=O[4]+R[4],D[5]=O[5]+R[5],D[6]=O[6]+R[6],D[7]=O[7]+R[7],D},lt.multiply=M,lt.scale=function(D,O,R){return D[0]=O[0]*R,D[1]=O[1]*R,D[2]=O[2]*R,D[3]=O[3]*R,D[4]=O[4]*R,D[5]=O[5]*R,D[6]=O[6]*R,D[7]=O[7]*R,D},lt.lerp=function(D,O,R,N){var W=1-N;return k(O,R)<0&&(N=-N),D[0]=O[0]*W+R[0]*N,D[1]=O[1]*W+R[1]*N,D[2]=O[2]*W+R[2]*N,D[3]=O[3]*W+R[3]*N,D[4]=O[4]*W+R[4]*N,D[5]=O[5]*W+R[5]*N,D[6]=O[6]*W+R[6]*N,D[7]=O[7]*W+R[7]*N,D},lt.invert=function(D,O){var R=P(O);return D[0]=-O[0]/R,D[1]=-O[1]/R,D[2]=-O[2]/R,D[3]=O[3]/R,D[4]=-O[4]/R,D[5]=-O[5]/R,D[6]=-O[6]/R,D[7]=O[7]/R,D},lt.conjugate=function(D,O){return D[0]=-O[0],D[1]=-O[1],D[2]=-O[2],D[3]=O[3],D[4]=-O[4],D[5]=-O[5],D[6]=-O[6],D[7]=O[7],D},lt.normalize=function(D,O){var R=P(O);if(R>0){R=Math.sqrt(R);var N=O[0]/R,W=O[1]/R,Z=O[2]/R,te=O[3]/R,ee=O[4],K=O[5],ie=O[6],le=O[7],he=N*ee+W*K+Z*ie+te*le;D[0]=N,D[1]=W,D[2]=Z,D[3]=te,D[4]=(ee-N*he)/R,D[5]=(K-W*he)/R,D[6]=(ie-Z*he)/R,D[7]=(le-te*he)/R}return D},lt.str=function(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"},lt.exactEquals=function(D,O){return D[0]===O[0]&&D[1]===O[1]&&D[2]===O[2]&&D[3]===O[3]&&D[4]===O[4]&&D[5]===O[5]&&D[6]===O[6]&&D[7]===O[7]},lt.equals=function(D,O){var R=D[0],N=D[1],W=D[2],Z=D[3],te=D[4],ee=D[5],K=D[6],ie=D[7],le=O[0],he=O[1],we=O[2],_e=O[3],xe=O[4],De=O[5],Se=O[6],Le=O[7];return Math.abs(R-le)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(le))&&Math.abs(N-he)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(he))&&Math.abs(W-we)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(we))&&Math.abs(Z-_e)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(_e))&&Math.abs(te-xe)<=o.EPSILON*Math.max(1,Math.abs(te),Math.abs(xe))&&Math.abs(ee-De)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(De))&&Math.abs(K-Se)<=o.EPSILON*Math.max(1,Math.abs(K),Math.abs(Se))&&Math.abs(ie-Le)<=o.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Le))},lt.sqrLen=lt.squaredLength=lt.len=lt.length=lt.dot=lt.mul=lt.setReal=lt.getReal=void 0;var o=p(I()),c=p(ot()),f=p(ve());function m(D){if(typeof WeakMap!="function")return null;var O=new WeakMap,R=new WeakMap;return(m=function(N){return N?R:O})(D)}function p(D,O){if(D&&D.__esModule)return D;if(D===null||d(D)!=="object"&&typeof D!="function")return{default:D};var R=m(O);if(R&&R.has(D))return R.get(D);var N={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in D)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(D,Z)){var te=W?Object.getOwnPropertyDescriptor(D,Z):null;te&&(te.get||te.set)?Object.defineProperty(N,Z,te):N[Z]=D[Z]}return N.default=D,R&&R.set(D,N),N}function v(D,O,R){var N=.5*R[0],W=.5*R[1],Z=.5*R[2],te=O[0],ee=O[1],K=O[2],ie=O[3];return D[0]=te,D[1]=ee,D[2]=K,D[3]=ie,D[4]=N*ie+W*K-Z*ee,D[5]=W*ie+Z*te-N*K,D[6]=Z*ie+N*ee-W*te,D[7]=-N*te-W*ee-Z*K,D}function T(D,O){return D[0]=O[0],D[1]=O[1],D[2]=O[2],D[3]=O[3],D[4]=O[4],D[5]=O[5],D[6]=O[6],D[7]=O[7],D}function M(D,O,R){var N=O[0],W=O[1],Z=O[2],te=O[3],ee=R[4],K=R[5],ie=R[6],le=R[7],he=O[4],we=O[5],_e=O[6],xe=O[7],De=R[0],Se=R[1],Le=R[2],We=R[3];return D[0]=N*We+te*De+W*Le-Z*Se,D[1]=W*We+te*Se+Z*De-N*Le,D[2]=Z*We+te*Le+N*Se-W*De,D[3]=te*We-N*De-W*Se-Z*Le,D[4]=N*le+te*ee+W*ie-Z*K+he*We+xe*De+we*Le-_e*Se,D[5]=W*le+te*K+Z*ee-N*ie+we*We+xe*Se+_e*De-he*Le,D[6]=Z*le+te*ie+N*K-W*ee+_e*We+xe*Le+he*Se-we*De,D[7]=te*le-N*ee-W*K-Z*ie+xe*We-he*De-we*Se-_e*Le,D}lt.getReal=c.copy,lt.setReal=c.copy,lt.mul=M;var k=c.dot;lt.dot=k;var w=c.length;lt.length=w,lt.len=w;var P=c.squaredLength;return lt.squaredLength=P,lt.sqrLen=P,lt}var Lt,Bt,ct={};function nr(){if(Lt)return ct;function d(O){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},d(O)}Lt=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.create=f,ct.clone=function(O){var R=new o.ARRAY_TYPE(2);return R[0]=O[0],R[1]=O[1],R},ct.fromValues=function(O,R){var N=new o.ARRAY_TYPE(2);return N[0]=O,N[1]=R,N},ct.copy=function(O,R){return O[0]=R[0],O[1]=R[1],O},ct.set=function(O,R,N){return O[0]=R,O[1]=N,O},ct.add=function(O,R,N){return O[0]=R[0]+N[0],O[1]=R[1]+N[1],O},ct.subtract=m,ct.multiply=p,ct.divide=v,ct.ceil=function(O,R){return O[0]=Math.ceil(R[0]),O[1]=Math.ceil(R[1]),O},ct.floor=function(O,R){return O[0]=Math.floor(R[0]),O[1]=Math.floor(R[1]),O},ct.min=function(O,R,N){return O[0]=Math.min(R[0],N[0]),O[1]=Math.min(R[1],N[1]),O},ct.max=function(O,R,N){return O[0]=Math.max(R[0],N[0]),O[1]=Math.max(R[1],N[1]),O},ct.round=function(O,R){return O[0]=Math.round(R[0]),O[1]=Math.round(R[1]),O},ct.scale=function(O,R,N){return O[0]=R[0]*N,O[1]=R[1]*N,O},ct.scaleAndAdd=function(O,R,N,W){return O[0]=R[0]+N[0]*W,O[1]=R[1]+N[1]*W,O},ct.distance=T,ct.squaredDistance=M,ct.length=k,ct.squaredLength=w,ct.negate=function(O,R){return O[0]=-R[0],O[1]=-R[1],O},ct.inverse=function(O,R){return O[0]=1/R[0],O[1]=1/R[1],O},ct.normalize=function(O,R){var N=R[0],W=R[1],Z=N*N+W*W;return Z>0&&(Z=1/Math.sqrt(Z)),O[0]=R[0]*Z,O[1]=R[1]*Z,O},ct.dot=function(O,R){return O[0]*R[0]+O[1]*R[1]},ct.cross=function(O,R,N){var W=R[0]*N[1]-R[1]*N[0];return O[0]=O[1]=0,O[2]=W,O},ct.lerp=function(O,R,N,W){var Z=R[0],te=R[1];return O[0]=Z+W*(N[0]-Z),O[1]=te+W*(N[1]-te),O},ct.random=function(O,R){R=R||1;var N=2*o.RANDOM()*Math.PI;return O[0]=Math.cos(N)*R,O[1]=Math.sin(N)*R,O},ct.transformMat2=function(O,R,N){var W=R[0],Z=R[1];return O[0]=N[0]*W+N[2]*Z,O[1]=N[1]*W+N[3]*Z,O},ct.transformMat2d=function(O,R,N){var W=R[0],Z=R[1];return O[0]=N[0]*W+N[2]*Z+N[4],O[1]=N[1]*W+N[3]*Z+N[5],O},ct.transformMat3=function(O,R,N){var W=R[0],Z=R[1];return O[0]=N[0]*W+N[3]*Z+N[6],O[1]=N[1]*W+N[4]*Z+N[7],O},ct.transformMat4=function(O,R,N){var W=R[0],Z=R[1];return O[0]=N[0]*W+N[4]*Z+N[12],O[1]=N[1]*W+N[5]*Z+N[13],O},ct.rotate=function(O,R,N,W){var Z=R[0]-N[0],te=R[1]-N[1],ee=Math.sin(W),K=Math.cos(W);return O[0]=Z*K-te*ee+N[0],O[1]=Z*ee+te*K+N[1],O},ct.angle=function(O,R){var N=O[0],W=O[1],Z=R[0],te=R[1],ee=Math.sqrt(N*N+W*W)*Math.sqrt(Z*Z+te*te);return Math.acos(Math.min(Math.max(ee&&(N*Z+W*te)/ee,-1),1))},ct.zero=function(O){return O[0]=0,O[1]=0,O},ct.str=function(O){return"vec2("+O[0]+", "+O[1]+")"},ct.exactEquals=function(O,R){return O[0]===R[0]&&O[1]===R[1]},ct.equals=function(O,R){var N=O[0],W=O[1],Z=R[0],te=R[1];return Math.abs(N-Z)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(Z))&&Math.abs(W-te)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(te))},ct.forEach=ct.sqrLen=ct.sqrDist=ct.dist=ct.div=ct.mul=ct.sub=ct.len=void 0;var o=function(O,R){if(O&&O.__esModule)return O;if(O===null||d(O)!=="object"&&typeof O!="function")return{default:O};var N=c(void 0);if(N&&N.has(O))return N.get(O);var W={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in O)if(te!=="default"&&Object.prototype.hasOwnProperty.call(O,te)){var ee=Z?Object.getOwnPropertyDescriptor(O,te):null;ee&&(ee.get||ee.set)?Object.defineProperty(W,te,ee):W[te]=O[te]}return W.default=O,N&&N.set(O,W),W}(I());function c(O){if(typeof WeakMap!="function")return null;var R=new WeakMap,N=new WeakMap;return(c=function(W){return W?N:R})(O)}function f(){var O=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0),O}function m(O,R,N){return O[0]=R[0]-N[0],O[1]=R[1]-N[1],O}function p(O,R,N){return O[0]=R[0]*N[0],O[1]=R[1]*N[1],O}function v(O,R,N){return O[0]=R[0]/N[0],O[1]=R[1]/N[1],O}function T(O,R){return Math.hypot(R[0]-O[0],R[1]-O[1])}function M(O,R){var N=R[0]-O[0],W=R[1]-O[1];return N*N+W*W}function k(O){return Math.hypot(O[0],O[1])}function w(O){var R=O[0],N=O[1];return R*R+N*N}ct.len=k,ct.sub=m,ct.mul=p,ct.div=v,ct.dist=T,ct.sqrDist=M,ct.sqrLen=w;var P,D=(P=f(),function(O,R,N,W,Z,te){var ee,K;for(R||(R=2),N||(N=0),K=W?Math.min(W*R+N,O.length):O.length,ee=N;ee<K;ee+=R)P[0]=O[ee],P[1]=O[ee+1],Z(P,P,te),O[ee]=P[0],O[ee+1]=P[1];return O});return ct.forEach=D,ct}function mr(){if(Bt)return E;function d(O){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},d(O)}Bt=1,Object.defineProperty(E,"__esModule",{value:!0}),E.vec4=E.vec3=E.vec2=E.quat2=E.quat=E.mat4=E.mat3=E.mat2d=E.mat2=E.glMatrix=void 0;var o=D(I());E.glMatrix=o;var c=D(B());E.mat2=c;var f=D(H());E.mat2d=f;var m=D(oe());E.mat3=m;var p=D(ve());E.mat4=p;var v=D(ot());E.quat=v;var T=D(zt());E.quat2=T;var M=D(nr());E.vec2=M;var k=D(je());E.vec3=k;var w=D(st());function P(O){if(typeof WeakMap!="function")return null;var R=new WeakMap,N=new WeakMap;return(P=function(W){return W?N:R})(O)}function D(O,R){if(O&&O.__esModule)return O;if(O===null||d(O)!=="object"&&typeof O!="function")return{default:O};var N=P(R);if(N&&N.has(O))return N.get(O);var W={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in O)if(te!=="default"&&Object.prototype.hasOwnProperty.call(O,te)){var ee=Z?Object.getOwnPropertyDescriptor(O,te):null;ee&&(ee.get||ee.set)?Object.defineProperty(W,te,ee):W[te]=O[te]}return W.default=O,N&&N.set(O,W),W}return E.vec4=w,E}var ir,Ut,hr,Vt,ge=mr(),ur=function(){if(Ut)return ir;function d(o,c,f,m){this.cx=3*o,this.bx=3*(f-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(m-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=c,this.p2x=f,this.p2y=m}return Ut=1,ir=d,d.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,c){if(c===void 0&&(c=1e-6),o<0)return 0;if(o>1)return 1;for(var f=o,m=0;m<8;m++){var p=this.sampleCurveX(f)-o;if(Math.abs(p)<c)return f;var v=this.sampleCurveDerivativeX(f);if(Math.abs(v)<1e-6)break;f-=p/v}var T=0,M=1;for(f=o,m=0;m<20&&(p=this.sampleCurveX(f),!(Math.abs(p-o)<c));m++)o>p?T=f:M=f,f=.5*(M-T)+T;return f},solve:function(o,c){return this.sampleCurveY(this.solveCurveX(o,c))}},ir}(),Ot=_(ur);function tr(){if(Vt)return hr;function d(o,c){this.x=o,this.y=c}return Vt=1,hr=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,c){return this.clone()._rotateAround(o,c)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var c=o.x-this.x,f=o.y-this.y;return c*c+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,c){return Math.atan2(this.x*c-this.y*o,this.x*o+this.y*c)},_matMult:function(o){var c=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=c,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var c=Math.cos(o),f=Math.sin(o),m=f*this.x+c*this.y;return this.x=c*this.x-f*this.y,this.y=m,this},_rotateAround:function(o,c){var f=Math.cos(o),m=Math.sin(o),p=c.y+m*(this.x-c.x)+f*(this.y-c.y);return this.x=c.x+f*(this.x-c.x)-m*(this.y-c.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(o){return o instanceof d?o:Array.isArray(o)?new d(o[0],o[1]):o},hr}var xt=_(tr());function un(d,o){if(Array.isArray(d)){if(!Array.isArray(o)||d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(!un(d[c],o[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&o!==null){if(typeof o!="object"||Object.keys(d).length!==Object.keys(o).length)return!1;for(const c in d)if(!un(d[c],o[c]))return!1;return!0}return d===o}const Fr=Math.PI/180,Ln=180/Math.PI;function Ge(d){return d*Fr}function vt(d){return d*Ln}const kt=[[0,0],[1,0],[1,1],[0,1]];function fr(d){if(d<=0)return 0;if(d>=1)return 1;const o=d*d,c=o*d;return 4*(d<.5?c:3*(d-o)+c-.75)}function dr(d,o,c,f){const m=new Ot(d,o,c,f);return function(p){return m.solve(p)}}const ar=dr(.25,.1,.25,1);function Yt(d,o,c){return Math.min(c,Math.max(o,d))}function Zr(d,o,c){return(c=Yt((c-d)/(o-d),0,1))*c*(3-2*c)}function oi(d,o,c){const f=c-o,m=((d-o)%f+f)%f+o;return m===o?c:m}function Bn(d,o,c){if(!d.length)return c(null,[]);let f=d.length;const m=new Array(d.length);let p=null;d.forEach((v,T)=>{o(v,(M,k)=>{M&&(p=M),m[T]=k,--f==0&&c(p,m)})})}function Ti(d,...o){for(const c of o)for(const f in c)d[f]=c[f];return d}let So=1;function Wo(){return So++}function la(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function ys(d,o){d.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function Ba(d,o,c){const f={};for(const m in d)f[m]=o.call(this,d[m],m,d);return f}function vs(d,o,c){const f={};for(const m in d)o.call(this,d[m],m,d)&&(f[m]=d[m]);return f}function go(d){return Array.isArray(d)?d.map(go):typeof d=="object"&&d?Ba(d,go):d}const ca={};function ai(d){ca[d]||(typeof console<"u"&&console.warn(d),ca[d]=!0)}function Wt(d,o,c){return(c.y-d.y)*(o.x-d.x)>(o.y-d.y)*(c.x-d.x)}function Hr(d){let o=0;for(let c,f,m=0,p=d.length,v=p-1;m<p;v=m++)c=d[m],f=d[v],o+=(f.x-c.x)*(c.y+f.y);return o}function Xr([d,o,c]){const f=Ge(o+90),m=Ge(c);return{x:d*Math.cos(f)*Math.sin(m),y:d*Math.sin(f)*Math.sin(m),z:d*Math.cos(m),azimuthal:o,polar:c}}function cn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function fn(d){const o={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,f,m,p)=>{const v=m||p;return o[f]=!v||v.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o}let ao=null;function Xi(d,o){return[d[4*o],d[4*o+1],d[4*o+2],d[4*o+3]]}function Jo(d,o,c,f){for(;o<c;){const m=o+c>>1;d[m]<f?o=m+1:c=m}return o}function Ma(d,o,c,f){for(;o<c;){const m=o+c>>1;d[m]<=f?o=m+1:c=m}return o}function _s(d){return d>0?1/(1.001-d):1+d}function ft(d){return d>0?1-1/(1.001-d):-d}const fe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!fe.API_URL)return null;try{const d=new URL(fe.API_URL);return d.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":d.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ye(d){return fe.API_URL_REGEX.test(d)}function Me(d){return fe.API_SPRITE_REGEX.test(d)}let $e,Ne,qe,ut,Ye,pt;function _t(){return $e==null&&($e=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),$e}const gt={now:()=>ut!==void 0?ut:performance.now(),setNow(d){ut=d},restoreNow(){ut=void 0},frame(d){const o=requestAnimationFrame(d);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(d,o=0){const{width:c,height:f}=d;Ye||(Ye=document.createElement("canvas"));const m=Ye.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>Ye.width||f>Ye.height)&&(Ye.width=c,Ye.height=f),m.clearRect(-o,-o,c+2*o,f+2*o),m.drawImage(d,0,0,c,f),m.getImageData(-o,-o,c+2*o,f+2*o)},resolveURL:d=>(Ne||(Ne=document.createElement("a")),Ne.href=d,Ne.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(qe==null&&(qe=window.matchMedia("(prefers-reduced-motion: reduce)")),qe.matches)},hasCanvasFingerprintNoise(){if(pt!==void 0)return pt;if(!_t())return pt=!1,!1;const d=new OffscreenCanvas(85,1),o=d.getContext("2d",{willReadFrequently:!0});let c=0;for(let m=0;m<d.width;++m)o.fillStyle=`rgba(${c++},${c++},${c++}, 255)`,o.fillRect(m,0,1,1);const f=o.getImageData(0,0,d.width,d.height);c=0;for(let m=0;m<f.data.length;++m)if(m%4!=3&&c++!==f.data[m])return pt=!0,!0;return pt=!1,!1}};function Nt(d,o){const c=d.indexOf("?");if(c<0)return`${d}?${new URLSearchParams(o).toString()}`;const f=new URLSearchParams(d.slice(c));for(const m in o)f.set(m,o[m]);return`${d.slice(0,c)}?${f.toString()}`}function Kt(d,o={persistentParams:[]}){const c=d.indexOf("?");if(c<0)return d;const f=new URLSearchParams,m=new URLSearchParams(d.slice(c));for(const v of o.persistentParams){const T=m.get(v);T&&f.set(v,T)}const p=f.toString();return`${d.slice(0,c)}${p.length>0?`?${p}`:""}`}const rr="mapbox-tiles";let Dr=500,Ur=50;const Vr=["language","worldview","jobid"];let qr,Jn;function bi(){try{return caches}catch{}}function en(){const d=bi();d&&qr==null&&(qr=d.open(rr))}let Pn=1/0;const In={supported:!1,testSupport:function(d){!Do&&ji&&(ua?Pa(d):Rn=d)}};let Rn,ji,Do=!1,ua=!1;const Hs=typeof self<"u"?self:{};function Pa(d){const o=d.createTexture();d.bindTexture(d.TEXTURE_2D,o);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,ji),d.isContextLost())return;In.supported=!0}catch{}d.deleteTexture(o),Do=!0}Hs.document&&(ji=Hs.document.createElement("img"),ji.onload=function(){Rn&&Pa(Rn),Rn=null,ua=!0},ji.onerror=function(){Do=!0,Rn=null},ji.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Lo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Lo);class Go extends Error{constructor(o,c,f){c===401&&ye(f)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=c,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const gf=cn()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Zs=function(d,o){if(!(/^file:/.test(c=d.url)||/^file:/.test(gf())&&!/^\w+:/.test(c))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,m){const p=new AbortController,v=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:gf(),referrerPolicy:f.referrerPolicy,signal:p.signal});let T=!1,M=!1;const k=(w=v.url).indexOf("sku=")>0&&ye(w);var w;f.type==="json"&&v.headers.set("Accept","application/json");const P=(O,R,N)=>{if(M)return;if(O&&O.message!=="SecurityError"&&ai(O.toString()),R&&N)return D(R);const W=Date.now();fetch(v).then(Z=>{if(Z.ok){const te=k?Z.clone():null;return D(Z,te,W)}return m(new Go(Z.statusText,Z.status,f.url))}).catch(Z=>{Z.name!=="AbortError"&&m(new Error(`${Z.message} ${f.url}`))})},D=(O,R,N)=>{(f.type==="arrayBuffer"?O.arrayBuffer():f.type==="json"?O.json():O.text()).then(W=>{M||(R&&N&&function(Z,te,ee){if(en(),qr==null)return;const K=fn(te.headers.get("Cache-Control")||"");if(K["no-store"])return;const ie={status:te.status,statusText:te.statusText,headers:new Headers};te.headers.forEach((we,_e)=>ie.headers.set(_e,we)),K["max-age"]&&ie.headers.set("Expires",new Date(ee+1e3*K["max-age"]).toUTCString());const le=ie.headers.get("Expires");if(!le||new Date(le).getTime()-ee<42e4)return;let he=Kt(Z.url,{persistentParams:Vr});if(te.status===206){const we=Z.headers.get("Range");if(!we)return;ie.status=200,he=Nt(he,{range:we})}(function(we,_e){if(Jn===void 0)try{new Response(new ReadableStream),Jn=!0}catch{Jn=!1}Jn?_e(we.body):we.blob().then(_e)})(te,we=>{const _e=new Response((xe=te.status)!==200&&xe!==404&&[101,103,204,205,304].includes(xe)?null:we,ie);var xe;en(),qr!=null&&qr.then(De=>De.put(he,_e)).catch(De=>ai(De.message))})}(v,R,N),T=!0,m(null,W,O.headers.get("Cache-Control"),O.headers.get("Expires")))}).catch(W=>{M||m(new Error(W.message))})};return k?function(O,R){if(en(),qr==null)return R(null);qr.then(N=>{let W=Kt(O.url,{persistentParams:Vr});const Z=O.headers.get("Range");Z&&(W=Nt(W,{range:Z})),N.match(W).then(te=>{const ee=function(K){if(!K)return!1;const ie=new Date(K.headers.get("Expires")||0),le=fn(K.headers.get("Cache-Control")||"");return ie>Date.now()&&!le["no-cache"]}(te);N.delete(W),ee&&N.put(W,te.clone()),R(null,te,ee)}).catch(R)}).catch(R)}(v,P):P(null,null),{cancel:()=>{M=!0,T||p.abort()}}}(d,o);if(cn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",d,o,void 0,!0)}var c;return function(f,m){const p=new XMLHttpRequest;p.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const v in f.headers)p.setRequestHeader(v,f.headers[v]);return f.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=f.credentials==="include",p.onerror=()=>{m(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let v=p.response;if(f.type==="json")try{v=JSON.parse(p.response)}catch(T){return m(T)}m(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else m(new Go(p.statusText,p.status,f.url))},p.send(f.body),{cancel:()=>p.abort()}}(d,o)},$c=function(d,o){return Zs(Ti(d,{type:"arrayBuffer"}),o)};function vb(d){const o=document.createElement("a");return o.href=d,o.protocol===location.protocol&&o.host===location.host}const av="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Um,yf;Um=[],yf=0;const _b=function(d,o){if(In.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),yf>=fe.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:d,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Um.push(p),p}yf++;let c=!1;const f=()=>{if(!c)for(c=!0,yf--;Um.length&&yf<fe.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Um.shift(),{requestParameters:v,callback:T,cancelled:M}=p;M||(p.cancel=_b(v,T).cancel)}},m=$c(d,(p,v,T,M)=>{f(),p?o(p):v&&(self.createImageBitmap?function(k,w){const P=new Blob([new Uint8Array(k)],{type:"image/png"});createImageBitmap(P).then(D=>{w(null,D)}).catch(D=>{w(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(k,w)=>o(k,w,T,M)):function(k,w){const P=new Image;P.onload=()=>{w(null,P),URL.revokeObjectURL(P.src),P.onload=null,requestAnimationFrame(()=>{P.src=av})},P.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(k)],{type:"image/png"});P.src=k.byteLength?URL.createObjectURL(D):av}(v,(k,w)=>o(k,w,T,M)))});return{cancel:()=>{m.cancel(),f()}}};var s2,l2,xb,vf={exports:{}},xs={exports:{}},Pl={exports:{}},Zu=function(){if(xb)return vf.exports;xb=1;var d=(s2||(s2=1,xs.exports=function(c,f){var m,p,v,T,M,k,w,P;for(p=c.length-(m=3&c.length),v=f,M=3432918353,k=461845907,P=0;P<p;)w=255&c.charCodeAt(P)|(255&c.charCodeAt(++P))<<8|(255&c.charCodeAt(++P))<<16|(255&c.charCodeAt(++P))<<24,++P,v=27492+(65535&(T=5*(65535&(v=(v^=w=(65535&(w=(w=(65535&w)*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*k+(((w>>>16)*k&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(w=0,m){case 3:w^=(255&c.charCodeAt(P+2))<<16;case 2:w^=(255&c.charCodeAt(P+1))<<8;case 1:v^=w=(65535&(w=(w=(65535&(w^=255&c.charCodeAt(P)))*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*k+(((w>>>16)*k&65535)<<16)&4294967295}return v^=c.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),xs.exports),o=(l2||(l2=1,Pl.exports=function(c,f){for(var m,p=c.length,v=f^p,T=0;p>=4;)m=1540483477*(65535&(m=255&c.charCodeAt(T)|(255&c.charCodeAt(++T))<<8|(255&c.charCodeAt(++T))<<16|(255&c.charCodeAt(++T))<<24))+((1540483477*(m>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),p-=4,++T;switch(p){case 3:v^=(255&c.charCodeAt(T+2))<<16;case 2:v^=(255&c.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&c.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Pl.exports);return vf.exports=d,vf.exports.murmur3=d,vf.exports.murmur2=o,vf.exports}(),bs=_(Zu);class Ka{constructor(o,...c){Ti(this,c[0]||{}),this.type=o}}class _f extends Ka{constructor(o,c={}){super("error",Ti({error:o},c))}}function bb(d,o,c){c[d]&&c[d].indexOf(o)!==-1||(c[d]=c[d]||[],c[d].push(o))}function sv(d,o,c){if(c&&c[d]){const f=c[d].indexOf(o);f!==-1&&c[d].splice(f,1)}}class Il{on(o,c){return this._listeners=this._listeners||{},bb(o,c,this._listeners),this}off(o,c){return sv(o,c,this._listeners),sv(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},bb(o,c,this._oneTimeListeners),this):new Promise(f=>{this.once(o,f)})}fire(o,c){const f=typeof o=="string"?new Ka(o,c):o,m=f.type;if(this.listens(m)){f.target=this;const p=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const M of p)M.call(this,f);const v=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const M of v)sv(m,M,this._oneTimeListeners),M.call(this,f);const T=this._eventedParent;T&&(Ti(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(f))}else f instanceof _f&&console.error(f.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}class $a{constructor(o){typeof o=="string"?this.name=o:(this.name=o.name,this.iconsetId=o.iconsetId)}static from(o){return new $a(o)}static toString(o){return o.iconsetId?`${o.name}${o.iconsetId}`:o.name}static parse(o){const[c,f]=o.split("");return new $a({name:c,iconsetId:f})}static isEqual(o,c){return o.name===c.name&&o.iconsetId===c.iconsetId}toString(){return $a.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var c2,wb={},Xs=function(){if(c2)return wb;c2=1;var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(p){return(p=Math.round(p))<0?0:p>255?255:p}function c(p){return o(p[p.length-1]==="%"?parseFloat(p)/100*255:parseInt(p))}function f(p){return(v=p[p.length-1]==="%"?parseFloat(p)/100:parseFloat(p))<0?0:v>1?1:v;var v}function m(p,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?p+(v-p)*T*6:2*T<1?v:3*T<2?p+(v-p)*(2/3-T)*6:p}try{wb.parseCSSColor=function(p){var v,T=p.replace(/ /g,"").toLowerCase();if(T in d)return d[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var M=T.indexOf("("),k=T.indexOf(")");if(M!==-1&&k+1===T.length){var w=T.substr(0,M),P=T.substr(M+1,k-(M+1)).split(","),D=1;switch(w){case"rgba":if(P.length!==4)return null;D=f(P.pop());case"rgb":return P.length!==3?null:[c(P[0]),c(P[1]),c(P[2]),D];case"hsla":if(P.length!==4)return null;D=f(P.pop());case"hsl":if(P.length!==3)return null;var O=(parseFloat(P[0])%360+360)%360/360,R=f(P[1]),N=f(P[2]),W=N<=.5?N*(R+1):N+R-N*R,Z=2*N-W;return[o(255*m(Z,W,O+1/3)),o(255*m(Z,W,O)),o(255*m(Z,W,O-1/3)),D];default:return null}}return null}}catch{}return wb}();class On{constructor(o,c,f,m=1){this.r=o,this.g=c,this.b=f,this.a=m}static parse(o){if(!o)return;if(o instanceof On)return o;if(typeof o!="string")return;const c=Xs.parseCSSColor(o);return c?new On(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toStringPremultipliedAlpha(){const[o,c,f,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(c)},${Math.round(f)},${m})`}toString(){const[o,c,f,m]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*c)},${Math.round(255*f)},${m})`}toRenderColor(o){const{r:c,g:f,b:m,a:p}=this;return new Sb(o,c,f,m,p)}clone(){return new On(this.r,this.g,this.b,this.a)}}class Sb{constructor(o,c,f,m,p){if(o){const v=o.image.height,T=v*v;c=p===0?0:c/p*(v-1),f=p===0?0:f/p*(v-1),m=p===0?0:m/p*(v-1);const M=Math.floor(c),k=Math.floor(f),w=Math.floor(m),P=Math.ceil(c),D=Math.ceil(f),O=Math.ceil(m),R=c-M,N=f-k,W=m-w,Z=o.image.data,te=4*(M+k*T+w*v),ee=4*(M+k*T+O*v),K=4*(M+D*T+w*v),ie=4*(M+D*T+O*v),le=4*(P+k*T+w*v),he=4*(P+k*T+O*v),we=4*(P+D*T+w*v),_e=4*(P+D*T+O*v);if(te<0||_e>=Z.length)throw new Error("out of range");this.r=br(br(br(Z[te],Z[ee],W),br(Z[K],Z[ie],W),N),br(br(Z[le],Z[he],W),br(Z[we],Z[_e],W),N),R)/255*p,this.g=br(br(br(Z[te+1],Z[ee+1],W),br(Z[K+1],Z[ie+1],W),N),br(br(Z[le+1],Z[he+1],W),br(Z[we+1],Z[_e+1],W),N),R)/255*p,this.b=br(br(br(Z[te+2],Z[ee+2],W),br(Z[K+2],Z[ie+2],W),N),br(br(Z[le+2],Z[he+2],W),br(Z[we+2],Z[_e+2],W),N),R)/255*p,this.a=p}else this.r=c,this.g=f,this.b=m,this.a=p}toArray(){const{r:o,g:c,b:f,a:m}=this;return m===0?[0,0,0,0]:[255*o/m,255*c/m,255*f/m,m]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:o,g:c,b:f,a:m}=this,p=Math.min(Math.max(o/m,0),1),v=Math.min(Math.max(c/m,0),1),T=Math.min(Math.max(f/m,0),1),M=Math.min(p,v,T),k=Math.max(p,v,T),w=(M+k)/2;if(M===k)return[0,0,100*w,m];const P=k-M,D=w>.5?P/(2-k-M):P/(k+M);let O=0;return k===p?O=(v-T)/P+(v<T?6:0):k===v?O=(T-p)/P+2:k===T&&(O=(p-v)/P+4),O*=60,[Math.min(Math.max(O,0),360),Math.min(Math.max(100*D,0),100),Math.min(Math.max(100*w,0),100),m]}toArray01(){const{r:o,g:c,b:f,a:m}=this;return m===0?[0,0,0,0]:[o/m,c/m,f/m,m]}toArray01Scaled(o){const{r:c,g:f,b:m,a:p}=this;return p===0?[0,0,0]:[c/p*o,f/p*o,m/p*o]}toArray01PremultipliedAlpha(){const{r:o,g:c,b:f,a:m}=this;return[o,c,f,m]}toArray01Linear(){const{r:o,g:c,b:f,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(o/m,2.2),Math.pow(c/m,2.2),Math.pow(f/m,2.2),m]}}function br(d,o,c){return d*(1-c)+o*c}function u2(d,o,c){return d.map((f,m)=>br(f,o[m],c))}function d2(d){return d*d*d*d*d}On.black=new On(0,0,0,1),On.white=new On(1,1,1,1),On.transparent=new On(0,0,0,0),On.red=new On(1,0,0,1),On.blue=new On(0,0,1,1);var Vm=Object.freeze({__proto__:null,array:u2,color:function(d,o,c){return new On(br(d.r,o.r,c),br(d.g,o.g,c),br(d.b,o.b,c),br(d.a,o.a,c))},easeIn:d2,number:br});function vn(d,...o){for(const c of o)for(const f in c)d[f]=c[f];return d}class Ys extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}class lv{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[f,m]of c)this.bindings[f]=m}concat(o){return new lv(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const xf={kind:"null"},cr={kind:"number"},Cn={kind:"string"},pn={kind:"boolean"},da={kind:"color"},bf={kind:"object"},_n={kind:"value"},Uc={kind:"collator"},Wm={kind:"formatted"},Vc={kind:"resolvedImage"};function Qo(d,o){return{kind:"array",itemType:d,N:o}}function Fi(d){if(d.kind==="array"){const o=Fi(d.itemType);return typeof d.N=="number"?`array<${o}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${o}>`}return d.kind}const Ol=[xf,cr,Cn,pn,da,Wm,bf,Qo(_n),Vc];function wf(d,o){if(o.kind==="error")return null;if(d.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!wf(d.itemType,o.itemType))&&(typeof d.N!="number"||d.N===o.N))return null}else{if(d.kind===o.kind)return null;if(d.kind==="value"){for(const c of Ol)if(!wf(c,o))return null}}return`Expected ${Fi(d)} but found ${Fi(o)} instead.`}function Tb(d,o){return o.some(c=>c.kind===d.kind)}function Sf(d,o){return o.some(c=>c==="null"?d===null:c==="array"?Array.isArray(d):c==="object"?d&&!Array.isArray(d)&&typeof d=="object":c===typeof d)}class cv{constructor(o,c,f){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gm{constructor(o,c,f,m,p){this.text=o.normalize?o.normalize():o,this.image=c,this.scale=f,this.fontStack=m,this.textColor=p}}class ha{constructor(o){this.sections=o}static fromString(o){return new ha([new Gm(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||!!o.image&&o.image.hasPrimary())}static factory(o){return o instanceof ha?o:ha.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const c of this.sections){if(c.image){const m=c.image.getPrimary().id.toString();o.push(["image",m]);continue}o.push(c.text);const f={};c.fontStack&&(f["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(f["font-scale"]=c.scale),c.textColor&&(f["text-color"]=["rgba"].concat(c.textColor.toRenderColor(null).toArray())),o.push(f)}return o}}class cc{constructor(o,c={}){if(this.id=$a.from(o),this.options=Object.assign({},c),c.transform){const{a:f,b:m,c:p,d:v,e:T,f:M}=c.transform;this.options.transform=new DOMMatrix([f,m,p,v,T,M])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:o,b:c,c:f,d:m,e:p,f:v}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:o,b:c,c:f,d:m,e:p,f:v}})}static parse(o){let c,f,m,p;try{({name:c,iconsetId:f,params:m,transform:p}=JSON.parse(o)||{})}catch{return null}if(!c)return null;const{a:v,b:T,c:M,d:k,e:w,f:P}=p||{};return new cc({name:c,iconsetId:f},{params:m,transform:new DOMMatrix([v,T,M,k,w,P])})}scaleSelf(o){return this.options.transform.scaleSelf(o),this}}class fa{constructor(o,c,f,m,p=!1){this.primaryId=$a.from(o),this.primaryOptions=c,f&&(this.secondaryId=$a.from(f)),this.secondaryOptions=m,this.available=p}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new cc(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new cc(this.secondaryId,this.secondaryOptions):null}static from(o){return typeof o=="string"?fa.build({name:o}):o}static build(o,c,f,m){return!o||typeof o=="object"&&!("name"in o)?null:new fa(o,f,c,m)}}function qm(d,o,c,f){return typeof d=="number"&&d>=0&&d<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof c=="number"&&c>=0&&c<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[d,o,c,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[d,o,c,f]:[d,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function kl(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof On||d instanceof cv||d instanceof ha||d instanceof fa)return!0;if(Array.isArray(d)){for(const o of d)if(!kl(o))return!1;return!0}if(typeof d=="object"){for(const o in d)if(!kl(d[o]))return!1;return!0}return!1}function so(d){if(d===null)return xf;if(typeof d=="string")return Cn;if(typeof d=="boolean")return pn;if(typeof d=="number")return cr;if(d instanceof On)return da;if(d instanceof cv)return Uc;if(d instanceof ha)return Wm;if(d instanceof fa)return Vc;if(Array.isArray(d)){const o=d.length;let c;for(const f of d){const m=so(f);if(c){if(c===m)continue;c=_n;break}c=m}return Qo(c||_n,o)}return bf}function No(d){const o=typeof d;return d===null?"":o==="string"||o==="number"||o==="boolean"?String(d):d instanceof On?d.toStringPremultipliedAlpha():d instanceof ha||d instanceof fa?d.toString():JSON.stringify(d)}class Wc{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(o.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!kl(o[1]))return c.error("invalid value");const f=o[1];let m=so(f);const p=c.expectedType;return m.kind!=="array"||m.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(m=p),new Wc(m,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof On?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ha?this.value.serialize():this.value}}class Vi{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Eb={string:Cn,number:cr,boolean:pn,object:bf};class ws{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let f,m=1;const p=o[0];if(p==="array"){let T,M;if(o.length>2){const k=o[1];if(typeof k!="string"||!(k in Eb)||k==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);T=Eb[k],m++}else T=_n;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);M=o[2],m++}f=Qo(T,M)}else f=Eb[p];const v=[];for(;m<o.length;m++){const T=c.parse(o[m],m,_n);if(!T)return null;v.push(T)}return new ws(f,v)}evaluate(o){for(let c=0;c<this.args.length;c++){const f=this.args[c].evaluate(o);if(!wf(this.type,so(f)))return f;if(c===this.args.length-1)throw new Vi(`The expression ${JSON.stringify(this.args[c].serialize())} evaluated to ${Fi(so(f))} but was expected to be of type ${Fi(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,c=[o.kind];if(o.kind==="array"){const f=o.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){c.push(f.kind);const m=o.N;(typeof m=="number"||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(f=>f.serialize()))}}class Tf{constructor(o){this.type=Wm,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&typeof f=="object")return c.error("First argument must be an image or text section.");const m=[];let p=!1;for(let v=1;v<=o.length-1;++v){const T=o[v];if(p&&typeof T=="object"&&!Array.isArray(T)){p=!1;let M=null;if(T["font-scale"]&&(M=c.parseObjectValue(T["font-scale"],v,"font-scale",cr),!M))return null;let k=null;if(T["text-font"]&&(k=c.parseObjectValue(T["text-font"],v,"text-font",Qo(Cn)),!k))return null;let w=null;if(T["text-color"]&&(w=c.parseObjectValue(T["text-color"],v,"text-color",da),!w))return null;const P=m[m.length-1];P.scale=M,P.font=k,P.textColor=w}else{const M=c.parse(o[v],v,_n);if(!M)return null;const k=M.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,m.push({content:M,scale:null,font:null,textColor:null})}}return new Tf(m)}evaluate(o){return new ha(this.sections.map(c=>{const f=c.content.evaluate(o);return so(f)===Vc?new Gm("",f,null,null,null):new Gm(No(f),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const c of this.sections){o.push(c.content.serialize());const f={};c.scale&&(f["font-scale"]=c.scale.serialize()),c.font&&(f["text-font"]=c.font.serialize()),c.textColor&&(f["text-color"]=c.textColor.serialize()),o.push(f)}return o}}class Xu{constructor(o,c,f,m){this._imageWarnHistory={},this.type=Vc,this.namePrimary=o,this.nameSecondary=c,f&&(this.paramsPrimary=f.params,this.iconsetIdPrimary=f.iconset?f.iconset.id:void 0),m&&(this.paramsSecondary=m.params,this.iconsetIdSecondary=m.iconset?m.iconset.id:void 0)}static parse(o,c){if(o.length<2)return c.error("Expected two or more arguments.");let f=1;const m=[];function p(){if(f<o.length){const T=c.parse(o[f],f++,Cn);return T?(m.push({image:T,options:{}}),!0):(c.error(m.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(f<o.length){const M=o[f];if((T=M)===null||typeof T!="object"||Array.isArray(T))return!0;const k=M.params,w=M.iconset,P=c.concat(f);if(!k&&!w)return f++,!0;if(k){if(typeof k!="object"||k.constructor!==Object)return P.error('Image options "params" should be an object'),!1;const D={},O=P.concat(void 0,"params");for(const R in k){if(!R)return O.error("Image parameter name should be non-empty"),!1;const N=O.concat(void 0,R).parse(k[R],void 0,da,void 0,{typeAnnotation:"coerce"});if(!N)return!1;D[R]=N}m[m.length-1].options.params=D}if(w){if(typeof w!="object"||w.constructor!==Object)return P.error('Image options "iconset" should be an object'),!1;if(!w.id)return P.error('Image options "iconset" should have an "id" property'),!1;m[m.length-1].options.iconset=w}return f++,!0}var T;return!0}for(let T=0;T<2;T++)if(!p()||!v())return;return new Xu(m[0].image,m[1]?m[1].image:void 0,m[0].options,m[1]?m[1].options:void 0)}evaluateParams(o,c){const f={};if(c){for(const m in c)if(c[m])try{f[m]=c[m].evaluate(o)}catch{continue}if(Object.keys(f).length!==0)return{params:f}}}evaluate(o){const c={name:this.namePrimary.evaluate(o),iconsetId:this.iconsetIdPrimary},f=this.nameSecondary?{name:this.nameSecondary.evaluate(o),iconsetId:this.iconsetIdSecondary}:void 0,m=fa.build(c,f,this.paramsPrimary?this.evaluateParams(o,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(o,this.paramsSecondary):void 0);if(m&&o.availableImages){const p=m.getPrimary().id;if(m.available=o.availableImages.some(v=>$a.isEqual(v,p)),m.available){const v=m.getSecondary()?m.getSecondary().id:null;v&&(m.available=o.availableImages.some(T=>$a.isEqual(T,v)))}}return m}eachChild(o){if(o(this.namePrimary),this.paramsPrimary)for(const c in this.paramsPrimary)this.paramsPrimary[c]&&o(this.paramsPrimary[c]);if(this.nameSecondary&&(o(this.nameSecondary),this.paramsSecondary))for(const c in this.paramsSecondary)this.paramsSecondary[c]&&o(this.paramsSecondary[c])}outputDefined(){return!1}serializeOptions(o,c){const f={};if(c&&(f.iconset={id:c}),o){f.params={};for(const m in o)o[m]&&(f.params[m]=o[m].serialize())}return Object.keys(f).length>0?f:void 0}serialize(){const o=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const c=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);c&&o.push(c)}if(this.nameSecondary&&(o.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const c=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);c&&o.push(c)}return o}}function Gc(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}const eD={"to-boolean":pn,"to-color":da,"to-number":cr,"to-string":Cn};class qc{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const f=o[0],m=[];let p=xf;if(f==="to-array"){if(!Array.isArray(o[1]))return null;const v=o[1].length;if(c.expectedType){if(c.expectedType.kind!=="array")return c.error(`Expected ${c.expectedType.kind} but found array.`);p=Qo(c.expectedType.itemType,v)}else{if(!(v>0&&kl(o[1][0])))return null;p=Qo(so(o[1][0]),v)}for(let T=0;T<v;T++){const M=o[1][T];let k;if(Gc(M)==="array")k=c.parse(M,void 0,p.itemType);else{const w=Gc(M);if(w!==p.itemType.kind)return c.error(`Expected ${p.itemType.kind} but found ${w}.`);k=c.registry.literal.parse(["literal",M===void 0?null:M],c)}if(!k)return null;m.push(k)}}else{if((f==="to-boolean"||f==="to-string")&&o.length!==2)return c.error("Expected one argument.");p=eD[f];for(let v=1;v<o.length;v++){const T=c.parse(o[v],v,_n);if(!T)return null;m.push(T)}}return new qc(p,m)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let c,f;for(const m of this.args){if(c=m.evaluate(o),f=null,c instanceof On)return c;if(typeof c=="string"){const p=o.parseColor(c);if(p)return p}else if(Array.isArray(c)&&(f=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:qm(c[0],c[1],c[2],c[3]),!f))return new On(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Vi(f||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const f of this.args){if(c=f.evaluate(o),c===null)return 0;const m=Number(c);if(!isNaN(m))return m}throw new Vi(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?ha.fromString(No(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?fa.build(No(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(c=>c.evaluate(o)):No(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Tf([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xu(this.args[0]).serialize();const o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(c=>{o.push(c.serialize())}),o}}const tD=["Unknown","Point","LineString","Polygon"];class uv{constructor(o,c){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=c}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?tD[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,c=this.featureDistanceData.scale,{x:f,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*c-o[0])+this.featureDistanceData.bearing[1]*(m*c-o[1])}return 0}parseColor(o){let c=this._parseColorCache[o];return c||(c=this._parseColorCache[o]=On.parse(o)),c}getConfig(o){return this.options?this.options.get(o):null}}class Ia{constructor(o,c,f,m,p){this.name=o,this.type=c,this._evaluate=f,this.args=m,this._overloadIndex=p}evaluate(o){if(!this._evaluate){const c=Ia.definitions[this.name];this._evaluate=Array.isArray(c)?c[2]:c.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,c){const f=o[0],m=Ia.definitions[f];if(!m)return c.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(m)?m[0]:m.type,v=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=[];let M=null,k=-1;for(const[w,P]of v){if(Array.isArray(w)&&w.length!==o.length-1)continue;T.push(w),k++,M=new kb(c.registry,c.path,null,c.scope,void 0,c._scope,c.options);const D=[];let O=!1;for(let R=1;R<o.length;R++){const N=o[R],W=Array.isArray(w)?w[R-1]:w.type,Z=M.parse(N,1+D.length,W);if(!Z){O=!0;break}D.push(Z)}if(!O)if(Array.isArray(w)&&w.length!==D.length)M.error(`Expected ${w.length} arguments, but found ${D.length} instead.`);else{for(let R=0;R<D.length;R++){const N=Array.isArray(w)?w[R]:w.type,W=D[R];M.concat(R+1).checkSubtype(N,W.type)}if(M.errors.length===0)return new Ia(f,p,P,D,k)}}if(T.length===1)c.errors.push(...M.errors);else{const w=(T.length?T:v.map(([D])=>D)).map(rD).join(" | "),P=[];for(let D=1;D<o.length;D++){const O=c.parse(o[D],1+P.length);if(!O)return null;P.push(Fi(O.type))}c.error(`Expected arguments of type ${w}, but found (${P.join(", ")}) instead.`)}return null}static register(o,c){Ia.definitions=c;for(const f in c)o[f]=Ia}}function rD(d){return Array.isArray(d)?`(${d.map(Fi).join(", ")})`:`(${Fi(d.type)}...)`}class Jd{constructor(o,c,f){this.type=Uc,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(o.length!==2)return c.error("Expected one argument.");const f=o[1];if(typeof f!="object"||Array.isArray(f))return c.error("Collator options argument must be an object.");const m=f["case-sensitive"]===void 0?c.parse(!1,1,pn):c.parseObjectValue(f["case-sensitive"],1,"case-sensitive",pn);if(!m)return null;const p=f["diacritic-sensitive"]===void 0?c.parse(!1,1,pn):c.parseObjectValue(f["diacritic-sensitive"],1,"diacritic-sensitive",pn);if(!p)return null;let v=null;return f.locale&&(v=c.parseObjectValue(f.locale,1,"locale",Cn),!v)?null:new Jd(m,p,v)}evaluate(o){return new cv(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function h2(d,o,c=0,f=d.length-1,m=nD){for(;f>c;){if(f-c>600){const M=f-c+1,k=o-c+1,w=Math.log(M),P=.5*Math.exp(2*w/3),D=.5*Math.sqrt(w*P*(M-P)/M)*(k-M/2<0?-1:1);h2(d,o,Math.max(c,Math.floor(o-k*P/M+D)),Math.min(f,Math.floor(o+(M-k)*P/M+D)),m)}const p=d[o];let v=c,T=f;for(Hm(d,c,o),m(d[f],p)>0&&Hm(d,c,f);v<T;){for(Hm(d,v,T),v++,T--;m(d[v],p)<0;)v++;for(;m(d[T],p)>0;)T--}m(d[c],p)===0?Hm(d,c,T):(T++,Hm(d,T,f)),T<=o&&(c=T+1),o<=T&&(f=T-1)}}function Hm(d,o,c){const f=d[o];d[o]=d[c],d[c]=f}function nD(d,o){return d<o?-1:d>o?1:0}function iD(d){let o=0;for(let c,f,m=0,p=d.length,v=p-1;m<p;v=m++)c=d[m],f=d[v],o+=(f.x-c.x)*(c.y+f.y);return o}function Zm(d,o){d[0]=Math.min(d[0],o[0]),d[1]=Math.min(d[1],o[1]),d[2]=Math.max(d[2],o[0]),d[3]=Math.max(d[3],o[1])}function Xm(d,o){return!(d[0]<=o[0]||d[2]>=o[2]||d[1]<=o[1]||d[3]>=o[3])}function oD(d,o,c){const f=d[0]-o[0],m=d[1]-o[1],p=d[0]-c[0],v=d[1]-c[1];return f*v-p*m==0&&f*p<=0&&m*v<=0}function Qd(d,o,c=!1){let f=!1;for(let T=0,M=o.length;T<M;T++){const k=o[T];for(let w=0,P=k.length,D=P-1;w<P;D=w++){const O=k[D],R=k[w];if(oD(d,O,R))return c;(p=O)[1]>(m=d)[1]!=(v=R)[1]>m[1]&&m[0]<(v[0]-p[0])*(m[1]-p[1])/(v[1]-p[1])+p[0]&&(f=!f)}}var m,p,v;return f}function eh(d,o,c,f){const m=f[0]-c[0],p=f[1]-c[1],v=(d[0]-c[0])*p-m*(d[1]-c[1]),T=(o[0]-c[0])*p-m*(o[1]-c[1]);return v>0&&T<0||v<0&&T>0}function dv(d,o,c,f){return(m=[f[0]-c[0],f[1]-c[1]])[0]*(p=[o[0]-d[0],o[1]-d[1]])[1]-m[1]*p[0]!=0&&!(!eh(d,o,c,f)||!eh(c,f,d,o));var m,p}const Yu=8192;function Ab(d,o){const c=(180+d[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,m=Math.pow(2,o.z);return[Math.round(c*m*Yu),Math.round(f*m*Yu)]}function aD(d,o){for(let c=0;c<o.length;c++)if(Qd(d,o[c]))return!0;return!1}function sD(d,o,c){for(const f of c)for(let m=0,p=f.length,v=p-1;m<p;v=m++)if(dv(d,o,f[v],f[m]))return!0;return!1}function f2(d,o){for(let c=0;c<d.length;++c)if(!Qd(d[c],o))return!1;for(let c=0;c<d.length-1;++c)if(sD(d[c],d[c+1],o))return!1;return!0}function lD(d,o){for(let c=0;c<o.length;c++)if(f2(d,o[c]))return!0;return!1}function Ku(d,o,c){const f=[];for(let m=0;m<d.length;m++){const p=[];for(let v=0;v<d[m].length;v++){const T=Ab(d[m][v],c);Zm(o,T),p.push(T)}f.push(p)}return f}function Jr(d,o,c){const f=[];for(let m=0;m<d.length;m++){const p=Ku(d[m],o,c);f.push(p)}return f}function gr(d,o,c,f){if(d[0]<c[0]||d[0]>c[2]){const m=.5*f;let p=d[0]-c[0]>m?-f:c[0]-d[0]>m?f:0;p===0&&(p=d[0]-c[2]>m?-f:c[2]-d[0]>m?f:0),d[0]+=p}Zm(o,d)}function hv(d,o,c,f){const m=Math.pow(2,f.z)*Yu,p=[f.x*Yu,f.y*Yu],v=[];if(!d)return v;for(const T of d)for(const M of T){const k=[M.x+p[0],M.y+p[1]];gr(k,o,c,m),v.push(k)}return v}function Lr(d,o,c,f){const m=Math.pow(2,f.z)*Yu,p=[f.x*Yu,f.y*Yu],v=[];if(!d)return v;for(const M of d){const k=[];for(const w of M){const P=[w.x+p[0],w.y+p[1]];Zm(o,P),k.push(P)}v.push(k)}if(o[2]-o[0]<=m/2){(T=o)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const M of v)for(const k of M)gr(k,o,c,m)}var T;return v}class Hc{constructor(o,c){this.type=pn,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(kl(o[1])){const f=o[1];if(f.type==="FeatureCollection")for(let m=0;m<f.features.length;++m){const p=f.features[m].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Hc(f,f.features[m].geometry)}else if(f.type==="Feature"){const m=f.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Hc(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Hc(f,f)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(c,f){const m=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=c.canonicalID();if(!v)return!1;if(f.type==="Polygon"){const T=Ku(f.coordinates,p,v),M=hv(c.geometry(),m,p,v);if(!Xm(m,p))return!1;for(const k of M)if(!Qd(k,T))return!1}if(f.type==="MultiPolygon"){const T=Jr(f.coordinates,p,v),M=hv(c.geometry(),m,p,v);if(!Xm(m,p))return!1;for(const k of M)if(!aD(k,T))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(c,f){const m=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=c.canonicalID();if(!v)return!1;if(f.type==="Polygon"){const T=Ku(f.coordinates,p,v),M=Lr(c.geometry(),m,p,v);if(!Xm(m,p))return!1;for(const k of M)if(!f2(k,T))return!1}if(f.type==="MultiPolygon"){const T=Jr(f.coordinates,p,v),M=Lr(c.geometry(),m,p,v);if(!Xm(m,p))return!1;for(const k of M)if(!lD(k,T))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Ef={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Or=1/298.257223563,Cb=Or*(2-Or),th=Math.PI/180;class Af{static fromTile(o,c,f){const m=Math.PI*(1-2*(o+.5)/Math.pow(2,c)),p=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/th;return new Af(p,f)}static get units(){return Ef}constructor(o,c){if(o===void 0)throw new Error("No latitude given.");if(c&&!Ef[c])throw new Error(`Unknown unit ${c}. Use one of: ${Object.keys(Ef).join(", ")}`);const f=6378.137*th*(c?Ef[c]:1),m=Math.cos(o*th),p=1/(1-Cb*(1-m*m)),v=Math.sqrt(p);this.kx=f*v*m,this.ky=f*v*p*(1-Cb)}distance(o,c){const f=Ri(o[0]-c[0])*this.kx,m=(o[1]-c[1])*this.ky;return Math.sqrt(f*f+m*m)}bearing(o,c){const f=Ri(c[0]-o[0])*this.kx;return Math.atan2(f,(c[1]-o[1])*this.ky)/th}destination(o,c,f){const m=f*th;return this.offset(o,Math.sin(m)*c,Math.cos(m)*c)}offset(o,c,f){return[o[0]+c/this.kx,o[1]+f/this.ky]}lineDistance(o){let c=0;for(let f=0;f<o.length-1;f++)c+=this.distance(o[f],o[f+1]);return c}area(o){let c=0;for(let f=0;f<o.length;f++){const m=o[f];for(let p=0,v=m.length,T=v-1;p<v;T=p++)c+=Ri(m[p][0]-m[T][0])*(m[p][1]+m[T][1])*(f?-1:1)}return Math.abs(c)/2*this.kx*this.ky}along(o,c){let f=0;if(c<=0)return o[0];for(let m=0;m<o.length-1;m++){const p=o[m],v=o[m+1],T=this.distance(p,v);if(f+=T,f>c)return Cf(p,v,(c-(f-T))/T)}return o[o.length-1]}pointToSegmentDistance(o,c,f){let[m,p]=c,v=Ri(f[0]-m)*this.kx,T=(f[1]-p)*this.ky;if(v!==0||T!==0){const M=(Ri(o[0]-m)*this.kx*v+(o[1]-p)*this.ky*T)/(v*v+T*T);M>1?(m=f[0],p=f[1]):M>0&&(m+=v/this.kx*M,p+=T/this.ky*M)}return v=Ri(o[0]-m)*this.kx,T=(o[1]-p)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(o,c){let f=1/0,m=o[0][0],p=o[0][1],v=0,T=0;for(let M=0;M<o.length-1;M++){let k=o[M][0],w=o[M][1],P=Ri(o[M+1][0]-k)*this.kx,D=(o[M+1][1]-w)*this.ky,O=0;P===0&&D===0||(O=(Ri(c[0]-k)*this.kx*P+(c[1]-w)*this.ky*D)/(P*P+D*D),O>1?(k=o[M+1][0],w=o[M+1][1]):O>0&&(k+=P/this.kx*O,w+=D/this.ky*O)),P=Ri(c[0]-k)*this.kx,D=(c[1]-w)*this.ky;const R=P*P+D*D;R<f&&(f=R,m=k,p=w,v=M,T=O)}return{point:[m,p],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(o,c,f){let m=this.pointOnLine(f,o),p=this.pointOnLine(f,c);if(m.index>p.index||m.index===p.index&&m.t>p.t){const k=m;m=p,p=k}const v=[m.point],T=m.index+1,M=p.index;!Mb(f[T],v[0])&&T<=M&&v.push(f[T]);for(let k=T+1;k<=M;k++)v.push(f[k]);return Mb(f[M],p.point)||v.push(p.point),v}lineSliceAlong(o,c,f){let m=0;const p=[];for(let v=0;v<f.length-1;v++){const T=f[v],M=f[v+1],k=this.distance(T,M);if(m+=k,m>o&&p.length===0&&p.push(Cf(T,M,(o-(m-k))/k)),m>=c)return p.push(Cf(T,M,(c-(m-k))/k)),p;m>o&&p.push(M)}return p}bufferPoint(o,c){const f=c/this.ky,m=c/this.kx;return[o[0]-m,o[1]-f,o[0]+m,o[1]+f]}bufferBBox(o,c){const f=c/this.ky,m=c/this.kx;return[o[0]-m,o[1]-f,o[2]+m,o[3]+f]}insideBBox(o,c){return Ri(o[0]-c[0])>=0&&Ri(o[0]-c[2])<=0&&o[1]>=c[1]&&o[1]<=c[3]}}function Mb(d,o){return d[0]===o[0]&&d[1]===o[1]}function Cf(d,o,c){const f=Ri(o[0]-d[0]);return[d[0]+f*c,d[1]+(o[1]-d[1])*c]}function Ri(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}class Ym{constructor(o=[],c=(f,m)=>f<m?-1:f>m?1:0){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:f}=this,m=c[o];for(;o>0;){const p=o-1>>1,v=c[p];if(f(m,v)>=0)break;c[o]=v,o=p}c[o]=m}_down(o){const{data:c,compare:f}=this,m=this.length>>1,p=c[o];for(;o<m;){let v=1+(o<<1);const T=v+1;if(T<this.length&&f(c[T],c[v])<0&&(v=T),f(c[v],p)>=0)break;c[o]=c[v],o=v}c[o]=p}}var $t=8192;function fv(d,o){return o.dist-d.dist}const Zc=100,ea=50;function p2(d){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==d.length)return!1;for(let c=0;c<o.length;c++)if(o[c]!==d[c])return!1;return!0}function pv(d){return d[1]-d[0]+1}function Xc(d,o){const c=d[1]>=d[0]&&d[1]<o;return c||console.warn("Distance Expression: Index is out of range"),c}function Mf(d,o){if(d[0]>d[1])return[null,null];const c=pv(d);if(o){if(c===2)return[d,null];const f=Math.floor(c/2);return[[d[0],d[0]+f],[d[0]+f,d[1]]]}{if(c===1)return[d,null];const f=Math.floor(c/2)-1;return[[d[0],d[0]+f],[d[0]+f+1,d[1]]]}}function Ju(d,o){const c=[1/0,1/0,-1/0,-1/0];if(!Xc(o,d.length))return c;for(let f=o[0];f<=o[1];++f)Zm(c,d[f]);return c}function Pf(d){const o=[1/0,1/0,-1/0,-1/0];for(let c=0;c<d.length;++c)for(let f=0;f<d[c].length;++f)Zm(o,d[c][f]);return o}function If(d,o,c){if(p2(d)||p2(o))return NaN;let f=0,m=0;return d[2]<o[0]&&(f=o[0]-d[2]),d[0]>o[2]&&(f=d[0]-o[2]),d[1]>o[3]&&(m=d[1]-o[3]),d[3]<o[1]&&(m=o[1]-d[3]),c.distance([0,0],[f,m])}function cD(d){return 360*d-180}function uD(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function Pb(d,o){const c=Math.pow(2,o.z),f=(d.y/$t+o.y)/c;return[cD((d.x/$t+o.x)/c),uD(f)]}function m2(d,o){const c=[];for(let f=0;f<d.length;++f)c.push(Pb(d[f],o));return c}function g2(d,o,c){const f=c.pointOnLine(o,d).point;return c.distance(d,f)}function y2(d,o,c,f,m){const p=c.slice(f[0],f[1]+1);let v=1/0;for(let T=o[0];T<=o[1];++T)if((v=Math.min(v,g2(d[T],p,m)))===0)return 0;return v}function mv(d,o,c,f,m){const p=Math.min(m.pointToSegmentDistance(d,c,f),m.pointToSegmentDistance(o,c,f)),v=Math.min(m.pointToSegmentDistance(c,d,o),m.pointToSegmentDistance(f,d,o));return Math.min(p,v)}function dD(d,o,c,f,m){if(!Xc(o,d.length)||!Xc(f,c.length))return NaN;let p=1/0;for(let v=o[0];v<o[1];++v)for(let T=f[0];T<f[1];++T){if(dv(d[v],d[v+1],c[T],c[T+1]))return 0;p=Math.min(p,mv(d[v],d[v+1],c[T],c[T+1],m))}return p}function rh(d,o,c,f,m){if(!Xc(o,d.length)||!Xc(f,c.length))return NaN;let p=1/0;for(let v=o[0];v<=o[1];++v)for(let T=f[0];T<=f[1];++T)if((p=Math.min(p,m.distance(d[v],c[T])))===0)return p;return p}function hD(d,o,c){if(Qd(d,o,!0))return 0;let f=1/0;for(const m of o){const p=m.length;if(p<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[p-1]&&(f=Math.min(f,c.pointToSegmentDistance(d,m[p-1],m[0])))===0||(f=Math.min(f,g2(d,m,c)))===0)return f}return f}function fD(d,o,c,f){if(!Xc(o,d.length))return NaN;for(let p=o[0];p<=o[1];++p)if(Qd(d[p],c,!0))return 0;let m=1/0;for(let p=o[0];p<o[1];++p)for(const v of c)for(let T=0,M=v.length,k=M-1;T<M;k=T++){if(dv(d[p],d[p+1],v[k],v[T]))return 0;m=Math.min(m,mv(d[p],d[p+1],v[k],v[T],f))}return m}function gv(d,o){for(const c of d)for(let f=0;f<=c.length-1;++f)if(Qd(c[f],o,!0))return!0;return!1}function v2(d,o,c,f=1/0){const m=Pf(d),p=Pf(o);if(f!==1/0&&If(m,p,c)>=f)return f;if(Xm(m,p)){if(gv(d,o))return 0}else if(gv(o,d))return 0;let v=f;for(const T of d)for(let M=0,k=T.length,w=k-1;M<k;w=M++)for(const P of o)for(let D=0,O=P.length,R=O-1;D<O;R=D++){if(dv(T[w],T[M],P[R],P[D]))return 0;v=Math.min(v,mv(T[w],T[M],P[R],P[D],c))}return v}function Km(d,o,c,f,m,p,v){if(p===null||v===null)return;const T=If(Ju(f,p),Ju(m,v),c);T<o&&d.push({dist:T,range1:p,range2:v})}function Rl(d,o,c,f,m=1/0){let p=Math.min(f.distance(d[0],c[0][0]),m);if(p===0)return p;const v=new Ym([{dist:0,range1:[0,d.length-1],range2:[0,0]}],fv),T=o?ea:Zc,M=Pf(c);for(;v.length;){const k=v.pop();if(k.dist>=p)continue;const w=k.range1;if(pv(w)<=T){if(!Xc(w,d.length))return NaN;if(o){const P=fD(d,w,c,f);if((p=Math.min(p,P))===0)return p}else for(let P=w[0];P<=w[1];++P){const D=hD(d[P],c,f);if((p=Math.min(p,D))===0)return p}}else{const P=Mf(w,o);if(P[0]!==null){const D=If(Ju(d,P[0]),M,f);D<p&&v.push({dist:D,range1:P[0],range2:[0,0]})}if(P[1]!==null){const D=If(Ju(d,P[1]),M,f);D<p&&v.push({dist:D,range1:P[1],range2:[0,0]})}}}return p}function Ib(d,o,c,f,m,p=1/0){let v=Math.min(p,m.distance(d[0],c[0]));if(v===0)return v;const T=new Ym([{dist:0,range1:[0,d.length-1],range2:[0,c.length-1]}],fv),M=o?ea:Zc,k=f?ea:Zc;for(;T.length;){const w=T.pop();if(w.dist>=v)continue;const P=w.range1,D=w.range2;if(pv(P)<=M&&pv(D)<=k){if(!Xc(P,d.length)||!Xc(D,c.length))return NaN;if(o&&f?v=Math.min(v,dD(d,P,c,D,m)):o||f?o&&!f?v=Math.min(v,y2(c,D,d,P,m)):!o&&f&&(v=Math.min(v,y2(d,P,c,D,m))):v=Math.min(v,rh(d,P,c,D,m)),v===0)return v}else{const O=Mf(P,o),R=Mf(D,f);Km(T,v,m,d,c,O[0],R[0]),Km(T,v,m,d,c,O[0],R[1]),Km(T,v,m,d,c,O[1],R[0]),Km(T,v,m,d,c,O[1],R[1])}}return v}function yv(d,o,c,f,m=1/0){let p=m;const v=Ju(d,[0,d.length-1]);for(const T of c)if(!(p!==1/0&&If(v,Ju(T,[0,T.length-1]),f)>=p)&&(p=Math.min(p,Ib(d,o,T,!0,f,p)),p===0))return p;return p}function Jm(d,o,c,f,m=1/0){let p=m;const v=Ju(d,[0,d.length-1]);for(const T of c){if(p!==1/0&&If(v,Pf(T),f)>=p)continue;const M=Rl(d,o,T,f,p);if(isNaN(M))return M;if((p=Math.min(p,M))===0)return p}return p}function vv(d){return d==="Point"||d==="MultiPoint"||d==="LineString"||d==="MultiLineString"||d==="Polygon"||d==="MultiPolygon"}class Qu{constructor(o,c){this.type=cr,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(kl(o[1])){const f=o[1];if(f.type==="FeatureCollection"){for(let m=0;m<f.features.length;++m)if(vv(f.features[m].geometry.type))return new Qu(f,f.features[m].geometry)}else if(f.type==="Feature"){if(vv(f.geometry.type))return new Qu(f,f.geometry)}else if(vv(f.type))return new Qu(f,f)}return c.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const c=o.geometry(),f=o.canonicalID();if(c!=null&&f!=null){if(o.geometryType()==="Point")return function(m,p,v){const T=[];for(const k of m)for(const w of k)T.push(Pb(w,p));const M=new Af(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?Ib(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",M):v.type==="MultiLineString"?yv(T,!1,v.coordinates,M):v.type==="Polygon"||v.type==="MultiPolygon"?Jm(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,M):null}(c,f,this.geometries);if(o.geometryType()==="LineString")return function(m,p,v){const T=[];for(const k of m){const w=[];for(const P of k)w.push(Pb(P,p));T.push(w)}const M=new Af(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return yv(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,M);if(v.type==="MultiLineString"){let k=1/0;for(let w=0;w<v.coordinates.length;w++){const P=yv(v.coordinates[w],!0,T,M,k);if(isNaN(P))return P;if((k=Math.min(k,P))===0)return k}return k}if(v.type==="Polygon"||v.type==="MultiPolygon"){let k=1/0;for(let w=0;w<T.length;w++){const P=Jm(T[w],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,M,k);if(isNaN(P))return P;if((k=Math.min(k,P))===0)return k}return k}return null}(c,f,this.geometries);if(o.geometryType()==="Polygon")return function(m,p,v){const T=[];for(const k of function(w,P){const D=w.length;if(D<=1)return[w];const O=[];let R,N;for(let W=0;W<D;W++){const Z=iD(w[W]);Z!==0&&(w[W].area=Math.abs(Z),N===void 0&&(N=Z<0),N===Z<0?(R&&O.push(R),R=[w[W]]):R.push(w[W]))}return R&&O.push(R),O}(m)){const w=[];for(let P=0;P<k.length;++P)w.push(m2(k[P],p));T.push(w)}const M=new Af(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Jm(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,M);if(v.type==="MultiLineString"){let k=1/0;for(let w=0;w<v.coordinates.length;w++){const P=Jm(v.coordinates[w],!0,T,M,k);if(isNaN(P))return P;if((k=Math.min(k,P))===0)return k}return k}return v.type==="Polygon"||v.type==="MultiPolygon"?function(k,w,P){let D=1/0;for(const O of k)for(const R of w){const N=v2(O,R,P,D);if(isNaN(N))return N;if((D=Math.min(D,N))===0)return D}return D}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,M):null}(c,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function _v(d,o){switch(d){case"string":return No(o);case"number":return+o;case"boolean":return!!o;case"color":return On.parse(o);case"formatted":return ha.fromString(No(o));case"resolvedImage":return fa.build(No(o))}return o}function Ob(d,o,c,f){return f!==void 0&&(d=f*Math.round(d/f)),o!==void 0&&d<o&&(d=o),c!==void 0&&d>c&&(d=c),d}class nh{constructor(o,c,f){this.type=o,this.key=c,this.scope=f}static parse(o,c){let f=c.expectedType;if(f==null&&(f=_n),o.length<2||o.length>3)return c.error("Invalid number of arguments for 'config' expression.");const m=c.parse(o[1],1);if(!(m instanceof Wc))return c.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const p=c.parse(o[2],2);return p instanceof Wc?new nh(f,No(m.value),No(p.value)):c.error("Scope of 'config' expression must be a string literal.")}return new nh(f,No(m.value))}evaluate(o){const c=[this.key,this.scope,o.scope].filter(Boolean).join(""),f=o.getConfig(c);if(!f)return null;const{type:m,value:p,values:v,minValue:T,maxValue:M,stepValue:k}=f,w=f.default.evaluate(o);let P=w;if(p){const D=o.scope;o.scope=(D||"").split("").slice(1).join(""),P=p.evaluate(o),o.scope=D}return m&&(P=_v(m,P)),P===void 0||T===void 0&&M===void 0&&k===void 0||(typeof P=="number"?P=Ob(P,T,M,k):Array.isArray(P)&&(P=P.map(D=>typeof D=="number"?Ob(D,T,M,k):D))),p!==void 0&&P!==void 0&&v&&!v.includes(P)&&(P=w,m&&(P=_v(m,P))),(m&&m!==this.type||P!==void 0&&so(P)!==this.type)&&(P=_v(this.type.kind,P)),P}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function Of(d){if(d instanceof Ia&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Hc||d instanceof Qu)return!1;let o=!0;return d.eachChild(c=>{o&&!Of(c)&&(o=!1)}),o}function Qm(d){if(d instanceof Ia&&d.name==="feature-state")return!1;let o=!0;return d.eachChild(c=>{o&&!Qm(c)&&(o=!1)}),o}function eg(d){if(d instanceof nh)return new Set([d.key]);let o=new Set;return d.eachChild(c=>{o=new Set([...o,...eg(c)])}),o}function Yc(d,o){if(d instanceof Ia&&o.indexOf(d.name)>=0)return!1;let c=!0;return d.eachChild(f=>{c&&!Yc(f,o)&&(c=!1)}),c}class ih{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(o.length!==2||typeof o[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const f=o[1];return c.scope.has(f)?new ih(f,c.scope.get(f)):c.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class kf{constructor(o,c=[],f,m=new lv,p=[],v,T){this.registry=o,this.path=c,this.key=c.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=m,this.errors=p,this.expectedType=f,this._scope=v,this.options=T}parse(o,c,f,m,p={}){return c||f?this.concat(c,null,f,m)._parse(o,p):this._parse(o,p)}parseObjectValue(o,c,f,m,p,v={}){return this.concat(c,f,m,p)._parse(o,v)}_parse(o,c){function f(m,p,v){return v==="assert"?new ws(p,[m]):v==="coerce"?new qc(p,[m]):m}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(m){let p=m.parse(o,this);if(!p)return null;if(this.expectedType){const v=this.expectedType,T=p.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else p=f(p,v,c.typeAnnotation||"coerce");else p=f(p,v,c.typeAnnotation||"assert")}if(!(p instanceof Wc)&&p.type.kind!=="resolvedImage"&&xv(p)){const v=new uv(this._scope,this.options);try{p=new Wc(p.type,p.evaluate(v))}catch(T){return this.error(T.message),null}}return p}return qc.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,f,m){let p=typeof o=="number"?this.path.concat(o):this.path;p=typeof c=="string"?p.concat(c):p;const v=m?this.scope.concat(m):this.scope;return new kf(this.registry,p,f||null,v,this.errors,this._scope,this.options)}error(o,...c){const f=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Ys(f,o))}checkSubtype(o,c){const f=wf(o,c);return f&&this.error(f),f}}var kb=kf;function xv(d){if(d instanceof ih)return xv(d.boundExpression);if(d instanceof Ia&&d.name==="error"||d instanceof Jd||d instanceof Hc||d instanceof Qu||d instanceof nh)return!1;const o=d instanceof qc||d instanceof ws;let c=!0;return d.eachChild(f=>{c=o?c&&xv(f):c&&f instanceof Wc}),!!c&&Of(d)&&Yc(d,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function tg(d,o){const c=d.length-1;let f,m,p=0,v=c,T=0;for(;p<=v;)if(T=Math.floor((p+v)/2),f=d[T],m=d[T+1],f<=o){if(T===c||o<m)return T;p=T+1}else{if(!(f>o))throw new Vi("Input is not a number.");v=T-1}return 0}class uc{constructor(o,c,f){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[m,p]of f)this.labels.push(m),this.outputs.push(p)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const f=c.parse(o[1],1,cr);if(!f)return null;const m=[];let p=null;c.expectedType&&c.expectedType.kind!=="value"&&(p=c.expectedType);for(let v=1;v<o.length;v+=2){const T=v===1?-1/0:o[v],M=o[v+1],k=v,w=v+1;if(typeof T!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(m.length&&m[m.length-1][0]>=T)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const P=c.parse(M,w,p);if(!P)return null;p=p||P.type,m.push([T,P])}return new uc(p,f,m)}evaluate(o){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(o);const m=this.input.evaluate(o);if(m<=c[0])return f[0].evaluate(o);const p=c.length;return m>=c[p-1]?f[p-1].evaluate(o):f[tg(c,m)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&o.push(this.labels[c]),o.push(this.outputs[c].serialize());return o}}const an=.95047,_2=1.08883,x2=4/29,Rf=6/29,Rb=3*Rf*Rf,pD=Rf*Rf*Rf,di=Math.PI/180,mD=180/Math.PI;function Db(d){return d>pD?Math.pow(d,1/3):d/Rb+x2}function Lb(d){return d>Rf?d*d*d:Rb*(d-x2)}function Nb(d){return 255*(d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055)}function zb(d){return(d/=255)<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function b2(d){const o=zb(d.r),c=zb(d.g),f=zb(d.b),m=Db((.4124564*o+.3575761*c+.1804375*f)/an),p=Db((.2126729*o+.7151522*c+.072175*f)/1);return{l:116*p-16,a:500*(m-p),b:200*(p-Db((.0193339*o+.119192*c+.9503041*f)/_2)),alpha:d.a}}function w2(d){let o=(d.l+16)/116,c=isNaN(d.a)?o:o+d.a/500,f=isNaN(d.b)?o:o-d.b/200;return o=1*Lb(o),c=an*Lb(c),f=_2*Lb(f),new On(Nb(3.2404542*c-1.5371385*o-.4985314*f),Nb(-.969266*c+1.8760108*o+.041556*f),Nb(.0556434*c-.2040259*o+1.0572252*f),d.alpha)}function gD(d,o,c){const f=o-d;return d+c*(f>180||f<-180?f-360*Math.round(f/360):f)}const rg={forward:b2,reverse:w2,interpolate:function(d,o,c){return{l:br(d.l,o.l,c),a:br(d.a,o.a,c),b:br(d.b,o.b,c),alpha:br(d.alpha,o.alpha,c)}}},ng={forward:function(d){const{l:o,a:c,b:f}=b2(d),m=Math.atan2(f,c)*mD;return{h:m<0?m+360:m,c:Math.sqrt(c*c+f*f),l:o,alpha:d.a}},reverse:function(d){const o=d.h*di,c=d.c;return w2({l:d.l,a:Math.cos(o)*c,b:Math.sin(o)*c,alpha:d.alpha})},interpolate:function(d,o,c){return{h:gD(d.h,o.h,c),c:br(d.c,o.c,c),l:br(d.l,o.l,c),alpha:br(d.alpha,o.alpha,c)}}};var S2=Object.freeze({__proto__:null,hcl:ng,lab:rg});class Ss{constructor(o,c,f,m,p){this.type=o,this.operator=c,this.interpolation=f,this.input=m,this.labels=[],this.outputs=[];for(const[v,T]of p)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(o,c,f,m){let p=0;if(o.name==="exponential")p=jb(c,o.base,f,m);else if(o.name==="linear")p=jb(c,1,f,m);else if(o.name==="cubic-bezier"){const v=o.controlPoints;p=new Ot(v[0],v[1],v[2],v[3]).solve(jb(c,1,f,m))}return p}static parse(o,c){let[f,m,p,...v]=o;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const k=m[1];if(typeof k!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:k}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const k=m.slice(1);if(k.length!==4||k.some(w=>typeof w!="number"||w<0||w>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:k}}}if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(p=c.parse(p,2,cr),!p)return null;const T=[];let M=null;f==="interpolate-hcl"||f==="interpolate-lab"?M=da:c.expectedType&&c.expectedType.kind!=="value"&&(M=c.expectedType);for(let k=0;k<v.length;k+=2){const w=v[k],P=v[k+1],D=k+3,O=k+4;if(typeof w!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(T.length&&T[T.length-1][0]>=w)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const R=c.parse(P,O,M);if(!R)return null;M=M||R.type,T.push([w,R])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Ss(M,f,m,p,T):c.error(`Type ${Fi(M)} is not interpolatable.`)}evaluate(o){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(o);const m=this.input.evaluate(o);if(m<=c[0])return f[0].evaluate(o);const p=c.length;if(m>=c[p-1])return f[p-1].evaluate(o);const v=tg(c,m),T=Ss.interpolationFactor(this.interpolation,m,c[v],c[v+1]),M=f[v].evaluate(o),k=f[v+1].evaluate(o);return this.operator==="interpolate"?Vm[this.type.kind.toLowerCase()](M,k,T):this.operator==="interpolate-hcl"?ng.reverse(ng.interpolate(ng.forward(M),ng.forward(k),T)):rg.reverse(rg.interpolate(rg.forward(M),rg.forward(k),T))}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const c=[this.operator,o,this.input.serialize()];for(let f=0;f<this.labels.length;f++)c.push(this.labels[f],this.outputs[f].serialize());return c}}function jb(d,o,c,f){const m=f-c,p=d-c;return m===0?0:o===1?p/m:(Math.pow(o,p)-1)/(Math.pow(o,m)-1)}class bv{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let f=null;const m=c.expectedType;m&&m.kind!=="value"&&(f=m);const p=[];for(const T of o.slice(1)){const M=c.parse(T,1+p.length,f,void 0,{typeAnnotation:"omit"});if(!M)return null;f=f||M.type,p.push(M)}const v=m&&p.some(T=>wf(m,T.type));return new bv(v?_n:f,p)}evaluate(o){let c,f=null,m=0;for(const p of this.args){if(m++,f=p.evaluate(o),f&&f instanceof fa&&!f.available&&(c||(c=f),f=null,m===this.args.length))return c;if(f!==null)break}return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(c=>{o.push(c.serialize())}),o}}class wv{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let p=1;p<o.length-1;p+=2){const v=o[p];if(typeof v!="string")return c.error(`Expected string, but found ${typeof v} instead.`,p);if(/[^a-zA-Z0-9_]/.test(v))return c.error("Variable names must contain only alphanumeric characters or '_'.",p);const T=c.parse(o[p+1],p+1);if(!T)return null;f.push([v,T])}const m=c.parse(o[o.length-1],o.length-1,c.expectedType,f);return m?new wv(f,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[c,f]of this.bindings)o.push(c,f.serialize());return o.push(this.result.serialize()),o}}class Fb{constructor(o,c,f){this.type=o,this.index=c,this.input=f}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,cr),m=c.parse(o[2],2,Qo(c.expectedType||_n));return f&&m?new Fb(m.type.itemType,f,m):null}evaluate(o){const c=this.index.evaluate(o),f=this.input.evaluate(o);if(c<0)throw new Vi(`Array index out of bounds: ${c} < 0.`);if(c>=f.length)throw new Vi(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c!==Math.floor(c))throw new Vi(`Array index must be an integer, but found ${c} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return f[c]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Bb{constructor(o,c,f){this.type=o,this.index=c,this.input=f}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,cr),m=c.parse(o[2],2,Qo(c.expectedType||_n));return f&&m?new Bb(m.type.itemType,f,m):null}evaluate(o){const c=this.index.evaluate(o),f=this.input.evaluate(o);if(c<0)throw new Vi(`Array index out of bounds: ${c} < 0.`);if(c>f.length-1)throw new Vi(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c===Math.floor(c))return f[c];const m=Math.floor(c),p=Math.ceil(c),v=f[m],T=f[p];if(typeof v!="number"||typeof T!="number")throw new Vi(`Cannot interpolate between non-number values at index ${c}.`);const M=c-m;return v*(1-M)+T*M}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class $b{constructor(o,c){this.type=pn,this.needle=o,this.haystack=c}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,_n),m=c.parse(o[2],2,_n);return f&&m?Tb(f.type,[pn,Cn,cr,xf,_n])?new $b(f,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(f.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(f==null)return!1;if(!Sf(c,["boolean","string","number","null"]))throw new Vi(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(so(c))} instead.`);if(!Sf(f,["string","array"]))throw new Vi(`Expected second argument to be of type array or string, but found ${Fi(so(f))} instead.`);return f.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Sv{constructor(o,c,f){this.type=cr,this.needle=o,this.haystack=c,this.fromIndex=f}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,_n),m=c.parse(o[2],2,_n);if(!f||!m)return null;if(!Tb(f.type,[pn,Cn,cr,xf,_n]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(f.type)} instead`);if(o.length===4){const p=c.parse(o[3],3,cr);return p?new Sv(f,m,p):null}return new Sv(f,m)}evaluate(o){const c=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!Sf(c,["boolean","string","number","null"]))throw new Vi(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(so(c))} instead.`);if(!Sf(f,["string","array"]))throw new Vi(`Expected second argument to be of type array or string, but found ${Fi(so(f))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(o);return f.indexOf(c,m)}return f.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Ub{constructor(o,c,f,m,p,v){this.inputType=o,this.type=c,this.input=f,this.cases=m,this.outputs=p,this.otherwise=v}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let f,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const p={},v=[];for(let k=2;k<o.length-1;k+=2){let w=o[k];const P=o[k+1];Array.isArray(w)||(w=[w]);const D=c.concat(k);if(w.length===0)return D.error("Expected at least one branch label.");for(const R of w){if(typeof R!="number"&&typeof R!="string")return D.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return D.error("Numeric branch labels must be integer values.");if(f){if(D.checkSubtype(f,so(R)))return null}else f=so(R);if(p[String(R)]!==void 0)return D.error("Branch labels must be unique.");p[String(R)]=v.length}const O=c.parse(P,k,m);if(!O)return null;m=m||O.type,v.push(O)}const T=c.parse(o[1],1,_n);if(!T)return null;const M=c.parse(o[o.length-1],o.length-1,m);return M?T.type.kind!=="value"&&c.concat(1).checkSubtype(f,T.type)?null:new Ub(f,m,T,p,v,M):null}evaluate(o){const c=this.input.evaluate(o);return(so(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),f=[],m={};for(const v of c){const T=m[this.cases[v]];T===void 0?(m[this.cases[v]]=f.length,f.push([this.cases[v],[v]])):f[T][1].push(v)}const p=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of f)o.push(T.length===1?p(T[0]):T.map(p)),o.push(this.outputs[v].serialize());return o.push(this.otherwise.serialize()),o}}class Vb{constructor(o,c,f){this.type=o,this.branches=c,this.otherwise=f}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let f;c.expectedType&&c.expectedType.kind!=="value"&&(f=c.expectedType);const m=[];for(let v=1;v<o.length-1;v+=2){const T=c.parse(o[v],v,pn);if(!T)return null;const M=c.parse(o[v+1],v+1,f);if(!M)return null;m.push([T,M]),f=f||M.type}const p=c.parse(o[o.length-1],o.length-1,f);return p?new Vb(f,m,p):null}evaluate(o){for(const[c,f]of this.branches)if(c.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,f]of this.branches)o(c),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(c=>{o.push(c.serialize())}),o}}class Tv{constructor(o,c,f,m){this.type=o,this.input=c,this.beginIndex=f,this.endIndex=m}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,_n),m=c.parse(o[2],2,cr);if(!f||!m)return null;if(!Tb(f.type,[Qo(_n),Cn,_n]))return c.error(`Expected first argument to be of type array or string, but found ${Fi(f.type)} instead`);if(o.length===4){const p=c.parse(o[3],3,cr);return p?new Tv(f.type,f,m,p):null}return new Tv(f.type,f,m)}evaluate(o){const c=this.input.evaluate(o),f=this.beginIndex.evaluate(o);if(!Sf(c,["string","array"]))throw new Vi(`Expected first argument to be of type array or string, but found ${Fi(so(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(o);return c.slice(f,m)}return c.slice(f)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function T2(d,o){return d==="=="||d==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function E2(d,o,c,f){return f.compare(o,c)===0}function Df(d,o,c){const f=d!=="=="&&d!=="!=";return class Zae{constructor(p,v,T){this.type=pn,this.lhs=p,this.rhs=v,this.collator=T,this.hasUntypedArgument=p.type.kind==="value"||v.type.kind==="value"}static parse(p,v){if(p.length!==3&&p.length!==4)return v.error("Expected two or three arguments.");const T=p[0];let M=v.parse(p[1],1,_n);if(!M)return null;if(!T2(T,M.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${Fi(M.type)}'.`);let k=v.parse(p[2],2,_n);if(!k)return null;if(!T2(T,k.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${Fi(k.type)}'.`);if(M.type.kind!==k.type.kind&&M.type.kind!=="value"&&k.type.kind!=="value")return v.error(`Cannot compare types '${Fi(M.type)}' and '${Fi(k.type)}'.`);f&&(M.type.kind==="value"&&k.type.kind!=="value"?M=new ws(k.type,[M]):M.type.kind!=="value"&&k.type.kind==="value"&&(k=new ws(M.type,[k])));let w=null;if(p.length===4){if(M.type.kind!=="string"&&k.type.kind!=="string"&&M.type.kind!=="value"&&k.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(w=v.parse(p[3],3,Uc),!w)return null}return new Zae(M,k,w)}evaluate(p){const v=this.lhs.evaluate(p),T=this.rhs.evaluate(p);if(f&&this.hasUntypedArgument){const M=so(v),k=so(T);if(M.kind!==k.kind||M.kind!=="string"&&M.kind!=="number")throw new Vi(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${M.kind}, ${k.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const M=so(v),k=so(T);if(M.kind!=="string"||k.kind!=="string")return o(p,v,T)}return this.collator?c(p,v,T,this.collator.evaluate(p)):o(p,v,T)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[d];return this.eachChild(v=>{p.push(v.serialize())}),p}}}const yD=Df("==",function(d,o,c){return o===c},E2),vD=Df("!=",function(d,o,c){return o!==c},function(d,o,c,f){return!E2(0,o,c,f)}),_D=Df("<",function(d,o,c){return o<c},function(d,o,c,f){return f.compare(o,c)<0}),xD=Df(">",function(d,o,c){return o>c},function(d,o,c,f){return f.compare(o,c)>0}),bD=Df("<=",function(d,o,c){return o<=c},function(d,o,c,f){return f.compare(o,c)<=0}),wD=Df(">=",function(d,o,c){return o>=c},function(d,o,c,f){return f.compare(o,c)>=0});class ig{constructor(o,c,f,m,p,v){this.type=Cn,this.number=o,this.locale=c,this.currency=f,this.unit=m,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(o,c){if(o.length!==3)return c.error("Expected two arguments.");const f=c.parse(o[1],1,cr);if(!f)return null;const m=o[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let p=null;if(m.locale&&(p=c.parseObjectValue(m.locale,2,"locale",Cn),!p))return null;let v=null;if(m.currency&&(v=c.parseObjectValue(m.currency,2,"currency",Cn),!v))return null;let T=null;if(m.unit&&(T=c.parseObjectValue(m.unit,2,"unit",Cn),!T))return null;let M=null;if(m["min-fraction-digits"]&&(M=c.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",cr),!M))return null;let k=null;return m["max-fraction-digits"]&&(k=c.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",cr),!k)?null:new ig(f,p,v,T,M,k)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Wb{constructor(o){this.type=cr,this.input=o}static parse(o,c){if(o.length!==2)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=c.parse(o[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Fi(f.type)} instead.`):new Wb(f):null}evaluate(o){const c=this.input.evaluate(o);if(typeof c=="string"||Array.isArray(c))return c.length;throw new Vi(`Expected value to be of type string or array, but found ${Fi(so(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(c=>{o.push(c.serialize())}),o}}function Gb(d){return function(){d=1831565813+(d|=0)|0;let o=Math.imul(d^d>>>15,1|d);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const Lf={"==":yD,"!=":vD,">":xD,"<":_D,">=":wD,"<=":bD,array:ws,at:Fb,"at-interpolated":Bb,boolean:ws,case:Vb,coalesce:bv,collator:Jd,format:Tf,image:Xu,in:$b,"index-of":Sv,interpolate:Ss,"interpolate-hcl":Ss,"interpolate-lab":Ss,length:Wb,let:wv,literal:Wc,match:Ub,number:ws,"number-format":ig,object:ws,slice:Tv,step:uc,string:ws,"to-boolean":qc,"to-color":qc,"to-number":qc,"to-string":qc,var:ih,within:Hc,distance:Qu,config:nh};function A2(d,[o,c,f,m]){o=o.evaluate(d),c=c.evaluate(d),f=f.evaluate(d);const p=m?m.evaluate(d):1,v=qm(o,c,f,p);if(v)throw new Vi(v);return new On(o/255*p,c/255*p,f/255*p,p)}function C2(d,[o,c,f,m]){o=o.evaluate(d),c=c.evaluate(d),f=f.evaluate(d);const p=m?m.evaluate(d):1,v=function(k,w,P,D){return typeof k=="number"&&k>=0&&k<=360?typeof w=="number"&&w>=0&&w<=100&&typeof P=="number"&&P>=0&&P<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[k,w,P,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[k,w,P,D]:[k,w,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[k,w,P,D]:[k,w,P]).join(", ")}]: 'h' must be between 0 and 360.`}(o,c,f,p);if(v)throw new Vi(v);const T=`hsla(${o}, ${c}%, ${f}%, ${p})`,M=On.parse(T);if(!M)throw new Vi(`Failed to parse HSLA color: ${T}`);return M}function qb(d,o){return d in o}function Ev(d,o){const c=o[d];return c===void 0?null:c}function Ks(d){return{type:d}}function Hb(d){return{result:"success",value:d}}function Kc(d){return{result:"error",value:d}}function Zb(d,o){return!!d&&!!d.parameters&&d.parameters.indexOf(o)>-1}function Nf(d){return d["property-type"]==="data-driven"}function Av(d){return Zb(d.expression,"measure-light")}function M2(d){return Zb(d.expression,"zoom")}function Xb(d){return!!d.expression&&d.expression.interpolated}function Cv(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}function P2(d){return d}function I2(d,o){const c=o.type==="color",f=d.stops&&typeof d.stops[0][0]=="object",m=f||!(f||d.property!==void 0),p=d.type||(Xb(o)?"exponential":"interval");if(c&&((d=vn({},d)).stops&&(d.stops=d.stops.map(k=>[k[0],On.parse(k[1])])),d.default=On.parse(d.default?d.default:o.default)),d.colorSpace&&d.colorSpace!=="rgb"&&!S2[d.colorSpace])throw new Error(`Unknown color space: ${d.colorSpace}`);let v,T,M;if(p==="exponential")v=Yb;else if(p==="interval")v=O2;else if(p==="categorical"){v=SD,T=Object.create(null);for(const k of d.stops)T[k[0]]=k[1];M=typeof d.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);v=Mv}if(f){const k={},w=[];for(let O=0;O<d.stops.length;O++){const R=d.stops[O],N=R[0].zoom;k[N]===void 0&&(k[N]={zoom:N,type:d.type,property:d.property,default:d.default,stops:[]},w.push(N)),k[N].stops.push([R[0].value,R[1]])}const P=[];for(const O of w)P.push([k[O].zoom,I2(k[O],o)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:Ss.interpolationFactor.bind(void 0,D),zoomStops:P.map(O=>O[0]),evaluate:({zoom:O},R)=>Yb({stops:P,base:d.base},o,O).evaluate(O,R)}}if(m){const k=p==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Ss.interpolationFactor.bind(void 0,k),zoomStops:d.stops.map(w=>w[0]),evaluate:({zoom:w})=>v(d,o,w,T,M)}}return{kind:"source",evaluate(k,w){const P=w&&w.properties?w.properties[d.property]:void 0;return P===void 0?og(d.default,o.default):v(d,o,P,T,M)}}}function og(d,o,c){return d!==void 0?d:o!==void 0?o:c!==void 0?c:void 0}function SD(d,o,c,f,m){return og(typeof c===m?f[c]:void 0,d.default,o.default)}function O2(d,o,c){if(Gc(c)!=="number")return og(d.default,o.default);const f=d.stops.length;if(f===1||c<=d.stops[0][0])return d.stops[0][1];if(c>=d.stops[f-1][0])return d.stops[f-1][1];const m=tg(d.stops.map(p=>p[0]),c);return d.stops[m][1]}function Yb(d,o,c){const f=d.base!==void 0?d.base:1;if(Gc(c)!=="number")return og(d.default,o.default);const m=d.stops.length;if(m===1||c<=d.stops[0][0])return d.stops[0][1];if(c>=d.stops[m-1][0])return d.stops[m-1][1];const p=tg(d.stops.map(w=>w[0]),c),v=function(w,P,D,O){const R=O-D,N=w-D;return R===0?0:P===1?N/R:(Math.pow(P,N)-1)/(Math.pow(P,R)-1)}(c,f,d.stops[p][0],d.stops[p+1][0]),T=d.stops[p][1],M=d.stops[p+1][1];let k=Vm[o.type]||P2;if(d.colorSpace&&d.colorSpace!=="rgb"){const w=S2[d.colorSpace];k=(P,D)=>w.reverse(w.interpolate(w.forward(P),w.forward(D),v))}return typeof T.evaluate=="function"?{evaluate(...w){const P=T.evaluate.apply(void 0,w),D=M.evaluate.apply(void 0,w);if(P!==void 0&&D!==void 0)return k(P,D,v)}}:k(T,M,v)}function Mv(d,o,c){return o.type==="color"?c=On.parse(c):o.type==="formatted"?c=ha.fromString(c.toString()):o.type==="resolvedImage"?c=fa.build(c.toString()):Gc(c)===o.type||o.type==="enum"&&o.values[c]||(c=void 0),og(c,d.default,o.default)}Ia.register(Lf,{error:[{kind:"error"},[Cn],(d,[o])=>{throw new Vi(o.evaluate(d))}],typeof:[Cn,[_n],(d,[o])=>Fi(so(o.evaluate(d)))],"to-rgba":[Qo(cr,4),[da],(d,[o])=>o.evaluate(d).toRenderColor(null).toArray()],"to-hsla":[Qo(cr,4),[da],(d,[o])=>o.evaluate(d).toRenderColor(null).toHslaArray()],rgb:[da,[cr,cr,cr],A2],rgba:[da,[cr,cr,cr,cr],A2],hsl:[da,[cr,cr,cr],C2],hsla:[da,[cr,cr,cr,cr],C2],has:{type:pn,overloads:[[[Cn],(d,[o])=>qb(o.evaluate(d),d.properties())],[[Cn,bf],(d,[o,c])=>qb(o.evaluate(d),c.evaluate(d))]]},get:{type:_n,overloads:[[[Cn],(d,[o])=>Ev(o.evaluate(d),d.properties())],[[Cn,bf],(d,[o,c])=>Ev(o.evaluate(d),c.evaluate(d))]]},"feature-state":[_n,[Cn],(d,[o])=>Ev(o.evaluate(d),d.featureState||{})],properties:[bf,[],d=>d.properties()],"geometry-type":[Cn,[],d=>d.geometryType()],id:[_n,[],d=>d.id()],zoom:[cr,[],d=>d.globals.zoom],pitch:[cr,[],d=>d.globals.pitch||0],"distance-from-center":[cr,[],d=>d.distanceFromCenter()],"measure-light":[cr,[Cn],(d,[o])=>d.measureLight(o.evaluate(d))],"heatmap-density":[cr,[],d=>d.globals.heatmapDensity||0],"line-progress":[cr,[],d=>d.globals.lineProgress||0],"raster-value":[cr,[],d=>d.globals.rasterValue||0],"raster-particle-speed":[cr,[],d=>d.globals.rasterParticleSpeed||0],"sky-radial-progress":[cr,[],d=>d.globals.skyRadialProgress||0],accumulated:[_n,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[cr,Ks(cr),(d,o)=>{let c=0;for(const f of o)c+=f.evaluate(d);return c}],"*":[cr,Ks(cr),(d,o)=>{let c=1;for(const f of o)c*=f.evaluate(d);return c}],"-":{type:cr,overloads:[[[cr,cr],(d,[o,c])=>o.evaluate(d)-c.evaluate(d)],[[cr],(d,[o])=>-o.evaluate(d)]]},"/":[cr,[cr,cr],(d,[o,c])=>o.evaluate(d)/c.evaluate(d)],"%":[cr,[cr,cr],(d,[o,c])=>o.evaluate(d)%c.evaluate(d)],ln2:[cr,[],()=>Math.LN2],pi:[cr,[],()=>Math.PI],e:[cr,[],()=>Math.E],"^":[cr,[cr,cr],(d,[o,c])=>Math.pow(o.evaluate(d),c.evaluate(d))],sqrt:[cr,[cr],(d,[o])=>Math.sqrt(o.evaluate(d))],log10:[cr,[cr],(d,[o])=>Math.log(o.evaluate(d))/Math.LN10],ln:[cr,[cr],(d,[o])=>Math.log(o.evaluate(d))],log2:[cr,[cr],(d,[o])=>Math.log(o.evaluate(d))/Math.LN2],sin:[cr,[cr],(d,[o])=>Math.sin(o.evaluate(d))],cos:[cr,[cr],(d,[o])=>Math.cos(o.evaluate(d))],tan:[cr,[cr],(d,[o])=>Math.tan(o.evaluate(d))],asin:[cr,[cr],(d,[o])=>Math.asin(o.evaluate(d))],acos:[cr,[cr],(d,[o])=>Math.acos(o.evaluate(d))],atan:[cr,[cr],(d,[o])=>Math.atan(o.evaluate(d))],min:[cr,Ks(cr),(d,o)=>Math.min(...o.map(c=>c.evaluate(d)))],max:[cr,Ks(cr),(d,o)=>Math.max(...o.map(c=>c.evaluate(d)))],abs:[cr,[cr],(d,[o])=>Math.abs(o.evaluate(d))],round:[cr,[cr],(d,[o])=>{const c=o.evaluate(d);return c<0?-Math.round(-c):Math.round(c)}],floor:[cr,[cr],(d,[o])=>Math.floor(o.evaluate(d))],ceil:[cr,[cr],(d,[o])=>Math.ceil(o.evaluate(d))],"filter-==":[pn,[Cn,_n],(d,[o,c])=>d.properties()[o.value]===c.value],"filter-id-==":[pn,[_n],(d,[o])=>d.id()===o.value],"filter-type-==":[pn,[Cn],(d,[o])=>d.geometryType()===o.value],"filter-<":[pn,[Cn,_n],(d,[o,c])=>{const f=d.properties()[o.value],m=c.value;return typeof f==typeof m&&f<m}],"filter-id-<":[pn,[_n],(d,[o])=>{const c=d.id(),f=o.value;return typeof c==typeof f&&c<f}],"filter->":[pn,[Cn,_n],(d,[o,c])=>{const f=d.properties()[o.value],m=c.value;return typeof f==typeof m&&f>m}],"filter-id->":[pn,[_n],(d,[o])=>{const c=d.id(),f=o.value;return typeof c==typeof f&&c>f}],"filter-<=":[pn,[Cn,_n],(d,[o,c])=>{const f=d.properties()[o.value],m=c.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[pn,[_n],(d,[o])=>{const c=d.id(),f=o.value;return typeof c==typeof f&&c<=f}],"filter->=":[pn,[Cn,_n],(d,[o,c])=>{const f=d.properties()[o.value],m=c.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[pn,[_n],(d,[o])=>{const c=d.id(),f=o.value;return typeof c==typeof f&&c>=f}],"filter-has":[pn,[_n],(d,[o])=>o.value in d.properties()],"filter-has-id":[pn,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[pn,[Qo(Cn)],(d,[o])=>o.value.indexOf(d.geometryType())>=0],"filter-id-in":[pn,[Qo(_n)],(d,[o])=>o.value.indexOf(d.id())>=0],"filter-in-small":[pn,[Cn,Qo(_n)],(d,[o,c])=>c.value.indexOf(d.properties()[o.value])>=0],"filter-in-large":[pn,[Cn,Qo(_n)],(d,[o,c])=>function(f,m,p,v){for(;p<=v;){const T=p+v>>1;if(m[T]===f)return!0;m[T]>f?v=T-1:p=T+1}return!1}(d.properties()[o.value],c.value,0,c.value.length-1)],all:{type:pn,overloads:[[[pn,pn],(d,[o,c])=>o.evaluate(d)&&c.evaluate(d)],[Ks(pn),(d,o)=>{for(const c of o)if(!c.evaluate(d))return!1;return!0}]]},any:{type:pn,overloads:[[[pn,pn],(d,[o,c])=>o.evaluate(d)||c.evaluate(d)],[Ks(pn),(d,o)=>{for(const c of o)if(c.evaluate(d))return!0;return!1}]]},"!":[pn,[pn],(d,[o])=>!o.evaluate(d)],"is-supported-script":[pn,[Cn],(d,[o])=>{const c=d.globals&&d.globals.isSupportedScript;return!c||c(o.evaluate(d))}],upcase:[Cn,[Cn],(d,[o])=>o.evaluate(d).toUpperCase()],downcase:[Cn,[Cn],(d,[o])=>o.evaluate(d).toLowerCase()],concat:[Cn,Ks(_n),(d,o)=>o.map(c=>No(c.evaluate(d))).join("")],"resolved-locale":[Cn,[Uc],(d,[o])=>o.evaluate(d).resolvedLocale()],random:[cr,[cr,cr,_n],(d,o)=>{const[c,f,m]=o.map(v=>v.evaluate(d));if(c>f||c===f)return c;let p;if(typeof m=="string")p=function(v){let T=0;if(v.length===0)return T;for(let M=0;M<v.length;M++)T=(T<<5)-T+v.charCodeAt(M),T|=0;return T}(m);else{if(typeof m!="number")throw new Vi(`Invalid seed input: ${m}`);p=m}return c+Gb(p)()*(f-c)}]});class Kb{constructor(o,c,f,m){this.expression=o,this._warningHistory={},this._evaluator=new uv(f,m),this._defaultValue=c?function(p){return p.type==="color"&&(Cv(p.default)||Array.isArray(p.default))?new On(0,0,0,0):p.type==="color"?On.parse(p.default)||null:p.default===void 0?null:p.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this.configDependencies=eg(o)}evaluateWithoutErrorHandling(o,c,f,m,p,v,T,M){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=f,this._evaluator.canonical=m||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(o,c,f,m,p,v,T,M){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=f||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=M||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Vi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${k.message}`)),this._defaultValue}}}function Pv(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in Lf}function zf(d,o,c,f){const m=new kb(Lf,[],o?function(v){const T={color:da,string:Cn,number:cr,enum:Cn,boolean:pn,formatted:Wm,resolvedImage:Vc};return v.type==="array"?Qo(T[v.value]||_n,v.length):T[v.type]}(o):void 0,void 0,void 0,c,f),p=m.parse(d,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Hb(new Kb(p,o,c,f)):Kc(m.errors)}class Jb{constructor(o,c,f,m){this.kind=o,this._styleExpression=c,this.isLightConstant=f,this.isLineProgressConstant=m,this.isStateDependent=o!=="constant"&&!Qm(c.expression),this.configDependencies=eg(c.expression)}evaluateWithoutErrorHandling(o,c,f,m,p,v){return this._styleExpression.evaluateWithoutErrorHandling(o,c,f,m,p,v)}evaluate(o,c,f,m,p,v){return this._styleExpression.evaluate(o,c,f,m,p,v)}}class jf{constructor(o,c,f,m,p,v){this.kind=o,this.zoomStops=f,this._styleExpression=c,this.isStateDependent=o!=="camera"&&!Qm(c.expression),this.isLightConstant=p,this.isLineProgressConstant=v,this.configDependencies=eg(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(o,c,f,m,p,v){return this._styleExpression.evaluateWithoutErrorHandling(o,c,f,m,p,v)}evaluate(o,c,f,m,p,v){return this._styleExpression.evaluate(o,c,f,m,p,v)}interpolationFactor(o,c,f){return this.interpolationType?Ss.interpolationFactor(this.interpolationType,o,c,f):0}}function Qb(d,o,c,f){if((d=zf(d,o,c,f)).result==="error")return d;const m=d.value.expression,p=Of(m);if(!p&&!Nf(o))return Kc([new Ys("","data expressions not supported")]);const v=Yc(m,["zoom","pitch","distance-from-center"]);if(!v&&!M2(o))return Kc([new Ys("","zoom expressions not supported")]);const T=Yc(m,["measure-light"]);if(!T&&!Av(o))return Kc([new Ys("","measure-light expression not supported")]);const M=Yc(m,["line-progress"]);if(!M&&!function(P){return Zb(P.expression,"line-progress")}(o))return Kc([new Ys("","line-progress expression not supported")]);const k=o.expression&&o.expression.relaxZoomRestriction,w=Ov(m);return w||v||k?w instanceof Ys?Kc([w]):w instanceof Ss&&!Xb(o)?Kc([new Ys("",'"interpolate" expressions cannot be used with this property')]):Hb(w?new jf(p&&M?"camera":"composite",d.value,w.labels,w instanceof Ss?w.interpolation:void 0,T,M):new Jb(p&&M?"constant":"source",d.value,T,M)):Kc([new Ys("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Iv{constructor(o,c){this._parameters=o,this._specification=c,vn(this,I2(this._parameters,this._specification))}static deserialize(o){return new Iv(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Ov(d){let o=null;if(d instanceof wv)o=Ov(d.result);else if(d instanceof bv){for(const c of d.args)if(o=Ov(c),o)break}else(d instanceof uc||d instanceof Ss)&&d.input instanceof Ia&&d.input.name==="zoom"&&(o=d);return o instanceof Ys||d.eachChild(c=>{const f=Ov(c);f instanceof Ys?o=f:o&&f&&o!==f&&(o=new Ys("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var ag,k2,R2=function(){if(k2)return ag;k2=1,ag=o;var d=3;function o(c,f,m){var p=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var v=new Int32Array(this.arrayBuffer);c=v[0],this.d=(f=v[1])+2*(m=v[2]);for(var T=0;T<this.d*this.d;T++){var M=v[d+T],k=v[d+T+1];p.push(M===k?null:v.subarray(M,k))}var w=v[d+p.length+1];this.keys=v.subarray(v[d+p.length],w),this.bboxes=v.subarray(w),this.insert=this._insertReadonly}else{this.d=f+2*m;for(var P=0;P<this.d*this.d;P++)p.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=c,this.padding=m,this.scale=f/c,this.uid=0;var D=m/f*c;this.min=-D,this.max=c+D}return o.prototype.insert=function(c,f,m,p,v){this._forEachCell(f,m,p,v,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(p),this.bboxes.push(v)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(c,f,m,p,v,T){this.cells[v].push(T)},o.prototype.query=function(c,f,m,p,v){var T=this.min,M=this.max;if(c<=T&&f<=T&&M<=m&&M<=p&&!v)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(c,f,m,p,this._queryCell,k,{},v),k},o.prototype._queryCell=function(c,f,m,p,v,T,M,k){var w=this.cells[v];if(w!==null)for(var P=this.keys,D=this.bboxes,O=0;O<w.length;O++){var R=w[O];if(M[R]===void 0){var N=4*R;(k?k(D[N+0],D[N+1],D[N+2],D[N+3]):c<=D[N+2]&&f<=D[N+3]&&m>=D[N+0]&&p>=D[N+1])?(M[R]=!0,T.push(P[R])):M[R]=!1}}},o.prototype._forEachCell=function(c,f,m,p,v,T,M,k){for(var w=this._convertToCellCoord(c),P=this._convertToCellCoord(f),D=this._convertToCellCoord(m),O=this._convertToCellCoord(p),R=w;R<=D;R++)for(var N=P;N<=O;N++){var W=this.d*N+R;if((!k||k(this._convertFromCellCoord(R),this._convertFromCellCoord(N),this._convertFromCellCoord(R+1),this._convertFromCellCoord(N+1)))&&v.call(this,c,f,m,p,W,T,M,k))return}},o.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},o.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,f=d+this.cells.length+1+1,m=0,p=0;p<this.cells.length;p++)m+=this.cells[p].length;var v=new Int32Array(f+m+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=f,M=0;M<c.length;M++){var k=c[M];v[d+M]=T,v.set(k,T),T+=k.length}return v[d+c.length]=T,v.set(this.keys,T),v[d+c.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},ag}(),Ff=_(R2);const kv={};function Qt(d,o,c={}){Object.defineProperty(d,"_classRegistryKey",{value:o,writable:!1}),kv[o]={klass:d,omit:c.omit||[]}}Qt(Object,"Object"),Ff.serialize=function(d,o){const c=d.toArrayBuffer();return o&&o.add(c),{buffer:c}},Ff.deserialize=function(d){return new Ff(d.buffer)},Object.defineProperty(Ff,"name",{value:"Grid"}),Qt(Ff,"Grid"),typeof DOMMatrix<"u"&&Qt(DOMMatrix,"DOMMatrix"),Qt(On,"Color"),Qt(Error,"Error"),Qt(ha,"Formatted"),Qt(Gm,"FormattedSection"),Qt(Go,"AJAXError"),Qt(fa,"ResolvedImage"),Qt(Iv,"StylePropertyFunction"),Qt(Kb,"StyleExpression",{omit:["_evaluator"]}),Qt($a,"ImageId"),Qt(cc,"ImageVariant"),Qt(jf,"ZoomDependentExpression"),Qt(Jb,"ZoomConstantExpression"),Qt(Ia,"CompoundExpression",{omit:["_evaluate"]});for(const d in Lf)kv[Lf[d]._classRegistryKey]||Qt(Lf[d],`Expression${d}`);function e1(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function t1(d){return self.ImageBitmap&&d instanceof ImageBitmap}function ed(d,o){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(e1(d)||t1(d))return o&&o.add(d),d;if(ArrayBuffer.isView(d))return o&&o.add(d.buffer),d;if(d instanceof ImageData)return o&&o.add(d.data.buffer),d;if(Array.isArray(d)){const c=[];for(const f of d)c.push(ed(f,o));return c}if(d instanceof Map){const c={$name:"Map",entries:[]};for(const[f,m]of d.entries())c.entries.push(ed(f),ed(m));return c}if(d instanceof Set){const c={$name:"Set"};let f=0;for(const m of d.values())c[++f]=ed(m);return c}if(d instanceof DOMMatrix){const c={$name:"DOMMatrix"},f=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const m of f)c[m]=d[m];return c}if(typeof d=="bigint")return{$name:"BigInt",value:d.toString()};if(typeof d=="object"){const c=d.constructor,f=c._classRegistryKey;if(!f)throw new Error(`Can't serialize object of unregistered class "${c.name}".`);const m=c.serialize?c.serialize(d,o):{};if(!c.serialize){for(const p in d)d.hasOwnProperty(p)&&(kv[f].omit.indexOf(p)>=0||(m[p]=ed(d[p],o)));d instanceof Error&&(m.message=d.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(m.$name=f),m}throw new Error("can't serialize object of type "+typeof d)}function Ts(d){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||e1(d)||t1(d)||ArrayBuffer.isView(d)||d instanceof ImageData)return d;if(Array.isArray(d))return d.map(Ts);if(typeof d=="object"){const o=d.$name||"Object";if(o==="Map"){const m=d.entries||[],p=new Map;for(let v=0;v<m.length;v+=2)p.set(Ts(m[v]),Ts(m[v+1]));return p}if(o==="Set"){const m=new Set;for(const p of Object.keys(d))p!=="$name"&&m.add(Ts(d[p]));return m}if(o==="DOMMatrix"){let m;return m=d.is2D?[d.a,d.b,d.c,d.d,d.e,d.f]:[d.m11,d.m12,d.m13,d.m14,d.m21,d.m22,d.m23,d.m24,d.m31,d.m32,d.m33,d.m34,d.m41,d.m42,d.m43,d.m44],new DOMMatrix(m)}if(o==="BigInt")return BigInt(d.value);const{klass:c}=kv[o];if(!c)throw new Error(`Can't deserialize unregistered class "${o}".`);if(c.deserialize)return c.deserialize(d);const f=Object.create(c.prototype);for(const m of Object.keys(d))m!=="$name"&&(f[m]=Ts(d[m]));return f}throw new Error("can't deserialize object of type "+typeof d)}const vr={"Latin-1 Supplement":d=>d>=128&&d<=255,Arabic:d=>d>=1536&&d<=1791,"Arabic Supplement":d=>d>=1872&&d<=1919,"Arabic Extended-A":d=>d>=2208&&d<=2303,"Hangul Jamo":d=>d>=4352&&d<=4607,"Unified Canadian Aboriginal Syllabics":d=>d>=5120&&d<=5759,Khmer:d=>d>=6016&&d<=6143,"Unified Canadian Aboriginal Syllabics Extended":d=>d>=6320&&d<=6399,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"CJK Radicals Supplement":d=>d>=11904&&d<=12031,"Kangxi Radicals":d=>d>=12032&&d<=12255,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Bopomofo:d=>d>=12544&&d<=12591,"Hangul Compatibility Jamo":d=>d>=12592&&d<=12687,Kanbun:d=>d>=12688&&d<=12703,"Bopomofo Extended":d=>d>=12704&&d<=12735,"CJK Strokes":d=>d>=12736&&d<=12783,"Katakana Phonetic Extensions":d=>d>=12784&&d<=12799,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"CJK Unified Ideographs Extension A":d=>d>=13312&&d<=19903,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Yi Syllables":d=>d>=40960&&d<=42127,"Yi Radicals":d=>d>=42128&&d<=42191,"Hangul Jamo Extended-A":d=>d>=43360&&d<=43391,"Hangul Syllables":d=>d>=44032&&d<=55215,"Hangul Jamo Extended-B":d=>d>=55216&&d<=55295,"Private Use Area":d=>d>=57344&&d<=63743,"CJK Compatibility Ideographs":d=>d>=63744&&d<=64255,"Arabic Presentation Forms-A":d=>d>=64336&&d<=65023,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Arabic Presentation Forms-B":d=>d>=65136&&d<=65279,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519,Osage:d=>d>=66736&&d<=66815,"CJK Unified Ideographs Extension B":d=>d>=131072&&d<=173791};function r1(d){for(const o of d)if(Rv(o.charCodeAt(0)))return!0;return!1}function TD(d){for(const o of d)if(!D2(o.charCodeAt(0)))return!1;return!0}function D2(d){return!(vr.Arabic(d)||vr["Arabic Supplement"](d)||vr["Arabic Extended-A"](d)||vr["Arabic Presentation Forms-A"](d)||vr["Arabic Presentation Forms-B"](d))}function Rv(d){return!(d!==746&&d!==747&&(d<4352||!(vr["Bopomofo Extended"](d)||vr.Bopomofo(d)||vr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||vr["CJK Compatibility Ideographs"](d)||vr["CJK Compatibility"](d)||vr["CJK Radicals Supplement"](d)||vr["CJK Strokes"](d)||!(!vr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||vr["CJK Unified Ideographs Extension A"](d)||vr["CJK Unified Ideographs"](d)||vr["Enclosed CJK Letters and Months"](d)||vr["Hangul Compatibility Jamo"](d)||vr["Hangul Jamo Extended-A"](d)||vr["Hangul Jamo Extended-B"](d)||vr["Hangul Jamo"](d)||vr["Hangul Syllables"](d)||vr.Hiragana(d)||vr["Ideographic Description Characters"](d)||vr.Kanbun(d)||vr["Kangxi Radicals"](d)||vr["Katakana Phonetic Extensions"](d)||vr.Katakana(d)&&d!==12540||!(!vr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!vr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||vr["Unified Canadian Aboriginal Syllabics"](d)||vr["Unified Canadian Aboriginal Syllabics Extended"](d)||vr["Vertical Forms"](d)||vr["Yijing Hexagram Symbols"](d)||vr["Yi Syllables"](d)||vr["Yi Radicals"](d))))}function n1(d){return!(Rv(d)||function(o){return!!(vr["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||vr["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||vr["Letterlike Symbols"](o)||vr["Number Forms"](o)||vr["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||vr["Control Pictures"](o)&&o!==9251||vr["Optical Character Recognition"](o)||vr["Enclosed Alphanumerics"](o)||vr["Geometric Shapes"](o)||vr["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||vr["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||vr["CJK Symbols and Punctuation"](o)||vr.Katakana(o)||vr["Private Use Area"](o)||vr["CJK Compatibility Forms"](o)||vr["Small Form Variants"](o)||vr["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(d))}function L2(d){return vr.Arabic(d)||vr["Arabic Supplement"](d)||vr["Arabic Extended-A"](d)||vr["Arabic Presentation Forms-A"](d)||vr["Arabic Presentation Forms-B"](d)}function Dv(d){return d>=1424&&d<=2303||vr["Arabic Presentation Forms-A"](d)||vr["Arabic Presentation Forms-B"](d)}function i1(d,o){return!(!o&&Dv(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||vr.Khmer(d))}function N2(d){for(const o of d)if(Dv(o.charCodeAt(0)))return!0;return!1}const o1="deferred",dc="loading",a1="loaded";let s1=null,Ua="unavailable",td=null;const sg=function(d){d&&typeof d=="string"&&d.indexOf("NetworkError")>-1&&(Ua="error"),s1&&s1(d)};function Lv(){Bf.fire(new Ka("pluginStateChange",{pluginStatus:Ua,pluginURL:td}))}const Bf=new Il,Nv=function(){return Ua},z2=function(){if(Ua!==o1||!td)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ua=dc,Lv(),td&&$c({url:td},d=>{d?sg(d):(Ua=a1,Lv())})},Js={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ua===a1||Js.applyArabicShaping!=null,isLoading:()=>Ua===dc,setState(d){Ua=d.pluginStatus,td=d.pluginURL},isParsed:()=>Js.applyArabicShaping!=null&&Js.processBidirectionalText!=null&&Js.processStyledBidirectionalText!=null,getPluginURL:()=>td};class Hn{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch,this.brightness=c.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(c,f){for(const m of c)if(!i1(m.charCodeAt(0),f))return!1;return!0}(o,Js.isLoaded())}}class $f{constructor(o,c,f,m){this.property=o,this.value=c,this.expression=function(p,v,T,M){if(Cv(p))return new Iv(p,v);if(Pv(p)||Array.isArray(p)&&p.length>0){const k=Qb(p,v,T,M);if(k.result==="error")throw new Error(k.value.map(w=>`${w.key}: ${w.message}`).join(", "));return k.value}{let k=p;return typeof p=="string"&&v.type==="color"&&(k=On.parse(p)),{kind:"constant",configDependencies:new Set,evaluate:()=>k}}}(c===void 0?o.specification.default:c,o.specification,f,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,c,f){return this.property.possiblyEvaluate(this,o,c,f)}}class l1{constructor(o,c,f){this.property=o,this.value=new $f(o,void 0,c,f)}transitioned(o,c){return new zv(this.property,this.value,c,Ti({},o.transition,this.transition),o.now)}untransitioned(){return new zv(this.property,this.value,null,{},0)}}class c1{constructor(o,c,f){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=c,this._options=f,this.configDependencies=new Set}getValue(o){return go(this._values[o].value.value)}setValue(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new l1(this._values[o].property,this._scope,this._options)),this._values[o].value=new $f(this._values[o].property,c===null?void 0:go(c),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,c){c&&(this._options=c);const f=this._properties.properties;if(o)for(const m in o){const p=o[m];if(m.endsWith("-transition")){const v=m.slice(0,-11);f[v]&&this.setTransition(v,p)}else f.hasOwnProperty(m)&&this.setValue(m,p)}}getTransition(o){return go(this._values[o].transition)}setTransition(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new l1(this._values[o].property)),this._values[o].transition=go(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(o[c]=f);const m=this.getTransition(c);m!==void 0&&(o[`${c}-transition`]=m)}return o}transitioned(o,c){const f=new lg(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].transitioned(o,c._values[m]);return f}untransitioned(){const o=new lg(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class zv{constructor(o,c,f,m,p){const v=m.delay||0,T=m.duration||0;p=p||0,this.property=o,this.value=c,this.begin=p+v,this.end=this.begin+T,o.specification.transition&&(m.delay||m.duration)&&(this.prior=f)}possiblyEvaluate(o,c,f){const m=o.now||0,p=this.value.possiblyEvaluate(o,c,f),v=this.prior;if(v){if(m>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(m<this.begin)return v.possiblyEvaluate(o,c,f);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(o,c,f),p,fr(T))}}return p}}class lg{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,f){const m=new Wf(this._properties);for(const p of Object.keys(this._values))m._values[p]=this._values[p].possiblyEvaluate(o,c,f);return m}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Uf{constructor(o,c,f){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=c,this._options=f,this.configDependencies=new Set}getValue(o){return go(this._values[o].value)}setValue(o,c){this._values[o]=new $f(this._values[o].property,c===null?void 0:go(c),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(o[c]=f)}return o}possiblyEvaluate(o,c,f){const m=new Wf(this._properties);for(const p of Object.keys(this._values))m._values[p]=this._values[p].possiblyEvaluate(o,c,f);return m}}class Vf{constructor(o,c,f){this.property=o,this.value=c,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,c,f,m){return this.property.evaluate(this.value,this.parameters,o,c,f,m)}}class Wf{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class jt{constructor(o){this.specification=o}possiblyEvaluate(o,c){return o.expression.evaluate(c)}interpolate(o,c,f){const m=Vm[this.specification.type];return m?m(o,c,f):o}}class Jt{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,f,m){return new Vf(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(c,null,{},f,m)}:o.expression,c)}interpolate(o,c,f){if(o.value.kind!=="constant"||c.value.kind!=="constant")return o;if(o.value.value===void 0||c.value.value===void 0)return new Vf(this,{kind:"constant",value:void 0},o.parameters);const m=Vm[this.specification.type];return m?new Vf(this,{kind:"constant",value:m(o.value.value,c.value.value,f)},o.parameters):o}evaluate(o,c,f,m,p,v){return o.kind==="constant"?o.value:o.evaluate(c,f,m,p,v)}}class Gf{constructor(o){this.specification=o}possiblyEvaluate(o,c,f,m){return!!o.expression.evaluate(c,null,{},f,m)}interpolate(){return!1}}class Ei{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new Hn(0,{});for(const f in o){const m=o[f];m.specification.overridable&&this.overridableProperties.push(f);const p=this.defaultPropertyValues[f]=new $f(m,void 0),v=this.defaultTransitionablePropertyValues[f]=new l1(m);this.defaultTransitioningPropertyValues[f]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=p.possiblyEvaluate(c)}}}Qt(Jt,"DataDrivenProperty"),Qt(jt,"DataConstantProperty"),Qt(Gf,"ColorRampProperty");var at=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"iconsets":{"experimental":true,"type":"iconsets"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"required":true,"type":"enum","values":{"sprite":1}},"url":{"required":true,"type":"string"}},"iconset_source":{"type":{"required":true,"type":"enum","values":{"source":1}},"source":{"required":true,"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","experimental":true,"private":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","experimental":true,"private":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"experimental":true,"private":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function j2(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function jv(d){if(Array.isArray(d))return d.map(jv);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const o={};for(const c in d)o[c]=jv(d[c]);return o}return j2(d)}function u1(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const o of d.slice(1))if(!u1(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function d1(d,o="",c=null,f="fill"){if(d==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};u1(d)||(d=Fv(d));const m=d;let p=!0;try{p=function(w){if(!qf(w))return w;let P=jv(w);return B2(P),P=F2(P),P}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let v=null,T=null;if(f!=="background"&&f!=="sky"&&f!=="slot"){T=at[`filter_${f}`];const w=zf(p,T,o,c);if(w.result==="error")throw new Error(w.value.map(P=>`${P.key}: ${P.message}`).join(", "));v=(P,D,O)=>w.value.evaluate(P,D,{},O)}let M=null,k=null;if(p!==m){const w=zf(m,T,o,c);if(w.result==="error")throw new Error(w.value.map(P=>`${P.key}: ${P.message}`).join(", "));M=(P,D,O,R,N)=>w.value.evaluate(P,D,{},O,void 0,void 0,R,N),k=!Of(w.value.expression)}return{filter:v,dynamicFilter:M||void 0,needGeometry:$2(p),needFeature:!!k}}function F2(d){if(!Array.isArray(d))return d;const o=function(c){if(ED.has(c[0])){for(let f=1;f<c.length;f++)if(qf(c[f]))return!0}return c}(d);return o===!0?o:o.map(c=>F2(c))}function B2(d){let o=!1;const c=[];if(d[0]==="case"){for(let f=1;f<d.length-1;f+=2)o=o||qf(d[f]),c.push(d[f+1]);c.push(d[d.length-1])}else if(d[0]==="match"){o=o||qf(d[1]);for(let f=2;f<d.length-1;f+=2)c.push(d[f+1]);c.push(d[d.length-1])}else if(d[0]==="step"){o=o||qf(d[1]);for(let f=1;f<d.length-1;f+=2)c.push(d[f+1])}o&&(d.length=0,d.push("any",...c));for(let f=1;f<d.length;f++)B2(d[f])}function qf(d){if(!Array.isArray(d))return!1;if((o=d[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let c=1;c<d.length;c++)if(qf(d[c]))return!0;return!1}const ED=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function AD(d,o){return d<o?-1:d>o?1:0}function $2(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let o=1;o<d.length;o++)if($2(d[o]))return!0;return!1}function Fv(d){if(!d)return!0;const o=d[0];return d.length<=1?o!=="any":o==="=="?rd(d[1],d[2],"=="):o==="!="?oh(rd(d[1],d[2],"==")):o==="<"||o===">"||o==="<="||o===">="?rd(d[1],d[2],o):o==="any"?(c=d.slice(1),["any"].concat(c.map(Fv))):o==="all"?["all"].concat(d.slice(1).map(Fv)):o==="none"?["all"].concat(d.slice(1).map(Fv).map(oh)):o==="in"?h1(d[1],d.slice(2)):o==="!in"?oh(h1(d[1],d.slice(2))):o==="has"?f1(d[1]):o!=="!has"||oh(f1(d[1]));var c}function rd(d,o,c){switch(d){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,d,o]}}function h1(d,o){if(o.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",d,["literal",o.sort(AD)]]:["filter-in-small",d,["literal",o]]}}function f1(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function oh(d){return["!",d]}const Bv="";function Hf(d,o){return o?`${d}${Bv}${o}`:d}const Jc="-transition",U2=new Set(["fill","line","background","hillshade","raster"]);class zo extends Il{constructor(o,c,f,m,p){if(super(),this.id=o.id,this.fqid=Hf(this.id,f),this.type=o.type,this.scope=f,this.lut=m,this.options=p,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const v=zf(this.filter,at[`filter_${o.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),c.layout&&(this._unevaluatedLayout=new Uf(c.layout,this.scope,p),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),c.paint){this._transitionablePaint=new c1(c.paint,this.scope,p);for(const v in o.paint)this.setPaintProperty(v,o.paint[v]);for(const v in o.layout)this.setLayoutProperty(v,o.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wf(c.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D(!0)&&U2.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c){if(this.type==="custom"&&o==="visibility")return void(this.visibility=c);const f=this._unevaluatedLayout;f._properties.properties[o]&&(f.setValue(o,c),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return o.endsWith(Jc)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c){const f=this._transitionablePaint,m=f._properties.properties;if(o.endsWith(Jc)){const P=o.slice(0,-11);return m[P]&&f.setTransition(P,c||void 0),!1}if(!m[o])return!1;const p=f._values[o],v=p.value.isDataDriven(),T=p.value;f.setValue(o,c),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const M=f._values[o].value,k=M.isDataDriven(),w=o.endsWith("pattern")||o==="line-dasharray";return k||v||w||this._handleOverridablePaintPropertyUpdate(o,T,M)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,c,f){return null}_handleOverridablePaintPropertyUpdate(o,c,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){return vs({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}is3D(o){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof Vf&&Nf(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=d1(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,c,f,m,p,v,T,M,k){}}const CD={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class cg{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Qn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function xn(d,o=1){let c=0,f=0;return{members:d.map(m=>{const p=CD[m.type].BYTES_PER_ELEMENT,v=c=V2(c,Math.max(o,p)),T=m.components||1;return f=Math.max(f,p),c+=p*T,{name:m.name,type:m.type,components:T,offset:v}}),size:V2(c,Math.max(f,o)),alignment:o}}function V2(d,o){return Math.ceil(d/o)*o}class Qc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const m=2*o;return this.int16[m+0]=c,this.int16[m+1]=f,o}}Qc.prototype.bytesPerElement=4,Qt(Qc,"StructArrayLayout2i4");class Zf extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const p=3*o;return this.int16[p+0]=c,this.int16[p+1]=f,this.int16[p+2]=m,o}}Zf.prototype.bytesPerElement=6,Qt(Zf,"StructArrayLayout3i6");class eu extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,f,m)}emplace(o,c,f,m,p){const v=4*o;return this.int16[v+0]=c,this.int16[v+1]=f,this.int16[v+2]=m,this.int16[v+3]=p,o}}eu.prototype.bytesPerElement=8,Qt(eu,"StructArrayLayout4i8");class ah extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}ah.prototype.bytesPerElement=4,Qt(ah,"StructArrayLayout1f4");class ug extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const p=4*o,v=2*o;return this.int16[p+0]=c,this.int16[p+1]=f,this.float32[v+1]=m,o}}ug.prototype.bytesPerElement=8,Qt(ug,"StructArrayLayout2i1f8");class p1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const p=4*o;return this.int16[p+0]=c,this.int16[p+1]=f,this.int16[p+2]=m,o}}p1.prototype.bytesPerElement=8,Qt(p1,"StructArrayLayout3i8");class Qs extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m,p)}emplace(o,c,f,m,p,v){const T=5*o;return this.int16[T+0]=c,this.int16[T+1]=f,this.int16[T+2]=m,this.int16[T+3]=p,this.int16[T+4]=v,o}}Qs.prototype.bytesPerElement=10,Qt(Qs,"StructArrayLayout5i10");class m1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,f,m,p,v,T)}emplace(o,c,f,m,p,v,T,M){const k=6*o,w=12*o,P=3*o;return this.int16[k+0]=c,this.int16[k+1]=f,this.uint8[w+4]=m,this.uint8[w+5]=p,this.uint8[w+6]=v,this.uint8[w+7]=T,this.float32[P+2]=M,o}}m1.prototype.bytesPerElement=12,Qt(m1,"StructArrayLayout2i4ub1f12");class Dl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const p=3*o;return this.float32[p+0]=c,this.float32[p+1]=f,this.float32[p+2]=m,o}}Dl.prototype.bytesPerElement=12,Qt(Dl,"StructArrayLayout3f12");class nd extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m,p)}emplace(o,c,f,m,p,v){const T=6*o,M=3*o;return this.uint16[T+0]=c,this.uint16[T+1]=f,this.uint16[T+2]=m,this.uint16[T+3]=p,this.float32[M+2]=v,o}}nd.prototype.bytesPerElement=12,Qt(nd,"StructArrayLayout4ui1f12");class $v extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,f,m)}emplace(o,c,f,m,p){const v=4*o;return this.uint16[v+0]=c,this.uint16[v+1]=f,this.uint16[v+2]=m,this.uint16[v+3]=p,o}}$v.prototype.bytesPerElement=8,Qt($v,"StructArrayLayout4ui8");class Uv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,f,m,p,v)}emplace(o,c,f,m,p,v,T){const M=6*o;return this.int16[M+0]=c,this.int16[M+1]=f,this.int16[M+2]=m,this.int16[M+3]=p,this.int16[M+4]=v,this.int16[M+5]=T,o}}Uv.prototype.bytesPerElement=12,Qt(Uv,"StructArrayLayout6i12");class g1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k,w,P,D){const O=this.length;return this.resize(O+1),this.emplace(O,o,c,f,m,p,v,T,M,k,w,P,D)}emplace(o,c,f,m,p,v,T,M,k,w,P,D,O){const R=12*o;return this.int16[R+0]=c,this.int16[R+1]=f,this.int16[R+2]=m,this.int16[R+3]=p,this.uint16[R+4]=v,this.uint16[R+5]=T,this.uint16[R+6]=M,this.uint16[R+7]=k,this.int16[R+8]=w,this.int16[R+9]=P,this.int16[R+10]=D,this.int16[R+11]=O,o}}g1.prototype.bytesPerElement=24,Qt(g1,"StructArrayLayout4i4ui4i24");class y1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,f,m,p,v)}emplace(o,c,f,m,p,v,T){const M=10*o,k=5*o;return this.int16[M+0]=c,this.int16[M+1]=f,this.int16[M+2]=m,this.float32[k+2]=p,this.float32[k+3]=v,this.float32[k+4]=T,o}}y1.prototype.bytesPerElement=20,Qt(y1,"StructArrayLayout3i3f20");class sh extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,f,m)}emplace(o,c,f,m,p){const v=4*o;return this.float32[v+0]=c,this.float32[v+1]=f,this.float32[v+2]=m,this.float32[v+3]=p,o}}sh.prototype.bytesPerElement=16,Qt(sh,"StructArrayLayout4f16");class v1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}v1.prototype.bytesPerElement=4,Qt(v1,"StructArrayLayout1ul4");class id extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const m=2*o;return this.uint16[m+0]=c,this.uint16[m+1]=f,o}}id.prototype.bytesPerElement=4,Qt(id,"StructArrayLayout2ui4");class _1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k,w,P,D,O){const R=this.length;return this.resize(R+1),this.emplace(R,o,c,f,m,p,v,T,M,k,w,P,D,O)}emplace(o,c,f,m,p,v,T,M,k,w,P,D,O,R){const N=20*o,W=10*o;return this.int16[N+0]=c,this.int16[N+1]=f,this.int16[N+2]=m,this.int16[N+3]=p,this.int16[N+4]=v,this.float32[W+3]=T,this.float32[W+4]=M,this.float32[W+5]=k,this.float32[W+6]=w,this.int16[N+14]=P,this.uint32[W+8]=D,this.uint16[N+18]=O,this.uint16[N+19]=R,o}}_1.prototype.bytesPerElement=40,Qt(_1,"StructArrayLayout5i4f1i1ul2ui40");class dg extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,f,m,p,v,T)}emplace(o,c,f,m,p,v,T,M){const k=8*o;return this.int16[k+0]=c,this.int16[k+1]=f,this.int16[k+2]=m,this.int16[k+4]=p,this.int16[k+5]=v,this.int16[k+6]=T,this.int16[k+7]=M,o}}dg.prototype.bytesPerElement=16,Qt(dg,"StructArrayLayout3i2i2i16");class x1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m,p)}emplace(o,c,f,m,p,v){const T=4*o,M=8*o;return this.float32[T+0]=c,this.float32[T+1]=f,this.float32[T+2]=m,this.int16[M+6]=p,this.int16[M+7]=v,o}}x1.prototype.bytesPerElement=16,Qt(x1,"StructArrayLayout2f1f2i16");class b1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,f,m,p,v)}emplace(o,c,f,m,p,v,T){const M=20*o,k=5*o;return this.uint8[M+0]=c,this.uint8[M+1]=f,this.float32[k+1]=m,this.float32[k+2]=p,this.float32[k+3]=v,this.float32[k+4]=T,o}}b1.prototype.bytesPerElement=20,Qt(b1,"StructArrayLayout2ub4f20");class qo extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const p=3*o;return this.uint16[p+0]=c,this.uint16[p+1]=f,this.uint16[p+2]=m,o}}qo.prototype.bytesPerElement=6,Qt(qo,"StructArrayLayout3ui6");class Vv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee,K,ie){const le=this.length;return this.resize(le+1),this.emplace(le,o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee,K,ie)}emplace(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee,K,ie,le){const he=30*o,we=15*o,_e=60*o;return this.int16[he+0]=c,this.int16[he+1]=f,this.int16[he+2]=m,this.float32[we+2]=p,this.float32[we+3]=v,this.uint16[he+8]=T,this.uint16[he+9]=M,this.uint32[we+5]=k,this.uint32[we+6]=w,this.uint32[we+7]=P,this.uint16[he+16]=D,this.uint16[he+17]=O,this.uint16[he+18]=R,this.float32[we+10]=N,this.float32[we+11]=W,this.uint8[_e+48]=Z,this.uint8[_e+49]=te,this.uint8[_e+50]=ee,this.uint32[we+13]=K,this.int16[he+28]=ie,this.uint8[_e+58]=le,o}}Vv.prototype.bytesPerElement=60,Qt(Vv,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Wv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee,K,ie,le,he,we,_e,xe,De,Se,Le,We,Ue,Xe,He){const nt=this.length;return this.resize(nt+1),this.emplace(nt,o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee,K,ie,le,he,we,_e,xe,De,Se,Le,We,Ue,Xe,He)}emplace(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee,K,ie,le,he,we,_e,xe,De,Se,Le,We,Ue,Xe,He,nt){const Je=20*o,it=40*o,Mt=80*o;return this.float32[Je+0]=c,this.float32[Je+1]=f,this.int16[it+4]=m,this.int16[it+5]=p,this.int16[it+6]=v,this.int16[it+7]=T,this.int16[it+8]=M,this.int16[it+9]=k,this.int16[it+10]=w,this.int16[it+11]=P,this.int16[it+12]=D,this.uint16[it+13]=O,this.uint16[it+14]=R,this.uint16[it+15]=N,this.uint16[it+16]=W,this.uint16[it+17]=Z,this.uint16[it+18]=te,this.uint16[it+19]=ee,this.uint16[it+20]=K,this.uint16[it+21]=ie,this.uint16[it+22]=le,this.uint16[it+23]=he,this.uint16[it+24]=we,this.uint16[it+25]=_e,this.uint16[it+26]=xe,this.uint16[it+27]=De,this.uint32[Je+14]=Se,this.float32[Je+15]=Le,this.float32[Je+16]=We,this.float32[Je+17]=Ue,this.float32[Je+18]=Xe,this.uint8[Mt+76]=He,this.uint16[it+39]=nt,o}}Wv.prototype.bytesPerElement=80,Qt(Wv,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Ja extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m,p)}emplace(o,c,f,m,p,v){const T=5*o;return this.float32[T+0]=c,this.float32[T+1]=f,this.float32[T+2]=m,this.float32[T+3]=p,this.float32[T+4]=v,o}}Ja.prototype.bytesPerElement=20,Qt(Ja,"StructArrayLayout5f20");class Gv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,f,m,p,v,T)}emplace(o,c,f,m,p,v,T,M){const k=7*o;return this.float32[k+0]=c,this.float32[k+1]=f,this.float32[k+2]=m,this.float32[k+3]=p,this.float32[k+4]=v,this.float32[k+5]=T,this.float32[k+6]=M,o}}Gv.prototype.bytesPerElement=28,Qt(Gv,"StructArrayLayout7f28");class w1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k,w,P){const D=this.length;return this.resize(D+1),this.emplace(D,o,c,f,m,p,v,T,M,k,w,P)}emplace(o,c,f,m,p,v,T,M,k,w,P,D){const O=11*o;return this.float32[O+0]=c,this.float32[O+1]=f,this.float32[O+2]=m,this.float32[O+3]=p,this.float32[O+4]=v,this.float32[O+5]=T,this.float32[O+6]=M,this.float32[O+7]=k,this.float32[O+8]=w,this.float32[O+9]=P,this.float32[O+10]=D,o}}w1.prototype.bytesPerElement=44,Qt(w1,"StructArrayLayout11f44");class S1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k){const w=this.length;return this.resize(w+1),this.emplace(w,o,c,f,m,p,v,T,M,k)}emplace(o,c,f,m,p,v,T,M,k,w){const P=9*o;return this.float32[P+0]=c,this.float32[P+1]=f,this.float32[P+2]=m,this.float32[P+3]=p,this.float32[P+4]=v,this.float32[P+5]=T,this.float32[P+6]=M,this.float32[P+7]=k,this.float32[P+8]=w,o}}S1.prototype.bytesPerElement=36,Qt(S1,"StructArrayLayout9f36");class Xf extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const m=2*o;return this.float32[m+0]=c,this.float32[m+1]=f,o}}Xf.prototype.bytesPerElement=8,Qt(Xf,"StructArrayLayout2f8");class hg extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,f,m)}emplace(o,c,f,m,p){const v=6*o;return this.uint32[3*o+0]=c,this.uint16[v+2]=f,this.uint16[v+3]=m,this.uint16[v+4]=p,o}}hg.prototype.bytesPerElement=12,Qt(hg,"StructArrayLayout1ul3ui12");class qv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}qv.prototype.bytesPerElement=2,Qt(qv,"StructArrayLayout1ui2");class Hv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W){const Z=this.length;return this.resize(Z+1),this.emplace(Z,o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W)}emplace(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z){const te=16*o;return this.float32[te+0]=c,this.float32[te+1]=f,this.float32[te+2]=m,this.float32[te+3]=p,this.float32[te+4]=v,this.float32[te+5]=T,this.float32[te+6]=M,this.float32[te+7]=k,this.float32[te+8]=w,this.float32[te+9]=P,this.float32[te+10]=D,this.float32[te+11]=O,this.float32[te+12]=R,this.float32[te+13]=N,this.float32[te+14]=W,this.float32[te+15]=Z,o}}Hv.prototype.bytesPerElement=64,Qt(Hv,"StructArrayLayout16f64");class Zv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,f,m,p,v,T)}emplace(o,c,f,m,p,v,T,M){const k=10*o,w=5*o;return this.uint16[k+0]=c,this.uint16[k+1]=f,this.uint16[k+2]=m,this.uint16[k+3]=p,this.float32[w+2]=v,this.float32[w+3]=T,this.float32[w+4]=M,o}}Zv.prototype.bytesPerElement=20,Qt(Zv,"StructArrayLayout4ui3f20");class Xv extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.int16[1*o+0]=c,o}}Xv.prototype.bytesPerElement=2,Qt(Xv,"StructArrayLayout1i2");class T1 extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint8[1*o+0]=c,o}}T1.prototype.bytesPerElement=1,Qt(T1,"StructArrayLayout1ub1");class E1 extends cg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}E1.prototype.size=40;class fg extends _1{get(o){return new E1(this,o)}}Qt(fg,"CollisionBoxArray");class W2 extends cg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}W2.prototype.size=60;class G2 extends Vv{get(o){return new W2(this,o)}}Qt(G2,"PlacedSymbolArray");class q2 extends cg{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}q2.prototype.size=80;class H2 extends Wv{get(o){return new q2(this,o)}}Qt(H2,"SymbolInstanceArray");class Z2 extends ah{getoffsetX(o){return this.float32[1*o+0]}}Qt(Z2,"GlyphOffsetArray");class pg extends Qc{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Qt(pg,"SymbolLineVertexArray");class mg extends cg{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}mg.prototype.size=12;class Qa extends hg{get(o){return new mg(this,o)}}Qt(Qa,"FeatureIndexArray");class gg extends id{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Qt(gg,"FillExtrusionCentroidArray");class X2 extends cg{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}X2.prototype.size=6;class Y2 extends Zf{get(o){return new X2(this,o)}}Qt(Y2,"FillExtrusionWallArray");const MD=xn([{name:"a_pos",components:2,type:"Int16"}],4),PD=xn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class hi{constructor(o=[]){this.segments=o}_prepareSegment(o,c,f,m){let p=this.segments[this.segments.length-1];return o>hi.MAX_VERTEX_ARRAY_LENGTH&&ai(`Max vertices per segment is ${hi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!p||p.vertexLength+o>hi.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==m)&&(p={vertexOffset:c,primitiveOffset:f,vertexLength:0,primitiveLength:0},m!==void 0&&(p.sortKey=m),this.segments.push(p)),p}prepareSegment(o,c,f,m){return this._prepareSegment(o,c.length,f.length,m)}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,f,m){return new hi([{vertexOffset:o,primitiveOffset:c,vertexLength:f,primitiveLength:m,vaos:{},sortKey:0}])}}function K2(d,o){return 256*(d=Yt(Math.floor(d),0,255))+Yt(Math.floor(o),0,255)}hi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qt(hi,"SegmentVector");const A1=xn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ID=xn([{name:"a_dash",components:4,type:"Uint16"}]);class yg{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,c,f,m){this.ids.push(C1(o)),this.positions.push(c,f,m)}eachPosition(o,c){const f=C1(o);let m=0,p=this.ids.length-1;for(;m<p;){const v=m+p>>1;this.ids[v]>=f?p=v:m=v+1}for(;this.ids[m]===f;)c(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(o,c){const f=new Float64Array(o.ids),m=new Uint32Array(o.positions);return vg(f,m,0,f.length-1),c&&(c.add(f.buffer),c.add(m.buffer)),{ids:f,positions:m}}static deserialize(o){const c=new yg;let f;c.ids=o.ids,c.positions=o.positions;for(const m of c.ids)m!==f&&c.uniqueIds.push(m),f=m;return c.indexed=!0,c}}function C1(d){const o=+d;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:bs(String(d))}function vg(d,o,c,f){for(;c<f;){const m=d[c+f>>1];let p=c-1,v=f+1;for(;;){do p++;while(d[p]<m);do v--;while(d[v]>m);if(p>=v)break;Yv(d,p,v),Yv(o,3*p,3*v),Yv(o,3*p+1,3*v+1),Yv(o,3*p+2,3*v+2)}v-c<f-v?(vg(d,o,c,v),c=v+1):(vg(d,o,v+1,f),f=v)}}function Yv(d,o,c){const f=d[o];d[o]=d[c],d[c]=f}Qt(yg,"FeaturePositionMap");class hc{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,c),this.initialized=!0),!!this.location}set(o,c,f){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class _g extends hc{constructor(o){super(o),this.current=0}set(o,c,f){this.fetchUniformLocation(o,c)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class Wi extends hc{constructor(o){super(o),this.current=0}set(o,c,f){this.fetchUniformLocation(o,c)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class el extends hc{constructor(o){super(o),this.current=[0,0]}set(o,c,f){this.fetchUniformLocation(o,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class Yf extends hc{constructor(o){super(o),this.current=[0,0,0]}set(o,c,f){this.fetchUniformLocation(o,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class xg extends hc{constructor(o){super(o),this.current=[0,0,0,0]}set(o,c,f){this.fetchUniformLocation(o,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class J2 extends hc{constructor(o){super(o),this.current=On.transparent.toRenderColor(null)}set(o,c,f){this.fetchUniformLocation(o,c)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const Q2=new Float32Array(16);class bg extends hc{constructor(o){super(o),this.current=Q2}set(o,c,f){if(this.fetchUniformLocation(o,c)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let m=1;m<16;m++)if(f[m]!==this.current[m]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const M1=new Float32Array(9),OD=new Float32Array(4);class P1 extends hc{constructor(o){super(o),this.current=OD}set(o,c,f){if(this.fetchUniformLocation(o,c)){for(let m=0;m<4;m++)if(f[m]!==this.current[m]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}}function I1(d){return[K2(255*d.r,255*d.g),K2(255*d.b,255*d.a)]}class wg{constructor(o,c,f,m){this.value=o,this.uniformNames=c.map(p=>`u_${p}`),this.type=f,this.context=m}setUniform(o,c,f,m,p){const v=m.constantOr(this.value);c.set(o,p,v instanceof On?v.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):v)}getBinding(o,c){return this.type==="color"?new J2(o):new Wi(o)}}class lh{constructor(o,c){this.uniformNames=c.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,c,f,m,p){const v=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;v&&c.set(o,p,v)}getBinding(o,c){return c==="u_pattern"||c==="u_dash"?new xg(o):new Wi(o)}}class tu{constructor(o,c,f,m){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=c.map(p=>({name:`a_${p}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(o,c,f,m,p,v,T){const M=this.paintVertexArray.length,k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Hn(0,{brightness:v}),c,{},p,m,T):this.expression.kind==="constant"&&this.expression.value,w=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Hn(0,{brightness:v}),c,{},p,m,T):this.lutExpression.value)==="none";this.paintVertexArray.resize(o),this._setPaintValue(M,o,k,w?null:this.context.lut)}updatePaintArray(o,c,f,m,p,v,T){const M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:T},f,m,void 0,p):this.expression.kind==="constant"&&this.expression.value,k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Hn(0,{brightness:T}),f,m,void 0,p):this.lutExpression.value)==="none";this._setPaintValue(o,c,M,k?null:this.context.lut)}_setPaintValue(o,c,f,m){if(this.type==="color"){const p=I1(f.toRenderColor(m));for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=o;p<c;p++)this.paintVertexArray.emplace(p,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ll{constructor(o,c,f,m,p,v){this.expression=o,this.uniformNames=c.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=m,this.context=p,this.maxValue=0,this.paintVertexAttributes=c.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(o,c,f,m,p,v,T){const M=this.expression.evaluate(new Hn(this.context.zoom,{brightness:v}),c,{},p,m,T),k=this.expression.evaluate(new Hn(this.context.zoom+1,{brightness:v}),c,{},p,m,T),w=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Hn(0,{brightness:v}),c,{},p,m,T):this.lutExpression.value)==="none",P=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(P,o,M,k,w?null:this.context.lut)}updatePaintArray(o,c,f,m,p,v,T){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:T},f,m,void 0,p),k=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},f,m,void 0,p),w=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Hn(0,{brightness:T}),f,m,void 0,p):this.lutExpression.value)==="none";this._setPaintValue(o,c,M,k,w?null:this.context.lut)}_setPaintValue(o,c,f,m,p){if(this.type==="color"){const v=I1(f.toRenderColor(p)),T=I1(f.toRenderColor(p));for(let M=o;M<c;M++)this.paintVertexArray.emplace(M,v[0],v[1],T[0],T[1])}else{for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,f,m);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(m))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c,f,m,p){const v=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,T=Yt(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);c.set(o,p,T)}getBinding(o,c){return new Wi(o)}}class od{constructor(o,c,f,m,p){this.expression=o,this.layerId=p,this.paintVertexAttributes=(f==="array"?ID:A1).members;for(let v=0;v<c.length;++v);this.paintVertexArray=new m}populatePaintArray(o,c,f,m){const p=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(p,o,c.patterns&&c.patterns[this.layerId],f)}updatePaintArray(o,c,f,m,p,v,T){this._setPaintValues(o,c,f.patterns&&f.patterns[this.layerId],v)}_setPaintValues(o,c,f,m){if(!m||!f)return;const p=m[f];if(!p)return;const{tl:v,br:T,pixelRatio:M}=p;for(let k=o;k<c;k++)this.paintVertexArray.emplace(k,v[0],v[1],T[0],T[1],M)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ch{constructor(o,c,f=()=>!0){this.binders={},this._buffers=[],this.context=c;const m=[];for(const p in o.paint._values){const v=o.paint.get(p);if(p.endsWith("-use-theme")||!f(p)||!(v instanceof Vf&&Nf(v.property.specification)))continue;const T=RD(p,o.type),M=v.value,k=v.property.specification.type,w=!!v.property.useIntegerZoom,P=p==="line-dasharray"||p.endsWith("pattern"),D=o.paint.get(`${p}-use-theme`),O=p==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||D&&D.value.kind!=="constant";if(M.kind!=="constant"||O)if(M.kind==="source"||O||P){const R=eA(p,k,"source");this.binders[p]=P?new od(M,T,k,R,o.id):new tu(M,T,k,R),m.push(`/a_${p}`)}else{const R=eA(p,k,"composite");this.binders[p]=new Ll(M,T,k,w,c,R),m.push(`/z_${p}`)}else this.binders[p]=P?new lh(M.value,T):new wg(M.value,T,k,c),m.push(`/u_${p}`);D&&(this.binders[p].lutExpression=D.value)}this.cacheKey=m.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof tu||c instanceof Ll?c.maxValue:0}populatePaintArrays(o,c,f,m,p,v,T){for(const M in this.binders){const k=this.binders[M];k.context=this.context,(k instanceof tu||k instanceof Ll||k instanceof od)&&k.populatePaintArray(o,c,f,m,p,v,T)}}setConstantPatternPositions(o){for(const c in this.binders){const f=this.binders[c];f instanceof lh&&f.setConstantPatternPositions(o)}}updatePaintArrays(o,c,f,m,p,v,T,M,k){let w=!1;const P=Object.keys(o),D=P.length!==0&&!M,O=D?P:c.uniqueIds;this.context.lut=p.lut;for(const R in this.binders){const N=this.binders[R];if(N.context=this.context,(N instanceof tu||N instanceof Ll||N instanceof od)&&N.expression&&N.expression.kind&&N.expression.kind!=="constant"&&(N.expression.isStateDependent===!0||N.expression.isLightConstant===!1)){const W=p.paint.get(R);N.expression=W.value;for(const Z of O){const te=o[Z.toString()];c.eachPosition(Z,(ee,K,ie)=>{const le=m.feature(ee);N.updatePaintArray(K,ie,le,te,v,T,k)})}if(!D)for(const Z of f.uniqueIds){const te=o[Z.toString()];f.eachPosition(Z,(ee,K,ie)=>{const le=m.feature(ee);N.updatePaintArray(K,ie,le,te,v,T,k)})}w=!0}}return w}defines(){const o=[];for(const c in this.binders){const f=this.binders[c];(f instanceof wg||f instanceof lh)&&o.push(...f.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof tu||f instanceof Ll||f instanceof od)for(let m=0;m<f.paintVertexAttributes.length;m++)o.push(f.paintVertexAttributes[m].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof wg||f instanceof lh||f instanceof Ll)for(const m of f.uniformNames)o.push(m)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const c=[];for(const f in this.binders){const m=this.binders[f];if(m instanceof wg||m instanceof lh||m instanceof Ll)for(const p of m.uniformNames)c.push({name:p,property:f,binding:m.getBinding(o,p)})}return c}setUniforms(o,c,f,m,p){for(const{name:v,property:T,binding:M}of f)this.binders[T].setUniform(o,M,p,m.get(T),v)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const c=this.binders[o];(c instanceof tu||c instanceof Ll||c instanceof od)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(o){for(const c in this.binders){const f=this.binders[c];(f instanceof tu||f instanceof Ll||f instanceof od)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof tu||c instanceof Ll||c instanceof od)&&c.destroy()}}}class ad{constructor(o,c,f=()=>!0){this.programConfigurations={};for(const m of o)this.programConfigurations[m.id]=new ch(m,c,f);this.needsUpload=!1,this._featureMap=new yg,this._featureMapWithoutIds=new yg,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,c,f,m,p,v,T,M){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(o,c,m,p,v,T,M);c.id!==void 0?this._featureMap.add(c.id,f,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,f,m,p,v,T){for(const M of f)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,c,M,m,p,v,T||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const kD={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function RD(d,o){return kD[d]||[d.replace(`${o}-`,"").replace(/-/g,"_")]}const DD={"line-pattern":{source:nd,composite:nd},"fill-pattern":{source:nd,composite:nd},"fill-extrusion-pattern":{source:nd,composite:nd},"line-dasharray":{source:$v,composite:$v}},Kv={color:{source:Xf,composite:sh},number:{source:ah,composite:Xf}};function eA(d,o,c){const f=DD[d];return f&&f[c]||Kv[o][c]}Qt(wg,"ConstantBinder"),Qt(lh,"PatternConstantBinder"),Qt(tu,"SourceExpressionBinder"),Qt(od,"PatternCompositeBinder"),Qt(Ll,"CompositeExpressionBinder"),Qt(ch,"ProgramConfiguration",{omit:["_buffers"]}),Qt(ad,"ProgramConfigurationSet");const Oa=$t/Math.PI/2,Kf=5,tA=6,rA=16383,Jf=64,Jv=[Jf,32,16],Es=-Oa,As=Oa;function Qf(d,o,c,f=Oa){return c=Ge(c),[d*Math.sin(c)*f,-o*f,d*Math.cos(c)*f]}function uh(d,o,c){return Qf(Math.cos(Ge(d)),Math.sin(Ge(d)),o,c)}const dh=63710088e-1,O1=2*Math.PI*dh;class bn{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bn(oi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,f=this.lat*c,m=o.lat*c,p=Math.sin(f)*Math.sin(m)+Math.cos(f)*Math.cos(m)*Math.cos((o.lng-this.lng)*c);return dh*Math.acos(Math.min(p,1))}toBounds(o=0){const c=360*o/40075017,f=c/Math.cos(Math.PI/180*this.lat);return new sd({lng:this.lng-f,lat:this.lat-c},{lng:this.lng+f,lat:this.lat+c})}toEcef(o){return uh(this.lat,this.lng,Oa+o*Oa/dh)}static convert(o){if(o instanceof bn)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new bn(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new bn(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class sd{constructor(o,c){if(o)if(c)this.setSouthWest(o).setNorthEast(c);else if(o.length===4){const f=o;this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]])}else{const f=o;this.setSouthWest(f[0]).setNorthEast(f[1])}}setNorthEast(o){return this._ne=o instanceof bn?new bn(o.lng,o.lat):bn.convert(o),this}setSouthWest(o){return this._sw=o instanceof bn?new bn(o.lng,o.lat):bn.convert(o),this}extend(o){const c=this._sw,f=this._ne;let m,p;if(o instanceof bn)m=o,p=o;else{if(!(o instanceof sd))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(sd.convert(o)):this.extend(bn.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(bn.convert(o)):this;if(m=o._sw,p=o._ne,!m||!p)return this}return c||f?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),f.lng=Math.max(p.lng,f.lng),f.lat=Math.max(p.lat,f.lat)):(this._sw=new bn(m.lng,m.lat),this._ne=new bn(p.lng,p.lat)),this}getCenter(){return new bn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new bn(this.getWest(),this.getNorth())}getSouthEast(){return new bn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:c,lat:f}=bn.convert(o);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&m}static convert(o){if(o)return o instanceof sd?o:new sd(o)}}const LD=0,ND=25.5;function Qv(d){return O1*Math.cos(d*Math.PI/180)}function fc(d){return(180+d)/360}function es(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function ta(d,o){return d/Qv(o)}function ts(d){return 360*d-180}function Ho(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function k1(d,o){return d*Qv(Ho(o))}const Bi=85.051129;function nA(d){return Math.cos(Ge(Yt(d,-Bi,Bi)))}function ld(d,o){const c=Yt(o,LD,ND),f=Math.pow(2,c);return nA(d)*O1/(512*f)}function zD(d){return 1/Math.cos(d*Math.PI/180)}function y(d,o=0){const c=Math.exp(Math.PI*(1-(d.y+o/$t)/(1<<d.z)*2));return 80150034*c/(c*c+1)/$t/(1<<d.z)}class s{constructor(o,c,f=0){this.x=+o,this.y=+c,this.z=+f}static fromLngLat(o,c=0){const f=bn.convert(o);return new s(fc(f.lng),es(f.lat),ta(c,f.lat))}toLngLat(){return new bn(ts(this.x),Ho(this.y))}toAltitude(){return k1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/O1*zD(Ho(this.y))}}function u(d,o,c,f,m,p,v,T,M){const k=(o+f)/2,w=(c+m)/2,P=new xt(k,w);T(P),function(D,O,R,N,W,Z){const te=R-W,ee=N-Z;return Math.abs((N-O)*te-(R-D)*ee)/Math.hypot(te,ee)}(P.x,P.y,p.x,p.y,v.x,v.y)>=M?(u(d,o,c,k,w,p,P,T,M),u(d,k,w,f,m,P,v,T,M)):d.push(v)}function g(d,o,c){let f=d[0],m=f.x,p=f.y;o(f);const v=[f];for(let T=1;T<d.length;T++){const M=d[T],{x:k,y:w}=M;o(M),u(v,m,p,k,w,f,M,o,c),m=k,p=w,f=M}return v}function x(d,o,c,f){if(f(o,c)){const m=o.add(c)._mult(.5);x(d,o,m,f),x(d,m,c,f)}else d.push(c)}function S(d,o){let c=d[0];const f=[c];for(let m=1;m<d.length;m++){const p=d[m];x(f,c,p,o),c=p}return f}const A=Math.pow(2,14)-1,L=-A-1;function z(d,o){const c=Math.round(d.x*o),f=Math.round(d.y*o);return d.x=Yt(c,L,A),d.y=Yt(f,L,A),(c<d.x||c>d.x+1||f<d.y||f>d.y+1)&&ai("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d}function U(d,o,c){const f=d.loadGeometry(),m=d.extent,p=$t/m;if(o&&c&&c.projection.isReprojectedInTileSpace){const v=1<<o.z,{scale:T,x:M,y:k,projection:w}=c,P=D=>{const O=ts((o.x+D.x/m)/v),R=Ho((o.y+D.y/m)/v),N=w.project(O,R);D.x=(N.x*T-M)*m,D.y=(N.y*T-k)*m};for(let D=0;D<f.length;D++)if(d.type!==1)f[D]=g(f[D],P,1);else{const O=[];for(const R of f[D])R.x<0||R.x>=m||R.y<0||R.y>=m||(P(R),O.push(R));f[D]=O}}for(const v of f)for(const T of v)z(T,p);return f}function V(d,o){return{type:d.type,id:d.id,properties:d.properties,geometry:o?U(d):[]}}function X(d,o,c,f,m){d.emplaceBack(2*o+(f+1)/2,2*c+(m+1)/2)}function Y(d,o,c){d.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class re{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Qc,this.indexArray=new qo,this.segments=new hi,this.programConfigurations=new ad(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}updateFootprints(o,c){}populate(o,c,f,m){const p=this.layers[0],v=[];let T=null;p.type==="circle"&&(T=p.layout.get("circle-sort-key"));for(const{feature:k,id:w,index:P,sourceLayerIndex:D}of o){const O=this.layers[0]._featureFilter.needGeometry,R=V(k,O);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),R,f))continue;const N=T?T.evaluate(R,{},f):void 0,W={id:w,properties:k.properties,type:k.type,sourceLayerIndex:D,index:P,geometry:O?R.geometry:U(k,f,m),patterns:{},sortKey:N};v.push(W)}T&&v.sort((k,w)=>k.sortKey-w.sortKey);let M=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Uv,M=m.projection);for(const k of v){const{geometry:w,index:P,sourceLayerIndex:D}=k,O=o[P].feature;this.addFeature(k,w,P,c.availableImages,f,M,c.brightness),c.featureIndex.insert(O,w,P,D,this.index)}}update(o,c,f,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,f,m,v,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,MD.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,PD.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,c,f,m,p,v,T){for(const M of c)for(const k of M){const w=k.x,P=k.y;if(w<0||w>=$t||P<0||P>=$t)continue;if(v){const R=v.projectTilePoint(w,P,p),N=v.upVector(p,w,P),W=this.globeExtVertexArray;Y(W,R,N),Y(W,R,N),Y(W,R,N),Y(W,R,N)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),O=D.vertexLength;X(this.layoutVertexArray,w,P,-1,-1),X(this.layoutVertexArray,w,P,1,-1),X(this.layoutVertexArray,w,P,1,1),X(this.layoutVertexArray,w,P,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+2,O+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{},m,p,T)}}function ce(d,o){for(let c=0;c<d.length;c++)if(Ie(o,d[c]))return!0;for(let c=0;c<o.length;c++)if(Ie(d,o[c]))return!0;return!!be(d,o)}function se(d,o,c){return!!Ie(d,o)||!!Te(o,d,c)}function pe(d,o){if(d.length===1)return Pe(o,d[0]);for(let c=0;c<o.length;c++){const f=o[c];for(let m=0;m<f.length;m++)if(Ie(d,f[m]))return!0}for(let c=0;c<d.length;c++)if(Pe(o,d[c]))return!0;for(let c=0;c<o.length;c++)if(be(d,o[c]))return!0;return!1}function me(d,o,c){if(d.length>1){if(be(d,o))return!0;for(let f=0;f<o.length;f++)if(Te(o[f],d,c))return!0}for(let f=0;f<d.length;f++)if(Te(d[f],o,c))return!0;return!1}function be(d,o){if(d.length===0||o.length===0)return!1;for(let c=0;c<d.length-1;c++){const f=d[c],m=d[c+1];for(let p=0;p<o.length-1;p++)if(Ee(f,m,o[p],o[p+1]))return!0}return!1}function Ee(d,o,c,f){return Wt(d,c,f)!==Wt(o,c,f)&&Wt(d,o,c)!==Wt(d,o,f)}function Te(d,o,c){const f=c*c;if(o.length===1)return d.distSqr(o[0])<f;for(let m=1;m<o.length;m++)if(Re(d,o[m-1],o[m])<f)return!0;return!1}function Re(d,o,c){const f=o.distSqr(c);if(f===0)return d.distSqr(o);const m=((d.x-o.x)*(c.x-o.x)+(d.y-o.y)*(c.y-o.y))/f;return d.distSqr(m<0?o:m>1?c:c.sub(o)._mult(m)._add(o))}function Pe(d,o){let c,f,m,p=!1;for(let v=0;v<d.length;v++){c=d[v];for(let T=0,M=c.length-1;T<c.length;M=T++)f=c[T],m=c[M],f.y>o.y!=m.y>o.y&&o.x<(m.x-f.x)*(o.y-f.y)/(m.y-f.y)+f.x&&(p=!p)}return p}function Ie(d,o){let c=!1;for(let f=0,m=d.length-1;f<d.length;m=f++){const p=d[f],v=d[m];p.y>o.y!=v.y>o.y&&o.x<(v.x-p.x)*(o.y-p.y)/(v.y-p.y)+p.x&&(c=!c)}return c}function Oe(d,o,c,f,m){for(const v of d)if(o<=v.x&&c<=v.y&&f>=v.x&&m>=v.y)return!0;const p=[new xt(o,c),new xt(o,m),new xt(f,m),new xt(f,c)];if(d.length>2){for(const v of p)if(Ie(d,v))return!0}for(let v=0;v<d.length-1;v++)if(ze(d[v],d[v+1],p))return!0;return!1}function ze(d,o,c){const f=c[0],m=c[2];if(d.x<f.x&&o.x<f.x||d.x>m.x&&o.x>m.x||d.y<f.y&&o.y<f.y||d.y>m.y&&o.y>m.y)return!1;const p=Wt(d,o,c[0]);return p!==Wt(d,o,c[1])||p!==Wt(d,o,c[2])||p!==Wt(d,o,c[3])}function Ve(d,o,c,f,m,p){let v=o.y-d.y,T=d.x-o.x;if(p=p||0){const M=v*v+T*T;if(M===0)return!0;const k=Math.sqrt(M);v/=k,T/=k}return!((c.x-d.x)*v+(c.y-d.y)*T-p<0||(f.x-d.x)*v+(f.y-d.y)*T-p<0||(m.x-d.x)*v+(m.y-d.y)*T-p<0)}function dt(d,o,c,f,m,p,v){return!(Ve(d,o,f,m,p,v)||Ve(o,c,f,m,p,v)||Ve(c,d,f,m,p,v)||Ve(f,m,d,o,c,v)||Ve(m,p,d,o,c,v)||Ve(p,f,d,o,c,v))}function rt(d,o,c){const f=o.paint.get(d).value;return f.kind==="constant"?f.value:c.programConfigurations.get(o.id).getMaxValue(d)}function St(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function Tt(d,o,c,f,m){if(!o[0]&&!o[1])return d;const p=xt.convert(o)._mult(m);c==="viewport"&&p._rotate(-f);const v=[];for(let T=0;T<d.length;T++)v.push(d[T].sub(p));return v}function Dt(d,o,c,f){const m=xt.convert(d)._mult(f);return o==="viewport"&&m._rotate(-c),m}let et,wt;Qt(re,"CircleBucket",{omit:["layers"]});var Ke,bt={exports:{}},yt=(Ke||(Ke=1,function(d,o){(function(c){function f(p,v,T){var M=m(256*p,256*(v=Math.pow(2,T)-v-1),T),k=m(256*(p+1),256*(v+1),T);return M[0]+","+M[1]+","+k[0]+","+k[1]}function m(p,v,T){var M=2*Math.PI*6378137/256/Math.pow(2,T);return[p*M-2*Math.PI*6378137/2,v*M-2*Math.PI*6378137/2]}c.getURL=function(p,v,T,M,k,w){return w=w||{},p+"?"+["bbox="+f(T,M,k),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+v].join("&")},c.getTileBBox=f,c.getMercCoords=m,Object.defineProperty(c,"__esModule",{value:!0})})(o)}(0,bt.exports)),bt.exports);class Et{constructor(o,c,f){this.z=o,this.x=c,this.y=f,this.key=Gt(0,o,o,c,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c){const f=yt.getTileBBox(this.x,this.y,this.z),m=function(p,v,T){let M,k="";for(let w=p;w>0;w--)M=1<<w-1,k+=(v&M?1:0)+(T&M?2:0);return k}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ht{constructor(o,c){this.wrap=o,this.canonical=c,this.key=Gt(o,c.z,c.z,c.x,c.y)}}class Ct{constructor(o,c,f,m,p){this.overscaledZ=o,this.wrap=c,this.canonical=new Et(f,+m,+p),this.key=c===0&&o===f?this.canonical.key:Gt(c,o,f,m,p)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const c=this.canonical.z-o;return o>this.canonical.z?new Ct(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ct(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c=!0){if(this.overscaledZ===o&&c)return this.key;if(o>this.canonical.z)return Gt(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-o;return Gt(this.wrap*+c,o,o,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new Ct(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,f=2*this.canonical.x,m=2*this.canonical.y;return[new Ct(c,this.wrap,c,f,m),new Ct(c,this.wrap,c,f+1,m),new Ct(c,this.wrap,c,f,m+1),new Ct(c,this.wrap,c,f+1,m+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Ct(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Ct(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ht(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Gt(d,o,c,f,m){const p=1<<Math.min(c,22);let v=p*(m%p)+f%p;return d&&c<22&&(v+=p*p*((d<0?-2*d-1:2*d)%(1<<2*(22-c)))),16*(32*v+c)+(o-c)}const qt=[d=>{let o=d.canonical.x-1,c=d.wrap;return o<0&&(o=(1<<d.canonical.z)-1,c--),new Ct(d.overscaledZ,c,d.canonical.z,o,d.canonical.y)},d=>{let o=d.canonical.x+1,c=d.wrap;return o===1<<d.canonical.z&&(o=0,c++),new Ct(d.overscaledZ,c,d.canonical.z,o,d.canonical.y)},d=>new Ct(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,(d.canonical.y===0?1<<d.canonical.z:d.canonical.y)-1),d=>new Ct(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y===(1<<d.canonical.z)-1?0:d.canonical.y+1)];Qt(Et,"CanonicalTileID"),Qt(Ct,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Zt=xn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:sr}=Zt,kr=xn([{name:"a_pos_3",components:3,type:"Int16"}]);var xr=xn([{name:"a_pos",type:"Int16",components:2}]);class Pr{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,f){const m=ge.vec2.dot(c,this.dir);if(Math.abs(m)<1e-6)return!1;const p=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1])/m;return f[0]=this.pos[0]+this.dir[0]*p,f[1]=this.pos[1]+this.dir[1]*p,!0}}class Ar{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,f){const m=ge.vec3.dot(c,this.dir);if(Math.abs(m)<1e-6)return!1;const p=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1]+(o[2]-this.pos[2])*c[2])/m;return f[0]=this.pos[0]+this.dir[0]*p,f[1]=this.pos[1]+this.dir[1]*p,f[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(o,c,f){if(ge.vec3.equals(this.pos,o)||c===0)return f[0]=f[1]=f[2]=0,!1;const[m,p,v]=this.dir,T=this.pos[0]-o[0],M=this.pos[1]-o[1],k=this.pos[2]-o[2],w=m*m+p*p+v*v,P=2*(T*m+M*p+k*v),D=P*P-4*w*(T*T+M*M+k*k-c*c);if(D<0){const O=Math.max(-P/2,0),R=T+m*O,N=M+p*O,W=k+v*O,Z=Math.hypot(R,N,W);return f[0]=R*c/Z,f[1]=N*c/Z,f[2]=W*c/Z,!1}{const O=(-P-Math.sqrt(D))/(2*w);if(O<0){const R=Math.hypot(T,M,k);return f[0]=T*c/R,f[1]=M*c/R,f[2]=k*c/R,!1}return f[0]=T+m*O,f[1]=M+p*O,f[2]=k+v*O,!0}}}class nn{constructor(o,c,f,m,p){this.TL=o,this.TR=c,this.BR=f,this.BL=m,this.horizon=p}static fromInvProjectionMatrix(o,c,f){const m=[-1,1,1],p=[1,1,1],v=[1,-1,1],T=[-1,-1,1],M=ge.vec3.transformMat4(m,m,o),k=ge.vec3.transformMat4(p,p,o),w=ge.vec3.transformMat4(v,v,o),P=ge.vec3.transformMat4(T,T,o);return new nn(M,k,w,P,c/f)}}function wn(d,o,c){let f=1/0,m=-1/0;const p=[];for(const v of d){ge.vec3.sub(p,v,o);const T=ge.vec3.dot(p,c);f=Math.min(f,T),m=Math.max(m,T)}return[f,m]}function Kn(d,o){let c=!0;for(let f=0;f<d.planes.length;f++){const m=d.planes[f];let p=0;for(let v=0;v<o.length;v++)p+=ge.vec3.dot(m,o[v])+m[3]>=0;if(p===0)return 0;p!==o.length&&(c=!1)}return c?2:1}function Yr(d,o){for(const c of d.projections){const f=wn(o,d.points[0],c.axis);if(c.projection[1]<f[0]||c.projection[0]>f[1])return 0}return 1}function fi(d,o){let c=0;const f=[0,0,0,0];for(let m=0;m<d.length;m++)f[0]=d[m][0],f[1]=d[m][1],f[2]=d[m][2],f[3]=1,ge.vec4.dot(f,o)>=0&&c++;return c}class Nr{constructor(o,c){this.points=o||new Array(8).fill([0,0,0]),this.planes=c||new Array(6).fill([0,0,0,0]),this.bounds=lr.fromPoints(this.points),this.projections=[],this.frustumEdges=[ge.vec3.sub([],this.points[2],this.points[3]),ge.vec3.sub([],this.points[0],this.points[3]),ge.vec3.sub([],this.points[4],this.points[0]),ge.vec3.sub([],this.points[5],this.points[1]),ge.vec3.sub([],this.points[6],this.points[2]),ge.vec3.sub([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const m=[0,-f[2],f[1]],p=[f[2],0,-f[0]];this.projections.push({axis:m,projection:wn(this.points,this.points[0],m)}),this.projections.push({axis:p,projection:wn(this.points,this.points[0],p)})}}static fromInvProjectionMatrix(o,c,f,m){const p=Math.pow(2,f),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const w=ge.vec4.transformMat4([],k,o),P=1/w[3]/c*p;return ge.vec4.mul(w,w,[P,P,m?1/w[3]:P,P])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const w=ge.vec3.sub([],v[k[0]],v[k[1]]),P=ge.vec3.sub([],v[k[2]],v[k[1]]),D=ge.vec3.normalize([],ge.vec3.cross([],w,P)),O=-ge.vec3.dot(D,v[k[1]]);return D.concat(O)}),M=[];for(let k=0;k<v.length;k++)M.push([v[k][0],v[k][1],v[k][2]]);return new Nr(M,T)}intersectsPrecise(o,c,f){for(let m=0;m<c.length;m++)if(!fi(o,c[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!fi(o,this.planes[m]))return 0;for(const m of f)for(const p of this.frustumEdges){const v=ge.vec3.cross([],m,p),T=ge.vec3.length(v);if(T===0)continue;ge.vec3.scale(v,v,1/T);const M=wn(this.points,this.points[0],v),k=wn(o,this.points[0],v);if(M[0]>k[1]||k[0]>M[1])return 0}return 1}containsPoint(o){for(const c of this.planes){const f=c[3];if(ge.vec3.dot([c[0],c[1],c[2]],o)+f<0)return!1}return!0}}class lr{static fromPoints(o){const c=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const m of o)ge.vec3.min(c,c,m),ge.vec3.max(f,f,m);return new lr(c,f)}static fromTileIdAndHeight(o,c,f){const m=1<<o.canonical.z,p=o.canonical.x,v=o.canonical.y;return new lr([p/m,v/m,c],[(p+1)/m,(v+1)/m,f])}static applyTransform(o,c){const f=o.getCorners();for(let m=0;m<f.length;++m)ge.vec3.transformMat4(f[m],f[m],c);return lr.fromPoints(f)}static applyTransformFast(o,c){const f=[c[12],c[13],c[14]],m=[...f];for(let p=0;p<3;p++)for(let v=0;v<3;v++){const T=c[4*v+p],M=T*o.min[v],k=T*o.max[v];f[p]+=Math.min(M,k),m[p]+=Math.max(M,k)}return new lr(f,m)}static projectAabbCorners(o,c){const f=o.getCorners();for(let m=0;m<f.length;++m)ge.vec3.transformMat4(f[m],f[m],c);return f}constructor(o,c){this.min=o,this.max=c,this.center=ge.vec3.scale([],ge.vec3.add([],this.min,this.max),.5)}quadrant(o){const c=[o%2==0,o<2],f=ge.vec3.clone(this.min),m=ge.vec3.clone(this.max);for(let p=0;p<c.length;p++)f[p]=c[p]?this.min[p]:this.center[p],m[p]=c[p]?this.center[p]:this.max[p];return m[2]=this.max[2],new lr(f,m)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,c=this.max;return[[o[0],o[1],o[2]],[c[0],o[1],o[2]],[c[0],c[1],o[2]],[o[0],c[1],o[2]],[o[0],o[1],c[2]],[c[0],o[1],c[2]],[c[0],c[1],c[2]],[o[0],c[1],c[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?Kn(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?Kn(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,c){return c||this.intersects(o)?Yr(o,this.getCorners()):0}intersectsPreciseFlat(o,c){return c||this.intersectsFlat(o)?Yr(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let c=0;c<3;++c)if(this.min[c]>o.max[c]||o.min[c]>this.max[c])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],o.min[c]),this.max[c]=Math.max(this.max[c],o.max[c])}encapsulatePoint(o){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],o[c]),this.max[c]=Math.max(this.max[c],o[c])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function sn(d){return d*Oa/dh}Qt(lr,"Aabb");const kn=[new lr([Es,Es,Es],[As,As,As]),new lr([Es,Es,Es],[0,0,As]),new lr([0,Es,Es],[As,0,As]),new lr([Es,0,Es],[0,As,As]),new lr([0,0,Es],[As,As,As])];function mn(d,o,c,f=!0){const m=ge.vec3.scale([],d._camera.position,d.worldSize),p=[o,c,1,1];ge.vec4.transformMat4(p,p,d.pixelMatrixInverse),ge.vec4.scale(p,p,1/p[3]);const v=ge.vec3.sub([],p,m),T=ge.vec3.normalize([],v),M=d.globeMatrix,k=[M[12],M[13],M[14]],w=ge.vec3.sub([],k,m),P=ge.vec3.length(w),D=ge.vec3.normalize([],w),O=d.worldSize/(2*Math.PI),R=ge.vec3.dot(D,T),N=Math.asin(O/P);if(N<Math.acos(R)){if(!f)return null;const De=[],Se=[];ge.vec3.scale(De,T,P/R),ge.vec3.normalize(Se,ge.vec3.sub(Se,De,w)),ge.vec3.normalize(T,ge.vec3.add(T,w,ge.vec3.scale(T,Se,Math.tan(N)*P)))}const W=[];new Ar(m,T).closestPointOnSphere(k,O,W);const Z=ge.vec3.normalize([],Xi(M,0)),te=ge.vec3.normalize([],Xi(M,1)),ee=ge.vec3.normalize([],Xi(M,2)),K=ge.vec3.dot(Z,W),ie=ge.vec3.dot(te,W),le=ge.vec3.dot(ee,W),he=vt(Math.asin(-ie/O));let we=vt(Math.atan2(K,le));we=d.center.lng+function(De,Se){const Le=(Se-De+180)%360-180;return Le<-180?Le+360:Le}(d.center.lng,we);const _e=fc(we),xe=Yt(es(he),0,1);return new s(_e,xe)}class Mi{constructor(o,c,f){this.a=ge.vec3.sub([],o,f),this.b=ge.vec3.sub([],c,f),this.center=f;const m=ge.vec3.normalize([],this.a),p=ge.vec3.normalize([],this.b);this.angle=Math.acos(ge.vec3.dot(m,p))}}function Yi(d,o){if(d.angle===0)return null;let c;return c=d.a[o]===0?1/d.angle*.5*Math.PI:1/d.angle*Math.atan(d.b[o]/d.a[o]/Math.sin(d.angle)-1/Math.tan(d.angle)),c<0||c>1?null:function(f,m,p,v){const T=Math.sin(p);return f*(Math.sin((1-v)*p)/T)+m*(Math.sin(v*p)/T)}(d.a[o],d.b[o],d.angle,Yt(c,0,1))+d.center[o]}function yo(d){if(d.z<=1)return kn[d.z+2*d.y+d.x];const o=pi(hn(d));return lr.fromPoints(o)}function To(d,o,c){return ge.vec3.scale(d,d,1-c),ge.vec3.scaleAndAdd(d,d,o,c)}function Cs(d,o,c){for(const f of d)ge.vec3.transformMat4(f,f,o),ge.vec3.scale(f,f,c)}function pa(d,o,c,f){const m=o/d.worldSize,p=d.globeMatrix;if(c.z<=1){const _e=yo(c).getCorners();return Cs(_e,p,m),lr.fromPoints(_e)}const v=hn(c,f),T=pi(v,Oa+sn(d._tileCoverLift));Cs(T,p,m);const M=Number.MAX_VALUE,k=[-M,-M,-M],w=[M,M,M];if(v.contains(d.center)){for(const De of T)ge.vec3.min(w,w,De),ge.vec3.max(k,k,De);k[2]=0;const _e=d.point,xe=[_e.x*m,_e.y*m,0];return ge.vec3.min(w,w,xe),ge.vec3.max(k,k,xe),new lr(w,k)}if(d._tileCoverLift>0){for(const _e of T)ge.vec3.min(w,w,_e),ge.vec3.max(k,k,_e);return new lr(w,k)}const P=[p[12]*m,p[13]*m,p[14]*m],D=v.getCenter(),O=Yt(d.center.lat,-Bi,Bi),R=Yt(D.lat,-Bi,Bi),N=fc(d.center.lng),W=es(O);let Z=N-fc(D.lng);const te=W-es(R);Z>.5?Z-=1:Z<-.5&&(Z+=1);let ee=0;if(Math.abs(Z)>Math.abs(te))ee=Z>=0?1:3;else{ee=te>=0?0:2;const _e=[p[4]*m,p[5]*m,p[6]*m],xe=-Math.sin(Ge(te>=0?v.getSouth():v.getNorth()))*Oa;ge.vec3.scaleAndAdd(P,P,_e,xe)}const K=T[ee],ie=T[(ee+1)%4],le=new Mi(K,ie,P),he=[Yi(le,0)||K[0],Yi(le,1)||K[1],Yi(le,2)||K[2]],we=Va(d.zoom);if(we>0){const _e=function({x:De,y:Se,z:Le},We,Ue,Xe,He){const nt=1/(1<<Le);let Je=De*nt,it=Je+nt,Mt=Se*nt,At=Mt+nt,er=0;const Rt=(Je+it)/2-Xe;return Rt>.5?er=-1:Rt<-.5&&(er=1),Je=((Je+er)*We-(Xe*=We))*Ue+Xe,it=((it+er)*We-Xe)*Ue+Xe,Mt=(Mt*We-(He*=We))*Ue+He,At=(At*We-He)*Ue+He,[[Je,At,0],[it,At,0],[it,Mt,0],[Je,Mt,0]]}(c,o,d._pixelsPerMercatorPixel,N,W);for(let De=0;De<T.length;De++)To(T[De],_e[De],we);const xe=ge.vec3.add([],_e[ee],_e[(ee+1)%4]);ge.vec3.scale(xe,xe,.5),To(he,xe,we)}for(const _e of T)ge.vec3.min(w,w,_e),ge.vec3.max(k,k,_e);return w[2]=Math.min(K[2],ie[2]),ge.vec3.min(w,w,he),ge.vec3.max(k,k,he),new lr(w,k)}function hn({x:d,y:o,z:c},f=!1){const m=1/(1<<c),p=new bn(ts(d*m),o===(1<<c)-1&&f?-90:Ho((o+1)*m)),v=new bn(ts((d+1)*m),o===0&&f?90:Ho(o*m));return new sd(p,v)}function pi(d,o=Oa){const c=Ge(d.getNorth()),f=Ge(d.getSouth()),m=Math.cos(c),p=Math.cos(f),v=Math.sin(c),T=Math.sin(f),M=d.getWest(),k=d.getEast();return[Qf(p,T,M,o),Qf(p,T,k,o),Qf(m,v,k,o),Qf(m,v,M,o)]}function Sn(d,o,c,f){const m=1<<c.z,p=(d/$t+c.x)/m;return uh(Ho((o/$t+c.y)/m),ts(p),f)}function $n({min:d,max:o}){return rA/Math.max(o[0]-d[0],o[1]-d[1],o[2]-d[2])}const Zo=new Float64Array(16);function si(d){const o=$n(d),c=ge.mat4.fromScaling(Zo,[o,o,o]);return ge.mat4.translate(c,c,ge.vec3.negate([],d.min))}function vo(d){const o=ge.mat4.fromTranslation(Zo,d.min),c=1/$n(d);return ge.mat4.scale(o,o,[c,c,c])}function pc(d){const o=$t/(2*Math.PI);return d/(2*Math.PI)/o}function rs(d,o){return $t/(512*Math.pow(2,d))*$n(yo(o))}function tl(d,o,c,f,m){const p=pc(c),v=[d,o,-c/(2*Math.PI)],T=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(T,T,v),ge.mat4.scale(T,T,[p,p,p]),ge.mat4.rotateX(T,T,Ge(-m)),ge.mat4.rotateY(T,T,Ge(-f)),T}function Va(d){return Zr(Kf,tA,d)}function rl(d,o){const c=uh(o.lat,o.lng),f=function(p){const v=uh(p._center.lat,p._center.lng),T=ge.vec3.fromValues(0,1,0);let M=ge.vec3.cross([],T,v);const k=ge.mat4.fromRotation([],-p.angle,v);M=ge.vec3.transformMat4(M,M,k),ge.mat4.fromRotation(k,-p._pitch,M);const w=ge.vec3.normalize([],v);return ge.vec3.scale(w,w,sn(p.cameraToCenterDistance/p.pixelsPerMeter)),ge.vec3.transformMat4(w,w,k),ge.vec3.add([],v,w)}(d),m=ge.vec3.subtract([],f,c);return ge.vec3.angle(m,c)}function ns(d,o){return rl(d,o)>Math.PI/2*1.01}const ru=Ge(85),mc=Math.cos(ru),nu=Math.sin(ru),R1=ge.mat4.create(),ep=d=>{const o=[];return d.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function e_(d,o,c,f,m,p,v,T,M){if(p&&d.queryGeometry.isAboveHorizon)return!1;p&&(M*=d.pixelToTileUnitsFactor);const k=d.tileID.canonical,w=c.projection.upVectorScale(k,c.center.lat,c.worldSize).metersToTile;for(const P of o)for(const D of P){const O=D.add(T),R=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(O.x,O.y,!0):0,N=c.projection.projectTilePoint(O.x,O.y,k);if(R>0){const ee=c.projection.upVector(k,O.x,O.y);N.x+=ee[0]*w*R,N.y+=ee[1]*w*R,N.z+=ee[2]*w*R}const W=p?O:D1(N.x,N.y,N.z,f),Z=p?d.tilespaceRays.map(ee=>oue(ee,R)):d.queryGeometry.screenGeometry,te=ge.vec4.transformMat4([],[N.x,N.y,N.z,1],f);if(!v&&p?M*=te[3]/c.cameraToCenterDistance:v&&!p&&(M*=c.cameraToCenterDistance/te[3]),p){const ee=Ho((D.y/$t+k.y)/(1<<k.z));M/=c.projection.pixelsPerMeter(ee,1)/ta(1,ee)}if(se(Z,W,M))return!0}return!1}function D1(d,o,c,f){const m=ge.vec4.transformMat4([],[d,o,c,1],f);return new xt(m[0]/m[3],m[1]/m[3])}const d6=ge.vec3.fromValues(0,0,0),iue=ge.vec3.fromValues(0,0,1);function oue(d,o){const c=ge.vec3.create();return d6[2]=o,d.intersectsPlane(d6,iue,c),new xt(c[0],c[1])}class h6 extends re{}let f6,p6,m6,g6;function y6(d,{width:o,height:c},f,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==o*c*f)throw new RangeError("mismatched image size")}else m=new Uint8Array(o*c*f);return d.width=o,d.height=c,d.data=m,d}function v6(d,o,c){const{width:f,height:m}=o;f===d.width&&m===d.height||(jD(d,o,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,f),height:Math.min(d.height,m)},c,null),d.width=f,d.height=m,d.data=o.data)}function jD(d,o,c,f,m,p,v,T){if(m.width===0||m.height===0)return o;if(m.width>d.width||m.height>d.height||c.x>d.width-m.width||c.y>d.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>o.width||m.height>o.height||f.x>o.width-m.width||f.y>o.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const M=d.data,k=o.data,w=p===4&&T;for(let P=0;P<m.height;P++){const D=((c.y+P)*d.width+c.x)*p,O=((f.y+P)*o.width+f.x)*p;if(w)for(let R=0;R<m.width;R++){const N=D+R*p+3,W=O+R*p;k[W+0]=255,k[W+1]=255,k[W+2]=255,k[W+3]=M[N]}else if(v)for(let R=0;R<m.width;R++){const N=D+R*p,W=O+R*p,Z=M[N+3],te=new On(M[N+0]/255*Z,M[N+1]/255*Z,M[N+2]/255*Z,Z).toRenderColor(v).toArray();k[W+0]=te[0],k[W+1]=te[1],k[W+2]=te[2],k[W+3]=te[3]}else for(let R=0;R<m.width*p;R++)k[O+R]=M[D+R]}return o}Qt(h6,"HeatmapBucket",{omit:["layers"]});class tp{constructor(o,c){y6(this,o,1,c)}resize(o){v6(this,new tp(o),1)}clone(){return new tp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,f,m,p){jD(o,c,f,m,p,1,null)}}class ra{constructor(o,c){y6(this,o,4,c)}resize(o){v6(this,new ra(o),4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new ra({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,f,m,p,v,T){jD(o,c,f,m,p,4,v,T)}}class _6{constructor(o,c){this.width=o.width,this.height=o.height,this.data=c instanceof Uint8Array?new Float32Array(c.buffer):c}}function L1(d){const o={},c=d.resolution||256,f=d.clips?d.clips.length:1,m=d.image||new ra({width:c,height:f}),p=(v,T,M)=>{o[d.evaluationKey]=M;const k=d.expression.evaluate(o);k&&(m.data[v+T+0]=Math.floor(255*k.r/k.a),m.data[v+T+1]=Math.floor(255*k.g/k.a),m.data[v+T+2]=Math.floor(255*k.b/k.a),m.data[v+T+3]=Math.floor(255*k.a))};if(d.clips)for(let v=0,T=0;v<f;++v,T+=4*c)for(let M=0,k=0;M<c;M++,k+=4){const w=M/(c-1),{start:P,end:D}=d.clips[v];p(T,k,P*(1-w)+D*w)}else for(let v=0,T=0;v<c;v++,T+=4)p(0,T,v/(c-1));return m}Qt(tp,"AlphaImage"),Qt(ra,"RGBAImage");const aue=xn([{name:"a_pos",components:2,type:"Int16"}],4),sue=xn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),lue=xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),cue=xn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function N1(d,o,c=2){const f=o&&o.length,m=f?o[0]*c:d.length;let p=x6(d,0,m,c,!0);const v=[];if(!p||p.next===p.prev)return v;let T,M,k;if(f&&(p=function(w,P,D,O){const R=[];for(let N=0,W=P.length;N<W;N++){const Z=x6(w,P[N]*O,N<W-1?P[N+1]*O:w.length,O,!1);Z===Z.next&&(Z.steiner=!0),R.push(yue(Z))}R.sort(pue);for(let N=0;N<R.length;N++)D=mue(R[N],D);return D}(d,o,p,c)),d.length>80*c){T=1/0,M=1/0;let w=-1/0,P=-1/0;for(let D=c;D<m;D+=c){const O=d[D],R=d[D+1];O<T&&(T=O),R<M&&(M=R),O>w&&(w=O),R>P&&(P=R)}k=Math.max(w-T,P-M),k=k!==0?32767/k:0}return z1(p,v,c,T,M,k,0),v}function x6(d,o,c,f,m){let p;if(m===function(v,T,M,k){let w=0;for(let P=T,D=M-k;P<M;P+=k)w+=(v[D]-v[P])*(v[P+1]+v[D+1]),D=P;return w}(d,o,c,f)>0)for(let v=o;v<c;v+=f)p=S6(v/f|0,d[v],d[v+1],p);else for(let v=c-f;v>=o;v-=f)p=S6(v/f|0,d[v],d[v+1],p);return p&&iA(p,p.next)&&(F1(p),p=p.next),p}function Sg(d,o){if(!d)return d;o||(o=d);let c,f=d;do if(c=!1,f.steiner||!iA(f,f.next)&&Eo(f.prev,f,f.next)!==0)f=f.next;else{if(F1(f),f=o=f.prev,f===f.next)break;c=!0}while(c||f!==o);return o}function z1(d,o,c,f,m,p,v){if(!d)return;!v&&p&&function(M,k,w,P){let D=M;do D.z===0&&(D.z=FD(D.x,D.y,k,w,P)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==M);D.prevZ.nextZ=null,D.prevZ=null,function(O){let R,N=1;do{let W,Z=O;O=null;let te=null;for(R=0;Z;){R++;let ee=Z,K=0;for(let le=0;le<N&&(K++,ee=ee.nextZ,ee);le++);let ie=N;for(;K>0||ie>0&&ee;)K!==0&&(ie===0||!ee||Z.z<=ee.z)?(W=Z,Z=Z.nextZ,K--):(W=ee,ee=ee.nextZ,ie--),te?te.nextZ=W:O=W,W.prevZ=te,te=W;Z=ee}te.nextZ=null,N*=2}while(R>1)}(D)}(d,f,m,p);let T=d;for(;d.prev!==d.next;){const M=d.prev,k=d.next;if(p?due(d,f,m,p):uue(d))o.push(M.i,d.i,k.i),F1(d),d=k.next,T=k.next;else if((d=k)===T){v?v===1?z1(d=hue(Sg(d),o),o,c,f,m,p,2):v===2&&fue(d,o,c,f,m,p):z1(Sg(d),o,c,f,m,p,1);break}}}function uue(d){const o=d.prev,c=d,f=d.next;if(Eo(o,c,f)>=0)return!1;const m=o.x,p=c.x,v=f.x,T=o.y,M=c.y,k=f.y,w=m<p?m<v?m:v:p<v?p:v,P=T<M?T<k?T:k:M<k?M:k,D=m>p?m>v?m:v:p>v?p:v,O=T>M?T>k?T:k:M>k?M:k;let R=f.next;for(;R!==o;){if(R.x>=w&&R.x<=D&&R.y>=P&&R.y<=O&&t_(m,T,p,M,v,k,R.x,R.y)&&Eo(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function due(d,o,c,f){const m=d.prev,p=d,v=d.next;if(Eo(m,p,v)>=0)return!1;const T=m.x,M=p.x,k=v.x,w=m.y,P=p.y,D=v.y,O=T<M?T<k?T:k:M<k?M:k,R=w<P?w<D?w:D:P<D?P:D,N=T>M?T>k?T:k:M>k?M:k,W=w>P?w>D?w:D:P>D?P:D,Z=FD(O,R,o,c,f),te=FD(N,W,o,c,f);let ee=d.prevZ,K=d.nextZ;for(;ee&&ee.z>=Z&&K&&K.z<=te;){if(ee.x>=O&&ee.x<=N&&ee.y>=R&&ee.y<=W&&ee!==m&&ee!==v&&t_(T,w,M,P,k,D,ee.x,ee.y)&&Eo(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,K.x>=O&&K.x<=N&&K.y>=R&&K.y<=W&&K!==m&&K!==v&&t_(T,w,M,P,k,D,K.x,K.y)&&Eo(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;ee&&ee.z>=Z;){if(ee.x>=O&&ee.x<=N&&ee.y>=R&&ee.y<=W&&ee!==m&&ee!==v&&t_(T,w,M,P,k,D,ee.x,ee.y)&&Eo(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;K&&K.z<=te;){if(K.x>=O&&K.x<=N&&K.y>=R&&K.y<=W&&K!==m&&K!==v&&t_(T,w,M,P,k,D,K.x,K.y)&&Eo(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function hue(d,o){let c=d;do{const f=c.prev,m=c.next.next;!iA(f,m)&&b6(f,c,c.next,m)&&j1(f,m)&&j1(m,f)&&(o.push(f.i,c.i,m.i),F1(c),F1(c.next),c=d=m),c=c.next}while(c!==d);return Sg(c)}function fue(d,o,c,f,m,p){let v=d;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&vue(v,T)){let M=w6(v,T);return v=Sg(v,v.next),M=Sg(M,M.next),z1(v,o,c,f,m,p,0),void z1(M,o,c,f,m,p,0)}T=T.next}v=v.next}while(v!==d)}function pue(d,o){return d.x-o.x}function mue(d,o){const c=function(m,p){let v=p;const T=m.x,M=m.y;let k,w=-1/0;do{if(M<=v.y&&M>=v.next.y&&v.next.y!==v.y){const N=v.x+(M-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(N<=T&&N>w&&(w=N,k=v.x<v.next.x?v:v.next,N===T))return k}v=v.next}while(v!==p);if(!k)return null;const P=k,D=k.x,O=k.y;let R=1/0;v=k;do{if(T>=v.x&&v.x>=D&&T!==v.x&&t_(M<O?T:w,M,D,O,M<O?w:T,M,v.x,v.y)){const N=Math.abs(M-v.y)/(T-v.x);j1(v,m)&&(N<R||N===R&&(v.x>k.x||v.x===k.x&&gue(k,v)))&&(k=v,R=N)}v=v.next}while(v!==P);return k}(d,o);if(!c)return o;const f=w6(c,d);return Sg(f,f.next),Sg(c,c.next)}function gue(d,o){return Eo(d.prev,d,o.prev)<0&&Eo(o.next,d,d.next)<0}function FD(d,o,c,f,m){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-c)*m|0)|d<<8))|d<<4))|d<<2))|d<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function yue(d){let o=d,c=d;do(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next;while(o!==d);return c}function t_(d,o,c,f,m,p,v,T){return(m-v)*(o-T)>=(d-v)*(p-T)&&(d-v)*(f-T)>=(c-v)*(o-T)&&(c-v)*(p-T)>=(m-v)*(f-T)}function vue(d,o){return d.next.i!==o.i&&d.prev.i!==o.i&&!function(c,f){let m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==f.i&&m.next.i!==f.i&&b6(m,m.next,c,f))return!0;m=m.next}while(m!==c);return!1}(d,o)&&(j1(d,o)&&j1(o,d)&&function(c,f){let m=c,p=!1;const v=(c.x+f.x)/2,T=(c.y+f.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&v<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(p=!p),m=m.next;while(m!==c);return p}(d,o)&&(Eo(d.prev,d,o.prev)||Eo(d,o.prev,o))||iA(d,o)&&Eo(d.prev,d,d.next)>0&&Eo(o.prev,o,o.next)>0)}function Eo(d,o,c){return(o.y-d.y)*(c.x-o.x)-(o.x-d.x)*(c.y-o.y)}function iA(d,o){return d.x===o.x&&d.y===o.y}function b6(d,o,c,f){const m=aA(Eo(d,o,c)),p=aA(Eo(d,o,f)),v=aA(Eo(c,f,d)),T=aA(Eo(c,f,o));return m!==p&&v!==T||!(m!==0||!oA(d,c,o))||!(p!==0||!oA(d,f,o))||!(v!==0||!oA(c,d,f))||!(T!==0||!oA(c,o,f))}function oA(d,o,c){return o.x<=Math.max(d.x,c.x)&&o.x>=Math.min(d.x,c.x)&&o.y<=Math.max(d.y,c.y)&&o.y>=Math.min(d.y,c.y)}function aA(d){return d>0?1:d<0?-1:0}function j1(d,o){return Eo(d.prev,d,d.next)<0?Eo(d,o,d.next)>=0&&Eo(d,d.prev,o)>=0:Eo(d,o,d.prev)<0||Eo(d,d.next,o)<0}function w6(d,o){const c=BD(d.i,d.x,d.y),f=BD(o.i,o.x,o.y),m=d.next,p=o.prev;return d.next=o,o.prev=d,c.next=m,m.prev=c,f.next=c,c.prev=f,p.next=f,f.prev=p,f}function S6(d,o,c,f){const m=BD(d,o,c);return f?(m.next=f.next,m.prev=f,f.next.prev=m,f.next=m):(m.prev=m,m.next=m),m}function F1(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function BD(d,o,c){return{i:d,x:o,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function sA(d,o){const c=d.length;if(c<=1)return[d];const f=[];let m,p;for(let v=0;v<c;v++){const T=Hr(d[v]);T!==0&&(d[v].area=Math.abs(T),p===void 0&&(p=T<0),p===T<0?(m&&f.push(m),m=[d[v]]):m.push(d[v]))}if(m&&f.push(m),o>1)for(let v=0;v<f.length;v++)f[v].length<=o||(h2(f[v],o,1,f[v].length-1,_ue),f[v]=f[v].slice(0,o));return f}function _ue(d,o){return o.area-d.area}function T6(d,o,c=1){if(!d)return null;const f=typeof d=="string"?fa.from(d).getPrimary():d.getPrimary(),m=f.id.toString();return o.has(m)||o.set(m,[]),f.scaleSelf(c),o.get(m).push(f),f.toString()}function $D(d,o,c,f){const m=f.patternDependencies;let p=!1;for(const v of o){const T=v.paint.get(`${d}-pattern`);T.isConstant()||(p=!0),T6(T.constantOr(null),m,c)&&(p=!0)}return p}function UD(d,o,c,f,m,p){const v=p.patternDependencies;for(const T of o){const M=T.paint.get(`${d}-pattern`).value;if(M.kind!=="constant"){let k=M.evaluate({zoom:f},c,{},p.availableImages);k=k&&k.name?k.name:k;const w=T6(k,v,m);w&&(c.patterns[T.id]=w)}}return c}var VD,E6,WD,A6,GD,C6,M6,lA={};function P6(){if(E6)return VD;E6=1;var d=tr();function o(m,p,v,T,M){this.properties={},this.extent=v,this.type=0,this._pbf=m,this._geometry=-1,this._keys=T,this._values=M,m.readFields(c,this,p)}function c(m,p,v){m==1?p.id=v.readVarint():m==2?function(T,M){for(var k=T.readVarint()+T.pos;T.pos<k;){var w=M._keys[T.readVarint()],P=M._values[T.readVarint()];M.properties[w]=P}}(v,p):m==3?p.type=v.readVarint():m==4&&(p._geometry=v.pos)}function f(m){for(var p,v,T=0,M=0,k=m.length,w=k-1;M<k;w=M++)T+=((v=m[w]).x-(p=m[M]).x)*(p.y+v.y);return T}return VD=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var p,v=m.readVarint()+m.pos,T=1,M=0,k=0,w=0,P=[];m.pos<v;){if(M<=0){var D=m.readVarint();T=7&D,M=D>>3}if(M--,T===1||T===2)k+=m.readSVarint(),w+=m.readSVarint(),T===1&&(p&&P.push(p),p=[]),p.push(new d(k,w));else{if(T!==7)throw new Error("unknown command "+T);p&&p.push(p[0].clone())}}return p&&P.push(p),P},o.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var p=m.readVarint()+m.pos,v=1,T=0,M=0,k=0,w=1/0,P=-1/0,D=1/0,O=-1/0;m.pos<p;){if(T<=0){var R=m.readVarint();v=7&R,T=R>>3}if(T--,v===1||v===2)(M+=m.readSVarint())<w&&(w=M),M>P&&(P=M),(k+=m.readSVarint())<D&&(D=k),k>O&&(O=k);else if(v!==7)throw new Error("unknown command "+v)}return[w,D,P,O]},o.prototype.toGeoJSON=function(m,p,v){var T,M,k=this.extent*Math.pow(2,v),w=this.extent*m,P=this.extent*p,D=this.loadGeometry(),O=o.types[this.type];function R(Z){for(var te=0;te<Z.length;te++){var ee=Z[te];Z[te]=[360*(ee.x+w)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+P)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(T=0;T<D.length;T++)N[T]=D[T][0];R(D=N);break;case 2:for(T=0;T<D.length;T++)R(D[T]);break;case 3:for(D=function(Z){var te=Z.length;if(te<=1)return[Z];for(var ee,K,ie=[],le=0;le<te;le++){var he=f(Z[le]);he!==0&&(K===void 0&&(K=he<0),K===he<0?(ee&&ie.push(ee),ee=[Z[le]]):ee.push(Z[le]))}return ee&&ie.push(ee),ie}(D),T=0;T<D.length;T++)for(M=0;M<D[T].length;M++)R(D[T][M])}D.length===1?D=D[0]:O="Multi"+O;var W={type:"Feature",geometry:{type:O,coordinates:D},properties:this.properties};return"id"in this&&(W.id=this.id),W},VD}function I6(){if(A6)return WD;A6=1;var d=P6();function o(f,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(c,this,m),this.length=this._features.length}function c(f,m,p){f===15?m.version=p.readVarint():f===1?m.name=p.readString():f===5?m.extent=p.readVarint():f===2?m._features.push(p.pos):f===3?m._keys.push(p.readString()):f===4&&m._values.push(function(v){for(var T=null,M=v.readVarint()+v.pos;v.pos<M;){var k=v.readVarint()>>3;T=k===1?v.readString():k===2?v.readFloat():k===3?v.readDouble():k===4?v.readVarint64():k===5?v.readVarint():k===6?v.readSVarint():k===7?v.readBoolean():null}return T}(p))}return WD=o,o.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var m=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,m,this.extent,this._keys,this._values)},WD}function O6(){return M6||(M6=1,lA.VectorTile=function(){if(C6)return GD;C6=1;var d=I6();function o(c,f,m){if(c===3){var p=new d(m,m.readVarint()+m.pos);p.length&&(f[p.name]=p)}}return GD=function(c,f){this.layers=c.readFields(o,{},f)},GD}(),lA.VectorTileFeature=P6(),lA.VectorTileLayer=I6()),lA}var rp=O6();const Tg="3d_elevation_id",k6="level";class xue{constructor(){this._valid=!1}reset(o){return this.feature=o,this._valid=!0,this._geometry=o.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(o,c){return this._valid&&o(c(this._geometry)),this}require(o,c,f){return this.get(o,!0,c,f)}optional(o,c,f){return this.get(o,!1,c,f)}success(){return this._valid}get(o,c,f,m){const p=this.feature.properties.hasOwnProperty(o)?+this.feature.properties[o]:void 0;return this._valid&&p!==void 0?f(m?m(p):p):c&&(this._valid=!1),this}}class R6{constructor(o,c){this.featureFunc=o,this.vertexFunc=c}parseFeature(o,c,f){return this.featureFunc(o,c,f)}parseVertex(o,c,f){return this.vertexFunc(o,c,f)}}const bue=new R6((d,o,c)=>d.reset(o).require(Tg,f=>{c.id=f}).optional("fixed_height_relative",f=>{c.constantHeight=f},hh.decodeRelativeHeight).geometry(f=>{c.bounds=f},hh.computeBounds).success(),(d,o,c)=>d.reset(o).require(Tg,f=>{c.id=f}).require("elevation_idx",f=>{c.idx=f}).require("extent",f=>{c.extent=f}).require("height_relative",f=>{c.height=f},hh.decodeRelativeHeight).geometry(f=>{c.position=f},hh.getPoint).success()),wue=new R6((d,o,c)=>d.reset(o).require(Tg,f=>{c.id=f}).optional("fixed_height",f=>{c.constantHeight=f},hh.decodeMetricHeight).geometry(f=>{c.bounds=f},hh.computeBounds).success(),(d,o,c)=>d.reset(o).require(Tg,f=>{c.id=f}).require("elevation_idx",f=>{c.idx=f}).require("extent",f=>{c.extent=f}).require("height",f=>{c.height=f},hh.decodeMetricHeight).geometry(f=>{c.position=f},hh.getPoint).success());class hh{static computeBounds(o){const c=new xt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),f=new xt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const m of o[0])c.x>m.x&&(c.x=m.x),c.y>m.y&&(c.y=m.y),f.x<m.x&&(f.x=m.x),f.y<m.y&&(f.y=m.y);return{min:c,max:f}}static getPoint(o){return ge.vec2.fromValues(o[0][0].x,o[0][0].y)}static decodeRelativeHeight(o){return 1e-4*o*5}static decodeMetricHeight(o){return 1e-4*o}static parse(o){const c=[],f=[],m=o.length,p=new xue;for(let T=0;T<m;T++){const M=o.feature(T),k=M.properties.hasOwnProperty("version")?String(M.properties.version):void 0,w=(v=k)?v==="1.0.1"?wue:void 0:bue;if(w===void 0){ai(`Unknown elevation feature version number ${k||"(unknown)"}`);continue}const P=M.properties.hasOwnProperty("type")?M.properties.type:void 0;if(P){if(rp.VectorTileFeature.types[M.type]==="Point"&&P==="curve_point"){const D={};w.parseVertex(p,M,D)&&c.push(D)}else if(rp.VectorTileFeature.types[M.type]==="Polygon"&&P==="curve_meta"){const D={};w.parseFeature(p,M,D)&&f.push(D)}}}var v;return{vertices:c,features:f}}}class qD{constructor(o,c,f,m,p,v){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=o,this.heightRange={min:f,max:f},this.safeArea=c,this.constantHeight=f,this.constantHeight==null&&(this.constantHeight!=null||m.length!==0)){this.vertices=m,this.edges=p,this.edges=this.edges.filter(T=>T.a<this.vertices.length&&T.b<this.vertices.length&&!ge.vec2.exactEquals(this.vertices[T.a].position,this.vertices[T.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const T of this.vertices)this.vertexProps.push({dir:ge.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,T.height),this.heightRange.max=Math.max(this.heightRange.max,T.height);for(const T of this.edges){const M=this.vertices[T.a].position,k=this.vertices[T.b].position,w=ge.vec2.subtract(ge.vec2.create(),k,M),P=ge.vec2.length(w),D=ge.vec2.scale(ge.vec2.create(),w,1/P);this.edgeProps.push({vec:w,dir:D,len:P});const O=this.vertexProps[T.a].dir,R=this.vertexProps[T.b].dir;ge.vec2.add(O,O,D),ge.vec2.add(R,R,D)}for(const T of this.vertexProps)T.dir[0]===0&&T.dir[1]===0||ge.vec2.normalize(T.dir,T.dir);this.tessellate(v)}}pointElevation(o){if(this.constantHeight!=null)return this.constantHeight;const c=this.getClosestEdge(o);if(c==null)return 0;const[f,m]=c;return((p,v,T)=>(1-T)*p+T*v)(this.vertices[this.edges[f].a].height,this.vertices[this.edges[f].b].height,m)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(o){if(this.edges.length===0)return;let c=0,f=Number.POSITIVE_INFINITY,m=0;const p=ge.vec2.fromValues(o.x,o.y);for(let v=0;v<this.edges.length;v++){const T=this.edges[v],M=this.edgeProps[v].dir,k=new Pr(p,this.edgeProps[v].dir),w=this.vertices[T.a].position,P=this.vertices[T.b].position,D=ge.vec2.create(),O=ge.vec2.create(),R=k.intersectsPlane(w,this.vertexProps[T.a].dir,D),N=k.intersectsPlane(P,this.vertexProps[T.b].dir,O);if(!R||!N)continue;const W=ge.vec2.subtract(ge.vec2.create(),O,D),Z=ge.vec2.subtract(ge.vec2.create(),p,D),te=ge.vec2.dot(W,W),ee=te>0?ge.vec2.dot(Z,W)/te:0,K=Yt(ee,0,1),ie=Math.abs((ee-K)*this.edgeProps[v].len),le=ge.vec2.subtract(ge.vec2.create(),p,w),he=ie+Math.abs(ge.vec2.dot(le,ge.vec2.fromValues(M[1],-M[0])));he<f&&(c=v,f=he,m=K)}return[c,m]}tessellate(o){for(let c=this.edges.length-1;c>=0;--c){const f=this.edges[c].a,m=this.edges[c].b,{position:p,height:v,extent:T}=this.vertices[f],{position:M,height:k,extent:w}=this.vertices[m],P=this.vertexProps[f].dir,D=this.vertexProps[m].dir,O=ge.vec3.fromValues(p[0]/o,p[1]/o,v),R=ge.vec3.fromValues(M[0]/o,M[1]/o,k),N=ge.vec3.fromValues(P[1],-P[0],0);ge.vec3.scale(N,N,T);const W=ge.vec3.fromValues(D[1],-D[0],0);if(ge.vec3.scale(W,W,w),this.distSqLines(ge.vec3.fromValues(O[0]+.5*N[0],O[1]+.5*N[1],O[2]+.5*N[2]),ge.vec3.fromValues(R[0]-.5*W[0],R[1]-.5*W[1],R[2]-.5*W[2]),ge.vec3.fromValues(O[0]-.5*N[0],O[1]-.5*N[1],O[2]-.5*N[2]),ge.vec3.fromValues(R[0]+.5*W[0],R[1]+.5*W[1],R[2]+.5*W[2]))<=.05*.05)continue;const Z=this.vertices.length,te=ge.vec2.add(ge.vec2.create(),p,M);this.vertices.push({position:ge.vec2.scale(te,te,.5),height:.5*(v+k),extent:.5*(T+w)});const ee=ge.vec2.add(ge.vec2.create(),P,D);this.vertexProps.push({dir:ge.vec2.normalize(ee,ee)}),this.edges.splice(c,1),this.edgeProps.splice(c,1),this.edges.push({a:f,b:Z}),this.edges.push({a:Z,b:m});const K=ge.vec2.subtract(ge.vec2.create(),this.vertices[Z].position,p),ie=ge.vec2.length(K),le={vec:K,dir:ge.vec2.scale(ge.vec2.create(),K,1/ie),len:ie};this.edgeProps.push(le),this.edgeProps.push(le)}}distSqLines(o,c,f,m){const p=ge.vec3.subtract(ge.vec3.create(),c,o),v=ge.vec3.subtract(ge.vec3.create(),m,f),T=ge.vec3.subtract(ge.vec3.create(),o,f),M=ge.vec3.dot(p,p),k=ge.vec3.dot(p,v),w=ge.vec3.dot(p,T),P=ge.vec3.dot(v,v),D=ge.vec3.dot(v,T),O=M*P-k*k;if(O===0){const te=ge.vec3.dot(T,v)/ge.vec3.dot(v,v),ee=ge.vec3.lerp(ge.vec3.create(),f,m,te);return ge.vec3.squaredDistance(ee,o)}const R=(k*D-w*P)/O,N=(M*D-k*w)/O,W=ge.vec3.lerp(ge.vec3.create(),o,c,R),Z=ge.vec3.lerp(ge.vec3.create(),f,m,N);return ge.vec3.squaredDistance(W,Z)}}class Sue{constructor(o,c){this.zScale=1,this.xOffset=0,this.yOffset=0,o.equals(c)||(this.zScale=Math.pow(2,c.z-o.z),this.xOffset=(o.x*this.zScale-c.x)*$t,this.yOffset=(o.y*this.zScale-c.y)*$t)}constantElevation(o,c){if(o.constantHeight!=null)return this.computeBiasedHeight(o.constantHeight,c)}pointElevation(o,c,f){const m=this.constantElevation(c,f);return m??(o.x=o.x*this.zScale+this.xOffset,o.y=o.y*this.zScale+this.yOffset,this.computeBiasedHeight(c.pointElevation(o),f))}computeBiasedHeight(o,c){return c<=0?o:o+c*Zr(0,c,o>=0?o:Math.abs(.5*o))}}Qt(qD,"ElevationFeature");class D6{constructor(){this.polygons=new Map}add(o,...c){this.polygons.has(o)?this.polygons.get(o).push(...c):this.polygons.set(o,c)}merge(o){for(const[c,f]of o.polygons)this.add(c,...f)}}class Eg{constructor(){this.portals=[]}static evaluate(o){if(o.length===0)return new Eg;let c=[];for(const k of o)c.push(...k.portals);if(c.length===0)return new Eg;const f=(k,w)=>k<=0&&w<=0||k>=$t&&w>=$t;for(const k of c){const w=k.va,P=k.vb;(f(w.x,P.x)||f(w.y,P.y))&&(k.type="border")}const m=c.filter(k=>k.type!=="unevaluated"),p=c.filter(k=>k.type==="unevaluated");if(p.length===0)return new Eg;p.sort((k,w)=>k.hash===w.hash?k.isTunnel===w.isTunnel?0:k.isTunnel?-1:1:k.hash<w.hash?1:-1),c=m.concat(p);let v=m.length,T=v,M=v;do if(T++,T===c.length||c[v].hash!==c[T].hash){if(T-v==2){M<v&&(c[M]=c[v],c[v]=null);const k=c[M],w=c[T-1];k.type=k.isTunnel!==w.isTunnel?"tunnel":"polygon",k.connection={a:k.connection.a,b:w.connection.a},M++}v=T}while(v!==c.length);return c.splice(M),c.sort((k,w)=>k.hash<w.hash?1:-1),{portals:c}}}Qt(Eg,"ElevationPortalGraph"),Qt(D6,"ElevationPolygons");class Tue{constructor(o,c,f){this.outPositions=o,this.outNormals=c,this.outIndices=f,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(o,c,f){let m=o[2];f!=null&&(m*=f);const p=this.getVec3Bits(o)<<96n|this.getVec3Bits(c),v=this.vertexLookup.get(p);if(v!=null)return v;const T=this.outPositions.length;this.vertexLookup.set(p,T);const M=Math.trunc(16384*c[0]),k=Math.trunc(16384*c[1]),w=Math.trunc(16384*c[2]);return this.outPositions.emplaceBack(o[0],o[1],m),this.outNormals.emplaceBack(M,k,w),T}addVertices(o,c,...f){const m=[];for(const p of f){const v=this.addVertex(p,o,c);m.push(v)}return m}addTriangles(o,c,f){if(c&&f){const m=f.length===1,p=ge.vec3.fromValues(0,0,0);for(let v=0;v<o.length;v+=3){const T=c[o[v+0]],M=c[o[v+1]],k=c[o[v+2]],w=m?f[0]:f[o[v+1]],P=m?f[0]:f[o[v+2]],D=this.addVertex(ge.vec3.fromValues(T.x,T.y,m?f[0]:f[o[v+0]]),p),O=this.addVertex(ge.vec3.fromValues(M.x,M.y,w),p),R=this.addVertex(ge.vec3.fromValues(k.x,k.y,P),p);this.outIndices.emplaceBack(D,O,R)}}else for(let m=0;m<o.length;m+=3)this.outIndices.emplaceBack(o[m+0],o[m+1],o[m+2])}addQuad(o,c){const f=this.addVertices(c,void 0,...o.map(M=>ge.vec3.fromValues(M.coord.x,M.coord.y,M.height))),[m,p,v,T]=f;this.addTriangles([m,p,v,v,T,m])}getBits(o){return this.view.setFloat32(0,o),BigInt(this.view.getUint32(0))}getVec3Bits(o){return this.getBits(o[0])<<64n|this.getBits(o[1])<<32n|this.getBits(o[2])}}class iu{constructor(o){this.unevaluatedPortals=new Eg,this.portalPolygons=new D6,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new ug,this.vertexNormals=new p1,this.indexArray=new qo,this.tileToMeters=y(o)}addVertices(o,c){const f=this.unevalVertices.length;for(let m=0;m<o.length;m++)this.unevalVertices.push(o[m]),this.unevalHeights.push(c[m]);return f}addTriangles(o,c,f){const m=f?this.unevalTunnelTriangles:this.unevalTriangles;for(const p of o)m.push(p+c)}addRenderableRing(o,c,f,m,p){const v=[new xt(p.min.x,p.min.y),new xt(p.max.x,p.min.y),new xt(p.max.x,p.max.y),new xt(p.min.x,p.max.y)];for(let T=0;T<f-1;T++){const M=c+T,k=M+1,w=this.unevalVertices[M],P=this.unevalVertices[k];if(!(w.x>=p.min.x&&w.x<=p.max.x&&w.y>=p.min.y&&w.y<=p.max.y||P.x>=p.min.x&&P.x<=p.max.x&&P.y>=p.min.y&&P.y<=p.max.y||ze(w,P,v))||this.isOnBorder(w.x,P.x)||this.isOnBorder(w.y,P.y))continue;const D=iu.computeEdgeHash(this.unevalVertices[M],this.unevalVertices[k]);let O,R=this.vertexHashLookup.get(iu.computePosHash(w));R!=null?O=R.next:(R=this.vertexHashLookup.get(iu.computePosHash(P)),O=R!=null?R.prev:D),this.unevalEdges.push({polygonIdx:o,a:M,b:k,hash:D,portalHash:O,isTunnel:m,type:"unevaluated"})}}addPortalCandidates(o,c,f,m,p){if(c.length===0)return;this.portalPolygons.add(o,{geometry:c,zLevel:p});const v=c[0];this.vertexHashLookup.clear();let T=iu.computeEdgeHash(v[v.length-2],v[v.length-1]);for(let M=0;M<v.length-1;M++){const k=v[M+0],w=v[M+1],P=ge.vec2.fromValues(w.x-k.x,w.y-k.y),D=ge.vec2.length(P);if(D===0)continue;let O="unevaluated";const R=m.pointElevation(k),N=m.pointElevation(w);Math.abs(R)<.01&&Math.abs(N)<.01?O="entrance":(this.isOnBorder(k.x,w.x)||this.isOnBorder(k.y,w.y))&&(O="border");const W=iu.computeEdgeHash(k,w);this.unevaluatedPortals.portals.push({connection:{a:o,b:void 0},va:k,vb:w,vab:P,length:D,hash:W,isTunnel:f,type:O});const Z=iu.computePosHash(k);this.vertexHashLookup.set(Z,{prev:T,next:W}),T=W}}construct(o){if(this.unevalVertices.length===0)return;const c=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),f=P=>{P.primitiveLength=this.indexArray.length-P.primitiveOffset},m=new Tue(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(o.portals,this.unevalEdges);const p=c(),v=c(),T=c(),M=(P,D)=>{P.sort((R,N)=>R.type===D&&N.type!==D?-1:R.type!==D&&N.type===D?1:0);const O=P.findIndex(R=>R.type!==D);return O>=0?O:P.length};let k=0;this.unevalEdges.length>0&&(k=M(this.unevalEdges,"none"),this.constructBridgeStructures(m,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:k},this.tileToMeters));const w=c();if(this.unevalEdges.length>0){const P=this.unevalEdges.splice(k),D=M(P,"tunnel")+k;this.unevalEdges.push(...P),this.constructTunnelStructures(m,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:k},{min:k,max:D})}f(T),m.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),f(w),m.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),f(v),m.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),f(p),this.maskSegments=hi.simpleSegment(0,w.primitiveOffset,0,w.primitiveLength),this.depthSegments=hi.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.renderableSegments=hi.simpleSegment(0,T.primitiveOffset,0,T.primitiveLength),this.shadowCasterSegments=hi.simpleSegment(0,p.primitiveOffset,0,p.primitiveLength)}upload(o){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=o.createVertexBuffer(this.vertexPositions,lue.members),this.vertexBufferNormal=o.createVertexBuffer(this.vertexNormals,cue.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(o,c,f,m){const p=new Map;for(let v=f;v<m;v++){const T=c[v],M=T.a,k=T.b;p.has(M)||p.set(M,{}),p.has(k)||p.set(k,{});const w=p.get(M),P=p.get(k);o[k]>0&&(w.to=k),o[M]>0&&(P.from=M)}return p}constructBridgeStructures(o,c,f,m,p,v){const T=this.computeVertexConnections(f,m,p.min,p.max),M=1/v,k=.5*M,w=D=>ge.vec3.fromValues(c[D].x,c[D].y,f[D]*M),P=D=>{const O=T.get(D),R=O.from,N=O.to;if(!R||!N)return;const W=w(R),Z=w(D),te=w(N),ee=ge.vec3.fromValues(0,0,0);if(!ge.vec3.exactEquals(W,Z)){const ie=ge.vec3.sub(ge.vec3.create(),Z,W);ge.vec3.add(ee,ee,ge.vec3.normalize(ie,ie))}if(!ge.vec3.exactEquals(te,Z)){const ie=ge.vec3.sub(ge.vec3.create(),te,Z);ge.vec3.add(ee,ee,ge.vec3.normalize(ie,ie))}const K=ge.vec3.len(ee);return K>0?ge.vec3.scale(ee,ee,1/K):void 0};for(let D=p.min;D<p.max;D++){const O=m[D],R=this.prepareEdgePoints(c,f,O,(It,_r)=>It>=_r);if(R==null)continue;const N=R[0],W=R[1],Z=ge.vec3.fromValues(N.coord.x,N.coord.y,M*N.height),te=ge.vec3.fromValues(W.coord.x,W.coord.y,M*W.height);if(ge.vec3.exactEquals(Z,te))continue;const ee=ge.vec3.sub(ge.vec3.create(),te,Z);ge.vec3.normalize(ee,ee);const K=It=>ge.vec3.normalize(It,It),ie=P(O.a)||ee,le=P(O.b)||ee,he=K(ge.vec3.fromValues(ie[1],-ie[0],0)),we=K(ge.vec3.fromValues(le[1],-le[0],0)),_e=K(ge.vec3.cross(ge.vec3.create(),he,ie)),xe=K(ge.vec3.cross(ge.vec3.create(),we,le)),De=ge.vec3.create(),Se=[ge.vec3.add(ge.vec3.create(),Z,ge.vec3.scale(De,ge.vec3.sub(De,he,_e),k)),ge.vec3.add(ge.vec3.create(),Z,ge.vec3.scale(De,ge.vec3.add(De,he,_e),k)),ge.vec3.add(ge.vec3.create(),Z,ge.vec3.scale(De,_e,k)),Z],Le=[ge.vec3.add(ge.vec3.create(),te,ge.vec3.scale(De,ge.vec3.sub(De,we,xe),k)),ge.vec3.add(ge.vec3.create(),te,ge.vec3.scale(De,ge.vec3.add(De,we,xe),k)),ge.vec3.add(ge.vec3.create(),te,ge.vec3.scale(De,xe,k)),te],[We,Ue]=o.addVertices(he,v,Se[0],Se[1]),[Xe,He]=o.addVertices(we,v,Le[0],Le[1]);o.addTriangles([We,Ue,Xe,Ue,He,Xe]);const[nt,Je]=o.addVertices(_e,v,Se[1],Se[2]),[it,Mt]=o.addVertices(xe,v,Le[1],Le[2]);o.addTriangles([nt,Je,it,Je,Mt,it]);const[At,er]=o.addVertices(ge.vec3.negate(he,he),v,Se[2],Se[3]),[Rt,Ft]=o.addVertices(ge.vec3.negate(we,we),v,Le[2],Le[3]);o.addTriangles([At,er,Rt,er,Ft,Rt])}}constructTunnelStructures(o,c,f,m,p,v){const T=M=>ge.vec3.normalize(M,M);for(let M=p.min;M<p.max;M++){const k=this.prepareEdgePoints(c,f,m[M],(O,R)=>O<=R);if(k==null)continue;const[w,P]=k,D=T(ge.vec3.fromValues(P.coord.y-w.coord.y,-(P.coord.x-w.coord.x),0));o.addQuad([w,P,{coord:P.coord,height:m[M].isTunnel?-.1:0},{coord:w.coord,height:m[M].isTunnel?-.1:0}],D)}for(let M=v.min;M<v.max;M++){const k=m[M],w=c[k.a],P=c[k.b],D=T(ge.vec3.fromValues(P.y-w.y,-(P.x-w.x),0));o.addQuad([{coord:P,height:0},{coord:w,height:0},{coord:w,height:f[k.a]+4},{coord:P,height:f[k.b]+4}],D),o.addQuad([{coord:w,height:0},{coord:P,height:0},{coord:P,height:f[k.b]+4},{coord:w,height:f[k.a]+4}],D)}}prepareEdgePoints(o,c,f,m){const p=o[f.a],v=o[f.b];let T=c[f.a],M=c[f.b];if(!(T!==0&&m(T,0)||M!==0&&m(M,0)))return;const k=p.clone(),w=v.clone();if(m(T,0)){if(!m(M,0)){const P=M/(M-T);w.x=br(w.x,k.x,P),w.y=br(w.y,k.y,P),M=br(M,T,P)}}else{const P=T/(T-M);k.x=br(k.x,w.x,P),k.y=br(k.y,w.y,P),T=br(T,M,P)}return[{coord:k,height:T},{coord:w,height:M}]}prepareEdges(o,c){if(c.length===0)return;c.sort((T,M)=>T.hash===M.hash?M.polygonIdx-T.polygonIdx:M.hash>T.hash?1:-1);let f=0,m=0,p=0,v=c[f].polygonIdx;do m++,(m===c.length||c[f].hash!==c[m].hash)&&((m-f==1||c[m-1].polygonIdx!==v)&&(p<f&&(c[p]=c[f],c[f]=null),c[p].type="none",p++),f=m,f!==c.length&&(v=c[f].polygonIdx));while(f!==c.length);if(c.splice(p),c.length!==0&&o.length!==0){c.sort((k,w)=>k.hash<w.hash?1:-1);let T=0,M=0;for(;T!==c.length&&M!==o.length;){const k=c[T],w=o[M];k.portalHash>w.hash?T++:w.hash>k.portalHash?M++:(k.type=w.type,T++)}}}isOnBorder(o,c){return o<=0&&c<=0||o>=$t&&c>=$t}static computeEdgeHash(o,c){return(o.y===c.y&&o.x>c.x||o.y>c.y)&&([o,c]=[c,o]),BigInt(iu.computePosHash(o))<<32n|BigInt(iu.computePosHash(c))}static computePosHash(o){return((65535&o.x)<<16|65535&o.y)>>>0}}class HD{constructor(o,c){this.layoutVertexArray=new Qc,this.indexArray=new qo,this.lineIndexArray=new id,this.triangleSegments=new hi,this.lineSegments=new hi,this.programConfigurations=new ad(o.layers,{zoom:o.zoom,lut:o.lut}),this.uploaded=!1,c&&(this.elevatedLayoutVertexArray=new ah)}update(o,c,f,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,f,m,v,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,aue.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.lineIndexBuffer=o.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=o.createVertexBuffer(this.elevatedLayoutVertexArray,sue.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(o,c,f,m,p,v){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,c,f,m,p,v)}}class ZD{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new HD(o,!1),this.elevationBufferData=new HD(o,!0),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=o.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(o,c){}populate(o,c,f,m){this.hasPattern=$D("fill",this.layers,this.pixelRatio,c);const p=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:M,index:k,sourceLayerIndex:w}of o){const P=this.layers[0]._featureFilter.needGeometry,D=V(T,P);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),D,f))continue;const O=p?p.evaluate(D,{},f,c.availableImages):void 0,R={id:M,properties:T.properties,type:T.type,sourceLayerIndex:w,index:k,geometry:P?D.geometry:U(T,f,m),patterns:{},sortKey:O};v.push(R)}p&&v.sort((T,M)=>T.sortKey-M.sortKey);for(const T of v){const{geometry:M,index:k,sourceLayerIndex:w}=T;if(this.hasPattern){const P=UD("fill",this.layers,T,this.zoom,this.pixelRatio,c);this.patternFeatures.push(P)}else this.addFeature(T,M,k,f,{},c.availableImages,c.brightness,c.elevationFeatures);c.featureIndex.insert(o[k].feature,M,k,w,this.index)}}update(o,c,f,m,p,v,T){this.bufferData.update(o,c,f,m,p,v,T),this.elevationBufferData.update(o,c,f,m,p,v,T)}addFeatures(o,c,f,m,p,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,c,f,m,v,o.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(o){this.bufferData.upload(o),this.elevationBufferData.upload(o),this.elevatedStructures&&this.elevatedStructures.upload(o)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(o,c,f,m,p,v=[],T,M){const k=sA(c,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(o,k,m,f,M):this.addGeometry(k,this.bufferData),this.bufferData.populatePaintArrays(o,f,p,v,m,T),this.elevationBufferData.populatePaintArrays(o,f,p,v,m,T)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(o){this.elevatedStructures&&this.elevatedStructures.construct(o)}addElevatedRoadFeature(o,c,f,m,p){const v=new Array,T=this.getElevationFeature(o,p);if(T){v.push({polygons:c,elevationFeature:T,elevationTileID:f});for(const M of v)if(M.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new iu(M.elevationTileID));const w=M.elevationFeature.isTunnel();let P=0;o.properties.hasOwnProperty(k6)&&(P=+o.properties[k6]);for(const D of M.polygons)this.elevatedStructures.addPortalCandidates(M.elevationFeature.id,D,w,M.elevationFeature,P)}const k=new Sue(f,M.elevationTileID);this.addElevatedGeometry(M.polygons,k,M.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,m)}}else this.addGeometry(c,this.bufferData)}addElevatedGeometry(o,c,f,m,p){const v={elevation:f,elevationSampler:c,bias:m,index:p},[T,M]=this.addGeometry(o,this.elevationBufferData,v);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:M}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,M))}addGeometry(o,c,f){let m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,v=null;f&&(v=f.elevationSampler.constantElevation(f.elevation,f.bias),v!=null&&(m=v,p=v));const T=(M,k,w)=>{if(f!=null)if(k.push(M),v!=null)c.elevatedLayoutVertexArray.emplaceBack(v),w.push(v);else{const P=f.elevationSampler.pointElevation(M,f.elevation,f.bias);c.elevatedLayoutVertexArray.emplaceBack(P),w.push(P),m=Math.min(m,P),p=Math.max(p,P)}};for(const M of o){let k=0;for(const ee of M)k+=ee.length;const w=c.triangleSegments.prepareSegment(k,c.layoutVertexArray,c.indexArray),P=w.vertexLength,D=[],O=[],R=[],N=[],W=[],Z=c.layoutVertexArray.length;for(const ee of M){if(ee.length===0)continue;ee!==M[0]&&O.push(D.length/2);const K=c.lineSegments.prepareSegment(ee.length,c.layoutVertexArray,c.lineIndexArray),ie=K.vertexLength;f&&W.push(c.layoutVertexArray.length-Z),T(ee[0],R,N),c.layoutVertexArray.emplaceBack(ee[0].x,ee[0].y),c.lineIndexArray.emplaceBack(ie+ee.length-1,ie),D.push(ee[0].x),D.push(ee[0].y);for(let le=1;le<ee.length;le++)T(ee[le],R,N),c.layoutVertexArray.emplaceBack(ee[le].x,ee[le].y),c.lineIndexArray.emplaceBack(ie+le-1,ie+le),D.push(ee[le].x),D.push(ee[le].y);K.vertexLength+=ee.length,K.primitiveLength+=ee.length}const te=N1(D,O);for(let ee=0;ee<te.length;ee+=3)c.indexArray.emplaceBack(P+te[ee],P+te[ee+1],P+te[ee+2]);if(f&&this.elevationMode==="hd-road-base"){const ee=f.elevation.isTunnel(),K=f.elevation.safeArea,ie=this.elevatedStructures.addVertices(R,N);this.elevatedStructures.addTriangles(te,ie,ee);const le=W.length;if(le>0){for(let he=0;he<le-1;he++)this.elevatedStructures.addRenderableRing(f.index,W[he]+ie,W[he+1]-W[he],ee,K);this.elevatedStructures.addRenderableRing(f.index,W[le-1]+ie,R.length-W[le-1],ee,K)}}w.vertexLength+=k,w.primitiveLength+=te.length/3}return[m,p]}getElevationFeature(o,c){if(!c)return;const f=+o.properties[Tg];return f!=null?c.find(m=>m.id===f):void 0}}let L6,N6,z6,j6;Qt(ZD,"FillBucket",{omit:["layers","patternFeatures"]}),Qt(HD,"FillBufferData"),Qt(iu,"ElevatedStructures");class XD{constructor(o,c,f,m){if(this.triangleCount=c.length/3,this.min=new xt(0,0),this.max=new xt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;const[p,v]=[o[0].clone(),o[0].clone()];for(let P=1;P<o.length;++P){const D=o[P];p.x=Math.min(p.x,D.x),p.y=Math.min(p.y,D.y),v.x=Math.max(v.x,D.x),v.y=Math.max(v.y,D.y)}if(m){const P=Math.ceil(Math.max(v.x-p.x,v.y-p.y)/m);f=Math.max(f,P)}if(f===0)return;this.min=p,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const M=Math.max(T.x,T.y)/f;this.cellsX=Math.max(1,Math.ceil(T.x/M)),this.cellsY=Math.max(1,Math.ceil(T.y/M)),this.xScale=1/M,this.yScale=1/M;const k=[];for(let P=0;P<this.triangleCount;P++){const D=o[c[3*P+0]].sub(this.min),O=o[c[3*P+1]].sub(this.min),R=o[c[3*P+2]].sub(this.min),N=cd(Math.floor(Math.min(D.x,O.x,R.x)),this.xScale,this.cellsX),W=cd(Math.floor(Math.max(D.x,O.x,R.x)),this.xScale,this.cellsX),Z=cd(Math.floor(Math.min(D.y,O.y,R.y)),this.yScale,this.cellsY),te=cd(Math.floor(Math.max(D.y,O.y,R.y)),this.yScale,this.cellsY),ee=new xt(0,0),K=new xt(0,0),ie=new xt(0,0),le=new xt(0,0);for(let he=Z;he<=te;++he){ee.y=K.y=he*M,ie.y=le.y=(he+1)*M;for(let we=N;we<=W;++we)ee.x=ie.x=we*M,K.x=le.x=(we+1)*M,(dt(D,O,R,ee,K,le)||dt(D,O,R,ee,le,ie))&&k.push({cellIdx:he*this.cellsX+we,triIdx:P})}}if(k.length===0)return;k.sort((P,D)=>P.cellIdx-D.cellIdx||P.triIdx-D.triIdx);let w=0;for(;w<k.length;){const P=k[w].cellIdx,D={start:this.payload.length,len:0};for(;w<k.length&&k[w].cellIdx===P;)++D.len,this.payload.push(k[w++].triIdx);this.cells[P]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,c){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const f=cd(o.x-this.min.x,this.xScale,this.cellsX),m=cd(o.y-this.min.y,this.yScale,this.cellsY),p=this.cells[m*this.cellsX+f];if(p){this._lazyInitLookup();for(let v=0;v<p.len;v++){const T=this.payload[p.start+v],M=Math.floor(T/8),k=1<<T%8;if(!(this.lookup[M]&k)&&(this.lookup[M]|=k,c.push(T),c.length===this.triangleCount))return}}}query(o,c,f){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>c.x||o.y>this.max.y||this.min.y>c.y)return;this._lazyInitLookup();const m=cd(o.x-this.min.x,this.xScale,this.cellsX),p=cd(c.x-this.min.x,this.xScale,this.cellsX),v=cd(o.y-this.min.y,this.yScale,this.cellsY),T=cd(c.y-this.min.y,this.yScale,this.cellsY);for(let M=v;M<=T;M++)for(let k=m;k<=p;k++){const w=this.cells[M*this.cellsX+k];if(w)for(let P=0;P<w.len;P++){const D=this.payload[w.start+P],O=Math.floor(D/8),R=1<<D%8;if(!(this.lookup[O]&R)&&(this.lookup[O]|=R,f.push(D),f.length===this.triangleCount))return}}}}function cd(d,o,c){return Math.max(0,Math.min(c-1,Math.floor(d*o)))}Qt(XD,"TriangleGridIndex");class F6{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.footprints=[]}updateFootprints(o,c){for(const f of this.footprints)c.push({footprint:f,id:o})}populate(o,c,f,m){const p=[];for(const{feature:v,id:T,index:M,sourceLayerIndex:k}of o){const w=this.layers[0]._featureFilter.needGeometry,P=V(v,w);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),P,f))continue;const D={id:T,properties:v.properties,type:v.type,sourceLayerIndex:k,index:M,geometry:w?P.geometry:U(v,f,m),patterns:{}};p.push(D)}for(const v of p){const{geometry:T,index:M,sourceLayerIndex:k}=v;this.addFeature(v,T,M,f,{},c.availableImages,c.brightness),c.featureIndex.insert(o[M].feature,T,M,k,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,c,f,m,p,v,T){}destroy(){}addFeature(o,c,f,m,p,v=[],T){for(const M of sA(c,2)){const k=[],w=[],P=[],D=new xt(1/0,1/0),O=new xt(-1/0,-1/0);for(const W of M)if(W.length!==0){W!==M[0]&&P.push(w.length/2);for(let Z=0;Z<W.length;Z++)w.push(W[Z].x),w.push(W[Z].y),k.push(W[Z]),D.x=Math.min(D.x,W[Z].x),D.y=Math.min(D.y,W[Z].y),O.x=Math.max(O.x,W[Z].x),O.y=Math.max(O.y,W[Z].y)}const R=N1(w,P),N=new XD(k,R,8,256);this.footprints.push({vertices:k,indices:R,grid:N,min:D,max:O})}}}Qt(F6,"ClipBucket",{omit:["layers"]});const Eue=xn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Aue=xn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Cue=xn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Mue=xn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Pue=xn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Iue=xn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Oue}=Eue;class Ag extends xt{constructor(o,c,f){super(o,c),this.z=f}}class B6 extends Ag{constructor(o,c,f,m){super(o,c,f),this.w=m}}function cA(d,o,c,f){const m=[],p=f===0?(v,T,M,k,w,P)=>{v.push(new xt(P,M+(P-T)/(k-T)*(w-M)))}:(v,T,M,k,w,P)=>{v.push(new xt(T+(P-M)/(w-M)*(k-T),P))};for(const v of d){const T=[];for(const M of v){if(M.length<=2)continue;const k=[];for(let D=0;D<M.length-1;D++){const O=M[D].x,R=M[D].y,N=M[D+1].x,W=M[D+1].y,Z=f===0?O:R,te=f===0?N:W;Z<o?te>o&&p(k,O,R,N,W,o):Z>c?te<c&&p(k,O,R,N,W,c):k.push(M[D]),te<o&&Z>=o&&p(k,O,R,N,W,o),te>c&&Z<=c&&p(k,O,R,N,W,c)}let w=M[M.length-1];const P=f===0?w.x:w.y;P>=o&&P<=c&&k.push(w),k.length&&(w=k[k.length-1],k[0].x===w.x&&k[0].y===w.y||k.push(k[0]),T.push(k))}T.length&&m.push(T)}return m}function $6(d,o,c,f){const m=c==="x"?"y":"x",p=(f-d[c])/(o[c]-d[c]);d[m]=d[m]+(o[m]-d[m])*p,d[c]=f,d.hasOwnProperty("z")&&(d.z=br(d.z,o.z,p)),d.hasOwnProperty("w")&&(d.w=br(d.w,o.w,p))}function U6(d,o,c,f){const m=c,p=f;for(const v of["x","y"]){let T=d,M=o;T[v]>=M[v]&&(T=o,M=d),T[v]<m&&M[v]>m&&$6(T,M,v,m),T[v]<p&&M[v]>p&&$6(M,T,v,p)}}const uA=Number.MAX_SAFE_INTEGER;function V6(d,o,c,f){return d.order<o||d.order===uA||!(d.clipMask&c)||function(m,p){return p.length!==0&&p.find(v=>v===m)===void 0}(f,d.clipScope)}function dA(d,o){return d.x-o.x||d.y-o.y}function W6(d,o){return dA(d.min,o.min)===0&&dA(d.max,o.max)===0}function YD(d,o){return!(d.min.x>o.max.x||d.max.x<o.min.x||d.min.y>o.max.y||d.max.y<o.min.y)}function KD(d,o){if(d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(d[c].sourceId!==o[c].sourceId||!W6(d[c],o[c])||d[c].order!==o[c].order||d[c].clipMask!==o[c].clipMask||!un(d[c].clipScope,o[c].clipScope))return!1;return!0}function G6(d,o,c){const f=1/$t,m=1/(1<<c.canonical.z),p=(o.x*f+c.canonical.x)*m+c.wrap,v=(o.y*f+c.canonical.y)*m;return{min:new xt((d.x*f+c.canonical.x)*m+c.wrap,(d.y*f+c.canonical.y)*m),max:new xt(p,v)}}function kue(d,o,c){const f=1<<c.canonical.z,m=((o.x-c.wrap)*f-c.canonical.x)*$t,p=(o.y*f-c.canonical.y)*$t;return{min:new xt(((d.x-c.wrap)*f-c.canonical.x)*$t,(d.y*f-c.canonical.y)*$t),max:new xt(m,p)}}function q6(d,o,c,f,m,p,v){const T=d.indices,M=d.vertices,k=[];for(let w=f;w<f+m;w+=3){const P=o[c[w+0]+p],D=o[c[w+1]+p],O=o[c[w+2]+p],R=Math.min(P.x,D.x,O.x),N=Math.max(P.x,D.x,O.x),W=Math.min(P.y,D.y,O.y),Z=Math.max(P.y,D.y,O.y);k.length=0,d.grid.query(new xt(R,W),new xt(N,Z),k);for(let te=0;te<k.length;te++){const ee=k[te];if(dt(M[T[3*ee+0]],M[T[3*ee+1]],M[T[3*ee+2]],P,D,O,v))return!0}}return!1}function H6(d,o,c,f){if(!d||!c)return!1;let m=d.vertices;if(!o.canonical.equals(f.canonical)||o.wrap!==f.wrap){if(c.vertices.length<d.vertices.length)return H6(c,f,d,o);const p=o.canonical,v=f.canonical,T=Math.pow(2,v.z-p.z);m=d.vertices.map(M=>new xt((M.x+p.x*$t)*T-v.x*$t,(M.y+p.y*$t)*T-v.y*$t))}return q6(c,m,d.indices,0,d.indices.length,0,0)}function Z6(d,o,c,f){const m=Math.pow(2,f.z-c.z);return new xt((d+c.x*$t)*m-f.x*$t,(o+c.y*$t)*m-f.y*$t)}function X6(d,o){const c=[];o.grid.queryPoint(d,c);const f=o.indices,m=o.vertices;for(let p=0;p<c.length;p++){const v=c[p];if(Ie([m[f[3*v+0]],m[f[3*v+1]],m[f[3*v+2]]],d))return!0}return!1}const JD=[new xt(0,0),new xt($t,0),new xt($t,$t),new xt(0,$t)];function Y6(d,o){const c=[];let f=[];if(!o||d.length<2)return[d];if(d.length===2)return ze(d[0],d[1],JD)?[d]:[];for(let m=0;m<d.length+2;m++){const p=d[m%d.length],v=d[(m+1)%d.length],T=ze(m===0?d[d.length-1]:d[(m-1)%d.length],p,JD),M=ze(p,v,JD),k=T||M;k&&f.push(p),k&&M||f.length>0&&(f.length>1&&c.push(f),f=[])}return f.length>1&&c.push(f),c}const QD=rp.VectorTileFeature.types,Rue=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Due=["fill-extrusion-flood-light-ground-radius"],Lue=Math.pow(2,13),Nue=Math.pow(2,15)-1,K6=new xt(0,1),np=2147483648;function B1(d,o,c,f,m,p,v,T){d.emplaceBack((o<<1)+v,(c<<1)+p,(Math.floor(f*Lue)<<1)+m,Math.round(T))}function $1(d,o,c){d.emplaceBack(o.x*$t,o.y*$t,c?1:0)}function hA(d,o,c,f,m,p){d.emplaceBack(o.x,o.y,(c.x<<1)+f,(c.y<<1)+m,p)}function U1(d,o,c){d.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class J6{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Q6{constructor(){this.centroidXY=new xt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new xt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new xt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new xt(this.max.x-this.min.x,this.max.y-this.min.y)}}class eV{constructor(){this.acc=new xt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,c){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=c.x,o.min.y=o.max.y=c.y)}appendEdge(o,c,f){this.accCount++,this.acc._add(c);let m=!!this.borders;c.x<o.min.x?(o.min.x=c.x,m=!0):c.x>o.max.x&&(o.max.x=c.x,m=!0),c.y<o.min.y?(o.min.y=c.y,m=!0):c.y>o.max.y&&(o.max.y=c.y,m=!0),((c.x===0||c.x===$t)&&c.x===f.x)!=((c.y===0||c.y===$t)&&c.y===f.y)&&this.processBorderOverlap(c,f),m&&this.checkBorderIntersection(c,f)}checkBorderIntersection(o,c){c.x<0!=o.x<0&&this.addBorderIntersection(0,br(c.y,o.y,(0-c.x)/(o.x-c.x))),c.x>$t!=o.x>$t&&this.addBorderIntersection(1,br(c.y,o.y,($t-c.x)/(o.x-c.x))),c.y<0!=o.y<0&&this.addBorderIntersection(2,br(c.x,o.x,(0-c.y)/(o.y-c.y))),c.y>$t!=o.y>$t&&this.addBorderIntersection(3,br(c.x,o.x,($t-c.y)/(o.y-c.y)))}addBorderIntersection(o,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[o];c<f[0]&&(f[0]=c),c>f[1]&&(f[1]=c)}processBorderOverlap(o,c){if(o.x===c.x){if(o.y===c.y)return;const f=o.x===0?0:1;this.addBorderIntersection(f,c.y),this.addBorderIntersection(f,o.y)}else{const f=o.y===0?2:3;this.addBorderIntersection(f,c.x),this.addBorderIntersection(f,o.x)}}centroid(){return this.accCount===0?new xt(0,0):new xt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,c)=>o+ +(c[0]!==Number.MAX_VALUE),0):0}}function tV(d,o){const c=d.add(o)._unit(),f=Yt(d.x*c.x+d.y*c.y,-1,1);var m,p,v;return v=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(v)))/4*Nue*((m=d).x*(p=o).y-m.y*p.x<0?-1:1)}const zue=[d=>d.x<0,d=>d.x>$t,d=>d.y<0,d=>d.y>$t];function jue(d,o,c,f){const m=[4];if(f===0)return m;c._mult(f);const p=d.sub(c),v=o.sub(c),T=[d,o,p,v];for(let M=0;M<4;M++)for(const k of T)if(zue[M](k)){m.push(M);break}return m}class rV{constructor(o){this.vertexArray=new Qs,this.indexArray=new qo,this.programConfigurations=new ad(o.layers,{zoom:o.zoom,lut:o.lut},c=>Due.includes(c)),this._segments=new hi,this.hiddenByLandmarkVertexArray=new T1,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new hi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,c,f,m=!1){const p=o.length;if(p>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*p,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let M;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const k=o[0],w=o[1];M=tV(k.sub(o[p-1])._perp()._unit(),w.sub(k)._perp()._unit())}for(let k=0;k<p;k++){const w=k===p-1?0:k+1,P=o[k],D=o[w],O=o[w===p-1?0:w+1],R=D.sub(P)._perp()._unit(),N=tV(R,O.sub(D)._perp()._unit()),W=M,Z=N;if(eL(P,D,c)||m&&oV(P,c)&&oV(D,c)){M=N;continue}const te=T.vertexLength;hA(this.vertexArray,P,D,1,1,W),hA(this.vertexArray,P,D,1,0,W),hA(this.vertexArray,P,D,0,1,Z),hA(this.vertexArray,P,D,0,0,Z),T.vertexLength+=4;const ee=jue(P,D,R,f);for(const K of ee)this._segmentToGroundQuads[v].push({id:te,region:K}),this._segmentToRegionTriCounts[v][K]+=2,T.primitiveLength+=2;M=N}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),c=o.length;for(let f=0;f<c;f++)this._segmentToGroundQuads[f].sort((m,p)=>m.region-p.region);for(let f=0;f<c;f++){const m=this._segmentToGroundQuads[f],p=o[f],v=this._segmentToRegionTriCounts[f];v.reduce((M,k)=>M+k,0);let T=0;for(let M=0;M<=4;M++){const k=v[M];if(k!==0){let w=this.regionSegments[M];w||(w=this.regionSegments[M]=new hi);const P={vertexOffset:p.vertexOffset,primitiveOffset:p.primitiveOffset+T,vertexLength:p.vertexLength,primitiveLength:k};w.get().push(P)}T+=k}for(let M=0;M<m.length;M++){const k=m[M].id;this.indexArray.emplaceBack(k,k+1,k+3),this.indexArray.emplaceBack(k,k+3,k+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,c,f,m,p,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,c,f,m,p,v)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Aue.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,c,f,m,p,v,T){this.hasData()&&this.programConfigurations.updatePaintArrays(o,c,f,m,p,v,T)}updateHiddenByLandmark(o){if(!this.hasData())return;const c=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;const f=o.flags&np?1:0;for(let m=o.groundVertexArrayOffset;m<c;++m)this.hiddenByLandmarkVertexArray.emplace(m,f);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,Pue.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const c=this.regionSegments[o];c&&c.destroy()}}}}class fA{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new qo,this.footprintVertices=new Qc,this.footprintSegments=[],this.layoutVertexArray=new eu,this.centroidVertexArray=new gg,this.wallVertexArray=new Y2,this.indexArray=new qo,this.programConfigurations=new ad(o.layers,{zoom:o.zoom,lut:o.lut},c=>Rue.includes(c)),this.segments=new hi,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.groundEffect=new rV(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,c){}populate(o,c,f,m){this.features=[],this.hasPattern=$D("fill-extrusion",this.layers,this.pixelRatio,c),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=y(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:p,id:v,index:T,sourceLayerIndex:M}of o){const k=this.layers[0]._featureFilter.needGeometry,w=V(p,k);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),w,f))continue;const P={id:v,sourceLayerIndex:M,index:T,geometry:k?w.geometry:U(p,f,m),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length,O=QD[P.type]==="Polygon";if(this.hasPattern)this.features.push(UD("fill-extrusion",this.layers,P,this.zoom,this.pixelRatio,c));else if(this.wallMode)for(const R of P.geometry)for(const N of Y6(R,O))this.addFeature(P,[N],T,f,{},c.availableImages,m,c.brightness);else this.addFeature(P,P.geometry,T,f,{},c.availableImages,m,c.brightness);c.featureIndex.insert(p,P.geometry,T,M,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,c,f,m,p,v){for(const T of this.features){const M=QD[T.type]==="Polygon",{geometry:k}=T;if(this.wallMode)for(const w of k)for(const P of Y6(w,M))this.addFeature(T,[P],T.index,c,f,m,p,v);else this.addFeature(T,k,T.index,c,f,m,p,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,c,f,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,f,m,v,T),this.groundEffect.update(o,c,p,f,m,v,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Oue),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,Mue.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,Iue.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,Cue.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,f,m,p,v,T,M){const k=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,w=[new xt(0,0),new xt($t,$t)],P=T.projection,D=P.name==="globe",O=this.wallMode||QD[o.type]==="Polygon",R=new eV;R.centroidDataIndex=this.centroidData.length;const N=new Q6,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},m)<=0,Z=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},m);let te;if(N.height=Z,N.vertexArrayOffset=this.layoutVertexArray.length,N.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Uv),this.wallMode){if(D)return void ai("Non zero fill-extrusion-line-width is not yet supported on globe.");if(c.length!==1)return;te=function(xe){const De=xe[0].x===xe[xe.length-1].x&&xe[0].y===xe[xe.length-1].y;(function(Ft){let It=0;const _r=Ft.length;for(let Xt=0;Xt<_r;Xt++)It+=(Ft[(Xt+1)%_r].x-Ft[Xt].x)*(Ft[(Xt+1)%_r].y+Ft[Xt].y);return It>=0})(xe)||(xe=xe.reverse());const Le={geometry:[],joinNormals:[],indices:[]},We=[],Ue=[],Xe=[];let He=xe.length;for(;He>=2&&xe[He-1].equals(xe[He-2]);)He--;if(He<(De?3:2))return Le;let nt,Je,it,Mt,At,er=0;for(;er<He-1&&xe[er].equals(xe[er+1]);)er++;De&&(nt=xe[He-2],At=xe[er].sub(nt)._unit()._perp());for(let Ft=er;Ft<He;Ft++){if(it=Ft===He-1?De?xe[er+1]:void 0:xe[Ft+1],it&&xe[Ft].equals(it))continue;At&&(Mt=At),nt&&(Je=nt),nt=xe[Ft],At=it?it.sub(nt)._unit()._perp():Mt,Mt=Mt||At;let It=Mt.add(At);It.x===0&&It.y===0||It._unit();const _r=It.x*At.x+It.y*At.y,Xt=_r!==0?1/_r:1/0,or=Mt.x*At.y-Mt.y*At.x>0;let Cr="miter";const Gr=2;Cr==="miter"&&Xt>Gr&&(Cr="bevel"),Cr==="bevel"&&(Xt>100&&(Cr="flipbevel"),Xt<Gr&&(Cr="miter"));const Ir=(Qr,Wr,tn,gn)=>{const Zn=new xt(Qr.x,Qr.y),Mr=new xt(Qr.x,Qr.y);Zn.x+=Wr.x*gn,Zn.y+=Wr.y*gn,Mr.x-=Wr.x*Math.max(tn,1),Mr.y-=Wr.y*Math.max(tn,1),Xe.push(Wr),We.push(Zn),Ue.push(Mr)};if(Cr==="miter")It._mult(Xt),Ir(nt,It,0,0);else if(Cr==="flipbevel")It=At.mult(-1),Ir(nt,It,0,0),Ir(nt,It.mult(-1),0,0);else{const Qr=-Math.sqrt(Xt*Xt-1),Wr=or?Qr:0,tn=or?0:Qr;Je&&Ir(nt,Mt,Wr,tn),it&&Ir(nt,At,Wr,tn)}}Le.geometry=[...We,...Ue.reverse(),We[0]],Le.joinNormals=[...Xe,...Xe.reverse(),Xe[Xe.length-1]];const Rt=Le.geometry.length-1;for(let Ft=0;Ft<Rt/2;Ft++)if(Ft+1<Rt/2){let It=Ft,_r=Ft+1,Xt=Rt-1-Ft,or=Rt-2-Ft;It=It===0?Rt-1:It-1,_r=_r===0?Rt-1:_r-1,Xt=Xt===0?Rt-1:Xt-1,or=or===0?Rt-1:or-1,Le.indices.push(Xt),Le.indices.push(_r),Le.indices.push(It),Le.indices.push(Xt),Le.indices.push(or),Le.indices.push(_r)}return Le}(c[0]),c=[te.geometry]}const ee=(xe,De)=>xe<(De.length-1)/2||xe===De.length-1,K=this.wallMode?[c]:sA(c,500);for(let xe=K.length-1;xe>=0;xe--){const De=K[xe];(De.length===0||(ie=De[0]).every(Se=>Se.x<=0)||ie.every(Se=>Se.x>=$t)||ie.every(Se=>Se.y<=0)||ie.every(Se=>Se.y>=$t))&&K.splice(xe,1)}var ie;let le;if(D)le=cV(K,w,m);else{le=[];for(const xe of K)le.push({polygon:xe,bounds:w})}const he=O?this.edgeRadius:0,we=he>0&&this.zoom<17,_e=(xe,De)=>{if(xe.length===0)return!1;const Se=xe[xe.length-1];return De.x===Se.x&&De.y===Se.y};for(const{polygon:xe,bounds:De}of le){let Se=0,Le=0;for(const He of xe)O&&!He[0].equals(He[He.length-1])&&He.push(He[0]),Le+=O?He.length-1:He.length;const We=this.segments.prepareSegment((O?5:4)*Le,this.layoutVertexArray,this.indexArray);N.footprintSegIdx<0&&(N.footprintSegIdx=this.footprintSegments.length),N.polygonSegIdx<0&&(N.polygonSegIdx=this.polygonSegments.length);const Ue={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Xe=new J6;if(Xe.vertexOffset=this.footprintVertices.length,Xe.indexOffset=3*this.footprintIndices.length,Xe.ringIndices=[],O){const He=[],nt=[];Se=We.vertexLength;for(let it=0;it<xe.length;it++){const Mt=xe[it];Mt.length&&it!==0&&nt.push(He.length/2);const At=[];let er,Rt;er=Mt[1].sub(Mt[0])._perp()._unit(),Xe.ringIndices.push(Mt.length-1);for(let Ft=1;Ft<Mt.length;Ft++){const It=Mt[Ft],_r=Mt[Ft===Mt.length-1?1:Ft+1],Xt=It.clone();if(he){Rt=_r.sub(It)._perp()._unit();const or=er.add(Rt)._unit(),Cr=he*Math.min(4,1/(er.x*or.x+er.y*or.y));Xt.x+=Cr*or.x,Xt.y+=Cr*or.y,Xt.x=Math.round(Xt.x),Xt.y=Math.round(Xt.y),er=Rt}if(!W||he!==0&&!we||_e(At,Xt)||At.push(Xt),B1(this.layoutVertexArray,Xt.x,Xt.y,0,0,1,1,0),this.wallMode){const or=ee(Ft,Mt);$1(this.wallVertexArray,te.joinNormals[Ft],!or)}We.vertexLength++,this.footprintVertices.emplaceBack(It.x,It.y),He.push(It.x,It.y),D&&U1(this.layoutVertexExtArray,P.projectTilePoint(Xt.x,Xt.y,m),P.upVector(m,Xt.x,Xt.y))}W&&(he===0||we)&&(At.length!==0&&_e(At,At[0])&&At.pop(),this.groundEffect.addData(At,De,k))}const Je=this.wallMode?te.indices:N1(He,nt);for(let it=0;it<Je.length;it+=3)this.footprintIndices.emplaceBack(Xe.vertexOffset+Je[it+0],Xe.vertexOffset+Je[it+1],Xe.vertexOffset+Je[it+2]),this.indexArray.emplaceBack(Se+Je[it],Se+Je[it+2],Se+Je[it+1]),We.primitiveLength++;Xe.indexCount+=Je.length,Xe.vertexCount+=this.footprintVertices.length-Xe.vertexOffset}for(let He=0;He<xe.length;He++){const nt=xe[He];R.startRing(N,nt[0]);let Je=nt.length>4&&aV(nt[nt.length-2],nt[0],nt[1]),it=he?Fue(nt[nt.length-2],nt[0],nt[1],he):0;const Mt=[];let At,er,Rt;er=nt[1].sub(nt[0])._perp()._unit();let Ft=!0;for(let It=1,_r=0;It<nt.length;It++){let Xt=nt[It-1],or=nt[It];const Cr=nt[It===nt.length-1?1:It+1];if(R.appendEdge(N,or,Xt),eL(or,Xt,De)){he&&(er=Cr.sub(or)._perp()._unit(),Ft=!Ft);continue}const Gr=or.sub(Xt)._perp(),Ir=Gr.x/(Math.abs(Gr.x)+Math.abs(Gr.y)),Qr=Gr.y>0?1:0,Wr=Xt.dist(or);if(_r+Wr>32768&&(_r=0),he){Rt=Cr.sub(or)._perp()._unit();let Mr=iV(Xt,or,Cr,nV(er,Rt),he);isNaN(Mr)&&(Mr=0);const ln=or.sub(Xt)._unit();Xt=Xt.add(ln.mult(it))._round(),or=or.add(ln.mult(-Mr))._round(),it=Mr,er=Rt,W&&this.zoom>=17&&(_e(Mt,Xt)||Mt.push(Xt),_e(Mt,or)||Mt.push(or))}const tn=We.vertexLength,gn=nt.length>4&&aV(Xt,or,Cr);let Zn=sV(_r,Je,Ft);if(B1(this.layoutVertexArray,Xt.x,Xt.y,Ir,Qr,0,0,Zn),B1(this.layoutVertexArray,Xt.x,Xt.y,Ir,Qr,0,1,Zn),this.wallMode){const Mr=ee(It-1,nt),ln=te.joinNormals[It-1];$1(this.wallVertexArray,ln,Mr),$1(this.wallVertexArray,ln,Mr)}if(_r+=Wr,Zn=sV(_r,gn,!Ft),Je=gn,B1(this.layoutVertexArray,or.x,or.y,Ir,Qr,0,0,Zn),B1(this.layoutVertexArray,or.x,or.y,Ir,Qr,0,1,Zn),this.wallMode){const Mr=ee(It,nt),ln=te.joinNormals[It];$1(this.wallVertexArray,ln,Mr),$1(this.wallVertexArray,ln,Mr)}if(We.vertexLength+=4,this.indexArray.emplaceBack(tn+0,tn+1,tn+2),this.indexArray.emplaceBack(tn+1,tn+3,tn+2),We.primitiveLength+=2,he){const Mr=Se+(It===1?nt.length-2:It-2),ln=It===1?Se:Mr+1;if(this.indexArray.emplaceBack(tn+1,Mr,tn+3),this.indexArray.emplaceBack(Mr,ln,tn+3),We.primitiveLength+=2,At===void 0&&(At=tn),!eL(Cr,nt[It],De)){const li=It===nt.length-1?At:We.vertexLength;this.indexArray.emplaceBack(tn+2,tn+3,li),this.indexArray.emplaceBack(tn+3,li+1,li),this.indexArray.emplaceBack(tn+3,ln,li+1),We.primitiveLength+=3}Ft=!Ft}if(D){const Mr=this.layoutVertexExtArray,ln=P.projectTilePoint(Xt.x,Xt.y,m),li=P.projectTilePoint(or.x,or.y,m),vi=P.upVector(m,Xt.x,Xt.y),Ai=P.upVector(m,or.x,or.y);U1(Mr,ln,vi),U1(Mr,ln,vi),U1(Mr,li,Ai),U1(Mr,li,Ai)}}O&&(Se+=nt.length-1),W&&he&&this.zoom>=17&&(Mt.length!==0&&_e(Mt,Mt[0])&&Mt.pop(),this.groundEffect.addData(Mt,De,k,he>0))}this.footprintSegments.push(Xe),Ue.triangleCount=this.indexArray.length-Ue.triangleArrayOffset,this.polygonSegments.push(Ue),++N.footprintSegLen,++N.polygonSegLen}if(N.vertexCount=this.layoutVertexArray.length-N.vertexArrayOffset,N.groundVertexCount=this.groundEffect.vertexArray.length-N.groundVertexArrayOffset,N.vertexCount!==0){if(N.centroidXY=R.borders?K6:this.encodeCentroid(R,N),this.centroidData.push(N),R.borders){this.featuresOnBorder.push(R);const xe=this.featuresOnBorder.length-1;for(let De=0;De<R.borders.length;De++)R.borders[De][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[De].push(xe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,p,v,m,M),this.groundEffect.addPaintPropertiesData(o,f,p,v,m,M),this.maxHeight=Math.max(this.maxHeight,Z)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((c,f)=>this.featuresOnBorder[c].borders[o][0]-this.featuresOnBorder[f].borders[o][0])}splitToSubtiles(){const o=[];for(let T=0;T<this.centroidData.length;T++){const M=this.centroidData[T],k=+(M.min.y+M.max.y>$t),w=2*k+(+(M.min.x+M.max.x>$t)^k);for(let P=0;P<M.polygonSegLen;P++){const D=M.polygonSegIdx+P;o.push({centroidIdx:T,subtile:w,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const c=new qo;o.sort((T,M)=>T.triangleSegmentIdx===M.triangleSegmentIdx?T.subtile-M.subtile:T.triangleSegmentIdx-M.triangleSegmentIdx);let f=0,m=0,p=0;for(const T of o){if(T.triangleSegmentIdx!==f)break;p++}const v=o.length;for(;m!==o.length;){f=o[m].triangleSegmentIdx;let T=0,M=m,k=m;for(let w=M;w<p&&o[w].subtile===T;w++)k++;for(;M!==p;){const w=o[M];T=w.subtile;const P=this.centroidData[w.centroidIdx].min.clone(),D=this.centroidData[w.centroidIdx].max.clone(),O={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:c.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=M;R<k;R++){const N=o[R],W=this.polygonSegments[N.polygonSegmentIdx],Z=this.centroidData[N.centroidIdx].min,te=this.centroidData[N.centroidIdx].max,ee=this.indexArray.uint16;for(let K=W.triangleArrayOffset;K<W.triangleArrayOffset+W.triangleCount;K++)c.emplaceBack(ee[3*K],ee[3*K+1],ee[3*K+2]);O.primitiveLength+=W.triangleCount,P.x=Math.min(P.x,Z.x),P.y=Math.min(P.y,Z.y),D.x=Math.max(D.x,te.x),D.y=Math.max(D.y,te.y)}O.primitiveLength>0&&this.triangleSubSegments.push({segment:O,min:P,max:D}),M=k;for(let R=M;R<p&&o[R].subtile===o[M].subtile;R++)k++}m=p;for(let w=m;w<v&&o[w].triangleSegmentIdx===o[m].triangleSegmentIdx;w++)p++}c._trim(),this.indexArray=c}getVisibleSegments(o,c,f){const m=new hi;if(this.wallMode){for(const N of this.triangleSubSegments)m.segments.push(N.segment);return m}let p=0,v=0;const T=1<<o.canonical.z;if(c){const N=c.getMinMaxForTile(o);N&&(p=N.min,v=N.max)}v+=this.maxHeight;const M=o.toUnwrapped();let k;const w=[M.canonical.x/T+M.wrap,M.canonical.y/T],P=[(M.canonical.x+1)/T+M.wrap,(M.canonical.y+1)/T],D=(N,W,Z)=>[N[0]*(1-Z[0])+W[0]*Z[0],N[1]*(1-Z[1])+W[1]*Z[1]],O=[],R=[];for(const N of this.triangleSubSegments){O[0]=N.min.x/$t,O[1]=N.min.y/$t,R[0]=N.max.x/$t,R[1]=N.max.y/$t;const W=D(w,P,O),Z=D(w,P,R);if(new lr([W[0],W[1],p],[Z[0],Z[1],v]).intersectsPrecise(f)===0){k&&(m.segments.push(k),k=void 0);continue}const te=N.segment;k&&k.vertexOffset!==te.vertexOffset&&(m.segments.push(k),k=void 0),k?(k.vertexLength+=te.vertexLength,k.primitiveLength+=te.primitiveLength):k={vertexOffset:te.vertexOffset,primitiveLength:te.primitiveLength,vertexLength:te.vertexLength,primitiveOffset:te.primitiveOffset,sortKey:void 0,vaos:{}}}return k&&m.segments.push(k),m}encodeCentroid(o,c){const f=o.centroid(),m=c.span(),p=Math.min(7,Math.round(m.x*this.tileToMeter/10)),v=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new xt(Yt(f.x,1,$t-1)<<3|p,Yt(f.y,1,$t-1)<<3|v)}encodeBorderCentroid(o){if(!o.borders)return new xt(0,0);const c=o.borders,f=Number.MAX_VALUE;if(c[0][0]!==f||c[1][0]!==f){const m=c[0][0]!==f?0:1;return new xt(6|(c[0][0]!==f?0:65528),(c[m][0]+c[m][1])/2<<3|6)}{const m=c[2][0]!==f?2:3;return new xt((c[m][0]+c[m][1])/2<<3|6,6|(c[2][0]!==f?0:65528))}}showCentroid(o){const c=this.centroidData[o.centroidDataIndex];c.flags&=np,c.centroidXY.x=0,c.centroidXY.y=0,this.writeCentroidToBuffer(c)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const c=o.vertexArrayOffset,f=o.vertexCount+o.vertexArrayOffset,m=o.flags&np?K6:o.centroidXY,p=this.centroidVertexArray.geta_centroid_pos0(c);if(this.centroidVertexArray.geta_centroid_pos1(c)!==m.y||p!==m.x){for(let v=c;v<f;++v)this.centroidVertexArray.emplace(v,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,c,f){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const m=c.getReplacementRegionsForTile(o.toUnwrapped());if(KD(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const p=[];for(const v of this.activeReplacements){if(v.order<f)continue;const T=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-o.canonical.z));for(const M of this.centroidData)if(!(M.flags&np||v.min.x>M.max.x||M.min.x>v.max.x||v.min.y>M.max.y||M.min.y>v.max.y))for(let k=0;k<M.footprintSegLen;k++){const w=this.footprintSegments[M.footprintSegIdx+k];if(p.length=0,Bue(this.footprintVertices,w.vertexOffset,w.vertexCount,v.footprintTileId.canonical,o.canonical,p),q6(v.footprint,p,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-T)){M.flags|=np;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,c,f){let m=!1;for(let p=0;p<f.footprintSegLen;p++){const v=this.footprintSegments[f.footprintSegIdx+p];let T=0;for(const M of v.ringIndices){for(let k=T,w=M+T-1;k<M+T;w=k++){const P=this.footprintVertices.int16[2*(k+v.vertexOffset)+0],D=this.footprintVertices.int16[2*(k+v.vertexOffset)+1],O=this.footprintVertices.int16[2*(w+v.vertexOffset)+1];D>c!=O>c&&o<(this.footprintVertices.int16[2*(w+v.vertexOffset)+0]-P)*(c-D)/(O-D)+P&&(m=!m)}T=M}}return m}getHeightAtTileCoord(o,c){let f=Number.NEGATIVE_INFINITY,m=!0;const p=4*(o+$t)*$t+(c+$t);if(this.partLookup.hasOwnProperty(p)){const v=this.partLookup[p];return v?{height:v.height,hidden:!!(v.flags&np)}:void 0}for(const v of this.centroidData)o>v.max.x||v.min.x>o||c>v.max.y||v.min.y>c||this.footprintContainsPoint(o,c,v)&&v&&v.height>f&&(f=v.height,this.partLookup[p]=v,m=!!(v.flags&np));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:m};this.partLookup[p]=void 0}}function nV(d,o){const c=d.add(o)._unit();return d.x*c.x+d.y*c.y}function Fue(d,o,c,f){const m=o.sub(d)._perp()._unit(),p=c.sub(o)._perp()._unit();return iV(d,o,c,nV(m,p),f)}function iV(d,o,c,f,m){const p=Math.sqrt(1-f*f);return Math.min(d.dist(o)/3,o.dist(c)/3,m*p/f)}function eL(d,o,c){return d.x<c[0].x&&o.x<c[0].x||d.x>c[1].x&&o.x>c[1].x||d.y<c[0].y&&o.y<c[0].y||d.y>c[1].y&&o.y>c[1].y}function oV(d,o){return d.x<o[0].x||d.x>o[1].x||d.y<o[0].y||d.y>o[1].y}function aV(d,o,c){if(d.x<0||d.x>=$t||o.x<0||o.x>=$t||c.x<0||c.x>=$t)return!1;const f=c.sub(o),m=f.perp(),p=d.sub(o);return(f.x*p.x+f.y*p.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(p.x*p.x+p.y*p.y))>-.866&&m.x*p.x+m.y*p.y<0}function sV(d,o,c){const f=o?2|d:-3&d;return c?1|f:-2&f}function lV(){const d=Math.PI/32,o=Math.tan(d),c=dh;return c*Math.sqrt(1+2*o*o)-c}function cV(d,o,c){const f=1<<c.z,m=ts(c.x/f),p=ts((c.x+1)/f),v=Ho(c.y/f),T=Ho((c.y+1)/f);return function(M,k,w,P,D=0,O){const R=[];if(!M.length||!w||!P)return R;const N=(le,he)=>{for(const we of le)R.push({polygon:we,bounds:he})},W=Math.ceil(Math.log2(w)),Z=Math.ceil(Math.log2(P)),te=W-Z,ee=[];for(let le=0;le<Math.abs(te);le++)ee.push(te>0?0:1);for(let le=0;le<Math.min(W,Z);le++)ee.push(0),ee.push(1);let K=M;if(K=cA(K,k[0].y-D,k[1].y+D,1),K=cA(K,k[0].x-D,k[1].x+D,0),!K.length)return R;const ie=[];for(ee.length?ie.push({polygons:K,bounds:k,depth:0}):N(K,k);ie.length;){const le=ie.pop(),he=le.depth,we=ee[he],_e=le.bounds[0],xe=le.bounds[1],De=we===0?_e.x:_e.y,Se=we===0?xe.x:xe.y,Le=O?O(we,De,Se):.5*(De+Se),We=cA(le.polygons,De-D,Le+D,we),Ue=cA(le.polygons,Le-D,Se+D,we);if(We.length){const Xe=[_e,new xt(we===0?Le:xe.x,we===1?Le:xe.y)];ee.length>he+1?ie.push({polygons:We,bounds:Xe,depth:he+1}):N(We,Xe)}if(Ue.length){const Xe=[new xt(we===0?Le:_e.x,we===1?Le:_e.y),xe];ee.length>he+1?ie.push({polygons:Ue,bounds:Xe,depth:he+1}):N(Ue,Xe)}}return R}(d,o,Math.ceil((p-m)/11.25),Math.ceil((v-T)/11.25),1,(M,k,w)=>{if(M===0)return .5*(k+w);{const P=Ho((c.y+k/$t)/f);return(es(.5*(Ho((c.y+w/$t)/f)+P))*f-c.y)*$t}})}function Bue(d,o,c,f,m,p){const v=Math.pow(2,f.z-m.z);for(let T=0;T<c;T++){let M=d.int16[2*(T+o)+0],k=d.int16[2*(T+o)+1];M=(M+m.x*$t)*v-f.x*$t,k=(k+m.y*$t)*v-f.y*$t,p.push(new xt(M,k))}}let uV,dV;function V1(d,o){return d.x*o.x+d.y*o.y}function hV(d,o){if(d.length===1){let c=0;const f=o[c++];let m;for(;!m||f.equals(m);)if(m=o[c++],!m)return 1/0;for(;c<o.length;c++){const p=o[c],v=d[0],T=m.sub(f),M=p.sub(f),k=v.sub(f),w=V1(T,T),P=V1(T,M),D=V1(M,M),O=V1(k,T),R=V1(k,M),N=w*D-P*P,W=(D*O-P*R)/N,Z=(w*R-P*O)/N,te=f.z*(1-W-Z)+m.z*W+p.z*Z;if(isFinite(te))return te}return 1/0}{let c=1/0;for(const f of o)c=Math.min(c,f.z);return c}}function fV(d,o,c,f,m,p,v,T){const M=v*m.getElevationAt(d,o,!0,!0),k=p[0]!==0,w=k?p[1]===0?v*(p[0]/7-450):v*function(P,D,O){const R=Math.floor(D[0]/8),N=Math.floor(D[1]/8),W=10*(D[0]-8*R),Z=10*(D[1]-8*N),te=P.getElevationAt(R,N,!0,!0),ee=P.getMeterToDEM(O),K=Math.floor(.5*(W*ee-1)),ie=Math.floor(.5*(Z*ee-1)),le=P.tileCoordToPixel(R,N),he=2*K+1,we=2*ie+1,_e=function(Ue,Xe,He,nt,Je){return[Ue.getElevationAtPixel(Xe,He,!0),Ue.getElevationAtPixel(Xe+Je,He,!0),Ue.getElevationAtPixel(Xe,He+Je,!0),Ue.getElevationAtPixel(Xe+nt,He+Je,!0)]}(P,le.x-K,le.y-ie,he,we),xe=Math.abs(_e[0]-_e[1]),De=Math.abs(_e[2]-_e[3]),Se=Math.abs(_e[0]-_e[2])+Math.abs(_e[1]-_e[3]),Le=Math.min(.25,.5*ee*(xe+De)/he),We=Math.min(.25,.5*ee*Se/we);return te+Math.max(Le*W,We*Z)}(m,p,T):M;return{base:M+(c===0?-1:c),top:k?Math.max(w+f,M+c+2):M+f}}Qt(fA,"FillExtrusionBucket",{omit:["layers","features"]}),Qt(Q6,"PartData"),Qt(J6,"FootprintSegment"),Qt(eV,"BorderCentroidData"),Qt(rV,"GroundEffect");const $ue=xn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Uue=xn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Vue}=$ue,Wue=xn([{name:"a_packed",components:3,type:"Float32"}]),{members:Gue}=Wue,que=xn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Hue}=que;class pV{constructor(o,c){this.width=o,this.height=c,this.nextRow=0,this.image=new tp({width:o,height:c}),this.positions={},this.uploaded=!1}getDash(o,c){const f=this.getKey(o,c);return this.positions[f]}trim(){const o=this.width,c=this.height=la(this.nextRow);this.image.resize({width:o,height:c})}getKey(o,c){return o.join(",")+c}getDashRanges(o,c,f){const m=[];let p=o.length%2==1?-o[o.length-1]*f:0,v=o[0]*f,T=!0;m.push({left:p,right:v,isDash:T,zeroLength:o[0]===0});let M=o[0];for(let k=1;k<o.length;k++){T=!T;const w=o[k];p=M*f,M+=w,v=M*f,m.push({left:p,right:v,isDash:T,zeroLength:w===0})}return m}addRoundDash(o,c,f){const m=c/2;for(let p=-f;p<=f;p++){const v=this.width*(this.nextRow+f+p);let T=0,M=o[T];for(let k=0;k<this.width;k++){k/M.right>1&&(M=o[++T]);const w=Math.abs(k-M.left),P=Math.abs(k-M.right),D=Math.min(w,P);let O;const R=p/f*(m+1);if(M.isDash){const N=m-Math.abs(R);O=Math.sqrt(D*D+N*N)}else O=m-Math.sqrt(D*D+R*R);this.image.data[v+k]=Math.max(0,Math.min(255,O+128))}}}addRegularDash(o,c){for(let M=o.length-1;M>=0;--M){const k=o[M],w=o[M+1];k.zeroLength?o.splice(M,1):w&&w.isDash===k.isDash&&(w.left=k.left,o.splice(M,1))}const f=o[0],m=o[o.length-1];f.isDash===m.isDash&&(f.left=m.left-this.width,m.right=f.right+this.width);const p=this.width*this.nextRow;let v=0,T=o[v];for(let M=0;M<this.width;M++){M/T.right>1&&(T=o[++v]);const k=Math.abs(M-T.left),w=Math.abs(M-T.right),P=Math.min(k,w);this.image.data[p+M]=Math.max(0,Math.min(255,(T.isDash?P:-P)+c+128))}}addDash(o,c){const f=this.getKey(o,c);if(this.positions[f])return this.positions[f];const m=c==="round",p=m?7:0,v=2*p+1;if(this.nextRow+v>this.height)return ai("LineAtlas out of space"),null;o.length===0&&o.push(1);let T=0;for(let w=0;w<o.length;w++)o[w]<0&&(ai("Negative value is found in line dasharray, replacing values with 0"),o[w]=0),T+=o[w];if(T!==0){const w=this.width/T,P=this.getDashRanges(o,this.width,w);m?this.addRoundDash(P,w,p):this.addRegularDash(P,c==="square"?.5*w:0)}const M=this.nextRow+p;this.nextRow+=v;const k={tl:[M,p],br:[T,0]};return this.positions[f]=k,k}}Qt(pV,"LineAtlas");const Zue=rp.VectorTileFeature.types,Xue=Math.cos(Math.PI/180*37.5),Yue=Math.cos(Math.PI/180*5);class tL{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new m1,this.layoutVertexArray2=new Dl,this.patternVertexArray=new Dl,this.indexArray=new qo,this.programConfigurations=new ad(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new hi,this.maxLineLength=0,this.zOffsetVertexArray=new Dl,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:$t/64}updateFootprints(o,c){}populate(o,c,f,m){this.hasPattern=$D("line",this.layers,this.pixelRatio,c);const p=this.layers[0].layout.get("line-sort-key");this.tileToMeter=y(f);const v=this.layers[0].layout.get("line-z-offset"),T=v.isConstant()&&!v.constantOr(0),M=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=M==="sea"||M==="ground"||!T&&M==="none",this.hasZOffset&&M==="none"&&ai(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const k=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&k!==void 0;const w=[];for(const{feature:R,id:N,index:W,sourceLayerIndex:Z}of o){const te=this.layers[0]._featureFilter.needGeometry,ee=V(R,te);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),ee,f))continue;const K=p?p.evaluate(ee,{},f):void 0,ie={id:N,properties:R.properties,type:R.type,sourceLayerIndex:Z,index:W,geometry:te?ee.geometry:U(R,f,m),patterns:{},sortKey:K};w.push(ie)}p&&w.sort((R,N)=>R.sortKey-N.sortKey);const{lineAtlas:P,featureIndex:D}=c,O=this.addConstantDashes(P);for(const R of w){const{geometry:N,index:W,sourceLayerIndex:Z}=R;if(O&&this.addFeatureDashes(R,P),this.hasPattern){const te=UD("line",this.layers,R,this.zoom,this.pixelRatio,c);this.patternFeatures.push(te)}else this.addFeature(R,N,W,f,P.positions,c.availableImages,c.brightness);D.insert(o[W].feature,N,W,Z,this.index)}}addConstantDashes(o){let c=!1;for(const f of this.layers){const m=f.paint.get("line-dasharray").value,p=f.layout.get("line-cap").value;if(m.kind!=="constant"||p.kind!=="constant")c=!0;else{const v=p.value,T=m.value;if(!T)continue;o.addDash(T,v)}}return c}addFeatureDashes(o,c){const f=this.zoom;for(const m of this.layers){const p=m.paint.get("line-dasharray").value,v=m.layout.get("line-cap").value;if(p.kind==="constant"&&v.kind==="constant")continue;let T,M;if(p.kind==="constant"){if(T=p.value,!T)continue}else T=p.evaluate({zoom:f},o);M=v.kind==="constant"?v.value:v.evaluate({zoom:f},o),c.addDash(T,M),o.patterns[m.id]=c.getKey(T,M)}}update(o,c,f,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,f,m,v,T)}addFeatures(o,c,f,m,p,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,c,f,m,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Gue)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,Hue)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Uue.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Vue),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,f,m,p,v,T){const M=this.layers[0].layout,k=M.get("line-join").evaluate(o,{}),w=M.get("line-cap").evaluate(o,{}),P=M.get("line-miter-limit"),D=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=M.get("line-z-offset").value;const O=this.layers[0].paint.get("line-width").value;O.kind!=="constant"&&O.isLineProgressConstant===!1&&(this.variableWidthValue=O);for(const R of c)this.addLine(R,o,m,k,w,P,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,p,v,m,T)}addLine(o,c,f,m,p,v,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const M=m==="none";if(this.patternJoinNone=this.hasPattern&&M,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ee=0;ee<o.length-1;ee++)this.totalDistance+=o[ee].dist(o[ee+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=Zue[c.type]==="Polygon";let w=o.length;for(;w>=2&&o[w-1].equals(o[w-2]);)w--;let P=0;for(;P<w-1&&o[P].equals(o[P+1]);)P++;if(w<(k?3:2))return;m==="bevel"&&(v=1.05);const D=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let O,R,N,W,Z,te;this.e1=this.e2=-1,k&&(O=o[w-2],Z=o[P].sub(O)._unit()._perp());for(let ee=P;ee<w;ee++){if(N=ee===w-1?k?o[P+1]:void 0:o[ee+1],N&&o[ee].equals(N))continue;Z&&(W=Z),O&&(R=O),O=o[ee],te=this.evaluateLineProgressFeatures(R?R.dist(O):0),Z=N?N.sub(O)._unit()._perp():W,W=W||Z;const K=R&&N;let ie=K?m:k||M?"butt":p;const le=W.x*Z.x+W.y*Z.y;if(M){const We=function(Ue){if(Ue.patternJoinNone){const Xe=Ue.segmentPoints.length/2,He=Ue.lineSoFar-Ue.segmentStart;for(let nt=0;nt<Xe;++nt){const Je=Ue.segmentPoints[2*nt+1],it=Math.round(Ue.segmentPoints[2*nt])+.5+.25*Je;Ue.patternVertexArray.emplaceBack(it,He,Ue.segmentStart),Ue.patternVertexArray.emplaceBack(it,He,Ue.segmentStart)}Ue.segmentPoints.length=0}Ue.e1=Ue.e2=-1};if(K&&le<Yue){this.updateDistance(R,O),this.addCurrentVertex(O,W,1,1,D,te),We(this),this.addCurrentVertex(O,Z,-1,-1,D,te);continue}if(R){if(!N){this.updateDistance(R,O),this.addCurrentVertex(O,W,1,1,D,te),We(this);continue}ie="miter"}}let he=W.add(Z);he.x===0&&he.y===0||he._unit();const we=he.x*Z.x+he.y*Z.y,_e=we!==0?1/we:1/0,xe=2*Math.sqrt(2-2*we),De=we<Xue&&R&&N,Se=W.x*Z.y-W.y*Z.x>0,Le=this.overscaling<=16?15*$t/(512*this.overscaling):0;if(K&&ie==="round"){if(_e<T)ie="miter";else if(_e<=2){const We=rL(O,-10,$t+10);ie=this.hasZOffset&&(We||this.hasCrossSlope)?"miter":"fakeround"}}if(ie==="miter"&&_e>v&&(ie="bevel"),ie==="bevel"&&(_e>2&&(ie="flipbevel"),_e<v&&(ie="miter")),R&&!(ie==="miter"&&De)&&this.updateDistance(R,O),ie==="miter")if(De){const We=O.dist(R);if(We>2*Le){const Xe=O.sub(O.sub(R)._mult(Le/We)._round());this.updateDistance(R,Xe),this.addCurrentVertex(Xe,W,0,0,D,te),R=Xe}this.updateDistance(R,O),he._mult(_e),this.addCurrentVertex(O,he,0,0,D,te);const Ue=O.dist(N);if(Ue>2*Le){const Xe=O.add(N.sub(O)._mult(Le/Ue)._round());this.updateDistance(O,Xe),this.addCurrentVertex(Xe,Z,0,0,D,te),O=Xe}}else he._mult(_e),this.addCurrentVertex(O,he,0,0,D,te);else if(ie==="flipbevel"){if(_e>100)he=Z.mult(-1);else{const We=_e*W.add(Z).mag()/W.sub(Z).mag();he._perp()._mult(We*(Se?-1:1))}this.addCurrentVertex(O,he,0,0,D,te),this.addCurrentVertex(O,he.mult(-1),0,0,D,te)}else if(ie==="bevel"||ie==="fakeround"){te!=null&&R&&this.addCurrentVertex(O,W,-1,-1,D,te);const We=O.dist(R)<=2*Le&&ie!=="bevel",Ue=he.mult(Se?1:-1);Ue._mult(_e);const Xe=Z.mult(Se?-1:1),He=W.mult(Se?-1:1),nt=this.evaluateLineProgressFeatures(this.distance);if(te==null&&(this.addHalfVertex(O,Ue.x,Ue.y,!1,!Se,0,D,nt),We||this.addHalfVertex(O,Ue.x+2*He.x,Ue.y+2*He.y,!1,Se,0,D,nt)),ie==="fakeround"){const Je=Math.round(180*xe/Math.PI/20);this.addHalfVertex(O,He.x,He.y,!1,Se,0,D,nt);for(let it=0;it<Je;it++){let Mt=it/Je;if(Mt!==.5){const er=Mt-.5;Mt+=Mt*er*(Mt-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*er*er+(.848013+le*(.215638*le-1.06021)))}const At=Xe.sub(He)._mult(Mt)._add(He)._unit();this.addHalfVertex(O,At.x,At.y,!1,Se,0,D,nt)}this.addHalfVertex(O,Xe.x,Xe.y,!1,Se,0,D,nt)}We||te!=null||this.addHalfVertex(O,Ue.x+2*Xe.x,Ue.y+2*Xe.y,!1,Se,0,D,nt),te!=null&&N&&this.addCurrentVertex(O,Z,1,1,D,te)}else ie==="butt"?this.addCurrentVertex(O,he,0,0,D,te):ie==="square"?(R||this.addCurrentVertex(O,he,-1,-1,D,te),this.addCurrentVertex(O,he,0,0,D,te),R&&this.addCurrentVertex(O,he,1,1,D,te)):ie==="round"&&(R&&(this.addCurrentVertex(O,W,0,0,D,te),this.addCurrentVertex(O,W,1,1,D,te,!0)),N&&(this.addCurrentVertex(O,Z,-1,-1,D,te,!0),this.addCurrentVertex(O,Z,0,0,D,te)))}}addVerticesTo(o,c,f,m,p,v,T,M,k,w){const P=(c.w-o.w)/this.tessellationStep|0;let D=0;const O=this.scaledDistance;if(P>1){this.lineSoFar=o.w;const N=(c.x-o.x)/P,W=(c.y-o.y)/P,Z=(c.z-o.z)/P,te=(c.w-o.w)/P;for(let ee=1;ee<P;++ee){o.x+=N,o.y+=W,o.z+=Z,this.lineSoFar+=te,D+=te;const K=this.evaluateLineProgressFeatures(this.prevDistance+D);this.scaledDistance=(this.prevDistance+D)/this.totalDistance,this.addHalfVertex(o,f,m,w,!1,T,k,K),this.addHalfVertex(o,p,v,w,!0,-M,k,K)}}this.lineSoFar=c.w,this.scaledDistance=O;const R=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(c,f,m,w,!1,T,k,R),this.addHalfVertex(c,p,v,w,!0,-M,k,R)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):ai(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let c=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(c=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:c}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:c}:{zOffset:0,variableWidth:c}}addCurrentVertex(o,c,f,m,p,v,T=!1){const M=c.x+c.y*f,k=c.y-c.x*f,w=c.y*m-c.x,P=-c.y-c.x*m;if(v!=null){const D=this.hasZOffset,O=-10,R=$t+10,N=v.zOffset,W=new B6(o.x,o.y,N,this.lineSoFar),Z=!!D&&rL(o,O,R),te=this.lineSoFar,ee=this.distance;if(this.currentVertex)if(Z){const K=this.currentVertexIsOutside,ie=this.currentVertex,le=new B6(o.x,o.y,N,this.lineSoFar);if(U6(ie,le,O,R),!rL(le,O,R)){if(K){this.e1=this.e2=-1,this.distance-=ie.dist(W),this.lineSoFar=ie.w;const he=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,M,k,T,!1,f,p,he),this.addHalfVertex(ie,w,P,T,!0,-m,p,he),this.prevDistance=this.distance}this.distance=this.prevDistance+ie.dist(le),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ie,le,M,k,w,P,f,m,p,T),this.distance=ee,this.scaledDistance=this.distance/this.totalDistance}}else{const K=this.currentVertex;if(this.currentVertexIsOutside){U6(K,W,O,R),this.e1=this.e2=-1,this.distance-=K.dist(W),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=K.w;const ie=this.evaluateLineProgressFeatures(K.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(K,M,k,T,!1,f,p,ie),this.addHalfVertex(K,w,P,T,!0,-m,p,ie),this.prevDistance=this.distance,this.distance=ee,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(K,W,M,k,w,P,f,m,p,T)}else Z||(this.addHalfVertex(o,M,k,T,!1,f,p,v),this.addHalfVertex(o,w,P,T,!0,-m,p,v));this.currentVertex=W,this.currentVertexIsOutside=Z,this.lineSoFar=te}else this.addHalfVertex(o,M,k,T,!1,f,p,v),this.addHalfVertex(o,w,P,T,!0,-m,p,v)}addHalfVertex({x:o,y:c},f,m,p,v,T,M,k){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((o<<1)+(p?1:0),(c<<1)+(v?1:0),Math.round(63*f)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const P=br(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,P)}const w=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),M.primitiveLength++),v?this.e2=w:this.e1=w,k!=null&&this.zOffsetVertexArray.emplaceBack(k.zOffset,k.variableWidth,k.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,c){this.prevDistance=this.distance,this.distance+=o.dist(c),this.updateScaledDistance()}}function rL(d,o,c){return d.x<o||d.x>c||d.y<o||d.y>c}let mV,gV;function yV(d,o,c){return o*($t/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}Qt(tL,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const vV=(d,o,c)=>(1-c)*d+c*o;function _V(d,o){return 1/yV(d,1,o.tileZoom)}function xV(d,o,c,f){return d.translatePosMatrix(f||o.tileID.projMatrix,o,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const bV=d=>{const o=[];wV(d)&&o.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const c=d.paint.get("line-trim-offset");c[0]===0&&c[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),d.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");const f=d.layout.get("line-join").constantOr("miter")==="none",m=!!d.paint.get("line-pattern").constantOr(1);return f&&m&&o.push("LINE_JOIN_NONE"),o};function wV(d){const o=d.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let nL;const SV=()=>nL||(nL={layout:mV||(mV=new Ei({"line-cap":new Jt(at.layout_line["line-cap"]),"line-join":new Jt(at.layout_line["line-join"]),"line-miter-limit":new jt(at.layout_line["line-miter-limit"]),"line-round-limit":new jt(at.layout_line["line-round-limit"]),"line-sort-key":new Jt(at.layout_line["line-sort-key"]),"line-z-offset":new Jt(at.layout_line["line-z-offset"]),"line-elevation-reference":new jt(at.layout_line["line-elevation-reference"]),"line-cross-slope":new jt(at.layout_line["line-cross-slope"]),visibility:new jt(at.layout_line.visibility),"line-width-unit":new jt(at.layout_line["line-width-unit"])})),paint:gV||(gV=new Ei({"line-opacity":new Jt(at.paint_line["line-opacity"]),"line-color":new Jt(at.paint_line["line-color"]),"line-translate":new jt(at.paint_line["line-translate"]),"line-translate-anchor":new jt(at.paint_line["line-translate-anchor"]),"line-width":new Jt(at.paint_line["line-width"]),"line-gap-width":new Jt(at.paint_line["line-gap-width"]),"line-offset":new Jt(at.paint_line["line-offset"]),"line-blur":new Jt(at.paint_line["line-blur"]),"line-dasharray":new Jt(at.paint_line["line-dasharray"]),"line-pattern":new Jt(at.paint_line["line-pattern"]),"line-gradient":new Gf(at.paint_line["line-gradient"]),"line-trim-offset":new jt(at.paint_line["line-trim-offset"]),"line-trim-fade-range":new jt(at.paint_line["line-trim-fade-range"]),"line-trim-color":new jt(at.paint_line["line-trim-color"]),"line-emissive-strength":new jt(at.paint_line["line-emissive-strength"]),"line-border-width":new Jt(at.paint_line["line-border-width"]),"line-border-color":new Jt(at.paint_line["line-border-color"]),"line-occlusion-opacity":new jt(at.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},nL);class Kue extends Jt{possiblyEvaluate(o,c){return c=new Hn(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,transition:c.transition}),super.possiblyEvaluate(o,c)}evaluate(o,c,f,m){return c=Ti({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(o,c,f,m)}}let W1;function TV(d,o){return o>0?o+2*d:d}const Jue=xn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Que=xn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),ede=xn([{name:"a_projected_pos",components:4,type:"Float32"}],4);xn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const tde=xn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),rde=xn([{name:"a_texb",components:2,type:"Uint16"}]),nde=xn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),ide=xn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);xn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const EV=xn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ode=xn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);xn([{name:"triangle",components:3,type:"Uint16"}]),xn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),xn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),xn([{type:"Float32",name:"offsetX"}]),xn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var na=24;const ou=128;function AV(d,o,c,f,m){if(d.kind==="camera")return d.maxSize;if(d.kind==="composite"){const p=o.possiblyEvaluate(new Hn(d.maxZoom),c).evaluate(m,{},c),v=o.possiblyEvaluate(new Hn(d.minZoom),c).evaluate(m,{},c);return Math.max(p,v)}return o.possiblyEvaluate(new Hn(f)).evaluate(m,{},c)}function iL(d,o){const{expression:c}=o;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new Hn(d+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=c;let p=0;for(;p<f.length&&f[p]<=d;)p++;p=Math.max(0,p-1);let v=p;for(;v<f.length&&f[v]<d+1;)v++;v=Math.min(f.length-1,v);const T=f[p],M=f[v];return c.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:M,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:M,minSize:c.evaluate(new Hn(T)),maxSize:c.evaluate(new Hn(M)),interpolationType:m}}}function pA(d,{uSize:o,uSizeT:c},{lowerSize:f,upperSize:m}){return d.kind==="source"?f/ou:d.kind==="composite"?br(f/ou,m/ou,c):o}function r_(d,o,c=1){let f=0,m=0;if(d.kind==="constant")m=d.layoutSize*c;else if(d.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:T}=d,M=p?Yt(Ss.interpolationFactor(p,o,v,T),0,1):0;d.kind==="camera"?m=br(d.minSize,d.maxSize,M)*c:f=M*c}return{uSizeT:f,uSize:m}}var ade=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ou,evaluateSizeForFeature:pA,evaluateSizeForZoom:r_,getRasterizedIconSize:AV,getSizeData:iL});function sde(d,o,c){return d.sections.forEach(f=>{f.text=function(m,p,v){const T=p.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),Js.applyArabicShaping&&(m=Js.applyArabicShaping(m)),m}(f.text,o,c)}),d}const G1={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function lde(d){return d==="︶"||d==="﹈"||d==="︸"||d==="﹄"||d==="﹂"||d==="︾"||d==="︼"||d==="︺"||d==="︘"||d==="﹀"||d==="︐"||d==="︓"||d==="︔"||d==="｀"||d==="￣"||d==="︑"||d==="︒"}function cde(d){return d==="︵"||d==="﹇"||d==="︷"||d==="﹃"||d==="﹁"||d==="︽"||d==="︻"||d==="︹"||d==="︗"||d==="︿"}var CV,oL,MV,aL={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function ude(){return CV||(CV=1,aL.read=function(d,o,c,f,m){var p,v,T=8*m-f-1,M=(1<<T)-1,k=M>>1,w=-7,P=c?m-1:0,D=c?-1:1,O=d[o+P];for(P+=D,p=O&(1<<-w)-1,O>>=-w,w+=T;w>0;p=256*p+d[o+P],P+=D,w-=8);for(v=p&(1<<-w)-1,p>>=-w,w+=f;w>0;v=256*v+d[o+P],P+=D,w-=8);if(p===0)p=1-k;else{if(p===M)return v?NaN:1/0*(O?-1:1);v+=Math.pow(2,f),p-=k}return(O?-1:1)*v*Math.pow(2,p-f)},aL.write=function(d,o,c,f,m,p){var v,T,M,k=8*p-m-1,w=(1<<k)-1,P=w>>1,D=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=f?0:p-1,R=f?1:-1,N=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(T=isNaN(o)?1:0,v=w):(v=Math.floor(Math.log(o)/Math.LN2),o*(M=Math.pow(2,-v))<1&&(v--,M*=2),(o+=v+P>=1?D/M:D*Math.pow(2,1-P))*M>=2&&(v++,M/=2),v+P>=w?(T=0,v=w):v+P>=1?(T=(o*M-1)*Math.pow(2,m),v+=P):(T=o*Math.pow(2,P-1)*Math.pow(2,m),v=0));m>=8;d[c+O]=255&T,O+=R,T/=256,m-=8);for(v=v<<m|T,k+=m;k>0;d[c+O]=255&v,O+=R,v/=256,k-=8);d[c+O-R]|=128*N}),aL}function PV(){if(MV)return oL;MV=1,oL=o;var d=ude();function o(K){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(K)?K:new Uint8Array(K||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var c=4294967296,f=1/c,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function p(K){return K.type===o.Bytes?K.readVarint()+K.pos:K.pos+1}function v(K,ie,le){return le?4294967296*ie+(K>>>0):4294967296*(ie>>>0)+(K>>>0)}function T(K,ie,le){var he=ie<=16383?1:ie<=2097151?2:ie<=268435455?3:Math.floor(Math.log(ie)/(7*Math.LN2));le.realloc(he);for(var we=le.pos-1;we>=K;we--)le.buf[we+he]=le.buf[we]}function M(K,ie){for(var le=0;le<K.length;le++)ie.writeVarint(K[le])}function k(K,ie){for(var le=0;le<K.length;le++)ie.writeSVarint(K[le])}function w(K,ie){for(var le=0;le<K.length;le++)ie.writeFloat(K[le])}function P(K,ie){for(var le=0;le<K.length;le++)ie.writeDouble(K[le])}function D(K,ie){for(var le=0;le<K.length;le++)ie.writeBoolean(K[le])}function O(K,ie){for(var le=0;le<K.length;le++)ie.writeFixed32(K[le])}function R(K,ie){for(var le=0;le<K.length;le++)ie.writeSFixed32(K[le])}function N(K,ie){for(var le=0;le<K.length;le++)ie.writeFixed64(K[le])}function W(K,ie){for(var le=0;le<K.length;le++)ie.writeSFixed64(K[le])}function Z(K,ie){return(K[ie]|K[ie+1]<<8|K[ie+2]<<16)+16777216*K[ie+3]}function te(K,ie,le){K[le]=ie,K[le+1]=ie>>>8,K[le+2]=ie>>>16,K[le+3]=ie>>>24}function ee(K,ie){return(K[ie]|K[ie+1]<<8|K[ie+2]<<16)+(K[ie+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(K,ie,le){for(le=le||this.length;this.pos<le;){var he=this.readVarint(),we=he>>3,_e=this.pos;this.type=7&he,K(we,ie,this),this.pos===_e&&this.skip(he)}return ie},readMessage:function(K,ie){return this.readFields(K,ie,this.readVarint()+this.pos)},readFixed32:function(){var K=Z(this.buf,this.pos);return this.pos+=4,K},readSFixed32:function(){var K=ee(this.buf,this.pos);return this.pos+=4,K},readFixed64:function(){var K=Z(this.buf,this.pos)+Z(this.buf,this.pos+4)*c;return this.pos+=8,K},readSFixed64:function(){var K=Z(this.buf,this.pos)+ee(this.buf,this.pos+4)*c;return this.pos+=8,K},readFloat:function(){var K=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,K},readDouble:function(){var K=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,K},readVarint:function(K){var ie,le,he=this.buf;return ie=127&(le=he[this.pos++]),le<128?ie:(ie|=(127&(le=he[this.pos++]))<<7,le<128?ie:(ie|=(127&(le=he[this.pos++]))<<14,le<128?ie:(ie|=(127&(le=he[this.pos++]))<<21,le<128?ie:function(we,_e,xe){var De,Se,Le=xe.buf;if(De=(112&(Se=Le[xe.pos++]))>>4,Se<128||(De|=(127&(Se=Le[xe.pos++]))<<3,Se<128)||(De|=(127&(Se=Le[xe.pos++]))<<10,Se<128)||(De|=(127&(Se=Le[xe.pos++]))<<17,Se<128)||(De|=(127&(Se=Le[xe.pos++]))<<24,Se<128)||(De|=(1&(Se=Le[xe.pos++]))<<31,Se<128))return v(we,De,_e);throw new Error("Expected varint not more than 10 bytes")}(ie|=(15&(le=he[this.pos]))<<28,K,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var K=this.readVarint();return K%2==1?(K+1)/-2:K/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var K=this.readVarint()+this.pos,ie=this.pos;return this.pos=K,K-ie>=12&&m?function(le,he,we){return m.decode(le.subarray(he,we))}(this.buf,ie,K):function(le,he,we){for(var _e="",xe=he;xe<we;){var De,Se,Le,We=le[xe],Ue=null,Xe=We>239?4:We>223?3:We>191?2:1;if(xe+Xe>we)break;Xe===1?We<128&&(Ue=We):Xe===2?(192&(De=le[xe+1]))==128&&(Ue=(31&We)<<6|63&De)<=127&&(Ue=null):Xe===3?(Se=le[xe+2],(192&(De=le[xe+1]))==128&&(192&Se)==128&&((Ue=(15&We)<<12|(63&De)<<6|63&Se)<=2047||Ue>=55296&&Ue<=57343)&&(Ue=null)):Xe===4&&(Se=le[xe+2],Le=le[xe+3],(192&(De=le[xe+1]))==128&&(192&Se)==128&&(192&Le)==128&&((Ue=(15&We)<<18|(63&De)<<12|(63&Se)<<6|63&Le)<=65535||Ue>=1114112)&&(Ue=null)),Ue===null?(Ue=65533,Xe=1):Ue>65535&&(Ue-=65536,_e+=String.fromCharCode(Ue>>>10&1023|55296),Ue=56320|1023&Ue),_e+=String.fromCharCode(Ue),xe+=Xe}return _e}(this.buf,ie,K)},readBytes:function(){var K=this.readVarint()+this.pos,ie=this.buf.subarray(this.pos,K);return this.pos=K,ie},readPackedVarint:function(K,ie){if(this.type!==o.Bytes)return K.push(this.readVarint(ie));var le=p(this);for(K=K||[];this.pos<le;)K.push(this.readVarint(ie));return K},readPackedSVarint:function(K){if(this.type!==o.Bytes)return K.push(this.readSVarint());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readSVarint());return K},readPackedBoolean:function(K){if(this.type!==o.Bytes)return K.push(this.readBoolean());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readBoolean());return K},readPackedFloat:function(K){if(this.type!==o.Bytes)return K.push(this.readFloat());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readFloat());return K},readPackedDouble:function(K){if(this.type!==o.Bytes)return K.push(this.readDouble());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readDouble());return K},readPackedFixed32:function(K){if(this.type!==o.Bytes)return K.push(this.readFixed32());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readFixed32());return K},readPackedSFixed32:function(K){if(this.type!==o.Bytes)return K.push(this.readSFixed32());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readSFixed32());return K},readPackedFixed64:function(K){if(this.type!==o.Bytes)return K.push(this.readFixed64());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readFixed64());return K},readPackedSFixed64:function(K){if(this.type!==o.Bytes)return K.push(this.readSFixed64());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readSFixed64());return K},skip:function(K){var ie=7&K;if(ie===o.Varint)for(;this.buf[this.pos++]>127;);else if(ie===o.Bytes)this.pos=this.readVarint()+this.pos;else if(ie===o.Fixed32)this.pos+=4;else{if(ie!==o.Fixed64)throw new Error("Unimplemented type: "+ie);this.pos+=8}},writeTag:function(K,ie){this.writeVarint(K<<3|ie)},realloc:function(K){for(var ie=this.length||16;ie<this.pos+K;)ie*=2;if(ie!==this.length){var le=new Uint8Array(ie);le.set(this.buf),this.buf=le,this.length=ie}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(K){this.realloc(4),te(this.buf,K,this.pos),this.pos+=4},writeSFixed32:function(K){this.realloc(4),te(this.buf,K,this.pos),this.pos+=4},writeFixed64:function(K){this.realloc(8),te(this.buf,-1&K,this.pos),te(this.buf,Math.floor(K*f),this.pos+4),this.pos+=8},writeSFixed64:function(K){this.realloc(8),te(this.buf,-1&K,this.pos),te(this.buf,Math.floor(K*f),this.pos+4),this.pos+=8},writeVarint:function(K){(K=+K||0)>268435455||K<0?function(ie,le){var he,we;if(ie>=0?(he=ie%4294967296|0,we=ie/4294967296|0):(we=~(-ie/4294967296),4294967295^(he=~(-ie%4294967296))?he=he+1|0:(he=0,we=we+1|0)),ie>=18446744073709552e3||ie<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");le.realloc(10),function(_e,xe,De){De.buf[De.pos++]=127&_e|128,_e>>>=7,De.buf[De.pos++]=127&_e|128,_e>>>=7,De.buf[De.pos++]=127&_e|128,_e>>>=7,De.buf[De.pos++]=127&_e|128,De.buf[De.pos]=127&(_e>>>=7)}(he,0,le),function(_e,xe){var De=(7&_e)<<4;xe.buf[xe.pos++]|=De|((_e>>>=3)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e)))))}(we,le)}(K,this):(this.realloc(4),this.buf[this.pos++]=127&K|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=K>>>7&127))))},writeSVarint:function(K){this.writeVarint(K<0?2*-K-1:2*K)},writeBoolean:function(K){this.writeVarint(!!K)},writeString:function(K){K=String(K),this.realloc(4*K.length),this.pos++;var ie=this.pos;this.pos=function(he,we,_e){for(var xe,De,Se=0;Se<we.length;Se++){if((xe=we.charCodeAt(Se))>55295&&xe<57344){if(!De){xe>56319||Se+1===we.length?(he[_e++]=239,he[_e++]=191,he[_e++]=189):De=xe;continue}if(xe<56320){he[_e++]=239,he[_e++]=191,he[_e++]=189,De=xe;continue}xe=De-55296<<10|xe-56320|65536,De=null}else De&&(he[_e++]=239,he[_e++]=191,he[_e++]=189,De=null);xe<128?he[_e++]=xe:(xe<2048?he[_e++]=xe>>6|192:(xe<65536?he[_e++]=xe>>12|224:(he[_e++]=xe>>18|240,he[_e++]=xe>>12&63|128),he[_e++]=xe>>6&63|128),he[_e++]=63&xe|128)}return _e}(this.buf,K,this.pos);var le=this.pos-ie;le>=128&&T(ie,le,this),this.pos=ie-1,this.writeVarint(le),this.pos+=le},writeFloat:function(K){this.realloc(4),d.write(this.buf,K,this.pos,!0,23,4),this.pos+=4},writeDouble:function(K){this.realloc(8),d.write(this.buf,K,this.pos,!0,52,8),this.pos+=8},writeBytes:function(K){var ie=K.length;this.writeVarint(ie),this.realloc(ie);for(var le=0;le<ie;le++)this.buf[this.pos++]=K[le]},writeRawMessage:function(K,ie){this.pos++;var le=this.pos;K(ie,this);var he=this.pos-le;he>=128&&T(le,he,this),this.pos=le-1,this.writeVarint(he),this.pos+=he},writeMessage:function(K,ie,le){this.writeTag(K,o.Bytes),this.writeRawMessage(ie,le)},writePackedVarint:function(K,ie){ie.length&&this.writeMessage(K,M,ie)},writePackedSVarint:function(K,ie){ie.length&&this.writeMessage(K,k,ie)},writePackedBoolean:function(K,ie){ie.length&&this.writeMessage(K,D,ie)},writePackedFloat:function(K,ie){ie.length&&this.writeMessage(K,w,ie)},writePackedDouble:function(K,ie){ie.length&&this.writeMessage(K,P,ie)},writePackedFixed32:function(K,ie){ie.length&&this.writeMessage(K,O,ie)},writePackedSFixed32:function(K,ie){ie.length&&this.writeMessage(K,R,ie)},writePackedFixed64:function(K,ie){ie.length&&this.writeMessage(K,N,ie)},writePackedSFixed64:function(K,ie){ie.length&&this.writeMessage(K,W,ie)},writeBytesField:function(K,ie){this.writeTag(K,o.Bytes),this.writeBytes(ie)},writeFixed32Field:function(K,ie){this.writeTag(K,o.Fixed32),this.writeFixed32(ie)},writeSFixed32Field:function(K,ie){this.writeTag(K,o.Fixed32),this.writeSFixed32(ie)},writeFixed64Field:function(K,ie){this.writeTag(K,o.Fixed64),this.writeFixed64(ie)},writeSFixed64Field:function(K,ie){this.writeTag(K,o.Fixed64),this.writeSFixed64(ie)},writeVarintField:function(K,ie){this.writeTag(K,o.Varint),this.writeVarint(ie)},writeSVarintField:function(K,ie){this.writeTag(K,o.Varint),this.writeSVarint(ie)},writeStringField:function(K,ie){this.writeTag(K,o.Bytes),this.writeString(ie)},writeFloatField:function(K,ie){this.writeTag(K,o.Fixed32),this.writeFloat(ie)},writeDoubleField:function(K,ie){this.writeTag(K,o.Fixed64),this.writeDouble(ie)},writeBooleanField:function(K,ie){this.writeVarintField(K,!!ie)}},oL}var mA=_(PV());const sL=3;function dde(d,o,c){o.glyphs=[],d===1&&c.readMessage(hde,o)}function hde(d,o,c){if(d===3){const{id:f,bitmap:m,width:p,height:v,left:T,top:M,advance:k}=c.readMessage(fde,{});o.glyphs.push({id:f,bitmap:new tp({width:p+2*sL,height:v+2*sL},m),metrics:{width:p,height:v,left:T,top:M,advance:k}})}else d===4?o.ascender=c.readSVarint():d===5&&(o.descender=c.readSVarint())}function fde(d,o,c){d===1?o.id=c.readVarint():d===2?o.bitmap=c.readBytes():d===3?o.width=c.readVarint():d===4?o.height=c.readVarint():d===5?o.left=c.readSVarint():d===6?o.top=c.readSVarint():d===7&&(o.advance=c.readVarint())}const IV=sL,Ms={horizontal:1,vertical:2,horizontalOnly:3};class q1{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,c){const f=new q1;return f.scale=o||1,f.fontStack=c,f}static forImage(o){const c=new q1;return c.image=o,c}}class n_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c,f){const m=new n_;for(let p=0;p<o.sections.length;p++){const v=o.sections[p];v.image?m.addImageSection(v,f):m.addTextSection(v,c)}return m}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(c,f){let m="";for(let p=0;p<c.length;p++){const v=c.charCodeAt(p+1)||null,T=c.charCodeAt(p-1)||null;m+=!f&&(v&&n1(v)&&!G1[c[p+1]]||T&&n1(T)&&!G1[c[p-1]])||!G1[c[p]]?c[p]:G1[c[p]]}return m}(this.text,o)}trim(){let o=0;for(let f=0;f<this.text.length&&gA[this.text.charCodeAt(f)];f++)o++;let c=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&gA[this.text.charCodeAt(f)];f--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const f=new n_;return f.text=this.text.substring(o,c),f.sectionIndex=this.sectionIndex.slice(o,c),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(q1.forText(o.scale,o.fontStack||c));const f=this.sections.length-1;for(let m=0;m<o.text.length;++m)this.sectionIndex.push(f)}addImageSection(o,c){const f=o.image?o.image.getPrimary():null;if(!f)return void ai("Can't add FormattedSection with an empty image.");f.scaleSelf(c);const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCodePoint(m),this.sections.push(q1.forImage(f)),this.sectionIndex.push(this.sections.length-1)):ai("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lL(d,o,c,f,m,p,v,T,M,k,w,P,D,O,R,N=1){const W=n_.fromFeature(d,m,N);P===Ms.vertical&&W.verticalizePunctuation(D);let Z=[];const te=function(he,we,_e,xe,De,Se){if(!he)return[];const Le=[],We=function(nt,Je,it,Mt,At,er){let Rt=0;for(let Ft=0;Ft<nt.length();Ft++){const It=nt.getSection(Ft);Rt+=OV(nt.getCodePoint(Ft),It,Mt,At,Je,er)}return Rt/Math.max(1,Math.ceil(Rt/it))}(he,we,_e,xe,De,Se),Ue=he.text.indexOf("​")>=0;let Xe=0;for(let nt=0;nt<he.length();nt++){const Je=he.getSection(nt),it=he.getCodePoint(nt);if(gA[it]||(Xe+=OV(it,Je,xe,De,we,Se)),nt<he.length()-1){const Mt=!((He=it)<11904||!(vr["Bopomofo Extended"](He)||vr.Bopomofo(He)||vr["CJK Compatibility Forms"](He)||vr["CJK Compatibility Ideographs"](He)||vr["CJK Compatibility"](He)||vr["CJK Radicals Supplement"](He)||vr["CJK Strokes"](He)||vr["CJK Symbols and Punctuation"](He)||vr["CJK Unified Ideographs Extension A"](He)||vr["CJK Unified Ideographs"](He)||vr["Enclosed CJK Letters and Months"](He)||vr["Halfwidth and Fullwidth Forms"](He)||vr.Hiragana(He)||vr["Ideographic Description Characters"](He)||vr["Kangxi Radicals"](He)||vr["Katakana Phonetic Extensions"](He)||vr.Katakana(He)||vr["Vertical Forms"](He)||vr["Yi Radicals"](He)||vr["Yi Syllables"](He)));(pde[it]||Mt||Je.image)&&Le.push(RV(nt+1,Xe,We,Le,mde(it,he.getCodePoint(nt+1),Mt&&Ue),!1))}}var He;return DV(RV(he.length(),Xe,We,Le,0,!0))}(W,k,p,o,f,O),{processBidirectionalText:ee,processStyledBidirectionalText:K}=Js;if(ee&&W.sections.length===1){const he=ee(W.toString(),te);for(const we of he){const _e=new n_;_e.text=we,_e.sections=W.sections;for(let xe=0;xe<we.length;xe++)_e.sectionIndex.push(0);Z.push(_e)}}else if(K){const he=K(W.text,W.sectionIndex,te);for(const we of he){const _e=new n_;_e.text=we[0],_e.sectionIndex=we[1],_e.sections=W.sections,Z.push(_e)}}else Z=function(he,we){const _e=[],xe=he.text;let De=0;for(const Se of we)_e.push(he.substring(De,Se)),De=Se;return De<xe.length&&_e.push(he.substring(De,xe.length)),_e}(W,te);const ie=[],le={positionedLines:ie,text:W.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(he,we,_e,xe,De,Se,Le,We,Ue,Xe,He,nt){let Je=0,it=0,Mt=0;const At=We==="right"?1:We==="left"?0:.5;let er=!1;for(const or of De){const Cr=or.getSections();for(const Gr of Cr){if(Gr.image)continue;const Ir=we[Gr.fontStack];if(Ir&&(er=Ir.ascender!==void 0&&Ir.descender!==void 0,!er))break}if(!er)break}let Rt=0;for(const or of De){or.trim();const Cr=or.getMaxScale(),Gr=(Cr-1)*na,Ir={positionedGlyphs:[],lineOffset:0};he.positionedLines[Rt]=Ir;const Qr=Ir.positionedGlyphs;let Wr=0;if(!or.length()){it+=Se,++Rt;continue}let tn=0,gn=0;for(let Mr=0;Mr<or.length();Mr++){const ln=or.getSection(Mr),li=or.getSectionIndex(Mr),vi=or.getCodePoint(Mr);let Ai=ln.scale,Pi=null,Un=null,Ao=null,Wa=na,Ki=0;Ue===Ms.vertical&&((Ft=vi)===12312||Ft===12313||Ft===12316||Ft===12540||Ft===12448)&&(Ue=Ms.horizontal);const co=!(Ue===Ms.horizontal||!He&&!Rv(vi)||He&&(gA[vi]||L2(vi)));if(ln.image){const ma=xe.get(ln.image.toString());if(!ma)continue;Ao=ln.image,he.iconsInText=he.iconsInText||!0,Un=ma.paddedRect;const Xo=ma.displaySize;Ai=Ai*na/nt,Pi={width:Xo[0],height:Xo[1],left:0,top:-IV,advance:co?Xo[1]:Xo[0],localGlyph:!1},Ki=er?-Pi.height*Ai:Cr*na-17-Xo[1]*Ai,Wa=Pi.advance;const zl=(co?Xo[0]:Xo[1])*Ai-na*Cr;zl>0&&zl>Wr&&(Wr=zl)}else{const ma=_e[ln.fontStack];if(!ma)continue;ma[vi]&&(Un=ma[vi]);const Xo=we[ln.fontStack];if(!Xo)continue;const zl=Xo.glyphs[vi];if(!zl)continue;if(Pi=zl.metrics,Wa=vi!==8203?na:0,er){const cp=Xo.ascender!==void 0?Math.abs(Xo.ascender):0,yc=Xo.descender!==void 0?Math.abs(Xo.descender):0,uu=(cp+yc)*Ai;tn<uu&&(tn=uu,gn=(cp-yc)/2*Ai),Ki=-cp*Ai}else Ki=(Cr-Ai)*na-17}co?(he.verticalizable=!0,Qr.push({glyph:vi,image:Ao,x:Je,y:it+Ki,vertical:co,scale:Ai,localGlyph:Pi.localGlyph,fontStack:ln.fontStack,sectionIndex:li,metrics:Pi,rect:Un}),Je+=Wa*Ai+Xe):(Qr.push({glyph:vi,image:Ao,x:Je,y:it+Ki,vertical:co,scale:Ai,localGlyph:Pi.localGlyph,fontStack:ln.fontStack,sectionIndex:li,metrics:Pi,rect:Un}),Je+=Pi.advance*Ai+Xe)}Qr.length!==0&&(Mt=Math.max(Je-Xe,Mt),er?LV(Qr,At,Wr,gn,Se*Cr/2):LV(Qr,At,Wr,0,Se/2)),Je=0;const Zn=Se*Cr+Wr;Ir.lineOffset=Math.max(Wr,Gr),it+=Zn,++Rt}var Ft;const It=it,{horizontalAlign:_r,verticalAlign:Xt}=cL(Le);(function(or,Cr,Gr,Ir,Qr,Wr){const tn=(Cr-Gr)*Qr,gn=-Wr*Ir;for(const Zn of or)for(const Mr of Zn.positionedGlyphs)Mr.x+=tn,Mr.y+=gn})(he.positionedLines,At,_r,Xt,Mt,It),he.top+=-Xt*It,he.bottom=he.top+It,he.left+=-_r*Mt,he.right=he.left+Mt,he.hasBaseline=er}(le,o,c,f,Z,v,T,M,P,k,D,R),!function(he){for(const we of he)if(we.positionedGlyphs.length!==0)return!1;return!0}(ie))return le}const gA={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pde={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function OV(d,o,c,f,m,p){if(o.image){const v=f.get(o.image.toString());return v?v.displaySize[0]*o.scale*na/p+m:0}{const v=c[o.fontStack],T=v&&v.glyphs[d];return T?T.metrics.advance*o.scale+m:0}}function kV(d,o,c,f){const m=Math.pow(d-o,2);return f?d<o?m/2:2*m:m+Math.abs(c)*c}function mde(d,o,c){let f=0;return d===10&&(f-=1e4),c&&(f+=150),d!==40&&d!==65288||(f+=50),o!==41&&o!==65289||(f+=50),f}function RV(d,o,c,f,m,p){let v=null,T=kV(o,c,m,p);for(const M of f){const k=kV(o-M.x,c,m,p)+M.badness;k<=T&&(v=M,T=k)}return{index:d,x:o,priorBreak:v,badness:T}}function DV(d){return d?DV(d.priorBreak).concat(d.index):[]}function cL(d){let o=.5,c=.5;switch(d){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function LV(d,o,c,f,m){if(!(o||c||f||m))return;const p=d.length-1,v=d[p],T=(v.x+v.metrics.advance*v.scale)*o;for(let M=0;M<=p;M++)d[M].x-=T,d[M].y+=c+f+m}function gde(d,o,c,f){const{horizontalAlign:m,verticalAlign:p}=cL(f),v=c[0]-d.displaySize[0]*m,T=c[1]-d.displaySize[1]*p;return{imagePrimary:d,imageSecondary:o,top:T,bottom:T+d.displaySize[1],left:v,right:v+d.displaySize[0]}}function NV(d,o,c,f,m,p){const v=d.imagePrimary;let T;if(v.content){const W=v.content,Z=v.pixelRatio||1;T=[W[0]/Z,W[1]/Z,v.displaySize[0]-W[2]/Z,v.displaySize[1]-W[3]/Z]}const M=o.left*p,k=o.right*p;let w,P,D,O;c==="width"||c==="both"?(O=m[0]+M-f[3],P=m[0]+k+f[1]):(O=m[0]+(M+k-v.displaySize[0])/2,P=O+v.displaySize[0]);const R=o.top*p,N=o.bottom*p;return c==="height"||c==="both"?(w=m[1]+R-f[0],D=m[1]+N+f[2]):(w=m[1]+(R+N-v.displaySize[1])/2,D=w+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:w,right:P,bottom:D,left:O,collisionPadding:T}}class fh extends xt{constructor(o,c,f,m,p){super(o,c),this.angle=m,this.z=f,p!==void 0&&(this.segment=p)}clone(){return new fh(this.x,this.y,this.z,this.angle,this.segment)}}function zV(d,o,c,f,m){if(o.segment===void 0)return!0;let p=o,v=o.segment+1,T=0;for(;T>-c/2;){if(v--,v<0)return!1;T-=d[v].dist(p),p=d[v]}T+=d[v].dist(d[v+1]),v++;const M=[];let k=0;for(;T<c/2;){const w=d[v],P=d[v+1];if(!P)return!1;let D=d[v-1].angleTo(w)-w.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:T,angleDelta:D}),k+=D;T-M[0].distance>f;)k-=M.shift().angleDelta;if(k>m)return!1;v++,T+=w.dist(P)}return!0}function jV(d){let o=0;for(let c=0;c<d.length-1;c++)o+=d[c].dist(d[c+1]);return o}function FV(d,o,c){return d?.6*o*c:0}function BV(d,o){return Math.max(d?d.right-d.left:0,o?o.right-o.left:0)}function yde(d,o,c,f,m,p){const v=FV(c,m,p),T=BV(c,f)*p;let M=0;const k=jV(d)/2;for(let w=0;w<d.length-1;w++){const P=d[w],D=d[w+1],O=P.dist(D);if(M+O>k){const R=(k-M)/O,N=br(P.x,D.x,R),W=br(P.y,D.y,R),Z=new fh(N,W,0,D.angleTo(P),w);return!v||zV(d,Z,T,v,o)?Z:void 0}M+=O}}function vde(d,o,c,f,m,p,v,T,M){const k=FV(f,p,v),w=BV(f,m),P=w*v,D=d[0].x===0||d[0].x===M||d[0].y===0||d[0].y===M;return o-P<o/4&&(o=P+o/4),$V(d,D?o/2*T%o:(w/2+2*p)*v*T%o,o,k,c,P,D,!1,M)}function $V(d,o,c,f,m,p,v,T,M){const k=p/2,w=jV(d);let P=0,D=o-c,O=[];for(let R=0;R<d.length-1;R++){const N=d[R],W=d[R+1],Z=N.dist(W),te=W.angleTo(N);for(;D+c<P+Z;){D+=c;const ee=(D-P)/Z,K=br(N.x,W.x,ee),ie=br(N.y,W.y,ee);if(K>=0&&K<M&&ie>=0&&ie<M&&D-k>=0&&D+k<=w){const le=new fh(K,ie,0,te,R);f&&!zV(d,le,p,f,m)||O.push(le)}}P+=Z}return T||O.length||v||(O=$V(d,P/2,c,f,m,p,v,!0,M)),O}function UV(d,o,c,f,m){const p=[];for(let v=0;v<d.length;v++){const T=d[v];let M;for(let k=0;k<T.length-1;k++){let w=T[k],P=T[k+1];w.x<o&&P.x<o||(w.x<o?w=new xt(o,w.y+(o-w.x)/(P.x-w.x)*(P.y-w.y))._round():P.x<o&&(P=new xt(o,w.y+(o-w.x)/(P.x-w.x)*(P.y-w.y))._round()),w.y<c&&P.y<c||(w.y<c?w=new xt(w.x+(c-w.y)/(P.y-w.y)*(P.x-w.x),c)._round():P.y<c&&(P=new xt(w.x+(c-w.y)/(P.y-w.y)*(P.x-w.x),c)._round()),w.x>=f&&P.x>=f||(w.x>=f?w=new xt(f,w.y+(f-w.x)/(P.x-w.x)*(P.y-w.y))._round():P.x>=f&&(P=new xt(f,w.y+(f-w.x)/(P.x-w.x)*(P.y-w.y))._round()),w.y>=m&&P.y>=m||(w.y>=m?w=new xt(w.x+(m-w.y)/(P.y-w.y)*(P.x-w.x),m)._round():P.y>=m&&(P=new xt(w.x+(m-w.y)/(P.y-w.y)*(P.x-w.x),m)._round()),M&&w.equals(M[M.length-1])||(M=[w],p.push(M)),M.push(P)))))}}return p}function VV(d){let o=0,c=0;for(const v of d)o+=v.w*v.h,c=Math.max(c,v.w);d.sort((v,T)=>T.h-v.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let m=0,p=0;for(const v of d)for(let T=f.length-1;T>=0;T--){const M=f[T];if(!(v.w>M.w||v.h>M.h)){if(v.x=M.x,v.y=M.y,p=Math.max(p,v.y+v.h),m=Math.max(m,v.x+v.w),v.w===M.w&&v.h===M.h){const k=f.pop();T<f.length&&(f[T]=k)}else v.h===M.h?(M.x+=v.w,M.w-=v.w):v.w===M.w?(M.y+=v.h,M.h-=v.h):(f.push({x:M.x+v.w,y:M.y,w:M.w-v.w,h:v.h}),M.y+=v.h,M.h-=v.h);break}}return{w:m,h:p,fill:o/(m*p)||0}}Qt(fh,"Anchor");const i_=1;class H1{static getImagePositionScale(o,c,f){if(c&&o&&o.options&&o.options.transform){const m=o.options.transform;return{x:m.a,y:m.d}}return{x:f,y:f}}constructor(o,c,f,m){this.paddedRect=o;const{pixelRatio:p,version:v,stretchX:T,stretchY:M,content:k,sdf:w,usvg:P}=c;this.pixelRatio=p,this.stretchX=T,this.stretchY=M,this.content=k,this.version=v,this.padding=f,this.sdf=w,this.scale=H1.getImagePositionScale(m,P,p)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function WV(d,o,c){const f=cc.parse(d),m=function(p,v,T=[1,1]){return{x:0,y:0,w:(p.data?p.data.width:p.width*T[0])+2*v,h:(p.data?p.data.height:p.height*T[1])+2*v}}(o,c,[f.options.transform.a,f.options.transform.d]);return{bin:m,imagePosition:new H1(m,o,c,f),imageVariant:f}}class GV{constructor(o,c,f){const m=new Map,p=new Map;this.haveRenderCallbacks=[];const v=[];this.addImages(o,m,i_,v),this.addImages(c,p,2,v);const{w:T,h:M}=VV(v),k=new ra({width:T||1,height:M||1});for(const[w,P]of o.entries()){const D=m.get(w).paddedRect;ra.copy(P.data,k,{x:0,y:0},{x:D.x+i_,y:D.y+i_},P.data,f,P.sdf)}for(const[w,P]of c.entries()){const D=p.get(w),O=D.paddedRect;let R=D.padding;const N=O.x+R,W=O.y+R,Z=P.data.width,te=P.data.height;R=R>1?R-1:R,ra.copy(P.data,k,{x:0,y:0},{x:N,y:W},P.data,f),ra.copy(P.data,k,{x:0,y:te-R},{x:N,y:W-R},{width:Z,height:R},f),ra.copy(P.data,k,{x:0,y:0},{x:N,y:W+te},{width:Z,height:R},f),ra.copy(P.data,k,{x:Z-R,y:0},{x:N-R,y:W},{width:R,height:te},f),ra.copy(P.data,k,{x:0,y:0},{x:N+Z,y:W},{width:R,height:te},f),ra.copy(P.data,k,{x:Z-R,y:te-R},{x:N-R,y:W-R},{width:R,height:R},f),ra.copy(P.data,k,{x:0,y:te-R},{x:N+Z,y:W-R},{width:R,height:R},f),ra.copy(P.data,k,{x:0,y:0},{x:N+Z,y:W+te},{width:R,height:R},f),ra.copy(P.data,k,{x:Z-R,y:0},{x:N-R,y:W+te},{width:R,height:R},f)}this.lut=f,this.image=k,this.iconPositions=m,this.patternPositions=p}addImages(o,c,f,m){for(const[p,v]of o.entries()){const{bin:T,imagePosition:M,imageVariant:k}=WV(p,v,f);c.set(p,M),m.push(T),v.hasRenderCallback&&this.haveRenderCallbacks.push(k.id)}}patchUpdatedImages(o,c,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>o.hasImage(m,f)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const m of o.getUpdatedImages(f)){for(const p of this.iconPositions.keys()){const v=cc.parse(p);if($a.isEqual(v.id,m)){const T=o.getImage(m,f);this.patchUpdatedImage(this.iconPositions.get(p),T,c)}}for(const p of this.patternPositions.keys()){const v=cc.parse(p);if($a.isEqual(v.id,m)){const T=o.getImage(m,f);this.patchUpdatedImage(this.patternPositions.get(p),T,c)}}}}patchUpdatedImage(o,c,f){if(!o||!c||o.version===c.version)return;o.version=c.version;const[m,p]=o.tl,v=o.sdf;if(this.lut||v){const T={width:c.data.width,height:c.data.height},M=new ra(T);ra.copy(c.data,M,{x:0,y:0},{x:0,y:0},T,this.lut,v),f.update(M,{position:{x:m,y:p}})}else f.update(c.data,{position:{x:m,y:p}})}}Qt(H1,"ImagePosition"),Qt(GV,"ImageAtlas");const Z1=1e20;function qV(d,o,c,f,m,p,v,T,M){for(let k=o;k<o+f;k++)HV(d,c*p+k,p,m,v,T,M);for(let k=c;k<c+m;k++)HV(d,k*p+o,1,f,v,T,M)}function HV(d,o,c,f,m,p,v){p[0]=0,v[0]=-Z1,v[1]=Z1,m[0]=d[o];for(let T=1,M=0,k=0;T<f;T++){m[T]=d[o+T*c];const w=T*T;do{const P=p[M];k=(m[T]-m[P]+w-P*P)/(T-P)/2}while(k<=v[M]&&--M>-1);M++,p[M]=T,v[M]=k,v[M+1]=Z1}for(let T=0,M=0;T<f;T++){for(;v[M+1]<T;)M++;const k=p[M],w=T-k;d[o+T*c]=m[k]+w*w}}const au=2,uL={none:0,ideographs:1,all:2};class o_{constructor(o,c,f){this.requestManager=o,this.localGlyphMode=c,this.localFontFamily=f,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,c){this.urls[c]=o}getGlyphs(o,c,f){const m=[],p=this.urls[c]||fe.GLYPHS_URL;for(const v in o)for(const T of o[v])m.push({stack:v,id:T});Bn(m,({stack:v,id:T},M)=>{let k=this.entries[v];k||(k=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=k.glyphs[T];if(w!==void 0)return void M(null,{stack:v,id:T,glyph:w});if(w=this._tinySDF(k,v,T),w)return k.glyphs[T]=w,void M(null,{stack:v,id:T,glyph:w});const P=Math.floor(T/256);if(256*P>65535)return ai("glyphs > 65535 not supported"),void M(null,{stack:v,id:T,glyph:w});if(k.ranges[P])return void M(null,{stack:v,id:T,glyph:w});let D=k.requests[P];D||(D=k.requests[P]=[],o_.loadGlyphRange(v,P,p,this.requestManager,(O,R)=>{if(R){k.ascender=R.ascender,k.descender=R.descender;for(const N in R.glyphs)this._doesCharSupportLocalGlyph(+N)||(k.glyphs[+N]=R.glyphs[+N]);k.ranges[P]=!0}for(const N of D)N(O,R);delete k.requests[P]})),D.push((O,R)=>{O?M(O):R&&M(null,{stack:v,id:T,glyph:R.glyphs[T]||null})})},(v,T)=>{if(v)f(v);else if(T){const M={};for(const{stack:k,id:w,glyph:P}of T)M[k]===void 0&&(M[k]={}),M[k].glyphs===void 0&&(M[k].glyphs={}),M[k].glyphs[w]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},M[k].ascender=this.entries[k].ascender,M[k].descender=this.entries[k].descender;f(null,M)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==uL.none&&(this.localGlyphMode===uL.all?!!this.localFontFamily:!!this.localFontFamily&&(vr["CJK Unified Ideographs"](o)||vr["Hangul Syllables"](o)||vr.Hiragana(o)||vr.Katakana(o)||vr["CJK Symbols and Punctuation"](o)||vr["CJK Unified Ideographs Extension A"](o)||vr["CJK Unified Ideographs Extension B"](o)||vr.Osage(o)))}_tinySDF(o,c,f){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(f))return;let p=o.tinySDF;if(!p){let N="400";/bold/i.test(c)?N="900":/medium/i.test(c)?N="500":/light/i.test(c)&&(N="200"),p=o.tinySDF=new o_.TinySDF({fontFamily:m,fontWeight:N,fontSize:24*au,buffer:3*au,radius:8*au}),p.fontWeight=N}if(this.localGlyphs[p.fontWeight][f])return this.localGlyphs[p.fontWeight][f];const v=String.fromCodePoint(f),{data:T,width:M,height:k,glyphWidth:w,glyphHeight:P,glyphLeft:D,glyphTop:O,glyphAdvance:R}=p.draw(v);return this.localGlyphs[p.fontWeight][f]={id:f,bitmap:new tp({width:M,height:k},T),metrics:{width:w/au,height:P/au,left:D/au,top:O/au-27,advance:R/au,localGlyph:!0}}}}o_.loadGlyphRange=function(d,o,c,f,m){const p=256*o,v=p+255,T=f.transformRequest(f.normalizeGlyphsURL(c).replace("{fontstack}",d).replace("{range}",`${p}-${v}`),Lo.Glyphs);$c(T,(M,k)=>{if(M)m(M);else if(k){const w={},P=function(D){return new mA(D).readFields(dde,{})}(k);for(const D of P.glyphs)w[D.id]=D;m(null,{glyphs:w,ascender:P.ascender,descender:P.descender})}})},o_.TinySDF=class{constructor({fontSize:d=24,buffer:o=3,radius:c=8,cutoff:f=.25,fontFamily:m="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=c;const T=this.size=d+4*o,M=this._createCanvas(T),k=this.ctx=M.getContext("2d",{willReadFrequently:!0});k.font=`${v} ${p} ${d}px ${m}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(d){const o=document.createElement("canvas");return o.width=o.height=d,o}draw(d){const{width:o,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:m,actualBoundingBoxRight:p}=this.ctx.measureText(d),v=Math.ceil(c),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-m))),M=Math.min(this.size-this.buffer,v+Math.ceil(f)),k=T+2*this.buffer,w=M+2*this.buffer,P=Math.max(k*w,0),D=new Uint8ClampedArray(P),O={data:D,width:k,height:w,glyphWidth:T,glyphHeight:M,glyphTop:v,glyphLeft:0,glyphAdvance:o};if(T===0||M===0)return O;const{ctx:R,buffer:N,gridInner:W,gridOuter:Z}=this;R.clearRect(N,N,T,M),R.fillText(d,N,N+v);const te=R.getImageData(N,N,T,M);Z.fill(Z1,0,P),W.fill(0,0,P);for(let ee=0;ee<M;ee++)for(let K=0;K<T;K++){const ie=te.data[4*(ee*T+K)+3]/255;if(ie===0)continue;const le=(ee+N)*k+K+N;if(ie===1)Z[le]=0,W[le]=Z1;else{const he=.5-ie;Z[le]=he>0?he*he:0,W[le]=he<0?he*he:0}}qV(Z,0,0,k,w,k,this.f,this.v,this.z),qV(W,N,N,T,M,k,this.f,this.v,this.z);for(let ee=0;ee<P;ee++){const K=Math.sqrt(Z[ee])-Math.sqrt(W[ee]);D[ee]=Math.round(255-255*(K/this.radius+this.cutoff))}return O}};const ip=i_;function ZV(d,o){return d+o[1]-o[0]}function XV(d,o,c,f,m=1){const p=[],v=d.imagePrimary,T=v.pixelRatio,M=v.paddedRect.w-2*ip,k=v.paddedRect.h-2*ip,w=(d.right-d.left)*m,P=(d.bottom-d.top)*m,D=v.stretchX||[[0,M]],O=v.stretchY||[[0,k]],R=D.reduce(ZV,0),N=O.reduce(ZV,0),W=M-R,Z=k-N;let te=0,ee=R,K=0,ie=N,le=0,he=W,we=0,_e=Z;if(v.content&&f){const De=v.content;te=yA(D,0,De[0]),K=yA(O,0,De[1]),ee=yA(D,De[0],De[2]),ie=yA(O,De[1],De[3]),le=De[0]-te,we=De[1]-K,he=De[2]-De[0]-ee,_e=De[3]-De[1]-ie}const xe=(De,Se,Le,We)=>{const Ue=vA(De.stretch-te,ee,w,d.left*m),Xe=_A(De.fixed-le,he,De.stretch,R),He=vA(Se.stretch-K,ie,P,d.top*m),nt=_A(Se.fixed-we,_e,Se.stretch,N),Je=vA(Le.stretch-te,ee,w,d.left*m),it=_A(Le.fixed-le,he,Le.stretch,R),Mt=vA(We.stretch-K,ie,P,d.top*m),At=_A(We.fixed-we,_e,We.stretch,N),er=new xt(Ue,He),Rt=new xt(Je,He),Ft=new xt(Je,Mt),It=new xt(Ue,Mt),_r=new xt(Xe/T,nt/T),Xt=new xt(it/T,At/T),or=o*Math.PI/180;if(or){const tn=Math.sin(or),gn=Math.cos(or),Zn=[gn,-tn,tn,gn];er._matMult(Zn),Rt._matMult(Zn),It._matMult(Zn),Ft._matMult(Zn)}const Cr=De.stretch+De.fixed,Gr=Le.stretch+Le.fixed,Ir=Se.stretch+Se.fixed,Qr=We.stretch+We.fixed,Wr=d.imageSecondary;return{tl:er,tr:Rt,bl:It,br:Ft,texPrimary:{x:v.paddedRect.x+ip+Cr,y:v.paddedRect.y+ip+Ir,w:Gr-Cr,h:Qr-Ir},texSecondary:Wr?{x:Wr.paddedRect.x+ip+Cr,y:Wr.paddedRect.y+ip+Ir,w:Gr-Cr,h:Qr-Ir}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:_r,pixelOffsetBR:Xt,minFontScaleX:he/T/w,minFontScaleY:_e/T/P,isSDF:c}};if(f&&(v.stretchX||v.stretchY)){const De=YV(D,W,R),Se=YV(O,Z,N);for(let Le=0;Le<De.length-1;Le++){const We=De[Le],Ue=De[Le+1];for(let Xe=0;Xe<Se.length-1;Xe++)p.push(xe(We,Se[Xe],Ue,Se[Xe+1]))}}else p.push(xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:k+1}));return p}function yA(d,o,c){let f=0;for(const m of d)f+=Math.max(o,Math.min(c,m[1]))-Math.max(o,Math.min(c,m[0]));return f}function YV(d,o,c){const f=[{fixed:-ip,stretch:0}];for(const[m,p]of d){const v=f[f.length-1];f.push({fixed:m-v.stretch,stretch:v.stretch}),f.push({fixed:m-v.stretch,stretch:v.stretch+(p-m)})}return f.push({fixed:o+ip,stretch:c}),f}function vA(d,o,c,f){return d/o*c+f}function _A(d,o,c,f){return d-o*c/f}function _de(d,o,c,f){const m=o+d.positionedLines[f].lineOffset;return f===0?c+m/2:c+(m+(o+d.positionedLines[f-1].lineOffset))/2}function xde(d,o=1,c=!1){let f=1/0,m=1/0,p=-1/0,v=-1/0;const T=d[0];for(let O=0;O<T.length;O++){const R=T[O];(!O||R.x<f)&&(f=R.x),(!O||R.y<m)&&(m=R.y),(!O||R.x>p)&&(p=R.x),(!O||R.y>v)&&(v=R.y)}const M=Math.min(p-f,v-m);let k=M/2;const w=new Ym([],bde);if(M===0)return new xt(f,m);for(let O=f;O<p;O+=M)for(let R=m;R<v;R+=M)w.push(new a_(O+k,R+k,k,d));let P=function(O){let R=0,N=0,W=0;const Z=O[0];for(let te=0,ee=Z.length,K=ee-1;te<ee;K=te++){const ie=Z[te],le=Z[K],he=ie.x*le.y-le.x*ie.y;N+=(ie.x+le.x)*he,W+=(ie.y+le.y)*he,R+=3*he}return new a_(N/R,W/R,0,O)}(d),D=w.length;for(;w.length;){const O=w.pop();(O.d>P.d||!P.d)&&(P=O,c&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,D)),O.max-P.d<=o||(k=O.h/2,w.push(new a_(O.p.x-k,O.p.y-k,k,d)),w.push(new a_(O.p.x+k,O.p.y-k,k,d)),w.push(new a_(O.p.x-k,O.p.y+k,k,d)),w.push(new a_(O.p.x+k,O.p.y+k,k,d)),D+=4)}return c&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function bde(d,o){return o.max-d.max}class a_{constructor(o,c,f,m){this.p=new xt(o,c),this.h=f,this.d=function(p,v){let T=!1,M=1/0;for(let k=0;k<v.length;k++){const w=v[k];for(let P=0,D=w.length,O=D-1;P<D;O=P++){const R=w[P],N=w[O];R.y>p.y!=N.y>p.y&&p.x<(N.x-R.x)*(p.y-R.y)/(N.y-R.y)+R.x&&(T=!T),M=Math.min(M,Re(p,R,N))}}return(T?1:-1)*Math.sqrt(M)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const dL=Number.POSITIVE_INFINITY,wde=Math.sqrt(2);function KV(d,[o,c]){let f=0,m=0;if(c===dL){o<0&&(o=0);const p=o/wde;switch(d){case"top-right":case"top-left":m=p-7;break;case"bottom-right":case"bottom-left":m=7-p;break;case"bottom":m=7-o;break;case"top":m=o-7}switch(d){case"top-right":case"bottom-right":f=-p;break;case"top-left":case"bottom-left":f=p;break;case"left":f=o;break;case"right":f=-o}}else{switch(o=Math.abs(o),c=Math.abs(c),d){case"top-right":case"top-left":case"top":m=c-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-c}switch(d){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}}return[f,m]}function JV(d,o,c,f,m,p,v,T){if(!d)return;const M=AV(o,c,f,m,p);return d.scaleSelf(M*T*v)}function QV(d,o,c,f,m,p,v,T){return{iconPrimary:JV(d.getPrimary(),o,c,f,m,p,v,T),iconSecondary:JV(d.getSecondary(),o,c,f,m,p,v,T)}}function e8(d,o,c,f){if(!d)return;const m=o.get(c.toString());if(d.imagePrimary=m,f){const p=o.get(f.toString());d.imageSecondary=p}}function Sde(d,o){for(const c in d.horizontal)t8(d.horizontal[c],o);t8(d.vertical,o)}function t8(d,o){if(d){for(const c of d.positionedLines)for(const f of c.positionedGlyphs)if(f.image!==null){const m=f.image.toString();f.rect=o.get(m).paddedRect}}}function hL(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Tde(d,o,c,f,m,p,v,T,M){const k=fL(p.horizontal)||p.vertical,w=c.get("icon-text-fit-padding").evaluate(f,{},m);let P,D=o;return o&&M!=="none"&&(d.allowVerticalPlacement&&p.vertical&&(P=NV(o,p.vertical,M,w,T,v)),k&&(D=NV(o,k,M,w,T,v))),{defaultShapedIcon:D,verticallyShapedIcon:P}}function Ede(d,o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z,te,ee){let K=v.textMaxSize.evaluate(o,{},D);K===void 0?K=T*v.textScaleFactor:K*=v.textScaleFactor;const ie=d.layers[0].layout,le=fL(c.horizontal)||c.vertical,he=O.name==="globe",we=na,_e=d.tilePixelRatio*K/we,xe=(Xe=d.overscaling,d.zoom>18&&Xe>2&&(Xe>>=1),Math.max($t/(512*Xe),1)*ie.get("symbol-spacing")),De=ie.get("text-padding")*d.tilePixelRatio,Se=ie.get("icon-padding")*d.tilePixelRatio,Le=Ge(ie.get("text-max-angle")),We=ie.get("icon-rotation-alignment")==="map"&&ee!=="point",Ue=xe/2;var Xe;d.hasAnyIconTextFit===!1&&W!=="none"&&(d.hasAnyIconTextFit=!0);const He=o.properties?+o.properties[Tg]:null,nt=He&&d.elevationFeatureIdToIndex?d.elevationFeatureIdToIndex.get(He):65535,Je=(it,Mt,At)=>{if(Mt.x<0||Mt.x>=$t||Mt.y<0||Mt.y>=$t)return;let er=null;if(he){const{x:Rt,y:Ft,z:It}=O.projectTilePoint(Mt.x,Mt.y,At);er={anchor:new fh(Rt,Ft,It,0,void 0),up:O.upVector(At,Mt.x,Mt.y)}}(function(Rt,Ft,It,_r,Xt,or,Cr,Gr,Ir,Qr,Wr,tn,gn,Zn,Mr,ln,li,vi,Ai,Pi,Un,Ao,Wa,Ki,co,ma,Xo,zl,cp){const yc=Rt.addToLineVertexArray(Ft,_r);let uu,up,dp,Og,zW,jW,FW,BW=0,$W=0,UW=0,VW=0,qL=-1,HL=-1;const ud={};let WW=bs("");const kg=It?It.anchor:Ft,ZL=zl!=="none";let XL=0,YL=0;if(Ir._unevaluatedLayout.getValue("text-radial-offset")===void 0?[XL,YL]=Ir.layout.get("text-offset").evaluate(Un,{},co).map(jl=>jl*na):(XL=Ir.layout.get("text-radial-offset").evaluate(Un,{},co)*na,YL=dL),Rt.allowVerticalPlacement&&Xt.vertical){const jl=Xt.vertical;if(Mr)jW=pL(jl),Gr&&(FW=pL(Gr));else{const Ps=Ir.layout.get("text-rotate").evaluate(Un,{},co)+90;dp=xA(Qr,kg,Ft,Wr,tn,gn,jl,Zn,Ps,ln),Gr&&(Og=xA(Qr,kg,Ft,Wr,tn,gn,Gr,vi,Ps))}}if(or){const jl=Rt.iconSizeData,Ps=Ir.layout.get("icon-rotate").evaluate(Un,{},co),fw=XV(or,Ps,Wa,ZL,Ao.iconScaleFactor),JL=Gr?XV(Gr,Ps,Wa,ZL,Ao.iconScaleFactor):void 0;up=xA(Qr,kg,Ft,Wr,tn,gn,or,vi,Ps,null),BW=4*fw.length;let Rg=null;jl.kind==="source"?(Rg=[ou*Ir.layout.get("icon-size").evaluate(Un,{},co)*Ao.iconScaleFactor],Rg[0]>op&&ai(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${X1}. Reduce your "icon-size".`)):jl.kind==="composite"&&(Rg=[ou*Ao.compositeIconSizes[0].evaluate(Un,{},co)*Ao.iconScaleFactor,ou*Ao.compositeIconSizes[1].evaluate(Un,{},co)*Ao.iconScaleFactor],(Rg[0]>op||Rg[1]>op)&&ai(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${X1}. Reduce your "icon-size".`)),Rt.addSymbols(Rt.icon,fw,Rg,Pi,Ai,Un,!1,It,Ft,yc.lineStartIndex,yc.lineLength,-1,Ki,co,ma,Xo),qL=Rt.icon.placedSymbolArray.length-1,JL&&($W=4*JL.length,Rt.addSymbols(Rt.icon,JL,Rg,Pi,Ai,Un,Ms.vertical,It,Ft,yc.lineStartIndex,yc.lineLength,-1,Ki,co,ma,Xo),HL=Rt.icon.placedSymbolArray.length-1)}for(const jl in Xt.horizontal){const Ps=Xt.horizontal[jl];uu||(WW=bs(Ps.text),Mr?zW=pL(Ps):uu=xA(Qr,kg,Ft,Wr,tn,gn,Ps,Zn,Ir.layout.get("text-rotate").evaluate(Un,{},co),ln));const fw=Ps.positionedLines.length===1;if(UW+=r8(Rt,It,Ft,Ps,Cr,Ir,Mr,Un,ln,yc,Xt.vertical?Ms.horizontal:Ms.horizontalOnly,fw?Object.keys(Xt.horizontal):[jl],ud,qL,Ao,Ki,co,ma),fw)break}Xt.vertical&&(VW+=r8(Rt,It,Ft,Xt.vertical,Cr,Ir,Mr,Un,ln,yc,Ms.vertical,["vertical"],ud,HL,Ao,Ki,co,ma));let hp=-1;const KL=(jl,Ps)=>jl?Math.max(jl,Ps):Ps;hp=KL(zW,hp),hp=KL(jW,hp),hp=KL(FW,hp);const nfe=hp>-1?1:0;Rt.glyphOffsetArray.length>=65535&&ai("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Un.sortKey!==void 0&&Rt.addToSortKeyRanges(Rt.symbolInstances.length,Un.sortKey),Rt.symbolInstances.emplaceBack(Ft.x,Ft.y,kg.x,kg.y,kg.z,ud.right>=0?ud.right:-1,ud.center>=0?ud.center:-1,ud.left>=0?ud.left:-1,ud.vertical>=0?ud.vertical:-1,qL,HL,WW,uu!==void 0?uu:Rt.collisionBoxArray.length,uu!==void 0?uu+1:Rt.collisionBoxArray.length,dp!==void 0?dp:Rt.collisionBoxArray.length,dp!==void 0?dp+1:Rt.collisionBoxArray.length,up!==void 0?up:Rt.collisionBoxArray.length,up!==void 0?up+1:Rt.collisionBoxArray.length,Og||Rt.collisionBoxArray.length,Og?Og+1:Rt.collisionBoxArray.length,Wr,UW,VW,BW,$W,nfe,0,XL,YL,hp,0,ZL?1:0,cp)})(d,Mt,er,it,c,f,p,m,d.layers[0],d.collisionBoxArray,o.index,o.sourceLayerIndex,d.index,De,te,k,0,Se,We,Z,o,v,w,P,D,R,N,W,nt)};if(ee==="line")for(const it of UV(o.geometry,0,0,$t,$t)){const Mt=vde(it,xe,Le,c.vertical||le,f,we,_e,d.overscaling,$t);for(const At of Mt)le&&Ade(d,le.text,Ue,At)||Je(it,At,D)}else if(ee==="line-center"){for(const it of o.geometry)if(it.length>1){const Mt=yde(it,Le,c.vertical||le,f,we,_e);Mt&&Je(it,Mt,D)}}else if(o.type==="Polygon")for(const it of sA(o.geometry,0)){const Mt=xde(it,16);Je(it[0],new fh(Mt.x,Mt.y,0,0,void 0),D)}else if(o.type==="LineString")for(const it of o.geometry)Je(it,new fh(it[0].x,it[0].y,0,0,void 0),D);else if(o.type==="Point")for(const it of o.geometry)for(const Mt of it)Je([Mt],new fh(Mt.x,Mt.y,0,0,void 0),D)}const X1=255,op=X1*ou;function r8(d,o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W,Z){const te=function(ie,le,he,we,_e,xe,De,Se){const Le=[];if(le.positionedLines.length===0)return Le;const We=we.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,Ue=function(it){const Mt=it[0],At=it[1],er=Mt*At;return er>0?[Mt,-At]:er<0?[-Mt,At]:Mt===0?[At,Mt]:[At,-Mt]}(he);let Xe=Math.abs(le.top-le.bottom);for(const it of le.positionedLines)Xe-=it.lineOffset;const He=le.positionedLines.length,nt=Xe/He;let Je=le.top-he[1];for(let it=0;it<He;++it){const Mt=le.positionedLines[it];Je=_de(le,nt,Je,it);for(const At of Mt.positionedGlyphs){if(!At.rect)continue;const er=At.rect||{};let Rt=IV+1,Ft=!0,It=1,_r=0;if(At.image){const Un=De.get(At.image.toString());if(!Un)continue;if(Un.sdf){ai("SDF images are not supported in formatted text and will be ignored.");continue}Ft=!1,It=Un.pixelRatio,Rt=i_/It}const Xt=(_e||Se)&&At.vertical,or=At.metrics.advance*At.scale/2,Cr=At.metrics,Gr=At.rect;if(Gr===null)continue;Se&&le.verticalizable&&(_r=At.image?or-At.metrics.width*At.scale/2:0);const Ir=_e?[At.x+or,At.y]:[0,0];let Qr=[0,0],Wr=[0,0],tn=!1;_e||(Xt?(Wr=[At.x+or+Ue[0],At.y+Ue[1]-_r],tn=!0):Qr=[At.x+or+he[0],At.y+he[1]-_r]);const gn=Gr.w*At.scale/(It*(At.localGlyph?au:1)),Zn=Gr.h*At.scale/(It*(At.localGlyph?au:1));let Mr,ln,li,vi;if(Xt){const Un=At.y-Je,Ao=new xt(-or,or-Un),Wa=-Math.PI/2,Ki=new xt(...Wr);Mr=new xt(-or+Qr[0],Qr[1]),Mr._rotateAround(Wa,Ao)._add(Ki),Mr.x+=-Un+or,Mr.y-=(Cr.left-Rt)*At.scale;const co=At.image?Cr.advance*At.scale:na*At.scale,ma=String.fromCodePoint(At.glyph);lde(ma)?Mr.x+=(1-Rt)*At.scale:cde(ma)?Mr.x+=co-Cr.height*At.scale+(-Rt-1)*At.scale:Mr.x+=At.image||Cr.width+2*Rt===Gr.w&&Cr.height+2*Rt===Gr.h?(co-Zn)/2:(co-(Cr.height+2*Rt)*At.scale)/2,ln=new xt(Mr.x,Mr.y-gn),li=new xt(Mr.x+Zn,Mr.y),vi=new xt(Mr.x+Zn,Mr.y-gn)}else{const Un=(Cr.left-Rt)*At.scale-or+Qr[0],Ao=(-Cr.top-Rt)*At.scale+Qr[1],Wa=Un+gn,Ki=Ao+Zn;Mr=new xt(Un,Ao),ln=new xt(Wa,Ao),li=new xt(Un,Ki),vi=new xt(Wa,Ki)}if(We){let Un;Un=_e?new xt(0,0):tn?new xt(Ue[0],Ue[1]):new xt(he[0],he[1]),Mr._rotateAround(We,Un),ln._rotateAround(We,Un),li._rotateAround(We,Un),vi._rotateAround(We,Un)}const Ai=new xt(0,0),Pi=new xt(0,0);Le.push({tl:Mr,tr:ln,bl:li,br:vi,texPrimary:er,texSecondary:void 0,writingMode:le.writingMode,glyphOffset:Ir,sectionIndex:At.sectionIndex,isSDF:Ft,pixelOffsetTL:Ai,pixelOffsetBR:Pi,minFontScaleX:0,minFontScaleY:0})}}return Le}(0,f,M,p,v,T,m,d.allowVerticalPlacement),ee=d.textSizeData;let K=null;ee.kind==="source"?(K=[ou*p.layout.get("text-size").evaluate(T,{},W)*R.textScaleFactor],K[0]>op&&ai(`${d.layerIds[0]}: Value for "text-size" is >= ${X1}. Reduce your "text-size".`)):ee.kind==="composite"&&(K=[ou*R.compositeTextSizes[0].evaluate(T,{},W)*R.textScaleFactor,ou*R.compositeTextSizes[1].evaluate(T,{},W)*R.textScaleFactor],(K[0]>op||K[1]>op)&&ai(`${d.layerIds[0]}: Value for "text-size" is >= ${X1}. Reduce your "text-size".`)),d.addSymbols(d.text,te,K,M,v,T,w,o,c,k.lineStartIndex,k.lineLength,O,N,W,Z,!1);for(const ie of P)D[ie]=d.text.placedSymbolArray.length-1;return 4*te.length}function fL(d){for(const o in d)return d[o];return null}function xA(d,o,c,f,m,p,v,T,M,k){let w=v.top,P=v.bottom,D=v.left,O=v.right;const R=v.collisionPadding;if(R&&(D-=R[0],w-=R[1],O+=R[2],P+=R[3]),M){const N=new xt(D,w),W=new xt(O,w),Z=new xt(D,P),te=new xt(O,P),ee=Ge(M);let K=new xt(0,0);k&&(K=new xt(k[0],k[1])),N._rotateAround(ee,K),W._rotateAround(ee,K),Z._rotateAround(ee,K),te._rotateAround(ee,K),D=Math.min(N.x,W.x,Z.x,te.x),O=Math.max(N.x,W.x,Z.x,te.x),w=Math.min(N.y,W.y,Z.y,te.y),P=Math.max(N.y,W.y,Z.y,te.y)}return d.emplaceBack(o.x,o.y,o.z,c.x,c.y,D,w,O,P,T,f,m,p),d.length-1}function pL(d){d.collisionPadding&&(d.top-=d.collisionPadding[1],d.bottom+=d.collisionPadding[3]);const o=d.bottom-d.top;return o>0?Math.max(10,o):null}function Ade(d,o,c,f){const m=d.compareText;if(o in m){const p=m[o];for(let v=p.length-1;v>=0;v--)if(f.dist(p[v])<c)return!0}else m[o]=[];return m[o].push(f),!1}function n8(d,o){const c=d.fovAboveCenter,f=d.elevation?d.elevation.getMinElevationBelowMSL()*o:0,m=(d._camera.position[2]*d.worldSize-f)/Math.cos(d._pitch),p=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-d._pitch-c,.01));let v=Math.sin(d._pitch)*p+m;const T=m*(1/d._horizonShift);if(!d.elevation||d.elevation.exaggeration()===0){let M=Math.max(d.zoom-17,0);d.isOrthographic&&(M/=10),v*=1+M}return Math.min(1.01*v,T)}function Y1(d,o){if(!o.isReprojectedInTileSpace)return{scale:1<<d.z,x:d.x,y:d.y,x2:d.x+1,y2:d.y+1,projection:o};const c=Math.pow(2,-d.z),f=d.x*c,m=(d.x+1)*c,p=d.y*c,v=(d.y+1)*c,T=ts(f),M=ts(m),k=Ho(p),w=Ho(v),P=o.project(T,k),D=o.project(M,k),O=o.project(M,w),R=o.project(T,w);let N=Math.min(P.x,D.x,O.x,R.x),W=Math.min(P.y,D.y,O.y,R.y),Z=Math.max(P.x,D.x,O.x,R.x),te=Math.max(P.y,D.y,O.y,R.y);const ee=c/16;function K(le,he,we,_e,xe,De){const Se=(we+xe)/2,Le=(_e+De)/2,We=o.project(ts(Se),Ho(Le)),Ue=Math.max(0,N-We.x,W-We.y,We.x-Z,We.y-te);N=Math.min(N,We.x),Z=Math.max(Z,We.x),W=Math.min(W,We.y),te=Math.max(te,We.y),Ue>ee&&(K(le,We,we,_e,Se,Le),K(We,he,Se,Le,xe,De))}K(P,D,f,p,m,p),K(D,O,m,p,m,v),K(O,R,m,v,f,v),K(R,P,f,v,f,p),N-=ee,W-=ee,Z+=ee,te+=ee;const ie=1/Math.max(Z-N,te-W);return{scale:ie,x:N*ie,y:W*ie,x2:Z*ie,y2:te*ie,projection:o}}function i8(d,{x:o,y:c},f=0){return new xt(((o-f)*d.scale-d.x)*$t,(c*d.scale-d.y)*$t)}const Cde=ge.mat4.identity(new Float32Array(16));class ap{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,c){return{x:0,y:0,z:0}}unproject(o,c){return new bn(0,0)}projectTilePoint(o,c,f){return{x:o,y:c,z:0}}locationPoint(o,c,f,m=!0){return o._coordinatePoint(o.locationCoordinate(c,f),m)}pixelsPerMeter(o,c){return ta(1,o)*c}pixelSpaceConversion(o,c,f){return 1}farthestPixelDistance(o){return n8(o,o.pixelsPerMeter)}pointCoordinate(o,c,f,m){const p=o.horizonLineFromTop(!1),v=new xt(c,Math.max(p,f));return o.rayIntersectionCoordinate(o.pointRayIntersection(v,m))}pointCoordinate3D(o,c,f){const m=new xt(c,f);if(o.elevation)return o.elevation.pointCoordinate(m);{const p=this.pointCoordinate(o,m.x,m.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(o,c){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,c.x,c.y);const f=o.horizonLineFromTop();return c.y<f}createInversionMatrix(o,c){return Cde}createTileMatrix(o,c,f){let m,p,v;const T=f.canonical,M=ge.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=Y1(T,this);m=1,p=k.x+f.wrap*k.scale,v=k.y,ge.mat4.scale(M,M,[m/k.scale,m/k.scale,o.pixelsPerMeter/c])}else m=c/o.zoomScale(T.z),p=(T.x+Math.pow(2,T.z)*f.wrap)*m,v=T.y*m;return ge.mat4.translate(M,M,[p,v,0]),ge.mat4.scale(M,M,[m/$t,m/$t,1]),M}upVector(o,c,f){return[0,0,1]}upVectorScale(o,c,f){return{metersToTile:1}}}class Mde extends ap{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[c,f]=this.parallels=o.parallels||[29.5,45.5],m=Math.sin(Ge(c));this.n=(m+Math.sin(Ge(f)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(o,c){const{n:f,c:m,r0:p}=this,v=Ge(o-this.center[0]),T=Ge(c),M=Math.sqrt(m-2*f*Math.sin(T))/f;return{x:M*Math.sin(v*f),y:M*Math.cos(v*f)-p,z:0}}unproject(o,c){const{n:f,c:m,r0:p}=this,v=p+c;let T=Math.atan2(o,Math.abs(v))*Math.sign(v);v*f<0&&(T-=Math.PI*Math.sign(o)*Math.sign(v));const M=Ge(this.center[0])*f;T=oi(T,-Math.PI-M,Math.PI-M);const k=Yt(vt(T/f)+this.center[0],-180,180),w=Math.asin(Yt((m-(o*o+v*v)*f*f)/(2*f),-1,1)),P=Yt(vt(w),-Bi,Bi);return new bn(k,P)}}const K1=1.340264,J1=-.081106,Q1=893e-6,ew=.003796,bA=Math.sqrt(3)/2;class Pde extends ap{project(o,c){c=c/180*Math.PI,o=o/180*Math.PI;const f=Math.asin(bA*Math.sin(c)),m=f*f,p=m*m*m;return{x:.5*(o*Math.cos(f)/(bA*(K1+3*J1*m+p*(7*Q1+9*ew*m)))/Math.PI+.5),y:1-.5*(f*(K1+J1*m+p*(Q1+ew*m))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,m=f*f,p=m*m*m;for(let w,P,D,O=0;O<12&&(P=f*(K1+J1*m+p*(Q1+ew*m))-c,D=K1+3*J1*m+p*(7*Q1+9*ew*m),w=P/D,f=Yt(f-w,-Math.PI/3,Math.PI/3),m=f*f,p=m*m*m,!(Math.abs(w)<1e-12));++O);const v=bA*o*(K1+3*J1*m+p*(7*Q1+9*ew*m))/Math.cos(f),T=Math.asin(Math.sin(f)/bA),M=Yt(180*v/Math.PI,-180,180),k=Yt(180*T/Math.PI,-Bi,Bi);return new bn(M,k)}}class Ide extends ap{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){return{x:.5+o/360,y:.5-c/360,z:0}}unproject(o,c){const f=360*(o-.5),m=Yt(360*(.5-c),-Bi,Bi);return new bn(f,m)}}const s_=Math.PI/2;function wA(d){return Math.tan((s_+d)/2)}class Ode extends ap{constructor(o){super(o),this.center=o.center||[0,30];const[c,f]=this.parallels=o.parallels||[30,30];let m=Ge(c),p=Ge(f);this.southernCenter=m+p<0,this.southernCenter&&(m=-m,p=-p);const v=Math.cos(m),T=wA(m);this.n=m===p?Math.sin(m):Math.log(v/Math.cos(p))/Math.log(wA(p)/T),this.f=v*Math.pow(wA(m),this.n)/this.n}project(o,c){c=Ge(c),this.southernCenter&&(c=-c),o=Ge(o-this.center[0]);const f=1e-6,{n:m,f:p}=this;p>0?c<-s_+f&&(c=-s_+f):c>s_-f&&(c=s_-f);const v=p/Math.pow(wA(c),m);let T=v*Math.sin(m*o),M=p-v*Math.cos(m*o);return T=.5*(T/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:T,y:this.southernCenter?M:1-M,z:0}}unproject(o,c){o=(2*o-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:f,f:m}=this,p=m-c,v=Math.sign(p),T=Math.sign(f)*Math.sqrt(o*o+p*p);let M=Math.atan2(o,Math.abs(p))*v;p*f<0&&(M-=Math.PI*Math.sign(o)*v);const k=Yt(vt(M/f)+this.center[0],-180,180),w=Yt(vt(2*Math.atan(Math.pow(m/T,1/f))-s_),-Bi,Bi);return new bn(k,this.southernCenter?-w:w)}}class o8 extends ap{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,c){return{x:fc(o),y:es(c),z:0}}unproject(o,c){const f=ts(o),m=Ho(c);return new bn(f,m)}}const a8=Ge(Bi);class kde extends ap{project(o,c){const f=(c=Ge(c))*c,m=f*f;return{x:.5*((o=Ge(o))*(.8707-.131979*f+m*(m*(.003971*f-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+f*(.015085+m*(.028874*f-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,m=25,p=0,v=f*f;do{v=f*f;const k=v*v;p=(f*(1.007226+v*(.015085+k*(.028874*v-.044475-.005916*k)))-c)/(1.007226+v*(.045255+k*(.259866*v-.311325-.005916*11*k))),f=Yt(f-p,-a8,a8)}while(Math.abs(p)>1e-6&&--m>0);v=f*f;const T=Yt(vt(o/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),M=vt(f);return new bn(T,M)}}const s8=Ge(Bi);class Rde extends ap{project(o,c){c=Ge(c),o=Ge(o);const f=Math.cos(c),m=2/Math.PI,p=Math.acos(f*Math.cos(o/2)),v=Math.sin(p)/p,T=.5*(o*m+2*f*Math.sin(o/2)/v)||0,M=.5*(c+Math.sin(c)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(o,c){let f=o=(2*o-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,p=25;const v=1e-6;let T=0,M=0;do{const k=Math.cos(m),w=Math.sin(m),P=2*w*k,D=w*w,O=k*k,R=Math.cos(f/2),N=Math.sin(f/2),W=2*R*N,Z=N*N,te=1-O*R*R,ee=te?1/te:0,K=te?Math.acos(k*R)*Math.sqrt(1/te):0,ie=.5*(2*K*k*N+2*f/Math.PI)-o,le=.5*(K*w+m)-c,he=.5*ee*(O*Z+K*k*R*D)+1/Math.PI,we=ee*(W*P/4-K*w*N),_e=.125*ee*(P*N-K*w*O*W),xe=.5*ee*(D*R+K*Z*k)+.5,De=we*_e-xe*he;T=(le*we-ie*xe)/De,M=(ie*_e-le*he)/De,f=Yt(f-T,-Math.PI,Math.PI),m=Yt(m-M,-s8,s8)}while((Math.abs(T)>v||Math.abs(M)>v)&&--p>0);return new bn(vt(f),vt(m))}}class l8 extends ap{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ge(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){const{scale:f,cosPhi:m}=this;return{x:Ge(o)*m*f+.5,y:-Math.sin(Ge(c))/m*f+.5,z:0}}unproject(o,c){const{scale:f,cosPhi:m}=this,p=-(c-.5)/f,v=Yt(vt((o-.5)/f)/m,-180,180),T=Math.asin(Yt(p*m,-1,1)),M=Yt(vt(T),-Bi,Bi);return new bn(v,M)}}class Dde extends o8{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,c,f){const m=Sn(o,c,f),p=si(yo(f));return ge.vec3.transformMat4(m,m,p),{x:m[0],y:m[1],z:m[2]}}locationPoint(o,c,f){const m=uh(c.lat,c.lng),p=ge.vec3.normalize([],m),v=f?o._centerAltitude+f:o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(c),o._centerAltitude):o._centerAltitude,T=ta(1,0)*$t*v;ge.vec3.scaleAndAdd(m,m,p,T);const M=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(M,o.pixelMatrix,o.globeMatrix),ge.vec3.transformMat4(m,m,M),new xt(m[0],m[1])}pixelsPerMeter(o,c){return ta(1,0)*c}pixelSpaceConversion(o,c,f){const m=ta(1,o)*c,p=br(ta(1,45)*c,m,f);return this.pixelsPerMeter(o,c)/p}createTileMatrix(o,c,f){const m=vo(yo(f.canonical));return ge.mat4.multiply(new Float64Array(16),o.globeMatrix,m)}createInversionMatrix(o,c){const{center:f}=o,m=si(yo(c));return ge.mat4.rotateY(m,m,Ge(f.lng)),ge.mat4.rotateX(m,m,Ge(f.lat)),ge.mat4.scale(m,m,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(o,c,f,m){return mn(o,c,f,!0)||new s(0,0)}pointCoordinate3D(o,c,f){const m=this.pointCoordinate(o,c,f,0);return[m.x,m.y,m.z]}isPointAboveHorizon(o,c){return!mn(o,c.x,c.y,!1)}farthestPixelDistance(o){const c=function(m,p){const v=m.cameraToCenterDistance,T=m._centerAltitude*p,M=m._camera,k=m._camera.forward(),w=ge.vec3.add([],ge.vec3.scale([],k,-v),[0,0,T]),P=m.worldSize/(2*Math.PI),D=[0,0,-P],O=m.width/m.height,R=Math.tan(m.fovAboveCenter),N=ge.vec3.scale([],M.up(),R),W=ge.vec3.scale([],M.right(),R*O),Z=ge.vec3.normalize([],ge.vec3.add([],ge.vec3.add([],k,N),W)),te=[];let ee;if(new Ar(w,Z).closestPointOnSphere(D,P,te)){const K=ge.vec3.add([],te,D),ie=ge.vec3.sub([],K,w);ee=Math.cos(m.fovAboveCenter)*ge.vec3.length(ie)}else{const K=ge.vec3.sub([],w,D),ie=ge.vec3.sub([],D,w);ge.vec3.normalize(ie,ie);const le=ge.vec3.length(K)-P;ee=Math.sqrt(le*(le+2*P));const he=Math.acos(ee/(P+le))-Math.acos(ge.vec3.dot(k,ie));ee*=Math.cos(he)}return 1.01*ee}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),f=Va(o.zoom);if(f>0){const m=n8(o,ta(1,o.center.lat)*o.worldSize),p=o.worldSize/(2*Math.PI),v=Math.max(o.width,o.height)/o.worldSize*Math.PI;return br(c,m+p*(1-Math.cos(v)),Math.pow(f,10))}return c}upVector(o,c,f){return Sn(c,f,o,1)}upVectorScale(o){return{metersToTile:sn($n(yo(o)))}}}function c8(d){const o=d.parallels,c=!!o&&Math.abs(o[0]+o[1])<.01;switch(d.name){case"mercator":return new o8(d);case"equirectangular":return new Ide(d);case"naturalEarth":return new kde(d);case"equalEarth":return new Pde(d);case"winkelTripel":return new Rde(d);case"albers":return c?new l8(d):new Mde(d);case"lambertConformalConic":return c?new l8(d):new Ode(d);case"globe":return new Dde(d)}throw new Error(`Invalid projection name: ${d.name}`)}const Lde=rp.VectorTileFeature.types,Nde=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function SA(d,o,c,f,m,p,v,T,M,k,w,P,D){const O=T?Math.min(op,Math.round(T[0])):0,R=T?Math.min(op,Math.round(T[1])):0;d.emplaceBack(o,c,Math.round(32*f),Math.round(32*m),p,v,(O<<1)+(M?1:0),R,16*k,16*w,256*P,256*D)}function TA(d,o,c){d.emplaceBack(o,c)}function EA(d,o,c,f,m,p,v){d.emplaceBack(o,c,f,m,p,v)}function AA(d,o,c,f,m){d.emplaceBack(o,c,f,m),d.emplaceBack(o,c,f,m),d.emplaceBack(o,c,f,m),d.emplaceBack(o,c,f,m)}function zde(d){for(const o of d.sections)if(N2(o.text))return!0;return!1}class mL{constructor(o){this.layoutVertexArray=new g1,this.indexArray=new qo,this.programConfigurations=o,this.segments=new hi,this.dynamicLayoutVertexArray=new sh,this.opacityVertexArray=new v1,this.placedSymbolArray=new G2,this.iconTransitioningVertexArray=new id,this.globeExtVertexArray=new y1,this.zOffsetVertexArray=new ah}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,c,f,m,p){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Jue.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,ede.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Nde,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,rde.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Que.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||p)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,tde.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||m)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Qt(mL,"SymbolBuffers");class gL{constructor(o,c,f){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new f,this.segments=new hi,this.collisionVertexArray=new b1,this.collisionVertexArrayExt=new sh}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,nde.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,ide.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Qt(gL,"CollisionBuffers");class CA{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ge.mat4.identity([]),this.placementViewportMatrix=ge.mat4.identity([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=iL(this.zoom,c["text-size"]),this.iconSizeData=iL(this.zoom,c["icon-size"]);const f=this.layers[0].layout,m=f.get("symbol-sort-key"),p=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(v=>Ms[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new mL(new ad(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new mL(new ad(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new Z2,this.lineVertexArray=new pg,this.symbolInstances=new H2}calculateGlyphDependencies(o,c,f,m,p){for(const v of o){const T=v.codePointAt(0);if(T===void 0)break;if(c[T]=!0,m&&p&&T<=65535){const M=G1[v];M&&(c[M.charCodeAt(0)]=!0)}}}updateFootprints(o,c){}updateReplacement(o,c){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const f=c.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!KD(this.activeReplacements,f)&&(this.activeReplacements=f,!0)}populate(o,c,f,m){const p=this.layers[0],v=p.layout,T=this.projection.name==="globe",M=v.get("text-font"),k=v.get("text-field"),w=v.get("icon-image"),[P,D]=v.get("icon-size-scale-range"),O=Yt(c.scaleFactor||1,P,D),R=(k.value.kind!=="constant"||k.value.value instanceof ha&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),N=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!R&&!N)return;const Z=c.iconDependencies,te=c.glyphDependencies,ee=c.availableImages,K=new Hn(this.zoom);for(const{feature:ie,id:le,index:he,sourceLayerIndex:we}of o){const _e=p._featureFilter.needGeometry,xe=V(ie,_e);if(!p._featureFilter.filter(K,xe,f))continue;if(_e||(xe.geometry=U(ie,f,m)),T&&ie.type!==1&&f.z<=5){const Ue=xe.geometry,Xe=.98078528056,He=(nt,Je)=>{const it=Sn(nt.x,nt.y,f,1),Mt=Sn(Je.x,Je.y,f,1);return ge.vec3.dot(it,Mt)<Xe};for(let nt=0;nt<Ue.length;nt++)Ue[nt]=S(Ue[nt],He)}let De,Se;if(R){const Ue=p.getValueAndResolveTokens("text-field",xe,f,ee),Xe=ha.factory(Ue);zde(Xe)&&(this.hasRTLText=!0),(!this.hasRTLText||Nv()==="unavailable"||this.hasRTLText&&Js.isParsed())&&(De=sde(Xe,p,xe))}if(N){const Ue=p.getValueAndResolveTokens("icon-image",xe,f,ee);Se=Ue instanceof fa?Ue:fa.build(Ue)}if(!De&&!Se)continue;const Le=this.sortFeaturesByKey?W.evaluate(xe,{},f):void 0,We={id:le,text:De,icon:Se,index:he,sourceLayerIndex:we,geometry:xe.geometry,properties:ie.properties,type:Lde[ie.type],sortKey:Le};if(this.features.push(We),Se){const Ue=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Xe,iconSecondary:He}=QV(Se,this.iconSizeData,Ue["icon-size"],f,this.zoom,We,this.pixelRatio,O),nt=Xe.id.toString();if(Z.has(nt)?Z.get(nt).push(Xe):Z.set(nt,[Xe]),He){const Je=He.id.toString();Z.has(Je)?Z.get(Je).push(He):Z.set(Je,[He])}}if(De){const Ue=M.evaluate(xe,{},f).join(","),Xe=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ms.vertical)>=0;for(const He of De.sections)if(He.image){const nt=He.image.getPrimary().scaleSelf(this.pixelRatio),Je=nt.id.toString(),it=Z.get(Je)||[];it.push(nt),Z.set(Je,it)}else{const nt=r1(De.toString()),Je=He.fontStack||Ue,it=te[Je]=te[Je]||{};this.calculateGlyphDependencies(He.text,it,Xe,this.allowVerticalPlacement,nt)}}}if(v.get("symbol-placement")==="line"&&(this.features=function(ie){const le={},he={},we=[];let _e=0;function xe(We){we.push(ie[We]),_e++}function De(We,Ue,Xe){const He=he[We];return delete he[We],he[Ue]=He,we[He].geometry[0].pop(),we[He].geometry[0]=we[He].geometry[0].concat(Xe[0]),He}function Se(We,Ue,Xe){const He=le[Ue];return delete le[Ue],le[We]=He,we[He].geometry[0].shift(),we[He].geometry[0]=Xe[0].concat(we[He].geometry[0]),He}function Le(We,Ue,Xe){const He=Xe?Ue[0][Ue[0].length-1]:Ue[0][0];return`${We}:${He.x}:${He.y}`}for(let We=0;We<ie.length;We++){const Ue=ie[We],Xe=Ue.geometry,He=Ue.text?Ue.text.toString():null;if(!He){xe(We);continue}const nt=Le(He,Xe),Je=Le(He,Xe,!0);if(nt in he&&Je in le&&he[nt]!==le[Je]){const it=Se(nt,Je,Xe),Mt=De(nt,Je,we[it].geometry);delete le[nt],delete he[Je],he[Le(He,we[Mt].geometry,!0)]=Mt,we[it].geometry=null}else nt in he?De(nt,Je,Xe):Je in le?Se(nt,Je,Xe):(xe(We),le[nt]=_e-1,he[Je]=_e-1)}return we.filter(We=>We.geometry)}(this.features)),v.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",c.elevationFeatures){!this.elevationFeatures&&c.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ie of c.elevationFeatures)this.elevationFeatureIdToIndex.set(ie.id,this.elevationFeatures.length),this.elevationFeatures.push(ie)}}else v.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ie,le)=>ie.sortKey-le.sortKey)}update(o,c,f,m,p,v,T){this.text.programConfigurations.updatePaintArrays(o,c,p,f,m,v,T),this.icon.programConfigurations.updatePaintArrays(o,c,p,f,m,v,T)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);if(f.elevationFeatureIndex===65535)continue;const m=this.elevationFeatures[f.elevationFeatureIndex];if(m){const p=.05+m.pointElevation(new xt(f.tileAnchorX,f.tileAnchorY));f.zOffset!==p&&(o=!0,f.zOffset=p)}}o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const o=(p,v,T)=>{f+=v,f>p.length&&p.resize(f);for(let M=-v;M<0;M++)p.emplace(M+f,T)},c=(p,v,T)=>{m+=v,m>p.length&&p.resize(m);for(let M=-v;M<0;M++)p.emplace(M+m,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,m=0;for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:M,numIconVertices:k}=v,w=v.zOffset,P=k>0;if((T>0||M>0)&&(o(this.text.zOffsetVertexArray,T,w),o(this.text.zOffsetVertexArray,M,w)),P){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:O}=v;D>=0&&c(this.icon.zOffsetVertexArray,k,w),O>=0&&c(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=c8(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const f=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:m,y:p}of c)this.lineVertexArray.emplaceBack(m,p);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,c,f,m,p,v,T,M,k,w,P,D,O,R,N,W){const Z=o.indexArray,te=o.layoutVertexArray,ee=o.globeExtVertexArray,K=o.segments.prepareSegment(4*c.length,te,Z,this.canOverlap?v.sortKey:void 0),ie=this.glyphOffsetArray.length,le=K.vertexLength,he=this.allowVerticalPlacement&&T===Ms.vertical?Math.PI/2:0,we=v.text&&v.text.sections;for(let xe=0;xe<c.length;xe++){const{tl:De,tr:Se,bl:Le,br:We,texPrimary:Ue,texSecondary:Xe,pixelOffsetTL:He,pixelOffsetBR:nt,minFontScaleX:Je,minFontScaleY:it,glyphOffset:Mt,isSDF:At,sectionIndex:er}=c[xe],Rt=K.vertexLength,Ft=Mt[1];if(SA(te,k.x,k.y,De.x,Ft+De.y,Ue.x,Ue.y,f,At,He.x,He.y,Je,it),SA(te,k.x,k.y,Se.x,Ft+Se.y,Ue.x+Ue.w,Ue.y,f,At,nt.x,He.y,Je,it),SA(te,k.x,k.y,Le.x,Ft+Le.y,Ue.x,Ue.y+Ue.h,f,At,He.x,nt.y,Je,it),SA(te,k.x,k.y,We.x,Ft+We.y,Ue.x+Ue.w,Ue.y+Ue.h,f,At,nt.x,nt.y,Je,it),M){const{x:It,y:_r,z:Xt}=M.anchor,[or,Cr,Gr]=M.up;EA(ee,It,_r,Xt,or,Cr,Gr),EA(ee,It,_r,Xt,or,Cr,Gr),EA(ee,It,_r,Xt,or,Cr,Gr),EA(ee,It,_r,Xt,or,Cr,Gr),AA(o.dynamicLayoutVertexArray,It,_r,Xt,he)}else AA(o.dynamicLayoutVertexArray,k.x,k.y,k.z,he);if(W){const It=Xe||Ue;TA(o.iconTransitioningVertexArray,It.x,It.y),TA(o.iconTransitioningVertexArray,It.x+It.w,It.y),TA(o.iconTransitioningVertexArray,It.x,It.y+It.h),TA(o.iconTransitioningVertexArray,It.x+It.w,It.y+It.h)}Z.emplaceBack(Rt,Rt+1,Rt+2),Z.emplaceBack(Rt+1,Rt+2,Rt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Mt[0]),xe!==c.length-1&&er===c[xe+1].sectionIndex||o.programConfigurations.populatePaintArrays(te.length,v,v.index,{},O,R,N,we&&we[er])}const _e=M?M.anchor:k;o.placedSymbolArray.emplaceBack(_e.x,_e.y,_e.z,k.x,k.y,ie,this.glyphOffsetArray.length-ie,le,w,P,k.segment,f?f[0]:0,f?f[1]:0,m[0],m[1],T,0,!1,0,D,0)}_commitLayoutVertex(o,c,f,m,p,v,T){o.emplaceBack(c,f,m,p,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(o,c,f,m,p,v,T){const M=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),k=M.vertexLength,w=T.tileAnchorX,P=T.tileAnchorY;for(let O=0;O<4;O++)f.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,c,o.padding,T.zOffset),this._commitLayoutVertex(f.layoutVertexArray,m,p,v,w,P,new xt(o.x1,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,m,p,v,w,P,new xt(o.x2,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,m,p,v,w,P,new xt(o.x2,o.y2)),this._commitLayoutVertex(f.layoutVertexArray,m,p,v,w,P,new xt(o.x1,o.y2)),M.vertexLength+=4;const D=f.indexArray;D.emplaceBack(k,k+1),D.emplaceBack(k+1,k+2),D.emplaceBack(k+2,k+3),D.emplaceBack(k+3,k),M.primitiveLength+=4}_addTextDebugCollisionBoxes(o,c,f,m,p,v){for(let T=m;T<p;T++){const M=f.get(T),k=this.getSymbolInstanceTextSize(o,v,c,T);this._addCollisionDebugVertices(M,k,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(o,c,f,m,p,v){for(let T=m;T<p;T++){const M=f.get(T),k=this.getSymbolInstanceIconSize(o,c,v.placedIconSymbolIndex);this._addCollisionDebugVertices(M,k,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,v)}}generateCollisionDebugBuffers(o,c,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gL(dg,EV.members,id),this.iconCollisionBox=new gL(dg,EV.members,id);const m=r_(this.iconSizeData,o),p=r_(this.textSizeData,o,f);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(p,o,c,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(p,o,c,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,o,c,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,o,c,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(o,c,f,m){const p=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),v=pA(this.textSizeData,o,p)/na;return this.tilePixelRatio*v}getSymbolInstanceIconSize(o,c,f){const m=this.icon.placedSymbolArray.get(f),p=pA(this.iconSizeData,o,m);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(o,c,f,m){o.emplaceBack(c,-f,-f,m),o.emplaceBack(c,f,-f,m),o.emplaceBack(c,f,f,m),o.emplaceBack(c,-f,f,m)}_updateTextDebugCollisionBoxes(o,c,f,m,p,v,T){for(let M=m;M<p;M++){const k=f.get(M),w=this.getSymbolInstanceTextSize(o,v,c,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,k.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(o,c,f,m,p,v,T){for(let M=m;M<p;M++){const k=f.get(M),w=this.getSymbolInstanceIconSize(o,c,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,k.padding,v.zOffset)}}updateCollisionDebugBuffers(o,c,f,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=r_(this.iconSizeData,o,m),v=r_(this.textSizeData,o,f);for(let T=0;T<this.symbolInstances.length;T++){const M=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(v,o,c,M.textBoxStartIndex,M.textBoxEndIndex,M,f),this._updateTextDebugCollisionBoxes(v,o,c,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M,f),this._updateIconDebugCollisionBoxes(p,o,c,M.iconBoxStartIndex,M.iconBoxEndIndex,M,m),this._updateIconDebugCollisionBoxes(p,o,c,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,c,f,m,p,v,T,M,k){const w={};if(c<f){const{x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K,featureIndex:ie}=o.get(c);w.textBox={x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K},w.textFeatureIndex=ie}if(m<p){const{x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K,featureIndex:ie}=o.get(m);w.verticalTextBox={x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K},w.verticalTextFeatureIndex=ie}if(v<T){const{x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K,featureIndex:ie}=o.get(v);w.iconBox={x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K},w.iconFeatureIndex=ie}if(M<k){const{x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K,featureIndex:ie}=o.get(M);w.verticalIconBox={x1:P,y1:D,x2:O,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ee,tileAnchorY:K},w.verticalIconFeatureIndex=ie}return w}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,c){const f=o.placedSymbolArray.get(c),m=f.vertexStartIndex+4*f.numGlyphs;for(let p=f.vertexStartIndex;p<m;p+=4)o.indexArray.emplaceBack(p,p+1,p+2),o.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(o),f=Math.cos(o),m=[],p=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const M=this.symbolInstances.get(T);m.push(0|Math.round(c*M.tileAnchorX+f*M.tileAnchorY)),p.push(M.featureIndex)}return v.sort((T,M)=>m[T]-m[M]||p[M]-p[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,c)=>this.symbolInstances.get(c).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,c){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===c?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const f=this.symbolInstances.get(c);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:k}=f;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),p>=0&&p!==m&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let u8,d8,yL;Qt(CA,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),CA.addDynamicAttributes=AA;class h8{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:xf,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Qt(h8,"FormatSectionOverride",{omit:["defaultValue"]});const vL=()=>yL||(yL={layout:u8||(u8=new Ei({"symbol-placement":new jt(at.layout_symbol["symbol-placement"]),"symbol-spacing":new jt(at.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jt(at.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Jt(at.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jt(at.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new jt(at.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new jt(at.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new jt(at.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new jt(at.layout_symbol["icon-ignore-placement"]),"icon-optional":new jt(at.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jt(at.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jt(at.layout_symbol["icon-size"]),"icon-size-scale-range":new jt(at.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Jt(at.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jt(at.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jt(at.layout_symbol["icon-image"]),"icon-rotate":new Jt(at.layout_symbol["icon-rotate"]),"icon-padding":new jt(at.layout_symbol["icon-padding"]),"icon-keep-upright":new jt(at.layout_symbol["icon-keep-upright"]),"icon-offset":new Jt(at.layout_symbol["icon-offset"]),"icon-anchor":new Jt(at.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jt(at.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jt(at.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jt(at.layout_symbol["text-rotation-alignment"]),"text-field":new Jt(at.layout_symbol["text-field"]),"text-font":new Jt(at.layout_symbol["text-font"]),"text-size":new Jt(at.layout_symbol["text-size"]),"text-size-scale-range":new jt(at.layout_symbol["text-size-scale-range"]),"text-max-width":new Jt(at.layout_symbol["text-max-width"]),"text-line-height":new Jt(at.layout_symbol["text-line-height"]),"text-letter-spacing":new Jt(at.layout_symbol["text-letter-spacing"]),"text-justify":new Jt(at.layout_symbol["text-justify"]),"text-radial-offset":new Jt(at.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jt(at.layout_symbol["text-variable-anchor"]),"text-anchor":new Jt(at.layout_symbol["text-anchor"]),"text-max-angle":new jt(at.layout_symbol["text-max-angle"]),"text-writing-mode":new jt(at.layout_symbol["text-writing-mode"]),"text-rotate":new Jt(at.layout_symbol["text-rotate"]),"text-padding":new jt(at.layout_symbol["text-padding"]),"text-keep-upright":new jt(at.layout_symbol["text-keep-upright"]),"text-transform":new Jt(at.layout_symbol["text-transform"]),"text-offset":new Jt(at.layout_symbol["text-offset"]),"text-allow-overlap":new jt(at.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new jt(at.layout_symbol["text-ignore-placement"]),"text-optional":new jt(at.layout_symbol["text-optional"]),visibility:new jt(at.layout_symbol.visibility)})),paint:d8||(d8=new Ei({"icon-opacity":new Jt(at.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Jt(at.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Jt(at.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Jt(at.paint_symbol["text-emissive-strength"]),"icon-color":new Jt(at.paint_symbol["icon-color"]),"icon-halo-color":new Jt(at.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jt(at.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jt(at.paint_symbol["icon-halo-blur"]),"icon-translate":new jt(at.paint_symbol["icon-translate"]),"icon-translate-anchor":new jt(at.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Jt(at.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Jt(at.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Jt(at.paint_symbol["text-occlusion-opacity"]),"text-color":new Jt(at.paint_symbol["text-color"],{runtimeType:da,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Jt(at.paint_symbol["text-halo-color"]),"text-halo-width":new Jt(at.paint_symbol["text-halo-width"]),"text-halo-blur":new Jt(at.paint_symbol["text-halo-blur"]),"text-translate":new jt(at.paint_symbol["text-translate"]),"text-translate-anchor":new jt(at.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new jt(at.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new jt(at.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new jt(at.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new jt(at.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Jt(at.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},yL);class MA extends zo{constructor(o,c,f,m){super(o,vL(),c,f,m),this._colorAdjustmentMatrix=ge.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,c){super.recalculate(o,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const m=[];for(const p of f)m.indexOf(p)<0&&m.push(p);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,c,f,m){return this._saturation===o&&this._contrast===c&&this._brightnessMin===f&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(p,v,T,M){p=ft(p),v=_s(v);const k=ge.mat4.create(),w=p/3,P=1-2*w,D=[P,w,w,0,w,P,w,0,w,w,P,0,0,0,0,1],O=.5-.5*v,R=M-T;return ge.mat4.multiply(k,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,O,O,O,1]),ge.mat4.multiply(k,k,D),k}(o,c,f,m),this._saturation=o,this._contrast=c,this._brightnessMin=f,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,c,f,m){const p=this.layout.get(o).evaluate(c,{},f,m),v=this._unevaluatedLayout._values[o];return v.isDataDriven()||Pv(v.value)||!p?p:function(T,M){return M.replace(/{([^{}]+)}/g,(k,w)=>w in T?String(T[w]):"")}(c.properties,p)}createBucket(o){return new CA(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of vL().paint.overridableProperties){if(!MA.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),f=new h8(c),m=new Kb(f,c.property.specification,this.scope,this.options);let p=null;p=c.value.kind==="constant"||c.value.kind==="source"?new Jb("source",m):new jf("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[o]=new Vf(c.property,p,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&MA.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const f=o.get("text-field"),m=vL().paint.properties[c];let p=!1;const v=T=>{for(const M of T)if(m.overrides&&m.overrides.hasOverride(M))return void(p=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ha)v(f.value.value.sections);else if(f.value.kind==="source"){const T=k=>{p||(k instanceof Wc&&so(k.value)===Wm?v(k.value.sections):k instanceof Tf?v(k.sections):k.eachChild(T))},M=f.value;M._styleExpression&&T(M._styleExpression.expression)}return p}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,c,f){return{config:new ch(this,{zoom:c,lut:f}),overrideFog:!1}}}let f8,p8,m8,g8;var _L=xn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function xL(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function bL(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class wL{constructor(o,c,f,m){this.context=o,this.format=f,this.useMipmap=m&&m.useMipmap,this.texture=o.gl.createTexture(),this.update(c,{premultiply:m&&m.premultiply})}update(o,c){const f=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,m=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:p}=this,{gl:v}=p,{x:T,y:M}=c&&c.position?c.position:{x:0,y:0},k=T+f,w=M+m;!this.size||this.size[0]===k&&this.size[1]===w||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!c||c.premultiply!==!1));const P=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&k>0&&w>0){const D=this.useMipmap?Math.floor(Math.log2(Math.max(k,w)))+1:1;v.texStorage2D(v.TEXTURE_2D,D,this.format,k,w),this.size=[k,w]}if(this.size)if(P)v.texSubImage2D(v.TEXTURE_2D,0,T,M,xL(this.format),bL(this.format),o);else{const D=o.data;D&&v.texSubImage2D(v.TEXTURE_2D,0,T,M,f,m,xL(this.format),bL(this.format),D)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(o,c,f=!1){const{context:m}=this,{gl:p}=m;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap&&!f?o===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),c!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,c),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,c),this.wrapS=c)}bindExtraParam(o,c,f,m){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),c!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,c),this.magFilter=c),o!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?o===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),f!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,f),this.wrapS=f),m!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class PA{constructor(o,c){this.context=o,this.texture=c}bind(o,c){const{context:f}=this,{gl:m}=f;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,o),this.minFilter=o),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrapS=c)}}function IA(d,o,c,f,m,p,v,T){const M=[d,o,1,c,f,1,m,p,1],k=[v,T,1],w=ge.mat3.adjoint([],M),[P,D,O]=ge.vec3.transformMat3(k,k,w);return ge.mat3.multiply(M,M,[P,0,0,0,D,0,0,0,O])}function y8(d,o,c,f,m,p,v,T){const M=function(k,w,P,D,O,R,N,W){const Z=IA(0,0,1,0,1,1,0,1),te=IA(k,w,P,D,O,R,N,W),ee=ge.mat3.adjoint([],Z);return ge.mat3.multiply(te,te,ee)}(d,o,c,f,m,p,v,T);return[M[2]/M[8]/$t,M[5]/M[8]/$t]}function OA(d){return[d[0],Math.min(Math.max(d[1],-Bi),Bi)]}class v8 extends Il{constructor(o,c,f,m){super(),this.id=o,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=c,this._dirty=!1}load(o,c){if(this._loaded=c||!1,this.fire(new Ka("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=_b(this.map._requestManager.transformRequest(this.url,Lo.Image),(f,m)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new _f(f)):m&&(this.image=m instanceof HTMLImageElement?gt.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new PA(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ka("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof PA||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let c=o[0][1],f=o[0][1];for(const p of o)p[1]>f&&(f=p[1]),p[1]<c&&(c=p[1]);const m=(f+c)/2;if(m>Bi?this.onNorthPole=!0:m<-Bi&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const p=o.map(s.fromLngLat);this.tileID=function(v){let T=1/0,M=1/0,k=-1/0,w=-1/0;for(const N of v)T=Math.min(T,N.x),M=Math.min(M,N.y),k=Math.max(k,N.x),w=Math.max(w,N.y);const P=Math.max(k-T,w-M),D=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),O=Math.pow(2,D);let R=Math.floor((T+k)/2*O);return R>1&&(R-=1),new Et(D,R,Math.floor((M+w)/2*O))}(p),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ka("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const Z in this.tiles){const te=this.tiles[Z];te.state!=="loaded"&&(te.state="loaded",te.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const c=Y1(new Et(0,0,0),this.map.transform.projection),f=[c.projection.project(this.coordinates[0][0],this.coordinates[0][1]),c.projection.project(this.coordinates[1][0],this.coordinates[1][1]),c.projection.project(this.coordinates[2][0],this.coordinates[2][1]),c.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Z){const te=Z[1].x-Z[0].x,ee=Z[1].y-Z[0].y,K=Z[2].x-Z[1].x,ie=Z[2].y-Z[1].y,le=Z[3].x-Z[2].x,he=Z[3].y-Z[2].y,we=Z[0].x-Z[3].x,_e=Z[0].y-Z[3].y,xe=te*ie-K*ee,De=K*he-le*ie,Se=le*_e-we*he,Le=we*ee-te*_e;return xe>0&&De>0&&Se>0&&Le>0||xe<0&&De<0&&Se<0&&Le<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=Y1(this.tileID,this.map.transform.projection),[p,v,T,M]=this.coordinates.map(Z=>{const te=m.projection.project(Z[0],Z[1]);return i8(m,te)._round()});this.perspectiveTransform=y8(p.x,p.y,v.x,v.y,T.x,T.y,M.x,M.y);const k=this._boundsArray=new eu;k.emplaceBack(p.x,p.y,0,0),k.emplaceBack(v.x,v.y,$t,0),k.emplaceBack(M.x,M.y,0,$t),k.emplaceBack(T.x,T.y,$t,$t),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(k,_L.members),this.boundsSegments=hi.simpleSegment(0,0,4,2);const w=[],P=[OA((D=this.coordinates)[0]),OA(D[1]),OA(D[2]),OA(D[3])];var D;const[O,R,N,W]=function(Z){let te=Z[0][0],ee=te,K=Z[0][1],ie=K;for(let le=1;le<Z.length;le++)Z[le][0]<te?te=Z[le][0]:Z[le][0]>ee&&(ee=Z[le][0]),Z[le][1]<K?K=Z[le][1]:Z[le][1]>ie&&(ie=Z[le][1]);return[te,K,ee-te,ie-K]}(P);{const Z=new eu,[te,ee,K,ie]=function(He){let nt=He[0].x,Je=nt,it=He[0].y,Mt=it;for(let At=1;At<He.length;At++)He[At].x<nt?nt=He[At].x:He[At].x>Je&&(Je=He[At].x),He[At].y<it?it=He[At].y:He[At].y>Mt&&(Mt=He[At].y);return[nt,it,Je-nt,Mt-it]}(f),le=He=>[(He.x-te)/K,(He.y-ee)/ie],[he,we,_e,xe]=f.map(le),De=function(He,nt,Je,it,Mt,At,er,Rt){const Ft=IA(0,0,1,0,1,1,0,1),It=IA(He,nt,Je,it,Mt,At,er,Rt),_r=ge.mat3.adjoint([],It);return ge.mat3.multiply(Ft,Ft,_r)}(he[0],he[1],we[0],we[1],_e[0],_e[1],xe[0],xe[1]);this.elevatedGlobePerspectiveTransform=y8(he[0],he[1],we[0],we[1],_e[0],_e[1],xe[0],xe[1]);const Se=(He,nt)=>{w.push(He.lng);const Je=Math.round((He.lng-O)/N*$t),it=Math.round((He.lat-R)/W*$t),Mt=le(nt),At=ge.vec3.transformMat3([],[Mt[0],Mt[1],1],De),er=Math.round(At[0]/At[2]*$t),Rt=Math.round(At[1]/At[2]*$t);Z.emplaceBack(Je,it,er,Rt)},Le=f[3].x-f[0].x,We=f[3].y-f[0].y,Ue=f[2].x-f[1].x,Xe=f[2].y-f[1].y;for(let He=0;He<65;He++){const nt=He/64,Je=[f[0].x+nt*Le,f[0].y+nt*We],it=[f[1].x+nt*Ue,f[1].y+nt*Xe],Mt=it[0]-Je[0],At=it[1]-Je[1];for(let er=0;er<65;er++){const Rt=er/64,Ft={x:Je[0]+Mt*Rt,y:Je[1]+At*Rt,z:0};Se(c.projection.unproject(Ft.x,Ft.y),Ft)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(Z,_L.members)}{this.maxLongitudeTriangleSize=0;let Z=[],te=new qo;const ee=(K,ie,le)=>{te.emplaceBack(K,ie,le);const he=w[K],we=w[ie],_e=w[le],xe=Math.min(Math.min(he,we),_e),De=Math.max(Math.max(he,we),_e)-xe;De>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=De),Z.push(xe+De/2)};for(let K=0;K<64;K++)for(let ie=0;ie<64;ie++){const le=65*K+ie,he=le+1,we=le+65,_e=we+1;ee(le,we,he),ee(he,we,_e)}[Z,te]=function(K,ie){const le=Array.from({length:K.length},(_e,xe)=>xe);le.sort((_e,xe)=>K[_e]-K[xe]);const he=[],we=new qo;for(let _e=0;_e<le.length;_e++){const xe=le[_e];he.push(K[xe]);const De=3*xe,Se=De+1;we.emplaceBack(ie.uint16[De],ie.uint16[Se],ie.uint16[Se+1])}return[he,we]}(Z,te),this.elevatedGlobeTrianglesCenterLongitudes=Z,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(te)}this.elevatedGlobeSegments=hi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,N/$t,0,W/$t,0,0,R,O,0])}prepare(){const o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;const c=this.map.painter.context,f=c.gl;!this._dirty||this.texture instanceof PA||(this.texture?this.texture.update(this.image):(this.texture=new wL(c,this.image,f.RGBA8),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(c)}loadTile(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const c=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!c)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let m=(p=o+180)+360*Math.round((f[0]-p)/360);var p;const v=new hi,T=(P,D)=>{v.segments.push({vertexOffset:0,primitiveOffset:P,vertexLength:c.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},M=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-m)<=M){const P=Ma(f,0,f.length,m+M);return P===f.length||T(P,Jo(f,P+1,f.length,m+360-M)-P),v}m<f[0]&&(m+=360);const k=Jo(f,0,f.length,m-M);if(k===f.length)return T(0,f.length),v;T(0,k-0);const w=Ma(f,k+1,f.length,m+M);return w!==f.length&&T(w,f.length-w),v}}const jde=(Math.pow(256,2)-1)/16907520;class _8 extends zo{constructor(o,c,f,m){super(o,{layout:m8||(m8=new Ei({visibility:new jt(at.layout_raster.visibility)})),paint:g8||(g8=new Ei({"raster-opacity":new jt(at.paint_raster["raster-opacity"]),"raster-color":new Gf(at.paint_raster["raster-color"]),"raster-color-mix":new jt(at.paint_raster["raster-color-mix"]),"raster-color-range":new jt(at.paint_raster["raster-color-range"]),"raster-hue-rotate":new jt(at.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jt(at.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jt(at.paint_raster["raster-brightness-max"]),"raster-saturation":new jt(at.paint_raster["raster-saturation"]),"raster-contrast":new jt(at.paint_raster["raster-contrast"]),"raster-resampling":new jt(at.paint_raster["raster-resampling"]),"raster-fade-duration":new jt(at.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new jt(at.paint_raster["raster-emissive-strength"]),"raster-array-band":new jt(at.paint_raster["raster-array-band"]),"raster-elevation":new jt(at.paint_raster["raster-elevation"]),"raster-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},c,f,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof v8&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const c=this._transitionablePaint._values["raster-color"].value.expression,[f,m]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(m)||f===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=L1({expression:c,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,m])}}let x8,b8,w8,S8,T8;class E8 extends zo{constructor(o,c,f,m){super(o,{layout:x8||(x8=new Ei({visibility:new jt(at["layout_raster-particle"].visibility)})),paint:b8||(b8=new Ei({"raster-particle-array-band":new jt(at["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new jt(at["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Gf(at["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new jt(at["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new jt(at["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new jt(at["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new jt(at["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new jt(at["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},c,f,m),this._updateColorRamp(),this.lastInvalidatedAt=gt.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,c=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=L1({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:c}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=gt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Fde extends zo{constructor(o,c){super(o,{},c,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(o){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function SL(d,o,c){const f=[0,0,1],m=ge.quat.identity([]);return ge.quat.rotateY(m,m,c?-Ge(d)+Math.PI:Ge(d)),ge.quat.rotateX(m,m,-Ge(o)),ge.vec3.transformQuat(f,f,m),ge.vec3.normalize(f,f)}function A8(d,o){const c=kA(d.projection,d.zoom,d.width,d.height),f=function(p,v,T,M,k){const w=new bn(T.lng-180*sp,T.lat),P=new bn(T.lng+180*sp,T.lat),D=p.project(w.lng,w.lat),O=p.project(P.lng,P.lat),R=-Math.atan2(O.y-D.y,O.x-D.x),N=s.fromLngLat(T);N.y=Yt(N.y,-1+sp,1-sp);const W=N.toLngLat(),Z=p.project(W.lng,W.lat),te=s.fromLngLat(W);te.x+=sp;const ee=te.toLngLat(),K=p.project(ee.lng,ee.lat),ie=M8(K.x-Z.x,K.y-Z.y,R),le=s.fromLngLat(W);le.y+=sp;const he=le.toLngLat(),we=p.project(he.lng,he.lat),_e=M8(we.x-Z.x,we.y-Z.y,R),xe=Math.abs(ie.x)/Math.abs(_e.y),De=ge.mat4.identity([]);ge.mat4.rotateZ(De,De,-R*(1-(k?0:M)));const Se=ge.mat4.identity([]);return ge.mat4.scale(Se,Se,[1,1-(1-xe)*M,1]),Se[4]=-_e.x/_e.y*M,ge.mat4.rotateZ(Se,Se,R),ge.mat4.multiply(Se,De,Se),Se}(d.projection,0,d.center,c,o),m=C8(d);return ge.mat4.scale(f,f,[m,m,1]),f}function C8(d){const o=d.projection,c=kA(d.projection,d.zoom,d.width,d.height),f=TL(o,d.center),m=TL(o,bn.convert(o.center));return Math.pow(2,f*c+(1-c)*m)}function kA(d,o,c,f,m=1/0){const p=d.range;if(!p)return 0;const v=Math.min(m,Math.max(c,f)),T=Math.log(v/1024)/Math.LN2;return Zr(p[0]+T,p[1]+T,o)}const sp=1/4e4;function TL(d,o){const c=Yt(o.lat,-Bi,Bi),f=new bn(o.lng-180*sp,c),m=new bn(o.lng+180*sp,c),p=d.project(f.lng,c),v=d.project(m.lng,c),T=s.fromLngLat(f),M=s.fromLngLat(m),k=v.x-p.x,w=v.y-p.y,P=M.x-T.x,D=M.y-T.y,O=Math.sqrt((P*P+D*D)/(k*k+w*w));return Math.log(O)/Math.LN2}function M8(d,o,c){const f=Math.cos(c),m=Math.sin(c);return{x:d*f-o*m,y:d*m+o*f}}function P8(d,o,c){ge.mat4.identity(d),ge.mat4.rotateZ(d,d,Ge(o[2])),ge.mat4.rotateX(d,d,Ge(o[0])),ge.mat4.rotateY(d,d,Ge(o[1])),ge.mat4.scale(d,d,c),ge.mat4.multiply(d,d,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function RA(d,o,c,f,m,p,v,T){const M=[c[0]-o[0],c[1]-o[1],0],k=[f[0]-o[0],f[1]-o[1],0];if(ge.vec3.length(M)<1e-12||ge.vec3.length(k)<1e-12)return ge.quat.identity(d);const w=ge.vec3.cross([],M,k);ge.vec3.normalize(w,w),ge.vec3.subtract(k,f,o),M[2]=(p-m)*T,k[2]=(v-m)*T;const P=M;return ge.vec3.cross(P,M,k),ge.vec3.normalize(P,P),ge.quat.rotationTo(d,w,P)}function EL(d,o,c=!1){const f=Va(o.zoom),m=function(p,v,T){const M=v.worldSize,k=[p[12],p[13],p[14]],w=Ho(k[1]/M),P=ts(k[0]/M),D=ge.mat4.identity([]),O=ta(1,w)*M,R=ta(1,0)*M*ld(w,v.zoom),N=1/pc(M);let W=R*N;if(T){const K=kA(v.projection,v.zoom,v.width,v.height,1024);W=N*v.projection.pixelSpaceConversion(v.center.lat,M,K)}const Z=uh(w,P);ge.vec3.add(Z,Z,ge.vec3.scale([],ge.vec3.normalize([],Z),O*W*k[2]));const te=function(K){const ie=[K[0],K[1],K[2]];let le=[0,1,0];const he=ge.vec3.cross([],le,ie);return ge.vec3.cross(le,ie,he),ge.vec3.squaredLength(le)===0&&(le=[0,1,0],ge.vec3.cross(he,ie,le)),ge.vec3.normalize(he,he),ge.vec3.normalize(le,le),ge.vec3.normalize(ie,ie),[he[0],he[1],he[2],0,le[0],le[1],le[2],0,ie[0],ie[1],ie[2],0,K[0],K[1],K[2],1]}(Z);ge.mat4.scale(D,D,[W,W,W*O]),ge.mat4.translate(D,D,[-k[0],-k[1],-k[2]]);const ee=ge.mat4.multiply([],v.globeMatrix,te);return ge.mat4.multiply(ee,ee,D),ge.mat4.multiply(ee,ee,p),ee}(d,o,c);if(f>0){const p=function(v,T){const M=T.worldSize,k=ta(1,0)*M*ld(T.center.lat,T.zoom)/pc(M),w=ta(1,T.center.lat)*M,P=ge.mat4.identity([]);return ge.mat4.rotateY(P,P,Ge(T.center.lng)),ge.mat4.rotateX(P,P,Ge(T.center.lat)),ge.mat4.translate(P,P,[0,0,Oa]),ge.mat4.scale(P,P,[k,k,k*w]),ge.mat4.translate(P,P,[T.point.x-.5*M,T.point.y-.5*M,0]),ge.mat4.multiply(P,P,v),ge.mat4.multiply(P,T.globeMatrix,P)}(d,o);return function(v,T,M){const k=(R,N,W)=>{const Z=ge.vec3.length(R),te=ge.vec3.length(N),ee=To(R,N,W);return ge.vec3.scale(ee,ee,1/ge.vec3.length(ee)*br(Z,te,W))},w=k([v[0],v[1],v[2]],[T[0],T[1],T[2]],M),P=k([v[4],v[5],v[6]],[T[4],T[5],T[6]],M),D=k([v[8],v[9],v[10]],[T[8],T[9],T[10]],M),O=To([v[12],v[13],v[14]],[T[12],T[13],T[14]],M);return[w[0],w[1],w[2],0,P[0],P[1],P[2],0,D[0],D[1],D[2],0,O[0],O[1],O[2],1]}(m,p,f)}return m}function I8(d,o,c,f){const m=lr.projectAabbCorners(f,c);let p=Number.MAX_VALUE,v=-1;for(let k=0;k<m.length;++k){const w=m[k];w[0]=(.5*w[0]+.5)*o.width,w[1]=(.5-.5*w[1])*o.height,w[2]<p&&(v=k,p=w[2])}const T=k=>new xt(m[k][0],m[k][1]);let M;switch(v){case 0:case 6:M=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:M=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:M=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:M=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(ce(d,M))return p}const Bde=xn([{name:"a_pos_3f",components:3,type:"Float32"}]),$de=xn([{name:"a_color_3f",components:3,type:"Float32"}]),Ude=xn([{name:"a_color_4f",components:4,type:"Float32"}]),Vde=xn([{name:"a_uv_2f",components:2,type:"Float32"}]),Wde=xn([{name:"a_normal_3f",components:3,type:"Float32"}]),Gde=xn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),qde=xn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),O8={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class DA{constructor(o,c,f,m){this.message=(o?`${o}: `:"")+f,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function k8(d,o){const c=d.indexOf("://")===-1;try{return new URL(d,c&&o?"http://example.com":void 0),!0}catch{return!1}}class R8{constructor(o,c){this.feature=o,this.instancedDataOffset=c,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class D8{constructor(){this.instancedDataArray=new Hv,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class AL{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(o,c){}populate(o,c,f,m){this.tileToMeter=y(f);const p=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:M,sourceLayerIndex:k}of o){const w=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),P=V(v,p);if(!this.layers[0]._featureFilter.filter(new Hn(this.zoom),P,f))continue;const D={id:w,sourceLayerIndex:k,index:M,geometry:p?P.geometry:U(v,f,m),properties:v.properties,type:v.type,patterns:{}},O=this.addFeature(D,D.geometry,P);O&&c.featureIndex.insert(v,D.geometry,M,k,this.index,this.instancesPerModel[O].instancedDataArray.length,$t/32)}this.lookup=null}update(o,c,f,m){for(const p in this.instancesPerModel){const v=this.instancesPerModel[p];for(const T in o)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],o[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];for(const m of f.features){const p=this.layers[0],v=m.feature,T=this.canonical,M=p.paint.get("model-rotation").evaluate(v,{},T),k=p.paint.get("model-scale").evaluate(v,{},T),w=p.paint.get("model-translation").evaluate(v,{},T);ge.vec3.exactEquals(m.rotation,M)&&ge.vec3.exactEquals(m.scale,k)&&ge.vec3.exactEquals(m.translation,w)||(this.evaluate(m,m.featureStates,f,!0),o=!0)}}return o}updateReplacement(o,c,f,m){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(KD(this.activeReplacements,p))return!1;this.activeReplacements=p;let v=!1;for(const T in this.instancesPerModel){const M=this.instancesPerModel[T],k=M.instancedDataArray;for(const w of M.features){const P=w.instancedDataOffset,D=w.instancedDataCount;for(let O=0;O<D;O++){const R=16*(O+P);let N=k.float32[R+0];const W=N>$t;N=W?N-$t:N;const Z=Math.floor(N),te=k.float32[R+1];let ee=!1;for(const K of this.activeReplacements)if(!V6(K,f,O8.Model,m)&&!(K.min.x>Z||Z>K.max.x||K.min.y>te||te>K.max.y)&&(ee=X6(Z6(Z,te,o.canonical,K.footprintTileId.canonical),K.footprint),ee))break;k.float32[R]=ee?N+$t:N,v=v||ee!==W}}}return v}isEmpty(){for(const o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];f.instancedDataArray.length<0||f.instancedDataArray.length===0||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=o.createVertexBuffer(f.instancedDataArray,Gde.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris)for(const c of this.modelUris)o.removeModel(c,"")}addFeature(o,c,f){const m=this.layers[0],p=m.layout.get("model-id").evaluate(f,{},this.canonical);if(!p)return ai(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),p;k8(p,!1)&&(this.modelUris.includes(p)||this.modelUris.push(p)),this.instancesPerModel[p]||(this.instancesPerModel[p]=new D8);const v=this.instancesPerModel[p],T=v.instancedDataArray,M=new R8(f,T.length);for(const k of c)for(const w of k){if(w.x<0||w.x>=$t||w.y<0||w.y>=$t)continue;const P=(this.lookupDim-1)/$t,D=this.lookupDim*(w.y*P|0)+w.x*P|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const O=T.length;T.resize(O+1),v.instancesEvaluatedElevation.push(0),T.float32[16*O]=w.x,T.float32[16*O+1]=w.y}return M.instancedDataCount=v.instancedDataArray.length-M.instancedDataOffset,M.instancedDataCount>0&&(o.id&&(v.idToFeaturesIndex[o.id]=v.features.length),v.features.push(M),this.evaluate(M,{},v,!1)),p}getModelUris(){return this.modelUris}evaluate(o,c,f,m){const p=this.layers[0],v=o.feature,T=this.canonical,M=o.rotation=p.paint.get("model-rotation").evaluate(v,c,T),k=o.scale=p.paint.get("model-scale").evaluate(v,c,T),w=o.translation=p.paint.get("model-translation").evaluate(v,c,T),P=p.paint.get("model-color").evaluate(v,c,T);P.a=p.paint.get("model-color-mix-intensity").evaluate(v,c,T);const D=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,k[0]),Math.max(k[1],k[2])),P8(D,M,k);const O=Math.round(100*P.a)+P.b/1.05;for(let R=0;R<o.instancedDataCount;++R){const N=o.instancedDataOffset+R,W=16*N,Z=f.instancedDataArray.float32;let te=0;m&&(te=Z[W+6]-f.instancesEvaluatedElevation[N]);const ee=0|Z[W+1];Z[W]=(0|Z[W])+P.r/1.05,Z[W+1]=ee+P.g/1.05,Z[W+2]=O,Z[W+3]=1/(T.z>10?this.tileToMeter:y(T,ee)),Z[W+4]=w[0],Z[W+5]=w[1],Z[W+6]=w[2]+te,Z[W+7]=D[0],Z[W+8]=D[1],Z[W+9]=D[2],Z[W+10]=D[4],Z[W+11]=D[5],Z[W+12]=D[6],Z[W+13]=D[8],Z[W+14]=D[9],Z[W+15]=D[10],f.instancesEvaluatedElevation[N]=w[2]}}}let L8,N8;Qt(AL,"ModelBucket",{omit:["layers"]}),Qt(D8,"PerModelAttributes"),Qt(R8,"ModelFeature");const Cg=64,l_={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function z8(d,o,c,f,m,p,v,T,M,k=!1){const w=c.zoom,P=c.project(f),D=ld(f.lat,w),O=1/D;ge.mat4.identity(d),ge.mat4.translate(d,d,[P.x+v[0]*O,P.y+v[1]*O,v[2]]);let R=1,N=1;const W=c.worldSize;if(k){if(c.projection.name==="mercator"){let K=0;c.elevation&&(K=c.elevation.getAtPointOrZero(new s(P.x/W,P.y/W),0));const ie=ge.vec4.transformMat4([],[P.x,P.y,K,1],c.projMatrix)[3]/c.cameraToCenterDistance;R=ie,N=ie*ld(c.center.lat,w)}else if(c.projection.name==="globe"){const K=EL(d,c),ie=ge.mat4.multiply([],c.projMatrix,K),le=[0,0,0,1];ge.vec4.transformMat4(le,le,ie);const he=le[3]/c.cameraToCenterDistance,we=Va(w),_e=c.projection.pixelsPerMeter(f.lat,W)*ld(f.lat,w),xe=c.projection.pixelsPerMeter(c.center.lat,W)*ld(c.center.lat,w);R=he/br(_e,nA(c.center.lat),we),N=he*D/_e,R*=xe,N*=xe}}else R=O;ge.mat4.scale(d,d,[R,R,N]);const Z=[...d],te=o.orientation,ee=[];if(P8(ee,[te[0]+m[0],te[1]+m[1],te[2]+m[2]],p),ge.mat4.multiply(d,Z,ee),T&&c.elevation){let K=0;const ie=[];if(M&&c.elevation){K=function(we,_e,xe,De,Se){const Le=_e.elevation;if(!Le)return 0;const We=lr.projectAabbCorners(xe,De),Ue=ta(1,Se.lat)*_e.worldSize,Xe=function(_r,Xt){const or=[0,0,1],Cr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Gr of Cr){const Ir=_r[Gr.corners[0]],Qr=_r[Gr.corners[1]],Wr=_r[Gr.corners[2]],tn=[Qr[0]-Ir[0],Qr[1]-Ir[1],Xt*(Qr[2]-Ir[2])],gn=ge.vec3.cross(tn,tn,[Wr[0]-Ir[0],Wr[1]-Ir[1],Xt*(Wr[2]-Ir[2])]);ge.vec3.normalize(gn,gn),Gr.dotProductWithUp=ge.vec3.dot(gn,or)}return Cr.sort((Gr,Ir)=>Gr.dotProductWithUp-Ir.dotProductWithUp),Cr[0].corners}(We,Ue),He=We[Xe[0]],nt=We[Xe[1]],Je=We[Xe[2]],it=We[Xe[3]],Mt=Le.getAtPointOrZero(new s(He[0]/_e.worldSize,He[1]/_e.worldSize),0),At=Le.getAtPointOrZero(new s(nt[0]/_e.worldSize,nt[1]/_e.worldSize),0),er=Le.getAtPointOrZero(new s(Je[0]/_e.worldSize,Je[1]/_e.worldSize),0),Rt=Le.getAtPointOrZero(new s(it[0]/_e.worldSize,it[1]/_e.worldSize),0),Ft=(Mt+Rt)/2,It=(At+er)/2;return Ft>It?At<er?RA(we,nt,it,He,At,Rt,Mt,Ue):RA(we,Je,He,it,er,Mt,Rt,Ue):Mt<Rt?RA(we,He,nt,Je,Mt,At,er,Ue):RA(we,it,Je,nt,Rt,er,At,Ue),Math.max(Ft,It)}(ie,c,o.aabb,d,f);const le=ge.mat4.fromQuat([],ie),he=ge.mat4.multiply([],le,ee);ge.mat4.multiply(d,Z,he)}else K=c.elevation.getAtPointOrZero(new s(P.x/W,P.y/W),0);K!==0&&(d[14]+=K)}}function tw(d,o,c=!1){d.uploaded||(d.gfxTexture=new wL(o,d.image,c?o.gl.R8:o.gl.RGBA8,{useMipmap:d.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),d.uploaded=!0,d.image=null)}function Hde(d,o,c){d.indexBuffer=o.createIndexBuffer(d.indexArray,!1,!0),d.vertexBuffer=o.createVertexBuffer(d.vertexArray,Bde.members,!1,!0),d.normalArray&&(d.normalBuffer=o.createVertexBuffer(d.normalArray,Wde.members,!1,!0)),d.texcoordArray&&(d.texcoordBuffer=o.createVertexBuffer(d.texcoordArray,Vde.members,!1,!0)),d.colorArray&&(d.colorBuffer=o.createVertexBuffer(d.colorArray,(d.colorArray.bytesPerElement===12?$de:Ude).members,!1,!0)),d.featureArray&&(d.pbrBuffer=o.createVertexBuffer(d.featureArray,qde.members,!0)),d.segments=hi.simpleSegment(0,0,d.vertexArray.length,d.indexArray.length);const f=d.material;f.pbrMetallicRoughness.baseColorTexture&&tw(f.pbrMetallicRoughness.baseColorTexture,o),f.pbrMetallicRoughness.metallicRoughnessTexture&&tw(f.pbrMetallicRoughness.metallicRoughnessTexture,o),f.normalTexture&&tw(f.normalTexture,o),f.occlusionTexture&&tw(f.occlusionTexture,o,c),f.emissionTexture&&tw(f.emissionTexture,o)}function CL(d,o,c){if(d.meshes)for(const f of d.meshes)Hde(f,o,c);if(d.children)for(const f of d.children)CL(f,o,c)}function LA(d){if(d.meshes)for(const o of d.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(d.children)for(const o of d.children)LA(o)}function ML(d){if(d.meshes)for(const c of d.meshes)c.vertexBuffer&&(c.vertexBuffer.destroy(),c.indexBuffer.destroy(),c.normalBuffer&&c.normalBuffer.destroy(),c.texcoordBuffer&&c.texcoordBuffer.destroy(),c.colorBuffer&&c.colorBuffer.destroy(),c.pbrBuffer&&c.pbrBuffer.destroy(),c.segments.destroy(),c.material&&((o=c.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(d.children)for(const c of d.children)ML(c)}class c_{constructor(o,c,f){this._demTile=o,this._dem=this._demTile.dem,this._scale=c,this._offset=f}static create(o,c,f){const m=f||o.findDEMTileFor(c);if(!m||!m.dem)return;const p=m.dem,v=m.tileID,T=1<<c.canonical.z-v.canonical.z;return new c_(m,p.dim/$t/T,[(c.canonical.x/T-v.canonical.x)*p.dim,(c.canonical.y/T-v.canonical.y)*p.dim])}tileCoordToPixel(o,c){const f=c*this._scale+this._offset[1],m=Math.floor(o*this._scale+this._offset[0]),p=Math.floor(f);return new xt(m,p)}getElevationAt(o,c,f,m){const p=o*this._scale+this._offset[0],v=c*this._scale+this._offset[1],T=Math.floor(p),M=Math.floor(v),k=this._dem;return m=!!m,f?br(br(k.get(T,M,m),k.get(T,M+1,m),v-M),br(k.get(T+1,M,m),k.get(T+1,M+1,m),v-M),p-T):k.get(T,M,m)}getElevationAtPixel(o,c,f){return this._dem.get(o,c,!!f)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*ta(1,o)*this._dem.stride}}const PL=new Float32Array(262144),Mg=new Uint8Array(262144);function j8(d){let o=0;if(d.meshes)for(const c of d.meshes)o=Math.max(o,c.aabb.max[2]);if(d.children)for(const c of d.children)o=Math.max(o,j8(c));return o}function F8(d,o,c){if(d.meshes)for(const f of d.meshes){if(f.aabb.min[0]===1/0)continue;const m=lr.applyTransform(f.aabb,d.matrix);c.insert(o,m.min[0],m.min[1],m.max[0],m.max[1])}if(d.children)for(const f of d.children)F8(f,o,c)}const B8=["","wall","door","roof","window","lamp","logo"];class $8{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:j8(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new lr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const c=new lr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==o&&(f.transformedAabb=lr.applyTransformFast(f.aabb,this.node.matrix),c.encapsulate(f.transformedAabb)),o++;this.aabb=c}return this.aabb}}class NA{constructor(o,c,f,m,p,v,T){this.id=f,this.layers=o,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=l_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=l_.HasMapboxMeshFeatures),p&&(this.modelTraits|=l_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const M of c)this.nodesInfo.push(new $8(M)),F8(M,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,c){for(const f of this.getNodesInfo()){const m=f.node;m.footprint&&c.push({footprint:m.footprint,id:o})}}update(o){const c=Object.keys(o).length!==0;if(c&&!this.stateDependentLayers.length)return;const f=c?this.stateDependentLayers:this.layers;if(!un(o,this.states))for(const m of f)this.evaluate(m,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const c=this.getNodesInfo();for(const f of c){const m=f.node;this.uploaded?this.updatePbrBuffer(m):CL(m,o,!0)}for(const f of c)LA(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let c=!1;if(!o.meshes)return c;for(const f of o.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),c=!0);return c}needsReEvaluation(o,c,f){const m=o.transform.projectionOptions,p=o.style.getBrightness(),v=this.brightness!==p;if(!this.uploaded||this.dirty||m.name!==this.projection.name||rw(f.paint.get("model-color").value,v)||rw(f.paint.get("model-color-mix-intensity").value,v)||rw(f.paint.get("model-roughness").value,v)||rw(f.paint.get("model-emissive-strength").value,v)||rw(f.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=m,this.brightness=p;const T=this.getNodesInfo();for(const M of T)M.state=null;return!0}return!1}evaluateScale(o,c){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const f=this.getNodesInfo(),m=this.id.canonical;for(const p of f){const v=p.feature;p.evaluatedScale=c.paint.get("model-scale").evaluate(v,{},m)}}evaluate(o,c){const f=this.getNodesInfo();for(const m of f){if(!m.node.meshes)continue;const p=m.feature,v=c&&c[p.id];if(un(v,m.state))continue;m.state=structuredClone(v);const T=m.node.meshes&&m.node.meshes[0].featureData,M=m.evaluatedColor[2],k=m.evaluatedRMEA[2],w=this.id.canonical;if(m.hasTranslucentParts=!1,T){for(let P=0;P<B8.length;P++){const D=B8[P];D.length&&(p.properties.part=D);const O=o.paint.get("model-color").evaluate(p,v,w).toRenderColor(null),R=o.paint.get("model-color-mix-intensity").evaluate(p,v,w);m.evaluatedColor[P]=[O.r,O.g,O.b,R],m.evaluatedRMEA[P][0]=o.paint.get("model-roughness").evaluate(p,v,w),m.evaluatedRMEA[P][2]=o.paint.get("model-emissive-strength").evaluate(p,v,w),m.evaluatedRMEA[P][3]=O.a,m.emissionHeightBasedParams[P]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(p,v,w),!m.hasTranslucentParts&&O.a<1&&(m.hasTranslucentParts=!0)}delete p.properties.part,Xde(m,M!==m.evaluatedColor[2]||k!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(p,v,w);m.evaluatedScale=o.paint.get("model-scale").evaluate(p,v,w),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,c,f,m){const p=o.findDEMTileFor(f);if(p&&(p.tileID.canonical!==this.terrainTile||c!==this.terrainExaggeration)){if(p.dem&&p.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=p.tileID.overscaledZ;const v=c_.create(o,f,p);if(!v)return;this.modelTraits&l_.HasMapboxMeshFeatures&&this.updateDEM(o,v,f,m);for(const T of this.getNodesInfo()){const M=T.node;if(!M.footprint||!M.footprint.vertices||!M.footprint.vertices.length)continue;const k=M.footprint.vertices;let w=v.getElevationAt(k[0].x,k[0].y,!0,!0);for(let P=1;P<k.length;P++)w=Math.min(w,v.getElevationAt(k[P].x,k[P].y,!0,!0));M.elevation=w}}this.terrainTile=p.tileID.canonical,this.terrainExaggeration=c}}updateDEM(o,c,f,m){let p=c._dem._modifiedForSources[m];if(p===void 0&&(c._dem._modifiedForSources[m]=[],p=c._dem._modifiedForSources[m]),p.includes(f.canonical))return;const v=c._dem.dim;p.push(f.canonical);let T=!1;for(const M of this.getNodesInfo()){const k=M.node;if(!k.footprint||!k.footprint.grid)continue;const w=k.footprint.grid,P=c.tileCoordToPixel(w.min.x,w.min.y),D=c.tileCoordToPixel(w.max.x,w.max.y),O=Math.min(Math.min(v-D.y,P.x),Math.min(P.y,v-D.x));if(O<0)continue;const R=Yt(O,2,5);let N=Math.max(0,P.x-R),W=Math.max(0,P.y-R),Z=Math.min(D.x+R,v-1),te=Math.min(D.y+R,v-1);for(let le=W;le<=te;++le)for(let he=N;he<=Z;++he)Mg[le*v+he]=255;let ee=0,K=0;for(let le=0;le<w.cellsY;++le)for(let he=0;he<w.cellsX;++he){if(!w.cells[le*w.cellsX+he])continue;const we=c.tileCoordToPixel(w.min.x+he/w.xScale,w.min.y+le/w.yScale),_e=c.tileCoordToPixel(w.min.x+(he+1)/w.xScale,w.min.y+(le+1)/w.yScale);for(let xe=we.y;xe<=Math.min(_e.y+1,v-1);++xe)for(let De=we.x;De<=Math.min(_e.x+1,v-1);++De)Mg[xe*v+De]===255&&(Mg[xe*v+De]=0,ee+=c.getElevationAtPixel(De,xe),K++)}const ie=ee/K;N=Math.max(1,P.x-R),W=Math.max(1,P.y-R),Z=Math.min(D.x+R,v-2),te=Math.min(D.y+R,v-2),T=!0;for(let le=W;le<=te;++le)for(let he=N;he<=Z;++he)Mg[le*v+he]===0&&(PL[le*v+he]=c._dem.set(he,le,ie));for(let le=1;le<R;++le){N=Math.max(1,P.x-le),W=Math.max(1,P.y-le),Z=Math.min(D.x+le,v-2),te=Math.min(D.y+le,v-2);for(let he=W;he<=te;++he)for(let we=N;we<=Z;++we){const _e=he*v+we;if(Mg[_e]===255){let xe=0,De=0,Se=-1,Le=-1;for(let We=-1;We<=1;++We)for(let Ue=-1;Ue<=1;++Ue){const Xe=(he+We)*v+we+Ue;if(Mg[Xe]>=le)continue;const He=PL[Xe],nt=Math.abs(He);nt>De&&(xe=He,De=nt,Se=Ue,Le=We)}if(De>.1){const We=1-(le+.5*Math.abs(Se*Le))/R;let Ue=c._dem.get(we,he)+xe*We;const Xe=c._dem.get(we+Se,he+Le),He=c._dem.get(we-Se,he-Le,!0);(Ue-Xe)*(Ue-He)>0&&(Ue=(Xe+He)/2),PL[_e]=c._dem.set(we,he,Ue),Mg[_e]=le}}}}}T&&(c._demTile.needsDEMTextureUpload=!0,c._dem._timestamp=gt.now())}setFilter(o){this.filter=o?d1(o):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(o=>this.filter.filter(new Hn(this.id.overscaledZ),o.feature,this.id.canonical)):this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const c of o)LA(c.node),ML(c.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,c){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const f=c.getReplacementRegionsForTile(o.toUnwrapped()),m=this.getNodesInfo();for(let p=0;p<this.nodesInfo.length;p++){const v=m[p].node;m[p].hiddenByReplacement=!!v.footprint&&!f.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(o,c){const f=this.getNodesInfo(),m=[],p=[0,0,0],v=ge.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const M=f[T],k=M.node.meshes[0],w=k.transformedAabb;if(o<w.min[0]||c<w.min[1]||o>w.max[0]||c>w.max[1])continue;if(M.node.hidden===!0)return{height:1/0,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};ge.mat4.invert(v,M.node.matrix),p[0]=o,p[1]=c,ge.vec3.transformMat4(p,p,v);const P=(p[0]-k.aabb.min[0])/(k.aabb.max[0]-k.aabb.min[0])*Cg|0,D=Math.min(63,(p[1]-k.aabb.min[1])/(k.aabb.max[1]-k.aabb.min[1])*Cg|0)*Cg+Math.min(63,P),O=k.heightmap[D];if(!(O<0&&M.node.footprint))return M.hiddenByReplacement?void 0:{height:O,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};if(M.node.footprint.grid.query(new xt(o,c),new xt(o,c),m),m.length>0)return{height:void 0,maxHeight:M.feature.properties.height,hidden:M.hiddenByReplacement,verticalScale:M.evaluatedScale[2]}}}}function rw(d,o){return!d.isLightConstant&&o}function Zde(d,o,c,f,m,p,v,T){let M=(61440&o|(61440&o)>>4)>>8,k=(3840&o|(3840&o)>>4)>>4,w=240&o|(240&o)>>4;c[3]>0&&(M=br(M,255*c[0],c[3]),k=br(k,255*c[1],c[3]),w=br(w,255*c[2],c[3]));const P=M<<8|k,D=w<<8|Math.floor(255*f[3]),O=function(le){const he=Yt(le,0,2);return Math.min(Math.round(.5*he*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],R=Yt(m[0],0,1),N=Yt(m[1],0,1),W=Yt(m[2],0,1),Z=Yt(m[3],0,1);let te,ee,K,ie;if(R!==N&&v!==p&&N!==R){const le=v-p;ee=1/(le*(N-R)),K=-(p+le*R)/(le*(N-R));const he=Yt(m[4],-1,1);ie=Math.pow(10,he),te=255*W<<8|255*Z}else te=65535,ee=0,K=1,ie=1;if(d.emplaceBack(P,D,O,te,ee,K,ie),T){const le=T.length;T.clear();for(let he=0;he<le;he++)T.emplaceBack(P,D,O,te,ee,K,ie)}}function Xde(d,o,c){const f=d.node;let m=0;const p=c&l_.HasMeshoptCompression;for(const v of f.meshes){if(f.lights&&f.lightMeshIndex===m||!v.featureData)continue;v.featureArray=new Zv,v.featureArray.reserve(v.featureData.length);let T=o;for(const M of v.featureData){const k=p?65535&M:M>>16&65535,w=p?M>>16&65535:65535&M,P=(15&w)<8?15&w:0,D=d.evaluatedRMEA[P],O=d.evaluatedColor[P],R=d.emissionHeightBasedParams[P];let N;if(T&&P===2&&f.lights&&(N=new Zv,N.resize(10*f.lights.length)),Zde(v.featureArray,k,O,D,R,v.aabb.min[2],v.aabb.max[2],N),N&&T){T=!1;const W=f.meshes[f.lightMeshIndex];W.featureArray=N,W.featureArray._trim()}}v.featureArray._trim(),m++}}function U8(d,o,c,f){const m=1<<d.z;o.lat=Ho((f/$t+d.y)/m),o.lng=ts((c/$t+d.x)/m)}Qt(NA,"Tiled3dModelBucket",{omit:["layers"]}),Qt($8,"Tiled3dModelFeature");const Yde={circle:class extends zo{constructor(d,o,c,f){super(d,{layout:et||(et=new Ei({"circle-sort-key":new Jt(at.layout_circle["circle-sort-key"]),"circle-elevation-reference":new jt(at.layout_circle["circle-elevation-reference"]),visibility:new jt(at.layout_circle.visibility)})),paint:wt||(wt=new Ei({"circle-radius":new Jt(at.paint_circle["circle-radius"]),"circle-color":new Jt(at.paint_circle["circle-color"]),"circle-blur":new Jt(at.paint_circle["circle-blur"]),"circle-opacity":new Jt(at.paint_circle["circle-opacity"]),"circle-translate":new jt(at.paint_circle["circle-translate"]),"circle-translate-anchor":new jt(at.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jt(at.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jt(at.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jt(at.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jt(at.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jt(at.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new jt(at.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f)}createBucket(d){return new re(d)}queryRadius(d){const o=d;return rt("circle-radius",this,o)+rt("circle-stroke-width",this,o)+St(this.paint.get("circle-translate"))}queryIntersectsFeature(d,o,c,f,m,p,v,T){const M=Dt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c);return e_(d,f,p,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,k)}getProgramIds(){return["circle"]}getDefaultProgramParams(d,o,c){const f=ep(this);return{config:new ch(this,{zoom:o,lut:c}),defines:f,overrideFog:!1}}},heatmap:class extends zo{createBucket(d){return new h6(d)}constructor(d,o,c,f){super(d,{layout:f6||(f6=new Ei({visibility:new jt(at.layout_heatmap.visibility)})),paint:p6||(p6=new Ei({"heatmap-radius":new Jt(at.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jt(at.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jt(at.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gf(at.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jt(at.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=L1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(d){return rt("heatmap-radius",this,d)}queryIntersectsFeature(d,o,c,f,m,p,v,T){const M=this.paint.get("heatmap-radius").evaluate(o,c);return e_(d,f,p,v,T,!0,!0,new xt(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(d,o,c){return d==="heatmap"?{config:new ch(this,{zoom:o,lut:c}),overrideFog:!1}:{}}},hillshade:class extends zo{constructor(d,o,c,f){super(d,{layout:m6||(m6=new Ei({visibility:new jt(at.layout_hillshade.visibility)})),paint:g6||(g6=new Ei({"hillshade-illumination-direction":new jt(at.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new jt(at.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jt(at.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jt(at.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jt(at.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jt(at.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new jt(at.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(d,o,c){return{overrideFog:!1}}},fill:class extends zo{constructor(d,o,c,f){super(d,{layout:L6||(L6=new Ei({"fill-sort-key":new Jt(at.layout_fill["fill-sort-key"]),visibility:new jt(at.layout_fill.visibility),"fill-elevation-reference":new jt(at.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Jt(at.layout_fill["fill-construct-bridge-guard-rail"])})),paint:N6||(N6=new Ei({"fill-antialias":new jt(at.paint_fill["fill-antialias"]),"fill-opacity":new Jt(at.paint_fill["fill-opacity"]),"fill-color":new Jt(at.paint_fill["fill-color"]),"fill-outline-color":new Jt(at.paint_fill["fill-outline-color"]),"fill-translate":new jt(at.paint_fill["fill-translate"]),"fill-translate-anchor":new jt(at.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jt(at.paint_fill["fill-pattern"]),"fill-emissive-strength":new jt(at.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Jt(at.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Jt(at.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Jt(at.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f)}getProgramIds(){const d=this.paint.get("fill-pattern"),o=d&&d.constantOr(1),c=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getDefaultProgramParams(d,o,c){return{config:new ch(this,{zoom:o,lut:c}),overrideFog:!1}}recalculate(d,o){super.recalculate(d,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new ZD(d)}queryRadius(){return St(this.paint.get("fill-translate"))}queryIntersectsFeature(d,o,c,f,m,p){return!d.queryGeometry.isAboveHorizon&&pe(Tt(d.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),f)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(d){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const o=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return d!=null?o&&!d:o}},"fill-extrusion":class extends zo{constructor(d,o,c,f){super(d,{layout:uV||(uV=new Ei({visibility:new jt(at["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new jt(at["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:dV||(dV=new Ei({"fill-extrusion-opacity":new jt(at["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jt(at["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jt(at["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jt(at["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jt(at["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jt(at["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jt(at["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new jt(at["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new jt(at["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new jt(at["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new jt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new jt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new jt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new jt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new jt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new jt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new jt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Jt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Jt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new jt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new jt(at["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new jt(at["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new jt(at["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Jt(at["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Jt(at["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new jt(at["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new fA(d)}queryRadius(){return St(this.paint.get("fill-extrusion-translate"))}is3D(d){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(d,o,c,f,m,p,v,T,M){const k=Dt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(o,c),P=this.paint.get("fill-extrusion-base").evaluate(o,c),D=[0,0],O=T&&p.elevation,R=p.elevation?p.elevation.exaggeration():1,N=d.tile.getBucket(this);if(O&&N instanceof fA){const K=N.centroidVertexArray,ie=M+1;ie<K.length&&(D[0]=K.geta_centroid_pos0(ie),D[1]=K.geta_centroid_pos1(ie))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(f=cV([f],[new xt(0,0),new xt($t,$t)],d.tileID.canonical).map(K=>K.polygon).flat());const W=O?T:null,[Z,te]=function(K,ie,le,he,we,_e,xe,De,Se,Le,We){return K.projection.name==="globe"?function(Ue,Xe,He,nt,Je,it,Mt,At,er,Rt,Ft){const It=[],_r=[],Xt=Ue.projection.upVectorScale(Ft,Ue.center.lat,Ue.worldSize).metersToTile,or=[0,0,0,1],Cr=[0,0,0,1],Gr=(Qr,Wr,tn,gn)=>{Qr[0]=Wr,Qr[1]=tn,Qr[2]=gn,Qr[3]=1},Ir=lV();He>0&&(He+=Ir),nt+=Ir;for(const Qr of Xe){const Wr=[],tn=[];for(const gn of Qr){const Zn=gn.x+Je.x,Mr=gn.y+Je.y,ln=Ue.projection.projectTilePoint(Zn,Mr,Ft),li=Ue.projection.upVector(Ft,gn.x,gn.y);let vi=He,Ai=nt;if(Mt){const Pi=fV(Zn,Mr,He,nt,Mt,At,er,Rt);vi+=Pi.base,Ai+=Pi.top}He!==0?Gr(or,ln.x+li[0]*Xt*vi,ln.y+li[1]*Xt*vi,ln.z+li[2]*Xt*vi):Gr(or,ln.x,ln.y,ln.z),Gr(Cr,ln.x+li[0]*Xt*Ai,ln.y+li[1]*Xt*Ai,ln.z+li[2]*Xt*Ai),ge.vec3.transformMat4(or,or,it),ge.vec3.transformMat4(Cr,Cr,it),Wr.push(new Ag(or[0],or[1],or[2])),tn.push(new Ag(Cr[0],Cr[1],Cr[2]))}It.push(Wr),_r.push(tn)}return[It,_r]}(K,ie,le,he,we,_e,xe,De,Se,Le,We):xe?function(Ue,Xe,He,nt,Je,it,Mt,At,er){const Rt=[],Ft=[],It=[0,0,0,1];for(const _r of Ue){const Xt=[],or=[];for(const Cr of _r){const Gr=Cr.x+nt.x,Ir=Cr.y+nt.y,Qr=fV(Gr,Ir,Xe,He,it,Mt,At,er);It[0]=Gr,It[1]=Ir,It[2]=Qr.base,It[3]=1,ge.vec4.transformMat4(It,It,Je),It[3]=Math.max(It[3],1e-5);const Wr=new Ag(It[0]/It[3],It[1]/It[3],It[2]/It[3]);It[0]=Gr,It[1]=Ir,It[2]=Qr.top,It[3]=1,ge.vec4.transformMat4(It,It,Je),It[3]=Math.max(It[3],1e-5);const tn=new Ag(It[0]/It[3],It[1]/It[3],It[2]/It[3]);Xt.push(Wr),or.push(tn)}Rt.push(Xt),Ft.push(or)}return[Rt,Ft]}(ie,le,he,we,_e,xe,De,Se,Le):function(Ue,Xe,He,nt,Je){const it=[],Mt=[],At=Je[8]*Xe,er=Je[9]*Xe,Rt=Je[10]*Xe,Ft=Je[11]*Xe,It=Je[8]*He,_r=Je[9]*He,Xt=Je[10]*He,or=Je[11]*He;for(const Cr of Ue){const Gr=[],Ir=[];for(const Qr of Cr){const Wr=Qr.x+nt.x,tn=Qr.y+nt.y,gn=Je[0]*Wr+Je[4]*tn+Je[12],Zn=Je[1]*Wr+Je[5]*tn+Je[13],Mr=Je[2]*Wr+Je[6]*tn+Je[14],ln=Je[3]*Wr+Je[7]*tn+Je[15],li=gn+At,vi=Zn+er,Ai=Mr+Rt,Pi=Math.max(ln+Ft,1e-5),Un=gn+It,Ao=Zn+_r,Wa=Mr+Xt,Ki=Math.max(ln+or,1e-5);Gr.push(new Ag(li/Pi,vi/Pi,Ai/Pi)),Ir.push(new Ag(Un/Ki,Ao/Ki,Wa/Ki))}it.push(Gr),Mt.push(Ir)}return[it,Mt]}(ie,le,he,we,_e)}(p,f,P,w,k,v,W,D,R,p.center.lat,d.tileID.canonical),ee=d.queryGeometry;return function(K,ie,le){let he=1/0;pe(le,ie)&&(he=hV(le,ie[0]));for(let we=0;we<ie.length;we++){const _e=ie[we],xe=K[we];for(let De=0;De<_e.length-1;De++){const Se=_e[De],Le=[Se,_e[De+1],xe[De+1],xe[De],Se];ce(le,Le)&&(he=Math.min(he,hV(le,Le)))}}return he!==1/0&&he}(Z,te,ee.isPointQuery()?ee.screenBounds:ee.screenGeometry)}},line:class extends zo{constructor(d,o,c,f){const m=SV();super(d,m,o,c,f),m.layout&&(this.layout=new Wf(m.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(d){if(d==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof uc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(d,o){super.recalculate(d,o),this.paint._values["line-floorwidth"]=(()=>{if(W1)return W1;const c=SV();return W1=new Kue(c.paint.properties["line-width"].specification),W1.useIntegerZoom=!0,W1})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new tL(d)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(d,o,c){const f=bV(this);return{config:new ch(this,{zoom:o,lut:c}),defines:f,overrideFog:!1}}queryRadius(d){const o=d,c=TV(rt("line-width",this,o),rt("line-gap-width",this,o)),f=rt("line-offset",this,o);return c/2+Math.abs(f)+St(this.paint.get("line-translate"))}queryIntersectsFeature(d,o,c,f,m,p){if(d.queryGeometry.isAboveHorizon)return!1;const v=Tt(d.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),T=d.pixelToTileUnitsFactor/2*TV(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),M=this.paint.get("line-offset").evaluate(o,c);return M&&(f=function(k,w){const P=[],D=new xt(0,0);for(let O=0;O<k.length;O++){const R=k[O],N=[];for(let W=0;W<R.length;W++){const Z=R[W],te=R[W+1],ee=W===0?D:Z.sub(R[W-1])._unit()._perp(),K=W===R.length-1?D:te.sub(Z)._unit()._perp(),ie=ee._add(K)._unit();ie._mult(1/(ie.x*K.x+ie.y*K.y)),N.push(ie._mult(w)._add(Z))}P.push(N)}return P}(f,M*d.pixelToTileUnitsFactor)),function(k,w,P){for(let D=0;D<w.length;D++){const O=w[D];if(k.length>=3){for(let R=0;R<O.length;R++)if(Ie(k,O[R]))return!0}if(me(k,O,P))return!0}return!1}(v,f,T)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(d){return!this.hasElevatedBuckets}},symbol:MA,background:class extends zo{constructor(d,o,c,f){super(d,{layout:f8||(f8=new Ei({visibility:new jt(at.layout_background.visibility)})),paint:p8||(p8=new Ei({"background-pitch-alignment":new jt(at.paint_background["background-pitch-alignment"]),"background-color":new jt(at.paint_background["background-color"]),"background-pattern":new jt(at.paint_background["background-pattern"]),"background-opacity":new jt(at.paint_background["background-opacity"]),"background-emissive-strength":new jt(at.paint_background["background-emissive-strength"]),"background-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(d,o,c){return{overrideFog:!1}}is3D(d){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:_8,"raster-particle":E8,sky:class extends zo{constructor(d,o,c,f){super(d,{layout:w8||(w8=new Ei({visibility:new jt(at.layout_sky.visibility)})),paint:S8||(S8=new Ei({"sky-type":new jt(at.paint_sky["sky-type"]),"sky-atmosphere-sun":new jt(at.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new jt(at.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new jt(at.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new jt(at.paint_sky["sky-gradient-radius"]),"sky-gradient":new Gf(at.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new jt(at.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new jt(at.paint_sky["sky-atmosphere-color"]),"sky-opacity":new jt(at.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="sky-gradient"?this._updateColorRamp():d!=="sky-atmosphere-sun"&&d!=="sky-atmosphere-halo-color"&&d!=="sky-atmosphere-color"&&d!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=L1({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(d){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=d.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(d,o){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),m=!f,p=d.style.light,v=p.properties.get("position");return m&&p.properties.get("anchor")==="viewport"&&ai("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?SL(v.azimuthal,90-v.polar,o):SL(f[0],90-f[1],o)}const c=this.paint.get("sky-gradient-center");return SL(c[0],90-c[1],o)}isSky(){return!0}markSkyboxValid(d){this._skyboxInvalidated=!1,this._lightPosition=d.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const d=this.paint.get("sky-type");return d==="atmosphere"?["skyboxCapture","skybox"]:d==="gradient"?["skyboxGradient"]:null}},slot:class extends zo{constructor(d,o,c,f){super(d,{paint:T8||(T8=new Ei({}))},o,null)}},model:class extends zo{constructor(d,o,c,f){super(d,{layout:L8||(L8=new Ei({visibility:new jt(at.layout_model.visibility),"model-id":new Jt(at.layout_model["model-id"])})),paint:N8||(N8=new Ei({"model-opacity":new Jt(at.paint_model["model-opacity"]),"model-rotation":new Jt(at.paint_model["model-rotation"]),"model-scale":new Jt(at.paint_model["model-scale"]),"model-translation":new Jt(at.paint_model["model-translation"]),"model-color":new Jt(at.paint_model["model-color"]),"model-color-mix-intensity":new Jt(at.paint_model["model-color-mix-intensity"]),"model-type":new jt(at.paint_model["model-type"]),"model-cast-shadows":new jt(at.paint_model["model-cast-shadows"]),"model-receive-shadows":new jt(at.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new jt(at.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Jt(at.paint_model["model-emissive-strength"]),"model-roughness":new Jt(at.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Jt(at.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new jt(at.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new jt(at.paint_model["model-front-cutoff"]),"model-color-use-theme":new Jt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new AL(d)}getProgramIds(){return["model"]}is3D(d){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(d){return d instanceof NA?$t-1:0}queryIntersectsFeature(d,o,c,f,m,p){if(!this.modelManager)return!1;const v=this.modelManager,T=d.tile.getBucket(this);if(!(T&&T instanceof AL))return!1;for(const M in T.instancesPerModel){const k=T.instancesPerModel[M],w=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(k.idToFeaturesIndex.hasOwnProperty(w)){const P=k.features[k.idToFeaturesIndex[w]],D=v.getModel(M,this.scope);if(!D)return!1;let O=ge.mat4.create();const R=new bn(0,0),N=T.canonical;let W=Number.MAX_VALUE;for(let Z=0;Z<P.instancedDataCount;++Z){const te=16*(P.instancedDataOffset+Z),ee=k.instancedDataArray.float32,K=[ee[te+4],ee[te+5],ee[te+6]];U8(N,R,ee[te],0|ee[te+1]),z8(O,D,p,R,P.rotation,P.scale,K,!1,!1,!1),p.projection.name==="globe"&&(O=EL(O,p));const ie=ge.mat4.multiply([],p.projMatrix,O),le=d.queryGeometry,he=I8(le.isPointQuery()?le.screenBounds:le.screenGeometry,p,ie,D.aabb);he!=null&&(W=Math.min(he,W))}return W!==Number.MAX_VALUE&&W}}return!1}_handleOverridablePaintPropertyUpdate(d,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven()||d!=="model-color"&&d!=="model-color-mix-intensity"&&d!=="model-rotation"&&d!=="model-scale"&&d!=="model-translation"&&d!=="model-emissive-strength")}_isPropertyZoomDependent(d){const o=this._transitionablePaint._values[d];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof jf}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends zo{constructor(d,o,c,f){super(d,{layout:z6||(z6=new Ei({"clip-layer-types":new jt(at.layout_clip["clip-layer-types"]),"clip-layer-scope":new jt(at.layout_clip["clip-layer-scope"])})),paint:j6||(j6=new Ei({}))},o,c,f)}recalculate(d,o){super.recalculate(d,o)}createBucket(d){return new F6(d)}is3D(d){return!0}}};class Kde{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Jde{constructor(){this.tasks={},this.taskQueue=[],ys(["process"],this),this.invoker=new Kde(this.process),this.nextId=0}add(o,c){const f=this.nextId++,m=function({type:p,isSymbolTile:v,zoom:T}){return T=T||0,p==="message"?0:p!=="maybePrepare"||v?p!=="parseTile"||v?p==="parseTile"&&v?300-T:p==="maybePrepare"&&v?400-T:500:200-T:100-T}(c);if(m===0){try{o()}finally{}return null}return this.tasks[f]={fn:o,metadata:c,priority:m,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const c=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let o=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const p=this.tasks[this.taskQueue[m]];p.priority<c&&(c=p.priority,o=m)}if(o===null)return null;const f=this.taskQueue[o];return this.taskQueue.splice(o,1),f}remove(){this.invoker.remove()}}class V8{constructor(o,c,f){this.target=o,this.parent=c,this.mapId=f,this.callbacks={},this.cancelCallbacks={},ys(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Jde}send(o,c,f,m,p=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=v,this.callbacks[T]=f);const M=new Set;return this.target.postMessage({id:T,type:o,hasCallback:!!f,targetMapId:m,mustQueue:p,sourceMapId:this.mapId,data:ed(c,M)},M),{cancel:()=>{f&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(o){const c=o.data;if(!c)return;const f=c.id;if(f&&(!c.targetMapId||this.mapId===c.targetMapId))if(c.type==="<cancel>"){const m=this.cancelCallbacks[f];delete this.cancelCallbacks[f],m&&m.cancel()}else if(c.mustQueue||cn()){const m=this.callbacks[f],p=this.scheduler.add(()=>this.processTask(f,c),m&&m.metadata||{type:"message"});p&&(this.cancelCallbacks[f]=p)}else this.processTask(f,c)}processTask(o,c){if(delete this.cancelCallbacks[o],c.type==="<response>"){const f=this.callbacks[o];delete this.callbacks[o],f&&(c.error?f(Ts(c.error)):f(null,Ts(c.data)))}else{const f=new Set,m=c.hasCallback?(v,T)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:v?ed(v):null,data:ed(T,f)},f)}:()=>{},p=Ts(c.data);if(this.parent[c.type])this.parent[c.type](c.sourceMapId,p,m);else if(this.parent.getWorkerSource){const v=c.type.split(".");this.parent.getWorkerSource(c.sourceMapId,v[0],p.source,p.scope)[v[1]](p,m)}else m(new Error(`Could not find function ${c.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var nw={workerUrl:"",workerClass:null,workerParams:void 0};const IL="mapboxgl_preloaded_worker_pool";class Pg{constructor(){this.active={}}acquire(o,c=Pg.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<c;)this.workers.push(nw.workerClass!=null?new nw.workerClass:new self.Worker(nw.workerUrl,nw.workerParams));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.workers&&this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[IL]}numActive(){return Object.keys(this.active).length}}Pg.workerCount=2;class u_{constructor(o,c,f="Worker",m=Pg.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=Wo();const p=this.workerPool.acquire(this.id,m);for(let v=0;v<p.length;v++){const T=new u_.Actor(p[v],c,this.id);T.name=`${f} ${v}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,c,f){Bn(this.actors,(m,p)=>{m.send(o,c,p)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let iw,OL;function zA(){return iw||(iw=new Pg),iw}u_.Actor=V8;const kL=new On(0,0,0);var RL=(d=>(d[d.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",d[d.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",d[d.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",d))(RL||{}),jA=(d=>(d[d.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",d[d.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",d[d.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",d[d.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",d))(jA||{}),ow=(d=>(d[d.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",d[d.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",d[d.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",d[d.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",d[d.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",d))(ow||{}),W8=(d=>(d[d.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",d[d.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",d[d.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",d))(W8||{}),d_=(d=>(d[d.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",d[d.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",d[d.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",d[d.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",d[d.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",d[d.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",d))(d_||{}),G8=(d=>(d[d.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",d[d.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",d[d.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",d))(G8||{});function Qde(d,o,c){d===1&&o.icons.push(function(f,m){return function(p){if(p.usvg_tree.height||(p.usvg_tree.height=p.usvg_tree.width),!p.metadata)return p;const{metadata:v}=p;if(v.content_area){const{content_area:T}=v;T.top==null&&(T.top=T.left),T.width==null&&(T.width=p.usvg_tree.width),T.height==null&&(T.height=T.width)}return v.stretch_x&&v.stretch_x.length&&q8(v,"x"),v.stretch_y&&v.stretch_y.length&&q8(v,"y"),p}(f.readFields(ehe,{name:void 0},m))}(c,c.readVarint()+c.pos))}function q8(d,o){const c=[],f=d[`stretch_${o}`];let m=null;for(let p=0;p<f.length;p++)m===null?m=c.length===0?f[0]:c[c.length-1][1]+f[p]:(c.push([m,m+f[p]]),m=null);d[`stretch_${o}_areas`]=c}function ehe(d,o,c){d===1?o.name=c.readString():d===2?o.metadata=function(f,m){return f.readFields(the,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},m)}(c,c.readVarint()+c.pos):d===3&&(o.usvg_tree=function(f,m){return f.readFields(ihe,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},m)}(c,c.readVarint()+c.pos),o.data="usvg_tree")}function the(d,o,c){d===1?o.stretch_x=c.readPackedVarint():d===2?o.stretch_y=c.readPackedVarint():d===3?o.content_area=function(f,m){return f.readFields(rhe,{left:0},m)}(c,c.readVarint()+c.pos):d===4&&o.variables.push(function(f,m){return f.readFields(nhe,{name:void 0},m)}(c,c.readVarint()+c.pos))}function rhe(d,o,c){d===1?o.left=c.readVarint():d===2?o.width=c.readVarint():d===3?o.top=c.readVarint():d===4&&(o.height=c.readVarint())}function nhe(d,o,c){d===1?o.name=c.readString():d===2&&(o.rgb_color=$A(c.readVarint()),o.value="rgb_color")}function ihe(d,o,c){d===1?o.width=o.height=c.readVarint():d===2?o.height=c.readVarint():d===3?o.children.push(FA(c,c.readVarint()+c.pos)):d===4?o.linear_gradients.push(function(f,m){return f.readFields(dhe,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},m)}(c,c.readVarint()+c.pos)):d===5?o.radial_gradients.push(function(f,m){return f.readFields(fhe,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},m)}(c,c.readVarint()+c.pos)):d===7?o.clip_paths.push(function(f,m){return f.readFields(phe,{children:[]},m)}(c,c.readVarint()+c.pos)):d===8&&o.masks.push(function(f,m){const p=f.readFields(mhe,{left:0,width:20,mask_type:1,children:[]},m);return p.height==null&&(p.height=p.width),p.top==null&&(p.top=p.left),p}(c,c.readVarint()+c.pos))}function FA(d,o){return d.readFields(ohe,{},o)}function ohe(d,o,c){d===1?(o.group=function(f,m){return f.readFields(ahe,{opacity:255,children:[]},m)}(c,c.readVarint()+c.pos),o.node="group"):d===2&&(o.path=function(f,m){return f.readFields(lhe,{paint_order:1,commands:[],step:1,diffs:[],rule:1},m)}(c,c.readVarint()+c.pos),o.node="path")}function ahe(d,o,c){d===1?o.transform=BA(c,c.readVarint()+c.pos):d===2?o.opacity=c.readVarint():d===5?o.clip_path_idx=c.readVarint():d===6?o.mask_idx=c.readVarint():d===7&&o.children.push(FA(c,c.readVarint()+c.pos))}function BA(d,o){return d.readFields(she,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function she(d,o,c){d===1?o.sx=c.readFloat():d===2?o.ky=c.readFloat():d===3?o.kx=c.readFloat():d===4?o.sy=c.readFloat():d===5?o.tx=c.readFloat():d===6&&(o.ty=c.readFloat())}function lhe(d,o,c){d===1?o.fill=function(f,m){return f.readFields(che,{rgb_color:kL,paint:"rgb_color",opacity:255},m)}(c,c.readVarint()+c.pos):d===2?o.stroke=function(f,m){return f.readFields(uhe,{rgb_color:kL,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},m)}(c,c.readVarint()+c.pos):d===3?o.paint_order=c.readVarint():d===5?c.readPackedVarint(o.commands):d===6?o.step=c.readFloat():d===7?c.readPackedSVarint(o.diffs):d===8&&(o.rule=c.readVarint())}function che(d,o,c){d===1?(o.rgb_color=$A(c.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=c.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=c.readVarint(),o.paint="radial_gradient_idx"):d===5&&(o.opacity=c.readVarint())}function $A(d){return new On((d>>16&255)/255,(d>>8&255)/255,(255&d)/255,1)}function uhe(d,o,c){d===1?(o.rgb_color=$A(c.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=c.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=c.readVarint(),o.paint="radial_gradient_idx"):d===5?c.readPackedFloat(o.dasharray):d===6?o.dashoffset=c.readFloat():d===7?o.miterlimit=c.readFloat():d===8?o.opacity=c.readVarint():d===9?o.width=c.readFloat():d===10?o.linecap=c.readVarint():d===11&&(o.linejoin=c.readVarint())}function dhe(d,o,c){d===1?o.transform=BA(c,c.readVarint()+c.pos):d===2?o.spread_method=c.readVarint():d===3?o.stops.push(H8(c,c.readVarint()+c.pos)):d===4?o.x1=c.readFloat():d===5?o.y1=c.readFloat():d===6?o.x2=c.readFloat():d===7&&(o.y2=c.readFloat())}function H8(d,o){return d.readFields(hhe,{offset:0,opacity:255,rgb_color:kL},o)}function hhe(d,o,c){d===1?o.offset=c.readFloat():d===2?o.opacity=c.readVarint():d===3&&(o.rgb_color=$A(c.readVarint()))}function fhe(d,o,c){d===1?o.transform=BA(c,c.readVarint()+c.pos):d===2?o.spread_method=c.readVarint():d===3?o.stops.push(H8(c,c.readVarint()+c.pos)):d===4?o.cx=c.readFloat():d===5?o.cy=c.readFloat():d===6?o.r=c.readFloat():d===7?o.fx=c.readFloat():d===8?o.fy=c.readFloat():d===9&&(o.fr=c.readFloat())}function phe(d,o,c){d===1?o.transform=BA(c,c.readVarint()+c.pos):d===2?o.clip_path_idx=c.readVarint():d===3&&o.children.push(FA(c,c.readVarint()+c.pos))}function mhe(d,o,c){d===1?o.left=o.top=c.readFloat():d===2?o.width=o.height=c.readFloat():d===3?o.top=c.readFloat():d===4?o.height=c.readFloat():d===5?o.mask_type=c.readVarint():d===6?o.mask_idx=c.readVarint():d===7&&o.children.push(FA(c,c.readVarint()+c.pos))}class ghe{static calculate(o={},c=[]){const f=new Map,m=new Map;if(Object.keys(o).length===0)return f;c.forEach(p=>{m.set(p.name,p.rgb_color||new On(0,0,0))});for(const[p,v]of Object.entries(o))m.has(p)?f.set(m.get(p).toStringPremultipliedAlpha(),v):console.warn(`Ignoring unknown image variable "${p}"`);return f}}function h_(d,o=255,c){const f=o/255,m=d.toStringPremultipliedAlpha(),p=c.has(m)?c.get(m).clone():d.clone();return p.a*=f,p.toString()}function aw(d,o){if(!_t()){const c=document.createElement("canvas");return c.width=d,c.height=o,c}return new OffscreenCanvas(d,o)}function yhe(d,o){const c=ghe.calculate(o.params,d.metadata?d.metadata.variables:[]),f=d.usvg_tree,m=f.width,p=f.height,v=o.transform?o.transform:new DOMMatrix,T=Math.max(1,Math.round(m*v.a)),M=Math.max(1,Math.round(p*v.d)),k=new DOMMatrix([T/m,0,0,M/p,0,0]),w=aw(T,M).getContext("2d");return DL(w,k,f,f,c),w.getImageData(0,0,T,M)}function DL(d,o,c,f,m){for(const p of f.children)Z8(d,o,c,p,m)}function Z8(d,o,c,f,m){f.group?(d.save(),function(p,v,T,M,k){const w=M.mask_idx!=null?T.masks[M.mask_idx]:null,P=M.clip_path_idx!=null?T.clip_paths[M.clip_path_idx]:null;if(M.transform&&(v=UA(M.transform).preMultiplySelf(v)),!function(R,N,W){return R.opacity!==255||N||W}(M,P!=null,w!=null))return void DL(p,v,T,M,k);const D=aw(p.canvas.width,p.canvas.height),O=D.getContext("2d");DL(O,v,T,M,k),P&&tW(O,v,T,P),w&&rW(O,v,T,w,k),p.globalAlpha=M.opacity/255,p.drawImage(D,0,0)}(d,o,c,f.group,m),d.restore()):f.path&&(d.save(),function(p,v,T,M,k){const w=nW(M);p.setTransform(v),M.paint_order===W8.PAINT_ORDER_FILL_AND_STROKE?(X8(p,T,M,w,k),K8(p,T,M,w,k)):(K8(p,T,M,w,k),X8(p,T,M,w,k))}(d,o,c,f.path,m),d.restore())}function X8(d,o,c,f,m){const p=c.fill;if(!p)return;const v=p.opacity/255;switch(p.paint){case"rgb_color":d.fillStyle=h_(p.rgb_color,p.opacity,m);break;case"linear_gradient_idx":d.fillStyle=J8(d,o.linear_gradients[p.linear_gradient_idx],v,m);break;case"radial_gradient_idx":d.fillStyle=Q8(d,o.radial_gradients[p.radial_gradient_idx],v,m)}d.fill(f,Y8(c))}function Y8(d){return d.rule===RL.PATH_RULE_NON_ZERO?"nonzero":d.rule===RL.PATH_RULE_EVEN_ODD?"evenodd":void 0}function K8(d,o,c,f,m){const p=c.stroke;if(!p)return;d.lineWidth=p.width,d.miterLimit=p.miterlimit,d.setLineDash(p.dasharray),d.lineDashOffset=p.dashoffset;const v=p.opacity/255;switch(p.paint){case"rgb_color":d.strokeStyle=h_(p.rgb_color,p.opacity,m);break;case"linear_gradient_idx":d.strokeStyle=J8(d,o.linear_gradients[p.linear_gradient_idx],v,m);break;case"radial_gradient_idx":d.strokeStyle=Q8(d,o.radial_gradients[p.radial_gradient_idx],v,m)}switch(p.linejoin){case ow.LINE_JOIN_MITER_CLIP:case ow.LINE_JOIN_MITER:d.lineJoin="miter";break;case ow.LINE_JOIN_ROUND:d.lineJoin="round";break;case ow.LINE_JOIN_BEVEL:d.lineJoin="bevel"}switch(p.linecap){case jA.LINE_CAP_BUTT:d.lineCap="butt";break;case jA.LINE_CAP_ROUND:d.lineCap="round";break;case jA.LINE_CAP_SQUARE:d.lineCap="square"}d.stroke(f)}function J8(d,o,c,f){if(o.stops.length===1){const D=o.stops[0];return h_(D.rgb_color,D.opacity*c,f)}const m=UA(o.transform),{x1:p,y1:v,x2:T,y2:M}=o,k=m.transformPoint(new DOMPoint(p,v)),w=m.transformPoint(new DOMPoint(T,M)),P=d.createLinearGradient(k.x,k.y,w.x,w.y);for(const D of o.stops)P.addColorStop(D.offset,h_(D.rgb_color,D.opacity*c,f));return P}function Q8(d,o,c,f){if(o.stops.length===1){const D=o.stops[0];return h_(D.rgb_color,D.opacity*c,f)}const m=UA(o.transform),{fx:p,fy:v,cx:T,cy:M}=o,k=m.transformPoint(new DOMPoint(p,v)),w=m.transformPoint(new DOMPoint(T,M)),P=d.createRadialGradient(k.x,k.y,0,w.x,w.y,o.r*((m.a+m.d)/2));for(const D of o.stops)P.addColorStop(D.offset,h_(D.rgb_color,D.opacity*c,f));return P}function eW(d,o,c,f){const m=f.transform?UA(f.transform).preMultiplySelf(o):o,p=aw(d.canvas.width,d.canvas.height),v=p.getContext("2d");for(const M of f.children)if(M.group)eW(v,m,c,M.group);else if(M.path){const k=M.path,w=new Path2D;w.addPath(nW(k),m),v.fill(w,Y8(k))}const T=f.clip_path_idx!=null?c.clip_paths[f.clip_path_idx]:null;T&&tW(v,m,c,T),d.globalCompositeOperation="source-over",d.drawImage(p,0,0)}function tW(d,o,c,f){const m=aw(d.canvas.width,d.canvas.height);eW(m.getContext("2d"),o,c,f),d.globalCompositeOperation="destination-in",d.drawImage(m,0,0)}function rW(d,o,c,f,m){if(f.children.length===0)return;const p=f.mask_idx!=null?c.masks[f.mask_idx]:null;p&&rW(d,o,c,p,m);const v=d.canvas.width,T=d.canvas.height,M=aw(v,T),k=M.getContext("2d"),w=f.width,P=f.height,D=f.left,O=f.top,R=new Path2D,N=new Path2D;N.rect(D,O,w,P),R.addPath(N,o),k.clip(R);for(const te of f.children)Z8(k,o,c,te,m);const W=k.getImageData(0,0,v,T),Z=W.data;if(f.mask_type===G8.MASK_TYPE_LUMINANCE)for(let te=0;te<Z.length;te+=4)Z[te+3]=Z[te+3]/255*(.2126*Z[te]+.7152*Z[te+1]+.0722*Z[te+2]);k.putImageData(W,0,0),d.globalCompositeOperation="destination-in",d.drawImage(M,0,0)}function UA(d){return d?new DOMMatrix([d.sx,d.ky,d.kx,d.sy,d.tx,d.ty]):new DOMMatrix}function nW(d){const o=new Path2D,c=d.step;let f=d.diffs[0]*c,m=d.diffs[1]*c;o.moveTo(f,m);for(let p=0,v=2;p<d.commands.length;p++)switch(d.commands[p]){case d_.PATH_COMMAND_MOVE:f+=d.diffs[v++]*c,m+=d.diffs[v++]*c,o.moveTo(f,m);break;case d_.PATH_COMMAND_LINE:f+=d.diffs[v++]*c,m+=d.diffs[v++]*c,o.lineTo(f,m);break;case d_.PATH_COMMAND_QUAD:{const T=f+d.diffs[v++]*c,M=m+d.diffs[v++]*c;f=T+d.diffs[v++]*c,m=M+d.diffs[v++]*c,o.quadraticCurveTo(T,M,f,m);break}case d_.PATH_COMMAND_CUBIC:{const T=f+d.diffs[v++]*c,M=m+d.diffs[v++]*c,k=T+d.diffs[v++]*c,w=M+d.diffs[v++]*c;f=k+d.diffs[v++]*c,m=w+d.diffs[v++]*c,o.bezierCurveTo(T,M,k,w,f,m);break}case d_.PATH_COMMAND_CLOSE:o.closePath()}return o}class VA{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const c=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,c),c}put(o,c){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,c)}delete(o){this.cache.delete(o)}}Qt(VA,"LRUCache");class LL{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new ra(o,o.data)}getFromCache(o,c,f){return this.cacheMap.has(f)||this.cacheMap.set(f,new VA(150)),this.cacheMap.get(f).get(Hf(o.toString(),c))}setInCache(o,c,f,m){this.cacheDependenciesMap.has(m)||this.cacheDependenciesMap.set(m,new Map),this.cacheMap.has(m)||this.cacheMap.set(m,new VA(150));const p=this.cacheDependenciesMap.get(m),v=Hf(o.id.toString(),f);p.get(v)||p.set(v,new Set);const T=this.cacheMap.get(m),M=o.toString();p.get(v).add(M),T.put(Hf(o.toString(),f),c)}removeImagesFromCacheByIds(o,c,f=0){if(!this.cacheMap.has(f)||!this.cacheDependenciesMap.has(f))return;const m=this.cacheMap.get(f),p=this.cacheDependenciesMap.get(f);for(const v of o){const T=Hf(v.toString(),c);if(p.has(T)){for(const M of p.get(T))m.delete(M);p.delete(T)}}}rasterize(o,c,f,m,p=yhe){const v=this.getFromCache(o,f,m);if(v)return v.clone();const T=p(c.icon,o.options),M=LL._getImage(T);return this.setInCache(o,M,f,m),M.clone()}}class iW{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,c){const f=this.toIdx(o,c);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(o,c){return this.leaves[this.toIdx(o,c)]}toIdx(o,c){return c*this.size+o}}function oW(d,o,c,f){let m=0,p=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(f[v])<1e-15){if(c[v]<d[v]||c[v]>o[v])return null}else{const T=1/f[v];let M=(d[v]-c[v])*T,k=(o[v]-c[v])*T;if(M>k){const w=M;M=k,k=w}if(M>m&&(m=M),k<p&&(p=k),m>p)return null}return m}function aW(d,o,c,f,m,p,v,T,M,k,w){const P=f-d,D=m-o,O=p-c,R=v-d,N=T-o,W=M-c,Z=w[1]*W-w[2]*N,te=w[2]*R-w[0]*W,ee=w[0]*N-w[1]*R,K=P*Z+D*te+O*ee;if(Math.abs(K)<1e-15)return null;const ie=1/K,le=k[0]-d,he=k[1]-o,we=k[2]-c,_e=(le*Z+he*te+we*ee)*ie;if(_e<0||_e>1)return null;const xe=he*O-we*D,De=we*P-le*O,Se=le*D-he*P,Le=(w[0]*xe+w[1]*De+w[2]*Se)*ie;return Le<0||_e+Le>1?null:(R*xe+N*De+W*Se)*ie}function sW(d,o,c){return(d-o)/(c-o)}function lW(d,o,c,f,m,p,v,T,M){const k=1<<c,w=p-f,P=v-m,D=(d+1)/k*w+f,O=(o+0)/k*P+m,R=(o+1)/k*P+m;T[0]=(d+0)/k*w+f,T[1]=O,M[0]=D,M[1]=R}class cW{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(p){const v=Math.ceil(Math.log2(p.dim/8)),T=[];let M=Math.ceil(Math.pow(2,v));const k=1/M,w=(O,R,N,W,Z)=>{const te=W?1:0,ee=(O+1)*N-te,K=R*N,ie=(R+1)*N-te;Z[0]=O*N,Z[1]=K,Z[2]=ee,Z[3]=ie};let P=new iW(M);const D=[];for(let O=0;O<M*M;O++){w(O%M,Math.floor(O/M),k,!1,D);const R=lp(D[0],D[1],p),N=lp(D[2],D[1],p),W=lp(D[2],D[3],p),Z=lp(D[0],D[3],p);P.minimums.push(Math.min(R,N,W,Z)),P.maximums.push(Math.max(R,N,W,Z)),P.leaves.push(1)}for(T.push(P),M/=2;M>=1;M/=2){const O=T[T.length-1];P=new iW(M);for(let R=0;R<M*M;R++){w(R%M,Math.floor(R/M),2,!0,D);const N=O.getElevation(D[0],D[1]),W=O.getElevation(D[2],D[1]),Z=O.getElevation(D[2],D[3]),te=O.getElevation(D[0],D[3]),ee=O.isLeaf(D[0],D[1]),K=O.isLeaf(D[2],D[1]),ie=O.isLeaf(D[2],D[3]),le=O.isLeaf(D[0],D[3]),he=Math.min(N.min,W.min,Z.min,te.min),we=Math.max(N.max,W.max,Z.max,te.max),_e=ee&&K&&ie&&le;P.maximums.push(we),P.minimums.push(he),P.leaves.push(we-he<=5&&_e?1:0)}T.push(P)}return T}(this.dem),f=c.length-1,m=c[f];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,f,0)}raycastRoot(o,c,f,m,p,v,T=1){return oW([o,c,-100],[f,m,this.maximums[0]*T],p,v)}raycast(o,c,f,m,p,v,T=1){if(!this.nodeCount)return null;const M=this.raycastRoot(o,c,f,m,p,v,T);if(M==null)return null;const k=[],w=[],P=[],D=[],O=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;O.length>0;){const{idx:R,t:N,nodex:W,nodey:Z,depth:te}=O.pop();if(this.leaves[R]){lW(W,Z,te,o,c,f,m,P,D);const K=1<<te,ie=(W+0)/K,le=(W+1)/K,he=(Z+0)/K,we=(Z+1)/K,_e=lp(ie,he,this.dem)*T,xe=lp(le,he,this.dem)*T,De=lp(le,we,this.dem)*T,Se=lp(ie,we,this.dem)*T,Le=aW(P[0],P[1],_e,D[0],P[1],xe,D[0],D[1],De,p,v),We=aW(D[0],D[1],De,P[0],D[1],Se,P[0],P[1],_e,p,v),Ue=Math.min(Le!==null?Le:Number.MAX_VALUE,We!==null?We:Number.MAX_VALUE);if(Ue!==Number.MAX_VALUE)return Ue;{const Xe=ge.vec3.scaleAndAdd([],p,v,N);if(uW(_e,xe,Se,De,sW(Xe[0],P[0],D[0]),sW(Xe[1],P[1],D[1]))>=Xe[2])return N}continue}let ee=0;for(let K=0;K<this._siblingOffset.length;K++){lW((W<<1)+this._siblingOffset[K][0],(Z<<1)+this._siblingOffset[K][1],te+1,o,c,f,m,P,D),P[2]=-100,D[2]=this.maximums[this.childOffsets[R]+K]*T;const ie=oW(P,D,p,v);if(ie!=null){const le=ie;k[K]=le;let he=!1;for(let we=0;we<ee&&!he;we++)le>=k[w[we]]&&(w.splice(we,0,K),he=!0);he||(w[ee]=K),ee++}}for(let K=0;K<ee;K++){const ie=w[K];O.push({idx:this.childOffsets[R]+ie,t:k[ie],nodex:(W<<1)+this._siblingOffset[ie][0],nodey:(Z<<1)+this._siblingOffset[ie][1],depth:te+1})}}return null}_addNode(o,c,f){return this.minimums.push(o),this.maximums.push(c),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(o,c,f,m,p){if(o[m].isLeaf(c,f)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const v=m-1,T=o[v];let M=0,k=0;for(let w=0;w<this._siblingOffset.length;w++){const P=2*c+this._siblingOffset[w][0],D=2*f+this._siblingOffset[w][1],O=T.getElevation(P,D),R=T.isLeaf(P,D),N=this._addNode(O.min,O.max,R);R&&(M|=1<<w),k||(k=N)}for(let w=0;w<this._siblingOffset.length;w++)M&1<<w||this._construct(o,2*c+this._siblingOffset[w][0],2*f+this._siblingOffset[w][1],v,k+w)}}function uW(d,o,c,f,m,p){return br(br(d,c,p),br(o,f,p),m)}function lp(d,o,c){const f=c.dim,m=Yt(d*f-.5,0,f-1),p=Yt(o*f-.5,0,f-1),v=Math.floor(m),T=Math.floor(p),M=Math.min(v+1,f-1),k=Math.min(T+1,f-1);return uW(c.get(v,T),c.get(M,T),c.get(v,k),c.get(M,k),m-v,p-T)}const vhe={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function _he(d,o,c){return(256*d*256+256*o+c)/10-1e4}function xhe(d,o,c){return 256*d+o+c/256-32768}class WA{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,c,f,m=!1){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void ai(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const p=this.dim=c.height-2,v=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.floatView=new Float32Array(c.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let M=0;M<p;M++)v[this._idx(-1,M)]=v[this._idx(0,M)],v[this._idx(p,M)]=v[this._idx(p-1,M)],v[this._idx(M,-1)]=v[this._idx(M,0)],v[this._idx(M,p)]=v[this._idx(M,p-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(p,-1)]=v[this._idx(p-1,0)],v[this._idx(-1,p)]=v[this._idx(0,p-1)],v[this._idx(p,p)]=v[this._idx(p-1,p-1)]}const T=f==="terrarium"?xhe:_he;for(let M=0;M<v.length;++M){const k=4*M;this.floatView[M]=T(this.pixels[k],this.pixels[k+1],this.pixels[k+2])}this._timestamp=gt.now()}_buildQuadTree(){this._tree=new cW(this)}get(o,c,f=!1){f&&(o=Yt(o,-1,this.dim),c=Yt(c,-1,this.dim));const m=this._idx(o,c);return this.floatView[m]}set(o,c,f){const m=this._idx(o,c),p=this.floatView[m];return this.floatView[m]=f,f-p}static getUnpackVector(o){return vhe[o]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}static pack(o,c){const f=[0,0,0,0],m=WA.getUnpackVector(c);let p=Math.floor((o+m[3])/m[2]);return f[2]=p%256,p=Math.floor(p/256),f[1]=p%256,p=Math.floor(p/256),f[0]=p,f}getPixels(){return new _6({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,c,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,p=c*this.dim+this.dim,v=f*this.dim,T=f*this.dim+this.dim;switch(c){case-1:m=p-1;break;case 1:p=m+1}switch(f){case-1:v=T-1;break;case 1:T=v+1}const M=-c*this.dim,k=-f*this.dim;for(let w=v;w<T;w++)for(let P=m;P<p;P++){const D=4*this._idx(P,w),O=4*this._idx(P+M,w+k);this.pixels[D+0]=o.pixels[O+0],this.pixels[D+1]=o.pixels[O+1],this.pixels[D+2]=o.pixels[O+2],this.pixels[D+3]=o.pixels[O+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function bhe(d,o,c){d===1?o.headerLength=c.readFixed32():d===2?o.x=c.readVarint():d===3?o.y=c.readVarint():d===4?o.z=c.readVarint():d===5&&o.layers.push(function(f,m){return f.readFields(Ahe,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(c,c.readVarint()+c.pos))}function whe(d,o,c){d===1?(o.delta_filter=function(f,m){return f.readFields(She,{blockSize:0},m)}(c,c.readVarint()+c.pos),o.filter="delta_filter"):d===2?(c.readVarint(),o.filter="zigzag_filter"):d===3?(c.readVarint(),o.filter="bitshuffle_filter"):d===4&&(c.readVarint(),o.filter="byteshuffle_filter")}function She(d,o,c){d===1&&(o.blockSize=c.readVarint())}function The(d,o,c){d===1?(c.readVarint(),o.codec="gzip_data"):d===2?(c.readVarint(),o.codec="jpeg_image"):d===3?(c.readVarint(),o.codec="webp_image"):d===4&&(c.readVarint(),o.codec="png_image")}function Ehe(d,o,c){let f=0,m=0;d===1?o.firstByte=c.readFixed64():d===2?o.lastByte=c.readFixed64():d===3?o.filters.push(function(p,v){return p.readFields(whe,{},v)}(c,c.readVarint()+c.pos)):d===4?o.codec=function(p,v){return p.readFields(The,{},v)}(c,c.readVarint()+c.pos):d===5?m=c.readFloat():d===6?f=c.readFloat():d===7?o.bands.push(c.readString()):d===8?o.offset=c.readDouble():d===9&&(o.scale=c.readDouble()),o.offset===0&&(o.offset=m),o.scale===0&&(o.scale=f)}function Ahe(d,o,c){d===1?o.version=c.readVarint():d===2?o.name=c.readString():d===3?o.units=c.readString():d===4?o.tileSize=c.readVarint():d===5?o.buffer=c.readVarint():d===6?o.pixelFormat=c.readVarint():d===7&&o.dataIndex.push(function(f,m){return f.readFields(Ehe,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(c,c.readVarint()+c.pos))}function Che(d,o,c){if(d===2)(function(f,m,p){f.readFields(Mhe,p,m)})(c,c.readVarint()+c.pos,o);else if(d===3)throw new Error("Not implemented")}function Mhe(d,o,c){if(d===1){let f=0;const m=c.readVarint()+c.pos;for(;c.pos<m;)o[f++]=c.readVarint()}}function Phe(d,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let c=o[3];for(let f=2;f>=1;f--){const m=f===1?1:0,p=f===2?1:0;for(let v=0;v<o[0];v++){const T=o[1]*v;for(let M=m;M<o[1];M++){const k=o[2]*(M+T);for(let w=p;w<o[2];w++){const P=o[3]*(w+k);for(let D=0;D<o[3];D++){const O=P+D;d[O]+=d[O-c]}}}}c*=o[f]}return d}function Ihe(d){for(let o=0,c=d.length;o<c;o++)d[o]=d[o]>>>1^-(1&d[o]);return d}function Ohe(d,o){switch(o){case"uint32":return d;case"uint16":for(let c=0;c<d.length;c+=2){const f=d[c],m=d[c+1];d[c]=(240&f)>>4|(61440&f)>>8|(240&m)<<4|61440&m,d[c+1]=15&f|(3840&f)>>4|(15&m)<<8|(3840&m)<<4}return d;case"uint8":for(let c=0;c<d.length;c+=4){const f=d[c],m=d[c+1],p=d[c+2],v=d[c+3];d[c+0]=(192&f)>>6|(192&m)>>4|(192&p)>>2|192&v,d[c+1]=(48&f)>>4|(48&m)>>2|48&p|(48&v)<<2,d[c+2]=(12&f)>>2|12&m|(12&p)<<2|(12&v)<<4,d[c+3]=3&f|(3&m)<<2|(3&p)<<4|(3&v)<<6}return d;default:throw new Error(`Invalid pixel format, "${o}"`)}}Qt(WA,"DEMData"),Qt(cW,"DemMinMaxQuadTree",{omit:["dem"]});var Nl=Uint8Array,sw=Uint16Array,khe=Int32Array,dW=new Nl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hW=new Nl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rhe=new Nl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),fW=function(d,o){for(var c=new sw(31),f=0;f<31;++f)c[f]=o+=1<<d[f-1];var m=new khe(c[30]);for(f=1;f<30;++f)for(var p=c[f];p<c[f+1];++p)m[p]=p-c[f]<<5|f;return{b:c,r:m}},pW=fW(dW,2),mW=pW.b,Dhe=pW.r;mW[28]=258,Dhe[258]=28;for(var Lhe=fW(hW,0).b,gW=new sw(32768),lo=0;lo<32768;++lo){var f_=(43690&lo)>>1|(21845&lo)<<1;gW[lo]=((65280&(f_=(61680&(f_=(52428&f_)>>2|(13107&f_)<<2))>>4|(3855&f_)<<4))>>8|(255&f_)<<8)>>1}var lw=function(d,o,c){for(var f=d.length,m=0,p=new sw(o);m<f;++m)d[m]&&++p[d[m]-1];var v,T=new sw(o);for(m=1;m<o;++m)T[m]=T[m-1]+p[m-1]<<1;v=new sw(1<<o);var M=15-o;for(m=0;m<f;++m)if(d[m])for(var k=m<<4|d[m],w=o-d[m],P=T[d[m]-1]++<<w,D=P|(1<<w)-1;P<=D;++P)v[gW[P]>>M]=k;return v},cw=new Nl(288);for(lo=0;lo<144;++lo)cw[lo]=8;for(lo=144;lo<256;++lo)cw[lo]=9;for(lo=256;lo<280;++lo)cw[lo]=7;for(lo=280;lo<288;++lo)cw[lo]=8;var yW=new Nl(32);for(lo=0;lo<32;++lo)yW[lo]=5;var Nhe=lw(cw,9),zhe=lw(yW,5),NL=function(d){for(var o=d[0],c=1;c<d.length;++c)d[c]>o&&(o=d[c]);return o},su=function(d,o,c){var f=o/8|0;return(d[f]|d[f+1]<<8)>>(7&o)&c},zL=function(d,o){var c=o/8|0;return(d[c]|d[c+1]<<8|d[c+2]<<16)>>(7&o)},jhe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],lu=function(d,o,c){var f=new Error(o||jhe[d]);if(f.code=d,Error.captureStackTrace&&Error.captureStackTrace(f,lu),!c)throw f;return f},Fhe=new Nl(0),Bhe=typeof TextDecoder<"u"&&new TextDecoder;try{Bhe.decode(Fhe,{stream:!0})}catch{}const $he={gzip_data:"gzip"};class gc extends Error{constructor(o){super(o),this.name="MRTError"}}const Uhe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},vW={uint32:1,uint16:2,uint8:4},Vhe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let jL;class GA{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const c=this.layers[o];if(!c)throw new gc(`Layer '${o}' not found`);return c}getHeaderLength(o){const c=new Uint8Array(o),f=new DataView(o);if(c[0]!==13)throw new gc("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(o){const c=new Uint8Array(o),f=this.getHeaderLength(o);if(c.length<f)throw new gc(`Expected header with length >= ${f} but got buffer of length ${c.length}`);const m=function(p,v){return p.readFields(bhe,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new jL(c.subarray(0,f)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new gc(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const p of m.layers)this.layers[p.name]=new _W(p,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const c=[],f=this.getLayer(o.layerName);for(let m of o.blockIndices){const p=f.dataIndex[m],v=p.firstByte-o.firstByte,T=p.lastByte-o.firstByte;if(f._blocksInProgress.has(m))continue;const M={layerName:f.name,firstByte:v,lastByte:T,pixelFormat:f.pixelFormat,blockIndex:m,blockShape:[p.bands.length].concat(f.bandShape),buffer:f.buffer,codec:p.codec.codec,filters:p.filters.map(k=>k.filter)};f._blocksInProgress.add(m),c.push(M)}return new xW(c,()=>{c.forEach(m=>f._blocksInProgress.delete(m.blockIndex))},(m,p)=>{if(c.forEach(v=>f._blocksInProgress.delete(v.blockIndex)),m)throw m;p.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class _W{constructor({version:o,name:c,units:f,tileSize:m,pixelFormat:p,buffer:v,dataIndex:T},M){if(this.version=o,this.version!==1)throw new gc(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=c,this.units=f,this.tileSize=m,this.buffer=v,this.pixelFormat=Uhe[p],this.dataIndex=T,this.bandShape=[m+2*v,m+2*v,vW[this.pixelFormat]],this._decodedBlocks=new VA(M?M.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return vW[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const c=o.blockIndex.toString();this._decodedBlocks.get(c)||this._decodedBlocks.put(c,o.data)}getBlockForBand(o){let c=0;switch(typeof o){case"string":for(const[f,m]of this.dataIndex.entries()){for(const[p,v]of m.bands.entries())if(v===o)return{bandIndex:c+p,blockIndex:f,blockBandIndex:p};c+=m.bands.length}break;case"number":for(const[f,m]of this.dataIndex.entries()){if(o>=c&&o<c+m.bands.length)return{bandIndex:o,blockIndex:f,blockBandIndex:o-c};c+=m.bands.length}break;default:throw new gc(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}throw new gc(`Band not found: ${JSON.stringify(o)}`)}getDataRange(o){let c=1/0,f=-1/0;const m=[],p=new Set;for(const v of o){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new gc(`Invalid band: ${JSON.stringify(v)}`);const M=this.dataIndex[T];m.includes(T)||m.push(T),p.add(T),c=Math.min(c,M.firstByte),f=Math.max(f,M.lastByte)}if(p.size>this.cacheSize)throw new gc(`Number of blocks to decode (${p.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:c,lastByte:f,blockIndices:m}}hasBand(o){const{blockIndex:c}=this.getBlockForBand(o);return c>=0}hasDataForBand(o){const{blockIndex:c}=this.getBlockForBand(o);return c>=0&&!!this._decodedBlocks.get(c.toString())}getBandView(o){const{blockIndex:c,blockBandIndex:f}=this.getBlockForBand(o),m=this._decodedBlocks.get(c.toString());if(!m)throw new gc(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const p=this.dataIndex[c],v=this.bandShape.reduce((k,w)=>k*w,1),T=f*v,M=m.subarray(T,T+v);return{data:M,bytes:new Uint8Array(M.buffer).subarray(M.byteOffset,M.byteOffset+M.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:p.offset,scale:p.scale}}}GA.setPbf=function(d){jL=d};class xW{constructor(o,c,f){this.tasks=o,this._onCancel=c,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,c){this._finalized||(this._onComplete(o,c),this._finalized=!0)}}GA.performDecoding=function(d,o){const c=new Uint8Array(d);return Promise.all(o.tasks.map(f=>{const{layerName:m,firstByte:p,lastByte:v,pixelFormat:T,blockShape:M,blockIndex:k,filters:w,codec:P}=f,D=c.subarray(p,v+1),O=new Uint32Array(M[0]*M[1]*M[2]);let R;if(P!=="gzip_data")throw new gc(`Unhandled codec: ${P}`);return R=function(N,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((K=function(he){he[0]==31&&he[1]==139&&he[2]==8||lu(6,"invalid gzip data");var we=he[3],_e=10;4&we&&(_e+=2+(he[10]|he[11]<<8));for(var xe=(we>>3&1)+(we>>4&1);xe>0;xe-=!he[_e++]);return _e+(2&we)}(ee=N))+8>ee.length&&lu(6,"invalid gzip data"),function(he,we,_e,xe){var De=he.length;if(!De||we.f&&!we.l)return _e||new Nl(0);var Se=!_e,Le=Se||we.i!=2,We=we.i;Se&&(_e=new Nl(3*De));var Ue,Xe,He=function(up){var dp=_e.length;if(up>dp){var Og=new Nl(Math.max(2*dp,up));Og.set(_e),_e=Og}},nt=we.f||0,Je=we.p||0,it=we.b||0,Mt=we.l,At=we.d,er=we.m,Rt=we.n,Ft=8*De;do{if(!Mt){nt=su(he,Je,1);var It=su(he,Je+1,3);if(Je+=3,!It){var _r=he[(Mr=4+((Je+7)/8|0))-4]|he[Mr-3]<<8,Xt=Mr+_r;if(Xt>De){We&&lu(0);break}Le&&He(it+_r),_e.set(he.subarray(Mr,Xt),it),we.b=it+=_r,we.p=Je=8*Xt,we.f=nt;continue}if(It==1)Mt=Nhe,At=zhe,er=9,Rt=5;else if(It==2){var or=su(he,Je,31)+257,Cr=su(he,Je+10,15)+4,Gr=or+su(he,Je+5,31)+1;Je+=14;for(var Ir=new Nl(Gr),Qr=new Nl(19),Wr=0;Wr<Cr;++Wr)Qr[Rhe[Wr]]=su(he,Je+3*Wr,7);Je+=3*Cr;var tn=NL(Qr),gn=(1<<tn)-1,Zn=lw(Qr,tn);for(Wr=0;Wr<Gr;){var Mr,ln=Zn[su(he,Je,gn)];if(Je+=15&ln,(Mr=ln>>4)<16)Ir[Wr++]=Mr;else{var li=0,vi=0;for(Mr==16?(vi=3+su(he,Je,3),Je+=2,li=Ir[Wr-1]):Mr==17?(vi=3+su(he,Je,7),Je+=3):Mr==18&&(vi=11+su(he,Je,127),Je+=7);vi--;)Ir[Wr++]=li}}var Ai=Ir.subarray(0,or),Pi=Ir.subarray(or);er=NL(Ai),Rt=NL(Pi),Mt=lw(Ai,er),At=lw(Pi,Rt)}else lu(1);if(Je>Ft){We&&lu(0);break}}Le&&He(it+131072);for(var Un=(1<<er)-1,Ao=(1<<Rt)-1,Wa=Je;;Wa=Je){var Ki=(li=Mt[zL(he,Je)&Un])>>4;if((Je+=15&li)>Ft){We&&lu(0);break}if(li||lu(2),Ki<256)_e[it++]=Ki;else{if(Ki==256){Wa=Je,Mt=null;break}var co=Ki-254;Ki>264&&(co=su(he,Je,(1<<(zl=dW[Wr=Ki-257]))-1)+mW[Wr],Je+=zl);var ma=At[zL(he,Je)&Ao],Xo=ma>>4;if(ma||lu(3),Je+=15&ma,Pi=Lhe[Xo],Xo>3){var zl=hW[Xo];Pi+=zL(he,Je)&(1<<zl)-1,Je+=zl}if(Je>Ft){We&&lu(0);break}Le&&He(it+131072);var cp=it+co;if(it<Pi){var yc=0-Pi,uu=Math.min(Pi,cp);for(yc+it<0&&lu(3);it<uu;++it)_e[it]=(void 0)[yc+it]}for(;it<cp;++it)_e[it]=_e[it-Pi]}}we.l=Mt,we.p=Wa,we.b=it,we.f=nt,Mt&&(nt=1,we.m=er,we.d=At,we.n=Rt)}while(!nt);return it!=_e.length&&Se?(Ue=_e,((Xe=it)==null||Xe>Ue.length)&&(Xe=Ue.length),new Nl(Ue.subarray(0,Xe))):_e.subarray(0,it)}(ee.subarray(K,-8),{i:2},new Nl(((Z=ee)[(te=Z.length)-4]|Z[te-3]<<8|Z[te-2]<<16|Z[te-1]<<24)>>>0))));var Z,te,ee,K;const ie=$he[W];if(!ie)throw new Error(`Unhandled codec: ${W}`);const le=new globalThis.DecompressionStream(ie);return new Response(new Blob([N]).stream().pipeThrough(le)).arrayBuffer().then(he=>new Uint8Array(he))}(D,P).then(N=>(function(W,Z){W.readFields(Che,Z)}(new jL(N),O),new Vhe[T](O.buffer))),R.then(N=>{for(let W=w.length-1;W>=0;W--)switch(w[W]){case"delta_filter":Phe(N,M);break;case"zigzag_filter":Ihe(N);break;case"bitshuffle_filter":Ohe(N,T);break;default:throw new gc(`Unhandled filter "${w[W]}"`)}return{layerName:m,blockIndex:k,data:N}}).catch(N=>{throw N})}))},Qt(xW,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Qt(GA,"MapboxRasterTile"),Qt(_W,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let uw,FL,cu,p_,BL,m_=null;function bW(){return cn()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:FL||fe.DRACO_URL}function wW(){if(cn()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(p_)return p_;const d=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return p_=WebAssembly.validate(d)?fe.MESHOPT_SIMD_URL:fe.MESHOPT_URL,p_}const qA={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Whe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},dw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function SW(d,o,c){const f=c.json.bufferViews.length,m=c.buffers.length;o.bufferView=f,c.json.bufferViews[f]={buffer:m,byteLength:d.byteLength},c.buffers[m]=d}const $L="KHR_draco_mesh_compression";function Ghe(d,o){const c=d.extensions&&d.extensions[$L];if(!c)return;const f=new cu.Decoder,m=CW(o,c.bufferView),p=new cu.Mesh;if(!f.DecodeArrayToMesh(m,m.byteLength,p))throw new Error("Failed to decode Draco mesh");const v=o.json.accessors[d.indices],T=qA[v.componentType],M=v.count*T.BYTES_PER_ELEMENT,k=cu._malloc(M);T===Uint16Array?f.GetTrianglesUInt16Array(p,M,k):f.GetTrianglesUInt32Array(p,M,k),SW(cu.memory.buffer.slice(k,k+M),v,o),cu._free(k);for(const w of Object.keys(c.attributes)){const P=f.GetAttributeByUniqueId(p,c.attributes[w]),D=o.json.accessors[d.attributes[w]],O=Whe[D.componentType],R=D.count*dw[D.type]*qA[D.componentType].BYTES_PER_ELEMENT,N=cu._malloc(R);f.GetAttributeDataArrayForAllPoints(p,P,cu[O],R,N),SW(cu.memory.buffer.slice(N,N+R),D,o),cu._free(N)}f.destroy(),p.destroy(),delete d.extensions[$L]}const HA="EXT_meshopt_compression";function qhe(d,o){if(!d.extensions||!d.extensions[HA])return;const c=d.extensions[HA],f=new Uint8Array(o.buffers[c.buffer],c.byteOffset||0,c.byteLength||0),m=new Uint8Array(c.count*c.byteStride);BL.decodeGltfBuffer(m,c.count,c.byteStride,f,c.mode,c.filter),d.buffer=o.buffers.length,d.byteOffset=0,o.buffers[d.buffer]=m.buffer,delete d.extensions[HA]}const TW=1179937895,EW=new TextDecoder("utf8");function AW(d,o){return new URL(d,o).href}function Hhe(d,o,c,f){return fetch(AW(d.uri,f)).then(m=>m.arrayBuffer()).then(m=>{o.buffers[c]=m})}function CW(d,o){const c=d.json.bufferViews[o];return new Uint8Array(d.buffers[c.buffer],c.byteOffset||0,c.byteLength)}function Zhe(d,o,c,f){if(d.uri){const m=AW(d.uri,f);return fetch(m).then(p=>p.blob()).then(p=>createImageBitmap(p)).then(p=>{o.images[c]=p})}if(d.bufferView!==void 0){const m=CW(o,d.bufferView),p=new Blob([m],{type:d.mimeType});return createImageBitmap(p).then(v=>{o.images[c]=v})}}function MW(d,o=0,c){const f={json:null,images:[],buffers:[]};if(new Uint32Array(d,o,1)[0]===TW){const w=new Uint32Array(d,o);let P=2;const D=(w[P++]>>2)-3,O=w[P++]>>2;if(P++,f.json=JSON.parse(EW.decode(w.subarray(P,P+O))),P+=O,P<D){const R=w[P++];P++;const N=o+(P<<2);f.buffers[0]=d.slice(N,N+R)}}else f.json=JSON.parse(EW.decode(new Uint8Array(d,o)));const{buffers:m,images:p,meshes:v,extensionsUsed:T,bufferViews:M}=f.json;let k=Promise.resolve();if(m){const w=[];for(let P=0;P<m.length;P++){const D=m[P];D.uri?w.push(Hhe(D,f,P,c)):f.buffers[P]||(f.buffers[P]=null)}k=Promise.all(w)}return k.then(()=>{const w=[],P=T&&T.includes($L),D=T&&T.includes(HA);if(P&&w.push(function(){if(!cu)return uw??(uw=function(O){let R,N=null;function W(){R=new Uint8Array(N.buffer)}function Z(){throw new Error("Unexpected Draco error.")}const te={a:{a:Z,d:function(ee,K,ie){return R.copyWithin(ee,K,K+ie)},c:function(ee){const K=R.length,ie=Math.max(ee>>>0,Math.ceil(1.2*K)),le=Math.ceil((ie-K)/65536);try{return N.grow(le),W(),!0}catch{return!1}},b:Z}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(O,te):O.then(ee=>ee.arrayBuffer()).then(ee=>WebAssembly.instantiate(ee,te))).then(ee=>{const{Rb:K,Qb:ie,P:le,T:he,X:we,Ja:_e,La:xe,Qa:De,Va:Se,Wa:Le,eb:We,jb:Ue,f:Xe,e:He,yb:nt,zb:Je,Ab:it,Bb:Mt,Db:At,Gb:er}=ee.instance.exports;N=He;const Rt=(()=>{let Ft=0,It=0,_r=0,Xt=0;return or=>{_r&&(K(Xt),K(Ft),It+=_r,_r=Ft=0),Ft||(It+=128,Ft=ie(It));const Cr=or.length+7&-8;let Gr=Ft;Cr>=It&&(_r=Cr,Gr=Xt=ie(Cr));for(let Ir=0;Ir<or.length;Ir++)R[Gr+Ir]=or[Ir];return Gr}})();return W(),Xe(),{memory:He,_free:K,_malloc:ie,Mesh:class{constructor(){this.ptr=le()}destroy(){he(this.ptr)}},Decoder:class{constructor(){this.ptr=_e()}destroy(){Ue(this.ptr)}DecodeArrayToMesh(Ft,It,_r){const Xt=Rt(Ft),or=xe(this.ptr,Xt,It,_r.ptr);return!!we(or)}GetAttributeByUniqueId(Ft,It){return{ptr:De(this.ptr,Ft.ptr,It)}}GetTrianglesUInt16Array(Ft,It,_r){Se(this.ptr,Ft.ptr,It,_r)}GetTrianglesUInt32Array(Ft,It,_r){Le(this.ptr,Ft.ptr,It,_r)}GetAttributeDataArrayForAllPoints(Ft,It,_r,Xt,or){We(this.ptr,Ft.ptr,It.ptr,_r,Xt,or)}},DT_INT8:nt(),DT_UINT8:Je(),DT_INT16:it(),DT_UINT16:Mt(),DT_UINT32:At(),DT_FLOAT32:er()}})}(fetch(bW())),uw.then(O=>{cu=O,uw=void 0}))}()),D&&w.push(function(){if(BL)return;const O=function(R){let N;const W=WebAssembly.instantiateStreaming(R,{}).then(ee=>{N=ee.instance,N.exports.__wasm_call_ctors()}),Z={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},te={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(ee,K,ie,le,he,we){(function(_e,xe,De,Se,Le,We,Ue){const Xe=_e.exports.sbrk,He=Se+3&-4,nt=Xe(He*Le),Je=Xe(We.length),it=new Uint8Array(_e.exports.memory.buffer);it.set(We,Je);const Mt=xe(nt,Se,Le,Je,We.length);if(Mt===0&&Ue&&Ue(nt,He,Le),De.set(it.subarray(nt,nt+Se*Le)),Xe(nt-Xe(0)),Mt!==0)throw new Error(`Malformed buffer data: ${Mt}`)})(N,N.exports[te[he]],ee,K,ie,le,N.exports[Z[we]])}}}(fetch(wW()));return O.ready.then(()=>{BL=O})}()),p)for(let O=0;O<p.length;O++)w.push(Zhe(p[O],f,O,c));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(P&&v)for(const{primitives:O}of v)for(const R of O)Ghe(R,f);if(D&&v&&M)for(const O of M)qhe(O,f);return f})})}function Ig(d,o){const c=d.json.bufferViews[o.bufferView],f=qA[o.componentType];return new f(d.buffers[c.buffer],(o.byteOffset||0)+(c.byteOffset||0),o.count*(c.byteStride&&c.byteStride!==dw[o.type]*f.BYTES_PER_ELEMENT?c.byteStride/f.BYTES_PER_ELEMENT:dw[o.type]))}function UL(d,o,c,f){const m=qA[o.componentType],p=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),v=d.json.bufferViews[o.bufferView],T=v.byteStride?v.byteStride/m.BYTES_PER_ELEMENT:dw[o.type],M=c.float32,k=M.length/c.capacity;for(let w=0,P=0;w<o.count*T;w+=T,P+=k)for(let D=0;D<k;D++)M[P+D]=f[w+D]*p;c._trim()}function Xhe(d,o,c){const f=d.indices,m=d.attributes,p={};p.indexArray=new qo;const v=o.json.accessors[f],T=v.count/3;p.indexArray.reserve(T);const M=Ig(o,v);for(let D=0;D<T;D++)p.indexArray.emplaceBack(M[3*D],M[3*D+1],M[3*D+2]);p.indexArray._trim(),p.vertexArray=new Dl;const k=o.json.accessors[m.POSITION];p.vertexArray.reserve(k.count);const w=Ig(o,k);for(let D=0;D<k.count;D++)p.vertexArray.emplaceBack(w[3*D],w[3*D+1],w[3*D+2]);if(p.vertexArray._trim(),p.aabb=new lr(k.min,k.max),p.centroid=function(D,O){const R=[0,0,0],N=D.length;if(N>0){for(let W=0;W<N;W++){const Z=3*D[W];R[0]+=O[Z],R[1]+=O[Z+1],R[2]+=O[Z+2]}R[0]/=N,R[1]/=N,R[2]/=N}return R}(M,w),m.COLOR_0!==void 0){const D=o.json.accessors[m.COLOR_0],O=dw[D.type],R=Ig(o,D);p.colorArray=O===3?new Dl:new sh,p.colorArray.resize(D.count),UL(o,D,p.colorArray,R)}if(m.NORMAL!==void 0){p.normalArray=new Dl;const D=o.json.accessors[m.NORMAL];p.normalArray.resize(D.count);const O=Ig(o,D);UL(o,D,p.normalArray,O)}if(m.TEXCOORD_0!==void 0&&c.length>0){p.texcoordArray=new Xf;const D=o.json.accessors[m.TEXCOORD_0];p.texcoordArray.resize(D.count);const O=Ig(o,D);UL(o,D,p.texcoordArray,O)}if(m._FEATURE_ID_RGBA4444!==void 0){const D=o.json.accessors[m._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(p.featureData=Ig(o,D))}m._FEATURE_RGBA4444!==void 0&&(p.featureData=new Uint32Array(Ig(o,o.json.accessors[m._FEATURE_RGBA4444]).buffer));const P=d.material;return p.material=function(D,O){const{emissiveFactor:R=[0,0,0],alphaMode:N="OPAQUE",alphaCutoff:W=.5,normalTexture:Z,occlusionTexture:te,emissiveTexture:ee,doubleSided:K}=D,{baseColorFactor:ie=[1,1,1,1],metallicFactor:le=1,roughnessFactor:he=1,baseColorTexture:we,metallicRoughnessTexture:_e}=D.pbrMetallicRoughness||{},xe=te?O[te.index]:void 0;if(te&&te.extensions&&te.extensions.KHR_texture_transform&&xe){const De=te.extensions.KHR_texture_transform;xe.offsetScale=[De.offset[0],De.offset[1],De.scale[0],De.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new On(...ie),metallicFactor:le,roughnessFactor:he,baseColorTexture:we?O[we.index]:void 0,metallicRoughnessTexture:_e?O[_e.index]:void 0},doubleSided:K,emissiveFactor:R,alphaMode:N,alphaCutoff:W,normalTexture:Z?O[Z.index]:void 0,occlusionTexture:xe,emissionTexture:ee?O[ee.index]:void 0,defined:D.defined===void 0}}(P!==void 0?o.json.materials[P]:{defined:!1},c),p}function PW(d,o,c){const{matrix:f,rotation:m,translation:p,scale:v,mesh:T,extras:M,children:k}=d,w={};if(w.matrix=f||ge.mat4.fromRotationTranslationScale([],m||[0,0,0,1],p||[0,0,0],v||[1,1,1]),T!==void 0){w.meshes=c[T];const P=w.anchor=[0,0];for(const D of w.meshes){const{min:O,max:R}=D.aabb;P[0]+=O[0]+R[0],P[1]+=O[1]+R[1]}P[0]=Math.floor(P[0]/w.meshes.length/2),P[1]=Math.floor(P[1]/w.meshes.length/2)}if(M&&(M.id&&(w.id=M.id),M.lights&&(w.lights=function(P){if(!P.length)return[];const D=function(Z){const te=atob(Z),ee=new Uint8Array(te.length);for(let K=0;K<te.length;K++)ee[K]=te.codePointAt(K);return ee}(P),O=[],R=D.length/24,N=new Uint16Array(D.buffer),W=new Float32Array(D.buffer);for(let Z=0;Z<R;Z++){const te=N[2*Z*6]/30,ee=N[2*Z*6+1]/30,K=N[2*Z*6+10]/100,ie=W[6*Z+1],le=W[6*Z+2],he=W[6*Z+3],we=W[6*Z+4],_e=he-ie,xe=we-le,De=Math.hypot(_e,xe);O.push({pos:[ie+.5*_e,le+.5*xe,ee],normal:[xe/De,-_e/De,0],width:De,height:te,depth:K,points:[ie,le,he,we]})}return O}(M.lights))),k){const P=[];for(const D of k)P.push(PW(o.json.nodes[D],o,c));w.children=P}return w}function Yhe(d){if(d.vertices.length===0||d.indices.length===0)return null;const o=new XD(d.vertices,d.indices,8,256),[c,f]=[o.min.clone(),o.max.clone()];return{vertices:d.vertices,indices:d.indices,grid:o,min:c,max:f}}function Khe(d){if(!d.extras||!d.extras.ground)return null;const o=d.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;const c=o[0];if(!c||!Array.isArray(c)||c.length===0)return null;const f=[];for(const v of c){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],M=v[1];typeof T=="number"&&typeof M=="number"&&f.push(new xt(T,M))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let m=0;for(let v=0;v<f.length;v++){const T=f[v],M=f[(v+1)%f.length],k=f[(v+2)%f.length];m+=(T.x-M.x)*(k.y-M.y)-(k.x-M.x)*(T.y-M.y)}m>0&&f.reverse();const p=N1(f.flatMap(v=>[v.x,v.y]),[]);return p.length===0?null:{vertices:f,indices:p}}function Jhe(d,o){const c=[],f=[];let m=0;const p=[];for(const v of d){m=c.length;const T=v.vertexArray.float32,M=v.indexArray.uint16;for(let k=0;k<v.vertexArray.length;k++)p[0]=T[3*k+0],p[1]=T[3*k+1],p[2]=T[3*k+2],ge.vec3.transformMat4(p,p,o),c.push(new xt(p[0],p[1]));for(let k=0;k<3*v.indexArray.length;k++)f.push(M[k]+m)}if(f.length%3!=0)return null;for(let v=0;v<f.length;v+=3){const T=c[f[v+0]],M=c[f[v+1]],k=c[f[v+2]];(T.x-M.x)*(k.y-M.y)-(k.x-M.x)*(T.y-M.y)>0&&([f[v+1],f[v+2]]=[f[v+2],f[v+1]])}return{vertices:c,indices:f}}function IW(d){const o=function(M,k){const w=[],P=WebGL2RenderingContext;if(M.json.textures)for(const D of M.json.textures){const O={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};D.sampler!==void 0&&Object.assign(O,M.json.samplers[D.sampler]),w.push({image:k[D.source],sampler:O,uploaded:!1})}return w}(d,d.images),c=function(M,k){const w=[];for(const P of M.json.meshes){const D=[];for(const O of P.primitives)D.push(Xhe(O,M,k));w.push(D)}return w}(d,o),{scenes:f,scene:m,nodes:p}=d.json,v=f?f[m||0].nodes:p,T=[];for(const M of v)T.push(PW(p[M],d,c));return function(M,k,w){const P={},D=new Set;for(let O=0;O<M.length;O++){const R=w[k[O]];if(!R.extras)continue;const N=R.extras["mapbox:footprint:version"],W=R.extras["mapbox:footprint:id"];(N||W)&&D.add(O),N==="1.0.0"&&W&&(P[W]=O)}for(let O=0;O<M.length;O++){if(D.has(O))continue;const R=M[O],N=w[k[O]];if(!N.extras)continue;let W=null;R.id in P&&(W=Jhe(M[P[R.id]].meshes,R.matrix)),W||(W=Khe(N)),W&&(R.footprint=Yhe(W))}if(D.size>0){const O=Array.from(D.values()).sort((R,N)=>R-N);for(let R=O.length-1;R>=0;R--)M.splice(O[R],1)}}(T,v,d.json.nodes),T}function Qhe(d){d.heightmap=new Float32Array(4096),d.heightmap.fill(-1);const o=d.vertexArray.float32,c=d.aabb.min[0]-1,f=d.aabb.min[1]-1,m=Cg/(d.aabb.max[0]-c+2),p=Cg/(d.aabb.max[1]-f+2);for(let v=0;v<o.length;v+=3){const T=o[v+2],M=(o[v+0]-c)*m|0,k=(o[v+1]-f)*p|0;T>d.heightmap[k*Cg+M]&&(d.heightmap[k*Cg+M]=T)}}function efe(d,o){const c={};c.indexArray=new qo,c.indexArray.reserve(4*d.length),c.vertexArray=new Dl,c.vertexArray.reserve(10*d.length),c.colorArray=new sh,c.vertexArray.reserve(10*d.length);let f=0;for(const v of d){const T=Math.min(10,Math.max(4,1.3*v.height))*o,M=[-v.normal[1],v.normal[0],0],k=Math.min(.29,.1*v.width/v.depth),w=v.width-2*v.depth*o*(k+.01),P=ge.vec3.scaleAndAdd([],v.pos,M,w/2),D=ge.vec3.scaleAndAdd([],v.pos,M,-w/2),O=[P[0],P[1],P[2]+v.height],R=[D[0],D[1],D[2]+v.height],N=ge.vec3.scaleAndAdd([],v.normal,M,k);ge.vec3.scale(N,N,T);const W=ge.vec3.scaleAndAdd([],v.normal,M,-k);ge.vec3.scale(W,W,T),ge.vec3.add(N,P,N),ge.vec3.add(W,D,W),P[2]+=.1,D[2]+=.1,c.vertexArray.emplaceBack(N[0],N[1],N[2]),c.vertexArray.emplaceBack(W[0],W[1],W[2]),c.vertexArray.emplaceBack(P[0],P[1],P[2]),c.vertexArray.emplaceBack(D[0],D[1],D[2]),c.vertexArray.emplaceBack(O[0],O[1],O[2]),c.vertexArray.emplaceBack(R[0],R[1],R[2]),c.vertexArray.emplaceBack(P[0],P[1],P[2]),c.vertexArray.emplaceBack(D[0],D[1],D[2]),c.vertexArray.emplaceBack(N[0],N[1],N[2]),c.vertexArray.emplaceBack(W[0],W[1],W[2]);const Z=w/T/2;c.colorArray.emplaceBack(-Z-k,-1,Z,.8),c.colorArray.emplaceBack(Z+k,-1,Z,.8),c.colorArray.emplaceBack(-Z,0,Z,1.3),c.colorArray.emplaceBack(Z,0,Z,1.3),c.colorArray.emplaceBack(Z+k,-.8,Z,.7),c.colorArray.emplaceBack(Z+k,-.8,Z,.7),c.colorArray.emplaceBack(0,0,Z,1.3),c.colorArray.emplaceBack(0,0,Z,1.3),c.colorArray.emplaceBack(Z+k,-1.2,Z,.8),c.colorArray.emplaceBack(Z+k,-1.2,Z,.8),c.indexArray.emplaceBack(6+f,4+f,8+f),c.indexArray.emplaceBack(7+f,9+f,5+f),c.indexArray.emplaceBack(0+f,1+f,2+f),c.indexArray.emplaceBack(1+f,3+f,2+f),f+=10}const m={defined:!0,emissiveFactor:[0,0,0]},p={};return p.baseColorFactor=On.white,m.pbrMetallicRoughness=p,c.material=m,c.aabb=new lr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),c}class OW{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const f=o[c];this._stringToNumber[f]=c,this._numberToString[c]=f}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const tfe=["id","tile","layer","source","sourceLayer","state"];class g_{constructor(o,c,f,m,p){this.type="Feature",this._vectorTileFeature=o,this._z=c,this._x=f,this._y=m,this.properties=o.properties,this.id=p}clone(){const o=new g_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const c of tfe)this[c]!==void 0&&(o[c]=this[c]);return o}}class kW{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Ff($t,16,0),this.featureIndexArray=new Qa,this.promoteId=c,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,c,f,m,p,v=0,T=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,m,p,v);const k=this.grid;for(let w=0;w<c.length;w++){const P=c[w],D=[1/0,1/0,-1/0,-1/0];for(let O=0;O<P.length;O++){const R=P[O];D[0]=Math.min(D[0],R.x),D[1]=Math.min(D[1],R.y),D[2]=Math.max(D[2],R.x),D[3]=Math.max(D[3],R.y)}T!==0&&(D[0]-=T,D[1]-=T,D[2]+=T,D[3]+=T),D[0]<$t&&D[1]<$t&&D[2]>=0&&D[3]>=0&&k.insert(M,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new rp.VectorTile(new mA(this.rawTileData)).layers,this.sourceLayerCoder=new OW(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,c){const{tilespaceGeometry:f,transform:m,tileTransform:p,pixelPosMatrix:v,availableImages:T}=c;this.loadVTLayers(),this.serializedLayersCache.clear();const M=f.bufferedTilespaceBounds,k=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(O,R,N,W)=>Oe(f.bufferedTilespaceGeometry,O,R,N,W));k.sort(rfe);let w=null;m.elevation&&k.length>0&&(w=c_.create(m.elevation,this.tileID));const P={};let D;for(let O=0;O<k.length;O++){const R=k[O];if(R===D)continue;D=R;const N=this.featureIndexArray.get(R);let W=null;this.is3DTile?this.loadMatchingModelFeature(P,N,o,f,m):this.loadMatchingFeature(P,N,o,T,(Z,te,ee,K=0)=>(W||(W=U(Z,this.tileID.canonical,p)),te.queryIntersectsFeature(f,Z,ee,W,this.z,m,v,w,K)))}return P}loadMatchingFeature(o,c,f,m,p){const{featureIndex:v,bucketIndex:T,sourceLayerIndex:M,layoutVertexArrayOffset:k}=c,w=this.bucketLayerIDs[T],P=f.layers,D=Object.keys(P);if(D.length&&!function(Z,te){for(let ee=0;ee<Z.length;ee++)if(te.indexOf(Z[ee])>=0)return!0;return!1}(D,w))return;const O=f.sourceCache,R=this.sourceLayerCoder.decode(M),N=this.vtLayers[R].feature(v),W=this.getId(N,R);for(let Z=0;Z<w.length;Z++){const te=w[Z];if(!P[te])continue;const{styleLayer:ee,targets:K}=P[te];let ie={};W!==void 0&&(ie=O.getFeatureState(ee.sourceLayer,W));const le=!p||p(N,ee,ie,k);if(!le)continue;const he=new g_(N,this.z,this.x,this.y,W);he.tile=this.tileID.canonical,he.state=ie;let we=this.serializedLayersCache.get(te);we||(we=ee.serialize(),we.id=te,this.serializedLayersCache.set(te,we)),he.source=we.source,he.sourceLayer=we["source-layer"],he.layer=Ti({},we),he.layer.paint=RW(we.paint,ee.paint,N,ie,m),he.layer.layout=RW(we.layout,ee.layout,N,ie,m);let _e=!1;for(const xe of K){this.updateFeatureProperties(he,xe);const{filter:De}=xe;if(De){if(N.properties=he.properties,De.needGeometry){const Se=V(N,!0);if(!De.filter(new Hn(this.tileID.overscaledZ),Se,this.tileID.canonical))continue}else if(!De.filter(new Hn(this.tileID.overscaledZ),N))continue}_e=!0,xe.targetId&&this.addFeatureVariant(he,xe)}_e&&this.appendToResult(o,te,v,he,le)}}loadMatchingModelFeature(o,c,f,m,p){const v=this.bucketLayerIDs[0][0],T=f.layers;if(!T[v])return;const{styleLayer:M,targets:k}=T[v];if(M.type!=="model")return;const w=m.tile,P=c.featureIndex,D=w.getBucket(M);if(!(D&&D instanceof NA))return;const O=function(we,_e,xe,De){const Se=we.getNodesInfo()[_e];if(Se.hiddenByReplacement||!Se.node.meshes)return;let Le=Number.MAX_VALUE;const We=Se.node,Ue=xe.tile,Xe=De.calculatePosMatrix(Ue.tileID.toUnwrapped(),De.worldSize),He=Se.evaluatedScale;let nt=0;De.elevation&&We.elevation&&(nt=We.elevation*De.elevation.exaggeration()),ge.mat4.translate(Xe,Xe,[(We.anchor?We.anchor[0]:0)*(He[0]-1),(We.anchor?We.anchor[1]:0)*(He[1]-1),nt]),ge.mat4.scale(Xe,Xe,He);const Je=xe.queryGeometry,it=Je.isPointQuery()?Je.screenBounds:Je.screenGeometry,Mt=function(er){const Rt=ge.mat4.multiply([],Xe,er.matrix);ge.mat4.multiply(Rt,De.expandedFarZProjMatrix,Rt);for(let Ft=0;Ft<er.meshes.length;++Ft){const It=er.meshes[Ft];if(Ft===er.lightMeshIndex)continue;const _r=I8(it,De,Rt,It.aabb);_r!=null&&(Le=Math.min(_r,Le))}if(er.children)for(const Ft of er.children)Mt(Ft)};if(Mt(We),Le===Number.MAX_VALUE)return;const At=new bn(0,0);return U8(Ue.tileID.canonical,At,Se.node.anchor[0],Se.node.anchor[1]),{intersectionZ:Le,position:At,feature:Se.feature}}(D,P,m,p);if(!O)return;const{z:R,x:N,y:W}=w.tileID.canonical,{feature:Z,intersectionZ:te,position:ee}=O;let K={};Z.id!==void 0&&(K=f.sourceCache.getFeatureState(M.sourceLayer,Z.id));const ie=new g_({},R,N,W,Z.id);ie.tile=this.tileID.canonical,ie.state=K,ie.properties=Z.properties,ie.geometry={type:"Point",coordinates:[ee.lng,ee.lat]};let le=this.serializedLayersCache.get(v);le||(le=M.serialize(),le.id=v,this.serializedLayersCache.set(v,le)),ie.source=le.source,ie.sourceLayer=le["source-layer"],ie.layer=Ti({},le);let he=!1;for(const we of k){this.updateFeatureProperties(ie,we);const{filter:_e}=we;if(_e){if(Z.properties=ie.properties,_e.needGeometry){if(!_e.filter(new Hn(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!_e.filter(new Hn(this.tileID.overscaledZ),Z))continue}he=!0,we.targetId&&this.addFeatureVariant(ie,we)}he&&this.appendToResult(o,v,P,ie,te)}updateFeatureProperties(o,c,f){if(c.properties){const m={};for(const p in c.properties){const v=c.properties[p].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,f);v!=null&&(m[p]=v)}o.properties=m}}addFeatureVariant(o,c,f){const m={target:c.target,namespace:c.namespace,uniqueFeatureID:c.uniqueFeatureID};c.properties&&(m.properties=o.properties),o.variants=o.variants||{},o.variants[c.targetId]=o.variants[c.targetId]||[],o.variants[c.targetId].push(m)}appendToResult(o,c,f,m,p){let v=o[c];v===void 0&&(v=o[c]=[]),v.push({featureIndex:f,feature:m,intersectionZ:p})}lookupSymbolFeatures(o,c,f,m,p){const v={};this.loadVTLayers();for(const T of o)this.loadMatchingFeature(v,{bucketIndex:c,sourceLayerIndex:f,featureIndex:T,layoutVertexArrayOffset:0},m,p);return v}loadFeature(o){const{featureIndex:c,sourceLayerIndex:f}=o;this.loadVTLayers();const m=this.sourceLayerCoder.decode(f),p=this.vtFeatures[m];if(p[c])return p[c];const v=this.vtLayers[m].feature(c);return p[c]=v,v}hasLayer(o){for(const c of this.bucketLayerIDs)for(const f of c)if(o===f)return!0;return!1}getId(o,c){let f=o.id;if(this.promoteId){const m=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[c];if(m!=null)if(Array.isArray(m)){if(!this.promoteIdExpression){const p=zf(m);if(p.result!=="success"){const v=p.value.map(T=>`${T.key}: ${T.message}`).join(", ");return void ai(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=p.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new uv),f=this.promoteIdExpression.evaluate({zoom:0},o)}else f=o.properties[m];typeof f=="boolean"&&(f=Number(f))}return f}}function RW(d,o,c,f,m){return Ba(d,(p,v)=>{const T=o instanceof Wf?o.get(v):null;return T&&T.evaluate?T.evaluate(c,f,m):T})}function rfe(d,o){return o-d}Qt(kW,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const DW=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class VL{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,f]=new Uint8Array(o,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=f>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const p=DW[15&f];if(!p)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(o,2,1),[T]=new Uint32Array(o,4,1);return new VL(T,v,p,o)}constructor(o,c=64,f=Float64Array,m){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=f,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const p=DW.indexOf(this.ArrayType),v=2*o*this.ArrayType.BYTES_PER_ELEMENT,T=o*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-T%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${f}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+M,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+M),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+M,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=o)}add(o,c){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=o,this.coords[this._pos++]=c,f}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return WL(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,c,f,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:T}=this,M=[0,p.length-1,0],k=[];for(;M.length;){const w=M.pop()||0,P=M.pop()||0,D=M.pop()||0;if(P-D<=T){for(let W=D;W<=P;W++){const Z=v[2*W],te=v[2*W+1];Z>=o&&Z<=f&&te>=c&&te<=m&&k.push(p[W])}continue}const O=D+P>>1,R=v[2*O],N=v[2*O+1];R>=o&&R<=f&&N>=c&&N<=m&&k.push(p[O]),(w===0?o<=R:c<=N)&&(M.push(D),M.push(O-1),M.push(1-w)),(w===0?f>=R:m>=N)&&(M.push(O+1),M.push(P),M.push(1-w))}return k}within(o,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:p,nodeSize:v}=this,T=[0,m.length-1,0],M=[],k=f*f;for(;T.length;){const w=T.pop()||0,P=T.pop()||0,D=T.pop()||0;if(P-D<=v){for(let W=D;W<=P;W++)NW(p[2*W],p[2*W+1],o,c)<=k&&M.push(m[W]);continue}const O=D+P>>1,R=p[2*O],N=p[2*O+1];NW(R,N,o,c)<=k&&M.push(m[O]),(w===0?o-f<=R:c-f<=N)&&(T.push(D),T.push(O-1),T.push(1-w)),(w===0?o+f>=R:c+f>=N)&&(T.push(O+1),T.push(P),T.push(1-w))}return M}}function WL(d,o,c,f,m,p){if(m-f<=c)return;const v=f+m>>1;LW(d,o,v,f,m,p),WL(d,o,c,f,v-1,1-p),WL(d,o,c,v+1,m,1-p)}function LW(d,o,c,f,m,p){for(;m>f;){if(m-f>600){const k=m-f+1,w=c-f+1,P=Math.log(k),D=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*D*(k-D)/k)*(w-k/2<0?-1:1);LW(d,o,c,Math.max(f,Math.floor(c-w*D/k+O)),Math.min(m,Math.floor(c+(k-w)*D/k+O)),p)}const v=o[2*c+p];let T=f,M=m;for(hw(d,o,f,c),o[2*m+p]>v&&hw(d,o,f,m);T<M;){for(hw(d,o,T,M),T++,M--;o[2*T+p]<v;)T++;for(;o[2*M+p]>v;)M--}o[2*f+p]===v?hw(d,o,f,M):(M++,hw(d,o,M,m)),M<=c&&(f=M+1),c<=M&&(m=M-1)}}function hw(d,o,c,f){GL(d,c,f),GL(o,2*c,2*f),GL(o,2*c+1,2*f+1)}function GL(d,o,c){const f=d[o];d[o]=d[c],d[c]=f}function NW(d,o,c,f){const m=d-c,p=o-f;return m*m+p*p}i.$=Ia,i.A=Ka,i.B=cc,i.C=Hf,i.D=u_,i.E=Il,i.F=2,i.G=H1,i.H=VV,i.I=$a,i.J=class extends DA{},i.K=Gc,i.L=vn,i.M=j2,i.N=Xb,i.O=Nf,i.P=xt,i.Q=M2,i.R=Lo,i.S=Pv,i.T=wL,i.U=jv,i.V=DA,i.W=Qb,i.X=zf,i.Y=Qm,i.Z=Yc,i._=Of,i.a=function(d){return fe.API_CDN_URL_REGEX.test(d)},i.a$=V,i.a0=Xs,i.a1=u1,i.a2=Cv,i.a3=Av,i.a4=function(d){const o=d.value;let c=[];if(!o)return c;const f=Gc(o);return f!=="string"?(c=c.concat([new DA(d.key,o,`string expected, "${f}" found`)]),c):(k8(o,!0)||(c=c.concat([new DA(d.key,o,`invalid url "${o}"`)])),c)},i.a5=at,i.a6=c1,i.a7=Ei,i.a8=jt,i.a9=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return Xr(d.expression.evaluate(o))}interpolate(d,o,c){return{x:br(d.x,o.x,c),y:br(d.y,o.y,c),z:br(d.z,o.z,c),azimuthal:br(d.azimuthal,o.azimuthal,c),polar:br(d.polar,o.polar,c)}}},i.aA=function(d,o){const c={};for(let f=0;f<o.length;f++){const m=o[f];m in d&&(c[m]=d[m])}return c},i.aB=sd,i.aC=es,i.aD=class{constructor(d){this.entries={},this.scheduler=d}request(d,o,c,f){const m=this.entries[d]=this.entries[d]||{callbacks:[]};if(m.result){const[p,v]=m.result;return this.scheduler?this.scheduler.add(()=>{f(p,v)},o):f(p,v),()=>{}}return m.callbacks.push(f),m.cancel||(m.cancel=c((p,v)=>{m.result=[p,v];for(const T of m.callbacks)this.scheduler?this.scheduler.add(()=>{T(p,v)},o):T(p,v);setTimeout(()=>delete this.entries[d],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(p=>p!==f),m.callbacks.length||(m.cancel(),delete this.entries[d]))}}},i.aE=function(d,o,c){const f=JSON.stringify(d.request);return d.data&&(this.deduped.entries[f]={result:[null,d.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:d.isSymbolTile,zoom:d.tileZoom},m=>{const p=$c(d.request,(v,T,M,k)=>{v?m(v):T&&m(null,{vectorTile:c?void 0:new rp.VectorTile(new mA(T)),rawData:T,cacheControl:M,expires:k})});return()=>{p.cancel(),m()}},o)},i.aF=function(d){Pn++,Pn>Ur&&(d.getActor().send("enforceCacheSizeLimit",Dr),Pn=0)},i.aG=function(d){return d<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))},i.aH=Ct,i.aI=_8,i.aJ=E8,i.aK=v8,i.aL=function(d,o){const c=document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let f=0;f<d.length;f++){const m=document.createElement("source");vb(d[f])||(c.crossOrigin="Anonymous"),m.src=d[f],c.appendChild(m)}return{cancel:()=>{}}},i.aM=PA,i.aN=function(d){return fetch(d).then(o=>o.arrayBuffer()).then(o=>MW(o,0,d))},i.aO=IW,i.aP=class{constructor(d,o,c,f){this.id=d,this.position=o!=null?new bn(o[0],o[1]):new bn(0,0),this.orientation=c??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new lr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(d,o){if(ge.mat4.multiply(d.matrix,o,d.matrix),d.meshes)for(const c of d.meshes){const f=lr.applyTransformFast(c.aabb,d.matrix);this.aabb.encapsulate(f)}if(d.children)for(const c of d.children)this._applyTransformations(c,d.matrix)}computeBoundsAndApplyParent(){const d=ge.mat4.identity([]);for(const o of this.nodes)this._applyTransformations(o,d)}computeModelMatrix(d,o,c,f,m,p,v=!1){z8(this.matrix,this,d.transform,this.position,o,c,f,m,p,v)}upload(d){if(!this.uploaded){for(const o of this.nodes)CL(o,d);for(const o of this.nodes)LA(o);this.uploaded=!0}}destroy(){for(const d of this.nodes)ML(d)}},i.aQ=ys,i.aR=Y1,i.aS=ts,i.aT=Ho,i.aU=eu,i.aV=qo,i.aW=Wo,i.aX=fg,i.aY=CA,i.aZ=function(){Js.isLoading()||Js.isLoaded()||Nv()!=="deferred"||z2()},i.a_=d1,i.aa=Hn,i.ab=jf,i.ac=s,i.ad=ge,i.ae=Zr,i.af=Wf,i.ag=Va,i.ah=br,i.ai=$t,i.aj=u2,i.ak=Ge,i.al=On,i.am=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return function([c,f]){const m=Xr([1,c,f]);return{x:m.x,y:m.y,z:m.z}}(d.expression.evaluate(o))}interpolate(d,o,c){return{x:br(d.x,o.x,c),y:br(d.y,o.y,c),z:br(d.z,o.z,c)}}},i.an=function(d,o,c=0,f=!0){const m=new xt(c,c),p=d.sub(m),v=o.add(m),T=[p,new xt(v.x,p.y),v,new xt(p.x,v.y)];return f&&T.push(p.clone()),T},i.ao=function(d,o){const c=[];for(let f=0;f<d.length;f++){const m=oi(f-1,-1,d.length-1),p=oi(f+1,-1,d.length-1),v=d[f],T=d[p],M=d[m].sub(v).unit(),k=T.sub(v).unit(),w=k.angleWithSep(M.x,M.y),P=M.add(k).unit().mult(-1*o/Math.sin(w/2));c.push(v.add(P))}return c},i.ap=i8,i.aq=Oe,i.ar=function(d,o,c=0){return ge.vec3.fromValues(((o.x-c)*d.scale-d.x)*$t,(o.y*d.scale-d.y)*$t,k1(o.z,o.y))},i.as=Ar,i.at=yV,i.au=function(d){let o=1/0,c=1/0,f=-1/0,m=-1/0;for(const p of d)o=Math.min(o,p.x),c=Math.min(c,p.y),f=Math.max(f,p.x),m=Math.max(m,p.y);return{min:new xt(o,c),max:new xt(f,m)}},i.av=fc,i.aw=Ie,i.ax=g,i.ay=Yt,i.az=Oa,i.b=function(d){return fe.API_FONTS_REGEX.test(d)},i.b$=kA,i.b0=g_,i.b1=fn,i.b2=tL,i.b3=ZD,i.b4=U,i.b5=Qc,i.b6=qv,i.b7=xr,i.b8=hi,i.b9=N1,i.bA=X6,i.bB=hL,i.bC=KV,i.bD=cL,i.bE=VL,i.bF=oi,i.bG=Xi,i.bH=ta,i.bI=function(d,o,c){d[4*o+0]=c[0],d[4*o+1]=c[1],d[4*o+2]=c[2],d[4*o+3]=c[3]},i.bJ=bg,i.bK=el,i.bL=Yf,i.bM=Wi,i.bN=_g,i.bO=bn,i.bP=c8,i.bQ=ht,i.bR=Nr,i.bS=C8,i.bT=Et,i.bU=pa,i.bV=function(d,o,c,f,m,p,v,T,M){if(M.name==="globe")return pa(d,o,new Et(c,f,m),!1);const k=Y1({z:c,x:f,y:m},M);return new lr([(p+k.x/k.scale)*o,o*(k.y/k.scale),v],[(p+k.x2/k.scale)*o,o*(k.y2/k.scale),T])},i.bW=function(d,o,c){let f=0;for(let m=0;m<2;++m)d[m]>0&&(f+=(d[m]-0)*(d[m]-0)),o[m]<0&&(f+=(0-o[m])*(0-o[m]));return f},i.bX=Bi,i.bY=tA,i.bZ=function(d){const o=ge.mat4.identity(new Float64Array(16));ge.mat4.multiply(o,d.pixelMatrix,d.globeMatrix);const c=[0,Es,0],f=[0,As,0];return ge.vec3.transformMat4(c,c,o),ge.vec3.transformMat4(f,f,o),[c[0]>0&&c[0]<=d.width&&c[1]>0&&c[1]<=d.height&&!ns(d,new bn(d.center.lat,90)),f[0]>0&&f[0]<=d.width&&f[1]>0&&f[1]<=d.height&&!ns(d,new bn(d.center.lat,-90))]},i.b_=function(d,o){const{scale:c}=d.tileTransform,f=c*$t/(d.tileSize*Math.pow(2,o.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return ge.mat2.scale(new Float32Array(4),o.inverseAdjustmentMatrix,[f,f])},i.ba=_L,i.bb=function(d,o){const c=Va(o.zoom);if(c===0)return yo(d);const f=hn(d),m=pi(f),p=fc(f.getWest())*o.worldSize,v=fc(f.getEast())*o.worldSize,T=es(f.getNorth())*o.worldSize,M=es(f.getSouth())*o.worldSize,k=[p,T,0],w=[v,T,0],P=[p,M,0],D=[v,M,0],O=ge.mat4.invert([],o.globeMatrix);return ge.vec3.transformMat4(k,k,O),ge.vec3.transformMat4(w,w,O),ge.vec3.transformMat4(P,P,O),ge.vec3.transformMat4(D,D,O),m[0]=To(m[0],P,c),m[1]=To(m[1],D,c),m[2]=To(m[2],w,c),m[3]=To(m[3],k,c),lr.fromPoints(m)},i.bc=si,i.bd=Sn,i.be=To,i.bf=Zf,i.bg=kr,i.bh=GA,i.bi=mA,i.bj=$c,i.bk=function(d,o){const c=[];for(const f in d)f in o||c.push(f);return c},i.bl=Bn,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=un,i.bo=function(d,o){const{x:c,y:f}=d.point,m=tl(c,f,d.worldSize/d._pixelsPerMercatorPixel,0,0);return ge.mat4.multiply(m,m,vo(yo(o)))},i.bp=r_,i.bq=Ms,i.br=pA,i.bs=function(d,o,c,f,m){const p=5*o+2;d.float32[p+0]=c,d.float32[p+1]=f,d.float32[p+2]=m},i.bt=AA,i.bu=UV,i.bv=ce,i.bw=na,i.bx=V6,i.by=O8,i.bz=Z6,i.c=Me,i.c$=bV,i.c0=A8,i.c1=function(d){const o=A8(d,!0);return ge.mat2.invert([],[o[0],o[1],o[4],o[5]])},i.c2=nn,i.c3=function(d){const{x:o,y:c}=d.point,{lng:f,lat:m}=d._center;return tl(o,c,d.worldSize,f,m)},i.c4=vt,i.c5=Gt,i.c6=Kf,i.c7=function(d){const o=Math.round((d+45+360)%360/90)%4;return kt[o]},i.c8=45,i.c9=d2,i.cA=J2,i.cB=class extends hc{constructor(d){super(d),this.current=M1}set(d,o,c){if(this.fetchUniformLocation(d,o)){for(let f=0;f<9;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},i.cC=fr,i.cD=function(d,o,c){const f=Va(c.zoom),m=d.style.map._antialias,p=d.terrain&&d.terrain.exaggeration()>0;return f===0&&!m&&!p},i.cE=function(d){const o=d.pixelsPerMeter,c=o/ta(1,d.center.lat),f=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(f,f,[d.point.x,d.point.y,0]),ge.mat4.scale(f,f,[c,c,o]),Float32Array.from(f)},i.cF=hn,i.cG=function(d){const o=Bi-5;d=Yt(d,-o,o)/o*90;const c=Math.pow(Math.abs(Math.sin(Ge(d))),3);return Math.round(c*(Jv.length-1))},i.cH=function(d,o,c,f){const m=o.getNorth(),p=o.getSouth(),v=o.getWest(),T=o.getEast(),M=1<<d.z,k=T-v,w=m-p,P=k/Jf,D=-w/Jv[c],O=[0,P,0,D,0,0,m,v,0];if(d.z>0){const R=180/f;ge.mat3.multiply(O,O,[R/k+1,0,0,0,R/w+1,0,-.5*R/P,.5*R/D,1])}return O[2]=M,O[5]=d.x,O[8]=d.y,O},i.cI=yo,i.cJ=function(d,o,c){const f=ge.mat4.identity(new Float64Array(16)),m=(o/(1<<d)-.5)*Math.PI*2;return ge.mat4.rotateY(f,c.globeMatrix,m),Float32Array.from(f)},i.cK=class{isDataAvailableAtPoint(d){const o=this._source();if(this.isUsingMockSource()||!o||d.y<0||d.y>1)return!1;const c=o.getSource().maxzoom,f=1<<c,m=Math.floor(d.x),p=Math.floor((d.x-m)*f),v=Math.floor(d.y*f),T=this.findDEMTileFor(new Ct(c,m,c,p,v));return!(!T||!T.dem)}getAtPointOrZero(d,o=0){return this.getAtPoint(d,o)||0}getAtPoint(d,o,c=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const f=this._source();if(!f||d.y<0||d.y>1)return o;const m=f.getSource().maxzoom,p=1<<m,v=Math.floor(d.x),T=d.x-v,M=new Ct(m,v,m,Math.floor(T*p),Math.floor(d.y*p)),k=this.findDEMTileFor(M);if(!k||!k.dem)return o;const w=k.dem,P=1<<k.tileID.canonical.z,D=(T*P-k.tileID.canonical.x)*w.dim,O=(d.y*P-k.tileID.canonical.y)*w.dim,R=Math.floor(D),N=Math.floor(O);return(c?this.exaggeration():1)*br(br(w.get(R,N),w.get(R,N+1),O-N),br(w.get(R+1,N),w.get(R+1,N+1),O-N),D-R)}getAtTileOffset(d,o,c){const f=1<<d.canonical.z;return this.getAtPointOrZero(new s(d.wrap+(d.canonical.x+o/$t)/f,(d.canonical.y+c/$t)/f))}getAtTileOffsetFunc(d,o,c,f){return m=>{const p=this.getAtTileOffset(d,m.x,m.y),v=f.upVector(d.canonical,m.x,m.y),T=f.upVectorScale(d.canonical,o,c).metersToTile;return ge.vec3.scale(v,v,p*T),v}}getForTilePoints(d,o,c,f){if(this.isUsingMockSource())return!1;const m=c_.create(this,d,f);return!!m&&(o.forEach(p=>{p[2]=this.exaggeration()*m.getElevationAt(p[0],p[1],c)}),!0)}getMinMaxForTile(d){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(d);if(!o||!o.dem)return null;const c=o.dem.tree,f=o.tileID,m=1<<d.canonical.z-f.canonical.z;let p=d.canonical.x/m-f.canonical.x,v=d.canonical.y/m-f.canonical.y,T=0;for(let M=0;M<d.canonical.z-f.canonical.z&&!c.leaves[T];M++){p*=2,v*=2;const k=2*Math.floor(v)+Math.floor(p);T=c.childOffsets[T]+k,p%=1,v%=1}return{min:this.exaggeration()*c.minimums[T],max:this.exaggeration()*c.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(d,o,c){throw new Error("Pure virtual method called.")}pointCoordinate(d){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(d){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const d=this.visibleDemTiles;if(d.length===0)return null;let o=!1,c=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const m of d){const p=this.getMinMaxForTile(m.tileID);p&&(c=Math.min(c,p.min),f=Math.max(f,p.max),o=!0)}return o?{min:c,max:f}:null}},i.cL=_6,i.cM=sn,i.cN=function(d,o){return[Math.pow(d[0],2.2)*o,Math.pow(d[1],2.2)*o,Math.pow(d[2],2.2)*o]},i.cO=rs,i.cP=ft,i.cQ=_s,i.cR=256,i.cS=function(d,o){const c=[0,0,0],f=si(yo(o.canonical));return ge.vec3.transformMat4(c,c,f),ge.vec3.transformMat4(c,c,d),c},i.cT=d=>({u_camera_to_center_distance:new Wi(d),u_extrude_scale:new P1(d),u_device_pixel_ratio:new Wi(d),u_matrix:new bg(d),u_inv_rot_matrix:new bg(d),u_merc_center:new el(d),u_tile_id:new Yf(d),u_zoom_transition:new Wi(d),u_up_dir:new Yf(d),u_emissive_strength:new Wi(d)}),i.cU=d=>({u_matrix:new bg(d),u_pixels_to_tile_units:new P1(d),u_device_pixel_ratio:new Wi(d),u_width_scale:new Wi(d),u_floor_width_scale:new Wi(d),u_units_to_pixels:new el(d),u_dash_image:new _g(d),u_gradient_image:new _g(d),u_image_height:new Wi(d),u_texsize:new el(d),u_tile_units_to_pixels:new Wi(d),u_alpha_discard_threshold:new Wi(d),u_trim_offset:new el(d),u_trim_fade_range:new el(d),u_trim_color:new xg(d),u_emissive_strength:new Wi(d),u_zbias_factor:new Wi(d),u_tile_to_meter:new Wi(d)}),i.cV=d=>({u_matrix:new bg(d),u_texsize:new el(d),u_pixels_to_tile_units:new P1(d),u_device_pixel_ratio:new Wi(d),u_width_scale:new Wi(d),u_floor_width_scale:new Wi(d),u_image:new _g(d),u_units_to_pixels:new el(d),u_tile_units_to_pixels:new Wi(d),u_alpha_discard_threshold:new Wi(d),u_trim_offset:new el(d),u_trim_fade_range:new el(d),u_trim_color:new xg(d),u_emissive_strength:new Wi(d),u_zbias_factor:new Wi(d),u_tile_to_meter:new Wi(d)}),i.cW=x1,i.cX=ode,i.cY=ade,i.cZ=ep,i.c_=(d,o,c,f,m,p)=>{const v=d.transform,T=v.projection.name==="globe";let M;if(p.paint.get("circle-pitch-alignment")==="map")if(T){const w=rs(v.zoom,o.canonical)*v._pixelsPerMercatorPixel;M=Float32Array.from([w,0,0,w])}else M=v.calculatePixelsToTileUnitsMatrix(c);else M=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const k={u_camera_to_center_distance:d.transform.getCameraToCenterDistance(v.projection),u_matrix:d.translatePosMatrix(o.projMatrix,c,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:gt.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:R1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:p.paint.get("circle-emissive-strength")};if(T){k.u_inv_rot_matrix=f,k.u_merc_center=m,k.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],k.u_zoom_transition=Va(v.zoom);const w=m[0]*$t,P=m[1]*$t;k.u_up_dir=v.projection.upVector(new Et(0,0,0),w,P)}return k},i.ca=Qv,i.cb=xg,i.cc=function(d,o,c){const f=Math.sqrt(d*d+o*o+c*c),m=f>0?Math.acos(c/f)*Ln:0;let p=d!==0||o!==0?Math.atan2(-o,-d)*Ln+90:0;return p<0&&(p+=360),[f,p,m]},i.cd=y,i.ce=lr,i.cf=Xr,i.cg=function(d){return[Math.pow(d[0],1/2.2),Math.pow(d[1],1/2.2),Math.pow(d[2],1/2.2)]},i.ch=function(d,o){return d.readFields(Qde,{icons:[]},o)},i.ci=function(d){return d({pluginStatus:Ua,pluginURL:td}),Bf.on("pluginStateChange",d),d},i.cj=zA,i.ck=o_,i.cl=uL,i.cm=gf,i.cn=sg,i.co=Kt,i.cp=bs,i.cq=go,i.cr=function(d){const o=d.indexOf(Bv);return o>=0?d.slice(0,o):d},i.cs=function(d){return d.indexOf(Bv)>=0},i.ct=function(d){const o=d.indexOf(Bv);return o>=0?d.slice(o+1):""},i.cu=function(d){const o=[],c=d.id;return c===void 0&&o.push({message:`layers.${c}: missing required property "id"`}),d.render===void 0&&o.push({message:`layers.${c}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},i.cv=function(d,o,c,f){return d.type==="custom"?new Fde(d,o):new Yde[d.type](d,o,c,f)},i.cw=vs,i.cx=class extends g_{constructor(d,o){super(d._vectorTileFeature,d._z,d._x,d._y,d.id),d.state&&(this.state=Object.assign({},d.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=d.source,this.sourceLayer=d.sourceLayer,this.layer=d.layer)}toJSON(){const d=super.toJSON();return d.target=this.target,d.namespace=this.namespace,d}},i.cy=Bf,i.cz=Zs,i.d=function(d){return fe.API_TILEJSON_REGEX.test(d)},i.d$=OW,i.d0=fa,i.d1=(d,o,c,f,m,p,v,T)=>{const M=d.transform,k=M.pitch<15?vV(.07,.7,Yt((14-M.zoom)/5,0,1)):.07,w=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:xV(d,o,c,f),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:m,u_width_scale:p,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:_V(o,M),u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(w?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:k,u_tile_to_meter:y(o.tileID.canonical,0)}},i.d2=(d,o,c,f,m,p,v,T,M)=>{const k=d.transform,w=k.calculatePixelsToTileUnitsMatrix(o),P=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none",D=k.pitch<15?vV(.07,.7,Yt((14-k.zoom)/5,0,1)):.07;return{u_matrix:xV(d,o,c,f),u_pixels_to_tile_units:w,u_device_pixel_ratio:p,u_width_scale:v,u_floor_width_scale:T,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:wV(c)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:_V(o,d.transform),u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(P?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:y(o.tileID.canonical,0)}},i.d3=la,i.d4=L1,i.d5=k1,i.d6=lV,i.d7=qt,i.d8=fA,i.d9=np,i.dA=uA,i.dB=dr,i.dC=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.dD=ar,i.dE=zD,i.dF=uh,i.dG=function([d,o,c]){const f=Math.hypot(d,o,c),m=Math.atan2(d,c),p=.5*Math.PI-Math.acos(-o/f);return new bn(vt(m),vt(p))},i.dH=TL,i.dI=function(d){const o=d.navigator?d.navigator.userAgent:null;return!!function(c){if(ao==null){const f=c.navigator?c.navigator.userAgent:null;ao=!!c.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return ao}(d)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dJ=function(d,o){Dr=d,Ur=o},i.dK=ns,i.dL=rl,i.dM=function(d){const o=[0,0,0],c=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(c,d.pixelMatrix,d.globeMatrix),ge.vec3.transformMat4(o,o,c),new xt(o[0],o[1])},i.dN=function(d,o,c=!1){if(Ua===o1||Ua===dc||Ua===a1)throw new Error("setRTLTextPlugin cannot be called multiple times.");td=gt.resolveURL(d),Ua=o1,s1=o,Lv(),c||z2()},i.dO=Nv,i.dP=function(){zA().acquire(IL)},i.dQ=function(){const d=iw;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(IL),iw=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dR=Pg,i.dS=function(d){const o=bi();if(!o)return;const c=o.delete(rr);d&&c.catch(d).then(()=>d())},i.dT=nw,i.dU=bW,i.dV=function(d){FL=gt.resolveURL(d),m_||(m_=new u_(zA(),new Il)),m_.broadcast("setDracoUrl",FL)},i.dW=wW,i.dX=function(d){p_=gt.resolveURL(d),m_||(m_=new u_(zA(),new Il)),m_.broadcast("setMeshoptUrl",p_)},i.dY=Qt,i.dZ=tp,i.d_=au,i.da=450,i.db=7,i.dc=jde,i.dd=xn,i.de=Xv,i.df=256,i.dg=vo,i.dh=Dl,i.di=Ja,i.dj=Gv,i.dk=function(d,o,c,f,m){return Yt((d-o)/(c-o)*(m-f)+f,f,m)},i.dl=Gb,i.dm=ld,i.dn=class{constructor(d,o,c,f){this.context=d,this.format=f,this.size=c,this.texture=d.gl.createTexture();const[m,p,v]=this.size,{gl:T}=d;T.bindTexture(T.TEXTURE_3D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,m,p,v,0,xL(this.format),bL(this.format),o.data)}bind(d,o){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_3D,this.texture),d!==this.minFilter&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,d),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,d),this.minFilter=d),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}},i.dp=EL,i.dq=[1,1,1],i.dr=c_,i.ds=l_,i.dt=id,i.du=Xf,i.dv=dh,i.dw=S1,i.dx=w1,i.dy=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new xt(1/0,1/0),max:new xt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(d,o=!1){const c=G6(new xt(0,0),new xt($t,$t),d),f=[];if(o&&!YD(c,this._globalClipBounds))return f;for(const m of this._activeRegions){if(m.hiddenByOverlap||!YD(c,m))continue;const p=kue(m.min,m.max,d);f.push({min:p.min,max:p.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return f}setSources(d){this._setSources(d.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const c=[];for(const f of o.cache.getVisibleCoordinates()){const m=o.cache.getTile(f).buckets[o.layer];m&&m.updateFootprints(f.toUnwrapped(),c)}return c},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(d){const o=d.getFootprints();if(o.length===0)return;const c=d.getOrder(),f=d.getClipMask(),m=d.getClipScope();for(const p of o){if(!p.footprint)continue;const v=G6(p.footprint.min,p.footprint.max,p.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:p.id,footprint:p.footprint,order:c,clipMask:f,clipScope:m})}this._sourceIds.push(d.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,c)=>o.priority-c.priority||dA(o.min,c.min)||dA(o.max,c.max)||o.order-c.order||o.clipMask-c.clipMask||function(f,m){const p=(v,T)=>v+T;return f.length-m.length||f.reduce(p,"").localeCompare(m.reduce(p,""))}(o.clipScope,c.clipScope));let d=this._activeRegions.length!==this._prevRegions.length;if(!d){let o=0;for(;!d&&o!==this._activeRegions.length;){const c=this._activeRegions[o],f=this._prevRegions[o];d=c.priority!==f.priority||!W6(c,f)||c.order!==f.order||c.clipMask!==f.clipMask||!un(c.clipScope,f.clipScope),++o}}if(d){++this._updateTime;for(const c of this._activeRegions)c.order!==uA&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,c.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,c.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,c.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,c.max.y));const o=c=>{const f=this._activeRegions;if(c>=f.length)return c;const m=f[c].priority;for(;c<f.length&&f[c].priority===m;)++c;return c};if(this._sourceIds.length>1){let c=0,f=o(c);for(;c!==f;){let m=c;const p=c;for(;m!==f;){const v=this._activeRegions[m];v.hiddenByOverlap=!1;for(let T=0;T<p;T++){const M=this._activeRegions[T];if(!M.hiddenByOverlap&&v.order===uA&&YD(v,M)&&(v.hiddenByOverlap=H6(v.footprint,v.tileId,M.footprint,M.tileId),v.hiddenByOverlap))break}++m}c=f,f=o(c)}}}}_setSources(d){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=d.length-1;o>=0;o--)this._addSource(d[o]);this._computeReplacement()}},i.dz=class{constructor(d){this._createGrid(d),this._createPoles(d)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const d of this._poleSegments)d.destroy();for(const d of this._gridSegments)d.withSkirts.destroy(),d.withoutSkirts.destroy()}_fillGridMeshWithLods(d,o){const c=new Qc,f=new qo,m=[],p=d+1+2,v=o[0]+1,T=o[0]+1+(1+o.length),M=(k,w,P)=>{let D=k===p-1?k-2:k===0?k:k-1;return D+=P?24575:0,[D,w]};for(let k=0;k<p;++k)c.emplaceBack(...M(k,0,!0));for(let k=0;k<v;++k)for(let w=0;w<p;++w)c.emplaceBack(...M(w,k,(w===0||w===p-1)&&!0));for(let k=0;k<o.length;++k){const w=o[k];for(let P=0;P<p;++P)c.emplaceBack(...M(P,w,!0))}for(let k=0;k<o.length;++k){const w=f.length,P=o[k]+1+2,D=new qo;for(let N=0;N<P-1;N++){const W=N===P-2,Z=W?p*(T-o.length+k-N):p;for(let te=0;te<p-1;te++){const ee=N*p+te;N===0||W||te===0||te===p-2?(D.emplaceBack(ee+1,ee,ee+Z),D.emplaceBack(ee+Z,ee+Z+1,ee+1)):(f.emplaceBack(ee+1,ee,ee+Z),f.emplaceBack(ee+Z,ee+Z+1,ee+1))}}const O=hi.simpleSegment(0,w,c.length,f.length-w);for(let N=0;N<D.uint16.length;N+=3)f.emplaceBack(D.uint16[N],D.uint16[N+1],D.uint16[N+2]);const R=hi.simpleSegment(0,w,c.length,f.length-w);m.push({withoutSkirts:O,withSkirts:R})}return{vertices:c,indices:f,segments:m}}_createGrid(d){const o=this._fillGridMeshWithLods(Jf,Jv);this._gridSegments=o.segments,this._gridBuffer=d.createVertexBuffer(o.vertices,xr.members),this._gridIndexBuffer=d.createIndexBuffer(o.indices,!0)}_createPoles(d){const o=new qo;for(let v=0;v<=Jf;v++)o.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=d.createIndexBuffer(o,!0);const c=new Ja,f=new Ja,m=new Ja,p=new Ja;this._poleSegments=[];for(let v=0,T=0;v<Kf;v++){const M=360/(1<<v);c.emplaceBack(0,-Oa,0,.5,0),f.emplaceBack(0,-Oa,0,.5,1),m.emplaceBack(0,-Oa,0,.5,.5),p.emplaceBack(0,-Oa,0,.5,.5);for(let k=0;k<=Jf;k++){let w=k/Jf,P=0;const D=br(0,M,w),[O,R,N]=Qf(mc,nu,D,Oa);c.emplaceBack(O,R,N,w,P),f.emplaceBack(O,R,N,w,1-P);const W=Ge(D);w=.5+.5*Math.sin(W),P=.5+.5*Math.cos(W),m.emplaceBack(O,R,N,w,P),p.emplaceBack(O,R,N,w,1-P)}this._poleSegments.push(hi.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=d.createVertexBuffer(c,sr,!1),this._poleSouthVertexBuffer=d.createVertexBuffer(f,sr,!1),this._texturedPoleNorthVertexBuffer=d.createVertexBuffer(m,sr,!1),this._texturedPoleSouthVertexBuffer=d.createVertexBuffer(p,sr,!1)}getGridBuffers(d,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[d].withSkirts:this._gridSegments[d].withoutSkirts]}getPoleBuffers(d,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[d]]}},i.e=fe,i.e0=kW,i.e1=pV,i.e2=Tg,i.e3="hd_road_elevation",i.e4=class{static parseFrom(d,o){const c=hh.parse(d);if(!c)return[];let{vertices:f,features:m}=c;const p=1/y(o);m.sort((k,w)=>k.id-w.id),f.sort((k,w)=>k.id-w.id||k.idx-w.idx),f=f.filter((k,w,P)=>w===P.findIndex(D=>D.id===k.id&&D.idx===k.idx));const v=new Array;let T=0;const M=f.length;for(const k of m){if(k.constantHeight){v.push(new qD(k.id,k.bounds,k.constantHeight));continue}for(;T!==M&&f[T].id<k.id;)T++;if(T===M||f[T].id!==k.id)continue;const w=new Array,P=new Array,D=T;for(;T!==M&&f[T].id===k.id;){const O=f[T];if(w.push({position:O.position,height:O.height,extent:O.extent}),T!==D&&f[T-1].idx===O.idx-1){const R=T-D;P.push({a:R-1,b:R})}T++}v.push(new qD(k.id,k.bounds,void 0,w,P,p))}return v}},i.e5=Ba,i.e6=Eg,i.e7=WV,i.e8=i_,i.e9=function(d,o,c,f,m,p,v,T=1,M){d.createArrays(),d.tilePixelRatio=$t/(512*d.overscaling),d.compareText={},d.iconsNeedLinear=!1;const k=d.layers[0].layout,w=d.layers[0]._unevaluatedLayout._values,P={};P.scaleFactor=T,P.textSizeScaleRange=k.get("text-size-scale-range"),P.iconSizeScaleRange=k.get("icon-size-scale-range");const[D,O]=P.textSizeScaleRange,[R,N]=P.iconSizeScaleRange;P.textScaleFactor=Yt(P.scaleFactor,D,O),P.iconScaleFactor=Yt(P.scaleFactor,R,N);const W=w["text-size"],Z=w["icon-size"];if(d.textSizeData.kind==="composite"){const{minZoom:he,maxZoom:we}=d.textSizeData;P.compositeTextSizes=[W.possiblyEvaluate(new Hn(he),p),W.possiblyEvaluate(new Hn(we),p)]}if(d.iconSizeData.kind==="composite"){const{minZoom:he,maxZoom:we}=d.iconSizeData;P.compositeIconSizes=[Z.possiblyEvaluate(new Hn(he),p),Z.possiblyEvaluate(new Hn(we),p)]}P.layoutTextSize=W.possiblyEvaluate(new Hn(v+1),p),P.layoutIconSize=Z.possiblyEvaluate(new Hn(v+1),p),P.textMaxSize=W.possiblyEvaluate(new Hn(18),p);const te=k.get("symbol-placement"),ee=k.get("text-rotation-alignment")==="map"&&te!=="point",K=k.get("text-size");let ie=!1;const le=[];for(const he of d.features){const we=k.get("text-font").evaluate(he,{},p).join(","),_e=K.evaluate(he,{},p)*P.textScaleFactor,xe=P.layoutTextSize.evaluate(he,{},p)*P.textScaleFactor,De=P.layoutIconSize.evaluate(he,{},p)*P.iconScaleFactor,Se={horizontal:{},vertical:void 0},Le=he.text;let We,Ue=[0,0];if(Le){const It=Le.toString(),_r=k.get("text-letter-spacing").evaluate(he,{},p)*na,Xt=k.get("text-line-height").evaluate(he,{},p)*na,or=TD(It)?_r:0,Cr=k.get("text-anchor").evaluate(he,{},p),Gr=k.get("text-variable-anchor");if(!Gr){const gn=k.get("text-radial-offset").evaluate(he,{},p);Ue=gn?KV(Cr,[gn*na,dL]):k.get("text-offset").evaluate(he,{},p).map(Zn=>Zn*na)}let Ir=ee?"center":k.get("text-justify").evaluate(he,{},p);const Qr=te==="point",Wr=Qr?k.get("text-max-width").evaluate(he,{},p)*na:1/0,tn=gn=>{d.allowVerticalPlacement&&r1(It)&&(Se.vertical=lL(Le,o,c,m,we,Wr,Xt,Cr,gn,or,Ue,Ms.vertical,!0,xe,_e,M))};if(!ee&&Gr){const gn=Ir==="auto"?Gr.map(Mr=>hL(Mr)):[Ir];let Zn=!1;for(let Mr=0;Mr<gn.length;Mr++){const ln=gn[Mr];if(!Se.horizontal[ln])if(Zn)Se.horizontal[ln]=Se.horizontal[0];else{const li=lL(Le,o,c,m,we,Wr,Xt,"center",ln,or,Ue,Ms.horizontal,!1,xe,_e,M);li&&(Se.horizontal[ln]=li,Zn=li.positionedLines.length===1)}}tn("left")}else{if(Ir==="auto"&&(Ir=hL(Cr)),Qr||k.get("text-writing-mode").indexOf("horizontal")>=0||!r1(It)){const gn=lL(Le,o,c,m,we,Wr,Xt,Cr,Ir,or,Ue,Ms.horizontal,!1,xe,_e,M);gn&&(Se.horizontal[Ir]=gn)}tn(Qr?"left":Ir)}}let Xe,He,nt,Je,it,Mt=!1;if(he.icon&&he.icon.hasPrimary()){const It=QV(he.icon,d.iconSizeData,w["icon-size"],p,d.zoom,he,M,P.iconScaleFactor);Xe=It.iconPrimary,He=It.iconSecondary;const _r=Xe.toString(),Xt=f.get(_r);Xt&&(nt=k.get("icon-offset").evaluate(he,{},p),Je=k.get("icon-anchor").evaluate(he,{},p),it=k.get("icon-text-fit").evaluate(he,{},p),We=gde(m.get(_r),He?m.get(He.toString()):void 0,nt,Je),Mt=Xt.sdf,d.sdfIcons===void 0?d.sdfIcons=Xt.sdf:d.sdfIcons!==Xt.sdf&&ai("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xt.pixelRatio!==d.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(d.iconsNeedLinear=!0))}ie=ie||!(!he.icon||!he.icon.hasSecondary());const At=fL(Se.horizontal)||Se.vertical;d.iconsInText||(d.iconsInText=!!At&&At.iconsInText);const er=xe*P.textScaleFactor/na,{defaultShapedIcon:Rt,verticallyShapedIcon:Ft}=Tde(d,We,k,he,p,Se,er,nt,it);We=Rt,le.push({feature:he,shapedTextOrientations:Se,shapedText:At,shapedIcon:We,iconPrimary:Xe,iconSecondary:He,iconOffset:nt,iconAnchor:Je,verticallyShapedIcon:Ft,layoutTextSize:xe,layoutIconSize:De,textOffset:Ue,isSDFIcon:Mt,iconTextFit:it})}return{featureData:le,sizes:P,hasAnySecondaryIcon:ie,textAlongLine:ee,symbolPlacement:te}},i.ea=GV,i.eb=function(d,o,c,f,m,p,v,T,M,k){const{featureData:w,hasAnySecondaryIcon:P,sizes:D,textAlongLine:O,symbolPlacement:R}=o;for(const N of w){const{shapedIcon:W,verticallyShapedIcon:Z,feature:te,shapedTextOrientations:ee,shapedText:K,layoutTextSize:ie,textOffset:le,isSDFIcon:he,iconPrimary:we,iconSecondary:_e,iconTextFit:xe,iconOffset:De}=N;e8(W,k.iconPositions,we,_e),e8(Z,k.iconPositions,we,_e),Sde(ee,k.iconPositions),(K||W)&&Ede(d,te,ee,W,Z,M,D,ie,0,le,he,f,m,v,T,P,xe,De,O,R)}c&&d.generateCollisionDebugBuffers(p,d.collisionBoxArray,D.textScaleFactor)},i.ec=rp,i.ed=WA,i.ee=tr,i.ef=O6,i.eg=PV,i.eh=_,i.ei=function(d){let o=0;if(new Uint32Array(d,0,1)[0]!==TW){const c=new Uint32Array(d,0,7),[,,f,m,p,v]=c;o=c.byteLength+m+p+v+p,(f!==d.byteLength||o>=d.byteLength)&&ai("Invalid b3dm header information.")}return MW(d,o)},i.ej=function(d,o){const c=IW(d);for(const f of c){for(const m of f.meshes)Qhe(m);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(efe(f.lights,o)))}return c},i.ek=NA,i.el=V8,i.em=Js,i.en=function(d){en(),qr!=null&&qr.then(o=>{o.keys().then(c=>{for(let f=0;f<c.length-d;f++)o.delete(c[f])})})},i.f=function(d){return d.indexOf("mapbox:")===0},i.g=function(d,o){return Zs(Ti(d,{method:"GET"}),o)},i.h=ye,i.i=function(d){return fe.API_STYLE_REGEX.test(d)&&!Me(d)},i.j=function(d){return decodeURIComponent(atob(d).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(d){return btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(o,c)=>String.fromCharCode(+("0x"+c))))},i.l=Ti,i.m=In,i.n=function(d,o){return Zs(Ti(d,{type:"json"}),o)},i.o=_b,i.p=function(d,o){return Zs(Ti(d,{method:"POST"}),o)},i.q=gt,i.r=ra,i.s=function(d){try{const o=self[d];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=_t,i.u=function(){return function d(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,d)}()},i.v=function(d){return!!d&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d)},i.w=ai,i.x=function(){return OL||(OL=new Pg),OL},i.y=LL,i.z=_f}),l(["./shared"],function(i){function _(ft){const fe=ft?ft.url.toString():void 0;return fe?performance.getEntriesByName(fe):[]}function b(ft){if(typeof ft=="number"||typeof ft=="boolean"||typeof ft=="string"||ft==null)return JSON.stringify(ft);if(Array.isArray(ft)){let ye="[";for(const Me of ft)ye+=`${b(Me)},`;return`${ye}]`}let fe="{";for(const ye of Object.keys(ft).sort())fe+=`${ye}:${b(ft[ye])},`;return`${fe}}`}function E(ft){let fe="";for(const ye of i.bm)(ft.type!=="model"||ye!=="minzoom"&&ye!=="maxzoom")&&(fe+=`/${b(ft[ye])}`);return fe}class C{constructor(fe){this.keyCache={},this._layers={},this._layerConfigs={},fe&&this.replace(fe)}replace(fe,ye){this._layerConfigs={},this._layers={},this.update(fe,[],ye)}update(fe,ye,Me){this._options=Me;for(const Ne of fe)this._layerConfigs[Ne.id]=Ne,(this._layers[Ne.id]=i.cv(Ne,this.scope,null,this._options)).compileFilter(Me),this.keyCache[Ne.id]&&delete this.keyCache[Ne.id];for(const Ne of ye)delete this.keyCache[Ne],delete this._layerConfigs[Ne],delete this._layers[Ne];this.familiesBySource={};const $e=function(Ne,qe){const ut={};for(let pt=0;pt<Ne.length;pt++){const _t=Ne[pt];let gt=qe&&qe[_t.id];!gt&&(gt=E(_t),_t.type==="line"&&_t.paint)&&function Kt(rr){return typeof rr=="string"&&rr==="line-progress"||(Array.isArray(rr)?rr.some(Kt):!(!rr||typeof rr!="object")&&Object.values(rr).some(Kt))}(_t.paint["line-width"])&&(gt+=`/${b(_t.paint["line-width"])}`),qe&&(qe[_t.id]=gt);let Nt=ut[gt];Nt||(Nt=ut[gt]=[]),Nt.push(_t)}const Ye=[];for(const pt in ut)Ye.push(ut[pt]);return Ye}(Object.values(this._layerConfigs),this.keyCache);for(const Ne of $e){const qe=Ne.map(Nt=>this._layers[Nt.id]),ut=qe[0];if(ut.visibility==="none")continue;const Ye=ut.source||"";let pt=this.familiesBySource[Ye];pt||(pt=this.familiesBySource[Ye]={});const _t=ut.sourceLayer||"_geojsonTileLayer";let gt=pt[_t];gt||(gt=pt[_t]=[]),gt.push(qe)}}}const I=1*i.d_;class F{constructor(fe){const ye={},Me=[];for(const ut in fe){const Ye=fe[ut],pt=ye[ut]={};for(const _t in Ye.glyphs){const gt=Ye.glyphs[+_t];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const Nt=gt.metrics.localGlyph?I:1,Kt={x:0,y:0,w:gt.bitmap.width+2*Nt,h:gt.bitmap.height+2*Nt};Me.push(Kt),pt[_t]=Kt}}const{w:$e,h:Ne}=i.H(Me),qe=new i.dZ({width:$e||1,height:Ne||1});for(const ut in fe){const Ye=fe[ut];for(const pt in Ye.glyphs){const _t=Ye.glyphs[+pt];if(!_t||_t.bitmap.width===0||_t.bitmap.height===0)continue;const gt=ye[ut][pt],Nt=_t.metrics.localGlyph?I:1;i.dZ.copy(_t.bitmap,qe,{x:0,y:0},{x:gt.x+Nt,y:gt.y+Nt},_t.bitmap)}}this.image=qe,this.positions=ye}}i.dY(F,"GlyphAtlas");class ${constructor(fe){this.tileID=new i.aH(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.tileZoom=fe.tileZoom,this.uid=fe.uid,this.zoom=fe.zoom,this.lut=fe.lut,this.canonical=fe.tileID.canonical,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.scope=fe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=fe.showCollisionBoxes,this.collectResourceTiming=!!fe.request&&fe.request.collectResourceTiming,this.promoteId=fe.promoteId,this.isSymbolTile=fe.isSymbolTile,this.tileTransform=i.aR(fe.tileID.canonical,fe.projection),this.projection=fe.projection,this.worldview=fe.worldview,this.localizableLayerIds=fe.localizableLayerIds,this.brightness=fe.brightness,this.extraShadowCaster=!!fe.extraShadowCaster,this.tessellationStep=fe.tessellationStep,this.scaleFactor=fe.scaleFactor}parse(fe,ye,Me,$e,Ne){this.status="parsing",this.data=fe,this.collisionBoxArray=new i.aX;const qe=new i.d$(Object.keys(fe.layers).sort()),ut=new i.e0(this.tileID,this.promoteId);ut.bucketLayerIDs=[];const Ye={},pt=new i.e1(256,256),_t={featureIndex:ut,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:pt,availableImages:Me,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},gt=ye.familiesBySource[this.source];for(const en in gt){const Pn=fe.layers[en];if(!Pn)continue;let In=!1,Rn=!1,ji=!1;for(const Pa of gt[en])Pa[0].type==="symbol"?In=!0:Rn=!0,Pa[0].is3D()&&Pa[0].type!=="model"&&(ji=!0);if(this.extraShadowCaster&&!ji||this.isSymbolTile===!0&&!In||this.isSymbolTile===!1&&!Rn)continue;Pn.version===1&&i.w(`Vector tile source "${this.source}" layer "${en}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Do=qe.encode(en),ua=[];let Hs=!1;for(let Pa=0,Lo=0;Pa<Pn.length;Pa++){const Go=Pn.feature(Pa),gf=ut.getId(Go,en);if(this.localizableLayerIds&&this.localizableLayerIds.has(en)){const Zs=Go.properties?Go.properties.worldview:null;if(this.worldview&&typeof Zs=="string")if(Zs==="all")Go.properties.$localized=!0;else{if(!Zs.split(",").includes(this.worldview))continue;Go.properties.$localized=!0,Go.properties.worldview=this.worldview}}!Hs&&Go.properties&&Go.properties.hasOwnProperty(i.e2)&&(Hs=!0),ua.push({feature:Go,id:gf,index:Lo,sourceLayerIndex:Do}),Lo++}Hs&&!_t.elevationFeatures&&fe.layers.hasOwnProperty(i.e3)&&(_t.elevationFeatures=i.e4.parseFrom(fe.layers[i.e3],this.canonical));for(const Pa of gt[en]){const Lo=Pa[0];(!this.extraShadowCaster||Lo.is3D()&&Lo.type!=="model")&&(this.isSymbolTile!==void 0&&Lo.type==="symbol"!==this.isSymbolTile||Lo.minzoom&&this.zoom<Math.floor(Lo.minzoom)||Lo.maxzoom&&this.zoom>=Lo.maxzoom||Lo.visibility!=="none"&&(B(Pa,this.zoom,_t.brightness,Me),(Ye[Lo.id]=Lo.createBucket({index:ut.bucketLayerIDs.length,layers:Pa,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Do,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(ua,_t,this.tileID.canonical,this.tileTransform),ut.bucketLayerIDs.push(Pa.map(Go=>i.C(Go.id,Go.scope)))))}}let Nt,Kt,rr,Dr,Ur,Vr;pt.trim();const qr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Jn=()=>{if(Nt)return this.status="done",Ne(Nt);if(this.extraShadowCaster)this.status="done",Ne(null,{buckets:Object.values(Ye).filter(en=>!en.isEmpty()),featureIndex:ut,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:_t.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Kt&&rr&&Dr){const en=new F(Kt),Pn=new Map;for(const[ji,Do]of rr.entries()){const{imagePosition:ua}=i.e7(ji,Do,i.e8);Pn.set(ji,ua)}const In={};for(const ji in Ye){const Do=Ye[ji];Do instanceof i.aY&&(B(Do.layers,this.zoom,_t.brightness,Me),In[ji]=i.e9(Do,Kt,en.positions,rr,Pn,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio))}const Rn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded($e,rr,Ur,()=>{Rn.iconsPending=!1,bi(In,en,Rn)}),this.rasterizeIfNeeded($e,Dr,Vr,()=>{Rn.patternsPending=!1,bi(In,en,Rn)})}},bi=(en,Pn,In,Rn)=>{if(In.iconsPending||In.patternsPending)return;const ji=new i.ea(rr,Dr,this.lut);for(const Do in Ye){const ua=Ye[Do];if(Do in en)i.eb(ua,en[Do],this.showCollisionBoxes,Me,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,rr,ji);else if(ua.hasPattern&&(ua instanceof i.b2||ua instanceof i.b3||ua instanceof i.d8)){B(ua.layers,this.zoom,_t.brightness,Me);const Hs=Object.fromEntries(ji.patternPositions);ua.addFeatures(_t,this.tileID.canonical,Hs,Me,this.tileTransform,this.brightness)}}this.status="done",Ne(null,{buckets:Object.values(Ye).filter(Do=>!Do.isEmpty()),featureIndex:ut,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pn.image,lineAtlas:pt,imageAtlas:ji,brightness:_t.brightness})};if(!this.extraShadowCaster){const en=i.e5(_t.glyphDependencies,Rn=>Object.keys(Rn).map(Number));Object.keys(en).length?$e.send("getGlyphs",{uid:this.uid,stacks:en,scope:this.scope},(Rn,ji)=>{Nt||(Nt=Rn,Kt=ji,Jn())},void 0,!1,qr):Kt={};const Pn=Array.from(_t.iconDependencies.keys()).map(Rn=>i.I.parse(Rn));Pn.length?$e.send("getImages",{images:Pn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Rn,ji)=>{Nt||(Nt=Rn,rr=new Map,Ur=this.updateImageMapAndGetImageTaskQueue(rr,ji,_t.iconDependencies),Jn())},void 0,!1,qr):(rr=new Map,Ur=new Map);const In=Array.from(_t.patternDependencies.keys()).map(Rn=>i.I.parse(Rn));In.length?$e.send("getImages",{images:In,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Rn,ji)=>{Nt||(Nt=Rn,Dr=new Map,Vr=this.updateImageMapAndGetImageTaskQueue(Dr,ji,_t.patternDependencies),Jn())},void 0,!1,qr):(Dr=new Map,Vr=new Map)}if(_t.elevationFeatures&&_t.elevationFeatures.length>0){const en=[];for(const In of Object.values(Ye))if(In instanceof i.b3){const Rn=In.getUnevaluatedPortalGraph();Rn&&en.push(Rn)}const Pn=i.e6.evaluate(en);for(const In of Object.values(Ye))In instanceof i.b3&&In.setEvaluatedPortalGraph(Pn)}Jn()}rasterizeIfNeeded(fe,ye,Me,$e){Array.from(ye.values()).some(Ne=>Ne.usvg)?this.rasterize(fe,ye,Me,$e):$e()}updateImageMapAndGetImageTaskQueue(fe,ye,Me){const $e=new Map;for(const Ne of ye.keys()){const qe=Me.get(Ne)||[];for(const ut of qe){const Ye=ut.toString(),pt=ye.get(ut.id.toString());pt.usvg?$e.has(Ye)||($e.set(Ye,ut),fe.set(Ye,Object.assign({},pt))):fe.set(Ye,pt)}}return $e}rasterize(fe,ye,Me,$e){this.rasterizeTask=fe.send("rasterizeImages",{scope:this.scope,tasks:Me},(Ne,qe)=>{if(!Ne)for(const[ut,Ye]of qe.entries()){const pt=Object.assign(ye.get(ut),{data:Ye});ye.set(ut,pt)}$e()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function B(ft,fe,ye,Me){const $e=new i.aa(fe,{brightness:ye});for(const Ne of ft)Ne.recalculate($e,Me)}class q extends i.E{constructor(fe,ye,Me,$e,Ne,qe){super(),this.actor=fe,this.layerIndex=ye,this.availableImages=Me,this.loadVectorData=Ne||i.aE,this.loading={},this.loaded={},this.deduped=new i.aD(fe.scheduler),this.isSpriteLoaded=$e,this.scheduler=fe.scheduler,this.brightness=qe}loadTile(fe,ye){const Me=fe.uid,$e=fe&&fe.request,Ne=$e&&$e.collectResourceTiming,qe=this.loading[Me]=new $(fe);qe.abort=this.loadVectorData(fe,(ut,Ye)=>{const pt=!this.loading[Me];if(delete this.loading[Me],qe.cancelRasterize(),pt||ut||!Ye)return qe.status="done",pt||(this.loaded[Me]=qe),ye(ut);const _t=Ye.rawData,gt={};Ye.expires&&(gt.expires=Ye.expires),Ye.cacheControl&&(gt.cacheControl=Ye.cacheControl),qe.vectorTile=Ye.vectorTile||new i.ec.VectorTile(new i.bi(_t));const Nt=()=>{qe.parse(qe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Kt,rr)=>{if(Kt||!rr)return ye(Kt);const Dr={};if(Ne){const Ur=_($e);Ur.length>0&&(Dr.resourceTiming=JSON.parse(JSON.stringify(Ur)))}ye(null,i.l({rawTileData:_t.slice(0)},rr,gt,Dr))})};this.isSpriteLoaded?Nt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Nt,{type:"parseTile",isSymbolTile:fe.isSymbolTile,zoom:fe.tileZoom}):Nt()}),this.loaded=this.loaded||{},this.loaded[Me]=qe})}reloadTile(fe,ye){const Me=this.loaded,$e=fe.uid;if(Me&&Me[$e]){const Ne=Me[$e];Ne.scaleFactor=fe.scaleFactor,Ne.showCollisionBoxes=fe.showCollisionBoxes,Ne.projection=fe.projection,Ne.brightness=fe.brightness,Ne.tileTransform=i.aR(fe.tileID.canonical,fe.projection),Ne.extraShadowCaster=fe.extraShadowCaster,Ne.lut=fe.lut;const qe=(ut,Ye)=>{const pt=Ne.reloadCallback;pt&&(delete Ne.reloadCallback,Ne.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor,pt)),ye(ut,Ye)};Ne.status==="parsing"?Ne.reloadCallback=qe:Ne.status==="done"&&(Ne.vectorTile?Ne.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor,qe):qe())}else ye(null,void 0)}abortTile(fe,ye){const Me=fe.uid,$e=this.loading[Me];$e&&($e.abort&&$e.abort(),delete this.loading[Me]),ye()}removeTile(fe,ye){const Me=this.loaded,$e=fe.uid;Me&&Me[$e]&&delete Me[$e],ye()}}class G{loadTile(fe,ye){const{uid:Me,encoding:$e,rawImageData:Ne,padding:qe}=fe,ut=ImageBitmap&&Ne instanceof ImageBitmap?this.getImageData(Ne,qe):Ne;ye(null,new i.ed(Me,ut,$e,qe<1))}reloadTile(fe,ye){ye(null,null)}abortTile(fe,ye){ye()}removeTile(fe,ye){ye()}getImageData(fe,ye){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(fe.width,fe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=fe.width,this.offscreenCanvas.height=fe.height,this.offscreenCanvasContext.drawImage(fe,0,0,fe.width,fe.height);const Me=this.offscreenCanvasContext.getImageData(-ye,-ye,fe.width+2*ye,fe.height+2*ye);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Me}}i.bh.setPbf(i.bi);class H{constructor(fe){this._mrt=new i.bh(fe.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=fe.uid,this.tileID=fe.tileID,this.source=fe.source}parse(fe,ye){const Me=this._mrt;this.status="parsing",this._entireBuffer=fe;try{Me.parseHeader(fe),this._isHeaderLoaded=!0;const $e=[];for(const Ne in Me.layers){const qe=Me.getLayer(Ne),ut=qe.getDataRange(qe.getBandList()),Ye=Me.createDecodingTask(ut),pt=fe.slice(ut.firstByte,ut.lastByte+1),_t=i.bh.performDecoding(pt,Ye).then(gt=>Ye.complete(null,gt)).catch(gt=>Ye.complete(gt,null));$e.push(_t)}Promise.allSettled($e).then(()=>ye(null,Me))}catch($e){ye($e)}}}class J{constructor(fe){this.actor=fe,this.loading={},this.loaded={}}loadTile(fe,ye){const Me=fe.uid,$e=fe.request,Ne=this.loading[Me]=new H(fe),{cancel:qe}=i.bj($e,(ut,Ye,pt,_t)=>{const gt=!this.loading[Me];if(delete this.loading[Me],gt||ut||!Ye)return Ne.status="done",gt||(this.loaded[Me]=Ne),ye(ut);Ne.parse(Ye,(Nt,Kt)=>{if(Nt||!Kt)return ye(Nt);ye(null,Kt,pt,_t)}),this.loaded[Me]=Ne});Ne.abort=qe}reloadTile(fe,ye){ye(null,void 0)}abortTile(fe,ye){const Me=fe.uid,$e=this.loading[Me];$e&&($e.abort&&$e.abort(),delete this.loading[Me]),ye()}removeTile(fe,ye){const Me=fe.uid;this.loaded[Me]&&delete this.loaded[Me],ye()}decodeRasterArray({task:fe,buffer:ye},Me){i.bh.performDecoding(ye,fe).then($e=>Me(null,$e)).catch($e=>Me($e))}}const Q=i.ec.VectorTileFeature.prototype.toGeoJSON;class oe{constructor(fe){this._feature=fe,this.extent=i.ai,this.type=fe.type,this.properties=fe.tags,"id"in fe&&!isNaN(fe.id)&&(this.id=parseInt(fe.id,10))}loadGeometry(){if(this._feature.type===1){const fe=[];for(const ye of this._feature.geometry)fe.push([new i.P(ye[0],ye[1])]);return fe}{const fe=[];for(const ye of this._feature.geometry){const Me=[];for(const $e of ye)Me.push(new i.P($e[0],$e[1]));fe.push(Me)}return fe}}toGeoJSON(fe,ye,Me){return Q.call(this,fe,ye,Me)}}class de{constructor(fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ai,this.length=fe.length,this._features=fe}feature(fe){return new oe(this._features[fe])}}const ae=64/4096,ve=128;class Fe{constructor(){this.features=new Map}clear(){this.features.clear()}load(fe=[],ye){for(const Me of fe){const $e=Me.id;if($e==null)continue;let Ne=this.features.get($e);Ne&&this.updateCache(Ne,ye),Me.geometry?(Ne=Ce(Me),this.updateCache(Ne,ye),this.features.set($e,Ne)):this.features.delete($e),this.updateCache(Ne,ye)}}updateCache(fe,ye){for(const{canonical:Me,uid:$e}of Object.values(ye)){const{z:Ne,x:qe,y:ut}=Me;ke(fe,Math.pow(2,Ne),qe,ut)&&delete ye[$e]}}getTile(fe,ye,Me){const $e=Math.pow(2,fe),Ne=[];for(const qe of this.features.values())ke(qe,$e,ye,Me)&&Ne.push(Qe(qe,$e,ye,Me));return{features:Ne}}getFeatures(){return[...this.features.values()]}}function ke({minX:ft,minY:fe,maxX:ye,maxY:Me},$e,Ne,qe){return ft<(Ne+1+ae)/$e&&fe<(qe+1+ae)/$e&&ye>(Ne-ae)/$e&&Me>(qe-ae)/$e}function Ce(ft){const{id:fe,geometry:ye,properties:Me}=ft;if(!ye)return;if(ye.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:$e,coordinates:Ne}=ye,qe={id:fe,type:1,geometry:[],tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},ut=qe.geometry;if($e==="Point")je(Ne,ut,qe);else if($e==="MultiPoint")for(const Ye of Ne)je(Ye,ut,qe);else if($e==="LineString")qe.type=2,tt(Ne,ut,qe);else if($e==="MultiLineString")qe.type=2,Ze(Ne,ut,qe);else if($e==="Polygon")qe.type=3,Ze(Ne,ut,qe,!0);else{if($e!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");qe.type=3;for(const Ye of Ne)Ze(Ye,ut,qe,!0)}return qe}function je([ft,fe],ye,Me){const $e=i.av(ft);let Ne=i.aC(fe);Ne=Ne<0?0:Ne>1?1:Ne,ye.push($e,Ne),Me.minX=Math.min(Me.minX,$e),Me.minY=Math.min(Me.minY,Ne),Me.maxX=Math.max(Me.maxX,$e),Me.maxY=Math.max(Me.maxY,Ne)}function tt(ft,fe,ye,Me=!1,$e=!1){const Ne=[];for(const qe of ft)je(qe,Ne,ye);fe.push(Ne),Me&&function(qe,ut){let Ye=0;for(let pt=0,_t=qe.length,gt=_t-2;pt<_t;gt=pt,pt+=2)Ye+=(qe[pt]-qe[gt])*(qe[pt+1]+qe[gt+1]);if(Ye>0===ut)for(let pt=0,_t=qe.length;pt<_t/2;pt+=2){const gt=qe[pt],Nt=qe[pt+1];qe[pt]=qe[_t-2-pt],qe[pt+1]=qe[_t-1-pt],qe[_t-2-pt]=gt,qe[_t-1-pt]=Nt}}(Ne,$e)}function Ze(ft,fe,ye,Me=!1){for(let $e=0;$e<ft.length;$e++)tt(ft[$e],fe,ye,Me,$e===0)}function Qe(ft,fe,ye,Me){const{id:$e,type:Ne,geometry:qe,tags:ut}=ft,Ye=[];if(Ne===1)(function(pt,_t,gt,Nt,Kt){for(let rr=0;rr<pt.length;rr+=2){const Dr=Math.round(i.ai*(pt[rr+0]*_t-gt)),Ur=Math.round(i.ai*(pt[rr+1]*_t-Nt));Kt.push([Dr,Ur])}})(qe,fe,ye,Me,Ye);else for(const pt of qe)st(pt,fe,ye,Me,Ye);return{id:$e,type:Ne,geometry:Ye,tags:ut}}function st(ft,fe,ye,Me,$e){const Ne=-ve,qe=i.ai+ve;let ut;for(let Ye=0;Ye<ft.length-2;Ye+=2){let pt=Math.round(i.ai*(ft[Ye+0]*fe-ye)),_t=Math.round(i.ai*(ft[Ye+1]*fe-Me)),gt=Math.round(i.ai*(ft[Ye+2]*fe-ye)),Nt=Math.round(i.ai*(ft[Ye+3]*fe-Me));const Kt=gt-pt,rr=Nt-_t;pt<Ne&&gt<Ne||(pt<Ne?(_t+=Math.round(rr*((Ne-pt)/Kt)),pt=Ne):gt<Ne&&(Nt=_t+Math.round(rr*((Ne-pt)/Kt)),gt=Ne),_t<Ne&&Nt<Ne||(_t<Ne?(pt+=Math.round(Kt*((Ne-_t)/rr)),_t=Ne):Nt<Ne&&(gt=pt+Math.round(Kt*((Ne-_t)/rr)),Nt=Ne),pt>=qe&&gt>=qe||(pt>=qe?(_t+=Math.round(rr*((qe-pt)/Kt)),pt=qe):gt>=qe&&(Nt=_t+Math.round(rr*((qe-pt)/Kt)),gt=qe),_t>=qe&&Nt>=qe||(_t>=qe?(pt+=Math.round(Kt*((qe-_t)/rr)),_t=qe):Nt>=qe&&(gt=pt+Math.round(Kt*((qe-_t)/rr)),Nt=qe),ut&&pt===ut[ut.length-1][0]&&_t===ut[ut.length-1][1]||(ut=[[pt,_t]],$e.push(ut)),ut.push([gt,Nt])))))}}var ot,Be,lt,zt={exports:{}},Lt=function(){if(lt)return zt.exports;lt=1;var ft=i.eg(),fe=function(){if(Be)return ot;Be=1;var _t=i.ee(),gt=i.ef().VectorTileFeature;function Nt(rr,Dr){this.options=Dr||{},this.features=rr,this.length=rr.length}function Kt(rr,Dr){this.id=typeof rr.id=="number"?rr.id:void 0,this.type=rr.type,this.rawGeometry=rr.type===1?[rr.geometry]:rr.geometry,this.properties=rr.tags,this.extent=Dr||4096}return ot=Nt,Nt.prototype.feature=function(rr){return new Kt(this.features[rr],this.options.extent)},Kt.prototype.loadGeometry=function(){var rr=this.rawGeometry;this.geometry=[];for(var Dr=0;Dr<rr.length;Dr++){for(var Ur=rr[Dr],Vr=[],qr=0;qr<Ur.length;qr++)Vr.push(new _t(Ur[qr][0],Ur[qr][1]));this.geometry.push(Vr)}return this.geometry},Kt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var rr=this.geometry,Dr=1/0,Ur=-1/0,Vr=1/0,qr=-1/0,Jn=0;Jn<rr.length;Jn++)for(var bi=rr[Jn],en=0;en<bi.length;en++){var Pn=bi[en];Dr=Math.min(Dr,Pn.x),Ur=Math.max(Ur,Pn.x),Vr=Math.min(Vr,Pn.y),qr=Math.max(qr,Pn.y)}return[Dr,Vr,Ur,qr]},Kt.prototype.toGeoJSON=gt.prototype.toGeoJSON,ot}();function ye(_t){var gt=new ft;return function(Nt,Kt){for(var rr in Nt.layers)Kt.writeMessage(3,Me,Nt.layers[rr])}(_t,gt),gt.finish()}function Me(_t,gt){var Nt;gt.writeVarintField(15,_t.version||1),gt.writeStringField(1,_t.name||""),gt.writeVarintField(5,_t.extent||4096);var Kt={keys:[],values:[],keycache:{},valuecache:{}};for(Nt=0;Nt<_t.length;Nt++)Kt.feature=_t.feature(Nt),gt.writeMessage(2,$e,Kt);var rr=Kt.keys;for(Nt=0;Nt<rr.length;Nt++)gt.writeStringField(3,rr[Nt]);var Dr=Kt.values;for(Nt=0;Nt<Dr.length;Nt++)gt.writeMessage(4,pt,Dr[Nt])}function $e(_t,gt){var Nt=_t.feature;Nt.id!==void 0&&gt.writeVarintField(1,Nt.id),gt.writeMessage(2,Ne,_t),gt.writeVarintField(3,Nt.type),gt.writeMessage(4,Ye,Nt)}function Ne(_t,gt){var Nt=_t.feature,Kt=_t.keys,rr=_t.values,Dr=_t.keycache,Ur=_t.valuecache;for(var Vr in Nt.properties){var qr=Nt.properties[Vr],Jn=Dr[Vr];if(qr!==null){Jn===void 0&&(Kt.push(Vr),Dr[Vr]=Jn=Kt.length-1),gt.writeVarint(Jn);var bi=typeof qr;bi!=="string"&&bi!=="boolean"&&bi!=="number"&&(qr=JSON.stringify(qr));var en=bi+":"+qr,Pn=Ur[en];Pn===void 0&&(rr.push(qr),Ur[en]=Pn=rr.length-1),gt.writeVarint(Pn)}}}function qe(_t,gt){return(gt<<3)+(7&_t)}function ut(_t){return _t<<1^_t>>31}function Ye(_t,gt){for(var Nt=_t.loadGeometry(),Kt=_t.type,rr=0,Dr=0,Ur=Nt.length,Vr=0;Vr<Ur;Vr++){var qr=Nt[Vr],Jn=1;Kt===1&&(Jn=qr.length),gt.writeVarint(qe(1,Jn));for(var bi=Kt===3?qr.length-1:qr.length,en=0;en<bi;en++){en===1&&Kt!==1&&gt.writeVarint(qe(2,bi-1));var Pn=qr[en].x-rr,In=qr[en].y-Dr;gt.writeVarint(ut(Pn)),gt.writeVarint(ut(In)),rr+=Pn,Dr+=In}Kt===3&&gt.writeVarint(qe(7,1))}}function pt(_t,gt){var Nt=typeof _t;Nt==="string"?gt.writeStringField(1,_t):Nt==="boolean"?gt.writeBooleanField(7,_t):Nt==="number"&&(_t%1!=0?gt.writeDoubleField(3,_t):_t<0?gt.writeSVarintField(6,_t):gt.writeVarintField(5,_t))}return zt.exports=ye,zt.exports.fromVectorTileJs=ye,zt.exports.fromGeojsonVt=function(_t,gt){gt=gt||{};var Nt={};for(var Kt in _t)Nt[Kt]=new fe(_t[Kt].features,gt),Nt[Kt].name=Kt,Nt[Kt].version=gt.version,Nt[Kt].extent=gt.extent;return ye({layers:Nt})},zt.exports.GeoJSONWrapper=fe,zt.exports}(),Bt=i.eh(Lt);const ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ft=>ft},nr=Math.fround||(mr=new Float32Array(1),ft=>(mr[0]=+ft,mr[0]));var mr;const ir=3,Ut=5,hr=6;class Vt{constructor(fe){this.options=Object.assign(Object.create(ct),fe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(fe){const{log:ye,minZoom:Me,maxZoom:$e}=this.options;ye&&console.time("total time");const Ne=`prepare ${fe.length} points`;ye&&console.time(Ne),this.points=fe;const qe=[];for(let Ye=0;Ye<fe.length;Ye++){const pt=fe[Ye];if(!pt.geometry)continue;const[_t,gt]=pt.geometry.coordinates,Nt=nr(Ot(_t)),Kt=nr(tr(gt));qe.push(Nt,Kt,1/0,Ye,-1,1),this.options.reduce&&qe.push(0)}let ut=this.trees[$e+1]=this._createTree(qe);ye&&console.timeEnd(Ne);for(let Ye=$e;Ye>=Me;Ye--){const pt=+Date.now();ut=this.trees[Ye]=this._createTree(this._cluster(ut,Ye)),ye&&console.log("z%d: %d clusters in %dms",Ye,ut.numItems,+Date.now()-pt)}return ye&&console.timeEnd("total time"),this}getClusters(fe,ye){let Me=((fe[0]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,fe[1]));let Ne=fe[2]===180?180:((fe[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,fe[3]));if(fe[2]-fe[0]>=360)Me=-180,Ne=180;else if(Me>Ne){const gt=this.getClusters([Me,$e,180,qe],ye),Nt=this.getClusters([-180,$e,Ne,qe],ye);return gt.concat(Nt)}const ut=this.trees[this._limitZoom(ye)],Ye=ut.range(Ot(Me),tr(qe),Ot(Ne),tr($e)),pt=ut.data,_t=[];for(const gt of Ye){const Nt=this.stride*gt;_t.push(pt[Nt+Ut]>1?ge(pt,Nt,this.clusterProps):this.points[pt[Nt+ir]])}return _t}getChildren(fe){const ye=this._getOriginId(fe),Me=this._getOriginZoom(fe),$e="No cluster with the specified id.",Ne=this.trees[Me];if(!Ne)throw new Error($e);const qe=Ne.data;if(ye*this.stride>=qe.length)throw new Error($e);const ut=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),Ye=Ne.within(qe[ye*this.stride],qe[ye*this.stride+1],ut),pt=[];for(const _t of Ye){const gt=_t*this.stride;qe[gt+4]===fe&&pt.push(qe[gt+Ut]>1?ge(qe,gt,this.clusterProps):this.points[qe[gt+ir]])}if(pt.length===0)throw new Error($e);return pt}getLeaves(fe,ye,Me){const $e=[];return this._appendLeaves($e,fe,ye=ye||10,Me=Me||0,0),$e}getTile(fe,ye,Me){const $e=this.trees[this._limitZoom(fe)],Ne=Math.pow(2,fe),{extent:qe,radius:ut}=this.options,Ye=ut/qe,pt=(Me-Ye)/Ne,_t=(Me+1+Ye)/Ne,gt={features:[]};return this._addTileFeatures($e.range((ye-Ye)/Ne,pt,(ye+1+Ye)/Ne,_t),$e.data,ye,Me,Ne,gt),ye===0&&this._addTileFeatures($e.range(1-Ye/Ne,pt,1,_t),$e.data,Ne,Me,Ne,gt),ye===Ne-1&&this._addTileFeatures($e.range(0,pt,Ye/Ne,_t),$e.data,-1,Me,Ne,gt),gt.features.length?gt:null}getClusterExpansionZoom(fe){let ye=this._getOriginZoom(fe)-1;for(;ye<=this.options.maxZoom;){const Me=this.getChildren(fe);if(ye++,Me.length!==1)break;fe=Me[0].properties.cluster_id}return ye}_appendLeaves(fe,ye,Me,$e,Ne){const qe=this.getChildren(ye);for(const ut of qe){const Ye=ut.properties;if(Ye&&Ye.cluster?Ne+Ye.point_count<=$e?Ne+=Ye.point_count:Ne=this._appendLeaves(fe,Ye.cluster_id,Me,$e,Ne):Ne<$e?Ne++:fe.push(ut),fe.length===Me)break}return Ne}_createTree(fe){const ye=new i.bE(fe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<fe.length;Me+=this.stride)ye.add(fe[Me],fe[Me+1]);return ye.finish(),ye.data=fe,ye}_addTileFeatures(fe,ye,Me,$e,Ne,qe){for(const ut of fe){const Ye=ut*this.stride,pt=ye[Ye+Ut]>1;let _t,gt,Nt;if(pt)_t=ur(ye,Ye,this.clusterProps),gt=ye[Ye],Nt=ye[Ye+1];else{const Dr=this.points[ye[Ye+ir]];_t=Dr.properties;const[Ur,Vr]=Dr.geometry.coordinates;gt=Ot(Ur),Nt=tr(Vr)}const Kt={type:1,geometry:[[Math.round(this.options.extent*(gt*Ne-Me)),Math.round(this.options.extent*(Nt*Ne-$e))]],tags:_t};let rr;rr=pt||this.options.generateId?ye[Ye+ir]:this.points[ye[Ye+ir]].id,rr!==void 0&&(Kt.id=rr),qe.features.push(Kt)}}_limitZoom(fe){return Math.max(this.options.minZoom,Math.min(Math.floor(+fe),this.options.maxZoom+1))}_cluster(fe,ye){const{radius:Me,extent:$e,reduce:Ne,minPoints:qe}=this.options,ut=Me/($e*Math.pow(2,ye)),Ye=fe.data,pt=[],_t=this.stride;for(let gt=0;gt<Ye.length;gt+=_t){if(Ye[gt+2]<=ye)continue;Ye[gt+2]=ye;const Nt=Ye[gt],Kt=Ye[gt+1],rr=fe.within(Ye[gt],Ye[gt+1],ut),Dr=Ye[gt+Ut];let Ur=Dr;for(const Vr of rr){const qr=Vr*_t;Ye[qr+2]>ye&&(Ur+=Ye[qr+Ut])}if(Ur>Dr&&Ur>=qe){let Vr,qr=Nt*Dr,Jn=Kt*Dr,bi=-1;const en=(gt/_t<<5)+(ye+1)+this.points.length;for(const Pn of rr){const In=Pn*_t;if(Ye[In+2]<=ye)continue;Ye[In+2]=ye;const Rn=Ye[In+Ut];qr+=Ye[In]*Rn,Jn+=Ye[In+1]*Rn,Ye[In+4]=en,Ne&&(Vr||(Vr=this._map(Ye,gt,!0),bi=this.clusterProps.length,this.clusterProps.push(Vr)),Ne(Vr,this._map(Ye,In)))}Ye[gt+4]=en,pt.push(qr/Ur,Jn/Ur,1/0,en,-1,Ur),Ne&&pt.push(bi)}else{for(let Vr=0;Vr<_t;Vr++)pt.push(Ye[gt+Vr]);if(Ur>1)for(const Vr of rr){const qr=Vr*_t;if(!(Ye[qr+2]<=ye)){Ye[qr+2]=ye;for(let Jn=0;Jn<_t;Jn++)pt.push(Ye[qr+Jn])}}}}return pt}_getOriginId(fe){return fe-this.points.length>>5}_getOriginZoom(fe){return(fe-this.points.length)%32}_map(fe,ye,Me){if(fe[ye+Ut]>1){const qe=this.clusterProps[fe[ye+hr]];return Me?Object.assign({},qe):qe}const $e=this.points[fe[ye+ir]].properties,Ne=this.options.map($e);return Me&&Ne===$e?Object.assign({},Ne):Ne}}function ge(ft,fe,ye){return{type:"Feature",id:ft[fe+ir],properties:ur(ft,fe,ye),geometry:{type:"Point",coordinates:[(Me=ft[fe],360*(Me-.5)),xt(ft[fe+1])]}};var Me}function ur(ft,fe,ye){const Me=ft[fe+Ut],$e=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,Ne=ft[fe+hr],qe=Ne===-1?{}:Object.assign({},ye[Ne]);return Object.assign(qe,{cluster:!0,cluster_id:ft[fe+ir],point_count:Me,point_count_abbreviated:$e})}function Ot(ft){return ft/360+.5}function tr(ft){const fe=Math.sin(ft*Math.PI/180),ye=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ye<0?0:ye>1?1:ye}function xt(ft){const fe=(180-360*ft)*Math.PI/180;return 360*Math.atan(Math.exp(fe))/Math.PI-90}function un(ft,fe,ye,Me){let $e=Me;const Ne=fe+(ye-fe>>1);let qe,ut=ye-fe;const Ye=ft[fe],pt=ft[fe+1],_t=ft[ye],gt=ft[ye+1];for(let Nt=fe+3;Nt<ye;Nt+=3){const Kt=Fr(ft[Nt],ft[Nt+1],Ye,pt,_t,gt);if(Kt>$e)qe=Nt,$e=Kt;else if(Kt===$e){const rr=Math.abs(Nt-Ne);rr<ut&&(qe=Nt,ut=rr)}}$e>Me&&(qe-fe>3&&un(ft,fe,qe,Me),ft[qe+2]=$e,ye-qe>3&&un(ft,qe,ye,Me))}function Fr(ft,fe,ye,Me,$e,Ne){let qe=$e-ye,ut=Ne-Me;if(qe!==0||ut!==0){const Ye=((ft-ye)*qe+(fe-Me)*ut)/(qe*qe+ut*ut);Ye>1?(ye=$e,Me=Ne):Ye>0&&(ye+=qe*Ye,Me+=ut*Ye)}return qe=ft-ye,ut=fe-Me,qe*qe+ut*ut}function Ln(ft,fe,ye,Me){const $e={id:ft??null,type:fe,geometry:ye,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")Ge($e,ye);else if(fe==="Polygon")Ge($e,ye[0]);else if(fe==="MultiLineString")for(const Ne of ye)Ge($e,Ne);else if(fe==="MultiPolygon")for(const Ne of ye)Ge($e,Ne[0]);return $e}function Ge(ft,fe){for(let ye=0;ye<fe.length;ye+=3)ft.minX=Math.min(ft.minX,fe[ye]),ft.minY=Math.min(ft.minY,fe[ye+1]),ft.maxX=Math.max(ft.maxX,fe[ye]),ft.maxY=Math.max(ft.maxY,fe[ye+1])}function vt(ft,fe,ye,Me){if(!fe.geometry)return;const $e=fe.geometry.coordinates;if($e&&$e.length===0)return;const Ne=fe.geometry.type,qe=Math.pow(ye.tolerance/((1<<ye.maxZoom)*ye.extent),2);let ut=[],Ye=fe.id;if(ye.promoteId?Ye=fe.properties[ye.promoteId]:ye.generateId&&(Ye=Me||0),Ne==="Point")kt($e,ut);else if(Ne==="MultiPoint")for(const pt of $e)kt(pt,ut);else if(Ne==="LineString")fr($e,ut,qe,!1);else if(Ne==="MultiLineString"){if(ye.lineMetrics){for(const pt of $e)ut=[],fr(pt,ut,qe,!1),ft.push(Ln(Ye,"LineString",ut,fe.properties));return}dr($e,ut,qe,!1)}else if(Ne==="Polygon")dr($e,ut,qe,!0);else{if(Ne!=="MultiPolygon"){if(Ne==="GeometryCollection"){for(const pt of fe.geometry.geometries)vt(ft,{id:Ye,geometry:pt,properties:fe.properties},ye,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const pt of $e){const _t=[];dr(pt,_t,qe,!0),ut.push(_t)}}ft.push(Ln(Ye,Ne,ut,fe.properties))}function kt(ft,fe){fe.push(ar(ft[0]),Yt(ft[1]),0)}function fr(ft,fe,ye,Me){let $e,Ne,qe=0;for(let Ye=0;Ye<ft.length;Ye++){const pt=ar(ft[Ye][0]),_t=Yt(ft[Ye][1]);fe.push(pt,_t,0),Ye>0&&(qe+=Me?($e*_t-pt*Ne)/2:Math.sqrt(Math.pow(pt-$e,2)+Math.pow(_t-Ne,2))),$e=pt,Ne=_t}const ut=fe.length-3;fe[2]=1,un(fe,0,ut,ye),fe[ut+2]=1,fe.size=Math.abs(qe),fe.start=0,fe.end=fe.size}function dr(ft,fe,ye,Me){for(let $e=0;$e<ft.length;$e++){const Ne=[];fr(ft[$e],Ne,ye,Me),fe.push(Ne)}}function ar(ft){return ft/360+.5}function Yt(ft){const fe=Math.sin(ft*Math.PI/180),ye=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ye<0?0:ye>1?1:ye}function Zr(ft,fe,ye,Me,$e,Ne,qe,ut){if(Me/=fe,Ne>=(ye/=fe)&&qe<Me)return ft;if(qe<ye||Ne>=Me)return null;const Ye=[];for(const pt of ft){const _t=pt.geometry;let gt=pt.type;const Nt=$e===0?pt.minX:pt.minY,Kt=$e===0?pt.maxX:pt.maxY;if(Nt>=ye&&Kt<Me){Ye.push(pt);continue}if(Kt<ye||Nt>=Me)continue;let rr=[];if(gt==="Point"||gt==="MultiPoint")oi(_t,rr,ye,Me,$e);else if(gt==="LineString")Bn(_t,rr,ye,Me,$e,!1,ut.lineMetrics);else if(gt==="MultiLineString")So(_t,rr,ye,Me,$e,!1);else if(gt==="Polygon")So(_t,rr,ye,Me,$e,!0);else if(gt==="MultiPolygon")for(const Dr of _t){const Ur=[];So(Dr,Ur,ye,Me,$e,!0),Ur.length&&rr.push(Ur)}if(rr.length){if(ut.lineMetrics&&gt==="LineString"){for(const Dr of rr)Ye.push(Ln(pt.id,gt,Dr,pt.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(rr.length===1?(gt="LineString",rr=rr[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=rr.length===3?"Point":"MultiPoint"),Ye.push(Ln(pt.id,gt,rr,pt.tags))}}return Ye.length?Ye:null}function oi(ft,fe,ye,Me,$e){for(let Ne=0;Ne<ft.length;Ne+=3){const qe=ft[Ne+$e];qe>=ye&&qe<=Me&&Wo(fe,ft[Ne],ft[Ne+1],ft[Ne+2])}}function Bn(ft,fe,ye,Me,$e,Ne,qe){let ut=Ti(ft);const Ye=$e===0?la:ys;let pt,_t,gt=ft.start;for(let Ur=0;Ur<ft.length-3;Ur+=3){const Vr=ft[Ur],qr=ft[Ur+1],Jn=ft[Ur+2],bi=ft[Ur+3],en=ft[Ur+4],Pn=$e===0?Vr:qr,In=$e===0?bi:en;let Rn=!1;qe&&(pt=Math.sqrt(Math.pow(Vr-bi,2)+Math.pow(qr-en,2))),Pn<ye?In>ye&&(_t=Ye(ut,Vr,qr,bi,en,ye),qe&&(ut.start=gt+pt*_t)):Pn>Me?In<Me&&(_t=Ye(ut,Vr,qr,bi,en,Me),qe&&(ut.start=gt+pt*_t)):Wo(ut,Vr,qr,Jn),In<ye&&Pn>=ye&&(_t=Ye(ut,Vr,qr,bi,en,ye),Rn=!0),In>Me&&Pn<=Me&&(_t=Ye(ut,Vr,qr,bi,en,Me),Rn=!0),!Ne&&Rn&&(qe&&(ut.end=gt+pt*_t),fe.push(ut),ut=Ti(ft)),qe&&(gt+=pt)}let Nt=ft.length-3;const Kt=ft[Nt],rr=ft[Nt+1],Dr=$e===0?Kt:rr;Dr>=ye&&Dr<=Me&&Wo(ut,Kt,rr,ft[Nt+2]),Nt=ut.length-3,Ne&&Nt>=3&&(ut[Nt]!==ut[0]||ut[Nt+1]!==ut[1])&&Wo(ut,ut[0],ut[1],ut[2]),ut.length&&fe.push(ut)}function Ti(ft){const fe=[];return fe.size=ft.size,fe.start=ft.start,fe.end=ft.end,fe}function So(ft,fe,ye,Me,$e,Ne){for(const qe of ft)Bn(qe,fe,ye,Me,$e,Ne,!1)}function Wo(ft,fe,ye,Me){ft.push(fe,ye,Me)}function la(ft,fe,ye,Me,$e,Ne){const qe=(Ne-fe)/(Me-fe);return Wo(ft,Ne,ye+($e-ye)*qe,1),qe}function ys(ft,fe,ye,Me,$e,Ne){const qe=(Ne-ye)/($e-ye);return Wo(ft,fe+(Me-fe)*qe,Ne,1),qe}function Ba(ft,fe){const ye=[];for(let Me=0;Me<ft.length;Me++){const $e=ft[Me],Ne=$e.type;let qe;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")qe=vs($e.geometry,fe);else if(Ne==="MultiLineString"||Ne==="Polygon"){qe=[];for(const ut of $e.geometry)qe.push(vs(ut,fe))}else if(Ne==="MultiPolygon"){qe=[];for(const ut of $e.geometry){const Ye=[];for(const pt of ut)Ye.push(vs(pt,fe));qe.push(Ye)}}ye.push(Ln($e.id,Ne,qe,$e.tags))}return ye}function vs(ft,fe){const ye=[];ye.size=ft.size,ft.start!==void 0&&(ye.start=ft.start,ye.end=ft.end);for(let Me=0;Me<ft.length;Me+=3)ye.push(ft[Me]+fe,ft[Me+1],ft[Me+2]);return ye}function go(ft,fe){if(ft.transformed)return ft;const ye=1<<ft.z,Me=ft.x,$e=ft.y;for(const Ne of ft.features){const qe=Ne.geometry,ut=Ne.type;if(Ne.geometry=[],ut===1)for(let Ye=0;Ye<qe.length;Ye+=2)Ne.geometry.push(ca(qe[Ye],qe[Ye+1],fe,ye,Me,$e));else for(let Ye=0;Ye<qe.length;Ye++){const pt=[];for(let _t=0;_t<qe[Ye].length;_t+=2)pt.push(ca(qe[Ye][_t],qe[Ye][_t+1],fe,ye,Me,$e));Ne.geometry.push(pt)}}return ft.transformed=!0,ft}function ca(ft,fe,ye,Me,$e,Ne){return[Math.round(ye*(ft*Me-$e)),Math.round(ye*(fe*Me-Ne))]}function ai(ft,fe,ye,Me,$e){const Ne=fe===$e.maxZoom?0:$e.tolerance/((1<<fe)*$e.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:ft.length,source:null,x:ye,y:Me,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ut of ft)Wt(qe,ut,Ne,$e);return qe}function Wt(ft,fe,ye,Me){const $e=fe.geometry,Ne=fe.type,qe=[];if(ft.minX=Math.min(ft.minX,fe.minX),ft.minY=Math.min(ft.minY,fe.minY),ft.maxX=Math.max(ft.maxX,fe.maxX),ft.maxY=Math.max(ft.maxY,fe.maxY),Ne==="Point"||Ne==="MultiPoint")for(let ut=0;ut<$e.length;ut+=3)qe.push($e[ut],$e[ut+1]),ft.numPoints++,ft.numSimplified++;else if(Ne==="LineString")Hr(qe,$e,ft,ye,!1,!1);else if(Ne==="MultiLineString"||Ne==="Polygon")for(let ut=0;ut<$e.length;ut++)Hr(qe,$e[ut],ft,ye,Ne==="Polygon",ut===0);else if(Ne==="MultiPolygon")for(let ut=0;ut<$e.length;ut++){const Ye=$e[ut];for(let pt=0;pt<Ye.length;pt++)Hr(qe,Ye[pt],ft,ye,!0,pt===0)}if(qe.length){let ut=fe.tags||null;if(Ne==="LineString"&&Me.lineMetrics){ut={};for(const pt in fe.tags)ut[pt]=fe.tags[pt];ut.mapbox_clip_start=$e.start/$e.size,ut.mapbox_clip_end=$e.end/$e.size}const Ye={geometry:qe,type:Ne==="Polygon"||Ne==="MultiPolygon"?3:Ne==="LineString"||Ne==="MultiLineString"?2:1,tags:ut};fe.id!==null&&(Ye.id=fe.id),ft.features.push(Ye)}}function Hr(ft,fe,ye,Me,$e,Ne){const qe=Me*Me;if(Me>0&&fe.size<($e?qe:Me))return void(ye.numPoints+=fe.length/3);const ut=[];for(let Ye=0;Ye<fe.length;Ye+=3)(Me===0||fe[Ye+2]>qe)&&(ye.numSimplified++,ut.push(fe[Ye],fe[Ye+1])),ye.numPoints++;$e&&function(Ye,pt){let _t=0;for(let gt=0,Nt=Ye.length,Kt=Nt-2;gt<Nt;Kt=gt,gt+=2)_t+=(Ye[gt]-Ye[Kt])*(Ye[gt+1]+Ye[Kt+1]);if(_t>0===pt)for(let gt=0,Nt=Ye.length;gt<Nt/2;gt+=2){const Kt=Ye[gt],rr=Ye[gt+1];Ye[gt]=Ye[Nt-2-gt],Ye[gt+1]=Ye[Nt-1-gt],Ye[Nt-2-gt]=Kt,Ye[Nt-1-gt]=rr}}(ut,Ne),ft.push(ut)}const Xr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class cn{constructor(fe,ye){const Me=(ye=this.options=function(Ne,qe){for(const ut in qe)Ne[ut]=qe[ut];return Ne}(Object.create(Xr),ye)).debug;if(Me&&console.time("preprocess data"),ye.maxZoom<0||ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ye.promoteId&&ye.generateId)throw new Error("promoteId and generateId cannot be used together.");let $e=function(Ne,qe){const ut=[];if(Ne.type==="FeatureCollection")for(let Ye=0;Ye<Ne.features.length;Ye++)vt(ut,Ne.features[Ye],qe,Ye);else vt(ut,Ne.type==="Feature"?Ne:{geometry:Ne},qe);return ut}(fe,ye);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ye.indexMaxZoom,ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),$e=function(Ne,qe){const ut=qe.buffer/qe.extent;let Ye=Ne;const pt=Zr(Ne,1,-1-ut,ut,0,-1,2,qe),_t=Zr(Ne,1,1-ut,2+ut,0,-1,2,qe);return(pt||_t)&&(Ye=Zr(Ne,1,-ut,1+ut,0,-1,2,qe)||[],pt&&(Ye=Ba(pt,1).concat(Ye)),_t&&(Ye=Ye.concat(Ba(_t,-1)))),Ye}($e,ye),$e.length&&this.splitTile($e,0,0,0),Me&&($e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(fe,ye,Me,$e,Ne,qe,ut){const Ye=[fe,ye,Me,$e],pt=this.options,_t=pt.debug;for(;Ye.length;){$e=Ye.pop(),Me=Ye.pop(),ye=Ye.pop(),fe=Ye.pop();const gt=1<<ye,Nt=fn(ye,Me,$e);let Kt=this.tiles[Nt];if(!Kt&&(_t>1&&console.time("creation"),Kt=this.tiles[Nt]=ai(fe,ye,Me,$e,pt),this.tileCoords.push({z:ye,x:Me,y:$e}),_t)){_t>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ye,Me,$e,Kt.numFeatures,Kt.numPoints,Kt.numSimplified),console.timeEnd("creation"));const Rn=`z${ye}`;this.stats[Rn]=(this.stats[Rn]||0)+1,this.total++}if(Kt.source=fe,Ne==null){if(ye===pt.indexMaxZoom||Kt.numPoints<=pt.indexMaxPoints)continue}else{if(ye===pt.maxZoom||ye===Ne)continue;if(Ne!=null){const Rn=Ne-ye;if(Me!==qe>>Rn||$e!==ut>>Rn)continue}}if(Kt.source=null,fe.length===0)continue;_t>1&&console.time("clipping");const rr=.5*pt.buffer/pt.extent,Dr=.5-rr,Ur=.5+rr,Vr=1+rr;let qr=null,Jn=null,bi=null,en=null,Pn=Zr(fe,gt,Me-rr,Me+Ur,0,Kt.minX,Kt.maxX,pt),In=Zr(fe,gt,Me+Dr,Me+Vr,0,Kt.minX,Kt.maxX,pt);fe=null,Pn&&(qr=Zr(Pn,gt,$e-rr,$e+Ur,1,Kt.minY,Kt.maxY,pt),Jn=Zr(Pn,gt,$e+Dr,$e+Vr,1,Kt.minY,Kt.maxY,pt),Pn=null),In&&(bi=Zr(In,gt,$e-rr,$e+Ur,1,Kt.minY,Kt.maxY,pt),en=Zr(In,gt,$e+Dr,$e+Vr,1,Kt.minY,Kt.maxY,pt),In=null),_t>1&&console.timeEnd("clipping"),Ye.push(qr||[],ye+1,2*Me,2*$e),Ye.push(Jn||[],ye+1,2*Me,2*$e+1),Ye.push(bi||[],ye+1,2*Me+1,2*$e),Ye.push(en||[],ye+1,2*Me+1,2*$e+1)}}getTile(fe,ye,Me){fe=+fe,ye=+ye,Me=+Me;const $e=this.options,{extent:Ne,debug:qe}=$e;if(fe<0||fe>24)return null;const ut=1<<fe,Ye=fn(fe,ye=ye+ut&ut-1,Me);if(this.tiles[Ye])return go(this.tiles[Ye],Ne);qe>1&&console.log("drilling down to z%d-%d-%d",fe,ye,Me);let pt,_t=fe,gt=ye,Nt=Me;for(;!pt&&_t>0;)_t--,gt>>=1,Nt>>=1,pt=this.tiles[fn(_t,gt,Nt)];return pt&&pt.source?(qe>1&&(console.log("found parent tile z%d-%d-%d",_t,gt,Nt),console.time("drilling down")),this.splitTile(pt.source,_t,gt,Nt,fe,ye,Me),qe>1&&console.timeEnd("drilling down"),this.tiles[Ye]?go(this.tiles[Ye],Ne):null):null}}function fn(ft,fe,ye){return 32*((1<<ft)*ye+fe)+ft}function ao(ft,fe){const ye=ft.tileID.canonical;if(!this._geoJSONIndex)return void fe(null,null);const Me=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);if(!Me)return void fe(null,null);const $e=new de(Me.features);let Ne=Bt($e);Ne.byteOffset===0&&Ne.byteLength===Ne.buffer.byteLength||(Ne=new Uint8Array(Ne)),fe(null,{vectorTile:$e,rawData:Ne.buffer})}class Xi extends q{constructor(fe,ye,Me,$e,Ne,qe){super(fe,ye,Me,$e,ao,qe),Ne&&(this.loadGeoJSON=Ne),this._dynamicIndex=new Fe}loadData(fe,ye){const Me=fe&&fe.request,$e=Me&&Me.collectResourceTiming;this.loadGeoJSON(fe,(Ne,qe)=>{if(Ne||!qe)return ye(Ne);if(typeof qe!="object")return ye(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));{try{if(fe.filter){const Ye=i.X(fe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(pt=>`${pt.key}: ${pt.message}`).join(", "));qe.features=qe.features.filter(pt=>Ye.value.evaluate({zoom:0},pt))}fe.dynamic?(qe.type==="Feature"&&(qe={type:"FeatureCollection",features:[qe]}),fe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(qe.features,this.loaded),fe.cluster&&(qe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=fe.cluster?new Vt(function({superclusterOptions:Ye,clusterProperties:pt}){if(!pt||!Ye)return Ye;const _t={},gt={},Nt={accumulated:null,zoom:0},Kt={properties:null},rr=Object.keys(pt);for(const Dr of rr){const[Ur,Vr]=pt[Dr],qr=i.X(Vr),Jn=i.X(typeof Ur=="string"?[Ur,["accumulated"],["get",Dr]]:Ur);_t[Dr]=qr.value,gt[Dr]=Jn.value}return Ye.map=Dr=>{Kt.properties=Dr;const Ur={};for(const Vr of rr)Ur[Vr]=_t[Vr].evaluate(Nt,Kt);return Ur},Ye.reduce=(Dr,Ur)=>{Kt.properties=Ur;for(const Vr of rr)Nt.accumulated=Dr[Vr],Dr[Vr]=gt[Vr].evaluate(Nt,Kt)},Ye}(fe)).load(qe.features):fe.dynamic?this._dynamicIndex:function(Ye,pt){return new cn(Ye,pt)}(qe,fe.geojsonVtOptions)}catch(Ye){return ye(Ye)}const ut={};if($e){const Ye=_(Me);Ye&&(ut.resourceTiming={},ut.resourceTiming[fe.source]=JSON.parse(JSON.stringify(Ye)))}ye(null,ut)}})}reloadTile(fe,ye){const Me=this.loaded;return Me&&Me[fe.uid]?fe.partial?ye(null,void 0):super.reloadTile(fe,ye):this.loadTile(fe,ye)}loadGeoJSON(fe,ye){if(fe.request)i.n(fe.request,ye);else{if(typeof fe.data!="string")return ye(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));try{return ye(null,JSON.parse(fe.data))}catch{return ye(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(fe,ye){try{ye(null,this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId))}catch(Me){ye(Me)}}getClusterChildren(fe,ye){try{ye(null,this._geoJSONIndex.getChildren(fe.clusterId))}catch(Me){ye(Me)}}getClusterLeaves(fe,ye){try{ye(null,this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset))}catch(Me){ye(Me)}}}class Jo{constructor(fe,ye){this.tileID=new i.aH(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.tileZoom=fe.tileZoom,this.uid=fe.uid,this.zoom=fe.zoom,this.canonical=fe.tileID.canonical,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=fe.projection,this.brightness=ye}parse(fe,ye,Me,$e){this.status="parsing";const Ne=new i.aH(Me.tileID.overscaledZ,Me.tileID.wrap,Me.tileID.canonical.z,Me.tileID.canonical.x,Me.tileID.canonical.y),qe=[],ut=ye.familiesBySource[Me.source],Ye=new i.e0(Ne,Me.promoteId);return Ye.bucketLayerIDs=[],Ye.is3DTile=!0,i.ei(fe).then(pt=>{if(!pt)return $e(new Error("Could not parse tile"));const _t=i.ej(pt,1/i.cd(Me.tileID.canonical)),gt=pt.json.extensionsUsed&&pt.json.extensionsUsed.includes("MAPBOX_mesh_features")||pt.json.asset.extras&&pt.json.asset.extras.MAPBOX_mesh_features,Nt=pt.json.extensionsUsed&&pt.json.extensionsUsed.includes("EXT_meshopt_compression"),Kt=new i.aa(this.zoom,{brightness:this.brightness});for(const rr in ut)for(const Dr of ut[rr]){const Ur=Dr[0];Ye.bucketLayerIDs.push(Dr.map(qr=>i.C(qr.id,qr.scope))),Ur.recalculate(Kt,[]);const Vr=new i.ek(Dr,_t,Ne,gt,Nt,this.brightness,Ye);gt||(Vr.needsUpload=!0),qe.push(Vr),Vr.evaluate(Ur)}this.status="done",$e(null,{buckets:qe,featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(pt=>$e(new Error(pt.message)))}}class Ma{constructor(fe,ye,Me,$e,Ne,qe){this.actor=fe,this.layerIndex=ye,this.availableImages=Me,this.brightness=qe,this.loading={},this.loaded={}}loadTile(fe,ye){const Me=fe.uid,$e=this.loading[Me]=new Jo(fe,this.brightness);i.bj(fe.request,(Ne,qe)=>{const ut=!this.loading[Me];return delete this.loading[Me],ut||Ne?($e.status="done",ut||(this.loaded[Me]=$e),ye(Ne)):qe&&qe.byteLength!==0?void $e.parse(qe,this.layerIndex,fe,(Ye,pt)=>{$e.status="done",this.loaded=this.loaded||{},this.loaded[Me]=$e,Ye||!pt?ye(Ye):ye(null,pt)}):($e.status="done",this.loaded[Me]=$e,ye())})}reloadTile(fe,ye){const Me=this.loaded,$e=fe.uid;if(Me&&Me[$e]){const Ne=Me[$e];Ne.projection=fe.projection,Ne.brightness=fe.brightness;const qe=(ut,Ye)=>{Ne.reloadCallback&&(delete Ne.reloadCallback,this.loadTile(fe,ye)),ye(ut,Ye)};Ne.status==="parsing"?Ne.reloadCallback=qe:Ne.status==="done"&&this.loadTile(fe,ye)}}abortTile(fe,ye){const Me=fe.uid;this.loading[Me]&&delete this.loading[Me],ye()}removeTile(fe,ye){const Me=this.loaded,$e=fe.uid;Me&&Me[$e]&&delete Me[$e],ye()}}class _s{constructor(fe){this.self=fe,this.actor=new i.el(fe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.y,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:q,geojson:Xi,"raster-dem":G,"raster-array":J,"batched-model":Ma},this.workerSources={},this.self.registerWorkerSource=(ye,Me)=>{if(this.workerSourceTypes[ye])throw new Error(`Worker source with name "${ye}" already registered.`);this.workerSourceTypes[ye]=Me},this.self.registerRTLTextPlugin=ye=>{if(i.em.isParsed())throw new Error("RTL text plugin already registered.");i.em.applyArabicShaping=ye.applyArabicShaping,i.em.processBidirectionalText=ye.processBidirectionalText,i.em.processStyledBidirectionalText=ye.processStyledBidirectionalText}}clearCaches(fe,ye,Me){delete this.layerIndexes[fe],delete this.availableImages[fe],delete this.workerSources[fe],Me()}checkIfReady(fe,ye,Me){Me()}setReferrer(fe,ye){this.referrer=ye}spriteLoaded(fe,{scope:ye,isLoaded:Me}){if(this.isSpriteLoaded[fe]||(this.isSpriteLoaded[fe]={}),this.isSpriteLoaded[fe][ye]=Me,this.workerSources[fe]&&this.workerSources[fe][ye])for(const $e in this.workerSources[fe][ye]){const Ne=this.workerSources[fe][ye][$e];for(const qe in Ne){const ut=Ne[qe];ut instanceof q&&(ut.isSpriteLoaded=Me,ut.fire(new i.A("isSpriteLoaded")))}}}setImages(fe,{scope:ye,images:Me},$e){if(this.availableImages[fe]||(this.availableImages[fe]={}),this.availableImages[fe][ye]=Me,this.workerSources[fe]&&this.workerSources[fe][ye]){for(const Ne in this.workerSources[fe][ye]){const qe=this.workerSources[fe][ye][Ne];for(const ut in qe)qe[ut].availableImages=Me}$e()}else $e()}setProjection(fe,ye){this.projections[fe]=i.bP(ye)}setBrightness(fe,ye,Me){this.brightness=ye,Me()}setLayers(fe,ye,Me){this.getLayerIndex(fe,ye.scope).replace(ye.layers,ye.options),Me()}updateLayers(fe,ye,Me){this.getLayerIndex(fe,ye.scope).update(ye.layers,ye.removedIds,ye.options),Me()}loadTile(fe,ye,Me){ye.projection=this.projections[fe]||this.defaultProjection,this.getWorkerSource(fe,ye.type,ye.source,ye.scope).loadTile(ye,Me)}decodeRasterArray(fe,ye,Me){this.getWorkerSource(fe,ye.type,ye.source,ye.scope).decodeRasterArray(ye,Me)}reloadTile(fe,ye,Me){ye.projection=this.projections[fe]||this.defaultProjection,this.getWorkerSource(fe,ye.type,ye.source,ye.scope).reloadTile(ye,Me)}abortTile(fe,ye,Me){this.getWorkerSource(fe,ye.type,ye.source,ye.scope).abortTile(ye,Me)}removeTile(fe,ye,Me){this.getWorkerSource(fe,ye.type,ye.source,ye.scope).removeTile(ye,Me)}removeSource(fe,ye,Me){if(!(this.workerSources[fe]&&this.workerSources[fe][ye.scope]&&this.workerSources[fe][ye.scope][ye.type]&&this.workerSources[fe][ye.scope][ye.type][ye.source]))return;const $e=this.workerSources[fe][ye.scope][ye.type][ye.source];delete this.workerSources[fe][ye.scope][ye.type][ye.source],$e.removeSource!==void 0?$e.removeSource(ye,Me):Me()}loadWorkerSource(fe,ye,Me){try{this.self.importScripts(ye.url),Me()}catch($e){Me($e.toString())}}syncRTLPluginState(fe,ye,Me){try{i.em.setState(ye);const $e=i.em.getPluginURL();if(i.em.isLoaded()&&!i.em.isParsed()&&$e!=null){this.self.importScripts($e);const Ne=i.em.isParsed();Me(Ne?void 0:new Error(`RTL Text Plugin failed to import scripts from ${$e}`),Ne)}}catch($e){Me($e.toString())}}setDracoUrl(fe,ye){this.dracoUrl=ye}getAvailableImages(fe,ye){this.availableImages[fe]||(this.availableImages[fe]={});let Me=this.availableImages[fe][ye];return Me||(Me=[]),Me}getLayerIndex(fe,ye){this.layerIndexes[fe]||(this.layerIndexes[fe]={});let Me=this.layerIndexes[fe][ye];return Me||(Me=this.layerIndexes[fe][ye]=new C,Me.scope=ye),Me}getWorkerSource(fe,ye,Me,$e){const Ne=this.workerSources;return Ne[fe]||(Ne[fe]={}),Ne[fe][$e]||(Ne[fe][$e]={}),Ne[fe][$e][ye]||(Ne[fe][$e][ye]={}),this.isSpriteLoaded[fe]||(this.isSpriteLoaded[fe]={}),Ne[fe][$e][ye][Me]||(Ne[fe][$e][ye][Me]=new this.workerSourceTypes[ye]({send:(qe,ut,Ye,pt,_t,gt)=>{this.actor.send(qe,ut,Ye,fe,_t,gt)},scheduler:this.actor.scheduler},this.getLayerIndex(fe,$e),this.getAvailableImages(fe,$e),this.isSpriteLoaded[fe][$e],void 0,this.brightness)),Ne[fe][$e][ye][Me]}rasterizeImages(fe,ye,Me){const $e=new Map;for(const[Ne,{image:qe,imageVariant:ut}]of ye.tasks.entries()){const Ye=this.imageRasterizer.rasterize(ut,qe,ye.scope,fe);$e.set(Ne,Ye)}Me(void 0,$e)}removeRasterizedImages(fe,ye,Me){this.imageRasterizer.removeImagesFromCacheByIds(ye.imageIds,ye.scope,fe),Me()}enforceCacheSizeLimit(fe,ye){i.en(ye)}getWorkerPerformanceMetrics(fe,ye,Me){Me(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _s(self)),_s}),l(["./shared"],function(i){var _="3.11.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},E={mark(y){performance.mark(y)},measure(y,s,u){performance.measure(y,s,u)}};function C(y){const s=y.name.split("?")[0];return i.a(s)&&s.includes("mapbox-gl.js")?"javascript":i.a(s)&&s.includes("mapbox-gl.css")?"css":i.b(s)?"fontRange":i.c(s)?"sprite":i.i(s)?"style":i.d(s)?"tilejson":"other"}var I,F={},$=function(){if(I)return F;function y(g){return!s(g)}function s(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,A,L=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(L);try{A=new Worker(z),S=!0}catch{S=!1}return A&&A.terminate(),URL.revokeObjectURL(z),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var A=S.getContext("2d");if(!A)return!1;var L=A.getImageData(0,0,1,1);return L&&L.width===S.width}()?(u[x=g&&g.failIfMajorPerformanceCaveat]===void 0&&(u[x]=function(S){var A,L=function(z){var U=document.createElement("canvas"),V=Object.create(y.webGLContextAttributes);return V.failIfMajorPerformanceCaveat=z,U.getContext("webgl2",V)}(S);if(!L)return!1;try{A=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!A||L.isContextLost())&&(L.shaderSource(A,"void main() {}"),L.compileShader(A),L.getShaderParameter(A,L.COMPILE_STATUS)===!0)}(x)),u[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}I=1,F.supported=y,F.notSupportedReason=s;var u={};return y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},F}();function B(y,s,u){const g=document.createElement(y);return s!=null&&(g.className=s),u&&u.appendChild(g),g}function q(y,s,u){const g=document.createElementNS("http://www.w3.org/2000/svg",y);for(const x of Object.keys(s))g.setAttributeNS(null,x,String(s[x]));return u&&u.appendChild(g),g}const G=typeof document<"u"?document.documentElement&&document.documentElement.style:null,H=G&&G.userSelect!==void 0?"userSelect":"WebkitUserSelect";let J;function Q(){G&&H&&(J=G[H],G[H]="none")}function oe(){G&&H&&(G[H]=J)}function de(y){y.preventDefault(),y.stopPropagation(),window.removeEventListener("click",de,!0)}function ae(){window.addEventListener("click",de,!0),window.setTimeout(()=>{window.removeEventListener("click",de,!0)},0)}function ve(y,s){const u=y.getBoundingClientRect();return Ce(y,u,s)}function Fe(y,s){const u=y.getBoundingClientRect(),g=[];for(let x=0;x<s.length;x++)g.push(Ce(y,u,s[x]));return g}function ke(y){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&y.button===2&&y.ctrlKey?0:y.button}function Ce(y,s,u){const g=y.offsetWidth===s.width?1:y.offsetWidth/s.width;return new i.P((u.clientX-s.left)*g,(u.clientY-s.top)*g)}const je="01",tt="NO_ACCESS_TOKEN";class Ze{constructor(s,u,g){this._transformRequestFn=s,this._customAccessToken=u,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const s=function(){let u="";for(let g=0;g<10;g++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",je,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,u){return this._transformRequestFn&&this._transformRequestFn(s,u)||{url:s}}normalizeStyleURL(s,u){if(!i.f(s))return s;const g=st(s);return g.params.push(`sdk=js-${_}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeGlyphsURL(s,u){if(!i.f(s))return s;const g=st(s);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeModelURL(s,u){if(!i.f(s))return s;const g=st(s);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeSourceURL(s,u,g,x){if(!i.f(s))return s;const S=st(s);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),g&&S.params.push(`language=${g}`),x&&S.params.push(`worldview=${x}`),this._makeAPIURL(S,this._customAccessToken||u)}normalizeIconsetURL(s,u){const g=st(s);return i.f(s)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||u)):ot(g)}normalizeSpriteURL(s,u,g,x){const S=st(s);return i.f(s)?(S.path=`/styles/v1${S.path}/sprite${u}${g}`,this._makeAPIURL(S,this._customAccessToken||x)):(S.path+=`${u}${g}`,ot(S))}normalizeTileURL(s,u,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!i.f(s))return s;const x=st(s);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||g&&x.authority!=="raster"&&g===512?"@2x":""}${i.m.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const S=this._customAccessToken||function(A){for(const L of A){const z=L.match(/^access_token=(.*)$/);if(z)return z[1]}return null}(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,S)}canonicalizeTileURL(s,u){const g=st(s);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return s;let x="mapbox://";g.path.match(/^\/raster\/v1\//)?x+=`raster/${g.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${g.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${g.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let S=g.params;return u&&(S=S.filter(A=>!A.match(/^access_token=/))),S.length&&(x+=`?${S.join("&")}`),x}canonicalizeTileset(s,u){const g=!!u&&i.f(u),x=[];for(const S of s.tiles||[])i.h(S)?x.push(this.canonicalizeTileURL(S,g)):x.push(S);return x}_makeAPIURL(s,u){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=st(i.e.API_URL);if(s.protocol=x.protocol,s.authority=x.authority,s.protocol==="http"){const S=s.params.indexOf("secure");S>=0&&s.params.splice(S,1)}if(x.path!=="/"&&(s.path=`${x.path}${s.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return ot(s);if(u=u||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return s.params=s.params.filter(S=>S.indexOf("access_token")===-1),s.params.push(`access_token=${u||""}`),ot(s)}}const Qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function st(y){const s=y.match(Qe);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function ot(y){const s=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${s}`}const Be="mapbox.eventData";function lt(y){if(!y)return null;const s=y.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(i.j(s[1]))}catch{return null}}class zt{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const u=lt(i.e.ACCESS_TOKEN);let g="";return g=u&&u.u?i.k(u.u):i.e.ACCESS_TOKEN||"",s?`${Be}.${s}:${g}`:`${Be}:${g}`}fetchEventData(){const s=i.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid");if(s)try{const x=localStorage.getItem(u);x&&(this.eventData=JSON.parse(x));const S=localStorage.getItem(g);S&&(this.anonId=S)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const s=i.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),x=this.anonId;if(s&&x)try{localStorage.setItem(g,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,u,g,x){if(!i.e.EVENTS_URL)return;const S=st(i.e.EVENTS_URL);S.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const A={event:this.type,created:new Date(s).toISOString()},L=u?i.l(A,u):A,z={url:ot(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=i.p(z,U=>{this.pendingRequest=null,g(U),this.saveEventData(),this.processRequests(x)})}queueRequest(s,u){this.queue.push(s),this.processRequests(u)}}const Lt=new class extends zt{constructor(y){super("appUserTurnstile"),this._customAccessToken=y}postTurnstileEvent(y,s){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(y)&&y.some(u=>i.f(u)||i.h(u))&&this.queueRequest(Date.now(),s)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=lt(i.e.ACCESS_TOKEN),u=s?s.u:i.e.ACCESS_TOKEN;let g=u!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),g=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),A=new Date(x),L=(x-this.eventData.lastSuccess)/864e5;g=g||L>=1||L<-1||S.getDate()!==A.getDate()}else g=!0;g?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:je,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=x,this.eventData.tokenU=u)},y):this.processRequests()}},Bt=Lt.postTurnstileEvent.bind(Lt),ct=new class extends zt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(y,s,u,g){this.skuToken=s,this.errorCb=g,i.e.EVENTS_URL&&(u||i.e.ACCESS_TOKEN?this.queueRequest({id:y,timestamp:Date.now()},u):this.errorCb(new Error(tt)))}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:je,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},y))}remove(){this.errorCb=null}},nr=ct.postMapLoadEvent.bind(ct),mr=new class extends zt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(y){let s=this.mapInstanceIdMap.get(y);return s||(s=i.u(),this.mapInstanceIdMap.set(y,s)),s}getEventId(y){const s=this.eventIdPerMapInstanceMap.get(y)||0;return this.eventIdPerMapInstanceMap.set(y,s+1),s}postStyleLoadEvent(y,s){const{map:u,style:g,importedStyles:x}=s;if(!i.e.EVENTS_URL||!y&&!i.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(u),A={mapInstanceId:S,eventId:this.getEventId(S),style:g};x.length&&(A.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:A},y)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:u}=this.queue.shift();this.postEvent(s,u,()=>{},y)}},ir=mr.postStyleLoadEvent.bind(mr),Ut=new class extends zt{constructor(){super("gljs.performance")}postPerformanceEvent(y,s){i.e.EVENTS_URL&&(y||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},y)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:u}=this.queue.shift(),g=function(x){const S=performance.getEntriesByType("resource"),A=performance.getEntriesByType("mark"),L=function(re){const ce={};if(re){for(const se in re)if(se!=="other")for(const pe of re[se]){const me=`${se}ResolveRangeMin`,be=`${se}ResolveRangeMax`,Ee=`${se}RequestCount`,Te=`${se}RequestCachedCount`;ce[me]=Math.min(ce[me]||1/0,pe.startTime),ce[be]=Math.max(ce[be]||-1/0,pe.responseEnd);const Re=Pe=>{ce[Pe]===void 0&&(ce[Pe]=0),++ce[Pe]};pe.transferSize!==void 0&&pe.transferSize===0&&Re(Te),Re(Ee)}}return ce}(function(re,ce){const se={};if(re)for(const pe of re){const me=ce(pe);se[me]===void 0&&(se[me]=[]),se[me].push(pe)}return se}(S,C)),z=window.devicePixelRatio,U=navigator.connection||navigator.mozConnection||navigator.webkitConnection,V=U?U.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},Y=(re,ce,se)=>{se!=null&&re.push({name:ce,value:se.toString()})};for(const re in L)Y(X.counters,re,L[re]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(Y(X.counters,"interactionRangeMin",x.interactionRange[0]),Y(X.counters,"interactionRangeMax",x.interactionRange[1])),A)for(const re of Object.keys(b)){const ce=b[re],se=A.find(pe=>pe.name===ce);se&&Y(X.counters,ce,se.startTime)}return Y(X.counters,"visibilityHidden",x.visibilityHidden),Y(X.attributes,"style",function(re){if(re)for(const ce of re){const se=ce.name.split("?")[0];if(i.i(se)){const pe=se.split("/").slice(-2);if(pe.length===2)return`mapbox://styles/${pe[0]}/${pe[1]}`}}}(S)),Y(X.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),Y(X.attributes,"fogEnabled",x.fogEnabled?"true":"false"),Y(X.attributes,"projection",x.projection),Y(X.attributes,"zoom",x.zoom),Y(X.metadata,"devicePixelRatio",z),Y(X.metadata,"connectionEffectiveType",V),Y(X.metadata,"navigatorUserAgent",navigator.userAgent),Y(X.metadata,"screenWidth",window.screen.width),Y(X.metadata,"screenHeight",window.screen.height),Y(X.metadata,"windowWidth",window.innerWidth),Y(X.metadata,"windowHeight",window.innerHeight),Y(X.metadata,"mapWidth",x.width/z),Y(X.metadata,"mapHeight",x.height/z),Y(X.metadata,"webglRenderer",x.renderer),Y(X.metadata,"webglVendor",x.vendor),Y(X.metadata,"sdkVersion",_),Y(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(u);for(const x of g.metadata);for(const x of g.counters);for(const x of g.attributes);this.postEvent(s,g,()=>{},y)}},hr=Ut.postPerformanceEvent.bind(Ut),Vt=new class extends zt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(y,s,u,g){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=st(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${s||""}`),x.params.push(`access_token=${g||i.e.ACCESS_TOKEN||""}`);const S={url:ot(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(S,A=>{this.pendingRequest=null,u(A),this.saveEventData(),this.processRequests(g)})}getSessionAPI(y,s,u,g){this.skuToken=s,this.errorCb=g,i.e.SESSION_PATH&&i.e.API_URL&&(u||i.e.ACCESS_TOKEN?this.queueRequest({id:y,timestamp:Date.now()},u):this.errorCb(new Error(tt)))}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||this.getSession(u,this.skuToken,g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},y)}remove(){this.errorCb=null}},ge=Vt.getSessionAPI.bind(Vt),ur=new Set;function Ot(y,s){s?ur.add(y):ur.delete(y)}class tr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,u){this._updatedSourceCaches[s]=u,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const u=s.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(s.id),this.setDirty()}removeLayer(s){const u=s.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][s.id]=s,this._updatedLayers[u].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const u in this._updatedLayers)s[u]=s[u]||{},s[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)s[u]=s[u]||{},s[u].removedIds=Object.keys(this._removedLayers[u]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(s){this._updatedImages.add(i.I.toString(s)),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function xt(y){const{userImage:s}=y;return!!(s&&s.render&&s.render())&&(y.data.replace(new Uint8Array(s.data.buffer)),!0)}class un extends i.E{constructor(s){super(),this._images={},this._iconsets={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.patternsInFlight=new Set,this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=s,s!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.y),this._imageRasterizer}createScope(s){this._images[s]={},this._iconsets[s]={},this.loaded[s]=!1,this.updatedImages[s]=new Set,this.patterns[s]={},this.callbackDispatchedThisFrame[s]=new Set,this.atlasImage[s]=new i.r({width:1,height:1})}createIconset(s,u){this._iconsets[s][u]={}}isLoaded(){for(const s in this.loaded)if(!this.loaded[s])return!1;return!0}setLoaded(s,u){if(this.loaded[u]!==s&&(this.loaded[u]=s,s)){for(const{ids:g,callback:x}of this.requestors)this._notify(g,u,x);this.requestors=[]}}hasImage(s,u){return!!this.getImage(s,u)}getImage(s,u){return(s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u])[s.name]}addImage(s,u,g){const x=s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u];this._validate(s,g)&&(x[s.name]=g)}_validate(s,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "content" value`))),g=!1),g}_validateStretch(s,u){if(!s)return!0;let g=0;for(const x of s){if(x[0]<g||x[1]<x[0]||u<x[1])return!1;g=x[1]}return!0}_validateContent(s,u){return s?s.length!==4||!u.usvg&&(s[0]<0||u.data.width<s[0]||s[1]<0||u.data.height<s[1]||s[2]<0||u.data.width<s[2]||s[3]<0||u.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,u,g){const x=s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u];g.version=x[s.name].version+1,x[s.name]=g,this.updatedImages[u].add(s),this.removeFromImageRasterizerCache(s,u)}clearUpdatedImages(s){this.updatedImages[s].clear()}removeFromImageRasterizerCache(s,u){if(this.spriteFormat!=="raster")if(i.t()){const g={imageIds:[s],scope:u};this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",g)}else this.imageRasterizer.removeImagesFromCacheByIds([s],u)}removeImage(s,u){const g=s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u],x=g[s.name];delete g[s.name],delete this.patterns[u][s.name],this.removeFromImageRasterizerCache(s,u),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(s){const u=[];for(const g of Object.keys(this._images[s]))u.push(new i.I(g));for(const g in this._iconsets[s])for(const x of Object.keys(this._iconsets[s][g]))u.push(new i.I({name:x,iconsetId:g}));return u}getImages(s,u,g){let x=!0;const S=!!this.loaded[u];if(!S)for(const A of s)(A.iconsetId?this._iconsets[u][A.iconsetId]:this._images[u])[A.name]||(x=!1);S||x?this._notify(s,u,g):this.requestors.push({ids:s,scope:u,callback:g})}rasterizeImages({scope:s,tasks:u},g){const x=new Map;for(const[S,A]of u.entries()){const L=this.getImage(A.id,s);L&&x.set(S,{image:L,imageVariant:A})}this._rasterizeImages(s,x,g)}_rasterizeImages(s,u,g){if(i.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{tasks:u,scope:s},g);else{const x=new Map;for(const[S,{image:A,imageVariant:L}]of u.entries())x.set(S,this.imageRasterizer.rasterize(L,A,s,0));g(void 0,x)}}getUpdatedImages(s){return this.updatedImages[s]||new Set}_notify(s,u,g){const x=new Map;for(const S of s){S.iconsetId&&(this._iconsets[u][S.iconsetId]=this._iconsets[u][S.iconsetId]||{});const A=(S.iconsetId?this._iconsets[u][S.iconsetId]:this._images[u])[S.name];if(!A){if(S.iconsetId)continue;i.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`),this.fire(new i.A("styleimagemissing",{id:S.name}));continue}const L={data:A.usvg?null:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,usvg:A.usvg,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)};A.usvg&&Object.assign(L,{width:A.icon.usvg_tree.width,height:A.icon.usvg_tree.height}),x.set(i.I.toString(S),L)}g(null,x)}getPixelSize(s){const{width:u,height:g}=this.atlasImage[s];return{width:u,height:g}}getPattern(s,u,g){const x=this.patterns[u][s.name],S=this.getImage(s,u);if(!S)return null;if(x){if(x.position.version===S.version)return x.position;x.position.version=S.version}else{if(S.usvg&&!S.data){const A=this.getPatternInFlightId(s.toString(),u);if(this.patternsInFlight.has(A))return null;this.patternsInFlight.add(A);const L=new i.B(s).scaleSelf(i.q.devicePixelRatio),z=new Map([[L.toString(),{image:S,imageVariant:L}]]);return this._rasterizeImages(u,z,(U,V)=>this.storePatternImage(L,u,S,g,V)),null}this.storePattern(s,u,S)}return this._updatePatternAtlas(u,g),this.patterns[u][s.name].position}getPatternInFlightId(s,u){return i.C(s,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,u,g,x,S){const A=s.toString(),L=S?S.get(A):void 0;L&&(g.data=L,this.storePattern(s.id,u,g),this._updatePatternAtlas(u,x),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),u)))}storePattern(s,u,g){const x={w:g.data.width+2*i.F,h:g.data.height+2*i.F,x:0,y:0},S=new i.G(x,g,i.F);this.patterns[u][s.name]={bin:x,position:S}}bind(s,u){const g=s.gl;let x=this.atlasTexture[u];x?this.dirty&&(x.update(this.atlasImage[u]),this.dirty=!1):(x=new i.T(s,this.atlasImage[u],g.RGBA8),this.atlasTexture[u]=x),x.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(s,u){const g=[];for(const L in this.patterns[s])g.push(this.patterns[s][L].bin);const{w:x,h:S}=i.H(g),A=this.atlasImage[s];A.resize({width:x||1,height:S||1});for(const L in this.patterns[s]){const{bin:z,position:U}=this.patterns[s][L];let V=U.padding;const X=z.x+V,Y=z.y+V,re=this._images[s][L].data,ce=re.width,se=re.height;V=V>1?V-1:V,i.r.copy(re,A,{x:0,y:0},{x:X,y:Y},{width:ce,height:se},u),i.r.copy(re,A,{x:0,y:se-V},{x:X,y:Y-V},{width:ce,height:V},u),i.r.copy(re,A,{x:0,y:0},{x:X,y:Y+se},{width:ce,height:V},u),i.r.copy(re,A,{x:ce-V,y:0},{x:X-V,y:Y},{width:V,height:se},u),i.r.copy(re,A,{x:0,y:0},{x:X+ce,y:Y},{width:V,height:se},u),i.r.copy(re,A,{x:ce-V,y:se-V},{x:X-V,y:Y-V},{width:V,height:V},u),i.r.copy(re,A,{x:0,y:se-V},{x:X+ce,y:Y-V},{width:V,height:V},u),i.r.copy(re,A,{x:0,y:0},{x:X+ce,y:Y+se},{width:V,height:V},u),i.r.copy(re,A,{x:ce-V,y:0},{x:X-V,y:Y+se},{width:V,height:V},u)}this.dirty=!0}beginFrame(){for(const s in this._images)this.callbackDispatchedThisFrame[s]=new Set}dispatchRenderCallbacks(s,u){for(const g of s){if(this.callbackDispatchedThisFrame[u].has(g.toString()))continue;this.callbackDispatchedThisFrame[u].add(g.toString());const x=(g.iconsetId?this._iconsets[u][g.iconsetId]:this._images[u])[g.name];xt(x)&&this.updateImage(g,u,x)}}}function Fr(y){const s=y.key,u=y.value,g=y.valueSpec||{},x=y.objectElementValidators||{},S=y.style,A=y.styleSpec;let L=[];const z=i.K(u);if(z!=="object")return[new i.V(s,u,`object expected, ${z} found`)];for(const U in u){const V=U.split(".")[0];let X;x[V]?X=x[V]:g[V]?X=Wt:x["*"]?X=x["*"]:g["*"]&&(X=Wt),X?L=L.concat(X({key:(s&&`${s}.`)+U,value:u[U],valueSpec:g[V]||g["*"],style:S,styleSpec:A,object:u,objectKey:U},u)):L.push(new i.J(s,u[U],`unknown property "${U}"`))}for(const U in g)x[U]||g[U].required&&g[U].default===void 0&&u[U]===void 0&&L.push(new i.V(s,u,`missing required property "${U}"`));return L}function Ln(y){const s=y.value,u=y.valueSpec,g=y.style,x=y.styleSpec,S=y.key,A=y.arrayElementValidator||Wt;if(i.K(s)!=="array")return[new i.V(S,s,`array expected, ${i.K(s)} found`)];if(u.length&&s.length!==u.length)return[new i.V(S,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new i.V(S,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let L={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};x.$version<7&&(L.function=u.function),i.K(u.value)==="object"&&(L=u.value);let z=[];for(let U=0;U<s.length;U++)z=z.concat(A({array:s,arrayIndex:U,value:s[U],valueSpec:L,style:g,styleSpec:x,key:`${S}[${U}]`},!0));return z}function Ge(y){const s=y.key,u=y.value,g=y.valueSpec;let x=i.K(u);if(x==="number"&&u!=u&&(x="NaN"),x!=="number")return[new i.V(s,u,`number expected, ${x} found`)];if("minimum"in g){let S=g.minimum;if(i.K(g.minimum)==="array"&&(S=g.minimum[y.arrayIndex]),u<S)return[new i.V(s,u,`${u} is less than the minimum value ${S}`)]}if("maximum"in g){let S=g.maximum;if(i.K(g.maximum)==="array"&&(S=g.maximum[y.arrayIndex]),u>S)return[new i.V(s,u,`${u} is greater than the maximum value ${S}`)]}return[]}function vt(y){const s=y.valueSpec,u=i.M(y.value.type);let g,x,S,A={};const L=u!=="categorical"&&y.value.property===void 0,z=!L,U=i.K(y.value.stops)==="array"&&i.K(y.value.stops[0])==="array"&&i.K(y.value.stops[0][0])==="object",V=Fr({key:y.key,value:y.value,valueSpec:y.styleSpec.function,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{stops:function(re){if(u==="identity")return[new i.V(re.key,re.value,'identity function may not have a "stops" property')];let ce=[];const se=re.value;return ce=ce.concat(Ln({key:re.key,value:se,valueSpec:re.valueSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:X})),i.K(se)==="array"&&se.length===0&&ce.push(new i.V(re.key,se,"array must have at least one stop")),ce},default:function(re){return Wt({key:re.key,value:re.value,valueSpec:s,style:re.style,styleSpec:re.styleSpec})}}});return u==="identity"&&L&&V.push(new i.V(y.key,y.value,'missing required property "property"')),u==="identity"||y.value.stops||V.push(new i.V(y.key,y.value,'missing required property "stops"')),u==="exponential"&&y.valueSpec.expression&&!i.N(y.valueSpec)&&V.push(new i.V(y.key,y.value,"exponential functions not supported")),y.styleSpec.$version>=8&&(z&&!i.O(y.valueSpec)?V.push(new i.V(y.key,y.value,"property functions not supported")):L&&!i.Q(y.valueSpec)&&V.push(new i.V(y.key,y.value,"zoom functions not supported"))),u!=="categorical"&&!U||y.value.property!==void 0||V.push(new i.V(y.key,y.value,'"property" property is required')),V;function X(re){let ce=[];const se=re.value,pe=re.key;if(i.K(se)!=="array")return[new i.V(pe,se,`array expected, ${i.K(se)} found`)];if(se.length!==2)return[new i.V(pe,se,`array length 2 expected, length ${se.length} found`)];if(U){if(i.K(se[0])!=="object")return[new i.V(pe,se,`object expected, ${i.K(se[0])} found`)];if(se[0].zoom===void 0)return[new i.V(pe,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new i.V(pe,se,"object stop key must have value")];const me=i.M(se[0].zoom);if(typeof me!="number")return[new i.V(pe,se[0].zoom,"stop zoom values must be numbers")];if(S&&S>me)return[new i.V(pe,se[0].zoom,"stop zoom values must appear in ascending order")];me!==S&&(S=me,x=void 0,A={}),ce=ce.concat(Fr({key:`${pe}[0]`,value:se[0],valueSpec:{zoom:{}},style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:Ge,value:Y}}))}else ce=ce.concat(Y({key:`${pe}[0]`,value:se[0],valueSpec:{},style:re.style,styleSpec:re.styleSpec},se));return i.S(i.U(se[1]))?ce.concat([new i.V(`${pe}[1]`,se[1],"expressions are not allowed in function stops.")]):ce.concat(Wt({key:`${pe}[1]`,value:se[1],valueSpec:s,style:re.style,styleSpec:re.styleSpec}))}function Y(re,ce){const se=i.K(re.value),pe=i.M(re.value),me=re.value!==null?re.value:ce;if(g){if(se!==g)return[new i.V(re.key,me,`${se} stop domain type must match previous stop domain type ${g}`)]}else g=se;if(se!=="number"&&se!=="string"&&se!=="boolean"&&typeof pe!="number"&&typeof pe!="string"&&typeof pe!="boolean")return[new i.V(re.key,me,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&u!=="categorical"){let be=`number expected, ${se} found`;return i.O(s)&&u===void 0&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(re.key,me,be)]}return u!=="categorical"||se!=="number"||typeof pe=="number"&&isFinite(pe)&&Math.floor(pe)===pe?u!=="categorical"&&se==="number"&&typeof pe=="number"&&typeof x=="number"&&x!==void 0&&pe<x?[new i.V(re.key,me,"stop domain values must appear in ascending order")]:(x=pe,u==="categorical"&&pe in A?[new i.V(re.key,me,"stop domain values must be unique")]:(A[pe]=!0,[])):[new i.V(re.key,me,`integer expected, found ${String(pe)}`)]}}function kt(y){const s=(y.expressionContext==="property"?i.W:i.X)(i.U(y.value),y.valueSpec);if(s.result==="error")return s.value.map(g=>new i.V(`${y.key}${g.key}`,y.value,g.message));const u=s.value.expression||s.value._styleExpression.expression;if(y.expressionContext==="property"&&y.propertyKey==="text-font"&&!u.outputDefined())return[new i.V(y.key,y.value,`Invalid data expression for "${y.propertyKey}". Output values must be contained as literals within the expression.`)];if(y.expressionContext==="property"&&y.propertyType==="layout"&&!i.Y(u))return[new i.V(y.key,y.value,'"feature-state" data expressions are not supported with layout properties.')];if(y.expressionContext==="filter")return fr(u,y);if(y.expressionContext&&y.expressionContext.indexOf("cluster")===0){if(!i.Z(u,["zoom","feature-state"]))return[new i.V(y.key,y.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(y.expressionContext==="cluster-initial"&&!i._(u))return[new i.V(y.key,y.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fr(y,s){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const x of s.valueSpec.expression.parameters)u.delete(x);if(u.size===0)return[];const g=[];return y instanceof i.$&&u.has(y.name)?[new i.V(s.key,s.value,`["${y.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(y.eachChild(x=>{g.push(...fr(x,s))}),g)}function dr(y){const s=y.key,u=y.value,g=y.valueSpec,x=[];return Array.isArray(g.values)?g.values.indexOf(i.M(u))===-1&&x.push(new i.V(s,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(i.M(u))===-1&&x.push(new i.V(s,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),x}function ar(y){return i.a1(i.U(y.value))?kt(i.L({},y,{expressionContext:"filter",valueSpec:y.styleSpec[`filter_${y.layerType||"fill"}`]})):Yt(y)}function Yt(y){const s=y.value,u=y.key;if(i.K(s)!=="array")return[new i.V(u,s,`array expected, ${i.K(s)} found`)];const g=y.styleSpec;let x,S=[];if(s.length<1)return[new i.V(u,s,"filter array must have at least 1 element")];switch(S=S.concat(dr({key:`${u}[0]`,value:s[0],valueSpec:g.filter_operator,style:y.style,styleSpec:y.styleSpec})),i.M(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&i.M(s[1])==="$type"&&S.push(new i.V(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&S.push(new i.V(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(x=i.K(s[1]),x!=="string"&&S.push(new i.V(`${u}[1]`,s[1],`string expected, ${x} found`)));for(let A=2;A<s.length;A++)x=i.K(s[A]),i.M(s[1])==="$type"?S=S.concat(dr({key:`${u}[${A}]`,value:s[A],valueSpec:g.geometry_type,style:y.style,styleSpec:y.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&S.push(new i.V(`${u}[${A}]`,s[A],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let A=1;A<s.length;A++)S=S.concat(Yt({key:`${u}[${A}]`,value:s[A],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":x=i.K(s[1]),s.length!==2?S.push(new i.V(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):x!=="string"&&S.push(new i.V(`${u}[1]`,s[1],`string expected, ${x} found`))}return S}function Zr(y,s){const u=y.key,g=y.style,x=y.layer,S=y.styleSpec,A=y.value,L=y.objectKey,z=S[`${s}_${y.layerType}`];if(!z)return[];const U=L.match(/^(.*)-use-theme$/);if(s==="paint"&&U&&z[U[1]])return i.S(A)?[].concat(Wt({key:y.key,value:A,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:S,expressionContext:"property",propertyType:s,propertyKey:L})):Wt({key:u,value:A,valueSpec:{type:"string"},style:g,styleSpec:S});const V=L.match(/^(.*)-transition$/);if(s==="paint"&&V&&z[V[1]]&&z[V[1]].transition)return Wt({key:u,value:A,valueSpec:S.transition,style:g,styleSpec:S});const X=y.valueSpec||z[L];if(!X)return[new i.J(u,A,`unknown property "${L}"`)];let Y;if(i.K(A)==="string"&&i.O(X)&&!X.tokens&&(Y=/^{([^}]+)}$/.exec(A))){const ce=`\`{ "type": "identity", "property": ${Y?JSON.stringify(Y[1]):'"_"'} }\``;return[new i.V(u,A,`"${L}" does not support interpolation syntax
Use an identity property function instead: ${ce}.`)]}const re=[];if(y.layerType==="symbol")L!=="text-field"||!g||g.glyphs||g.imports||re.push(new i.V(u,A,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&i.a2(i.U(A))&&i.M(A.type)==="identity"&&re.push(new i.V(u,A,'"text-font" does not support identity functions'));else if(y.layerType==="model"&&s==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.O(X)&&(i.a3(X)||i.Q(X))){const ce=i.W(i.U(A),X),se=ce.value.expression||ce.value._styleExpression.expression;se&&!i.Z(se,["measure-light"])&&(L==="model-emissive-strength"&&i._(se)&&i.Y(se)||re.push(new i.V(u,A,`${L} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return re.concat(Wt({key:y.key,value:A,valueSpec:X,style:g,styleSpec:S,expressionContext:"property",propertyType:s,propertyKey:L}))}function oi(y){return Zr(y,"paint")}function Bn(y){return Zr(y,"layout")}function Ti(y){let s=[];const u=y.value,g=y.key,x=y.style,S=y.styleSpec;u.type||u.ref||s.push(new i.V(g,u,'either "type" or "ref" is required'));let A=i.M(u.type);const L=i.M(u.ref);if(u.id){const z=i.M(u.id);for(let U=0;U<y.arrayIndex;U++){const V=x.layers[U];i.M(V.id)===z&&s.push(new i.V(g,u.id,`duplicate layer id "${u.id}", previously used at line ${V.id.__line__}`))}}if("ref"in u){let z;["type","source","source-layer","filter","layout"].forEach(U=>{U in u&&s.push(new i.V(g,u[U],`"${U}" is prohibited for ref layers`))}),x.layers.forEach(U=>{i.M(U.id)===L&&(z=U)}),z?z.ref?s.push(new i.V(g,u.ref,"ref cannot reference another ref layer")):A=i.M(z.type):typeof L=="string"&&s.push(new i.V(g,u.ref,`ref layer "${L}" not found`))}else if(A!=="background"&&A!=="sky"&&A!=="slot")if(u.source){const z=x.sources&&x.sources[u.source],U=z&&i.M(z.type);z?U==="vector"&&A==="raster"?s.push(new i.V(g,u.source,`layer "${u.id}" requires a raster source`)):U==="raster"&&A!=="raster"?s.push(new i.V(g,u.source,`layer "${u.id}" requires a vector source`)):U!=="vector"||u["source-layer"]?U==="raster-dem"&&A!=="hillshade"?s.push(new i.V(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):U!=="raster-array"||["raster","raster-particle"].includes(A)?A!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||U==="geojson"&&z.lineMetrics?A==="raster-particle"&&U!=="raster-array"&&s.push(new i.V(g,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):s.push(new i.V(g,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new i.V(g,u.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new i.V(g,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new i.V(g,u.source,`source "${u.source}" not found`))}else s.push(new i.V(g,u,'missing required property "source"'));return s=s.concat(Fr({key:g,value:u,valueSpec:S.layer,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Wt({key:`${g}.type`,value:u.type,valueSpec:S.layer.type,style:y.style,styleSpec:y.styleSpec,object:u,objectKey:"type"}),filter:z=>ar(i.L({layerType:A},z)),layout:z=>Fr({layer:u,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":U=>Bn(i.L({layerType:A},U))}}),paint:z=>Fr({layer:u,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":U=>oi(i.L({layerType:A,layer:u},U))}})}})),s}function So(y){const s=y.value,u=y.key,g=i.K(s);return g!=="string"?[new i.V(u,s,`string expected, ${g} found`)]:[]}const Wo={promoteId:function y({key:s,value:u}){if(i.K(u)==="string")return So({key:s,value:u});if(Array.isArray(u)){const g=[],x=i.U(u),S=i.X(x);return S.result==="error"&&S.value.forEach(A=>{g.push(new i.V(`${s}${A.key}`,null,`${A.message}`))}),i.Z(S.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new i.V(`${s}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const x in u)g.push(...y({key:`${s}.${x}`,value:u[x]}));return g}}};function la(y){const s=y.value,u=y.key,g=y.styleSpec,x=y.style;if(!s.type)return[new i.V(u,s,'"type" is required')];const S=i.M(s.type);let A=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&(s.url||s.tiles||A.push(new i.J(u,s,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return A=A.concat(Fr({key:u,value:s,valueSpec:g[`source_${S.replace("-","_")}`],style:y.style,styleSpec:g,objectElementValidators:Wo})),A;case"geojson":if(A=Fr({key:u,value:s,valueSpec:g.source_geojson,style:x,styleSpec:g,objectElementValidators:Wo}),s.cluster)for(const L in s.clusterProperties){const[z,U]=s.clusterProperties[L],V=typeof z=="string"?[z,["accumulated"],["get",L]]:z;A.push(...kt({key:`${u}.${L}.map`,value:U,expressionContext:"cluster-map"})),A.push(...kt({key:`${u}.${L}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return A;case"video":return Fr({key:u,value:s,valueSpec:g.source_video,style:x,styleSpec:g});case"image":return Fr({key:u,value:s,valueSpec:g.source_image,style:x,styleSpec:g});case"canvas":return[new i.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dr({key:`${u}.type`,value:s.type,valueSpec:{values:ys(g)},style:x,styleSpec:g})}}function ys(y){return y.source.reduce((s,u)=>{const g=y[u];return g.type.type==="enum"&&(s=s.concat(Object.keys(g.type.values))),s},[])}function Ba(y){const s=y.value,u=y.styleSpec,g=u.light,x=y.style;let S=[];const A=i.K(s);if(s===void 0)return S;if(A!=="object")return S=S.concat([new i.V("light",s,`object expected, ${A} found`)]),S;for(const L in s){const z=L.match(/^(.*)-transition$/),U=L.match(/^(.*)-use-theme$/);S=S.concat(U&&g[U[1]]?Wt({key:L,value:s[L],valueSpec:{type:"string"},style:x,styleSpec:u}):z&&g[z[1]]&&g[z[1]].transition?Wt({key:L,value:s[L],valueSpec:u.transition,style:x,styleSpec:u}):g[L]?Wt({key:L,value:s[L],valueSpec:g[L],style:x,styleSpec:u}):[new i.V(L,s[L],`unknown property "${L}"`)])}return S}function vs(y){const s=y.value;let u=[];if(!s)return u;const g=i.K(s);if(g!=="object")return u=u.concat([new i.V("light-3d",s,`object expected, ${g} found`)]),u;const x=y.styleSpec,S=x["light-3d"],A=y.key,L=y.style,z=y.style.lights;for(const X of["type","id"])if(!(X in s))return u=u.concat([new i.V("light-3d",s,`missing property ${X} on light`)]),u;if(s.type&&z)for(let X=0;X<y.arrayIndex;X++){const Y=i.M(s.type),re=z[X];i.M(re.type)===Y&&u.push(new i.V(A,s.id,`duplicate light type "${s.type}", previously defined at line ${re.id.__line__}`))}const U=`properties_light_${s.type}`;if(!(U in x))return u=u.concat([new i.V("light-3d",s,`Invalid light type ${s.type}`)]),u;const V=x[U];for(const X in s)if(X==="properties"){const Y=s[X],re=i.K(Y);if(re!=="object")return u=u.concat([new i.V("properties",Y,`object expected, ${re} found`)]),u;for(const ce in Y)u=u.concat(V[ce]?Wt({key:ce,value:Y[ce],valueSpec:V[ce],style:L,styleSpec:x}):[new i.J(y.key,Y[ce],`unknown property "${ce}"`)])}else{const Y=X.match(/^(.*)-transition$/),re=X.match(/^(.*)-use-theme$/);u=u.concat(re&&S[re[1]]?Wt({key:X,value:s[X],valueSpec:{type:"string"},style:L,styleSpec:x}):Y&&S[Y[1]]&&S[Y[1]].transition?Wt({key:X,value:s[X],valueSpec:x.transition,style:L,styleSpec:x}):S[X]?Wt({key:X,value:s[X],valueSpec:S[X],style:L,styleSpec:x}):[new i.J(X,s[X],`unknown property "${X}"`)])}return u}function go(y){const s=y.value,u=y.key,g=y.style,x=y.styleSpec,S=x.terrain;let A=[];const L=i.K(s);if(s===void 0||L==="null")return A;if(L!=="object")return A=A.concat([new i.V("terrain",s,`object expected, ${L} found`)]),A;for(const z in s){const U=z.match(/^(.*)-transition$/),V=z.match(/^(.*)-use-theme$/);A=A.concat(V&&S[V[1]]?Wt({key:z,value:s[z],valueSpec:{type:"string"},style:g,styleSpec:x}):U&&S[U[1]]&&S[U[1]].transition?Wt({key:z,value:s[z],valueSpec:x.transition,style:g,styleSpec:x}):S[z]?Wt({key:z,value:s[z],valueSpec:S[z],style:g,styleSpec:x}):[new i.J(z,s[z],`unknown property "${z}"`)])}if(s.source){const z=g.sources&&g.sources[s.source],U=z&&i.M(z.type);z?U!=="raster-dem"&&A.push(new i.V(u,s.source,`terrain cannot be used with a source of type ${String(U)}, it only be used with a "raster-dem" source type`)):A.push(new i.V(u,s.source,`source "${s.source}" not found`))}else A.push(new i.V(u,s,'terrain is missing required property "source"'));return A}function ca(y){const s=y.value,u=y.style,g=y.styleSpec,x=g.fog;let S=[];const A=i.K(s);if(s===void 0)return S;if(A!=="object")return S=S.concat([new i.V("fog",s,`object expected, ${A} found`)]),S;for(const L in s){const z=L.match(/^(.*)-transition$/),U=L.match(/^(.*)-use-theme$/);S=S.concat(U&&x[U[1]]?Wt({key:L,value:s[L],valueSpec:{type:"string"},style:u,styleSpec:g}):z&&x[z[1]]&&x[z[1]].transition?Wt({key:L,value:s[L],valueSpec:g.transition,style:u,styleSpec:g}):x[L]?Wt({key:L,value:s[L],valueSpec:x[L],style:u,styleSpec:g}):[new i.J(L,s[L],`unknown property "${L}"`)])}return S}const ai={"*":()=>[],array:Ln,boolean:function(y){const s=y.value,u=y.key,g=i.K(s);return g!=="boolean"?[new i.V(u,s,`boolean expected, ${g} found`)]:[]},number:Ge,color:function(y){const s=y.key,u=y.value,g=i.K(u);return g!=="string"?[new i.V(s,u,`color expected, ${g} found`)]:i.a0.parseCSSColor(u)===null?[new i.V(s,u,`color expected, "${u}" found`)]:[]},enum:dr,filter:ar,function:vt,layer:Ti,object:Fr,source:la,model:i.a4,light:Ba,"light-3d":vs,terrain:go,fog:ca,string:So,formatted:function(y){return So(y).length===0?[]:kt(y)},resolvedImage:function(y){return So(y).length===0?[]:kt(y)},projection:function(y){const s=y.value,u=y.styleSpec,g=u.projection,x=y.style;let S=[];const A=i.K(s);if(A==="object")for(const L in s)S=S.concat(Wt({key:L,value:s[L],valueSpec:g[L],style:x,styleSpec:u}));else A!=="string"&&(S=S.concat([new i.V("projection",s,`object or string expected, ${A} found`)]));return S},import:function(y){const{value:s,styleSpec:u}=y,{data:g,...x}=s;Object.defineProperty(x,"__line__",{value:s.__line__,enumerable:!1});let S=Fr(i.L({},y,{value:x,valueSpec:u.import}));return i.M(x.id)===""&&S.push(new i.V(`${y.key}.id`,x,"import id can't be an empty string")),g&&(S=S.concat(Xr(g,u,{key:`${y.key}.data`}))),S},iconset:function(y){const s=y.value,u=y.key,g=y.styleSpec,x=y.style;if(!s.type)return[new i.V(u,s,'"type" is required')];const S=i.M(s.type);let A=[];if(A=A.concat(Fr({key:u,value:s,valueSpec:g[`iconset_${S}`],style:x,styleSpec:g})),S==="source"&&s.source){const L=x.sources&&x.sources[s.source],z=L&&i.M(L.type);L?z!=="raster-array"&&A.push(new i.V(u,s.source,`iconset cannot be used with a source of type ${String(z)}, it only be used with a "raster-array" source type`)):A.push(new i.V(u,s.source,`source "${s.source}" not found`))}return A}};function Wt(y,s=!1){const u=y.value,g=y.valueSpec,x=y.styleSpec;if(g.expression&&i.a2(i.M(u)))return vt(y);if(g.expression&&i.S(i.U(u)))return kt(y);if(g.type&&ai[g.type]){const S=ai[g.type](y);return s===!0&&S.length>0&&i.K(y.value)==="array"?kt(y):S}return Fr(i.L({},y,{valueSpec:g.type?x[g.type]:g}))}function Hr(y){const s=y.value,u=y.key,g=So(y);return g.length||(s.indexOf("{fontstack}")===-1&&g.push(new i.V(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&g.push(new i.V(u,s,'"glyphs" url must include a "{range}" token'))),g}function Xr(y,s=i.a5,u={}){return Wt({key:u.key||"",value:y,valueSpec:s.$root,styleSpec:s,style:y,objectElementValidators:{glyphs:Hr,"*":()=>[]}})}function cn(y,s=i.a5){return qe(Xr(y,s))}const fn=y=>qe(la(y)),ao=y=>qe(Ba(y)),Xi=y=>qe(vs(y)),Jo=y=>qe(go(y)),Ma=y=>qe(ca(y)),_s=y=>qe(function(s){const u=s.value,g=s.style,x=s.styleSpec,S=x.snow;let A=[];const L=i.K(u);if(u===void 0)return A;if(L!=="object")return A=A.concat([new i.V("snow",u,`object expected, ${L} found`)]),A;for(const z in u){const U=z.match(/^(.*)-transition$/);A=A.concat(U&&S[U[1]]&&S[U[1]].transition?Wt({key:z,value:u[z],valueSpec:x.transition,style:g,styleSpec:x}):S[z]?Wt({key:z,value:u[z],valueSpec:S[z],style:g,styleSpec:x}):[new i.J(z,u[z],`unknown property "${z}"`)])}return A}(y)),ft=y=>qe(function(s){const u=s.value,g=s.style,x=s.styleSpec,S=x.rain;let A=[];const L=i.K(u);if(u===void 0)return A;if(L!=="object")return A=A.concat([new i.V("rain",u,`object expected, ${L} found`)]),A;for(const z in u){const U=z.match(/^(.*)-transition$/);A=A.concat(U&&S[U[1]]&&S[U[1]].transition?Wt({key:z,value:u[z],valueSpec:x.transition,style:g,styleSpec:x}):S[z]?Wt({key:z,value:u[z],valueSpec:S[z],style:g,styleSpec:x}):[new i.J(z,u[z],`unknown property "${z}"`)])}return A}(y)),fe=y=>qe(Ti(y)),ye=y=>qe(ar(y)),Me=y=>qe(oi(y)),$e=y=>qe(Bn(y)),Ne=y=>qe(i.a4(y));function qe(y){return y.slice().sort((s,u)=>s.line&&u.line?s.line-u.line:0)}function ut(y,s){let u=!1;if(s&&s.length)for(const g of s)g instanceof i.J?i.w(g.message):(y.fire(new i.z(new Error(g.message))),u=!0);return u}let Ye;class pt extends i.E{constructor(s,u="flat"){super(),this._transitionable=new i.a6(Ye||(Ye=new i.a7({anchor:new i.a8(i.a5.light.anchor),position:new i.a9(i.a5.light.position),color:new i.a8(i.a5.light.color),intensity:new i.a8(i.a5.light.intensity)}))),this.setLight(s,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u,g={}){this._validate(ao,s,g)||(this._transitionable.setTransitionOrValue(s),this.id=u)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,g){return(!g||g.validate!==!1)&&ut(this,s.call(cn,i.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let _t=class extends i.E{constructor(y,s,u,g){super(),this.scope=u,this._transitionable=new i.a6(new i.a7({source:new i.a8(i.a5.terrain.source),exaggeration:new i.a8(i.a5.terrain.exaggeration)}),u,g),this._transitionable.setTransitionOrValue(y,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(y,s){this._transitionable.setTransitionOrValue(y,s)}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}getExaggeration(y){return this._transitioning.possiblyEvaluate(new i.aa(y)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const y=this._transitionable._values.exaggeration;if(!y)return null;const s=y.value.expression;if(!s)return null;let u=-1,g=-1,x=1;for(const S of s.zoomStops)x=s.evaluate(new i.aa(S)),x>.01?(u=S,g=-1):g=S;return x<.01&&u>0&&g>u?[u,g]:null}isZoomDependent(){const y=this._transitionable._values.exaggeration;return y!=null&&y.value!=null&&y.value.expression!=null&&y.value.expression instanceof i.ab}};const gt=45,Nt=65,Kt=.05;function rr(y,s,u,g){const x=i.ae(gt,Nt,u),[S,A]=Dr(y,g);let L=1-Math.min(1,Math.exp((s-S)/(A-S)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*x*y.alpha}function Dr(y,s){const u=.5/Math.tan(.5*s);return[y.range[0]+u,y.range[1]+u]}function Ur(y,s,u,g,x){const S=i.ad.vec3.transformMat4([],[s,u,g],x.mercatorFogMatrix);return rr(y,i.ad.vec3.length(S),x.pitch,x._fov)}function Vr(y,s,u,g,x,S,A){const L=[[u,g,0],[x,g,0],[x,S,0],[u,S,0]];let z=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(const V of L){const X=i.ad.vec3.transformMat4([],V,s),Y=i.ad.vec3.length(X);z=Math.min(z,Y),U=Math.max(U,Y)}return[rr(y,z,A.pitch,A._fov),rr(y,U,A.pitch,A._fov)]}class qr extends i.E{constructor(s,u,g,x){super();const S=new i.a7({range:new i.a8(i.a5.fog.range),color:new i.a8(i.a5.fog.color),"color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a8(i.a5.fog["high-color"]),"high-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a8(i.a5.fog["space-color"]),"space-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a8(i.a5.fog["horizon-blend"]),"star-intensity":new i.a8(i.a5.fog["star-intensity"]),"vertical-range":new i.a8(i.a5.fog["vertical-range"])});this._transitionable=new i.a6(S,g,new Map(x)),this.set(s,x),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new i.af(S),this.scope=g}get state(){const s=this._transform,u=s.projection.name==="globe",g=i.ag(s.zoom),x=this.properties.get("range"),S=[.5,3];return{range:u?[i.ah(S[0],x[0],g),i.ah(S[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,u,g={}){if(this._validate(Ma,s,g))return;const x=i.l({},s);for(const S of Object.keys(i.a5.fog))x[S]===void 0&&(x[S]=i.a5.fog[S].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ae(gt,Nt,s))*u.a}getOpacityAtLatLng(s,u){return this._transform.projection.supportsFog?function(g,x,S){const A=i.ac.fromLngLat(x),L=S.elevation?S.elevation.getAtPointOrZero(A):0;return Ur(g,A.x,A.y,L,S)}(this.state,s,u):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(s.toUnwrapped());return Vr(this.state,u,0,0,i.ai,i.ai,this._transform)}getOpacityForBounds(s,u,g,x,S){return this._transform.projection.supportsFog?Vr(this.state,s,u,g,x,S,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Dr(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const g of u){const x=s.points[g];let S;if(x[2]>=0)S=x;else{const A=s.points[g-4];S=i.aj(A,x,A[2]/(A[2]-x[2]))}if(Ur(this.state,S[0],S[1],0,this._transform)>=Kt)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,g){return(!g||g.validate!==!1)&&ut(this,s.call(cn,i.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let Jn,bi,en,Pn,In=class extends i.E{constructor(y,s,u,g){super();const x=Jn||(Jn=new i.a7({density:new i.a8(i.a5.snow.density),intensity:new i.a8(i.a5.snow.intensity),color:new i.a8(i.a5.snow.color),opacity:new i.a8(i.a5.snow.opacity),vignette:new i.a8(i.a5.snow.vignette),"vignette-color":new i.a8(i.a5.snow["vignette-color"]),"center-thinning":new i.a8(i.a5.snow["center-thinning"]),direction:new i.a8(i.a5.snow.direction),"flake-size":new i.a8(i.a5.snow["flake-size"])}));this._transitionable=new i.a6(x,u,new Map(g)),this.set(y,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.af(x),this.scope=u}get state(){const y=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),g=i.ak(u[0]),x=-Math.max(i.ak(u[1]),.01),S=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette"),L=this.properties.get("vignette-color");return L.a=A,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.al(s.r,s.g,s.b,s.a*y),direction:S,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:L}}get(){return this._transitionable.serialize()}set(y,s,u={}){if(this._validate(_s,y,u))return;const g=i.l({},y);for(const x of Object.keys(i.a5.snow))g[x]===void 0&&(g[x]=i.a5.snow[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(y){this._transitionable.setTransitionOrValue(this._options,new Map(y))}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}_validate(y,s,u){return(!u||u.validate!==!1)&&ut(this,y.call(cn,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}},Rn=class extends i.E{constructor(y,s,u,g){super();const x=bi||(bi=new i.a7({density:new i.a8(i.a5.rain.density),intensity:new i.a8(i.a5.rain.intensity),color:new i.a8(i.a5.rain.color),opacity:new i.a8(i.a5.rain.opacity),vignette:new i.a8(i.a5.rain.vignette),"vignette-color":new i.a8(i.a5.rain["vignette-color"]),"center-thinning":new i.a8(i.a5.rain["center-thinning"]),direction:new i.a8(i.a5.rain.direction),"droplet-size":new i.a8(i.a5.rain["droplet-size"]),"distortion-strength":new i.a8(i.a5.rain["distortion-strength"])}));this._transitionable=new i.a6(x,u,new Map(g)),this.set(y,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.af(x),this.scope=u}get state(){const y=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),g=i.ak(u[0]),x=-Math.max(i.ak(u[1]),.01),S=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette-color");return A.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.al(s.r,s.g,s.b,s.a*y),direction:S,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:A}}get(){return this._transitionable.serialize()}set(y,s,u={}){if(this._validate(ft,y,u))return;const g=i.l({},y);for(const x of Object.keys(i.a5.rain))g[x]===void 0&&(g[x]=i.a5.rain[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(y){this._transitionable.setTransitionOrValue(this._options,new Map(y))}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}_validate(y,s,u){return(!u||u.validate!==!1)&&ut(this,y.call(cn,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}};class ji extends i.E{constructor(s,u,g,x){super(),this.scope=g,this._options=s,this.properties=new i.af(u),this._transitionable=new i.a6(u,g,new Map(x)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,u){this._options=s,this._transitionable.setTransitionOrValue(s.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Do{constructor(s,u,g,x){this.screenBounds=s,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(s,u){let g,x;if(s instanceof i.P||typeof s[0]=="number"){const S=i.P.convert(s);g=[S],x=u.isPointAboveHorizon(S)}else{const S=i.P.convert(s[0]),A=i.P.convert(s[1]);g=[S,A],x=i.an(S,A).every(L=>u.isPointAboveHorizon(L))}return new Do(g,u.getCameraPoint(),x,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return i.an(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.an(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),i.ao(x,s)}bufferedCameraGeometryGlobe(s){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.an(u,g,s),S=this.cameraPoint.clone();switch(3*((S.y>u.y)+(S.y>g.y))+((S.x>u.x)+(S.x>g.x))){case 0:x[0]=S,x[4]=S.clone();break;case 1:x.splice(1,0,S);break;case 2:x[1]=S;break;case 3:x.splice(4,0,S);break;case 5:x.splice(2,0,S);break;case 6:x[3]=S;break;case 7:x.splice(3,0,S);break;case 8:x[2]=S}return x}containsTile(s,u,g,x=0){const S=s.queryPadding/u._pixelsPerMercatorPixel+1,A=g?this._bufferedCameraMercator(S,u):this._bufferedScreenMercator(S,u);let L=s.tileID.wrap+(A.unwrapped?x:0);const z=A.polygon.map(pe=>i.ap(s.tileTransform,pe,L));if(!i.aq(z,0,0,i.ai,i.ai))return;L=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const U=this.screenGeometryMercator.polygon.map(pe=>i.ar(s.tileTransform,pe,L)),V=U.map(pe=>new i.P(pe[0],pe[1])),X=u.getFreeCameraOptions().position||new i.ac(0,0,0),Y=i.ar(s.tileTransform,X,L),re=U.map(pe=>{const me=i.ad.vec3.sub(pe,pe,Y);return i.ad.vec3.normalize(me,me),new i.as(Y,me)}),ce=i.at(s,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:re,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(se=i.au(z),se.min.x=i.ay(se.min.x,0,i.ai),se.min.y=i.ay(se.min.y,0,i.ai),se.max.x=i.ay(se.max.x,0,i.ai),se.max.y=i.ay(se.max.y,0,i.ai),se),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ce};var se}_bufferedScreenMercator(s,u){const g=Pa(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),u):{polygon:this.bufferedScreenGeometry(s).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(s,u){const g=Pa(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),u):{polygon:this.bufferedCameraGeometry(s).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(s,u){const g=function(S,A){const L=i.ad.mat4.multiply([],A.pixelMatrix,A.globeMatrix),z=[0,-i.az,0,1],U=[0,i.az,0,1],V=[0,0,0,1];i.ad.vec4.transformMat4(z,z,L),i.ad.vec4.transformMat4(U,U,L),i.ad.vec4.transformMat4(V,V,L);const X=new i.P(z[0]/z[3],z[1]/z[3]),Y=new i.P(U[0]/U[3],U[1]/U[3]),re=i.aw(S,X)&&z[3]<V[3],ce=i.aw(S,Y)&&U[3]<V[3];if(!re&&!ce)return null;const se=function(Ie,Oe,ze){for(let Ve=1;Ve<Ie.length;Ve++){const dt=Hs(Oe.pointCoordinate3D(Ie[Ve-1]).x),rt=Hs(Oe.pointCoordinate3D(Ie[Ve]).x);if(ze<0){if(dt<rt)return{idx:Ve,t:-dt/(rt-1-dt)}}else if(rt<dt)return{idx:Ve,t:(1-dt)/(rt+1-dt)}}return null}(S,A,re?-1:1);if(!se)return null;const{idx:pe,t:me}=se;let be=pe>1?ua(S.slice(0,pe),A):[],Ee=pe<S.length?ua(S.slice(pe),A):[];be=be.map(Ie=>new i.P(Hs(Ie.x),Ie.y)),Ee=Ee.map(Ie=>new i.P(Hs(Ie.x),Ie.y));const Te=[...be];Te.length===0&&Te.push(Ee[Ee.length-1]);const Re=i.ah(Te[Te.length-1].y,(Ee.length===0?be[0]:Ee[0]).y,me);let Pe;return Pe=re?[new i.P(0,Re),new i.P(0,0),new i.P(1,0),new i.P(1,Re)]:[new i.P(1,Re),new i.P(1,1),new i.P(0,1),new i.P(0,Re)],Te.push(...Pe),Ee.length===0?Te.push(be[0]):Te.push(...Ee),{polygon:Te.map(Ie=>new i.ac(Ie.x,Ie.y)),unwrapped:!1}}(s,u);if(g)return g;const x=function(S,A){let L=!1,z=-1/0,U=0;for(let X=0;X<S.length-1;X++)S[X].x>z&&(z=S[X].x,U=X);for(let X=0;X<S.length-1;X++){const Y=(U+X)%(S.length-1),re=S[Y],ce=S[Y+1];Math.abs(re.x-ce.x)>.5&&(re.x<ce.x?(re.x+=1,Y===0&&(S[S.length-1].x+=1)):(ce.x+=1,Y+1===S.length-1&&(S[0].x+=1)),L=!0)}const V=i.av(A.center.lng);return L&&V<Math.abs(V-1)&&S.forEach(X=>{X.x-=1}),{polygon:S,unwrapped:L}}(ua(s,u).map(S=>new i.P(Hs(S.x),S.y)),u);return{polygon:x.polygon.map(S=>new i.ac(S.x,S.y)),unwrapped:x.unwrapped}}}function ua(y,s){return i.ax(y,u=>{const g=s.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function Hs(y){return y<0?1+y%1:y%1}function Pa(y){return 100*y|0}function Lo(y,s,u,g,x){const S=function(L,z){if(L)return x(L);if(z){if(y.url&&z.tiles&&y.tiles&&delete y.tiles,z.variants){if(!Array.isArray(z.variants))return x(new Error("variants must be an array"));for(const V of z.variants){if(V==null||typeof V!="object"||V.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(V.capabilities))return x(new Error("capabilities must be an array"));if(V.capabilities.length===1&&V.capabilities[0]==="meshopt"){z=i.l(z,V);break}}}const U=i.aA(i.l({},z,y),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);U.tiles=s.canonicalizeTileset(U,y.url),x(null,U)}},A=function(L,z,U){if(!L)return null;if(!z&&!U)return L;U=U||L.worldview_default;const V=Object.values(L.language||{});if(V.length===0)return null;const X=Object.values(L.worldview||{});if(X.length===0)return null;const Y=V.every(ce=>ce===z),re=X.every(ce=>ce===U);return Y&&re?L:z in(L.language_options||{})||U in(L.worldview_options||{})?null:L.language_options&&L.worldview_options?L:null}(y.data,u,g);return A?i.q.frame(()=>S(null,A)):y.url?i.n(s.transformRequest(s.normalizeSourceURL(y.url,null,u,g),i.R.Source),S):i.q.frame(()=>{const{data:L,...z}=y;S(null,z)})}class Go{constructor(s,u,g){this.bounds=i.aB.convert(this.validateBounds(s)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const u=Math.pow(2,s.z),g=Math.floor(i.av(this.bounds.getWest())*u),x=Math.floor(i.aC(this.bounds.getNorth())*u),S=Math.ceil(i.av(this.bounds.getEast())*u),A=Math.ceil(i.aC(this.bounds.getSouth())*u);return s.x>=g&&s.x<S&&s.y>=x&&s.y<A}}class gf extends i.E{constructor(s,u,g,x){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.aA(u,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aD}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Lo(this._options,this.map._requestManager,u,g,(x,S)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new i.z(x));else if(S){if(i.l(this,S),this.hasWorldviews=!!S.worldview_options,S.worldview_default&&(this.worldviewDefault=S.worldview_default),S.vector_layers){this.vectorLayers=S.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const A of S.vector_layers)this.vectorLayerIds.push(A.id),S.worldview&&S.worldview[A.source]&&this.localizableLayerIds.add(A.id)}S.bounds&&(this.tileBounds=new Go(S.bounds,this.minzoom,this.maxzoom)),Bt(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}s&&s(x)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(s,u){const g=s.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(g),S=this.map._requestManager.transformRequest(x,i.R.Tile),A=this.map.style?this.map.style.getLut(this.scope):null,L=A?{image:A.image.clone()}:null,z={request:S,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:L,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(g)&&(z.worldview=this.map.getWorldview()||this.worldviewDefault,z.localizableLayerIds=this.localizableLayerIds),z.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=u:s.request=s.actor.send("reloadTile",z,U.bind(this));else if(s.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",z,U.bind(this),void 0,!0);else{const V=i.aE.call({deduped:this._deduped},z,(X,Y)=>{X||!Y?U.call(this,X):(z.data={cacheControl:Y.cacheControl,expires:Y.expires,rawData:Y.rawData.slice(0)},s.actor&&s.actor.send("loadTile",z,U.bind(this),void 0,!0))},!0);s.request={cancel:V}}function U(V,X){return delete s.request,s.aborted?u(null):V&&V.status!==404?u(V):(X&&X.resourceTiming&&(s.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&s.setExpiryData(X),s.loadVectorData(X,this.map.painter),i.aF(this.dispatcher),u(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Zs extends i.E{constructor(s,u,g,x){super(),this.id=s,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},u),i.l(this,i.aA(u,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._tileJSONRequest=Lo(this._options,this.map._requestManager,null,null,(u,g)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new i.z(u)):g&&(i.l(this,g),g.raster_layers&&(this.rasterLayers=g.raster_layers,this.rasterLayerIds=this.rasterLayers.map(x=>x.id)),g.bounds&&(this.tileBounds=new Go(g.bounds,this.minzoom,this.maxzoom)),Bt(g.tiles),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),s&&s(u)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,u){const g=i.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=i.o(this.map._requestManager.transformRequest(x,i.R.Tile),(S,A,L,z)=>(delete s.request,s.aborted?(s.state="unloaded",u(null)):S?(s.state="errored",u(S)):A?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:L,expires:z}),s.setTexture(A,this.map.painter),s.state="loaded",i.aF(this.dispatcher),void u(null)):u(null)))}abortTile(s,u){s.request&&(s.request.cancel(),delete s.request),u&&u()}unloadTile(s,u){s.texture&&s.texture instanceof i.T?(s.destroy(!0),s.texture&&s.texture instanceof i.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class $c extends Zs{constructor(s,u,g,x){super(s,u,g,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this.iconsets={},this._options=i.l({type:"raster-array"},u)}triggerRepaint(s){const u=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);u&&u.enabled&&g&&u._clearRenderCacheForTile(g.id,s.tileID),this.map.triggerRepaint()}loadTile(s,u){const g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,i.R.Tile),S={request:x,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=x,s.actor||(s.actor=this.dispatcher.getActor());const A=(L,z,U,V)=>{if(delete s.request,s.aborted)return s.state="unloaded",u(null);if(L)return L.name==="AbortError"?void 0:(s.state="errored",u(L));if(this.map._refreshExpiredTiles&&z&&s.setExpiryData({cacheControl:U,expires:V}),this.partial)s.state="empty";else{if(!z)return u(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=z;const X=new Map;for(const Y in s._mrt.layers){const re=s.getLayer(Y);if(re)for(const ce of re.getBandList()){const{bytes:se,tileSize:pe,buffer:me}=re.getBandView(ce),be=pe+2*me,Ee={data:new i.r({width:be,height:be},se),pixelRatio:2,sdf:!1,usvg:!1,version:0};X.set(`${Y}/${ce}`,Ee)}}for(const Y in this.iconsets)this.iconsets[Y].addIcons(X)}u(null)};s.request=this.partial?s.fetchHeader(void 0,A.bind(this)):s.actor.send("loadTile",S,A.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){const g=s.texture;g&&g instanceof i.T?(s.destroy(!0),this.map.painter.saveTileTexture(g)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,u,g){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(u,g,(x,S)=>{if(x)return s.state="errored",this.fire(new i.z(x)),void this.triggerRepaint(s);S&&(s._isHeaderLoaded=!0,s.setTexture(S,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:S})=>S===s),g=u&&u.fields,x=g&&g.bands&&g.bands;return x?x[0]:0}getTextureDescriptor(s,u,g){if(!s)return;const x=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let S=null;u instanceof i.aI?S=u.paint.get("raster-array-band"):u instanceof i.aJ&&(S=u.paint.get("raster-particle-array-band"));const A=S||this.getInitialBand(x);if(A!=null)if(s.textureDescriptor){if(!s.updateNeeded(x,A)||g)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,x,A)}addIconset(s,u){this.iconsets[s]=u,this.partial=!1}}const vb={vector:gf,raster:Zs,"raster-dem":class extends Zs{constructor(y,s,u,g){super(y,s,u,g),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(y,s){const u=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,S){x&&(y.state="errored",s(x)),S&&(y.dem=S,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",s(null))}y.request=i.o(this.map._requestManager.transformRequest(u,i.R.Tile),(function(x,S,A,L){if(delete y.request,y.aborted)y.state="unloaded",s(null);else if(x)y.state="errored",s(x);else if(S){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:A,expires:L});const z=ImageBitmap&&S instanceof ImageBitmap&&i.t(),U=1-(S.width-i.aG(S.width))/2;U<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const V=z?S:i.q.getImageData(S,U),X={uid:y.uid,tileID:y.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:V,encoding:this.encoding,padding:U};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadTile",X,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(y){const s=y.canonical,u=Math.pow(2,s.z),g=(s.x-1+u)%u,x=s.x===0?y.wrap-1:y.wrap,S=(s.x+1+u)%u,A=s.x+1===u?y.wrap+1:y.wrap,L={};return L[new i.aH(y.overscaledZ,x,s.z,g,s.y).key]={backfilled:!1},L[new i.aH(y.overscaledZ,A,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(L[new i.aH(y.overscaledZ,x,s.z,g,s.y-1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,y.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,A,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<u&&(L[new i.aH(y.overscaledZ,x,s.z,g,s.y+1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,y.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,A,s.z,S,s.y+1).key]={backfilled:!1}),L}},"raster-array":$c,geojson:class extends i.E{constructor(y,s,u,g){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=s.data,this._options=i.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const x=i.ai/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*x,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*x,extent:i.ai,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:i.ai,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*x,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}updateData(y){if(!this._options.dynamic)return this.fire(new i.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof y!="string"&&(y.type==="Feature"&&(y={type:"FeatureCollection",features:[y]}),y.type!=="FeatureCollection"))return this.fire(new i.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof y!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const u of this._data.features)s.set(u.id,u);for(const u of y.features)s.set(u.id,u);this._data.features=[...s.values()]}else this._data=y;return this._updateWorkerData(!0),this}getClusterExpansionZoom(y,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id,scope:this.scope},s),this}getClusterChildren(y,s){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id,scope:this.scope},s),this}getClusterLeaves(y,s,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:y,limit:s,offset:u},g),this}_updateWorkerData(y=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.A("dataloading",{dataType:"source"})),this._loaded=!1;const s=i.l({append:y},this.workerOptions);s.scope=this.scope;const u=this._data;typeof u=="string"?(s.request=this.map._requestManager.transformRequest(i.q.resolveURL(u),i.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(g,x)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new i.z(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(S.resourceTiming=x.resourceTiming[this.id]),y&&(this._partialReload=!0),this.fire(new i.A("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(y),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const y=i.C(this.id,this.scope);this.map.style.clearSource(y),this._updateWorkerData()}loadTile(y,s){const u=y.actor?"reloadTile":"loadTile";y.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,x=g?{image:g.image.clone()}:null,S=this._partialReload,A={type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:S};y.request=this.actor.send(u,A,(L,z)=>S&&!z?(y.state="loaded",s(null)):(delete y.request,y.destroy(),y.aborted?s(null):L?s(L):(y.loadVectorData(z,this.map.painter,u==="reloadTile"),s(null))),void 0,u==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y,s){this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id,scope:this.scope}),y.destroy()}onRemove(y){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aK{constructor(y,s,u,g){super(y,s,u,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const s of y.urls)this.urls.push(this.map._requestManager.transformRequest(s,i.R.Source).url);i.aL(this.urls,(s,u)=>{this._loaded=!0,s?this.fire(new i.z(s)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const s=this.video.seekable;y<s.start(0)||y>s.end(0)?this.fire(new i.z(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,s=y.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(y,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aK,model:class extends i.E{constructor(y,s,u,g){super(),this.id=y,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const y=[];for(const s in this._options.models){const u=this._options.models[s],g=i.aN(this.map._requestManager.transformRequest(u.uri,i.R.Model).url).then(x=>{if(!x)return;const S=i.aO(x),A=new i.aP(s,u.position,u.orientation,S);A.computeBoundsAndApplyParent(),this.models.push(A)}).catch(x=>{this.fire(new i.z(new Error(`Could not load model ${s} from ${u.uri}: ${x.message}`)))});y.push(g)}return Promise.allSettled(y).then(()=>{this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this.fire(new i.z(new Error(`Could not load models: ${s.message}`)))})}onAdd(y){this.map=y,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(y,s){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(y,s,u,g){super(),this.type="batched-model",this.id=y,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(y){this.map=y,this.load()}reload(){this.cancelTileJSONRequest();const y=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(y))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(y){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Lo(this._options,this.map._requestManager,s,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new i.z(g))):x&&(i.l(this,x),x.bounds&&(this.tileBounds=new Go(x.bounds,this.minzoom,this.maxzoom)),Bt(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),y&&y(g)})}hasTransition(){return!1}hasTile(y){return!this.tileBounds||this.tileBounds.contains(y.canonical)}loaded(){return this._loaded}loadTile(y,s){const u=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,i.R.Tile),data:void 0,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,tileSize:this.tileSize*y.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:y.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.q.devicePixelRatio,promoteId:this.promoteId};if(y.actor&&y.state!=="expired")if(y.state==="loading")y.reloadCallback=s;else{if(y.buckets){const S=Object.values(y.buckets);for(const A of S)A.dirty=!0;return void(y.state="loaded")}y.request=y.actor.send("reloadTile",g,x.bind(this))}else y.actor=this.dispatcher.getActor(),y.request=y.actor.send("loadTile",g,x.bind(this),void 0,!0);function x(S,A){return y.aborted?s(null):S&&S.status!==404?s(S):(this.map._refreshExpiredTiles&&A&&y.setExpiryData(A),y.loadModelData(A,this.map.painter),y.state="loaded",void s(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aK{constructor(y,s,u,g){super(y,s,u,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new i.z(new i.V(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.z(new i.V(`sources.${y}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new i.z(new i.V(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new i.z(new i.V(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.z(new i.V(`sources.${y}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(y){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!y&&!this._playing||this.texture instanceof i.aM||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends i.E{constructor(y,s,u,g){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Go(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.aA(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aA(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this.map=y,this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:s,y:u,z:g}=y.canonical;return this._implementation.hasTile({x:s,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,s){const{x:u,y:g,z:x}=y.tileID.canonical,S=new AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:x},{signal:S.signal})).then((function(A){return delete y.request,y.aborted?(y.state="unloaded",s(null)):A===void 0?(y.state="errored",s(null)):A===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",s(null)):function(L){return L instanceof ImageData||L instanceof HTMLCanvasElement||L instanceof ImageBitmap||L instanceof HTMLImageElement}(A)?(this.loadTileData(y,A),y.state="loaded",void s(null)):(y.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(A=>{A.name!=="AbortError"&&(y.state="errored",s(A))}),y.request.cancel=()=>S.abort()}loadTileData(y,s){y.setTexture(s,this.map.painter)}unloadTile(y,s){if(y.texture&&y.texture instanceof i.T?(y.destroy(!0),y.texture&&y.texture instanceof i.T&&this.map.painter.saveTileTexture(y.texture)):y.destroy(),this._implementation.unloadTile){const{x:u,y:g,z:x}=y.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:x})}s&&s()}abortTile(y,s){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){const y=i.C(this.id,this.scope);this.map.style.clearSource(y)}_update(){this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}}},av=function(y,s,u,g){const x=new vb[s.type](y,s,u,g);if(x.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${x.id}`);return i.aQ(["load","abort","unload","serialize","prepare"],x),x};function Um(y,s,u=""){return`${u}:${s.id||""}:${s.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:x,importId:S}=g;return`featureset:${x}${S?`:import:${S}`:""}`}}(y.target)}`}function yf(y,s,u,g=""){if(y.uniqueFeatureID){const x=Um(y,s,g);if(u.has(x))return!0;u.add(x)}return!1}function _b(y,s,u,g,x=!1){const S=s.sourceCache.transform,A=s.sourceCache.tilesIn(y,s.has3DLayers,x);A.sort(xb);const L=[];for(const z of A){const U=z.tile.queryRenderedFeatures(s,z,u,g,S,x);Object.keys(U).length&&L.push({wrappedTileID:z.tile.tileID.wrapped().key,queryResults:U})}return L.length===0?{}:function(z){const U={},V={};for(const X of z){const Y=X.queryResults,re=X.wrappedTileID,ce=V[re]=V[re]||{};for(const se in Y){const pe=Y[se],me=ce[se]=ce[se]||{},be=U[se]=U[se]||[];for(const Ee of pe)me[Ee.featureIndex]||(me[Ee.featureIndex]=!0,be.push(Ee))}}return U}(L)}function s2(y,s,u,g,x){const S={},A=g.queryRenderedSymbols(y),L=[];for(const z of Object.keys(A).map(Number))L.push(x[z]);L.sort(xb);for(const z of L){const U=z.featureIndex.lookupSymbolFeatures(A[z.bucketInstanceId],z.bucketIndex,z.sourceLayerIndex,s,u);for(const V in U){const X=S[V]=S[V]||[],Y=U[V];Y.sort((re,ce)=>{const se=z.featureSortOrder;if(se){const pe=se.indexOf(re.featureIndex);return se.indexOf(ce.featureIndex)-pe}return ce.featureIndex-re.featureIndex});for(const re of Y)X.push(re)}}return S}function l2(y,s){const u=y.getRenderableIds().map(S=>y.getTileByID(S)),g=[],x={};for(let S=0;S<u.length;S++){const A=u[S],L=A.tileID.canonical.key;x[L]||(x[L]=!0,A.querySourceFeatures(g,s))}return g}function xb(y,s){const u=y.tileID,g=s.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function vf(y,s){const u={};if(!s)return u;for(const g of y){const x=g.layerIds.map(S=>s.getLayer(S)).filter(Boolean);if(x.length!==0){g.layers=x,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(S=>x.filter(A=>A.id===S)[0]));for(const S of x)u[S.fqid]=g}}return u}const xs=32,Pl=33,Zu=new Uint16Array(8184);for(let y=0;y<2046;y++){let s=y+2,u=0,g=0,x=0,S=0,A=0,L=0;for(1&s?x=S=A=xs:u=g=L=xs;(s>>=1)>1;){const U=u+x>>1,V=g+S>>1;1&s?(x=u,S=g,u=A,g=L):(u=x,g=S,x=A,S=L),A=U,L=V}const z=4*y;Zu[z+0]=u,Zu[z+1]=g,Zu[z+2]=x,Zu[z+3]=S}const bs=new Uint16Array(2178),Ka=new Uint8Array(1089),_f=new Uint16Array(1089);function bb(y){return y===0?-.03125:y===32?.03125:0}const sv={type:2,extent:i.ai,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ai+1,0),new i.P(i.ai+1,i.ai+1),new i.P(0,i.ai+1),new i.P(0,0)]]};class Il{constructor(s,u,g,x,S){this.tileID=s,this.uid=i.aW(),this.uses=0,this.tileSize=u,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(s){const u=s+this.timeAdded;u<i.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aR(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,u,g){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=vf(s.buckets,u.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const S=this.buckets[x];if(S instanceof i.aY){if(this.hasSymbolBuckets=!0,!g)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const S=this.buckets[x];if(S instanceof i.aY&&S.hasRTLText){this.hasRTLText=!0,i.aZ();break}}this.queryPadding=0;for(const x in this.buckets){const S=this.buckets[x],A=u.style.getOwnLayer(x);if(!A)continue;const L=A.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,L)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new i.aX}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,u,g){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,vf(s.buckets,u.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const x in this.buckets){const S=this.buckets[x];S.uploadPending()&&S.upload(s)}const u=s.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new i.T(s,g.image,u.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(s,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(s,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(s,u,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,g),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=u.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(s,u,g,x,S,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const L=function(z,U){const V=i.ad.mat4.fromScaling([],[.5*z.width,.5*-z.height,1]);return i.ad.mat4.translate(V,V,[1,-1,0]),i.ad.mat4.multiply(V,V,z.calculateProjMatrix(U.toUnwrapped())),Float32Array.from(V)}(S,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:u,pixelPosMatrix:L,transform:x,availableImages:g,tileTransform:this.tileTransform})}querySourceFeatures(s,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),S=u?u.sourceLayer:"",A=x._geojsonTileLayer||x[S];if(!A)return;const L=i.a_(u&&u.filter),{z,x:U,y:V}=this.tileID.canonical,X={z,x:U,y:V};for(let Y=0;Y<A.length;Y++){const re=A.feature(Y);if(L.needGeometry){const pe=i.a$(re,!0);if(!L.filter(new i.aa(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!L.filter(new i.aa(this.tileID.overscaledZ),re))continue;const ce=g.getId(re,S),se=new i.b0(re,z,U,V,ce);se.tile=X,s.push(se)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const u=this.expirationTime;if(s.cacheControl){const g=i.b1(s.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(u)if(this.expirationTime<u)x=!0;else{const S=this.expirationTime-u;S?this.expirationTime=g+Math.max(S,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,u){if(!this.latestFeatureIndex||!s.style)return;const g=this.latestFeatureIndex.loadVTLayers(),x=s.style.listImages(),S=s.style.getBrightness();for(const A in this.buckets){if(!s.style.hasLayer(A))continue;const L=this.buckets[A],z=L.layers[0],U=z.sourceLayer||"_geojsonTileLayer",V=g[U],X=s.style.getLayerSourceCache(z);let Y={};X&&(Y=X._state.getState(U,void 0));const re=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ce=Object.keys(Y).length>0&&!u;ce&&!L.stateDependentLayers.length&&!u||L.update(Y,V,x,re,ce?L.stateDependentLayers:L.layers,u,S),(L instanceof i.b2||L instanceof i.b3)&&s._terrain&&s._terrain.enabled&&X&&L.uploadPending()&&s._terrain._clearRenderCacheForTile(X.id,this.tileID);const se=s&&s.style&&s.style.getOwnLayer(A);se&&(this.queryPadding=Math.max(this.queryPadding,se.queryRadius(L)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=i.q.now()+s}setTexture(s,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s):(this.texture=new i.T(g,s,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(s,u){const g={};for(const x of u)g[x]=!0;this.dependencies[s]=g}hasDependency(s,u){for(const g of s){const x=this.dependencies[g];if(x){for(const S of u)if(x[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const g=i.b4(sv,this.tileID.canonical,this.tileTransform)[0],x=new i.b5,S=new i.b6;for(let A=0;A<g.length;A++){const{x:L,y:z}=g[A];x.emplaceBack(L,z),S.emplaceBack(A)}S.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(S),this._tileDebugBuffer=s.createVertexBuffer(x,i.b7.members),this._tileDebugSegments=i.b8.simpleSegment(0,0,x.length,S.length)}_makeTileBoundsBuffers(s,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const g=i.b4(sv,this.tileID.canonical,this.tileTransform)[0];let x,S;if(this.isRaster){const A=function(L,z){const U=i.aR(L,z),V=Math.pow(2,L.z);for(let pe=0;pe<Pl;pe++)for(let me=0;me<Pl;me++){const be=i.aS((L.x+(me+bb(me))/xs)/V),Ee=i.aT((L.y+(pe+bb(pe))/xs)/V),Te=z.project(be,Ee),Re=pe*Pl+me;bs[2*Re+0]=Math.round((Te.x*U.scale-U.x)*i.ai),bs[2*Re+1]=Math.round((Te.y*U.scale-U.y)*i.ai)}Ka.fill(0),_f.fill(0);for(let pe=2045;pe>=0;pe--){const me=4*pe,be=Zu[me+0],Ee=Zu[me+1],Te=Zu[me+2],Re=Zu[me+3],Pe=be+Te>>1,Ie=Ee+Re>>1,Oe=Pe+Ie-Ee,ze=Ie+be-Pe,Ve=Ee*Pl+be,dt=Re*Pl+Te,rt=Ie*Pl+Pe,St=Math.hypot((bs[2*Ve+0]+bs[2*dt+0])/2-bs[2*rt+0],(bs[2*Ve+1]+bs[2*dt+1])/2-bs[2*rt+1])>=16;Ka[rt]=Ka[rt]||(St?1:0),pe<1022&&(Ka[rt]=Ka[rt]||Ka[(Ee+ze>>1)*Pl+(be+Oe>>1)]||Ka[(Re+ze>>1)*Pl+(Te+Oe>>1)])}const X=new i.aU,Y=new i.aV;let re=0;function ce(pe,me){const be=me*Pl+pe;return _f[be]===0&&(X.emplaceBack(bs[2*be+0],bs[2*be+1],pe*i.ai/xs,me*i.ai/xs),_f[be]=++re),_f[be]-1}function se(pe,me,be,Ee,Te,Re){const Pe=pe+be>>1,Ie=me+Ee>>1;if(Math.abs(pe-Te)+Math.abs(me-Re)>1&&Ka[Ie*Pl+Pe])se(Te,Re,pe,me,Pe,Ie),se(be,Ee,Te,Re,Pe,Ie);else{const Oe=ce(pe,me),ze=ce(be,Ee),Ve=ce(Te,Re);Y.emplaceBack(Oe,ze,Ve)}}return se(0,0,xs,xs,xs,0),se(xs,xs,0,0,0,xs),{vertices:X,indices:Y}}(this.tileID.canonical,u);x=A.vertices,S=A.indices}else{x=new i.aU,S=new i.aV;for(const{x:L,y:z}of g)x.emplaceBack(L,z,0,0);const A=i.b9(x.int16,void 0,4);for(let L=0;L<A.length;L+=3)S.emplaceBack(A[L],A[L+1],A[L+2])}this._tileBoundsBuffer=s.createVertexBuffer(x,i.ba.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(S),this._tileBoundsSegments=i.b8.simpleSegment(0,0,x.length,S.length)}_makeGlobeTileDebugBuffers(s,u){const g=u.projection;if(!g||g.name!=="globe"||u.freezeTileCoverage)return;const x=this.tileID.canonical,S=i.bb(x,u),A=i.bc(S),L=i.ag(u.zoom);let z;L>0&&(z=i.ad.mat4.invert(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,x,u,A,z,L),this._makeGlobeTileDebugTextBuffer(s,x,u,A,z,L)}_globePoint(s,u,g,x,S,A,L){let z=i.bd(s,u,g);if(A){const U=1<<g.z,V=i.av(x.center.lng),X=i.aC(x.center.lat),Y=(g.x+.5)/U-V;let re=0;Y>.5?re=-1:Y<-.5&&(re=1);let ce=(s/i.ai+g.x)/U+re,se=(u/i.ai+g.y)/U;ce=(ce-V)*x._pixelsPerMercatorPixel+V,se=(se-X)*x._pixelsPerMercatorPixel+X;const pe=[ce*x.worldSize,se*x.worldSize,0];i.ad.vec3.transformMat4(pe,pe,A),z=i.be(z,pe,L)}return i.ad.vec3.transformMat4(z,z,S)}_makeGlobeTileDebugBorderBuffer(s,u,g,x,S,A){const L=new i.b5,z=new i.b6,U=new i.bf,V=(Y,re,ce,se,pe)=>{const me=(ce-Y)/(pe-1),be=(se-re)/(pe-1),Ee=L.length;for(let Te=0;Te<pe;Te++){const Re=Y+Te*me,Pe=re+Te*be;L.emplaceBack(Re,Pe);const Ie=this._globePoint(Re,Pe,u,g,x,S,A);U.emplaceBack(Ie[0],Ie[1],Ie[2]),z.emplaceBack(Ee+Te)}},X=i.ai;V(0,0,X,0,16),V(X,0,X,X,16),V(X,X,0,X,16),V(0,X,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(z),this._tileDebugBuffer=s.createVertexBuffer(L,i.b7.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(U,i.bg.members),this._tileDebugSegments=i.b8.simpleSegment(0,0,L.length,z.length)}_makeGlobeTileDebugTextBuffer(s,u,g,x,S,A){const L=i.ai/4,z=new i.b5,U=new i.aV,V=new i.bf,X=25;U.reserve(32),z.reserve(X),V.reserve(X);const Y=(re,ce)=>X*re+ce;for(let re=0;re<X;re++){const ce=re*L;for(let se=0;se<X;se++){const pe=se*L;z.emplaceBack(pe,ce);const me=this._globePoint(pe,ce,u,g,x,S,A);V.emplaceBack(me[0],me[1],me[2])}}for(let re=0;re<4;re++)for(let ce=0;ce<4;ce++){const se=Y(re,ce),pe=Y(re,ce+1),me=Y(re+1,ce),be=Y(re+1,ce+1);U.emplaceBack(se,pe,me),U.emplaceBack(me,pe,be)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(U),this._tileDebugTextBuffer=s.createVertexBuffer(z,i.b7.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(V,i.bg.members),this._tileDebugTextSegments=i.b8.simpleSegment(0,0,X,32)}destroy(s=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bh.setPbf(i.bi);class $a extends Il{constructor(s,u,g,x,S){super(s,u,g,x,S),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexture(s,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s,{premultiply:!1}):this.texture=new i.T(g,s,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,u){const g=this._mrt=new i.bh(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=i.bj(x,(S,A,L,z)=>{if(S)u(S);else try{const U=g.getHeaderLength(A);if(U>s)return void(this.request=this.fetchHeader(U,u));g.parseHeader(A),this._isHeaderLoaded=!0;let V=0;for(const X of Object.values(g.layers))V=Math.max(V,X.dataIndex[X.dataIndex.length-1].lastByte);A.byteLength>=V&&(this.entireBuffer=A),u(null,this.entireBuffer||A,L,z)}catch(U){u(U)}}),this.request}fetchBand(s,u,g){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void g(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void g(new Error("Can't fetch tile band without an actor"));let A;const L=(X,Y)=>{A.complete(X,Y),X?g(X):(this.updateTextureDescriptor(s,u),g(null,this.textureDescriptor&&this.textureDescriptor.img))},z=(X,Y)=>{if(X)return g(X);const re=S.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Y,task:A},L,void 0,!0);this._workQueue.push(()=>{re&&re.cancel(),A.cancel()})},U=x.getLayer(s);if(!U)return void g(new Error(`Unknown sourceLayer "${s}"`));if(U.hasDataForBand(u))return this.updateTextureDescriptor(s,u),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const V=U.getDataRange([u]);if(A=x.createDecodingTask(V),!A||A.tasks.length)if(this.flushQueues(),this.entireBuffer)z(null,this.entireBuffer.slice(V.firstByte,V.lastByte+1));else{const X=Object.assign({},this.requestParams,{headers:{Range:`bytes=${V.firstByte}-${V.lastByte}`}}),Y=i.bj(X,z);this._fetchQueue.push(()=>{Y.cancel(),A.cancel()})}else g(null)}updateNeeded(s,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,u){if(!this._mrt)return;const g=this._mrt.getLayer(s);if(!g||!g.hasBand(u)||!g.hasDataForBand(u))return;const{bytes:x,tileSize:S,buffer:A,offset:L,scale:z}=g.getBandView(u),U=S+2*A,V=new i.r({width:U,height:U},x),X=this.texture;X&&X instanceof i.T&&X.update(V,{premultiply:!1}),this.textureDescriptor={layer:s,band:u,img:V,buffer:A,offset:L,tileSize:S,format:g.pixelFormat,mix:[z,256*z,65536*z,16777216*z]}}}class c2{constructor(s,u){this.max=s,this.onRemove=u,this.reset()}reset(){for(const s in this.data)for(const u of this.data[s])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(s,u,g){const x=s.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const S={value:u,timeout:void 0};if(g!==void 0&&(S.timeout=setTimeout(()=>{this.remove(s,S)},g)),this.data[x].push(S),this.order.push(x),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const u=this.data[s].shift();return u.timeout&&clearTimeout(u.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),u.value}getByKey(s){const u=this.data[s];return u?u[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,u){if(!this.has(s))return this;const g=s.wrapped().key,x=u===void 0?0:this.data[g].indexOf(u),S=this.data[g][x];return this.data[g].splice(x,1),S.timeout&&clearTimeout(S.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(S.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(s){const u=[];for(const g in this.data)for(const x of this.data[g])s(x.value)||u.push(x);for(const g of u)this.remove(g.value.tileID,g)}}class wb{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,u,g){const x=String(u);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][x]=this.stateChanges[s][x]||{},i.l(this.stateChanges[s][x],g),this.deletedStates[s]===null){this.deletedStates[s]={};for(const S in this.state[s])S!==x&&(this.deletedStates[s][S]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][x]===null){this.deletedStates[s][x]={};for(const S in this.state[s][x])g[S]||(this.deletedStates[s][x][S]=null)}else for(const S in g)this.deletedStates[s]&&this.deletedStates[s][x]&&this.deletedStates[s][x][S]===null&&delete this.deletedStates[s][x][S]}removeFeatureState(s,u,g){if(this.deletedStates[s]===null)return;const x=String(u);if(this.deletedStates[s]=this.deletedStates[s]||{},g&&u!==void 0)this.deletedStates[s][x]!==null&&(this.deletedStates[s][x]=this.deletedStates[s][x]||{},this.deletedStates[s][x][g]=null);else if(u!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][x])for(g in this.deletedStates[s][x]={},this.stateChanges[s][x])this.deletedStates[s][x][g]=null;else this.deletedStates[s][x]=null;else this.deletedStates[s]=null}getState(s,u){const g=this.state[s]||{},x=this.stateChanges[s]||{},S=this.deletedStates[s];if(S===null)return{};if(u!==void 0){const L=String(u),z=i.l({},g[L],x[L]);if(S){const U=S[u];if(U===null)return{};for(const V in U)delete z[V]}return z}const A=i.l({},g,x);if(S)for(const L in S)delete A[L];return A}initializeTileState(s,u){s.refreshFeatureState(u)}coalesceChanges(s,u){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const S={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),i.l(this.state[x][A],this.stateChanges[x][A]),S[A]=this.state[x][A];g[x]=S}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const S={};if(this.deletedStates[x]===null)for(const A in this.state[x])S[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else if(this.state[x][A])for(const L of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][L];S[A]=this.state[x][A]}g[x]=g[x]||{},i.l(g[x],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in s)s[x].refreshFeatureState(u)}}class Xs extends i.E{constructor(s,u,g){super(),this.id=s,this._onlySymbols=g,u.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new c2(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new wb,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,u){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,u)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(s),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(On).map(s=>s.key)}getRenderableIds(s,u){const g=[];for(const x in this._tiles)this._isIdRenderable(+x,s,u)&&g.push(this._tiles[x]);return s?g.sort((x,S)=>{const A=x.tileID,L=S.tileID,z=new i.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),U=new i.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-L.overscaledZ||U.y-z.y||U.x-z.x}).map(x=>x.tileID.key):g.map(x=>x.tileID).sort(On).map(x=>x.key)}hasRenderableParent(s){const u=this.findLoadedParent(s,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(s,u,g){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(u||!this._tiles[s].holdingForFade())&&(g||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,u){const g=this._tiles[s];g&&(g.state!=="loading"&&(g.state=u),this._loadTile(g,this._tileLoaded.bind(this,g,s,u)))}_tileLoaded(s,u,g,x){if(x)if(s.state="errored",x.status!==404)this._source.fire(new i.z(x,{tile:s}));else{if(this._source.fire(new i.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const S=this.map.painter.terrain;this.update(this.transform,S.getScaledDemTileSize(),!0),S.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=i.q.now(),g==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(u,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new i.A("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const u=this.getRenderableIds();for(let x=0;x<u.length;x++){const S=u[x];if(s.neighboringTiles&&s.neighboringTiles[S]){const A=this.getTileByID(S);g(s,A),g(A,s)}}function g(x,S){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let A=S.tileID.canonical.x-x.tileID.canonical.x;const L=S.tileID.canonical.y-x.tileID.canonical.y,z=Math.pow(2,x.tileID.canonical.z),U=S.tileID.key;A===0&&L===0||Math.abs(L)>1||(Math.abs(A)>1&&(Math.abs(A+z)===1?A+=z:Math.abs(A-z)===1&&(A-=z)),S.dem&&x.dem&&(x.dem.backfillBorder(S.dem,A,L),x.neighboringTiles&&x.neighboringTiles[U]&&(x.neighboringTiles[U].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,u,g,x){for(const S in this._tiles){let A=this._tiles[S];if(x[S]||!A.hasData()||A.tileID.overscaledZ<=u||A.tileID.overscaledZ>g)continue;let L=A.tileID;for(;A&&A.tileID.overscaledZ>u+1;){const U=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[U.key],A&&A.hasData()&&(L=U)}let z=L;for(;z.overscaledZ>u;)if(z=z.scaledTo(z.overscaledZ-1),s[z.key]){x[L.key]=L;break}}}findLoadedParent(s,u){if(s.key in this._loadedParentTiles){const g=this._loadedParentTiles[s.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=s.overscaledZ-1;g>=u;g--){const x=s.scaledTo(g),S=this._getLoadedTile(x);if(S)return S}}_getLoadedTile(s){const u=this._tiles[s.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,u){u=u||this._source.tileSize;const g=Math.ceil(s.width/u)+1,x=Math.ceil(s.height/u)+1,S=Math.floor(g*x*5),A=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(L)}handleWrapJump(s){const u=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,u){const g={};for(const x in this._tiles){const S=this._tiles[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),g[S.tileID.key]=S}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(s,u,g,x){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(s,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let A,L=this._source.maxzoom;const z=this.map&&this.map.painter?this.map.painter._terrain:null;if(z&&z.sourceCache===this&&z.attenuationRange()){const X=z.attenuationRange()[0],Y=Math.floor(X)-Math.log2(z.getDemUpscale());L>Y&&(L=Y)}if(this.used||this.usedForTerrain){if(this._source.tileID)A=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(X=>new i.aH(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y));else if(this.tileCoverLift!==0){const X=s.clone();X.tileCoverLift=this.tileCoverLift,A=X.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&s.projection.name==="globe"&&(A.push(new i.aH(1,0,1,0,0)),A.push(new i.aH(1,0,1,1,0)),A.push(new i.aH(1,0,1,0,1)),A.push(new i.aH(1,0,1,1,1)))}else if(A=s.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const X=this._source.hasTile.bind(this._source);A=A.filter(Y=>X(Y))}}else A=[];if(A.length>0&&this.castsShadows&&x&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Sb(this._source.type)){const X=s.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),Y=Math.min(X,this._source.maxzoom);if(S){const re=s.extendTileCover(A,Y);for(const ce of re)A.push(ce)}else{const re=s.extendTileCover(A,Y,x);for(const ce of re)this._shadowCasterTiles[ce.key]=!0,A.push(ce)}}const U=this._updateRetainedTiles(A);if(Sb(this._source.type)&&A.length!==0){const X={},Y={},re=Object.keys(U);for(const se of re){const pe=U[se],me=this._tiles[se];if(!me||me.fadeEndTime&&me.fadeEndTime<=i.q.now())continue;const be=this.findLoadedParent(pe,Math.max(pe.overscaledZ-Xs.maxOverzooming,this._source.minzoom));be&&(this._addTile(be.tileID),X[be.tileID.key]=be.tileID),Y[se]=pe}const ce=A[A.length-1].overscaledZ;for(const se in this._tiles){const pe=this._tiles[se];if(U[se]||!pe.hasData())continue;let me=pe.tileID;for(;me.overscaledZ>ce;){me=me.scaledTo(me.overscaledZ-1);const be=this._tiles[me.key];if(be&&be.hasData()&&Y[me.key]){U[se]=pe.tileID;break}}}for(const se in X)U[se]||(this._coveredTiles[se]=!0,U[se]=X[se])}for(const X in U)this._tiles[X].clearFadeHold();const V=i.bk(this._tiles,U);for(const X of V){const Y=this._tiles[X];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(+X)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const u={};if(s.length===0)return u;const g={},x=s.reduce((U,V)=>Math.min(U,V.overscaledZ),1/0),S=s[0].overscaledZ,A=Math.max(S-Xs.maxOverzooming,this._source.minzoom),L=Math.max(S+Xs.maxUnderzooming,this._source.minzoom),z={};for(const U of s){const V=this._addTile(U);u[U.key]=U,V.hasData()||x<this._source.maxzoom&&(z[U.key]=U)}this._retainLoadedChildren(z,x,L,u);for(const U of s){let V=this._tiles[U.key];if(V.hasData())continue;if(U.canonical.z>=this._source.maxzoom){const Y=U.children(this._source.maxzoom)[0],re=this.getTile(Y);if(re&&re.hasData()){u[Y.key]=Y;continue}}else{const Y=U.children(this._source.maxzoom);if(u[Y[0].key]&&u[Y[1].key]&&u[Y[2].key]&&u[Y[3].key])continue}let X=V.wasRequested();for(let Y=U.overscaledZ-1;Y>=A;--Y){const re=U.scaledTo(Y);if(g[re.key]||(g[re.key]=!0,V=this.getTile(re),!V&&X&&(V=this._addTile(re)),V&&(u[re.key]=re,X=V.wasRequested(),V.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const u=[];let g,x=this._tiles[s].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}u.push(x.key);const S=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(S),g)break;x=S}for(const S of u)this._loadedParentTiles[S]=g}}_addTile(s){let u=this._tiles[s.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),u;u=this._cache.getAndRemove(s),u&&(this._setTileReloadTimer(s.key,u),u.tileID=s,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,u)));const g=!!u;if(!g){const x=this.map?this.map.painter:null,S=this._source.tileSize*s.overscaleFactor();u=this._source.type==="raster-array"?new $a(s,S,this.transform.tileZoom,x,this._isRaster):new Il(s,S,this.transform.tileZoom,x,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,s.key,u.state))}return u?(u.uses++,this._tiles[s.key]=u,g||this._source.fire(new i.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(s,u){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const g=u.getExpiryTimeout();g&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},g))}_removeTile(s){const u=this._tiles[s];u&&(u.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,u,g){const x=[],S=this.transform;if(!S)return x;const A=S.projection.name==="globe",L=i.av(S.center.lng);for(const z in this._tiles){const U=this._tiles[z];if(g&&U.clearQueryDebugViz(),U.holdingForFade())continue;let V;if(A){const X=U.tileID.canonical;if(X.z===0){const Y=[Math.abs(i.ay(L,...br(X,-1))-L),Math.abs(i.ay(L,...br(X,1))-L)];V=[0,2*Y.indexOf(Math.min(...Y))-1]}else{const Y=[Math.abs(i.ay(L,...br(X,-1))-L),Math.abs(i.ay(L,...br(X,0))-L),Math.abs(i.ay(L,...br(X,1))-L)];V=[Y.indexOf(Math.min(...Y))-1]}}else V=[0];for(const X of V){const Y=s.containsTile(U,S,u,X);Y&&x.push(Y)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,u){const g=this.getRenderableIds(s,u).map(S=>this._tiles[S].tileID),x=this.transform.projection.name==="globe";for(const S of g)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=x?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return g}sortCoordinatesByDistance(s){const u=s.slice(),g=this.transform._camera.position,x=this.transform._camera.forward(),S={};for(const A of u){const L=1/(1<<A.canonical.z);S[A.key]=((A.canonical.x+.5)*L+A.wrap-g[0])*x[0]+((A.canonical.y+.5)*L-g[1])*x[1]-g[2]*x[2]}return u.sort((A,L)=>S[A.key]-S[L.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(Sb(this._source.type))for(const s in this._tiles){const u=this._tiles[s];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(s,u,g){this._state.updateState(s=s||"_geojsonTileLayer",u,g)}removeFeatureState(s,u,g){this._state.removeFeatureState(s=s||"_geojsonTileLayer",u,g)}getFeatureState(s,u){return this._state.getState(s=s||"_geojsonTileLayer",u)}setDependencies(s,u,g){const x=this._tiles[s];x&&x.setDependencies(u,g)}reloadTilesForDependencies(s,u){for(const g in this._tiles)this._tiles[g].hasDependency(s,u)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(s,u))}_preloadTiles(s,u){if(!this._sourceLoaded){const z=()=>{this._sourceLoaded&&(this._source.off("data",z),this._preloadTiles(s,u))};return void this._source.on("data",z)}const g=new Map,x=Array.isArray(s)?s:[s],S=this.map.painter.terrain,A=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const z of x){const U=z.coveringTiles({tileSize:A,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const V of U)g.set(V.key,V);this.usedForTerrain&&z.updateElevation(!1)}const L=Array.from(g.values());i.bl(L,(z,U)=>{const V=new Il(z,this._source.tileSize*z.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(V,X=>{this._source.type==="raster-dem"&&V.dem&&this._backfillDEM(V),U(X,V)})},u)}}function On(y,s){const u=Math.abs(2*y.wrap)-+(y.wrap<0),g=Math.abs(2*s.wrap)-+(s.wrap<0);return y.overscaledZ-s.overscaledZ||g-u||s.canonical.y-y.canonical.y||s.canonical.x-y.canonical.x}function Sb(y){return y==="raster"||y==="image"||y==="video"||y==="custom"}function br(y,s){const u=1<<y.z;return[y.x/u+s,(y.x+1)/u+s]}Xs.maxOverzooming=10,Xs.maxUnderzooming=3;class u2{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,u=!1;for(const g in this.style._mergedLayers){const x=this.style._mergedLayers[g];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:s,visibilityChanged:u});else if(x.type==="model"){const S=this.style.getLayerSource(x);S&&S.type==="batched-model"&&this.layers.push({layer:x,visible:s,visibilityChanged:u})}}}onNewFrame(s){this.layersGotHidden=!1;for(const u of this.layers){const g=u.layer;let x=!1;g.type==="fill-extrusion"?x=!g.isHidden(s)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="model"&&(x=!g.isHidden(s)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&u.visible,u.visible=x}}updateZOffset(s,u){this.currentBuildingBuckets=[];for(const x of this.layers){const S=x.layer,A=this.style.getLayerSourceCache(S);let L=1;S.type==="fill-extrusion"&&(L=x.visible?S.paint.get("fill-extrusion-vertical-scale"):0);let z=A?A.getTile(u):null;if(!z&&A&&u.canonical.z>A.getSource().minzoom){let U=u.scaledTo(Math.min(A.getSource().maxzoom,u.overscaledZ-1));for(;U.overscaledZ>=A.getSource().minzoom&&(z=A.getTile(U),!z&&U.overscaledZ!==0);)U=U.scaledTo(U.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:z?z.getBucket(S):null,tileID:z?z.tileID:u,verticalScale:L})}s.hasAnyZOffset=!1;let g=!1;for(let x=0;x<s.symbolInstances.length;x++){const S=s.symbolInstances.get(x),A=S.zOffset,L=this._getHeightAtTileOffset(u,S.tileAnchorX,S.tileAnchorY);S.zOffset=L!==Number.NEGATIVE_INFINITY?L:A,g||A===S.zOffset||(g=!0),s.hasAnyZOffset||S.zOffset===0||(s.hasAnyZOffset=!0)}g&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,u,g,x){let S=u,A=g;if(s.canonical.z!==x.canonical.z){const L=x.canonical,z=1/(1<<s.canonical.z-L.z);S=(u+s.canonical.x*i.ai)*z-L.x*i.ai|0,A=(g+s.canonical.y*i.ai)*z-L.y*i.ai|0}return{tileX:S,tileY:A}}_getHeightAtTileOffset(s,u,g){let x,S;for(let A=0;A<this.layers.length;++A){if(this.layers[A].layer.type!=="fill-extrusion")continue;const{bucket:L,tileID:z,verticalScale:U}=this.currentBuildingBuckets[A];if(!L)continue;const{tileX:V,tileY:X}=this._mapCoordToOverlappingTile(s,u,g,z),Y=L.getHeightAtTileCoord(V,X);Y&&Y.height!==void 0&&(Y.hidden?x=Y.height:S=Math.max(Y.height*U,S||0))}if(S!==void 0)return S;for(let A=0;A<this.layers.length;++A){const L=this.layers[A];if(L.layer.type!=="model"||!L.visible)continue;const{bucket:z,tileID:U}=this.currentBuildingBuckets[A];if(!z)continue;const{tileX:V,tileY:X}=this._mapCoordToOverlappingTile(s,u,g,U),Y=z.getHeightAtTileCoord(V,X);if(Y&&!Y.hidden)return Y.height===void 0&&x!==void 0?Math.min(Y.maxHeight,x)*Y.verticalScale:Y.height?Y.height*Y.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function d2(y,s){const u={};for(const g in y)g!=="ref"&&(u[g]=y[g]);return i.bm.forEach(g=>{g in s&&(u[g]=s[g])}),u}function Vm(y){y=y.slice();const s=Object.create(null);for(let u=0;u<y.length;u++)s[y[u].id]=y[u];for(let u=0;u<y.length;u++)"ref"in y[u]&&(y[u]=d2(y[u],s[y[u].ref]));return y}const vn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Ys(y,s,u){u.push({command:vn.addSource,args:[y,s[y]]})}function lv(y,s,u){s.push({command:vn.removeSource,args:[y]}),u[y]=!0}function xf(y,s,u,g){lv(y,u,g),Ys(y,s,u)}function cr(y,s,u){let g;for(g in y[u])if(y[u].hasOwnProperty(g)&&g!=="data"&&!i.bn(y[u][g],s[u][g]))return!1;for(g in s[u])if(s[u].hasOwnProperty(g)&&g!=="data"&&!i.bn(y[u][g],s[u][g]))return!1;return!0}function Cn(y,s,u,g,x,S){let A;for(A in s=s||{},y=y||{})y.hasOwnProperty(A)&&(i.bn(y[A],s[A])||u.push({command:S,args:[g,A,s[A],x]}));for(A in s)s.hasOwnProperty(A)&&!y.hasOwnProperty(A)&&(i.bn(y[A],s[A])||u.push({command:S,args:[g,A,s[A],x]}))}function pn(y){return y.id}function da(y,s){return y[s.id]=s,y}class bf{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=i.ay(s,0,1);let u=1,g=this._distances[u];const x=s*this.paddedLength+this.padding;for(;g<x&&u<this._distances.length;)g=this._distances[++u];const S=u-1,A=this._distances[S],L=g-A,z=L>0?(x-A)/L:0;return this.points[S].mult(1-z).add(this.points[u].mult(z))}}class _n{constructor(s,u,g){const x=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(u/g);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,g,x,S){this._forEachCell(u,g,x,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(S)}insertCircle(s,u,g,x){this._forEachCell(u-x,g-x,u+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(g),this.circles.push(x)}_insertBoxCell(s,u,g,x,S,A){this.boxCells[S].push(A)}_insertCircleCell(s,u,g,x,S,A){this.circleCells[S].push(A)}_query(s,u,g,x,S,A){if(g<0||s>this.width||x<0||u>this.height)return!S&&[];const L=[];if(s<=0&&u<=0&&this.width<=g&&this.height<=x){if(S)return!0;for(let z=0;z<this.boxKeys.length;z++)L.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const U=this.circles[3*z],V=this.circles[3*z+1],X=this.circles[3*z+2];L.push({key:this.circleKeys[z],x1:U-X,y1:V-X,x2:U+X,y2:V+X})}return A?L.filter(A):L}return this._forEachCell(s,u,g,x,this._queryCell,L,{hitTest:S,seenUids:{box:{},circle:{}}},A),S?L.length>0:L}_queryCircle(s,u,g,x,S){const A=s-g,L=s+g,z=u-g,U=u+g;if(L<0||A>this.width||U<0||z>this.height)return!x&&[];const V=[];return this._forEachCell(A,z,L,U,this._queryCellCircle,V,{hitTest:x,circle:{x:s,y:u,radius:g},seenUids:{box:{},circle:{}}},S),x?V.length>0:V}query(s,u,g,x,S){return this._query(s,u,g,x,!1,S)}hitTest(s,u,g,x,S){return this._query(s,u,g,x,!0,S)}hitTestCircle(s,u,g,x){return this._queryCircle(s,u,g,!0,x)}_queryCell(s,u,g,x,S,A,L,z){const U=L.seenUids,V=this.boxCells[S];if(V!==null){const Y=this.bboxes;for(const re of V)if(!U.box[re]){U.box[re]=!0;const ce=4*re;if(s<=Y[ce+2]&&u<=Y[ce+3]&&g>=Y[ce+0]&&x>=Y[ce+1]&&(!z||z(this.boxKeys[re]))){if(L.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[re],x1:Y[ce],y1:Y[ce+1],x2:Y[ce+2],y2:Y[ce+3]})}}}const X=this.circleCells[S];if(X!==null){const Y=this.circles;for(const re of X)if(!U.circle[re]){U.circle[re]=!0;const ce=3*re;if(this._circleAndRectCollide(Y[ce],Y[ce+1],Y[ce+2],s,u,g,x)&&(!z||z(this.circleKeys[re]))){if(L.hitTest)return A.push(!0),!0;{const se=Y[ce],pe=Y[ce+1],me=Y[ce+2];A.push({key:this.circleKeys[re],x1:se-me,y1:pe-me,x2:se+me,y2:pe+me})}}}}}_queryCellCircle(s,u,g,x,S,A,L,z){const U=L.circle,V=L.seenUids,X=this.boxCells[S];if(X!==null){const re=this.bboxes;for(const ce of X)if(!V.box[ce]){V.box[ce]=!0;const se=4*ce;if(this._circleAndRectCollide(U.x,U.y,U.radius,re[se+0],re[se+1],re[se+2],re[se+3])&&(!z||z(this.boxKeys[ce])))return A.push(!0),!0}}const Y=this.circleCells[S];if(Y!==null){const re=this.circles;for(const ce of Y)if(!V.circle[ce]){V.circle[ce]=!0;const se=3*ce;if(this._circlesCollide(re[se],re[se+1],re[se+2],U.x,U.y,U.radius)&&(!z||z(this.circleKeys[ce])))return A.push(!0),!0}}}_forEachCell(s,u,g,x,S,A,L,z){const U=this._convertToXCellCoord(s),V=this._convertToYCellCoord(u),X=this._convertToXCellCoord(g),Y=this._convertToYCellCoord(x);for(let re=U;re<=X;re++)for(let ce=V;ce<=Y;ce++)if(S.call(this,s,u,g,x,this.xCellCount*ce+re,A,L,z))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,g,x,S,A){const L=x-s,z=S-u,U=g+A;return U*U>L*L+z*z}_circleAndRectCollide(s,u,g,x,S,A,L){const z=(A-x)/2,U=Math.abs(s-(x+z));if(U>z+g)return!1;const V=(L-S)/2,X=Math.abs(u-(S+V));if(X>V+g)return!1;if(U<=z||X<=V)return!0;const Y=U-z,re=X-V;return Y*Y+re*re<=g*g}}const Uc={unknown:0,flipRequired:1,flipNotRequired:2},Wm=Math.tan(85*Math.PI/180);function Vc(y,s,u,g,x,S,A){const L=i.ad.mat4.create();if(u)if(S.name==="globe"){const z=i.bo(x,s);i.ad.mat4.multiply(L,L,z)}else{const z=i.ad.mat2.invert([],A);L[0]=z[0],L[1]=z[1],L[4]=z[2],L[5]=z[3],g||i.ad.mat4.rotateZ(L,L,x.angle)}else i.ad.mat4.multiply(L,x.labelPlaneMatrix,y);return L}function Qo(y,s,u,g,x,S,A){const L=Vc(y,s,u,g,x,S,A);return S.name==="globe"&&u||(L[2]=L[6]=L[10]=L[14]=0),L}function Fi(y,s,u,g,x,S,A){if(u){if(S.name==="globe"){const L=Vc(y,s,u,g,x,S,A);return i.ad.mat4.invert(L,L),i.ad.mat4.multiply(L,y,L),L}{const L=i.ad.mat4.clone(y),z=i.ad.mat4.identity([]);return z[0]=A[0],z[1]=A[1],z[4]=A[2],z[5]=A[3],i.ad.mat4.multiply(L,L,z),g||i.ad.mat4.rotateZ(L,L,-x.angle),L}}return x.glCoordMatrix}function Ol(y,s,u,g){const x=[y,s,u,1];u?i.ad.vec4.transformMat4(x,x,g):so(x,x,g);const S=x[3];return x[0]/=S,x[1]/=S,x[2]/=S,x}function wf(y,s){return Math.min(.5+y/s*.5,1.5)}function Tb(y,s){const u=y[0]/y[3],g=y[1]/y[3];return u>=-s[0]&&u<=s[0]&&g>=-s[1]&&g<=s[1]}function Sf(y,s,u,g,x,S,A,L,z,U){const V=u.transform,X=g?y.textSizeData:y.iconSizeData,Y=i.bp(X,u.transform.zoom),re=V.projection.name==="globe",ce=[256/u.width*2+1,256/u.height*2+1],se=g?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;se.clear();let pe=null;re&&(pe=g?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const me=y.lineVertexArray,be=g?y.text.placedSymbolArray:y.icon.placedSymbolArray,Ee=u.transform.width/u.transform.height;let Te,Re=!1;for(let Pe=0;Pe<be.length;Pe++){const Ie=be.get(Pe),{numGlyphs:Oe,writingMode:ze}=Ie;if(ze!==i.bq.vertical||Re||Te===i.bq.horizontal||(Re=!0),Te=ze,(Ie.hidden||ze===i.bq.vertical)&&!Re){kl(Oe,se);continue}Re=!1;const Ve=new i.P(Ie.tileAnchorX,Ie.tileAnchorY);let{x:dt,y:rt,z:St}=V.projection.projectTilePoint(Ve.x,Ve.y,U.canonical);if(z){const[qt,Zt,sr]=z(Ve);dt+=qt,rt+=Zt,St+=sr}const Tt=[dt,rt,St,1];if(i.ad.vec4.transformMat4(Tt,Tt,s),!Tb(Tt,ce)){kl(Oe,se);continue}const Dt=Tt[3],et=wf(u.transform.getCameraToCenterDistance(V.projection),Dt),wt=i.br(X,Y,Ie),Ke=A?wt/et:wt*et,bt=Ol(dt,rt,St,x);if(bt[3]<=0){kl(Oe,se);continue}let yt={};const Et=i.ak(y.layers[0].layout.get("text-max-angle")),ht=Math.cos(Et),Ct=A?null:z,Gt=ha(Ie,Ke,!1,L,s,x,S,y.glyphOffsetArray,me,se,pe,bt,Ve,yt,Ee,Ct,V.projection,U,A,ht);Re=Gt.useVertical,Ct&&Gt.needsFlipping&&(yt={}),(Gt.notEnoughRoom||Re||Gt.needsFlipping&&ha(Ie,Ke,!0,L,s,x,S,y.glyphOffsetArray,me,se,pe,bt,Ve,yt,Ee,Ct,V.projection,U,A,ht).notEnoughRoom)&&kl(Oe,se)}g?(y.text.dynamicLayoutVertexBuffer.updateData(se),pe&&y.text.globeExtVertexBuffer&&y.text.globeExtVertexBuffer.updateData(pe)):(y.icon.dynamicLayoutVertexBuffer.updateData(se),pe&&y.icon.globeExtVertexBuffer&&y.icon.globeExtVertexBuffer.updateData(pe))}function cv(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe){const{lineStartIndex:me,glyphStartIndex:be,segment:Ee}=L,Te=be+L.numGlyphs,Re=me+L.lineLength,Pe=s.getoffsetX(be),Ie=s.getoffsetX(Te-1),Oe=qm(y*Pe,u,g,x,S,A,Ee,me,Re,z,U,V,X,Y,!0,re,ce,se,pe);if(!Oe)return null;const ze=qm(y*Ie,u,g,x,S,A,Ee,me,Re,z,U,V,X,Y,!0,re,ce,se,pe);return ze?{first:Oe,last:ze}:null}function Gm(y,s,u,g){return y===i.bq.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:y===i.bq.vertical?g>0?{needsFlipping:!0}:null:s!==Uc.unknown&&function(x,S){return x===0||Math.abs(S/x)>Wm}(u,g)?s===Uc.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function ha(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me,be,Ee){const Te=s/24,Re=y.lineOffsetX*Te,Pe=y.lineOffsetY*Te,{lineStartIndex:Ie,glyphStartIndex:Oe,numGlyphs:ze,segment:Ve,writingMode:dt,flipState:rt}=y,St=Ie+y.lineLength,Tt=Dt=>{if(V){const[bt,yt,Et]=Dt.up,ht=U.length;i.bs(V,ht+0,bt,yt,Et),i.bs(V,ht+1,bt,yt,Et),i.bs(V,ht+2,bt,yt,Et),i.bs(V,ht+3,bt,yt,Et)}const[et,wt,Ke]=Dt.point;i.bt(U,et,wt,Ke,Dt.angle)};if(ze>1){const Dt=cv(Te,L,Re,Pe,u,X,Y,y,z,S,re,se,!1,pe,me,be,Ee);if(!Dt)return{notEnoughRoom:!0};if(g&&!u){let[et,wt,Ke]=Dt.first.point,[bt,yt,Et]=Dt.last.point;[et,wt]=Ol(et,wt,Ke,A),[bt,yt]=Ol(bt,yt,Et,A);const ht=Gm(dt,rt,(bt-et)*ce,yt-wt);if(y.flipState=ht&&ht.needsFlipping?Uc.flipRequired:Uc.flipNotRequired,ht)return ht}Tt(Dt.first);for(let et=Oe+1;et<Oe+ze-1;et++){const wt=qm(Te*L.getoffsetX(et),Re,Pe,u,X,Y,Ve,Ie,St,z,S,re,se,!1,!1,pe,me,be,Ee);if(!wt)return U.length-=4*(et-Oe),{notEnoughRoom:!0};Tt(wt)}Tt(Dt.last)}else{if(g&&!u){const et=Ol(Y.x,Y.y,0,x),wt=Ie+Ve+1,Ke=new i.P(z.getx(wt),z.gety(wt)),bt=Ol(Ke.x,Ke.y,0,x),yt=bt[3]>0?bt:fa(Y,Ke,et,1,x,void 0,pe,me.canonical),Et=Gm(dt,rt,(yt[0]-et[0])*ce,yt[1]-et[1]);if(y.flipState=Et&&Et.needsFlipping?Uc.flipRequired:Uc.flipNotRequired,Et)return Et}const Dt=qm(Te*L.getoffsetX(Oe),Re,Pe,u,X,Y,Ve,Ie,St,z,S,re,se,!1,!1,pe,me,be,Ee);if(!Dt)return{notEnoughRoom:!0};Tt(Dt)}return{}}function cc(y,s,u,g,x){const{x:S,y:A,z:L}=g.projectTilePoint(y.x,y.y,s);if(!x)return Ol(S,A,L,u);const[z,U,V]=x(y);return Ol(S+z,A+U,L+V,u)}function fa(y,s,u,g,x,S,A,L){const z=cc(y.sub(s)._unit()._add(y),L,x,A,S);return i.ad.vec3.sub(z,u,z),i.ad.vec3.normalize(z,z),i.ad.vec3.scaleAndAdd(z,u,z,g)}function qm(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me,be){const Ee=g?y-s:y+s;let Te=Ee>0?1:-1,Re=0;g&&(Te*=-1,Re=Math.PI),Te<0&&(Re+=Math.PI);let Pe=L+A+(Te>0?0:1)|0,Ie=x,Oe=x,ze=0,Ve=0;const dt=Math.abs(Ee),rt=[],St=[];let Tt=S,Dt=Tt,et=i.ad.vec3.zero([]);const wt=()=>fa(Dt,Tt,Oe,dt-ze+1,V,Y,se,pe.canonical);for(;ze+Ve<=dt;){if(Pe+=Te,Pe<L||Pe>=z)return null;if(Oe=Ie,Dt=Tt,rt.push(Oe),re&&St.push(Dt),Tt=new i.P(U.getx(Pe),U.gety(Pe)),Ie=X[Pe],!Ie){const sr=cc(Tt,pe.canonical,V,se,Y);Ie=sr[3]>0?X[Pe]=sr:wt()}ze+=Ve;const qt=i.ad.vec3.sub([],Ie,Oe),Zt=i.ad.vec3.distance(Oe,Ie);if(u&&Zt>0&&Ve>0&&i.ad.vec3.dot(et,qt)/(Ve*Zt)<be)return null;Ve=Zt,et=qt}ce&&Y&&(X[Pe]&&(Ie=wt(),Ve=i.ad.vec3.distance(Oe,Ie),et=i.ad.vec3.sub([],Ie,Oe)),X[Pe]=Ie);const Ke=(dt-ze)/Ve,bt=Tt.sub(Dt)._mult(Ke)._add(Dt),yt=i.ad.vec3.scaleAndAdd([],Oe,et,Ke);let Et=[0,0,1],ht=et[0],Ct=et[1];if(me&&(Et=se.upVector(pe.canonical,bt.x,bt.y),Et[0]!==0||Et[1]!==0||Et[2]!==1)){const qt=[Et[2],0,-Et[0]],Zt=i.ad.vec3.cross([],Et,qt);i.ad.vec3.normalize(qt,qt),i.ad.vec3.normalize(Zt,Zt),ht=i.ad.vec3.dot(et,qt),Ct=i.ad.vec3.dot(et,Zt)}if(u){const qt=i.ad.vec3.cross([],Et,et);i.ad.vec3.normalize(qt,qt),i.ad.vec3.scaleAndAdd(yt,yt,qt,u*Te)}const Gt=Re+Math.atan2(Ct,ht);return rt.push(yt),re&&St.push(bt),{point:yt,angle:Gt,path:rt,tilePath:St,up:Et}}function kl(y,s){const u=s.length,g=u+4*y;s.resize(g),s.float32.fill(-1/0,4*u,4*g)}function so(y,s,u){const g=s[0],x=s[1];return y[0]=u[0]*g+u[4]*x+u[12],y[1]=u[1]*g+u[5]*x+u[13],y[3]=u[3]*g+u[7]*x+u[15],y}const No=100;class Wc{constructor(s,u,g=new _n(s.width+200,s.height+200,25),x=new _n(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+No,this.screenBottomBoundary=s.height+No,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=u}placeCollisionBox(s,u,g,x,S,A,L,z){let U=g.projectedAnchorX,V=g.projectedAnchorY,X=g.projectedAnchorZ;const Y=g.elevation,re=g.tileID,ce=s.getProjection();if(Y&&re){const[Pe,Ie,Oe]=ce.upVector(re.canonical,g.tileAnchorX,g.tileAnchorY),ze=ce.upVectorScale(re.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=Pe*Y*ze,V+=Ie*Y*ze,X+=Oe*Y*ze}const se=this.projectAndGetPerspectiveRatio(L,U,V,X,g.tileID,ce.name==="globe"||!!Y||this.transform.pitch>0,ce),pe=A*se.perspectiveRatio,me=(g.x1*u+x.x-g.padding)*pe+se.point.x,be=(g.y1*u+x.y-g.padding)*pe+se.point.y,Ee=(g.x2*u+x.x+g.padding)*pe+se.point.x,Te=(g.y2*u+x.y+g.padding)*pe+se.point.y,Re=se.perspectiveRatio<=.55||se.occluded;return!this.isInsideGrid(me,be,Ee,Te)||!S&&this.grid.hitTest(me,be,Ee,Te,z)||Re?{box:[],offscreen:!1,occluded:se.occluded}:{box:[me,be,Ee,Te],offscreen:this.isOffscreen(me,be,Ee,Te),occluded:!1}}placeCollisionCircles(s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se){const pe=[],me=this.transform.elevation,be=s.getProjection(),Ee=me?me.getAtTileOffsetFunc(se,this.transform.center.lat,this.transform.worldSize,be):null,Te=new i.P(g.tileAnchorX,g.tileAnchorY);let{x:Re,y:Pe,z:Ie}=be.projectTilePoint(Te.x,Te.y,se.canonical);if(Ee){const[Et,ht,Ct]=Ee(Te);Re+=Et,Pe+=ht,Ie+=Ct}const Oe=be.name==="globe",ze=this.projectAndGetPerspectiveRatio(L,Re,Pe,Ie,se,Oe||!!me||this.transform.pitch>0,be),{perspectiveRatio:Ve}=ze,dt=(X?A/Ve:A*Ve)/i.bw,rt=Ol(Re,Pe,Ie,z),St=g.lineOffsetX*dt,Tt=g.lineOffsetY*dt,Dt=i.ak(s.layers[0].layout.get("text-max-angle")),et=Math.cos(Dt),wt=ze.signedDistanceFromCamera>0?cv(dt,S,St,Tt,!1,rt,Te,g,x,z,{},me&&!X?Ee:null,X&&!!me,be,se,X,et):null;let Ke=!1,bt=!1,yt=!0;if(wt&&!ze.occluded){const Et=.5*re*Ve+ce,ht=new i.P(-100,-100),Ct=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Gt=new bf,{first:qt,last:Zt}=wt,sr=qt.path.length;let kr=[];for(let Ar=sr-1;Ar>=1;Ar--)kr.push(qt.path[Ar]);for(let Ar=1;Ar<Zt.path.length;Ar++)kr.push(Zt.path[Ar]);const xr=2.5*Et;U&&(kr=kr.map(([Ar,nn,wn],Kn)=>(Ee&&!Oe&&(wn=Ee(Kn<sr-1?qt.tilePath[sr-1-Kn]:Zt.tilePath[Kn-sr+2])[2]),Ol(Ar,nn,wn,U))),kr.some(Ar=>Ar[3]<=0)&&(kr=[]));let Pr=[];if(kr.length>0){let Ar=1/0,nn=-1/0,wn=1/0,Kn=-1/0;for(const Yr of kr)Ar=Math.min(Ar,Yr[0]),wn=Math.min(wn,Yr[1]),nn=Math.max(nn,Yr[0]),Kn=Math.max(Kn,Yr[1]);nn>=ht.x&&Ar<=Ct.x&&Kn>=ht.y&&wn<=Ct.y&&(Pr=[kr.map(Yr=>new i.P(Yr[0],Yr[1]))],(Ar<ht.x||nn>Ct.x||wn<ht.y||Kn>Ct.y)&&(Pr=i.bu(Pr,ht.x,ht.y,Ct.x,Ct.y)))}for(const Ar of Pr){Gt.reset(Ar,.25*Et);let nn=0;nn=Gt.length<=.5*Et?1:Math.ceil(Gt.paddedLength/xr)+1;for(let wn=0;wn<nn;wn++){const Kn=wn/Math.max(nn-1,1),Yr=Gt.lerp(Kn),fi=Yr.x+No,Nr=Yr.y+No;pe.push(fi,Nr,Et,0);const lr=fi-Et,sn=Nr-Et,kn=fi+Et,mn=Nr+Et;if(yt=yt&&this.isOffscreen(lr,sn,kn,mn),bt=bt||this.isInsideGrid(lr,sn,kn,mn),!u&&this.grid.hitTestCircle(fi,Nr,Et,Y)&&(Ke=!0,!V))return{circles:[],offscreen:!1,collisionDetected:Ke,occluded:!1}}}}return{circles:!V&&Ke||!bt?[]:pe,offscreen:yt,collisionDetected:Ke,occluded:ze.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,x=1/0,S=-1/0,A=-1/0;for(const V of s){const X=new i.P(V.x+No,V.y+No);g=Math.min(g,X.x),x=Math.min(x,X.y),S=Math.max(S,X.x),A=Math.max(A,X.y),u.push(X)}const L=this.grid.query(g,x,S,A).concat(this.ignoredGrid.query(g,x,S,A)),z={},U={};for(const V of L){const X=V.key;if(z[X.bucketInstanceId]===void 0&&(z[X.bucketInstanceId]={}),z[X.bucketInstanceId][X.featureIndex])continue;const Y=[new i.P(V.x1,V.y1),new i.P(V.x2,V.y1),new i.P(V.x2,V.y2),new i.P(V.x1,V.y2)];i.bv(u,Y)&&(z[X.bucketInstanceId][X.featureIndex]=!0,U[X.bucketInstanceId]===void 0&&(U[X.bucketInstanceId]=[]),U[X.bucketInstanceId].push(X.featureIndex))}return U}insertCollisionBox(s,u,g,x,S){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:S},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,g,x,S){const A=u?this.ignoredGrid:this.grid,L={bucketInstanceId:g,featureIndex:x,collisionGroupID:S};for(let z=0;z<s.length;z+=4)A.insertCircle(L,s[z],s[z+1],s[z+2])}projectAndGetPerspectiveRatio(s,u,g,x,S,A,L){const z=[u,g,x,1];let U=!1;x||this.transform.pitch>0?(i.ad.vec4.transformMat4(z,z,s),this.fogState&&S&&L.name!=="globe"&&(U=function(Y,re,ce,se,pe,me){const be=me.calculateFogTileMatrix(pe),Ee=[re,ce,se];return i.ad.vec3.transformMat4(Ee,Ee,be),rr(Y,i.ad.vec3.length(Ee),me.pitch,me._fov)}(this.fogState,u,g,x,S.toUnwrapped(),this.transform)>.9)):so(z,z,s);const V=z[3];return{point:new i.P((z[0]/V+1)/2*this.transform.width+No,(-z[1]/V+1)/2*this.transform.height+No),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/V*.5,1.5),signedDistanceFromCamera:V,occluded:A&&z[2]>V||U}}isOffscreen(s,u,g,x){return g<No||s>=this.screenRightBoundary||x<No||u>this.screenBottomBoundary}isInsideGrid(s,u,g,x){return g>=0&&s<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=i.ad.mat4.identity([]);return i.ad.mat4.translate(s,s,[-100,-100,0]),s}}function Vi(y,s,u){const g=s.createTileMatrix(y,y.worldSize,u.toUnwrapped());return i.ad.mat4.multiply(new Float32Array(16),y.projMatrix,g)}function Eb(y,s,u){if(s.projection.name===u.projection.name)return y.projMatrix;const g=u.clone();return g.setProjection(s.projection),Vi(g,s.getProjection(),y)}function ws(y,s,u){return s.name===u.projection.name?y.projMatrix:Vi(u,s,y)}class Tf{constructor(s,u,g,x){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Xu{constructor(s,u,g,x,S,A=!1){this.text=new Tf(s?s.text:null,u,g,S),this.icon=new Tf(s?s.icon:null,u,x,S),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gc{constructor(s,u,g,x=!1){this.text=s,this.icon=u,this.skipFade=g,this.clipped=x}}class eD{constructor(){this.invProjMatrix=i.ad.mat4.create(),this.viewportMatrix=i.ad.mat4.create(),this.circles=[]}}class qc{constructor(s,u,g,x,S){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=S}}class tD{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[s]}}function uv(y,s,u,g,x){const{horizontalAlign:S,verticalAlign:A}=i.bD(y),L=-(S-.5)*s,z=-(A-.5)*u,U=i.bC(y,g);return new i.P(L+U[0]*x,z+U[1]*x)}function Ia(y,s,u,g,x){const S=new i.P(y,s);return u&&S._rotate(g?x:-x),S}class rD{constructor(s,u,g,x,S,A){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Wc(this.transform,S),this.buildingIndex=A,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new tD(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,u,g,x,S=1){const A=g.getBucket(u),L=g.latestFeatureIndex;if(!A||!L||u.fqid!==A.layerIds[0])return;const z=A.layers[0].layout,U=A.layers[0].paint,V=g.collisionBoxArray,X=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),Y=g.tileSize/i.ai,re=g.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ce=(se=g.tileID,pe=A.getProjection(),me=this.transform,pe.name===this.projection?me.calculateProjMatrix(se.toUnwrapped()):Vi(me,pe,se));var se,pe,me;const be=z.get("text-pitch-alignment")==="map",Ee=z.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const Te=u.dynamicFilter(),Re=u.dynamicFilterNeedsFeature(),Pe=this.transform.calculatePixelsToTileUnitsMatrix(g),Ie=Qo(ce,g.tileID.canonical,be,Ee,this.transform,A.getProjection(),Pe);let Oe=null;if(be){const wt=Fi(ce,g.tileID.canonical,be,Ee,this.transform,A.getProjection(),Pe);Oe=i.ad.mat4.multiply([],this.transform.labelPlaneMatrix,wt)}let ze=null;Te&&g.latestFeatureIndex&&(ze={unwrappedTileID:re,dynamicFilter:Te,dynamicFilterNeedsFeature:Re}),this.retainedQueryData[A.bucketInstanceId]=new qc(A.bucketInstanceId,L,A.sourceLayerIndex,A.index,g.tileID);const[Ve,dt]=A.layers[0].layout.get("text-size-scale-range"),rt=i.ay(S,Ve,dt),[St,Tt]=z.get("icon-size-scale-range"),Dt=i.ay(S,St,Tt),et={bucket:A,layout:z,paint:U,posMatrix:ce,textLabelPlaneMatrix:Ie,labelToScreenMatrix:Oe,clippingData:ze,scale:X,textPixelRatio:Y,holdingForFade:g.holdingForFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:i.bp(A.textSizeData,this.transform.zoom,rt),partiallyEvaluatedIconSize:i.bp(A.iconSizeData,this.transform.zoom,Dt),collisionGroup:this.collisionGroups.get(A.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(x)for(const wt of A.sortKeyRanges){const{sortKey:Ke,symbolInstanceStart:bt,symbolInstanceEnd:yt}=wt;s.push({sortKey:Ke,symbolInstanceStart:bt,symbolInstanceEnd:yt,parameters:et})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:et})}attemptAnchorPlacement(s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me,be){const{textOffset0:Ee,textOffset1:Te,crossTileID:Re}=Y,Pe=[Ee,Te],Ie=uv(s,g,x,Pe,S),Oe=this.collisionIndex.placeCollisionBox(ce,S,u,Ia(Ie.x,Ie.y,A,L,this.transform.angle),X,z,U,V.predicate);if(pe){const ze=ce.getSymbolInstanceIconSize(be,this.transform.zoom,Y.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ce,ze,pe,Ia(Ie.x,Ie.y,A,L,this.transform.angle),X,z,U,V.predicate).box.length===0)return}if(Oe.box.length>0){let ze;return this.prevPlacement&&this.prevPlacement.variableOffsets[Re]&&this.prevPlacement.placements[Re]&&this.prevPlacement.placements[Re].text&&(ze=this.prevPlacement.variableOffsets[Re].anchor),this.variableOffsets[Re]={textOffset:Pe,width:g,height:x,anchor:s,textScale:S,prevAnchor:ze},this.markUsedJustification(ce,s,Y,se),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,se,Y),this.placedOrientations[Re]=se),{shift:Ie,placedGlyphBoxes:Oe}}}placeLayerBucketPart(s,u,g,x,S=1){const{bucket:A,layout:L,paint:z,posMatrix:U,textLabelPlaneMatrix:V,labelToScreenMatrix:X,clippingData:Y,textPixelRatio:re,holdingForFade:ce,collisionBoxArray:se,partiallyEvaluatedTextSize:pe,partiallyEvaluatedIconSize:me,collisionGroup:be,latestFeatureIndex:Ee}=s.parameters,Te=L.get("text-optional"),Re=L.get("icon-optional"),Pe=L.get("text-allow-overlap"),Ie=L.get("icon-allow-overlap"),Oe=L.get("text-rotation-alignment")==="map",ze=L.get("text-pitch-alignment")==="map",Ve=z.get("symbol-z-offset"),dt=L.get("symbol-elevation-reference")==="sea",[rt,St]=L.get("text-size-scale-range"),[Tt,Dt]=L.get("icon-size-scale-range"),et=i.ay(S,rt,St),wt=i.ay(S,Tt,Dt);this.transform.setProjection(A.projection);let Ke=Pe&&(Ie||!A.hasIconData()||Re),bt=Ie&&(Pe||!A.hasTextData()||Te);const yt=!Ve.isConstant();!A.collisionArrays&&se&&A.deserializeCollisionBoxes(se),g&&x&&A.updateCollisionDebugBuffers(this.transform.zoom,se,et,wt);const Et=(ht,Ct,Gt)=>{const{crossTileID:qt,numVerticalGlyphVertices:Zt}=ht;let sr=null;if(Y&&Y.dynamicFilterNeedsFeature||yt){const hn=this.retainedQueryData[A.bucketInstanceId];sr=Ee.loadFeature({featureIndex:ht.featureIndex,bucketIndex:hn.bucketIndex,sourceLayerIndex:hn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Y&&!(0,Y.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},sr,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new i.P(ht.tileAnchorX,ht.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[qt]=new Gc(!1,!1,!1,!0),void u.add(qt);const kr=Ve.evaluate(sr,{});if(u.has(qt))return;if(ce)return void(this.placements[qt]=new Gc(!1,!1,!1));let xr=!1,Pr=!1,Ar=!0,nn=!1,wn=!1,Kn=null,Yr={box:null,offscreen:null,occluded:null},fi={box:null,offscreen:null,occluded:null},Nr=null,lr=null,sn=null,kn=0,mn=0,Mi=0;Gt.textFeatureIndex?kn=Gt.textFeatureIndex:ht.useRuntimeCollisionCircles&&(kn=ht.featureIndex),Gt.verticalTextFeatureIndex&&(mn=Gt.verticalTextFeatureIndex);const Yi=hn=>{hn.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const pi=this.transform.elevation;hn.elevation=dt?kr:kr+(pi?pi.getAtTileOffset(hn.tileID,hn.tileAnchorX,hn.tileAnchorY):0),hn.elevation+=ht.zOffset},yo=Gt.textBox;if(yo){Yi(yo);const hn=Sn=>{let $n=i.bq.horizontal;if(A.allowVerticalPlacement&&!Sn&&this.prevPlacement){const Zo=this.prevPlacement.placedOrientations[qt];Zo&&(this.placedOrientations[qt]=Zo,$n=Zo,this.markUsedOrientation(A,$n,ht))}return $n},pi=(Sn,$n)=>{if(A.allowVerticalPlacement&&Zt>0&&Gt.verticalTextBox){for(const Zo of A.writingModes)if(Zo===i.bq.vertical?(Yr=$n(),fi=Yr):Yr=Sn(),Yr&&Yr.box&&Yr.box.length)break}else Yr=Sn()};if(L.get("text-variable-anchor")){let Sn=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[qt]){const si=this.prevPlacement.variableOffsets[qt];Sn.indexOf(si.anchor)>0&&(Sn=Sn.filter(vo=>vo!==si.anchor),Sn.unshift(si.anchor))}const $n=(si,vo,pc)=>{const rs=A.getSymbolInstanceTextSize(pe,ht,this.transform.zoom,Ct),tl=(si.x2-si.x1)*rs+2*si.padding,Va=(si.y2-si.y1)*rs+2*si.padding,rl=ht.hasIconTextFit&&!Ie?vo:null;rl&&Yi(rl);let ns={box:[],offscreen:!1,occluded:!1};const ru=Pe?2*Sn.length:Sn.length;for(let mc=0;mc<ru;++mc){const nu=this.attemptAnchorPlacement(Sn[mc%Sn.length],si,tl,Va,rs,Oe,ze,re,U,be,mc>=Sn.length,ht,Ct,A,pc,rl,pe,me);if(nu&&(ns=nu.placedGlyphBoxes,ns&&ns.box&&ns.box.length)){xr=!0,Kn=nu.shift;break}}return ns};pi(()=>$n(yo,Gt.iconBox,i.bq.horizontal),()=>{const si=Gt.verticalTextBox;return si&&Yi(si),A.allowVerticalPlacement&&!(Yr&&Yr.box&&Yr.box.length)&&Zt>0&&si?$n(si,Gt.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Yr&&(xr=Yr.box,Ar=Yr.offscreen,nn=Yr.occluded);const Zo=hn(!(!Yr||!Yr.box));if(!xr&&this.prevPlacement){const si=this.prevPlacement.variableOffsets[qt];si&&(this.variableOffsets[qt]=si,this.markUsedJustification(A,si.anchor,ht,Zo))}}else{const Sn=($n,Zo)=>{const si=A.getSymbolInstanceTextSize(pe,ht,this.transform.zoom,Ct,S),vo=this.collisionIndex.placeCollisionBox(A,si,$n,new i.P(0,0),Pe,re,U,be.predicate);return vo&&vo.box&&vo.box.length&&(this.markUsedOrientation(A,Zo,ht),this.placedOrientations[qt]=Zo),vo};pi(()=>Sn(yo,i.bq.horizontal),()=>{const $n=Gt.verticalTextBox;return A.allowVerticalPlacement&&Zt>0&&$n?(Yi($n),Sn($n,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),hn(!!(Yr&&Yr.box&&Yr.box.length))}}if(Nr=Yr,xr=Nr&&Nr.box&&Nr.box.length>0,Ar=Nr&&Nr.offscreen,nn=Nr&&Nr.occluded,ht.useRuntimeCollisionCircles){const hn=A.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex>=0?ht.centerJustifiedTextSymbolIndex:ht.verticalPlacedTextSymbolIndex),pi=i.br(A.textSizeData,pe,hn),Sn=L.get("text-padding");lr=this.collisionIndex.placeCollisionCircles(A,Pe,hn,A.lineVertexArray,A.glyphOffsetArray,pi,U,V,X,g,ze,be.predicate,ht.collisionCircleDiameter*pi/i.bw,Sn,this.retainedQueryData[A.bucketInstanceId].tileID),xr=Pe||lr.circles.length>0&&!lr.collisionDetected,Ar=Ar&&lr.offscreen,nn=lr.occluded}if(Gt.iconFeatureIndex&&(Mi=Gt.iconFeatureIndex),Gt.iconBox){const hn=pi=>{Yi(pi);const Sn=ht.hasIconTextFit&&Kn?Ia(Kn.x,Kn.y,Oe,ze,this.transform.angle):new i.P(0,0),$n=A.getSymbolInstanceIconSize(me,this.transform.zoom,ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,$n,pi,Sn,Ie,re,U,be.predicate)};fi&&fi.box&&fi.box.length&&Gt.verticalIconBox?(sn=hn(Gt.verticalIconBox),Pr=sn.box.length>0):(sn=hn(Gt.iconBox),Pr=sn.box.length>0),Ar=Ar&&sn.offscreen,wn=sn.occluded}const To=Te||ht.numHorizontalGlyphVertices===0&&Zt===0,Cs=Re||ht.numIconVertices===0;if(To||Cs?Cs?To||(Pr=Pr&&xr):xr=Pr&&xr:Pr=xr=Pr&&xr,xr&&Nr&&Nr.box&&this.collisionIndex.insertCollisionBox(Nr.box,L.get("text-ignore-placement"),A.bucketInstanceId,fi&&fi.box&&mn?mn:kn,be.ID),Pr&&sn&&this.collisionIndex.insertCollisionBox(sn.box,L.get("icon-ignore-placement"),A.bucketInstanceId,Mi,be.ID),lr&&(xr&&this.collisionIndex.insertCollisionCircles(lr.circles,L.get("text-ignore-placement"),A.bucketInstanceId,kn,be.ID),g)){const hn=A.bucketInstanceId;let pi=this.collisionCircleArrays[hn];pi===void 0&&(pi=this.collisionCircleArrays[hn]=new eD);for(let Sn=0;Sn<lr.circles.length;Sn+=4)pi.circles.push(lr.circles[Sn+0]),pi.circles.push(lr.circles[Sn+1]),pi.circles.push(lr.circles[Sn+2]),pi.circles.push(lr.collisionDetected?1:0)}const pa=A.projection.name!=="globe";Ke=Ke&&(pa||!nn),bt=bt&&(pa||!wn),this.placements[qt]=new Gc(xr||Ke,Pr||bt,Ar||A.justReloaded),u.add(qt)};if(A.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(A,this.retainedQueryData[A.bucketInstanceId].tileID),A.elevationType==="road"&&A.updateRoadElevation(),A.updateZOffset(),A.sortFeaturesByY){const ht=A.getSortedSymbolIndexes(this.transform.angle);for(let Ct=ht.length-1;Ct>=0;--Ct){const Gt=ht[Ct];Et(A.symbolInstances.get(Gt),Gt,A.collisionArrays[Gt])}A.hasAnyZOffset&&i.w(`${A.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(A.hasAnyZOffset){const ht=A.getSortedIndexesByZOffset();for(let Ct=0;Ct<ht.length;++Ct){const Gt=ht[Ct];Et(A.symbolInstances.get(Gt),Gt,A.collisionArrays[Gt])}}else for(let ht=s.symbolInstanceStart;ht<s.symbolInstanceEnd;ht++)Et(A.symbolInstances.get(ht),ht,A.collisionArrays[ht]);if(g&&A.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[A.bucketInstanceId];i.ad.mat4.invert(ht.invProjMatrix,U),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(s,u,g,x){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:z,crossTileID:U}=g,V=i.bB(u),X=x===i.bq.vertical?z:V==="left"?S:V==="center"?A:V==="right"?L:-1;S>=0&&(s.text.placedSymbolArray.get(S).crossTileID=X>=0&&S!==X?0:U),A>=0&&(s.text.placedSymbolArray.get(A).crossTileID=X>=0&&A!==X?0:U),L>=0&&(s.text.placedSymbolArray.get(L).crossTileID=X>=0&&L!==X?0:U),z>=0&&(s.text.placedSymbolArray.get(z).crossTileID=X>=0&&z!==X?0:U)}markUsedOrientation(s,u,g){const x=u===i.bq.horizontal||u===i.bq.horizontalOnly?u:0,S=u===i.bq.vertical?u:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:U}=g,V=s.text.placedSymbolArray;A>=0&&(V.get(A).placedOrientation=x),L>=0&&(V.get(L).placedOrientation=x),z>=0&&(V.get(z).placedOrientation=x),U>=0&&(V.get(U).placedOrientation=S)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(s):1,S=u?u.opacities:{},A=u?u.variableOffsets:{},L=u?u.placedOrientations:{};for(const z in this.placements){const U=this.placements[z],V=S[z];V?(this.opacities[z]=new Xu(V,x,U.text,U.icon,null,U.clipped),g=g||U.text!==V.text.placed||U.icon!==V.icon.placed):(this.opacities[z]=new Xu(null,x,U.text,U.icon,U.skipFade,U.clipped),g=g||U.text||U.icon)}for(const z in S){const U=S[z];if(!this.opacities[z]){const V=new Xu(U,x,!1,!1);V.isHidden()||(this.opacities[z]=V,g=g||U.text.placed||U.icon.placed)}}for(const z in A)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=A[z]);for(const z in L)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=L[z]);g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u,g,x){const S=new Set;for(const A of u){const L=A.getBucket(s);L&&A.latestFeatureIndex&&s.fqid===L.layerIds[0]&&(this.updateBucketOpacities(L,S,A,A.collisionBoxArray,g,x,A.tileID,s.scope),L.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(L,A.tileID),L.elevationType==="road"&&L.updateRoadElevation(),L.updateZOffset())}}updateBucketOpacities(s,u,g,x,S,A,L,z){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const U=s.layers[0].layout,V=s.layers[0].paint,X=!!s.layers[0].dynamicFilter(),Y=new Xu(null,0,!1,!1,!0),re=U.get("text-allow-overlap"),ce=U.get("icon-allow-overlap"),se=U.get("text-variable-anchor"),pe=U.get("text-rotation-alignment")==="map",me=U.get("text-pitch-alignment")==="map",be=V.get("symbol-z-offset"),Ee=U.get("symbol-elevation-reference")==="sea",Te=!be.isConstant(),Re=new Xu(null,0,re&&(ce||!s.hasIconData()||U.get("icon-optional")),ce&&(re||!s.hasTextData()||U.get("text-optional")),!0);!s.collisionArrays&&x&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(x);const Pe=(Oe,ze,Ve)=>{for(let dt=0;dt<ze/4;dt++)Oe.opacityVertexArray.emplaceBack(Ve)};let Ie=0;A&&s.updateReplacement(L,A);for(let Oe=0;Oe<s.symbolInstances.length;Oe++){const ze=s.symbolInstances.get(Oe),{numHorizontalGlyphVertices:Ve,numVerticalGlyphVertices:dt,crossTileID:rt,numIconVertices:St,tileAnchorX:Tt,tileAnchorY:Dt}=ze;let et=null;const wt=this.retainedQueryData[s.bucketInstanceId];Te&&ze&&wt&&(et=g.latestFeatureIndex.loadFeature({featureIndex:ze.featureIndex,bucketIndex:wt.bucketIndex,sourceLayerIndex:wt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ke=be.evaluate(et,{}),bt=u.has(rt);let yt=this.opacities[rt];bt?yt=Y:yt||(yt=Re,this.opacities[rt]=yt),u.add(rt);const Et=Ve>0||dt>0,ht=St>0,Ct=this.placedOrientations[rt],Gt=Ct===i.bq.vertical,qt=Ct===i.bq.horizontal||Ct===i.bq.horizontalOnly;!Et&&!ht||yt.isHidden()||Ie++;let Zt=!1;if((Et||ht)&&A)for(const sr of s.activeReplacements){if(i.bx(sr,S,i.by.Symbol,z)||sr.min.x>Tt||Tt>sr.max.x||sr.min.y>Dt||Dt>sr.max.y)continue;const kr=i.bz(Tt,Dt,L.canonical,sr.footprintTileId.canonical);if(Zt=i.bA(kr,sr.footprint),Zt)break}if(Et){const sr=Zt?eh:Qd(yt.text);Pe(s.text,Ve,Gt?eh:sr),Pe(s.text,dt,qt?eh:sr);const kr=yt.text.isHidden(),{leftJustifiedTextSymbolIndex:xr,centerJustifiedTextSymbolIndex:Pr,rightJustifiedTextSymbolIndex:Ar,verticalPlacedTextSymbolIndex:nn}=ze,wn=s.text.placedSymbolArray,Kn=kr||Gt?1:0;xr>=0&&(wn.get(xr).hidden=Kn),Pr>=0&&(wn.get(Pr).hidden=Kn),Ar>=0&&(wn.get(Ar).hidden=Kn),nn>=0&&(wn.get(nn).hidden=kr||qt?1:0);const Yr=this.variableOffsets[rt];Yr&&this.markUsedJustification(s,Yr.anchor,ze,Ct);const fi=this.placedOrientations[rt];fi&&(this.markUsedJustification(s,"left",ze,fi),this.markUsedOrientation(s,fi,ze))}if(ht){const sr=Zt?eh:Qd(yt.icon),{placedIconSymbolIndex:kr,verticalPlacedIconSymbolIndex:xr}=ze,Pr=s.icon.placedSymbolArray,Ar=yt.icon.isHidden()?1:0;kr>=0&&(Pe(s.icon,St,Gt?eh:sr),Pr.get(kr).hidden=Ar),xr>=0&&(Pe(s.icon,ze.numVerticalIconVertices,qt?eh:sr),Pr.get(xr).hidden=Ar)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const sr=s.collisionArrays[Oe];if(sr){let kr=new i.P(0,0),xr=!0;if(sr.textBox||sr.verticalTextBox){if(se){const Ar=this.variableOffsets[rt];Ar?(kr=uv(Ar.anchor,Ar.width,Ar.height,Ar.textOffset,Ar.textScale),pe&&kr._rotate(me?this.transform.angle:-this.transform.angle)):xr=!1}X&&(xr=!yt.clipped),sr.textBox&&Jd(s.textCollisionBox.collisionVertexArray,yt.text.placed,!xr||Gt,Ke,Ee,kr.x,kr.y),sr.verticalTextBox&&Jd(s.textCollisionBox.collisionVertexArray,yt.text.placed,!xr||qt,Ke,Ee,kr.x,kr.y)}const Pr=xr&&!!(!qt&&sr.verticalIconBox);sr.iconBox&&Jd(s.iconCollisionBox.collisionVertexArray,yt.icon.placed,Pr,Ke,Ee,ze.hasIconTextFit?kr.x:0,ze.hasIconTextFit?kr.y:0),sr.verticalIconBox&&Jd(s.iconCollisionBox.collisionVertexArray,yt.icon.placed,!Pr,Ke,Ee,ze.hasIconTextFit?kr.x:0,ze.hasIconTextFit?kr.y:0)}}}if(s.fullyClipped=Ie===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Oe=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Oe.invProjMatrix,s.placementViewportMatrix=Oe.viewportMatrix,s.collisionCircleArray=Oe.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function Jd(y,s,u,g,x,S,A){y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0),y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0),y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0),y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0)}const h2=Math.pow(2,25),Hm=Math.pow(2,24),nD=Math.pow(2,17),iD=Math.pow(2,16),Zm=Math.pow(2,9),Xm=Math.pow(2,8),oD=Math.pow(2,1);function Qd(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const s=y.placed?1:0,u=Math.floor(127*y.opacity);return u*h2+s*Hm+u*nD+s*iD+u*Zm+s*Xm+u*oD+s}const eh=0;class dv{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,u,g,x,S,A){const L=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(L,x,s[this._currentTileIndex],this._sortAcrossTiles,A),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((z,U)=>z.sortKey-U.sortKey));this._currentPartIndex<L.length;){const z=L[this._currentPartIndex];if(u.placeLayerBucketPart(z,this._seenCrossTileIDs,g,z.symbolInstanceStart===0,A),this._currentPartIndex++,S())return!0}return!1}}class Yu{constructor(s,u,g,x,S,A,L,z,U){this.placement=new rD(s,S,A,L,z,U),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(s,u,g,x,S){const A=i.q.now(),L=()=>{const z=i.q.now()-A;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=u[s[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=U)&&(!z.maxzoom||z.maxzoom>U)){const V=z,X=V.layout.get("symbol-z-elevate"),Y=V.layout.get("symbol-sort-key").constantOr(1)!==void 0,re=V.layout.get("symbol-z-order"),ce=re==="viewport-y"||re==="auto"&&!(re!=="viewport-y"&&Y),se=V.layout.get("text-allow-overlap")||V.layout.get("icon-allow-overlap")||V.layout.get("text-ignore-placement")||V.layout.get("icon-ignore-placement"),pe=ce&&se,me=this._inProgressLayer=this._inProgressLayer||new dv(V),be=i.C(z.source,z.scope);if(me.continuePlacement(X||pe?x[be]:g[be],this.placement,this._showCollisionBoxes,z,L,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Ab=512/i.ai/2;class aD{constructor(s,u,g){this.tileID=s,this.bucketInstanceId=g,this.index=new i.bE(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=s.canonical.x*i.ai,S=s.canonical.y*i.ai;for(let A=0;A<u.length;A++){const{key:L,crossTileID:z,tileAnchorX:U,tileAnchorY:V}=u.get(A),X=Math.floor((x+U)*Ab),Y=Math.floor((S+V)*Ab);this.index.add(X,Y),this.keys.push(L),this.crossTileIDs.push(z)}this.index.finish()}findMatches(s,u,g){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),S=Ab/Math.pow(2,u.canonical.z-this.tileID.canonical.z),A=u.canonical.x*i.ai,L=u.canonical.y*i.ai;for(let z=0;z<s.length;z++){const U=s.get(z);if(U.crossTileID)continue;const{key:V,tileAnchorX:X,tileAnchorY:Y}=U,re=Math.floor((A+X)*S),ce=Math.floor((L+Y)*S),se=this.index.range(re-x,ce-x,re+x,ce+x);for(const pe of se){const me=this.crossTileIDs[pe];if(this.keys[pe]===V&&!g.has(me)){g.add(me),U.crossTileID=me;break}}}}}class sD{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class f2{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(u!==0)for(const g in this.indexes){const x=this.indexes[g],S={};for(const A in x){const L=x[A];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+u),S[L.tileID.key]=L}this.indexes[g]=S}this.lng=s}addBucket(s,u,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let S=0;S<u.symbolInstances.length;S++)u.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const x=this.usedCrossTileIDs[s.overscaledZ];for(const S in this.indexes){const A=this.indexes[S];if(Number(S)>s.overscaledZ)for(const L in A){const z=A[L];z.tileID.isChildOf(s)&&z.findMatches(u.symbolInstances,s,x)}else{const L=A[s.scaledTo(Number(S)).key];L&&L.findMatches(u.symbolInstances,s,x)}}for(let S=0;S<u.symbolInstances.length;S++){const A=u.symbolInstances.get(S);A.crossTileID||(A.crossTileID=g.generate(),x.add(A.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new aD(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let u=!1;for(const g in this.indexes){const x=this.indexes[g];for(const S in x)s[x[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[S]),delete x[S],u=!0)}return u}}class lD{constructor(){this.layerIndexes={},this.crossTileIDs=new sD,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,g,x){let S=this.layerIndexes[s.fqid];S===void 0&&(S=this.layerIndexes[s.fqid]=new f2);let A=!1;const L={};x.name!=="globe"&&S.handleWrapJump(g);for(const z of u){const U=z.getBucket(s);U&&s.fqid===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(z.tileID,U,this.crossTileIDs)&&(A=!0),L[U.bucketInstanceId]=!0)}return S.removeStaleBuckets(L)&&(A=!0),A}pruneUnusedLayers(s){const u={};s.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const Ku=771;class Jr{constructor(s,u,g,x){this.blendFunction=s,this.blendColor=u,this.mask=g,this.blendEquation=x}}Jr.Replace=[1,0,1,0],Jr.disabled=new Jr(Jr.Replace,i.al.transparent,[!1,!1,!1,!1]),Jr.unblended=new Jr(Jr.Replace,i.al.transparent,[!0,!0,!0,!0]),Jr.alphaBlended=new Jr([1,Ku,1,Ku],i.al.transparent,[!0,!0,!0,!0]),Jr.alphaBlendedNonPremultiplied=new Jr([770,Ku,770,Ku],i.al.transparent,[!0,!0,!0,!0]),Jr.multiply=new Jr([774,0,774,0],i.al.transparent,[!0,!0,!0,!0]);class gr{constructor(s,u,g){this.func=s,this.mask=u,this.range=g}}gr.ReadOnly=!1,gr.ReadWrite=!0,gr.disabled=new gr(519,gr.ReadOnly,[0,1]);const hv=7680;class Lr{constructor(s,u,g,x,S,A){this.test=s,this.ref=u,this.mask=g,this.fail=x,this.depthFail=S,this.pass=A}}Lr.disabled=new Lr({func:519,mask:0},0,0,hv,hv,hv);const Hc=1029,Ef=2305;class Or{constructor(s,u,g){this.enable=s,this.mode=u,this.frontFace=g}}function Cb(y,s){const u=i.bG(y,3);i.ad.mat4.fromQuat(y,s),i.bI(y,3,u)}function th(y,s){const u=i.ad.quat.identity([]);return i.ad.quat.rotateZ(u,u,-s),i.ad.quat.rotateX(u,u,-y),u}function Af(y,s){const u=[y[0],y[1],0],g=[s[0],s[1],0];if(i.ad.vec3.length(u)>=1e-15){const A=i.ad.vec3.normalize([],u);i.ad.vec3.scale(g,A,i.ad.vec3.dot(g,A)),s[0]=g[0],s[1]=g[1]}const x=i.ad.vec3.cross([],s,y);if(i.ad.vec3.len(x)<1e-15)return null;const S=Math.atan2(-x[1],x[0]);return th(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),S)}Or.disabled=new Or(!1,Hc,Ef),Or.backCCW=new Or(!0,Hc,Ef),Or.backCW=new Or(!0,Hc,2304),Or.frontCW=new Or(!0,1028,2304),Or.frontCCW=new Or(!0,1028,Ef);class Mb{constructor(s,u){this.position=s,this.orientation=u}get position(){return this._position}set position(s){if(s){const u=s instanceof i.ac?s:new i.ac(s[0],s[1],s[2]);this._renderWorldCopies&&(u.x=i.bF(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(s,u){if(this.orientation=null,!this.position)return;const g=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.ac.fromLngLat(s)):0,S=i.ac.fromLngLat(s,x),A=[S.x-g.x,S.y-g.y,S.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Af(A,u)}setPitchBearing(s,u){this.orientation=th(i.ak(s),i.ak(-u))}}class Cf{constructor(s,u){this._transform=i.ad.mat4.identity([]),this.orientation=u,this.position=s}get mercatorPosition(){const s=this.position;return new i.ac(s[0],s[1],s[2])}get position(){const s=i.bG(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var u;s&&i.bI(this._transform,3,[(u=s)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||i.ad.quat.identity([]),s&&Cb(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,u){this._orientation=th(s,u),Cb(this._transform,this._orientation)}forward(){const s=i.bG(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=i.bG(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=i.bG(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,u){const g=new Float64Array(16);return i.ad.mat4.invert(g,this.getWorldToCamera(s,u)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,u,g){const x=this.position;i.ad.vec3.scale(x,x,-s);const S=new Float64Array(16);return i.ad.mat4.fromScaling(S,[g,g,g]),i.ad.mat4.translate(S,S,x),S[10]*=u,S}getWorldToCamera(s,u){const g=new Float64Array(16),x=new Float64Array(4),S=this.position;return i.ad.quat.conjugate(x,this._orientation),i.ad.vec3.scale(S,S,-s),i.ad.mat4.fromQuat(g,x),i.ad.mat4.translate(g,g,S),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(s,u,g,x){const S=new Float64Array(16);return i.ad.mat4.perspective(S,s,u,g,x),S}getCameraToClipOrthographic(s,u,g,x,S,A){const L=new Float64Array(16);return i.ad.mat4.ortho(L,s,u,g,x,S,A),L}getDistanceToElevation(s,u=!1){const g=s===0?0:i.bH(s,u?i.aT(this.position[1]):this.position[1]),x=this.forward();return(g-this.position[2])/x[2]}clone(){return new Cf([...this.position],[...this.orientation])}}const Ri={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Ym{constructor(s=0,u=0,g=0,x=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=g,this.right=x}interpolate(s,u,g){return u.top!=null&&s.top!=null&&(this.top=i.ah(s.top,u.top,g)),u.bottom!=null&&s.bottom!=null&&(this.bottom=i.ah(s.bottom,u.bottom,g)),u.left!=null&&s.left!=null&&(this.left=i.ah(s.left,u.left,g)),u.right!=null&&s.right!=null&&(this.right=i.ah(s.right,u.right,g)),this}getCenter(s,u){const g=i.ay((this.left+s-this.right)/2,0,s),x=i.ay((this.top+u-this.bottom)/2,0,u);return new i.P(g,x)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Ym(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const $t=15;class fv{constructor(s,u,g,x,S,A,L){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=s||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=x??60,this.setProjection(A),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ym,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Cf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new fv(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<$t}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return i.aA(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const g=this.getProjection(),x=!i.bn(u,g);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const u=s!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const u=-s*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=i.ad.mat2.create(),i.ad.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const u=i.ay(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=i.ak(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const u=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,S=0;for(let A=0;A<u.length;A++){const L=new i.P(u[A][0]*this.width,g+u[A][1]*(this.height-g)),z=s.pointCoordinate(L);if(!z)continue;const U=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);x+=z[3]*U,S+=U}return S===0?NaN:x/S}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(s),S=this._mercatorZfromZoom(this._maxZoom),A=Math.max(x-g,S);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let g;g=s.z<this._camera.position[2]?[u.x,u.y,u.z]:[s.x,s.y,s.z];const x=i.ad.vec3.length(i.ad.vec3.sub([],this._camera.position,g));return i.ay(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let u=!1;if(s.orientation&&!i.ad.quat.exactEquals(s.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(s.orientation)),s.position){const g=[s.position.x,s.position.y,s.position.z];i.ad.vec3.exactEquals(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,u=new Mb;return u.position=new i.ac(s[0],s[1],s[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(s){if(!i.ad.quat.length(s))return!1;i.ad.quat.normalize(s,s);const u=i.ad.vec3.transformQuat([],[0,0,-1],s),g=i.ad.vec3.transformQuat([],[0,-1,0],s);if(g[2]<0)return!1;const x=Af(u,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(s){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;s[2]=i.ay(s[2],x/g,x/u),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,g){this._unmodified=!1,this._edgeInsets.interpolate(s,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const u=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(s){const u=[new i.bQ(0,s)];if(this.renderWorldCopies){const g=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),S=this.pointCoordinate(new i.P(this.width,this.height)),A=this.pointCoordinate(new i.P(0,this.height)),L=Math.floor(Math.min(g.x,x.x,S.x,A.x)),z=Math.floor(Math.max(g.x,x.x,S.x,A.x)),U=1;for(let V=L-U;V<=z+U;V++)V!==0&&u.push(new i.bQ(V,s))}return u}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,u,g){let x=[];const S=g!==void 0,A=!S;if(A&&this.zoom<u||S&&g[0]===0&&g[1]===0)return x;const L=new Set,z=(V,X,Y,re,ce)=>{const se=i.c5(X,V,Y,re,ce);L.has(se)||(x.push(new i.aH(V,X,Y,re,ce)),L.add(se))};for(let V=0;V<s.length;V++){const X=s[V];if(A&&X.canonical.z!==u)continue;const Y=X.canonical,re=X.overscaledZ,ce=X.wrap,se=1<<Y.z,pe=Y.x+1<se,me=Y.x>0,be=Y.y+1<se,Ee=Y.y>0,Te=X.wrap-(me?0:1),Re=X.wrap+(pe?0:1),Pe=me?Y.x-1:se-1,Ie=pe?Y.x+1:0;if(S)g[0]<0?(z(re,Re,Y.z,Ie,Y.y),g[1]<0&&be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Re,Y.z,Ie,Y.y+1)),g[1]>0&&Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Re,Y.z,Ie,Y.y-1))):g[0]>0?(z(re,Te,Y.z,Pe,Y.y),g[1]<0&&be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Te,Y.z,Pe,Y.y+1)),g[1]>0&&Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Te,Y.z,Pe,Y.y-1))):g[1]<0&&be?z(re,ce,Y.z,Y.x,Y.y+1):Ee&&z(re,ce,Y.z,Y.x,Y.y-1);else{const Oe=X.visibleQuadrants;1&Oe&&(z(re,Te,Y.z,Pe,Y.y),Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Te,Y.z,Pe,Y.y-1))),2&Oe&&(z(re,Re,Y.z,Ie,Y.y),Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Re,Y.z,Ie,Y.y-1))),4&Oe&&(z(re,Te,Y.z,Pe,Y.y),be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Te,Y.z,Pe,Y.y+1))),8&Oe&&(z(re,Re,Y.z,Ie,Y.y),be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Re,Y.z,Ie,Y.y+1)))}}const U=[];for(const V of x)x.some(X=>V.isChildOf(X))||U.push(V);if(x=U.filter(V=>!s.some(X=>!!(V.overscaledZ<u&&X.isChildOf(V))||V.equals(X)||V.isChildOf(X))),A){const V=1<<u,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Y=[V*X.x,V*X.y],re=4,ce=re*re;x=x.filter(se=>{const pe=se.canonical.x+.5-Y[0],me=se.canonical.y+.5-Y[1];return pe*pe+me*me<ce})}return x}coveringTiles(s){let u=this.coveringZoomLevel(s);const g=u,x=this.elevation&&this.elevation.exaggeration(),S=x&&!s.isTerrainDEM,A=this.projection.name==="mercator";if(s.minzoom!==void 0&&u<s.minzoom)return[];s.maxzoom!==void 0&&u>s.maxzoom&&(u=s.maxzoom);const L=this.locationCoordinate(this.center),z=this.center.lat,U=1<<u,V=[U*L.x,U*L.y,0],X=this.projection.name==="globe",Y=!X,re=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,Y),ce=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),se=U*i.bH(1,this.center.lat),pe=this._camera.position[2]/i.bH(1,this.center.lat),me=[U*ce.x,U*ce.y,pe*(Y?1:se)],be=X||x,Ee=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Te=this.isLODDisabled(!0)?u:0;let Re;if(this._elevation&&s.isTerrainDEM)Re=1e4*this._elevation.exaggeration();else if(this._elevation){const Ke=this._elevation.getMinMaxForVisibleTiles();Re=Ke?Ke.max:this._centerAltitude}else Re=this._centerAltitude;const Pe=s.isTerrainDEM?-Re:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ie=this.projection.isReprojectedInTileSpace?i.bS(this):1,Oe=Ke=>{const yt=new i.ac(Ke.x+25e-6,Ke.y,Ke.z),Et=new i.ac(Ke.x,Ke.y+25e-6,Ke.z),ht=Ke.toLngLat(),Ct=yt.toLngLat(),Gt=Et.toLngLat(),qt=this.locationCoordinate(ht),Zt=this.locationCoordinate(Ct),sr=this.locationCoordinate(Gt),kr=Math.hypot(Zt.x-qt.x,Zt.y-qt.y),xr=Math.hypot(sr.x-qt.x,sr.y-qt.y);return Math.sqrt(kr*xr)*Ie/25e-6},ze=Ke=>{const bt=Re,yt=Pe;return{aabb:i.bV(this,U,0,0,0,Ke,yt,bt,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:bt,wrap:Ke,fullyVisible:!1}},Ve=[];let dt=[];const rt=u,St=s.reparseOverscaled?g:u,Tt=(pe-this._centerAltitude)*se,Dt=Ke=>{if(!this._elevation||!Ke.tileID||!A)return;const bt=this._elevation.getMinMaxForTile(Ke.tileID),yt=Ke.aabb;bt?(yt.min[2]=bt.min,yt.max[2]=bt.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(Ke.shouldSplit=wt(Ke),Ke.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},et=(Ke,bt)=>{if(.707*bt<Ke)return 1;const yt=bt/Ke;return yt/(1.4144271570014144+(Math.pow(1.1,yt-1.4144271570014144+1)-1)/(1.1-1)-1)},wt=Ke=>{if(Ke.zoom<Te)return!0;if(Ke.zoom===rt)return!1;if(Ke.shouldSplit!=null)return Ke.shouldSplit;const bt=Ke.aabb.distanceX(me),yt=Ke.aabb.distanceY(me);let Et=Tt,ht=1;if(X){Et=Ke.aabb.distanceZ(me);const xr=Math.pow(2,Ke.zoom),Pr=i.aT((Ke.y+1)/xr),Ar=i.aT(Ke.y/xr),nn=Math.min(Math.max(z,Pr),Ar),wn=i.ca(nn)/i.ca(z);if(ht=nn===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,wn/this._mercatorScaleRatio),this.zoom<=i.c6&&Ke.zoom===rt-1&&wn>=.9)return!0}else if(S&&(Et=Ke.aabb.distanceZ(me)*se),this.projection.isReprojectedInTileSpace&&g<=5){const xr=Math.pow(2,Ke.zoom),Pr=Oe(new i.ac((Ke.x+.5)/xr,(Ke.y+.5)/xr));ht=Pr>.85?1:Pr}if(!A){const xr=Math.sqrt(bt*bt+yt*yt+Et*Et);let Pr=(1<<rt-Ke.zoom)*Ee*ht;return Pr*=et(Math.max(Et,Tt),xr),xr<Pr}let Ct=Number.MAX_VALUE,Gt=0;const qt=Ke.aabb.getCorners(),Zt=[];for(const xr of qt){i.ad.vec3.sub(Zt,xr,me),X||(S?Zt[2]*=se:Zt[2]=Tt);const Pr=i.ad.vec3.dot(Zt,this._camera.forward());Pr<Ct&&(Ct=Pr,Gt=Math.abs(Zt[2]))}let sr=(1<<rt-Ke.zoom)*Ee*ht;if(sr*=et(Math.max(Gt,Tt),Ct),Ct<sr)return!0;const kr=Ke.aabb.closestPoint(V);return kr[0]===V[0]&&kr[1]===V[1]};if(this.renderWorldCopies)for(let Ke=1;Ke<=3;Ke++)Ve.push(ze(-Ke)),Ve.push(ze(Ke));for(Ve.push(ze(0));Ve.length>0;){const Ke=Ve.pop(),bt=Ke.x,yt=Ke.y;let Et=Ke.fullyVisible;const ht=()=>this.projection.name==="globe"&&(Ke.y===0||Ke.y===(1<<Ke.zoom)-1);if(!Et){let Ct=be?Ke.aabb.intersects(re):Ke.aabb.intersectsFlat(re);if(Ct===0&&ht()){const Gt=new i.bT(Ke.zoom,bt,yt);Ct=i.bU(this,U,Gt,!0).intersects(re)}if(Ct===0)continue;Et=Ct===2}if(Ke.zoom!==rt&&wt(Ke))for(let Ct=0;Ct<4;Ct++){const Gt=(bt<<1)+Ct%2,qt=(yt<<1)+(Ct>>1),Zt={aabb:A?Ke.aabb.quadrant(Ct):i.bV(this,U,Ke.zoom+1,Gt,qt,Ke.wrap,Ke.minZ,Ke.maxZ,this.projection),zoom:Ke.zoom+1,x:Gt,y:qt,wrap:Ke.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:Ke.minZ,maxZ:Ke.maxZ};S&&!X&&(Zt.tileID=new i.aH(Ke.zoom+1===rt?St:Ke.zoom+1,Ke.wrap,Ke.zoom+1,Gt,qt),Dt(Zt)),Ve.push(Zt)}else{const Ct=Ke.zoom===rt?St:Ke.zoom;if(s.minzoom&&s.minzoom>Ct)continue;let Gt=0;if(!Et){let kr=be?Ke.aabb.intersectsPrecise(re):Ke.aabb.intersectsPreciseFlat(re);if(kr===0&&ht()){const xr=new i.bT(Ke.zoom,bt,yt);kr=i.bU(this,U,xr,!0).intersectsPrecise(re)}if(kr===0)continue;if(s.calculateQuadrantVisibility)if(re.containsPoint(Ke.aabb.center))Gt=15;else for(let xr=0;xr<4;xr++)Ke.aabb.quadrant(xr).intersects(re)!==0&&(Gt|=1<<xr)}const qt=V[0]-(.5+bt+(Ke.wrap<<Ke.zoom))*(1<<u-Ke.zoom),Zt=V[1]-.5-yt,sr=Ke.tileID?Ke.tileID:new i.aH(Ct,Ke.wrap,Ke.zoom,bt,yt);s.calculateQuadrantVisibility&&(sr.visibleQuadrants=Gt),dt.push({tileID:sr,distanceSq:qt*qt+Zt*Zt})}}if(this.fogCullDistSq){const Ke=this.fogCullDistSq,bt=this.horizonLineFromTop();dt=dt.filter(yt=>{const Et=[0,0,0,1],ht=[i.ai,i.ai,0,1],Ct=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());i.ad.vec4.transformMat4(Et,Et,Ct),i.ad.vec4.transformMat4(ht,ht,Ct);const Gt=i.ad.vec4.min([],Et,ht),qt=i.ad.vec4.max([],Et,ht),Zt=i.bW(Gt,qt);if(Zt===0)return!0;let sr=!1;const kr=this._elevation;if(kr&&Zt>Ke&&bt!==0){const xr=this.calculateProjMatrix(yt.tileID.toUnwrapped());let Pr;s.isTerrainDEM||(Pr=kr.getMinMaxForTile(yt.tileID)),Pr||(Pr={min:Pe,max:Re});const Ar=i.c7(this.rotation),nn=[Ar[0]*i.ai,Ar[1]*i.ai,Pr.max];i.ad.vec3.transformMat4(nn,nn,xr),sr=(1-nn[1])*this.height*.5<bt}return Zt<Ke||sr})}return dt.sort((Ke,bt)=>Ke.distanceSq-bt.distanceSq).map(Ke=>Ke.tileID)}resize(s,u){this.width=s,this.height=u,this.pixelsToGLUnits=[2/s,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const u=i.ay(s.lat,-i.bX,i.bX),g=this.projection.project(s.lng,u);return new i.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,u){let g,x;const S=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;g=(u.x-S.x)/L,x=(u.y-S.y)/L}else{const L=this.pointCoordinate(u),z=this.pointCoordinate(S);g=L.x-z.x,x=L.y-z.y}const A=this.locationCoordinate(s);this.setLocation(new i.ac(A.x-g,A.y-x))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,u){return this.projection.locationPoint(this,s,u)}locationPoint3D(s,u){return this.projection.locationPoint(this,s,u,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,u){return this.coordinateLocation(this.pointCoordinate3D(s,u))}locationCoordinate(s,u){const g=u?i.bH(u,s.lat):void 0,x=this.projection.project(s.lng,s.lat);return new i.ac(x.x,x.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,u){const g=u??this._centerAltitude,x=[s.x,s.y,0,1],S=[s.x,s.y,1,1];i.ad.vec4.transformMat4(x,x,this.pixelMatrixInverse),i.ad.vec4.transformMat4(S,S,this.pixelMatrixInverse);const A=S[3];i.ad.vec4.scale(x,x,1/x[3]),i.ad.vec4.scale(S,S,1/A);const L=x[2],z=S[2];return{p0:x,p1:S,t:L===z?0:(g-L)/(z-L)}}screenPointToMercatorRay(s){const u=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return i.ad.vec4.transformMat4(u,u,this.pixelMatrixInverse),i.ad.vec4.transformMat4(g,g,this.pixelMatrixInverse),i.ad.vec4.scale(u,u,1/u[3]),i.ad.vec4.scale(g,g,1/g[3]),u[2]=i.bH(u[2],this._center.lat)*this.worldSize,g[2]=i.bH(g[2],this._center.lat)*this.worldSize,i.ad.vec4.scale(u,u,1/this.worldSize),i.ad.vec4.scale(g,g,1/this.worldSize),new i.as([u[0],u[1],u[2]],i.ad.vec3.normalize([],i.ad.vec3.sub([],g,u)))}rayIntersectionCoordinate(s){const{p0:u,p1:g,t:x}=s,S=i.bH(u[2],this._center.lat),A=i.bH(g[2],this._center.lat);return new i.ac(i.ah(u[0],g[0],x)/this.worldSize,i.ah(u[1],g[1],x)/this.worldSize,i.ah(S,A,x))}pointCoordinate(s,u=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,u)}pointCoordinate3D(s,u){if(!this.elevation)return this.pointCoordinate(s,u);let g=this.projection.pointCoordinate3D(this,s.x,s.y);if(g)return new i.ac(g[0],g[1],g[2]);let x=0,S=this.horizonLineFromTop();if(s.y>S)return this.pointCoordinate(s,u);const A=.02*S,L=s.clone();for(let z=0;z<10&&S-x>A;z++){L.y=i.ah(x,S,.66);const U=this.projection.pointCoordinate3D(this,L.x,L.y);U?(S=L.y,g=U):x=L.y}return g?new i.ac(g[0],g[1],g[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(s);const u=this.pointCoordinate(s);return u.y>=0&&u.y<=1}_coordinatePoint(s,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,x=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return i.ad.vec4.transformMat4(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,S=this.pointLocation3D(new i.P(u,s)),A=this.pointLocation3D(new i.P(x,s)),L=this.pointLocation3D(new i.P(x,g)),z=this.pointLocation3D(new i.P(u,g));let U=Math.min(S.lng,A.lng,L.lng,z.lng),V=Math.max(S.lng,A.lng,L.lng,z.lng),X=Math.min(S.lat,A.lat,L.lat,z.lat),Y=Math.max(S.lat,A.lat,L.lat,z.lat);const re=Math.pow(2,-this.zoom)/16*270,ce=this.projection.name==="globe"?1:4,se=(pe,me,be,Ee,Te)=>{const Re=(pe+be)/2,Pe=(me+Ee)/2,Ie=new i.P(Re,Pe),{lng:Oe,lat:ze}=this.pointLocation3D(Ie),Ve=Math.max(0,U-Oe,X-ze,Oe-V,ze-Y);U=Math.min(U,Oe),V=Math.max(V,Oe),X=Math.min(X,ze),Y=Math.max(Y,ze),(Te<ce||Ve>re)&&(se(pe,me,Re,Pe,Te+1),se(Re,Pe,be,Ee,Te+1))};if(se(u,s,x,s,1),se(x,s,x,g,1),se(x,g,u,g,1),se(u,g,u,s,1),this.projection.name==="globe"){const[pe,me]=i.bZ(this);pe?(Y=90,V=180,U=-180):me&&(X=-90,V=180,U=-180)}return new i.aB(new i.bO(U,X),new i.bO(V,Y))}_getBoundsRectangular(s,u){const{top:g,left:x}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,L=new i.P(x,g),z=new i.P(A,g),U=new i.P(A,S),V=new i.P(x,S);let X=this.pointCoordinate(L,s),Y=this.pointCoordinate(z,s);const re=this.pointCoordinate(U,u),ce=this.pointCoordinate(V,u),se=(pe,me)=>(me.y-pe.y)/(me.x-pe.x);return X.y>1&&Y.y>=0?X=new i.ac((1-ce.y)/se(ce,X)+ce.x,1):X.y<0&&Y.y<=1&&(X=new i.ac(-ce.y/se(ce,X)+ce.x,0)),Y.y>1&&X.y>=0?Y=new i.ac((1-re.y)/se(re,Y)+re.x,1):Y.y<0&&X.y<=1&&(Y=new i.ac(-re.y/se(re,Y)+re.x,0)),new i.aB().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(re))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=s.visibleDemTiles.reduce((g,x)=>{if(x.dem){const S=x.dem.tree;g.min=Math.min(g.min,S.minimums[0]),g.max=Math.max(g.max,S.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*s.exaggeration(),u.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.av(this.minLng)*this.tileSize,this.worldMaxX=i.av(this.maxLng)*this.tileSize,this.worldMinY=i.aC(this.maxLat)*this.tileSize,this.worldMaxY=i.aC(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,u){return this.projection.createTileMatrix(this,u,s)}calculateDistanceTileData(s){const u=s.key,g=this._distanceTileDataCache;if(g[u])return g[u];const x=s.canonical,S=1/this.height,A=this.cameraWorldSize,L=A/this.zoomScale(x.z),z=(x.x+Math.pow(2,x.z)*s.wrap)*L,U=x.y*L,V=this.point;V.x*=A/this.worldSize,V.y*=A/this.worldSize;const X=this.angle,Y=Math.sin(-X),re=-Math.cos(-X);return g[u]={bearing:[Y,re],center:[(V.x-z)*S,(V.y-U)*S],scale:L/i.ai*S},g[u]}calculateFogTileMatrix(s){const u=s.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return i.ad.mat4.multiply(x,this.worldToFogMatrix,x),g[u]=new Float32Array(x),g[u]}calculateProjMatrix(s,u=!1,g=!1){const x=s.key;let S;if(S=g?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,S[x])return S[x];const A=this.calculatePosMatrix(s,this.worldSize);let L;return L=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,i.ad.mat4.multiply(A,L,A),S[x]=new Float32Array(A),S[x]}calculatePixelsToTileUnitsMatrix(s){const u=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const x=i.b_(s,this);return g[u]=x,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,u=i.ad.mat4.fromScaling([],[s,s,s]);return i.ad.mat4.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const u=i.bH(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),x=this._camera.forward(),S=i.bH(1,this._center.lat);g[2]/=S,x[2]/=S,i.ad.vec3.normalize(x,x);const A=s.raycast(g,x,s.exaggeration());if(A){const L=i.ad.vec3.scaleAndAdd([],g,x,A),z=new i.ac(L[0],L[1],i.bH(L[2],i.aT(L[1]))),U=(z.z+i.ad.vec3.length([z.x-g[0],z.y-g[1],z.z-g[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(U),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const u=this._elevation,g=i.bH(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(g),S=u.getAtPointOrZero(new i.ac(...x)),A=this.pixelsPerMeter/this.worldSize*S,L=this._minimumHeightOverTerrain(),z=x[2]-A;if(z<=L)if(z<0||s){const U=this.locationCoordinate(this._center,this._centerAltitude),V=[x[0],x[1],U.z-x[2]],X=i.ad.vec3.length(V);V[2]-=(L-z)/this._pixelsPerMercatorPixel;const Y=i.ad.vec3.length(V);if(Y===0)return;i.ad.vec3.scale(V,V,X/Y*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],U.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const Y=this.center;return Y.lat=i.ay(Y.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(Y.lng=i.ay(Y.lng,this.minLng,this.maxLng)),this.center=Y,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:x}=this.point;let S=0,A=g,L=x;const z=this.width/2,U=this.height/2,V=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(x-U<V&&(L=V+U),x+U>X&&(L=X-U),X-V<this.height&&(S=Math.max(S,this.height/(X-V)),L=(X+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Y=this.worldMinX*this.scale,re=this.worldMaxX*this.scale,ce=this.worldSize/2-(Y+re)/2;A=(g+ce+this.worldSize)%this.worldSize-ce,A-z<Y&&(A=Y+z),A+z>re&&(A=re-z),re-Y<this.width&&(S=Math.max(S,this.width/(re-Y)),A=(re+Y)/2)}A===g&&L===x||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(A,L))),S&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,u=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const x=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?g:1,A=this._camera.getWorldToCamera(this.worldSize,S);let L;const z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(z[8]=2*-s.x/this.width,z[9]=2*s.y/this.height,this.isOrthographic){let ze=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ve=ze*this.aspect,dt=-Ve,rt=-ze;Ve-=s.x,dt-=s.x,ze+=s.y,rt+=s.y,L=this._camera.getCameraToClipOrthographic(dt,Ve,rt,ze,this._nearZ,this._farZ),((St,Tt,Dt,et)=>{for(let wt=0;wt<16;wt++)St[wt]=i.ah(Tt[wt],Dt[wt],et)})(L,L,z,i.c9(this.pitch>=$t?1:this.pitch/$t))}else L=z;const U=i.ad.mat4.mul([],z,A);let V=i.ad.mat4.mul([],L,A);if(this.projection.isReprojectedInTileSpace){const ze=this.locationCoordinate(this.center),Ve=i.ad.mat4.identity([]);i.ad.mat4.translate(Ve,Ve,[ze.x*this.worldSize,ze.y*this.worldSize,0]),i.ad.mat4.multiply(Ve,Ve,i.c0(this)),i.ad.mat4.translate(Ve,Ve,[-ze.x*this.worldSize,-ze.y*this.worldSize,0]),i.ad.mat4.multiply(V,V,Ve),i.ad.mat4.multiply(U,U,Ve),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ad.mat4.scale([],V,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=V,this.invProjMatrix=i.ad.mat4.invert(new Float64Array(16),this.projMatrix),u){const ze=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ze[8]=2*-s.x/this.width,ze[9]=2*s.y/this.height,this.expandedFarZProjMatrix=i.ad.mat4.mul([],ze,A)}else this.expandedFarZProjMatrix=this.projMatrix;const X=i.ad.mat4.invert([],L);this.frustumCorners=i.c2.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const Y=new Float32Array(16);i.ad.mat4.identity(Y),i.ad.mat4.scale(Y,Y,[1,-1,1]),i.ad.mat4.rotateX(Y,Y,this._pitch),i.ad.mat4.rotateZ(Y,Y,this.angle);const re=i.ad.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ad.mat4.clone(re);const ce=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;re[8]=2*-s.x/this.width,re[9]=2*(s.y+ce)/this.height,this.skyboxMatrix=i.ad.mat4.multiply(Y,re,Y);const se=this.point,pe=se.x,me=se.y,be=this.width%2/2,Ee=this.height%2/2,Te=Math.cos(this.angle),Re=Math.sin(this.angle),Pe=pe-Math.round(pe)+Te*be+Re*Ee,Ie=me-Math.round(me)+Te*Ee+Re*be,Oe=new Float64Array(V);if(i.ad.mat4.translate(Oe,Oe,[Pe>.5?Pe-1:Pe,Ie>.5?Ie-1:Ie,0]),this.alignedProjMatrix=Oe,V=i.ad.mat4.create(),i.ad.mat4.scale(V,V,[this.width/2,-this.height/2,1]),i.ad.mat4.translate(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=i.ad.mat4.create(),i.ad.mat4.scale(V,V,[1,-1,1]),i.ad.mat4.translate(V,V,[-1,-1,0]),i.ad.mat4.scale(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=i.ad.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,U),this._calcFogMatrices(),this._distanceTileDataCache={},V=i.ad.mat4.invert(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=V,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const ze=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ad.vec3.transformMat4(ze,ze,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=V;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,S=[s,s,u];i.ad.vec3.scale(S,S,x),i.ad.vec3.scale(g,g,-1),i.ad.vec3.multiply(g,g,S);const A=i.ad.mat4.create();i.ad.mat4.translate(A,A,g),i.ad.mat4.scale(A,A,S),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,u,x)}_computeCameraPosition(s){const u=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-s/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*S,x.y/this.worldSize-g[1]*S,s/this.worldSize*this._centerAltitude-g[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],x=s[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(S=Math.min((u-g)/x,1)),this._camera.position=i.ad.vec3.scaleAndAdd([],this._camera.position,s,S),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),S=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ak(this._maxPitch)),L=Math.max((s[2]-S)/Math.cos(g),A),z=this._zoomFromMercatorZ(L);i.ad.vec3.scaleAndAdd(s,s,u,L),this._pitch=i.ay(g,i.ak(this.minPitch),i.ak(this.maxPitch)),this.angle=i.bF(x,-Math.PI,Math.PI),this._setZoom(i.ay(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ac(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let u=0,g=i.bY,x=0,S=1/0;for(;g-u>1e-6&&g>u;){const A=u+.5*(g-u),L=this.tileSize*Math.pow(2,A),z=this.getCameraToCenterDistance(this.projection,A,L),U=this.scaleZoom(z/(s*this.tileSize)),V=Math.abs(A-U);V<S&&(S=V,x=A),A<U?u=A:g=A}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,u){const g=Math.min(s.x,u.x),x=Math.max(s.x,u.x),S=Math.min(s.y,u.y),A=Math.max(s.y,u.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new i.P(g,S),new i.P(x,A),new i.P(g,A),new i.P(x,S)],z=this.renderWorldCopies?-3:0,U=this.renderWorldCopies?4:1;for(const V of L){const X=this.pointRayIntersection(V);if(X.t<0)return!0;const Y=this.rayIntersectionCoordinate(X);if(Y.x<z||Y.y<0||Y.x>U||Y.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(s,u){const g=i.ad.vec3.length(i.ad.vec3.sub([],this._camera.position,s)),x=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([u,g,x],S){const A=[u,g,x,1];i.ad.vec4.transformMat4(A,A,S);const L=A[3]=Math.max(A[3],1e-6);return A[0]/=L,A[1]/=L,A[2]/=L,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,s))}}getCameraToCenterDistance(s,u=this.zoom,g=this.worldSize){const x=i.b$(s,u,this.width,this.height,1024),S=s.pixelSpaceConversion(this.center.lat,g,x);let A=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(A=i.ah(1,A,i.c9(this.pitch>=$t?1:this.pitch/$t))),A}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ad.mat4.multiply(s,s,this.globeMatrix),s}getFrustum(s){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const Zc=(y,s)=>{if(s>0&&y.terrain&&i.w("Cutoff is currently disabled on terrain"),s<=0||y.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=y.transform,g=Math.max(Math.abs(u._zoom-(y.minCutoffZoom-1)),1),x=u.isLODDisabled(!1)?i.ae(60,45,u.pitch):i.ae(30,15,u.pitch),S=u._farZ-u._nearZ,A=s*u.height,L=((1-(z=x))*u.cameraToCenterDistance+z*(u._farZ+A))*g;var z;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(L-u._nearZ)/S,(L-A-u._nearZ)/S]}}},ea={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class p2{constructor(s,u){this.aabb=s,this.lastCascade=u}}class pv{add(s,u){const g=this.receivers[s.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],u.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],u.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],u.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],u.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],u.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],u.max[2])):this.receivers[s.key]=new p2(u,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,u,g){const x=i.ce.fromPoints(s.points);let S=0;for(const A in this.receivers){const L=this.receivers[A];if(!L||!x.intersectsAabb(L.aabb))continue;L.aabb.min=x.closestPoint(L.aabb.min),L.aabb.max=x.closestPoint(L.aabb.max);const z=L.aabb.getCorners();for(let U=0;U<g.length;U++){let V=!0;for(const X of z){const Y=[X[0]*u,X[1]*u,X[2]];if(i.ad.vec3.transformMat4(Y,Y,g[U].matrix),Y[0]<-1||Y[0]>1||Y[1]<-1||Y[1]>1){V=!1;break}}if(L.lastCascade=U,S=Math.max(S,U),V)break}}return S+1}}class Xc{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new pv,this._depthMode=new gr(s.context.gl.LEQUAL,gr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(ea,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(ea,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(ea,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,u){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const x=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||x<=0||(this._shadowLayerCount=g.style.order.reduce((ce,se)=>{const pe=g.style._mergedLayers[se];return ce+(pe.hasShadowPass()&&!pe.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=g.context,A=ea.shadowMapResolution,L=ea.shadowMapResolution;if(this._cascades.length===0||ea.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ce=0;ce<ea.cascadeCount;++ce){const se=g._shadowMapDebug,pe=S.gl,me=S.createFramebuffer(A,L,se,"texture"),be=new i.T(S,{width:A,height:L,data:null},pe.DEPTH_COMPONENT16);if(me.depthAttachment.set(be.texture),se){const Ee=new i.T(S,{width:A,height:L,data:null},pe.RGBA8);me.colorAttachment.set(Ee.texture)}this._cascades.push({framebuffer:me,texture:be,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=Ju(u);let z=0;if(s.elevation){const ce=s.elevation,se=[1e4,-1e4];ce.visibleDemTiles.filter(pe=>pe.dem).forEach(pe=>{const me=pe.dem.tree;se[0]=Math.min(se[0],me.minimums[0]),se[1]=Math.max(se[1],me.maximums[0])}),se[0]!==1e4&&(z=(se[1]-se[0])*ce.exaggeration())}const U=1.5*s.cameraToCenterDistance,V=3*U,X=new Float64Array(16);for(let ce=0;ce<this._cascades.length;++ce){const se=this._cascades[ce];let pe=s.height/50,me=1;ea.cascadeCount===1?me=V:ce===0?me=U:(pe=U,me=V);const[be,Ee]=If(s,this.shadowDirection,pe,me,ea.shadowMapResolution,z);se.scale=s.scale,se.matrix=be,se.boundingSphereRadius=Ee,i.ad.mat4.invert(X,se.matrix),se.frustum=i.bR.fromInvProjectionMatrix(X,1,0,!0),se.far=me}const Y=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Y].far,this._cascades[Y].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ea.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ea.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ri.ShadowMap0,this._uniformValues.u_shadowmap_1=Ri.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const re=g.transform.elevation;for(const ce of this._groundShadowTiles){let se={min:0,max:0};if(re){const pe=re.getMinMaxForTile(ce);pe&&(se=pe)}this.addShadowReceiver(ce.toUnwrapped(),se.min,se.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,u){if(!this.enabled)return;const g=this.painter,x=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),x.viewport.set([0,0,ea.shadowMapResolution,ea.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){g.currentShadowCascade=S,x.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),x.clear({color:i.al.white,depth:1});for(const A of s.order){const L=s._mergedLayers[A];if(!L.hasShadowPass()||L.isHidden(g.transform.zoom))continue;const z=s.getLayerSourceCache(L),U=z?u[z.id]:void 0;(L.type==="model"||U&&U.length)&&g.renderLayer(g,z,L,U)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,u=s.style,g=s.context,x=u.directionalLight,S=u.ambientLight;if(!x||!S)return;const A=[],L=Zc(s,s.longestCutoffRange);L.shouldRenderCutoff&&A.push("RENDER_CUTOFF"),A.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&A.push("NORMAL_OFFSET");const z=Pf(u,x,S),U=new gr(g.gl.LEQUAL,gr.ReadOnly,s.depthRangeFor3D);for(const V of this._groundShadowTiles){const X=V.toUnwrapped(),Y=s.isTileAffectedByFog(V),re=s.getOrCreateProgram("groundShadow",{defines:A,overrideFog:Y});this.setupShadows(X,re),s.uploadCommonUniforms(g,re,X,null,L);const ce={u_matrix:s.transform.calculateProjMatrix(X),u_ground_shadow_factor:z};re.draw(s,g.gl.TRIANGLES,U,Lr.disabled,Jr.multiply,Or.disabled,ce,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Jr.unblended:Jr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const u=this.painter.transform,g=u.calculatePosMatrix(s,u.worldSize);return i.ad.mat4.multiply(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(s){return i.ad.mat4.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,u,g,x=0){if(!this.enabled)return;const S=this.painter.transform,A=this.painter.context,L=A.gl,z=this._uniformValues,U=new Float64Array(16),V=S.calculatePosMatrix(s,S.worldSize);for(let X=0;X<this._cascades.length;X++)i.ad.mat4.multiply(U,this._cascades[X].matrix,V),z[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(U),A.activeTexture.set(L.TEXTURE0+Ri.ShadowMap0+X),this._cascades[X].texture.bind(L.NEAREST,L.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){const X=i.cd(s.canonical),Y=2/S.tileSize*i.ai/ea.shadowMapResolution,re=Y*this._cascades[0].boundingSphereRadius,ce=Y*this._cascades[this._cascades.length-1].boundingSphereRadius,se=(g==="vector-tile"?1:3)/Math.pow(2,x-s.canonical.z-(1-S.zoom+Math.floor(S.zoom)));z.u_shadow_normal_offset=[X,re*se,ce*se],z.u_shadow_bias=[6e-5,.0012,.012]}else z.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(A,z)}setupShadowsFromMatrix(s,u,g=!1){if(!this.enabled)return;const x=this.painter.context,S=x.gl,A=this._uniformValues,L=new Float64Array(16);for(let z=0;z<ea.cascadeCount;z++)i.ad.mat4.multiply(L,this._cascades[z].matrix,s),A[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),x.activeTexture.set(S.TEXTURE0+Ri.ShadowMap0+z),this._cascades[z].texture.bind(S.NEAREST,S.CLAMP_TO_EDGE);if(this.useNormalOffset=g,g){const z=ea.normalOffset;A.u_shadow_normal_offset=[1,z,z],A.u_shadow_bias=[6e-5,.0012,.012]}else A.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(x,A)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,u,g,x){if(x[2]>=0)return{};const S=function(z,U,V){const X=V/(1<<z.canonical.z);return new i.ce([z.canonical.x*X+z.wrap*V,z.canonical.y*X+z.wrap*V,0],[(z.canonical.x+1)*X+z.wrap*V,(z.canonical.y+1)*X+z.wrap*V,U])}(s,u,g).getCorners(),A=u/-x[2];x[0]<0?(i.ad.vec3.add(S[0],S[0],[x[0]*A,0,0]),i.ad.vec3.add(S[3],S[3],[x[0]*A,0,0])):x[0]>0&&(i.ad.vec3.add(S[1],S[1],[x[0]*A,0,0]),i.ad.vec3.add(S[2],S[2],[x[0]*A,0,0])),x[1]<0?(i.ad.vec3.add(S[0],S[0],[0,x[1]*A,0]),i.ad.vec3.add(S[1],S[1],[0,x[1]*A,0])):x[1]>0&&(i.ad.vec3.add(S[2],S[2],[0,x[1]*A,0]),i.ad.vec3.add(S[3],S[3],[0,x[1]*A,0]));const L={};return L.vertices=S,L.planes=[Mf(S[1],S[0],S[4]),Mf(S[2],S[1],S[5]),Mf(S[3],S[2],S[6]),Mf(S[0],S[3],S[7])],L}addShadowReceiver(s,u,g){this._receivers.add(s,i.ce.fromTileIdAndHeight(s,u,g))}getMaxCascadeForTile(s){const u=this._receivers.get(s);return u&&u.lastCascade?u.lastCascade:0}}function Mf(y,s,u){const g=i.ad.vec3.sub([],u,s),x=i.ad.vec3.sub([],y,s),S=i.ad.vec3.cross([],g,x),A=i.ad.vec3.length(S);return A===0?[0,0,1,0]:(i.ad.vec3.scale(S,S,1/A),[S[0],S[1],S[2],-i.ad.vec3.dot(S,s)])}function Ju(y){const s=y.properties.get("direction"),u=i.cc(s.x,s.y,s.z);u[2]=i.ay(u[2],0,75);const g=i.cf([u[0],u[1],u[2]]);return i.ad.vec3.fromValues(g.x,g.y,g.z)}function Pf(y,s,u){const g=s.properties.get("color-use-theme")==="none",x=s.properties.get("color"),S=s.properties.get("intensity"),A=s.properties.get("direction"),L=[A.x,A.y,A.z],z=u.properties.get("color-use-theme")==="none",U=u.properties.get("color"),V=u.properties.get("intensity"),X=Math.max(i.ad.vec3.dot([0,0,1],L),0),Y=[0,0,0];i.ad.vec3.scale(Y,U.toRenderColor(z?null:y.getLut(s.scope)).toArray01Linear().slice(0,3),V);const re=[0,0,0];return i.ad.vec3.scale(re,x.toRenderColor(g?null:y.getLut(u.scope)).toArray01Linear().slice(0,3),X*S),i.cg([Y[0]>0?Y[0]/(Y[0]+re[0]):0,Y[1]>0?Y[1]/(Y[1]+re[1]):0,Y[2]>0?Y[2]/(Y[2]+re[2]):0])}function If(y,s,u,g,x,S){const A=y.zoom,L=y.scale,z=y.worldSize,U=1/z,V=y.aspect,X=Math.sqrt(1+V*V)*Math.tan(.5*y.fovX),Y=X*X,re=g-u,ce=g+u;let se,pe;Y>re/ce?(se=g,pe=g*X):(se=.5*ce*(1+Y),pe=.5*Math.sqrt(re*re+2*(g*g+u*u)*Y+ce*ce*Y*Y));const me=y.projection.pixelsPerMeter(y.center.lat,z),be=y._camera.getCameraToWorldMercator(),Ee=[0,0,-se*U];i.ad.vec3.transformMat4(Ee,Ee,be);let Te=pe*U;const Re=y._edgeInsets;if(!(Re.left===0&&Re.top===0&&Re.right===0&&Re.bottom===0||Re.left===Re.right&&Re.top===Re.bottom)){const Et=y._camera.getWorldToCamera(y.worldSize,y.projection.zAxisUnit==="meters"?me:1),ht=y._camera.getCameraToClipPerspective(y._fov,y.width/y.height,u,g);ht[8]=2*-y.centerOffset.x/y.width,ht[9]=2*y.centerOffset.y/y.height;const Ct=new Float64Array(16);i.ad.mat4.mul(Ct,ht,Et);const Gt=new Float64Array(16);i.ad.mat4.invert(Gt,Ct);const qt=i.bR.fromInvProjectionMatrix(Gt,z,A,!0);for(const Zt of qt.points){const sr=((Pe=Zt)[0]/=L,Pe[1]/=L,Pe[2]=i.bH(Pe[2],y._center.lat),Pe);Te=Math.max(Te,i.ad.vec3.len(i.ad.vec3.subtract([],Ee,sr)))}}var Pe;Te*=x/(x-1);const Ie=Math.acos(s[2]),Oe=Math.atan2(-s[0],-s[1]),ze=new Cf;ze.position=Ee,ze.setPitchBearing(Ie,Oe);const Ve=ze.getWorldToCamera(z,me),dt=Te*z,rt=Math.min(y._mercatorZfromZoom(17)*z*-2,-2*dt),St=ze.getCameraToClipOrthographic(-dt,dt,-dt,dt,rt,(dt+S*me)/s[2]),Tt=new Float64Array(16);i.ad.mat4.multiply(Tt,St,Ve);const Dt=i.ad.vec3.fromValues(Math.floor(1e6*Ee[0])/1e6*z,Math.floor(1e6*Ee[1])/1e6*z,0),et=.5*x,wt=[0,0,0];i.ad.vec3.transformMat4(wt,Dt,Tt),i.ad.vec3.scale(wt,wt,et);const Ke=[Math.floor(wt[0]),Math.floor(wt[1]),Math.floor(wt[2])],bt=[0,0,0];i.ad.vec3.sub(bt,wt,Ke),i.ad.vec3.scale(bt,bt,-1/et);const yt=new Float64Array(16);return i.ad.mat4.identity(yt),i.ad.mat4.translate(yt,yt,bt),i.ad.mat4.multiply(Tt,yt,Tt),[Tt,dt]}class cD extends i.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(s,u){return i.aN(this.requestManager.transformRequest(u,i.R.Model).url).then(g=>{if(!g)return;const x=i.aO(g),S=new i.aP(s,void 0,void 0,x);return S.computeBoundsAndApplyParent(),S}).catch(g=>{if(g&&g.status===404)return null;this.fire(new i.z(new Error(`Could not load model ${s} from ${u}: ${g.message}`)))})}load(s,u,g={keepNumReferences:!1}){this.models[u]||(this.models[u]={});const x=Object.keys(s);this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+x.length;const S=[];for(const A of x)S.push(this.loadModel(A,s[A]));Promise.allSettled(S).then(A=>{for(let L=0;L<A.length;L++){const{status:z,value:U}=A[L];if(z==="fulfilled"&&U){const V=this.models[u][x[L]];this.models[u][x[L]]={model:U,numReferences:g.keepNumReferences&&V?V.numReferences:1}}}this.numModelsLoading[u]-=x.length,this.fire(new i.A("data",{dataType:"style"}))}).catch(A=>{this.fire(new i.z(new Error(`Could not load models: ${A.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,u){return!!this.getModel(s,u)}getModel(s,u){return this.models[u]||(this.models[u]={}),this.models[u][s]?this.models[u][s].model:void 0}addModel(s,u,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={}),this.hasModel(s,g)&&this.models[g][s].numReferences++,this.modelUris[g][s]=this.requestManager.normalizeModelURL(u),this.load({[s]:this.modelUris[g][s]},g)}addModels(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g=this.modelUris[u];for(const x in s)this.models[u][x]={},g[x]=this.requestManager.normalizeModelURL(s[x]);this.load(g,u,{keepNumReferences:!0})}reloadModels(s){this.load(this.modelUris[s],s)}addModelsFromBucket(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g={};for(const x of s)this.hasModel(x,u)?this.models[u][x].numReferences++:(this.modelUris[u][x]=this.requestManager.normalizeModelURL(x),g[x]=this.modelUris[u][x]);this.load(g,u)}removeModel(s,u){if(this.models[u]&&this.models[u][s]&&(this.models[u][s].numReferences--,this.models[u][s].numReferences===0)){const g=this.models[u][s].model;delete this.models[u][s],delete this.modelUris[u][s],g.destroy()}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,u){this.models[u]||(this.models[u]={});for(const g in this.models[u])this.models[u][g].model&&this.models[u][g].model.upload(s.context)}}const uD=new i.a7({data:new i.a8(i.a5.colorTheme.data)}),Pb={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function m2(y){return y=y||{},Object.assign(y,Pb)}class g2 extends i.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aQ(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(A,L){const[z,U]=A,{center:V,radius:X}=L,[Y,re]=V,ce=Math.abs(z-Y);return Math.sqrt((ce>180?360-ce:ce)**2+(U-re)**2)<=X}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.A("floorplangone")));const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=new i.P(this._map.transform.width/2,this._map.transform.height/2),x=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(s?x:g,u);S.length>0&&(this._selectedFloorplan&&S[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=S[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(S){const[[A,L],[z,U]]=S,V=(z-A+360)%360,X=V>180?360-V:V;return{center:[(A+X/2+360)%360,(L+U)/2],radius:Math.sqrt(X**2+(U-L)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const u=this._floorplanStates[this._indoorData.id].selectedBuilding,g=this._floorplanStates[this._indoorData.id].selectedLevel;let x;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const S of this._indoorData.levels)S.id===this._selectedLevel.id&&(x=S.id);if(this.fire(new i.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:x})),u){const S=this._indoorData.buildings.find(A=>A.id===u);this._buildingSelected(S,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(g){const S=this._indoorData.levels.find(A=>A.id===g);this._updateLevels(S,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,u){u&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const g=this._indoorData.levels.filter(x=>s.levels.includes(x.id));this.fire(new i.A("buildingselected",{buildingId:s.id,levels:g}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{const u=this._indoorData.levels.find(g=>g.id===s);this._updateLevels(u,!0)}this.fire(new i.A("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,u){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(u&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function g(U){const V=U.indexOf("/floor/");if(V===-1)return U;const X=V+7,Y=U.indexOf("/",X);return Y===-1?U.slice(X):U.slice(X,Y)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const x=[],S={},A={},L={},z={};for(const U of this._indoorData.levels)if(x.push(U.id),S[U.id]=U.height,A[U.id]=U.base,s){if(this.mergeFloors){const V=g(s.id),X=g(U.id);L[U.id]=X===V?"true":"false"}else L[U.id]=U.id===s.id?"true":"false";z[U.id]=U.base<s.base?"true":"false"}else z[U.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",L]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",z]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),u&&s.extent)){const U=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),V=this._map.getZoom(),X=U.zoom?Math.abs(V-U.zoom):0;this._map.fitBounds(s.extent,X>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:V})}}selectFloorplan(s){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(g,u);if(x.length>0){for(const S of x)if(JSON.parse(S.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=S,this._floorplanSelected(!0);break}}}selectBuilding(s){const u=this._indoorData.buildings.find(g=>g.id===s);this._buildingSelected(u,!0)}selectLevel(s){this._levelSelected(s)}}function y2(y){if(!y.metadata||!y.metadata.content_area)return;const s=i.q.devicePixelRatio,{left:u,top:g,width:x,height:S}=y.metadata.content_area,A=u*s,L=g*s;return[A,L,A+x*s,L+S*s]}function mv(y){if(y)return y.map(([s,u])=>[s*i.q.devicePixelRatio,u*i.q.devicePixelRatio])}class dD{constructor(s,u){this.id=s,this.style=u}addIcons(s){const u=new Map;for(const[g,x]of s.entries()){const S=i.I.from({name:g,iconsetId:this.id});u.set(S,x)}this.style.addImages(u)}}const rh=(y,s)=>ut(y,s&&s.filter(u=>u.identifier!=="source.canvas")),hD=i.aA(vn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),fD=i.aA(vn,["setCenter","setZoom","setBearing","setPitch"]),gv=new Set(["background","sky","slot","custom"]),v2={version:8,layers:[],sources:{}},Km={duration:300,delay:0};class Rl extends i.E{constructor(s,u={}){super(),this.map=s,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=i.l({},Km),this._buildingIndex=new u2(this),this.crossTileSymbolIndex=new lD,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new tr,this.dispatcher=u.dispatcher?u.dispatcher:new i.D(i.cj(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new un(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new i.ck(s._requestManager,u.localFontFamily?i.cl.all:u.localIdeographFontFamily?i.cl.ideographs:i.cl.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new cD(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",i.cm());const g=this;this._rtlTextPluginCallback=Rl.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(S,A)=>{if(i.cn(S),A&&A.every(L=>L))for(const L in g._sourceCaches){const z=g._sourceCaches[L],U=z.getSource().type;U!=="vector"&&U!=="geojson"||z.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const S=this.getOwnSource(x.sourceId);if(S&&S.vectorLayerIds)for(const A in this._layers){const L=this._layers[A];L.source===S.id&&this._validateLayer(L)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(i.f(s))return s;const u=i.co(s);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${i.cp(JSON.stringify(s))}`}_diffStyle(s,u,g){this.globalId=this._getGlobalId(s);const x=(S,A)=>{try{A(null,this.setState(S,g))}catch(L){A(L,!1)}};if(typeof s=="string"){const S=this.map._requestManager.normalizeStyleURL(s),A=this.map._requestManager.transformRequest(S,i.R.Style);i.n(A,(L,z)=>{L?this.fire(new i.z(L)):z&&x(z,u)})}else typeof s=="object"&&x(s,u)}loadURL(s,u={}){this.fire(new i.A("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!i.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,u.accessToken),this.resolvedImports.add(s);const x=this.importsCache.get(s);if(x)return this._load(x,g);const S=this.map._requestManager.transformRequest(s,i.R.Style);this._request=i.n(S,(A,L)=>{if(this._request=null,A)this.fire(new i.z(A));else if(L)return this.importsCache.set(s,L),this._load(L,g)})}loadJSON(s,u={}){this.fire(new i.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=i.q.frame(()=>{this._request=null,this._load(s,u.validate!==!1)})}loadEmpty(){this.fire(new i.A("dataloading",{dataType:"style"})),this._load(v2,!1)}_loadImports(s,u,g){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const S of s){const A=this._createFragmentStyle(S),L=new Promise(V=>{A.once("style.import.load",V),A.once("error",V)}).then(()=>this.mergeAll());if(x.push(L),this.resolvedImports.has(S.url)){A.loadEmpty();continue}const z=S.data||this.importsCache.get(S.url);z?(A.loadJSON(z,{validate:u}),this._isInternalStyle(z)&&(A.globalId=null)):S.url?A.loadURL(S.url,{validate:u}):A.loadEmpty();const U={style:A,id:S.id,config:S.config};if(g){const V=this.fragments.findIndex(({id:X})=>X===g);this.fragments=this.fragments.slice(0,V).concat(U).concat(this.fragments.slice(V))}else this.fragments.push(U)}return Promise.allSettled(x)}getImportGlobalIds(s=this,u=new Set){for(const g of s.fragments)g.style.globalId&&u.add(g.style.globalId),this.getImportGlobalIds(g.style,u);return[...u.values()]}_createFragmentStyle(s){const u=this.scope?i.C(s.id,this.scope):s.id;let g;const x=this._initialConfig&&this._initialConfig[u];(s.config||x)&&(g=i.l({},s.config,x));const S=new Rl(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,u){const g=s.indoor?m2(s.schema):s.schema;if(this._isInternalStyle(s)){const A=i.l({},v2,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(A,u)}if(this.updateConfig(this._config,g),u&&rh(this,cn(s)))return;this._loaded=!0,this.stylesheet=i.cq(s);const x=()=>{for(const U in s.sources)this.addSource(U,s.sources[U],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const U in s.iconsets)this.addIconset(U,s.iconsets[U]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(s.glyphs);const A=Vm(this.stylesheet.layers);if(this._order=A.map(U=>U.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const U=this.stylesheet.lights[0];this.light=new pt(U.properties,U.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new pt(this.stylesheet.light)),this._layers={};for(const U of A){const V=i.cv(U,this.scope,this._styleColorTheme.lut,this.options);V.configDependencies.size!==0&&this._configDependentLayers.add(V.fqid),V.setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V;const X=this.getOwnLayerSourceCache(V),Y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&V.canCastShadows()&&Y&&(X.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const L=this.stylesheet.terrain;L&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(L,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.A("data",{dataType:"style"}));const z=this.isRootStyle();s.imports?this._loadImports(s.imports,u).then(()=>{this._reloadImports(),this.fire(new i.A(z?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.A(z?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const S=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(S){const A=this._evaluateColorThemeData(S);this._loadColorTheme(A).then(()=>{x()}).catch(L=>{i.w(`Couldn't load color theme from the stylesheet: ${L}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,u,g,x,S,A,L,z,U,V;const X={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Y=>{if(Y.stylesheet){if(Y.light!=null&&(s=Y.light),Y.stylesheet.lights)for(const re of Y.stylesheet.lights)re.type==="ambient"&&Y.ambientLight!=null&&(u=Y.ambientLight),re.type==="directional"&&Y.directionalLight!=null&&(g=Y.directionalLight);x=this._prioritizeTerrain(x,Y.terrain,Y.stylesheet.terrain),Y.stylesheet.fog&&Y.fog!=null&&(S=Y.fog),Y.stylesheet.snow&&Y.snow!=null&&(A=Y.snow),Y.stylesheet.rain&&Y.rain!=null&&(L=Y.rain),Y.stylesheet.camera!=null&&(V=Y.stylesheet.camera),Y.stylesheet.projection!=null&&(z=Y.stylesheet.projection),Y.stylesheet.transition!=null&&(U=Y.stylesheet.transition),X[Y.scope]=Y._styleColorTheme}}),this.light=s,this.ambientLight=u,this.directionalLight=g,this.fog=S,this.snow=A,this.rain=L,this._styleColorThemeForScope=X,x===null?delete this.terrain:this.terrain=x,this.camera=V||{"camera-projection":"perspective"},this.projection=z||{name:"mercator"},this.transition=i.l({},Km,U),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const u=g=>{for(const x of g.fragments)u(x.style);s(g)};u(this)}_prioritizeTerrain(s,u,g){const x=s&&s.drapeRenderMode===0;return g===null?u&&u.drapeRenderMode===0?u:x?s:null:u!=null&&(!s||x||u&&u.drapeRenderMode===1)?u:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{s=this._prioritizeTerrain(s,u.terrain,u.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(s=u.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},u={},g={};this.forEachFragmentStyle(x=>{for(const S in x._sourceCaches){const A=i.C(S,x.scope);s[A]=x._sourceCaches[S]}for(const S in x._otherSourceCaches){const A=i.C(S,x.scope);u[A]=x._otherSourceCaches[S]}for(const S in x._symbolSourceCaches){const A=i.C(S,x.scope);g[A]=x._symbolSourceCaches[S]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=g}mergeLayers(){const s={},u=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const A of S._order){const L=S._layers[A];if(L.type==="slot"){const z=i.cr(A);if(s[z])continue;s[z]=[]}L.slot&&s[L.slot]?s[L.slot].push(L):u.push(L)}}),this._mergedOrder=[];const x=(S=[])=>{for(const A of S)if(A.type==="slot"){const L=i.cr(A.id);s[L]&&x(s[L]),this._mergedSlots.push(L)}else{const L=i.C(A.id,A.scope);this._mergedOrder.push(L),g[L]=A,A.is3D(!!this.terrain)&&(this._has3DLayers=!0),A.type==="circle"&&(this._hasCircleLayers=!0),A.type==="symbol"&&(this._hasSymbolLayers=!0),A.type==="clip"&&(this._clipLayerPresent=!0)}};x(u),this._mergedOrder.sort((S,A)=>{const L=g[S],z=g[A];return L.hasInitialOcclusionOpacityProperties?z.is3D(!!this.terrain)?1:0:L.is3D(!!this.terrain)&&z.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=i.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(u,g,x){const S=i.l({},g);for(const L of Object.keys(i.a5.colorTheme))S[L]===void 0&&(S[L]=i.a5.colorTheme[L].default);const A=new i.a6(uD,u,new Map(x));return A.setTransitionOrValue(S,x),A.untransitioned().possiblyEvaluate(new i.aa(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,x)=>{const S="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let A=s;A.startsWith(S)||(A=S+A);const L=i.I.from("mapbox-reserved-lut"),z=new Image;z.src=A,z.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},z.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void g();this._styleColorTheme.lutLoading=!1;const{width:U,height:V,data:X}=i.q.getImageData(z);if(V>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(U!==V*V)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(L)&&this.removeImage(L),this.addImage(L,{data:new i.r({width:U,height:V},X),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Y=this.imageManager.getImage(L,this.scope);Y?(this._styleColorTheme.lut={image:Y.data,data:s},g()):x(new Error("Missing LUT image."))}})}getLut(s){const u=this._styleColorThemeForScope[s];return u?u.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(u,g,x){let S,A,L;const z=i.q.devicePixelRatio>1?"@2x":"";let U=i.n(g.transformRequest(g.normalizeSpriteURL(u,z,".json"),i.R.SpriteJSON),(Y,re)=>{U=null,L||(L=Y,S=re,X())}),V=i.o(g.transformRequest(g.normalizeSpriteURL(u,z,".png"),i.R.SpriteImage),(Y,re)=>{V=null,L||(L=Y,A=re,X())});function X(){if(L)x(L);else if(S&&A){const Y=i.q.getImageData(A),re={};for(const ce in S){const{width:se,height:pe,x:me,y:be,sdf:Ee,pixelRatio:Te,stretchX:Re,stretchY:Pe,content:Ie}=S[ce],Oe=new i.r({width:se,height:pe});i.r.copy(Y,Oe,{x:me,y:be},{x:0,y:0},{width:se,height:pe},null),re[ce]={data:Oe,pixelRatio:Te,sdf:Ee,stretchX:Re,stretchY:Pe,content:Ie,usvg:!1}}x(null,re)}}return{cancel(){U&&(U.cancel(),U=null),V&&(V.cancel(),V=null)}}}(s,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new i.z(u));else if(g){const x=new Map;for(const S in g)x.set(i.I.from(S),g[S]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))})}addIconset(s,u){if(u.type==="sprite")return void this._loadSprite(u.url);const g=this.getOwnSource(u.source);if(!g)return void this.fire(new i.z(new Error(`Source "${u.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));if(g.type!=="raster-array")return void this.fire(new i.z(new Error(`Source "${u.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));this.imageManager.createIconset(this.scope,s);const x=new dD(s,this);g.addIconset(s,x)}_loadIconset(s){if(!i.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const u=this.map._spriteFormat==="auto";var g,x;this._spriteRequest=(x=(S,A)=>{if(this._spriteRequest=null,S)u?this._loadSprite(s):this.fire(new i.z(S));else if(A){const L=new Map;for(const z in A)L.set(i.I.from(z),A[z]);this.addImages(L)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))},i.bj((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(s),i.R.Iconset),(S,A)=>{if(S)return void x(S);const L={},z=i.ch(new i.bi(A));for(const U of z.icons){const V={version:1,pixelRatio:i.q.devicePixelRatio,content:y2(U),stretchX:U.metadata?mv(U.metadata.stretch_x_areas):void 0,stretchY:U.metadata?mv(U.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:U};L[U.name]=V}x(null,L)}))}_validateLayer(s){const u=this.getOwnSource(s.source);if(!u)return;const g=s.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.z(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,u)=>{const g=this.fragments[u];return g&&g.style&&(s.data=g.style.serialize()),s})}_serializeSources(){const s={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();s[g.id]||(s[g.id]=g.serialize())}return s}_serializeLayers(s){const u=[];for(const g of s){const x=this._layers[g];x&&x.type!=="custom"&&u.push(x.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const u=this.getOwnLayer(s);if(u)return u;this.fire(new i.z(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const u=this.getOwnSource(s);if(u)return u;this.fire(new i.z(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,u){const g=this.map.painter;if(g)for(let x=s.minzoom||0;x<(s.maxzoom||25.5);x++){const S=s.getProgramIds();if(S)for(const A of S){const L=s.getDefaultProgramParams(A,u.zoom,this._styleColorTheme.lut);L&&(g.style=this,this.fog&&(g._fogVisible=!0,L.overrideFog=!0,g.getOrCreateProgram(A,L)),g._fogVisible=!1,L.overrideFog=!1,g.getOrCreateProgram(A,L),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(L.overrideRtt=!0,g.getOrCreateProgram(A,L)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const u=this.calculateLightsBrightness();s.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u));const g=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const L in A){const{updatedIds:z,removedIds:U}=A[L];(z||U)&&(this._updateWorkerLayers(L,z,U),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const S={};for(const A in this._mergedSourceCaches){const L=this._mergedSourceCaches[A];S[A]=L.used,L.used=!1,L.tileCoverLift=0}for(const A of this._mergedOrder){const L=this._mergedLayers[A];if(L.recalculate(s,this._availableImages),!L.isHidden(s.zoom)){const z=this.getLayerSourceCache(L);z&&(z.used=!0,z.tileCoverLift=Math.max(z.tileCoverLift,L.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(L,s)}):this.precompilePrograms(L,s))}for(const A in this._mergedSourceCaches){const L=this._mergedSourceCaches[A];if(!L)continue;const z=L._source;z.type==="raster-array"&&z.iconsets&&(L.used=!0)}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();for(const A in S){const L=this._mergedSourceCaches[A];S[A]!==L.used&&L.getSource().fire(new i.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new i.A("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=this._changes.getUpdatedImages();if(s.length){for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s);this._changes.resetUpdatedImages()}}_updateWorkerLayers(s,u,g){const x=this.getFragmentStyle(s);x&&this.dispatcher.broadcast("updateLayers",{layers:u?x._serializeLayers(u):[],scope:s,removedIds:g||[],options:x.options})}setState(s,u){if(this._checkLoaded(),rh(this,cn(s)))return!1;(s=i.cq(s)).layers=Vm(s.layers);const g=function(A,L){if(!A)return[{command:vn.setStyle,args:[L]}];let z=[];try{if(!i.bn(A.version,L.version))return[{command:vn.setStyle,args:[L]}];if(i.bn(A.center,L.center)||z.push({command:vn.setCenter,args:[L.center]}),i.bn(A.zoom,L.zoom)||z.push({command:vn.setZoom,args:[L.zoom]}),i.bn(A.bearing,L.bearing)||z.push({command:vn.setBearing,args:[L.bearing]}),i.bn(A.pitch,L.pitch)||z.push({command:vn.setPitch,args:[L.pitch]}),i.bn(A.sprite,L.sprite)||z.push({command:vn.setSprite,args:[L.sprite]}),i.bn(A.glyphs,L.glyphs)||z.push({command:vn.setGlyphs,args:[L.glyphs]}),i.bn(A.imports,L.imports)||function(re=[],ce=[],se){ce=ce||[];const pe=(re=re||[]).map(pn),me=ce.map(pn),be=re.reduce(da,{}),Ee=ce.reduce(da,{}),Te=pe.slice();let Re,Pe,Ie,Oe;for(Re=0,Pe=0;Re<pe.length;Re++)Ie=pe[Re],Ee.hasOwnProperty(Ie)?Pe++:(se.push({command:vn.removeImport,args:[Ie]}),Te.splice(Te.indexOf(Ie,Pe),1));for(Re=0,Pe=0;Re<me.length;Re++)Ie=me[me.length-1-Re],Te[Te.length-1-Re]!==Ie&&(be.hasOwnProperty(Ie)?(se.push({command:vn.removeImport,args:[Ie]}),Te.splice(Te.lastIndexOf(Ie,Te.length-Pe),1)):Pe++,Oe=Te[Te.length-Re],se.push({command:vn.addImport,args:[Ee[Ie],Oe]}),Te.splice(Te.length-Re,0,Ie));for(const ze of ce){const Ve=be[ze.id];Ve&&!i.bn(Ve,ze)&&se.push({command:vn.updateImport,args:[ze.id,ze]})}}(A.imports,L.imports,z),i.bn(A.transition,L.transition)||z.push({command:vn.setTransition,args:[L.transition]}),i.bn(A.light,L.light)||z.push({command:vn.setLight,args:[L.light]}),i.bn(A.fog,L.fog)||z.push({command:vn.setFog,args:[L.fog]}),i.bn(A.snow,L.snow)||z.push({command:vn.setSnow,args:[L.snow]}),i.bn(A.rain,L.rain)||z.push({command:vn.setRain,args:[L.rain]}),i.bn(A.projection,L.projection)||z.push({command:vn.setProjection,args:[L.projection]}),i.bn(A.lights,L.lights)||z.push({command:vn.setLights,args:[L.lights]}),i.bn(A.camera,L.camera)||z.push({command:vn.setCamera,args:[L.camera]}),!i.bn(A["color-theme"],L["color-theme"]))return[{command:vn.setStyle,args:[L]}];const U={},V=[];(function(re,ce,se,pe){let me;for(me in ce=ce||{},re=re||{})re.hasOwnProperty(me)&&(ce.hasOwnProperty(me)||lv(me,se,pe));for(me in ce){if(!ce.hasOwnProperty(me))continue;const be=ce[me];re.hasOwnProperty(me)?i.bn(re[me],be)||(re[me].type==="geojson"&&be.type==="geojson"&&cr(re,ce,me)?se.push({command:vn.setGeoJSONSourceData,args:[me,be.data]}):xf(me,ce,se,pe)):Ys(me,ce,se)}})(A.sources,L.sources,V,U);const X=[];A.layers&&A.layers.forEach(re=>{re.source&&U[re.source]?z.push({command:vn.removeLayer,args:[re.id]}):X.push(re)});let Y=A.terrain;Y&&U[Y.source]&&(z.push({command:vn.setTerrain,args:[void 0]}),Y=void 0),z=z.concat(V),i.bn(Y,L.terrain)||z.push({command:vn.setTerrain,args:[L.terrain]}),function(re,ce,se){ce=ce||[];const pe=(re=re||[]).map(pn),me=ce.map(pn),be=re.reduce(da,{}),Ee=ce.reduce(da,{}),Te=pe.slice(),Re=Object.create(null);let Pe,Ie,Oe,ze,Ve,dt,rt;for(Pe=0,Ie=0;Pe<pe.length;Pe++)Oe=pe[Pe],Ee.hasOwnProperty(Oe)?Ie++:(se.push({command:vn.removeLayer,args:[Oe]}),Te.splice(Te.indexOf(Oe,Ie),1));for(Pe=0,Ie=0;Pe<me.length;Pe++)Oe=me[me.length-1-Pe],Te[Te.length-1-Pe]!==Oe&&(be.hasOwnProperty(Oe)?(se.push({command:vn.removeLayer,args:[Oe]}),Te.splice(Te.lastIndexOf(Oe,Te.length-Ie),1)):Ie++,dt=Te[Te.length-Pe],se.push({command:vn.addLayer,args:[Ee[Oe],dt]}),Te.splice(Te.length-Pe,0,Oe),Re[Oe]=!0);for(Pe=0;Pe<me.length;Pe++)if(Oe=me[Pe],ze=be[Oe],Ve=Ee[Oe],!Re[Oe]&&!i.bn(ze,Ve))if(i.bn(ze.source,Ve.source)&&i.bn(ze["source-layer"],Ve["source-layer"])&&i.bn(ze.type,Ve.type)){for(rt in Cn(ze.layout,Ve.layout,se,Oe,null,vn.setLayoutProperty),Cn(ze.paint,Ve.paint,se,Oe,null,vn.setPaintProperty),i.bn(ze.slot,Ve.slot)||se.push({command:vn.setSlot,args:[Oe,Ve.slot]}),i.bn(ze.filter,Ve.filter)||se.push({command:vn.setFilter,args:[Oe,Ve.filter]}),i.bn(ze.minzoom,Ve.minzoom)&&i.bn(ze.maxzoom,Ve.maxzoom)||se.push({command:vn.setLayerZoomRange,args:[Oe,Ve.minzoom,Ve.maxzoom]}),ze)ze.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?Cn(ze[rt],Ve[rt],se,Oe,rt.slice(6),vn.setPaintProperty):i.bn(ze[rt],Ve[rt])||se.push({command:vn.setLayerProperty,args:[Oe,rt,Ve[rt]]}));for(rt in Ve)Ve.hasOwnProperty(rt)&&!ze.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?Cn(ze[rt],Ve[rt],se,Oe,rt.slice(6),vn.setPaintProperty):i.bn(ze[rt],Ve[rt])||se.push({command:vn.setLayerProperty,args:[Oe,rt,Ve[rt]]}))}else se.push({command:vn.removeLayer,args:[Oe]}),dt=Te[Te.lastIndexOf(Oe)+1],se.push({command:vn.addLayer,args:[Ve,dt]})}(X,L.layers,z)}catch(U){console.warn("Unable to compute style diff:",U),z=[{command:vn.setStyle,args:[L]}]}return z}(this.serialize(),s).filter(A=>!(A.command in fD));if(g.length===0)return!1;const x=g.filter(A=>!(A.command in hD));if(x.length>0)throw new Error(`Unimplemented: ${x.map(A=>A.command).join(", ")}.`);const S=[];return g.forEach(A=>{S.push(this[A.command].apply(this,A.args))}),u&&Promise.all(S).then(u),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}addImages(s){for(const[u,g]of s.entries()){if(this.getImage(u)&&!u.iconsetId)return this.fire(new i.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,g),this._changes.updateImage(u)}return this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this}addImage(s,u){return this.getImage(s)&&!s.iconsetId?this.fire(new i.z(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,u),this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this)}updateImage(s,u,g=!1){this.imageManager.updateImage(s,this.scope,u),g&&(this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(s,u,g={}){return this._checkLoaded(),this._validate(Ne,`models.${s}`,u,null,g)||(this.modelManager.addModel(s,u,this.scope),this._changes.setDirty()),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this):this.fire(new i.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,u,g={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(fn,`sources.${s}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=av(s,u,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const S=A=>{const L=(A?"symbol:":"other:")+x.id,z=i.C(L,this.scope),U=this._sourceCaches[L]=new Xs(z,x,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=U,U.onAdd(this.map)};S(!1),u.type!=="vector"&&u.type!=="geojson"||S(!0),x.onAdd&&x.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const u=this.getOwnSource(s);if(!u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const g=this.getOwnSourceCaches(s);for(const x of g){const S=i.cr(x.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,u){this._checkLoaded(),this.getOwnSource(s).setData(u),this._changes.setDirty()}getOwnSource(s){const u=this.getOwnSourceCache(s);return u&&u.getSource()}getOwnSources(){const s=[];for(const u in this._otherSourceCaches){const g=this.getOwnSourceCache(u);g&&s.push(g.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const u in s){const g=s[u]._tiles;for(const x in g){const S=g[x];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const x of s){if(this._validate(Xi,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(x),S.updateTransitions(u)}else this.ambientLight=new ji(x,en||(en=new i.a7({color:new i.a8(i.a5.properties_light_ambient.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(x),S.updateTransitions(u)}else this.directionalLight=new ji(x,Pn||(Pn=new i.a7({direction:new i.am(i.a5.properties_light_directional.direction),color:new i.a8(i.a5.properties_light_directional.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_directional.intensity),"cast-shadows":new i.a8(i.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a8(i.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a8(i.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=new i.aa(this.z||0,u);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,u=this.ambientLight;if(!s||!u)return;const g=Y=>.2126*(Y[0]<=.03928?Y[0]/12.92:Math.pow((Y[0]+.055)/1.055,2.4))+.7152*(Y[1]<=.03928?Y[1]/12.92:Math.pow((Y[1]+.055)/1.055,2.4))+.0722*(Y[2]<=.03928?Y[2]/12.92:Math.pow((Y[2]+.055)/1.055,2.4)),x=s.properties.get("color").toRenderColor(null).toArray01(),S=s.properties.get("intensity"),A=s.properties.get("direction"),L=1-i.cc(A.x,A.y,A.z)[2]/90,z=g(x)*S*L,U=u.properties.get("color").toRenderColor(null).toArray01(),V=u.properties.get("intensity"),X=g(U)*V;return Number(((z+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(!s)return this;if(i.cs(s)){const u=i.ct(s),g=this.fragments.find(({id:S})=>S===u);if(!g)throw new Error(`Style import '${s}' not found`);const x=i.cr(s);return g.style.getFragmentStyle(x)}{const u=this.fragments.find(({id:g})=>g===s);return u?u.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const u={},g=(x,S="")=>`${x}::${S}`;this._featuresetSelectors={};for(const x in s){const S=this._featuresetSelectors[x]=[];for(const A of s[x].selectors){if(A.featureNamespace){const z=this.getOwnLayer(A.layer);if(!z){i.w(`Layer is undefined for selector: ${A.layer}`);continue}const U=g(z.source,z.sourceLayer);if(U in u&&u[U]!==A.featureNamespace){i.w(`"featureNamespace ${A.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}u[U]=A.featureNamespace}let L;if(A.properties)for(const z in A.properties){const U=i.X(A.properties[z]);U.result==="success"&&(L=L||{},L[z]=U.value)}S.push({layerId:A.layer,namespace:A.featureNamespace,properties:L,uniqueFeatureID:A._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const u=this.getFragmentStyle(s);if(!u||!u.stylesheet.featuresets)return[];const g=[];for(const x in u.stylesheet.featuresets)g.push({featuresetId:x,importId:u.scope?u.scope:void 0});return g}getFeaturesetLayers(s,u){const g=this.getFragmentStyle(u),x=g.stylesheet.featuresets;if(!x||!x[s])return this.fire(new i.z(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const S=[];for(const A of x[s].selectors){const L=g.getOwnLayer(A.layer);L&&S.push(L)}return S}getConfigProperty(s,u){const g=this.getFragmentStyle(s);if(!g)return null;const x=i.C(u,g.scope),S=g.options.get(x),A=S?S.value||S.default:null;return A?A.serialize():null}setConfigProperty(s,u,g){const x=this.getFragmentStyle(s);if(!x)return;const S=x.stylesheet.indoor?m2(x.stylesheet.schema):x.stylesheet.schema;if(!S||!S[u])return;const A=i.X(g);if(A.result!=="success")return void rh(this,A.value);const L=A.value.expression,z=i.C(u,x.scope),U=x.options.get(z);if(!U)return;let V;const{minValue:X,maxValue:Y,stepValue:re,type:ce,values:se}=S[u],pe=i.X(S[u].default);pe.result==="success"&&(V=pe.value.expression),V?(this.options.set(z,Object.assign({},U,{value:L,default:V,minValue:X,maxValue:Y,stepValue:re,type:ce,values:se})),this.updateConfigDependencies(u)):this.fire(new i.z(new Error(`No schema defined for the config option "${u}" in the "${s}" fragment.`)))}getConfig(s){const u=this.getFragmentStyle(s);if(!u)return null;const g=u.stylesheet.schema;if(!g)return null;const x={};for(const S in g){const A=i.C(S,u.scope),L=u.options.get(A),z=L?L.value||L.default:null;x[S]=z?z.serialize():null}return x}setConfig(s,u){const g=this.getFragmentStyle(s);g&&(g.updateConfig(u,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const u=this.getFragmentStyle(s);return u?u.stylesheet.schema:null}setSchema(s,u){const g=this.getFragmentStyle(s);g&&(g.stylesheet.schema=u,g.updateConfig(g._config,u),this.updateConfigDependencies())}updateConfig(s,u){if(this._config=s,s||u)if(u)for(const g in u){let x,S;const A=i.X(u[g].default);if(A.result==="success"&&(x=A.value.expression),s&&s[g]!==void 0){const Y=i.X(s[g]);Y.result==="success"&&(S=Y.value.expression)}const{minValue:L,maxValue:z,stepValue:U,type:V,values:X}=u[g];if(x){const Y=i.C(g,this.scope);this.options.set(Y,{default:x,value:S,minValue:L,maxValue:z,stepValue:U,type:V,values:X})}else this.fire(new i.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new i.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const u of this._configDependentLayers){const g=this.getLayer(u);if(g){if(s&&!g.configDependencies.has(s))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const g=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(g){const x=u._evaluateColorThemeData(g);(!u._styleColorTheme.lut&&x!==""||u._styleColorTheme.lut&&x!==u._styleColorTheme.lut.data)&&u.setColorTheme(g)}}),this._changes.setDirty()}addLayer(s,u,g={}){this._checkLoaded();const x=s.id;if(this._layers[x])return void this.fire(new i.z(new Error(`Layer with id "${x}" already exists on this map`)));let S;if(s.type==="custom"){if(rh(this,i.cu(s)))return;S=i.cv(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(x,s.source),s=i.cq(s),s=i.l(s,{source:x})),this._validate(fe,`layers.${x}`,s,{arrayIndex:-1},g))return;S=i.cv(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}})}S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid);let A=this._order.length;if(u){const V=this._order.indexOf(u);if(V===-1)return void this.fire(new i.z(new Error(`Layer with id "${u}" does not exist on this map.`)));S.slot===this._layers[u].slot?A=V:i.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=S;const L=this.getOwnLayerSourceCache(S),z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();L&&S.canCastShadows()&&z&&(L.castsShadows=!0);const U=this._changes.getRemovedLayer(S);if(U&&S.source&&L&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const V=i.C(S.source,S.scope);U.type!==S.type?this._changes.updateSourceCache(V,"clear"):(this._changes.updateSourceCache(V,"reload"),L.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(s,u){this._checkLoaded();const g=this._checkLayer(s);if(!g||s===u)return;const x=this._order.indexOf(s);this._order.splice(x,1);let S=this._order.length;if(u){const A=this._order.indexOf(u);if(A===-1)return void this.fire(new i.z(new Error(`Layer with id "${u}" does not exist on this map.`)));g.slot===this._layers[u].slot?S=A:i.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const u=this._checkLayer(s);if(!u)return;u.setEventedParent(null);const g=this._order.indexOf(s);this._order.splice(g,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const x=this.getOwnLayerSourceCache(u);if(x&&x.castsShadows){let S=!1;for(const A in this._layers)if(this._layers[A].source===u.source&&this._layers[A].canCastShadows()){S=!0;break}x.castsShadows=S}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const u in this._layers)if(this._layers[u].type===s)return!0;return!1}setLayerZoomRange(s,u,g){this._checkLoaded();const x=this._checkLayer(s);x&&(x.minzoom===u&&x.maxzoom===g||(u!=null&&(x.minzoom=u),g!=null&&(x.maxzoom=g),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,u){this._checkLoaded();const g=this._checkLayer(s);g&&g.slot!==u&&(g.slot=u,this._updateLayer(g))}setFilter(s,u,g={}){this._checkLoaded();const x=this._checkLayer(s);if(x&&!i.bn(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(ye,`layers.${x.id}.filter`,u,{layerType:x.type},g)||(x.filter=i.cq(u),this._updateLayer(x)))}getFilter(s){const u=this._checkLayer(s);if(u)return i.cq(u.filter)}setLayoutProperty(s,u,g,x={}){this._checkLoaded();const S=this._checkLayer(s);if(S&&!i.bn(S.getLayoutProperty(u),g)){if(g!=null&&(!x||x.validate!==!1)&&rh(S,$e.call(cn,{key:`layers.${s}.layout.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:i.a5,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(u,g),S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)}}getLayoutProperty(s,u){const g=this._checkLayer(s);if(g)return g.getLayoutProperty(u)}setPaintProperty(s,u,g,x={}){this._checkLoaded();const S=this._checkLayer(s);if(!S||i.bn(S.getPaintProperty(u),g)||g!=null&&(!x||x.validate!==!1)&&rh(S,Me.call(cn,{key:`layers.${s}.paint.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:i.a5})))return;const A=S.setPaintProperty(u,g);S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),A&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(s,u){const g=this._checkLayer(s);if(g)return g.getPaintProperty(u)}setFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:z,importId:U}=s.target,V=this.getFragmentStyle(U),X=V.getFeaturesetLayers(z);for(const{source:Y,sourceLayer:re}of X)V.setFeatureState({id:s.id,source:Y,sourceLayer:re},u)}else if("layerId"in s.target){const{layerId:z}=s.target,U=this.getLayer(z);this.setFeatureState({id:s.id,source:U.source,sourceLayer:U.sourceLayer},u)}return}const g=s.source,x=s.sourceLayer,S=this._checkSource(g);if(!S)return;const A=S.type;if(A==="geojson"&&x)return void this.fire(new i.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(A==="vector"&&!x)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided.")));const L=this.getOwnSourceCaches(g);for(const z of L)z.setFeatureState(x,s.id,u)}removeFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:z,importId:U}=s.target,V=this.getFragmentStyle(U),X=V.getFeaturesetLayers(z);for(const{source:Y,sourceLayer:re}of X)V.removeFeatureState({id:s.id,source:Y,sourceLayer:re},u)}else if("layerId"in s.target){const{layerId:z}=s.target,U=this.getLayer(z);this.removeFeatureState({id:s.id,source:U.source,sourceLayer:U.sourceLayer},u)}return}const g=s.source,x=this._checkSource(g);if(!x)return;const S=x.type,A=S==="vector"?s.sourceLayer:void 0;if(S==="vector"&&!A)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new i.z(new Error("A feature id is required to remove its specific state property.")));const L=this.getOwnSourceCaches(g);for(const z of L)z.removeFeatureState(A,s.id,u)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let S;if("featuresetId"in s.target){const{featuresetId:A,importId:L}=s.target,z=this.getFragmentStyle(L),U=z.getFeaturesetLayers(A);for(const{source:V,sourceLayer:X}of U){const Y=z.getFeatureState({id:s.id,source:V,sourceLayer:X});if(Y&&!S)S=Y;else if(!i.bn(S,Y))return void this.fire(new i.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:A}=s.target,L=this.getLayer(A);S=this.getFeatureState({id:s.id,source:L.source,sourceLayer:L.sourceLayer})}return S}const u=s.source,g=s.sourceLayer,x=this._checkSource(u);if(x){if(x.type!=="vector"||g)return s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(g,s.id);this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=i.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),u=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return i.cw({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(s){for(const u of Object.values(this._mergedLayers))s(u)&&this._updateLayer(u)}_updateLayer(s){this._changes.updateLayer(s);const u=this.getLayerSourceCache(s),g=i.C(s.source,s.scope),x=this._changes.getUpdatedSourceCaches();s.source&&!x[g]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),u.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const u=L=>this._mergedLayers[L].is3D(!!this.terrain),g=this.order,x={},S=[];for(let L=g.length-1;L>=0;L--){const z=g[L];if(u(z)){x[z]=L;for(const U of s){const V=U[z];if(V)for(const X of V)S.push(X)}}}S.sort((L,z)=>z.intersectionZ-L.intersectionZ);const A=[];for(let L=g.length-1;L>=0;L--){const z=g[L];if(u(z))for(let U=S.length-1;U>=0;U--){const V=S[U].feature;if(V.layer&&x[V.layer.id]<L)break;A.push(V),S.pop()}else for(const U of s){const V=U[z];if(V)for(const X of V)A.push(X.feature)}}return A}queryRenderedFeatures(s,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(ye,"queryRenderedFeatures.filter",u.filter,null,u),x=i.a_(u.filter));const S={},A=V=>{if(gv.has(V.type))return;const X=this.getOwnLayerSourceCache(V),Y=S[X.id]=S[X.id]||{sourceCache:X,layers:{},has3DLayers:!1};V.is3D(!!this.terrain)&&(Y.has3DLayers=!0),Y.layers[V.fqid]=Y.layers[V.fqid]||{styleLayer:V,targets:[]},Y.layers[V.fqid].targets.push({filter:x})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new i.z(new Error("parameters.layers must be an Array."))),[];for(const V of u.layers){const X=this._layers[V];if(!X)return this.fire(new i.z(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];A(X)}}else for(const V in this._layers)A(this._layers[V]);const L=this._queryRenderedFeatures(s,S,g),z=this._flattenAndSortRenderedFeatures(L),U=[];for(const V of z)i.ct(V.layer.id)===this.scope&&U.push(V);return U}queryRenderedFeatureset(s,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(ye,"queryRenderedFeatures.filter",u.filter,null,u),x=i.a_(u.filter));const S="mock",A=[];if(u&&u.target)A.push(Object.assign({},u,{targetId:S,filter:x}));else{const V=this.getFeaturesetDescriptors();for(const X of V)A.push({targetId:S,filter:x,target:X});for(const{style:X}of this.fragments){const Y=X.getFeaturesetDescriptors();for(const re of Y)A.push({targetId:S,filter:x,target:re})}}const L=this.queryRenderedTargets(s,A,g),z=[],U=new Set;for(const V of L)for(const X of V.variants[S])yf(X,V,U)||z.push(new i.cx(V,X));return z}queryRenderedTargets(s,u,g){const x={},S=(L,z,U,V)=>{const X=x[z.id]=x[z.id]||{sourceCache:z,layers:{},has3DLayers:!1};if(X.layers[L.fqid]=X.layers[L.fqid]||{styleLayer:L,targets:[]},L.is3D(!!this.terrain)&&(X.has3DLayers=!0),!V)return U.uniqueFeatureID=!1,void X.layers[L.fqid].targets.push(U);X.layers[L.fqid].targets.push(Object.assign({},U,{namespace:V.namespace,properties:V.properties,uniqueFeatureID:V.uniqueFeatureID}))};for(const L of u)if("featuresetId"in L.target){const{featuresetId:z,importId:U}=L.target,V=this.getFragmentStyle(U);if(!V||!V._featuresetSelectors)continue;const X=V._featuresetSelectors[z];if(!X){this.fire(new i.z(new Error(`The featureset '${z}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Y of X){const re=V.getOwnLayer(Y.layerId);re&&!gv.has(re.type)&&S(re,V.getOwnLayerSourceCache(re),L,Y)}}else if("layerId"in L.target){const{layerId:z}=L.target,U=this.getLayer(z);if(!U||gv.has(U.type))continue;S(U,this.getLayerSourceCache(U),L)}const A=this._queryRenderedFeatures(s,x,g);return this._flattenAndSortRenderedFeatures(A)}_queryRenderedFeatures(s,u,g){const x=[],S=!!this.map._showQueryGeometry,A=Do.createFromScreenPoints(s,g);for(const L in u){const z=_b(A,u[L],this._availableImages,g,S);Object.keys(z).length&&x.push(z)}if(this.placement)for(const L in u){if(!u[L].sourceCache._onlySymbols)continue;const z=s2(A.screenGeometry,u[L],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(z).length&&x.push(z)}return x}querySourceFeatures(s,u){const g=u&&u.filter;g&&this._validate(ye,"querySourceFeatures.filter",g,null,u);let x=[];const S=this.getOwnSourceCaches(s);for(const A of S)x=x.concat(l2(A,u));return x}addSourceType(s,u,g){return Rl.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Rl.setSourceType(s,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:u.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,u,g={}){this._checkLoaded();const x=this.light.getLight();let S=!1;for(const L in s)if(!i.bn(s[L],x[L])){S=!0;break}if(!S)return;const A=this._getTransitionParameters();this.light.setLight(s,u,g),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,u=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=s;const x=s.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const L="terrain-dem-src";this.addSource(L,g.source),g=i.cq(g),g=i.l(g,{source:L})}const S=i.l({},g),A={};if(this.terrain&&x){S.source=this.terrain.get().source;const L=this.terrain?this.getFragmentStyle(this.terrain.scope):null;L&&(A.style=L.serialize())}if(this._validate(Jo,"terrain",S,A))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u),this.fire(new i.A("data",{dataType:"style"}))}else{const S=this.terrain,A=S.get();for(const L of Object.keys(i.a5.terrain))!g.hasOwnProperty(L)&&i.a5.terrain[L].default&&(g[L]=i.a5.terrain[L].default);for(const L in s)if(!i.bn(s[L],A[L])){S.set(s,this.options),this.stylesheet.terrain=s;const z=this._getTransitionParameters({duration:0});S.updateTransitions(z),this.fire(new i.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const u=this.fog=new qr(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createSnow(s){const u=this.snow=new In(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createRain(s){const u=this.rain=new Rn(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void s();const g=this._evaluateColorThemeData(u);this._loadColorTheme(g).then(()=>{this.fire(new i.A("colorthemeset")),s()}).catch(x=>{i.w(`Couldn't set color theme: ${x}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,u){const g=this.getFragmentStyle(s);g&&(g._styleColorTheme.colorThemeOverride=u,g._reloadColorTheme())}_getTransitionParameters(s){return{now:i.q.now(),transition:i.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],u=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?s.push(g):u.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...u)}_createTerrain(s,u){const g=this.terrain=new _t(s,u,this.scope,this.options);u===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="symbol"&&this._updateLayer(u)}}_validate(s,u,g,x,S={}){if(S&&S.validate===!1)return!1;const A=i.l({},this.serialize());return rh(this,s.call(cn,i.l({key:u,style:A,value:g,styleSpec:i.a5},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cy.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(s){const u=this.getSourceCaches(s);for(const g of u)g.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const u=this.getSourceCaches(s);for(const g of u)g.resume(),g.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let u;this.directionalLight&&(u=Ju(this.directionalLight));for(const g in this._mergedSourceCaches)this._mergedSourceCaches[g].update(s,void 0,void 0,u)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const u=this._sourceCaches[s];u.resume(),u.reload()}}_updatePlacement(s,u,g,x,S,A,L=!1){let z=!1,U=!1;const V={},X={};for(const Y of this._mergedOrder){const re=this._mergedLayers[Y];if(re.type!=="symbol")continue;const ce=i.C(re.source,re.scope);let se=V[ce];if(!se){const me=this.getLayerSourceCache(re);if(!me)continue;const be=me.getRenderableIds(!0).map(Ee=>me.getTileByID(Ee));X[ce]=be.slice(),se=V[ce]=be.sort((Ee,Te)=>Te.tileID.overscaledZ-Ee.tileID.overscaledZ||(Ee.tileID.isLessThan(Te.tileID)?-1:1))}const pe=this.crossTileSymbolIndex.addLayer(re,se,u.center.lng,u.projection);z=z||pe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),L=L||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.A("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),u.zoom))&&(this.pauseablePlacement=new Yu(u,this._mergedOrder,L,g,x,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,V,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),U=!0),z&&this.pauseablePlacement.placement.setStale()),U||z){this._buildingIndex.onNewFrame(u.zoom);for(let Y=0;Y<this._mergedOrder.length;Y++){const re=this._mergedLayers[this._mergedOrder[Y]];if(re.type!=="symbol")continue;const ce=this.isLayerClipped(re);this.placement.updateLayerOpacities(re,V[i.C(re.source,re.scope)],Y,ce?A:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,u){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:S})=>S===s.id)!==-1)return void this.fire(new i.z(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!u)return g.push(s),this._loadImports([s],!0);const x=g.findIndex(({id:S})=>S===u);return x===-1&&this.fire(new i.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,x).concat(s).concat(g.slice(x)),this._loadImports([s],!0,u)}updateImport(s,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(s);return x===-1?this:typeof u=="string"?(this.setImportUrl(s,u),this):(u.url&&u.url!==g[x].url&&this.setImportUrl(s,u.url),i.bn(u.config,g[x].config)||this.setImportConfig(s,u.config,u.data.schema),i.bn(u.data,g[x].data)||this.setImportData(s,u.data),this)}moveImport(s,u){this._checkLoaded();let g=this.stylesheet.imports||[];const x=this.getImportIndex(s);if(x===-1)return this;const S=this.getImportIndex(u);if(S===-1)return this;const A=g[x],L=this.fragments[x];return g=g.filter(({id:z})=>z!==s),this.fragments=this.fragments.filter(({id:z})=>z!==s),this.stylesheet.imports=g.slice(0,S).concat(A).concat(g.slice(S)),this.fragments=this.fragments.slice(0,S).concat(L).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(s,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(s);if(x===-1)return this;g[x].url=u;const S=this.fragments[x];return S.style=this._createFragmentStyle(g[x]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(u),this}setImportData(s,u){this._checkLoaded();const g=this.getImportIndex(s),x=this.stylesheet.imports||[];return g===-1?this:u?(this.fragments[g].style.setState(u),this._reloadImports(),this):(delete x[g].data,this.setImportUrl(s,x[g].url))}setImportConfig(s,u,g){this._checkLoaded();const x=this.getImportIndex(s),S=this.stylesheet.imports||[];if(x===-1)return this;u?S[x].config=u:delete S[x].config;const A=this.fragments[x];g&&A.style.stylesheet&&(A.style.stylesheet.schema=g);const L=A.style.stylesheet&&A.style.stylesheet.schema;return A.config=u,A.style.updateConfig(u,L),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const u=this.stylesheet.imports||[],g=this.getImportIndex(s);g!==-1&&(u.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(s){const u=(this.stylesheet.imports||[]).findIndex(g=>g.id===s);return u===-1&&this.fire(new i.z(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),u}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const u in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[u];g&&s.push(g.getSource())}return s}getSource(s,u){const g=this.getSourceCache(s,u);return g&&g.getSource()}getLayerSource(s){const u=this.getLayerSourceCache(s);return u&&u.getSource()}getSourceCache(s,u){const g=i.C(s,u);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(s){const u=i.C(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[s]&&u.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&u.push(this._mergedSymbolSourceCaches[s]),u}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const u in s){const g=s[u];g==="reload"?this.reloadSource(u):g==="clear"&&this.clearSource(u)}}updateLayers(s){const u=this._changes.getUpdatedPaintProperties();for(const g of u){const x=this.getLayer(g);x&&x.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s,this.scope)}getImages(s,u,g){this.imageManager.getImages(u.images,u.scope,g),this._updateTilesForChangedImages();const x=A=>{if(A){const L=u.images.map(z=>i.I.toString(z));A.setDependencies(u.tileID.key,u.type,L)}},S=i.C(u.source,u.scope);x(this._mergedOtherSourceCaches[S]),x(this._mergedSymbolSourceCaches[S])}rasterizeImages(s,u,g){this.imageManager.rasterizeImages(u,g)}getGlyphs(s,u,g){this.glyphManager.getGlyphs(u.stacks,u.scope,g)}getResource(s,u,g){return i.cz(u,g)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const u=[];return this._otherSourceCaches[s]&&u.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&u.push(this._symbolSourceCaches[s]),u}_isSourceCacheLoaded(s){const u=this.getOwnSourceCaches(s);return u.length===0?(this.fire(new i.z(new Error(`There is no source with ID '${s}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,u){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;const g=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D(!!this.terrain)){if(g||u&&u.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Rl.getSourceType=function(y){return vb[y]},Rl.setSourceType=function(y,s){vb[y]=s},Rl.registerForPluginStateChange=i.ci;var Ib=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,yv=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Jm=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,vv="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Qu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,_v=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ob=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,nh=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Of=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Qm=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,eg=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Yc=[];uc(Ib,Yc),uc(Jm,Yc),uc(yv,Yc);const ih={"_prelude_fog.vertex.glsl":_v,"_prelude_terrain.vertex.glsl":Qu,"_prelude_shadow.vertex.glsl":Qm,"_prelude_fog.fragment.glsl":Ob,"_prelude_shadow.fragment.glsl":eg,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":nh,"_prelude_raster_particle.glsl":Of},kf={};an("",Qu),an(Ob,_v),an(eg,Qm),an(nh,""),an(Of,"");const kb=an(yv,Jm),xv=Ib;var tg={background:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:an("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:an(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:an(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:an("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:an("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:an("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:an(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:an(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:an(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:an(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:an(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:an(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),0.001);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:an("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:an("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:an(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:an(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:an("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:an(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,vv),skyboxGradient:an(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,vv),skyboxCapture:an(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:an(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:an(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:an(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:an(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:an("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:an("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:an("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:an("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function uc(y,s){const u=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const S of x)s.includes(S)||s.push(S)}}function an(y,s){const u=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(U=>{const V=U.split(" ");return V[V.length-1]}),x=[...new Set(x)]);const S={},A=[],L=[];if(y=y.replace(u,(U,V)=>(L.push(V),"")),(s=s.replace(u,(U,V)=>(A.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let z=[...Yc];uc(y,z),uc(s,z);for(const U of[...A,...L])ih[U]||console.error(`Undefined include: ${U}`),kf[U]||(kf[U]=[],uc(ih[U],kf[U])),z=[...z,...kf[U]];return{fragmentSource:y=y.replace(g,(U,V,X,Y,re)=>(S[re]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${re}
in ${X} ${Y} ${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="initialize"?`
#ifdef HAS_UNIFORM_u_${re}
    ${X} ${Y} ${re} = u_${re};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${X} ${Y} ${re};
#endif
`:V==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(g,(U,V,X,Y,re)=>{const ce=Y==="float"?"vec2":Y,se=re.match(/color/)?"color":ce;return V==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${re}
in ${X} ${Y} a_${re};
#endif
`:S[re]?V==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${X} ${ce} a_${re};
out ${X} ${Y} ${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="initialize"?se==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = a_${re};
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = unpack_mix_${se}(a_${re}, u_${re}_t);
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${X} ${Y} a_${re};
    out ${X} ${Y} ${re};
#endif
`:V==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${re} = a_${re};
#endif
`:void 0:V==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${X} ${ce} a_${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="define-instanced"?se==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${re}0;
in vec4 a_${re}1;
in vec4 a_${re}2;
in vec4 a_${re}3;
#else
uniform ${X} ${Y} u_${re};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${ce} a_${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${X} ${Y} ${re} = a_${re};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${X} ${Y} ${re} = a_${re};
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${X} ${Y} ${re} = unpack_mix_${se}(a_${re}, u_${re}_t);
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`}),staticAttributes:x,usedDefines:z,vertexIncludes:A,fragmentIncludes:L}}class _2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,u,g,x,S,A,L,z){this.context=s;let U=this.boundPaintVertexBuffers.length!==x.length;for(let X=0;!U&&X<x.length;X++)this.boundPaintVertexBuffers[X]!==x[X]&&(U=!0);let V=this.boundDynamicVertexBuffers.length!==L.length;for(let X=0;!V&&X<L.length;X++)this.boundDynamicVertexBuffers[X]!==L[X]&&(V=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||U||V||this.boundIndexBuffer!==S||this.boundVertexOffset!==A)this.freshBind(u,g,x,S,A,L,z);else{s.bindVertexArrayOES.set(this.vao);for(const X of L)X&&(X.bind(),z&&X.instanceCount&&X.setVertexAttribDivisor(s.gl,u,z));S&&S.dynamicDraw&&S.bind()}}freshBind(s,u,g,x,S,A,L){const z=s.numAttributes,U=this.context,V=U.gl;this.vao&&this.destroy(),this.vao=U.gl.createVertexArray(),U.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=A,u.enableAttributes(V,s),u.bind(),u.setVertexAttribPointers(V,s,S);for(const X of g)X.enableAttributes(V,s),X.bind(),X.setVertexAttribPointers(V,s,S);for(const X of A)X&&(X.enableAttributes(V,s),X.bind(),X.setVertexAttribPointers(V,s,S),L&&X.instanceCount&&X.setVertexAttribDivisor(V,s,L));x&&x.bind(),U.currentNumAttributes=z}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function x2(y,s){const u=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new i.ac(0,g/u).toLngLat().lat,new i.ac(0,(g+1)/u).toLngLat().lat]}function Rf(y,s,u,g,x,S,A){const L=y.context,z=L.gl,U=u.hillshadeFBO;if(!U)return;y.prepareDrawTile();const V=y.isTileAffectedByFog(s),X=y.getOrCreateProgram("hillshade",{overrideFog:V});L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get());const Y=((pe,me,be,Ee)=>{const Te=be.paint.get("hillshade-shadow-color"),Re=be.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Pe=be.paint.get("hillshade-highlight-color"),Ie=be.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Oe=be.paint.get("hillshade-accent-color"),ze=be.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ve=be.paint.get("hillshade-emissive-strength");let dt=i.ak(be.paint.get("hillshade-illumination-direction"));if(be.paint.get("hillshade-illumination-anchor")==="viewport")dt-=pe.transform.angle;else if(pe.style&&pe.style.enable3dLights()&&pe.style.directionalLight){const St=pe.style.directionalLight.properties.get("direction"),Tt=i.cc(St.x,St.y,St.z);dt=i.ak(Tt[1])}const rt=!pe.options.moving;return{u_matrix:Ee||pe.transform.calculateProjMatrix(me.tileID.toUnwrapped(),rt),u_image:0,u_latrange:x2(0,me.tileID),u_light:[be.paint.get("hillshade-exaggeration"),dt],u_shadow:Te.toRenderColor(Re?null:be.lut),u_highlight:Pe.toRenderColor(Ie?null:be.lut),u_emissive_strength:Ve,u_accent:Oe.toRenderColor(ze?null:be.lut)}})(y,u,g,y.terrain?s.projMatrix:null);y.uploadCommonUniforms(L,X,s.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:ce,tileBoundsSegments:se}=y.getTileBoundsBuffers(u);X.draw(y,z.TRIANGLES,x,S,A,Or.disabled,Y,g.id,re,ce,se)}function Rb(y,s,u){if(!s.needsDEMTextureUpload)return;const g=y.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||y.getTileTexture(u.stride);const S=u.getPixels();s.demTexture?s.demTexture.update(S,{premultiply:!1}):s.demTexture=new i.T(g,S,x.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function pD(y,s,u){const g=y.context,x=g.gl;if(!s.dem)return;const S=s.dem;if(g.activeTexture.set(x.TEXTURE1),Rb(y,s,S),!s.demTexture)return;s.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const A=S.dim;g.activeTexture.set(x.TEXTURE0);let L=s.hillshadeFBO;if(!L){const Y=new i.T(g,{width:A,height:A,data:null},x.RGBA8);Y.bind(x.LINEAR,x.CLAMP_TO_EDGE),L=s.hillshadeFBO=g.createFramebuffer(A,A,!0,"renderbuffer"),L.colorAttachment.set(Y.texture)}g.bindFramebuffer.set(L.framebuffer),g.viewport.set([0,0,A,A]);const{tileBoundsBuffer:z,tileBoundsIndexBuffer:U,tileBoundsSegments:V}=y.getMercatorTileBoundsBuffers(),X=[];y.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),y.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(y,x.TRIANGLES,gr.disabled,Lr.disabled,Jr.unblended,Or.disabled,((Y,re)=>{const ce=re.stride,se=i.ad.mat4.create();return i.ad.mat4.ortho(se,0,i.ai,-i.ai,0,0,1),i.ad.mat4.translate(se,se,[0,-i.ai,0]),{u_matrix:se,u_image:1,u_dimension:[ce,ce],u_zoom:Y.overscaledZ}})(s.tileID,S),u.id,z,U,V),s.needsHillshadePrepare=!1}class di{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mD extends di{getDefault(){return i.al.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Db extends di{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Lb extends di{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Nb extends di{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class zb extends di{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class b2 extends di{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class w2 extends di{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class gD extends di{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class rg extends di{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class ng extends di{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class S2 extends di{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class Ss extends di{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class jb extends di{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class bv extends di{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class wv extends di{getDefault(){return i.al.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Fb extends di{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Bb extends di{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class $b extends di{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Sv extends di{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Ub=class extends di{getDefault(){return null}set(y){(y!==this.current||this.dirty)&&(this.gl.useProgram(y),this.current=y,this.dirty=!1)}};class Vb extends di{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Tv extends di{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class T2 extends di{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class E2 extends di{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Df extends di{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class yD extends di{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class vD extends di{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class _D extends di{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class xD extends di{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class bD extends di{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class wD extends di{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class ig extends di{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class Wb extends ig{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Gb extends ig{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Lf extends ig{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class A2 extends Gb{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const C2=(y,s,u)=>({u_matrix:y,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:u}),qb=(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:x,u_merc_center:S,u_image0:0,u_frustum_tl:A,u_frustum_tr:L,u_frustum_br:z,u_frustum_bl:U,u_globe_pos:V,u_globe_radius:X,u_viewport:Y,u_grid_matrix:se?Float32Array.from(se):new Float32Array(9),u_skirt_height:re,u_far_z_cutoff:ce});function Ev(y,s){return y!=null&&s!=null&&!(!y.hasData()||!s.hasData())&&y.demTexture!=null&&s.demTexture!=null&&y.tileID.key!==s.tileID.key}const Ks=new class{constructor(){this.operations={}}newMorphing(y,s,u,g,x){if(y in this.operations){const S=this.operations[y];S.to.tileID.key!==u.tileID.key&&(S.queued=u)}else this.operations[y]={startTime:g,phase:0,duration:x,from:s,to:u,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const s=this.operations[y];return{from:s.from,to:s.to,phase:s.phase}}update(y){for(const s in this.operations){const u=this.operations[s];for(u.phase=(y-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,y)){delete this.operations[s];break}}}_nextOp(y,s){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=s,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Hb={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Kc(y,s,u){if(s===0)return 0;const g=s<1&&u===514?.25/s:1;return 6*Math.pow(1.5,22-y)*Math.max(s,1)*g}function Zb(y,s){const u=1<<y.z;return!s&&(y.x===0||y.x===u-1)||y.y===0||y.y===u-1}const Nf=y=>({u_matrix:y});function Av(y,s,u,g,x){if(x>0){const S=i.q.now(),A=(S-y.timeAdded)/x,L=s?(S-s.timeAdded)/x:-1,z=u.getSource(),U=g.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),V=!s||Math.abs(s.tileID.overscaledZ-U)>Math.abs(y.tileID.overscaledZ-U),X=V&&y.refreshedUponExpiration?1:i.ay(V?A:1-L,0,1);return y.refreshedUponExpiration&&A>=1&&(y.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class M2 extends Xs{constructor(s){const u={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new i.D(i.cj(),null),x=av("mock-dem",u,g,s.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,u){s.state="loaded",u(null)}}class Xb extends Xs{constructor(s){const u=av("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new i.D(i.cj(),null),s.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,u,g){if(s.freezeTileCoverage)return;this.transform=s;const x=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,A)=>{if(S[A.key]="",!this._tiles[A.key]){const L=new Il(A,this._source.tileSize*A.overscaleFactor(),s.tileZoom);L.state="loaded",this._tiles[A.key]=L}return S},{});for(const S in this._tiles)S in x||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(s){const u=this.proxyCachedFBO[s];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Cv extends i.aH{constructor(s,u,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class P2 extends i.cK{constructor(s,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,S]=function(z){const U=new i.b5,V=new i.aV,X=131;U.reserve(17161),V.reserve(33800);const Y=i.ai/128,re=i.ai+Y/2,ce=re+Y;for(let pe=-Y;pe<ce;pe+=Y)for(let me=-Y;me<ce;me+=Y){const be=me<0||me>re||pe<0||pe>re?24575:0,Ee=i.ay(Math.round(me),0,i.ai),Te=i.ay(Math.round(pe),0,i.ai);U.emplaceBack(Ee+be,Te)}const se=(pe,me)=>{const be=me*X+pe;V.emplaceBack(be+1,be,be+X),V.emplaceBack(be+X,be+X+1,be+1)};for(let pe=1;pe<129;pe++)for(let me=1;me<129;me++)se(me,pe);return[0,129].forEach(pe=>{for(let me=0;me<130;me++)se(me,pe),se(pe,me)}),[U,V,32768]}(),A=s.context;this.gridBuffer=A.createVertexBuffer(g,i.b7.members),this.gridIndexBuffer=A.createIndexBuffer(x),this.gridSegments=i.b8.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=i.b8.simpleSegment(0,0,g.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Xb(u.map),this.orthoMatrix=i.ad.mat4.create(),i.ad.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ai,0,i.ai,0,1);const L=A.gl;this._overlapStencilMode=new Lr({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new M2(u.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,u,g){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const x=s.terrain.properties,S=s.terrain.drapeRenderMode===0,A=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const L=s.terrain&&s.terrain.scope,z=x.get("source"),U=S?this._mockSourceCache:s.getSourceCache(z,L);if(!U)return void i.w(`Couldn't find terrain source "${z}".`);if(this.sourceCache=U,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=A?this.calculateExaggeration(u):x.get("exaggeration"),!u.projection.requiresDraping&&A&&this._exaggeration===0)return void this._disable();this.enabled=!0;const V=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(u,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,V(),this._initializing=!0),V(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const u=this._previousCameraAltitude,g=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=g;const x=u!=null?g-u:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const S=s.zoom,A=this._style.terrain;if(!this._previousUpdateTimestamp)return A.getExaggeration(S);let L=S-this._previousZoom;const z=this._previousUpdateTimestamp;let U=S;this._evaluationZoom!=null&&(U=this._evaluationZoom,Math.abs(S-U)>.5&&(L=.5*(S-U+L)),L*x<0&&(U+=L)),this._evaluationZoom=U;const V=A.getExaggeration(U),X=V===A.getExaggeration(Math.max(0,U-.1));if(X&&Math.abs(V-this._exaggeration)<.01)return V;let Y=Math.min(.1,.00375*(this._updateTimestamp-z));return(X||V<.1||Math.abs(L)<1e-4)&&(Y=Math.min(.2,4*Y)),i.ah(this._exaggeration,V,Y)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(i.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(z=>{const U=u.getTileByID(z).tileID;return U.projMatrix=g.calculateProjMatrix(U.toUnwrapped()),U});(function(z,U){const V=U.transform.pointCoordinate(U.transform.getCameraPoint()),X=new i.P(V.x,V.y);z.sort((Y,re)=>{if(re.overscaledZ-Y.overscaledZ)return re.overscaledZ-Y.overscaledZ;const ce=new i.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),se=new i.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),pe=X.mult(1<<Y.canonical.z);return pe.x-=.5,pe.y-=.5,pe.distSqr(ce)-pe.distSqr(se)})})(x,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},x.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const A=this._style._mergedSourceCaches;for(const z in A){const U=A[z];if(!U.used||(U!==this.sourceCache&&this.resetTileLookupCache(U.id),this._setupProxiedCoordsForOrtho(U,s[z],S),U.usedForTerrain))continue;const V=s[z];U.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[u.id]=x.map(z=>new Cv(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const L={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const U=this.terrainTileForTile[z.key];if(!U)continue;const V=U.tileID.key;V in L||(this._visibleDemTiles.push(U),L[V]=V)}}_assignTerrainTiles(s){this._initializing||s.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const s=this.painter.context,u=s.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],S=x.dem;!S||x.demTexture&&!x.needsDEMTextureUpload||(s.activeTexture.set(u.TEXTURE1),Rb(this.painter,x,S))}}_prepareDemTileUniforms(s,u,g,x){if(!u||u.demTexture==null)return!1;const S=s.tileID.canonical,A=Math.pow(2,u.tileID.canonical.z-S.z),L=x||"";return g[`u_dem_tl${L}`]=[S.x*A%1,S.y*A%1],g[`u_dem_scale${L}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const u=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const S=x.dem.tree.minimums[0];return S>0&&s++,g+S},0);return s?u/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,u=s.gl;s.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new i.cL({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(x,{premultiply:!1}):S=this._emptyDEMTexture=new i.T(s,x,u.R32F,{premultiply:!1}),S}setupElevationDraw(s,u,g){const x=this.painter.context,S=x.gl,A={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};A.u_exaggeration=this.exaggeration();let L=null,z=null,U=1;if(g&&g.morphing&&this._useVertexMorphing){const re=g.morphing.srcDemTile,ce=g.morphing.dstDemTile;U=g.morphing.phase,re&&ce&&(this._prepareDemTileUniforms(s,re,A,"_prev")&&(z=re),this._prepareDemTileUniforms(s,ce,A)&&(L=ce))}const V=re=>re&&re.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let X=null;var Y;if(this.enabled?z&&L?(X=L.demTexture,x.activeTexture.set(S.TEXTURE4),z.demTexture.bind(V(z),S.CLAMP_TO_EDGE),A.u_dem_lerp=U):(L=this.terrainTileForTile[s.tileID.key],X=this._prepareDemTileUniforms(s,L,A)?L.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,x.activeTexture.set(S.TEXTURE2),X&&(A.u_dem_size=(Y=X).size[0]===1?1:Y.size[0]-2,X.bind(V(L),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,u,A),g&&g.useMeterToDem&&L){const re=(1<<L.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=re}if(g&&g.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(x,A),this.painter.transform.projection.name==="globe"){const re=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(x,re)}}globeUniformValues(s,u,g){const x=s.projection;return{u_tile_tl_up:x.upVector(u,0,0),u_tile_tr_up:x.upVector(u,i.ai,0),u_tile_br_up:x.upVector(u,i.ai,i.ai),u_tile_bl_up:x.upVector(u,0,i.ai),u_tile_up_scale:g?i.cM(1):x.upVectorScale(u,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const u=this.painter,g=this.painter.context;s.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,S,A,L,z){if(x.transform.projection.name==="globe")(function(U,V,X,Y,re){const ce=U.context,se=ce.gl;let pe,me;const be=U.transform,Ee=i.cD(U,ce,be),Te=(St,Tt)=>{if(me===Tt)return;const Dt=[Hb[Tt],"PROJECTION_GLOBE_VIEW"];Ee&&Dt.push("CUSTOM_ANTIALIASING");const et=U.isTileAffectedByFog(St);pe=U.getOrCreateProgram("globeRaster",{defines:Dt,overrideFog:et}),me=Tt},Re=U.colorModeForRenderPass(),Pe=new gr(se.LEQUAL,gr.ReadWrite,U.depthRangeFor3D);Ks.update(re);const Ie=i.cE(be),Oe=[i.av(be.center.lng),i.aC(be.center.lat)],ze=U.globeSharedBuffers,Ve=[be.width*i.q.devicePixelRatio,be.height*i.q.devicePixelRatio],dt=Float32Array.from(be.globeMatrix),rt={useDenormalizedUpVectorScale:!0};{const St=U.transform,Tt=Kc(St.zoom,V.exaggeration(),V.sourceCache._source.tileSize);me=-1;const Dt=se.TRIANGLES;for(const et of Y){const wt=X.getTile(et),Ke=Lr.disabled,bt=V.prevTerrainTileForTile[et.key],yt=V.terrainTileForTile[et.key];Ev(bt,yt)&&Ks.newMorphing(et.key,bt,yt,re,250),ce.activeTexture.set(se.TEXTURE0),wt.texture&&wt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Et=Ks.getMorphValuesForProxy(et.key),ht=Et?1:0;Et&&i.L(rt,{morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:i.cC(Et.phase)}});const Ct=i.cF(et.canonical),Gt=i.cG(Ct.getCenter().lat),qt=i.cH(et.canonical,Ct,Gt,St.worldSize/St._pixelsPerMercatorPixel),Zt=i.bc(i.cI(et.canonical)),sr=qb(St.expandedFarZProjMatrix,dt,Ie,Zt,i.ag(St.zoom),Oe,St.frustumCorners.TL,St.frustumCorners.TR,St.frustumCorners.BR,St.frustumCorners.BL,St.globeCenterInViewSpace,St.globeRadius,Ve,Tt,St._farZ,qt);if(Te(et,ht),pe&&(V.setupElevationDraw(wt,pe,rt),U.uploadCommonUniforms(ce,pe,et.toUnwrapped()),ze)){const[kr,xr,Pr]=ze.getGridBuffers(Gt,Tt!==0);pe.draw(U,Dt,Pe,Ke,Re,Or.backCCW,sr,"globe_raster",kr,xr,Pr)}}}if(ze&&(U.renderDefaultNorthPole||U.renderDefaultSouthPole)){const St=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ee&&St.push("CUSTOM_ANTIALIASING"),pe=U.getOrCreateProgram("globeRaster",{defines:St});for(const Tt of Y){const{x:Dt,y:et,z:wt}=Tt.canonical,Ke=et===0,bt=et===(1<<wt)-1,[yt,Et,ht,Ct]=ze.getPoleBuffers(wt,!1);if(Ct&&(Ke||bt)){const Gt=X.getTile(Tt);ce.activeTexture.set(se.TEXTURE0),Gt.texture&&Gt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);let qt=i.cJ(wt,Dt,be);const Zt=i.bc(i.cI(Tt.canonical)),sr=(kr,xr)=>kr.draw(U,se.TRIANGLES,Pe,Lr.disabled,Re,Or.disabled,qb(be.expandedFarZProjMatrix,qt,qt,Zt,0,Oe,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Ve,0,be._farZ),"globe_pole_raster",xr,ht,Ct);V.setupElevationDraw(Gt,pe,rt),U.uploadCommonUniforms(ce,pe,Tt.toUnwrapped()),Ke&&U.renderDefaultNorthPole&&sr(pe,yt),bt&&U.renderDefaultSouthPole&&(qt=i.ad.mat4.scale(i.ad.mat4.create(),qt,[1,-1,1]),sr(pe,Et))}}}})(x,S,A,L,z);else{const U=x.context,V=U.gl;let X,Y;const re=x.shadowRenderer,ce=Zc(x,x.longestCutoffRange),se=Re=>{if(Y===Re)return;const Pe=[];Pe.push(Hb[Re]),ce.shouldRenderCutoff&&Pe.push("RENDER_CUTOFF"),re&&(Pe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),re.useNormalOffset&&Pe.push("NORMAL_OFFSET")),X=x.getOrCreateProgram("terrainRaster",{defines:Pe}),Y=Re},pe=x.colorModeForRenderPass(),me=new gr(V.LEQUAL,gr.ReadWrite,x.depthRangeFor3D);Ks.update(z);const be=x.transform,Ee=Kc(be.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let Te=[0,0,0];if(re){const Re=x.style.directionalLight,Pe=x.style.ambientLight;Re&&Pe&&(Te=Pf(x.style,Re,Pe))}{Y=-1;const Re=V.TRIANGLES,[Pe,Ie]=[S.gridIndexBuffer,S.gridSegments];for(const Oe of L){const ze=A.getTile(Oe),Ve=Lr.disabled,dt=S.prevTerrainTileForTile[Oe.key],rt=S.terrainTileForTile[Oe.key];Ev(dt,rt)&&Ks.newMorphing(Oe.key,dt,rt,z,250),U.activeTexture.set(V.TEXTURE0),ze.texture&&ze.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const St=Ks.getMorphValuesForProxy(Oe.key),Tt=St?1:0;let Dt;St&&(Dt={morphing:{srcDemTile:St.from,dstDemTile:St.to,phase:i.cC(St.phase)}});const et=C2(Oe.projMatrix,Zb(Oe.canonical,be.renderWorldCopies)?Ee/10:Ee,Te);if(se(Tt),!X)continue;S.setupElevationDraw(ze,X,Dt);const wt=Oe.toUnwrapped();re&&re.setupShadows(wt,X),x.uploadCommonUniforms(U,X,wt,null,ce),X.draw(x,Re,me,Ve,pe,Or.backCCW,et,"terrain_raster",S.gridBuffer,Pe,Ie)}}}}(u,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,x=this.proxySourceCache,S=this.proxiedCoords[x.id],A=this._drapedRenderBatches.shift(),L=u.style.order,z=[];let U=0;for(const V of S){const X=x.getTileByID(V.proxyTileKey),Y=x.proxyCachedFBO[V.key]?x.proxyCachedFBO[V.key][s]:void 0,re=Y!==void 0?x.renderCache[Y]:this.pool[U++],ce=Y!==void 0;if(X.texture=re.tex,ce&&!re.dirty){z.push(X.tileID);continue}let se;g.bindFramebuffer.set(re.fb.framebuffer),this.renderedToTile=!1,re.dirty&&(g.clear({color:i.al.transparent,stencil:0}),re.dirty=!1);for(let pe=A.start;pe<=A.end;++pe){const me=u.style._mergedLayers[L[pe]];if(me.isHidden(u.transform.zoom))continue;const be=u.style.getLayerSourceCache(me),Ee=be?this.proxyToSource[V.key][be.id]:[V];if(!Ee)continue;const Te=Ee;g.viewport.set([0,0,re.fb.width,re.fb.height]),se!==(be?be.id:null)&&(this._setupStencil(re,Ee,me,be),se=be?be.id:null),u.renderLayer(u,be,me,Te)}if(this._drapedRenderBatches.length===0)for(const pe of this._pendingGroundEffectLayers){const me=u.style._mergedLayers[L[pe]];if(me.isHidden(u.transform.zoom))continue;const be=u.style.getLayerSourceCache(me),Ee=be?this.proxyToSource[V.key][be.id]:[V];if(!Ee)continue;const Te=Ee;g.viewport.set([0,0,re.fb.width,re.fb.height]),se!==(be?be.id:null)&&(this._setupStencil(re,Ee,me,be),se=be?be.id:null),u.renderLayer(u,be,me,Te)}this.renderedToTile?(re.dirty=!0,z.push(X.tileID)):ce||--U,U===5&&(U=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),A.end+1}postRender(){}isLayerOrderingCorrect(s){const u=s.order.length;let g=-1,x=u;for(let S=0;S<u;++S)this._style.isLayerDraped(s._mergedLayers[s.order[S]])?g=Math.max(g,S):x=Math.min(x,S);return x>g}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{s=Math.min(s,u.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,u,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const A=S.tileID,L=1<<A.overscaledZ,{x:z,y:U}=A.canonical,V=z/L,X=(z+1)/L,Y=U/L,re=(U+1)/L;return{minx:V,miny:Y,maxx:X,maxy:re,t:S.dem.tree.raycastRoot(V,Y,X,re,s,u,g),tile:S}});x.sort((S,A)=>(S.t!==null?S.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const S of x){if(S.t==null)return null;const A=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,s,u,g);if(A!=null)return A}return null}_createFBO(){const s=this.painter.context,u=s.gl,g=this.drapeBufferSize;s.activeTexture.set(u.TEXTURE0);const x=new i.T(s,{width:g[0],height:g[1],data:null},u.RGBA8);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const S=s.createFramebuffer(g[0],g[1],!0,null);return S.colorAttachment.set(x.texture),S.depthAttachment=new A2(s,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:S,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const u=this._style._mergedLayers[s],g=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const g of this._style.getSources())if(g instanceof gf){s=!0;break}if(!s)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(x);if(S&&!u[S.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.ab){u[S.id]=!0;for(const A of this.proxyCoords){const L=this.proxyToSource[A.key][S.id];if(L)for(const z of L)this._clearRenderCacheForTile(S.id,z)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof Zs){s=!0;break}if(!s)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(x);if(!S||u[S.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const A=x.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const z=this.proxyToSource[L.key][S.id];if(z)for(const U of z){const V=Av(S.getTile(U),S.findLoadedParent(U,0),S,this.painter.transform,A);(V.opacity!==1||V.mix!==0)&&this._clearRenderCacheForTile(S.id,U)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,u=s.length;if(u===0)return;const g=[];this._pendingGroundEffectLayers=[];let x,S=0,A=this._style._mergedLayers[s[S]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++S<u;)A=this._style._mergedLayers[s[S]];for(;S<u;++S){const L=this._style._mergedLayers[s[S]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?x===void 0&&(x=S):(L.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),x!==void 0&&(g.push({start:x,end:S-1}),x=void 0)))}if(x!==void 0&&g.push({start:x,end:S-1}),g.length!==0){const L=g[g.length-1];this._pendingGroundEffectLayers.every(z=>z>L.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(s){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const A=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let L=0;L<A.length;++L){const z=Object.values(A[L]);u.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let A=g.length-1;A>=0;A--){const L=g[A];if(u.getTileByID(L.key),u.proxyCachedFBO[L.key]!==void 0){const z=s[L.key],U=this.proxyToSource[L.key];let V=0;for(const X in U){const Y=U[X],re=z[X];if(!re||re.length!==Y.length||Y.some((ce,se)=>ce!==re[se]||x[X]&&x[X].hasOwnProperty(ce.key))){V=-1;break}++V}for(const X in u.proxyCachedFBO[L.key])u.renderCache[u.proxyCachedFBO[L.key][X]].dirty=V<0||V!==Object.values(z).length}}const S=[...this._drapedRenderBatches];S.sort((A,L)=>L.end-L.start-(A.end-A.start));for(const A of S)for(const L of g){if(u.proxyCachedFBO[L.key])continue;let z=u.renderCachePool.pop();z===void 0&&u.renderCache.length<50&&(z=u.renderCache.length,u.renderCache.push(this._createFBO())),z!==void 0&&(u.proxyCachedFBO[L.key]={},u.proxyCachedFBO[L.key][A.start]=z,u.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(s,u,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,A=S.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let L;if(g.isTileClipped())L=u.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Lr.disabled}_renderTileClippingMasks(s,u){const g=this.painter,x=this.painter.context,S=x.gl;g._tileClippingMaskIDs={},x.setColorMode(Jr.disabled),x.setDepthMode(gr.disabled);const A=g.getOrCreateProgram("clippingMask");for(const L of s){const z=g._tileClippingMaskIDs[L.key]=--u;A.draw(g,S.TRIANGLES,gr.disabled,new Lr({func:S.ALWAYS,mask:0},z,255,S.KEEP,S.KEEP,S.REPLACE),Jr.disabled,Or.disabled,Nf(L.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){const u=this.painter.transform;if(s.x<0||s.x>u.width||s.y<0||s.y>u.height)return null;const g=[s.x,s.y,1,1];i.ad.vec4.transformMat4(g,g,u.pixelMatrixInverse),i.ad.vec4.scale(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const x=u._camera.position,S=i.bH(1,u.center.lat),A=[x[0],x[1],x[2]/S,0],L=i.ad.vec3.subtract([],g.slice(0,3),A);i.ad.vec3.normalize(L,L);const z=this.raycast(A,L,this._exaggeration);return z!==null&&z?(i.ad.vec3.scaleAndAdd(A,A,L,z),A[3]=A[2],A[2]*=S,A):null}_setupProxiedCoordsForOrtho(s,u,g){if(s.getSource()instanceof i.aK)return this._setupProxiedCoordsForImageSource(s,u,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const x=this.proxiedCoords[s.id]=[],S=this.proxyCoords;for(let z=0;z<S.length;z++){const U=S[z],V=this._findTileCoveringTileID(U,s);if(V){const X=this._createProxiedId(U,V,g[U.key]&&g[U.key][s.id]);x.push(X),this.proxyToSource[U.key][s.id]=[X]}}let A=!1;const L=new Set;for(let z=0;z<u.length;z++){const U=s.getTile(u[z]);if(!U||!U.hasData())continue;const V=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==U.tileID.canonical.z){const X=this.proxyToSource[V.tileID.key][s.id],Y=this._createProxiedId(V.tileID,U,g[V.tileID.key]&&g[V.tileID.key][s.id]);X?X.splice(X.length-1,0,Y):this.proxyToSource[V.tileID.key][s.id]=[Y];const re=this.proxyToSource[V.tileID.key][s.id];L.has(re)||L.add(re),x.push(Y),A=!0}}if(this._sourceTilesOverlap[s.id]=A,A&&this._debugParams.sortTilesHiZFirst)for(const z of L)z.sort((U,V)=>V.overscaledZ-U.overscaledZ)}_setupProxiedCoordsForImageSource(s,u,g){if(!s.getSource().loaded())return;const x=this.proxiedCoords[s.id]=[],S=this.proxyCoords,A=s.getSource(),L=A.tileID;if(!L)return;const z=new i.P(L.x,L.y)._div(1<<L.z),U=A.coordinates.map(i.ac.fromLngLat).reduce((X,Y)=>(X.min.x=Math.min(X.min.x,Y.x-z.x),X.min.y=Math.min(X.min.y,Y.y-z.y),X.max.x=Math.max(X.max.x,Y.x-z.x),X.max.y=Math.max(X.max.y,Y.y-z.y),X),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(X,Y)=>{const re=X.wrap+X.canonical.x/(1<<X.canonical.z),ce=X.canonical.y/(1<<X.canonical.z),se=i.ai/(1<<X.canonical.z),pe=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),me=Y.canonical.y/(1<<Y.canonical.z);return re+se<pe+U.min.x||re>pe+U.max.x||ce+se<me+U.min.y||ce>me+U.max.y};for(let X=0;X<S.length;X++){const Y=S[X];for(let re=0;re<u.length;re++){const ce=s.getTile(u[re]);if(!ce||!ce.hasData()||V(Y,ce.tileID))continue;const se=this._createProxiedId(Y,ce,g[Y.key]&&g[Y.key][s.id]),pe=this.proxyToSource[Y.key][s.id];pe?pe.push(se):this.proxyToSource[Y.key][s.id]=[se],x.push(se)}}}_createProxiedId(s,u,g){let x=this.orthoMatrix;if(g){const S=g.find(A=>A.key===u.tileID.key);if(S)return S}if(u.tileID.key!==s.key){const S=s.canonical.z-u.tileID.canonical.z;let A,L,z;x=i.ad.mat4.create();const U=u.tileID.wrap-s.wrap<<s.overscaledZ;S>0?(A=i.ai>>S,L=A*((u.tileID.canonical.x<<S)-s.canonical.x+U),z=A*((u.tileID.canonical.y<<S)-s.canonical.y)):(A=i.ai<<-S,L=i.ai*(u.tileID.canonical.x-(s.canonical.x+U<<-S)),z=i.ai*(u.tileID.canonical.y-(s.canonical.y<<-S))),i.ad.mat4.ortho(x,0,A,0,A,0,1),i.ad.mat4.translate(x,x,[L,z,0])}return new Cv(u.tileID,s.key,x)}_findTileCoveringTileID(s,u){let g=u.getTile(s);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[u.id],S=x[s.key];if(g=S?u.getTileByID(S):null,g&&g.hasData()||S===null)return g;let A=g?g.tileID:s,L=A.overscaledZ;const z=u.getSource().minzoom,U=[];if(!S){const X=u.getSource().maxzoom;if(s.canonical.z>=X){const Y=s.canonical.z-X;u.getSource().reparseOverscaled?(L=Math.max(s.canonical.z+2,u.transform.tileZoom),A=new i.aH(L,s.wrap,X,s.canonical.x>>Y,s.canonical.y>>Y)):Y!==0&&(L=X,A=new i.aH(L,s.wrap,X,s.canonical.x>>Y,s.canonical.y>>Y))}A.key!==s.key&&(U.push(A.key),g=u.getTile(A))}const V=X=>{U.forEach(Y=>{x[Y]=X}),U.length=0};for(L-=1;L>=z&&(!g||!g.hasData());L--){g&&V(g.tileID.key);const X=A.calculateScaledKey(L);if(g=u.getTileByID(X),g&&g.hasData())break;const Y=x[X];if(Y===null)break;Y===void 0?U.push(X):g=u.getTileByID(Y)}return V(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,u){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[u.key]=!0}}function I2(y,s,u){const g=function(L,z,U){const V=i.ad.vec3.dot(z,L),X=i.ad.vec3.dot(U,[.2126,.7152,.0722]),Y=(ce,se,pe)=>(1-pe)*ce+pe*se,re=Y(1-.3*Math.min(X,1),1,Math.min(V+1,1));return Y(.92,1,Math.asin(i.ay(z[2],-1,1))/Math.PI+.5)*re}(y,[0,0,1],s),x=[0,0,0];i.ad.vec3.scale(x,u.slice(0,3),g);const S=[0,0,0];i.ad.vec3.scale(S,s.slice(0,3),y[2]);const A=[0,0,0];return i.ad.vec3.add(A,x,S),i.cg(A)}const og=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],SD=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class O2{static cacheKey(s,u,g,x){let S=`${u}${x?x.cacheKey:""}`;for(const A of g)s.usedDefines.includes(A)&&(S+=`/${A}`);return S}constructor(s,u,g,x,S,A){const L=s.gl;this.program=L.createProgram(),this.configuration=x,this.name=u,this.fixedDefines=[...A];const z=x?x.getBinderAttributes():[],U=(g.staticAttributes||[]).concat(z);let V=x?x.defines():[];V=V.concat(A.map(pe=>`#define ${pe}`));const X=`#version 300 es
`;let Y=X+V.concat("precision mediump float;",xv,kb.fragmentSource).join(`
`);for(const pe of g.fragmentIncludes)Y+=`
${ih[pe]}`;Y+=`
${g.fragmentSource}`;let re=X+V.concat("precision highp float;",xv,kb.vertexSource).join(`
`);for(const pe of g.vertexIncludes)re+=`
${ih[pe]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(re+=`
uniform int u_instanceID;
`),re+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(re=re.replaceAll("gl_InstanceID","u_instanceID"));const ce=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(ce,Y),L.compileShader(ce),L.attachShader(this.program,ce);const se=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(se,re),L.compileShader(se),L.attachShader(this.program,se),this.attributes={},this.numAttributes=U.length;for(let pe=0;pe<this.numAttributes;pe++)if(U[pe]){const me=U[pe].startsWith("a_")?U[pe]:`a_${U[pe]}`;L.bindAttribLocation(this.program,pe,me),this.attributes[me]=pe}L.linkProgram(this.program),L.deleteShader(se),L.deleteShader(ce),this.fixedUniforms=S(s),this.binderUniforms=x?x.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(pe=>({u_instanceID:new i.bN(pe)}))(s)),(A.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(pe=>({u_dem:new i.bN(pe),u_dem_prev:new i.bN(pe),u_dem_tl:new i.bK(pe),u_dem_scale:new i.bM(pe),u_dem_tl_prev:new i.bK(pe),u_dem_scale_prev:new i.bM(pe),u_dem_size:new i.bM(pe),u_dem_lerp:new i.bM(pe),u_exaggeration:new i.bM(pe),u_depth:new i.bN(pe),u_depth_size_inv:new i.bK(pe),u_depth_range_unpack:new i.bK(pe),u_occluder_half_size:new i.bM(pe),u_occlusion_depth_offset:new i.bM(pe),u_meter_to_dem:new i.bM(pe),u_label_plane_matrix_inv:new i.bJ(pe)}))(s)),A.includes("GLOBE")&&(this.globeUniforms=(pe=>({u_tile_tl_up:new i.bL(pe),u_tile_tr_up:new i.bL(pe),u_tile_br_up:new i.bL(pe),u_tile_bl_up:new i.bL(pe),u_tile_up_scale:new i.bM(pe)}))(s)),A.includes("FOG")&&(this.fogUniforms=(pe=>({u_fog_matrix:new i.bJ(pe),u_fog_range:new i.bK(pe),u_fog_color:new i.cb(pe),u_fog_horizon_blend:new i.bM(pe),u_fog_vertical_limit:new i.bK(pe),u_fog_temporal_offset:new i.bM(pe),u_frustum_tl:new i.bL(pe),u_frustum_tr:new i.bL(pe),u_frustum_br:new i.bL(pe),u_frustum_bl:new i.bL(pe),u_globe_pos:new i.bL(pe),u_globe_radius:new i.bM(pe),u_globe_transition:new i.bM(pe),u_is_globe:new i.bN(pe),u_viewport:new i.bK(pe)}))(s)),A.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(pe=>({u_cutoff_params:new i.cb(pe)}))(s)),A.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(pe=>({u_lighting_ambient_color:new i.bL(pe),u_lighting_directional_dir:new i.bL(pe),u_lighting_directional_color:new i.bL(pe),u_ground_radiance:new i.bL(pe)}))(s)),A.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(pe=>({u_light_matrix_0:new i.bJ(pe),u_light_matrix_1:new i.bJ(pe),u_fade_range:new i.bK(pe),u_shadow_normal_offset:new i.bL(pe),u_shadow_intensity:new i.bM(pe),u_shadow_texel_size:new i.bM(pe),u_shadow_map_resolution:new i.bM(pe),u_shadow_direction:new i.bL(pe),u_shadow_bias:new i.bL(pe),u_shadowmap_0:new i.bN(pe),u_shadowmap_1:new i.bN(pe)}))(s))}}setTerrainUniformValues(s,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setGlobeUniformValues(s,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setFogUniformValues(s,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setCutoffUniformValues(s,u){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setLightsUniformValues(s,u){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setShadowUniformValues(s,u){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}_drawDebugWireframe(s,u,g,x,S,A,L,z,U,V){const X=s.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const Y=s.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||s._terrain&&s._terrain.renderingToTexture||!og.includes(this.name))||!(!X.layers3D||!SD.includes(this.name))))return;const re=Y.gl,ce=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,S,Y);if(!ce)return;const se=[...this.fixedDefines];se.push("DEBUG_WIREFRAME");const pe=s.getOrCreateProgram(this.name,{config:this.configuration,defines:se});Y.program.set(pe.program);const me=(Te,Re,Pe)=>{if(Re[Te]&&Pe[Te])for(const Ie in Re[Te])Pe[Te][Ie]&&Pe[Te][Ie].set(Pe.program,Ie,Re[Te][Ie].current)};U&&U.setUniforms(pe.program,Y,pe.binderUniforms,L,{zoom:z}),me("fixedUniforms",this,pe),me("terrainUniforms",this,pe),me("globeUniforms",this,pe),me("fogUniforms",this,pe),me("lightsUniforms",this,pe),me("shadowUniforms",this,pe),ce.bind(),Y.setColorMode(new Jr([re.ONE,re.ONE_MINUS_SRC_ALPHA,re.ZERO,re.ONE],i.al.transparent,[!0,!0,!0,!1])),Y.setDepthMode(new gr(u.func===re.LESS?re.LEQUAL:u.func,gr.ReadOnly,u.range)),Y.setStencilMode(Lr.disabled);const be=3*A.primitiveLength*2,Ee=3*A.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Te=V||1;for(let Re=0;Re<Te;++Re)pe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Re),re.drawElements(re.LINES,be,re.UNSIGNED_SHORT,Ee)}else V&&V>1?re.drawElementsInstanced(re.LINES,be,re.UNSIGNED_SHORT,Ee,V):re.drawElements(re.LINES,be,re.UNSIGNED_SHORT,Ee);S.bind(),Y.program.set(this.program),Y.setDepthMode(u),Y.setStencilMode(g),Y.setColorMode(x)}checkUniforms(s,u,g){if(this.fixedDefines.includes(u)){for(const x of Object.keys(g))if(!g[x].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${x} not set but required by ${u} being defined`)}}draw(s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe){const me=s.context,be=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(g),me.setStencilMode(x),me.setColorMode(S),me.setCullFace(A);for(const Re of Object.keys(this.fixedUniforms))this.fixedUniforms[Re].set(this.program,Re,L[Re]);ce&&ce.setUniforms(this.program,me,this.binderUniforms,Y,{zoom:re});const Ee={[be.POINTS]:1,[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[u];this.checkUniforms(z,"RENDER_SHADOWS",this.shadowUniforms);const Te=pe&&pe>0?1:void 0;for(const Re of X.get()){const Pe=Re.vaos||(Re.vaos={});if((Pe[z]||(Pe[z]=new _2)).bind(me,this,U,ce?ce.getPaintVertexBuffers():[],V,Re.vertexOffset,se||[],Te),this.forceManualRenderingForInstanceIDShaders){const Ie=pe||1;for(let Oe=0;Oe<Ie;++Oe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Oe),V?be.drawElements(u,Re.primitiveLength*Ee,be.UNSIGNED_SHORT,Re.primitiveOffset*Ee*2):be.drawArrays(u,Re.vertexOffset,Re.vertexLength)}else pe&&pe>1?be.drawElementsInstanced(u,Re.primitiveLength*Ee,be.UNSIGNED_SHORT,Re.primitiveOffset*Ee*2,pe):V?be.drawElements(u,Re.primitiveLength*Ee,be.UNSIGNED_SHORT,Re.primitiveOffset*Ee*2):be.drawArrays(u,Re.vertexOffset,Re.vertexLength);u===be.TRIANGLES&&V&&this._drawDebugWireframe(s,g,x,S,V,Re,Y,re,ce,pe)}}}function Yb(y,s){const u=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,y.transform.tileZoom)/u,x=g*(s.tileID.canonical.x+s.tileID.wrap*u),S=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.at(s,1,y.transform.tileZoom),u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const Mv={terrain:0,flat:1},Kb=i.ad.mat4.create(),Pv=(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me)=>{const be=s.style.light,Ee=be.properties.get("position"),Te=[Ee.x,Ee.y,Ee.z],Re=i.ad.mat3.create();be.properties.get("anchor")==="viewport"&&(i.ad.mat3.fromRotation(Re,-s.transform.angle),i.ad.vec3.transformMat3(Te,Te,Re));const Pe=be.properties.get("color"),Ie=s.transform,Oe={u_matrix:y,u_lightpos:Te,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Pe.r,Pe.g,Pe.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kb,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Mv[U],u_base_type:Mv[V],u_ao:x,u_edge_radius:S,u_width_scale:A,u_flood_light_color:ce,u_vertical_scale:se,u_flood_light_intensity:pe,u_ground_shadow_factor:me};return Ie.projection.name==="globe"&&(Oe.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],Oe.u_zoom_transition=X,Oe.u_inv_rot_matrix=re,Oe.u_merc_center=Y,Oe.u_up_dir=Ie.projection.upVector(new i.bT(0,0,0),Y[0]*i.ai,Y[1]*i.ai),Oe.u_height_lift=z),Oe},zf=(y,s,u,g,x,S)=>({u_matrix:y,u_edge_radius:s,u_width_scale:u,u_vertical_scale:g,u_height_type:Mv[x],u_base_type:Mv[S]}),Jb=(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe)=>{const me=Pv(y,s,u,g,x,S,A,L,U,V,X,Y,re,ce,se,pe,1,[0,0,0]),be={u_height_factor:-Math.pow(2,L.overscaledZ)/z.tileSize/8};return i.l(me,Yb(s,z),be)},jf=(y,s)=>({u_matrix:y,u_emissive_strength:s}),Qb=(y,s,u,g)=>i.l(jf(y,s),Yb(u,g)),Iv=(y,s,u)=>({u_matrix:y,u_world:u,u_emissive_strength:s}),Ov=(y,s,u,g,x)=>i.l(Qb(y,s,u,g),{u_world:x}),ag=(y,s,u,g,x)=>({u_matrix:y,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:u,u_height_scale:g,u_reset_depth:x}),k2=(y,s,u,g)=>{const x=i.ai/u.tileSize;return{u_matrix:y,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/x,s.pixelsToGLUnits[1]/x]}},R2=(y,s,u=1)=>({u_matrix:y,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:u}),Ff=i.ad.mat4.create(),kv=(y,s,u,g,x,S,A)=>{const L=y.transform,z=L.projection.name==="globe",U=z?i.cO(L.zoom,s.canonical)*L._pixelsPerMercatorPixel:i.at(u,1,S),V={u_matrix:s.projMatrix,u_extrude_scale:U,u_intensity:A,u_inv_rot_matrix:Ff,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){V.u_inv_rot_matrix=g,V.u_merc_center=x,V.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],V.u_zoom_transition=i.ag(L.zoom);const X=x[0]*i.ai,Y=x[1]*i.ai;V.u_up_dir=L.projection.upVector(new i.bT(0,0,0),X,Y)}return V};function Qt(y,[s,u,g,x],[S,A]){if(S===A)return[0,0,0,0];const L=255*(y-1)/(y*(A-S));return[s*L,u*L,g*L,x*L]}function e1(y,s,[u,g]){return u===g?0:.5/y+(s-u)*(y-1)/(y*(g-u))}const t1=(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me,be,Ee,Te)=>({u_matrix:y,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:U,u_fade_t:V.mix,u_opacity:V.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:i.cP(X.paint.get("raster-saturation")),u_contrast_factor:i.cQ(X.paint.get("raster-contrast")),u_spin_weights:ed(X.paint.get("raster-hue-rotate")),u_perspective_transform:Y,u_raster_elevation:re,u_zoom_transition:A,u_merc_center:L,u_cutoff_params:z,u_colorization_mix:Qt(i.cR,se,me),u_colorization_offset:e1(i.cR,pe,me),u_color_ramp:ce,u_texture_offset:[Ee/(be+2*Ee),be/(be+2*Ee)],u_texture_res:[be+2*Ee,be+2*Ee],u_emissive_strength:Te});function ed(y){y*=Math.PI/180;const s=Math.sin(y),u=Math.cos(y);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const Ts=.05,vr=(y,s,u,g,x,S,A,L,z,U,V,X)=>({u_matrix:y,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:U,u_fade_t:V.mix,u_opacity:V.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:A,u_merc_center:L,u_cutoff_params:z}),r1=(y,s,u,g,x,S,A,L,z,U)=>({u_particle_texture:y,u_particle_texture_side_len:s,u_tile_offset:u,u_velocity:g,u_color_ramp:S,u_velocity_res:x,u_max_speed:A,u_uv_offset:L,u_data_scale:[255*z[0],255*z[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ts,Ts]}),TD=(y,s,u,g,x,S,A,L,z,U)=>({u_particle_texture:y,u_particle_texture_side_len:s,u_velocity:u,u_velocity_res:g,u_max_speed:x,u_speed_factor:S,u_reset_rate:A,u_rand_seed:Math.random(),u_uv_offset:L,u_data_scale:[255*z[0],255*z[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ts,Ts]}),D2=i.ad.mat4.create(),Rv=(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me,be,Ee,Te,Re)=>{const Pe=x.transform,Ie={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Pe.getCameraToCenterDistance(be),u_rotate_symbol:+u,u_aspect_ratio:Pe.width/Pe.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:A,u_coord_matrix:L,u_is_text:+U,u_elevation_from_sea:z?1:0,u_pitch_with_map:+g,u_texsize:V,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:D2,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:D2,u_up_vector:[0,-1,0],u_color_adj_mat:Ee,u_icon_transition:Te||0,u_gamma_scale:g?x.transform.getCameraToCenterDistance(be)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+Y,u_scale_factor:Re||1};return be.name==="globe"&&(Ie.u_tile_id=[re.canonical.x,re.canonical.y,1<<re.canonical.z],Ie.u_zoom_transition=ce,Ie.u_inv_rot_matrix=pe,Ie.u_merc_center=se,Ie.u_camera_forward=Pe._camera.forward(),Ie.u_ecef_origin=i.cS(Pe.globeMatrix,re.toUnwrapped()),Ie.u_tile_matrix=Float32Array.from(Pe.globeMatrix),Ie.u_up_vector=me),Ie},n1=(y,s,u,g)=>({u_matrix:y,u_emissive_strength:s,u_opacity:u,u_color:g}),L2=(y,s,u,g,x,S,A,L,z)=>i.l(function(U,V,X,Y,re,ce){const{width:se,height:pe}=Y.imageManager.getPixelSize(V),me=Math.pow(2,ce.tileID.overscaledZ),be=ce.tileSize*Math.pow(2,Y.transform.tileZoom)/me,Ee=be*(ce.tileID.canonical.x+ce.tileID.wrap*me),Te=be*ce.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[se,pe],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:re?[Y.transform.width,-1*Y.transform.height]:[1/i.at(ce,1,Y.transform.tileZoom),1/i.at(ce,1,Y.transform.tileZoom)],u_pixel_coord_upper:[Ee>>16,Te>>16],u_pixel_coord_lower:[65535&Ee,65535&Te]}}(0,S,A,g,L,z),{u_matrix:y,u_emissive_strength:s,u_opacity:u}),Dv=new Float32Array(i.ad.mat4.identity([])),i1=(y,s,u,g,x,S,A,L,z,U,V,X,Y,re=[0,0,0],ce)=>{const se=x.style.light,pe=se.properties.get("position"),me=[-pe.x,-pe.y,pe.z],be=i.ad.mat3.create();se.properties.get("anchor")==="viewport"&&(i.ad.mat3.fromRotation(be,-x.transform.angle),i.ad.vec3.transformMat3(me,me,be));const Ee=V.alphaMode==="MASK",Te=se.properties.get("color").toRenderColor(null),Re=Y.paint.get("model-ambient-occlusion-intensity"),Pe=Y.paint.get("model-color").constantOr(i.al.white).toRenderColor(null),Ie=Y.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:y,u_lighting_matrix:s,u_normal_matrix:u,u_node_matrix:g||Dv,u_lightpos:me,u_lightintensity:se.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_camera_pos:re,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+Ee,u_alphaCutoff:V.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[L[0],L[1],L[2],1],u_metallicFactor:z,u_roughnessFactor:U,u_baseColorTexture:Ri.BaseColor,u_metallicRoughnessTexture:Ri.MetallicRoughness,u_normalTexture:Ri.Normal,u_occlusionTexture:Ri.Occlusion,u_emissionTexture:Ri.Emission,u_lutTexture:Ri.LUT,u_color_mix:[Pe.r,Pe.g,Pe.b,Ie],u_aoIntensity:Re,u_emissive_strength:X,u_occlusionTextureTransform:ce||[0,0,0,0]}},N2=(y,s=Dv,u=Dv)=>({u_matrix:y,u_instance:s,u_node_matrix:u}),o1={fillExtrusion:y=>({u_matrix:new i.bJ(y),u_lightpos:new i.bL(y),u_lightintensity:new i.bM(y),u_lightcolor:new i.bL(y),u_vertical_gradient:new i.bM(y),u_opacity:new i.bM(y),u_edge_radius:new i.bM(y),u_width_scale:new i.bM(y),u_ao:new i.bK(y),u_height_type:new i.bN(y),u_base_type:new i.bN(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_up_dir:new i.bL(y),u_height_lift:new i.bM(y),u_flood_light_color:new i.bL(y),u_vertical_scale:new i.bM(y),u_flood_light_intensity:new i.bM(y),u_ground_shadow_factor:new i.bL(y)}),fillExtrusionDepth:y=>({u_matrix:new i.bJ(y),u_edge_radius:new i.bM(y),u_width_scale:new i.bM(y),u_vertical_scale:new i.bM(y),u_height_type:new i.bN(y),u_base_type:new i.bN(y)}),fillExtrusionPattern:y=>({u_matrix:new i.bJ(y),u_lightpos:new i.bL(y),u_lightintensity:new i.bM(y),u_lightcolor:new i.bL(y),u_vertical_gradient:new i.bM(y),u_height_factor:new i.bM(y),u_edge_radius:new i.bM(y),u_width_scale:new i.bM(y),u_ao:new i.bK(y),u_height_type:new i.bN(y),u_base_type:new i.bN(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_up_dir:new i.bL(y),u_height_lift:new i.bM(y),u_image:new i.bN(y),u_texsize:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_tile_units_to_pixels:new i.bM(y),u_opacity:new i.bM(y)}),fillExtrusionGroundEffect:y=>({u_matrix:new i.bJ(y),u_opacity:new i.bM(y),u_ao_pass:new i.bM(y),u_meter_to_tile:new i.bM(y),u_ao:new i.bK(y),u_flood_light_intensity:new i.bM(y),u_flood_light_color:new i.bL(y),u_attenuation:new i.bM(y),u_edge_radius:new i.bM(y),u_fb:new i.bN(y),u_fb_size:new i.bM(y),u_dynamic_offset:new i.bM(y)}),fill:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y)}),fillPattern:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_image:new i.bN(y),u_texsize:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_tile_units_to_pixels:new i.bM(y)}),fillOutline:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_world:new i.bK(y)}),fillOutlinePattern:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_world:new i.bK(y),u_image:new i.bN(y),u_texsize:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_tile_units_to_pixels:new i.bM(y)}),elevatedStructures:y=>({u_matrix:new i.bJ(y)}),elevatedStructuresDepthReconstruct:y=>({u_matrix:new i.bJ(y),u_camera_pos:new i.bL(y),u_depth_bias:new i.bM(y),u_height_scale:new i.bM(y),u_reset_depth:new i.bM(y)}),circle:i.cT,collisionBox:y=>({u_matrix:new i.bJ(y),u_camera_to_center_distance:new i.bM(y),u_extrude_scale:new i.bK(y)}),collisionCircle:y=>({u_matrix:new i.bJ(y),u_inv_matrix:new i.bJ(y),u_camera_to_center_distance:new i.bM(y),u_viewport_size:new i.bK(y)}),debug:y=>({u_color:new i.cA(y),u_matrix:new i.bJ(y),u_overlay:new i.bN(y),u_overlay_scale:new i.bM(y)}),clippingMask:y=>({u_matrix:new i.bJ(y)}),heatmap:y=>({u_extrude_scale:new i.bM(y),u_intensity:new i.bM(y),u_matrix:new i.bJ(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_up_dir:new i.bL(y)}),heatmapTexture:y=>({u_image:new i.bN(y),u_color_ramp:new i.bN(y),u_opacity:new i.bM(y)}),hillshade:y=>({u_matrix:new i.bJ(y),u_image:new i.bN(y),u_latrange:new i.bK(y),u_light:new i.bK(y),u_shadow:new i.cA(y),u_highlight:new i.cA(y),u_emissive_strength:new i.bM(y),u_accent:new i.cA(y)}),hillshadePrepare:y=>({u_matrix:new i.bJ(y),u_image:new i.bN(y),u_dimension:new i.bK(y),u_zoom:new i.bM(y)}),line:i.cU,linePattern:i.cV,raster:y=>({u_matrix:new i.bJ(y),u_normalize_matrix:new i.bJ(y),u_globe_matrix:new i.bJ(y),u_merc_matrix:new i.bJ(y),u_grid_matrix:new i.cB(y),u_tl_parent:new i.bK(y),u_scale_parent:new i.bM(y),u_fade_t:new i.bM(y),u_opacity:new i.bM(y),u_image0:new i.bN(y),u_image1:new i.bN(y),u_brightness_low:new i.bM(y),u_brightness_high:new i.bM(y),u_saturation_factor:new i.bM(y),u_contrast_factor:new i.bM(y),u_spin_weights:new i.bL(y),u_perspective_transform:new i.bK(y),u_raster_elevation:new i.bM(y),u_zoom_transition:new i.bM(y),u_merc_center:new i.bK(y),u_cutoff_params:new i.cb(y),u_colorization_mix:new i.cb(y),u_colorization_offset:new i.bM(y),u_color_ramp:new i.bN(y),u_texture_offset:new i.bK(y),u_texture_res:new i.bK(y),u_emissive_strength:new i.bM(y)}),rasterParticle:y=>({u_matrix:new i.bJ(y),u_normalize_matrix:new i.bJ(y),u_globe_matrix:new i.bJ(y),u_merc_matrix:new i.bJ(y),u_grid_matrix:new i.cB(y),u_tl_parent:new i.bK(y),u_scale_parent:new i.bM(y),u_fade_t:new i.bM(y),u_opacity:new i.bM(y),u_image0:new i.bN(y),u_image1:new i.bN(y),u_raster_elevation:new i.bM(y),u_zoom_transition:new i.bM(y),u_merc_center:new i.bK(y),u_cutoff_params:new i.cb(y)}),rasterParticleTexture:y=>({u_texture:new i.bN(y),u_opacity:new i.bM(y)}),rasterParticleDraw:y=>({u_particle_texture:new i.bN(y),u_particle_texture_side_len:new i.bM(y),u_tile_offset:new i.bK(y),u_velocity:new i.bN(y),u_color_ramp:new i.bN(y),u_velocity_res:new i.bK(y),u_max_speed:new i.bM(y),u_uv_offset:new i.bK(y),u_data_scale:new i.bK(y),u_data_offset:new i.bM(y),u_particle_pos_scale:new i.bM(y),u_particle_pos_offset:new i.bK(y)}),rasterParticleUpdate:y=>({u_particle_texture:new i.bN(y),u_particle_texture_side_len:new i.bM(y),u_velocity:new i.bN(y),u_velocity_res:new i.bK(y),u_max_speed:new i.bM(y),u_speed_factor:new i.bM(y),u_reset_rate:new i.bM(y),u_rand_seed:new i.bM(y),u_uv_offset:new i.bK(y),u_data_scale:new i.bK(y),u_data_offset:new i.bM(y),u_particle_pos_scale:new i.bM(y),u_particle_pos_offset:new i.bK(y)}),symbol:y=>({u_is_size_zoom_constant:new i.bN(y),u_is_size_feature_constant:new i.bN(y),u_size_t:new i.bM(y),u_size:new i.bM(y),u_camera_to_center_distance:new i.bM(y),u_rotate_symbol:new i.bN(y),u_aspect_ratio:new i.bM(y),u_fade_change:new i.bM(y),u_matrix:new i.bJ(y),u_label_plane_matrix:new i.bJ(y),u_coord_matrix:new i.bJ(y),u_is_text:new i.bN(y),u_elevation_from_sea:new i.bN(y),u_pitch_with_map:new i.bN(y),u_texsize:new i.bK(y),u_texsize_icon:new i.bK(y),u_texture:new i.bN(y),u_texture_icon:new i.bN(y),u_gamma_scale:new i.bM(y),u_device_pixel_ratio:new i.bM(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_camera_forward:new i.bL(y),u_tile_matrix:new i.bJ(y),u_up_vector:new i.bL(y),u_ecef_origin:new i.bL(y),u_is_halo:new i.bN(y),u_icon_transition:new i.bM(y),u_color_adj_mat:new i.bJ(y),u_scale_factor:new i.bM(y)}),background:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_opacity:new i.bM(y),u_color:new i.cA(y)}),backgroundPattern:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_opacity:new i.bM(y),u_image:new i.bN(y),u_pattern_tl:new i.bK(y),u_pattern_br:new i.bK(y),u_texsize:new i.bK(y),u_pattern_size:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_pattern_units_to_pixels:new i.bK(y)}),terrainRaster:y=>({u_matrix:new i.bJ(y),u_image0:new i.bN(y),u_skirt_height:new i.bM(y),u_ground_shadow_factor:new i.bL(y)}),skybox:y=>({u_matrix:new i.bJ(y),u_sun_direction:new i.bL(y),u_cubemap:new i.bN(y),u_opacity:new i.bM(y),u_temporal_offset:new i.bM(y)}),skyboxGradient:y=>({u_matrix:new i.bJ(y),u_color_ramp:new i.bN(y),u_center_direction:new i.bL(y),u_radius:new i.bM(y),u_opacity:new i.bM(y),u_temporal_offset:new i.bM(y)}),skyboxCapture:y=>({u_matrix_3f:new i.cB(y),u_sun_direction:new i.bL(y),u_sun_intensity:new i.bM(y),u_color_tint_r:new i.cb(y),u_color_tint_m:new i.cb(y),u_luminance:new i.bM(y)}),globeRaster:y=>({u_proj_matrix:new i.bJ(y),u_globe_matrix:new i.bJ(y),u_normalize_matrix:new i.bJ(y),u_merc_matrix:new i.bJ(y),u_zoom_transition:new i.bM(y),u_merc_center:new i.bK(y),u_image0:new i.bN(y),u_grid_matrix:new i.cB(y),u_skirt_height:new i.bM(y),u_far_z_cutoff:new i.bM(y),u_frustum_tl:new i.bL(y),u_frustum_tr:new i.bL(y),u_frustum_br:new i.bL(y),u_frustum_bl:new i.bL(y),u_globe_pos:new i.bL(y),u_globe_radius:new i.bM(y),u_viewport:new i.bK(y)}),globeAtmosphere:y=>({u_frustum_tl:new i.bL(y),u_frustum_tr:new i.bL(y),u_frustum_br:new i.bL(y),u_frustum_bl:new i.bL(y),u_horizon:new i.bM(y),u_transition:new i.bM(y),u_fadeout_range:new i.bM(y),u_color:new i.cb(y),u_high_color:new i.cb(y),u_space_color:new i.cb(y),u_temporal_offset:new i.bM(y),u_horizon_angle:new i.bM(y)}),model:y=>({u_matrix:new i.bJ(y),u_lighting_matrix:new i.bJ(y),u_normal_matrix:new i.bJ(y),u_node_matrix:new i.bJ(y),u_lightpos:new i.bL(y),u_lightintensity:new i.bM(y),u_lightcolor:new i.bL(y),u_camera_pos:new i.bL(y),u_opacity:new i.bM(y),u_baseColorFactor:new i.cb(y),u_emissiveFactor:new i.cb(y),u_metallicFactor:new i.bM(y),u_roughnessFactor:new i.bM(y),u_baseTextureIsAlpha:new i.bN(y),u_alphaMask:new i.bN(y),u_alphaCutoff:new i.bM(y),u_baseColorTexture:new i.bN(y),u_metallicRoughnessTexture:new i.bN(y),u_normalTexture:new i.bN(y),u_occlusionTexture:new i.bN(y),u_emissionTexture:new i.bN(y),u_lutTexture:new i.bN(y),u_color_mix:new i.cb(y),u_aoIntensity:new i.bM(y),u_emissive_strength:new i.bM(y),u_occlusionTextureTransform:new i.cb(y)}),modelDepth:y=>({u_matrix:new i.bJ(y),u_instance:new i.bJ(y),u_node_matrix:new i.bJ(y)}),groundShadow:y=>({u_matrix:new i.bJ(y),u_ground_shadow_factor:new i.bL(y)}),stars:y=>({u_matrix:new i.bJ(y),u_up:new i.bL(y),u_right:new i.bL(y),u_intensity_multiplier:new i.bM(y)}),snowParticle:y=>({u_modelview:new i.bJ(y),u_projection:new i.bJ(y),u_time:new i.bM(y),u_cam_pos:new i.bL(y),u_velocityConeAperture:new i.bM(y),u_velocity:new i.bM(y),u_horizontalOscillationRadius:new i.bM(y),u_horizontalOscillationRate:new i.bM(y),u_boxSize:new i.bM(y),u_billboardSize:new i.bM(y),u_simpleShapeParameters:new i.bK(y),u_screenSize:new i.bK(y),u_thinningCenterPos:new i.bK(y),u_thinningShape:new i.bL(y),u_thinningAffectedRatio:new i.bM(y),u_thinningParticleOffset:new i.bM(y),u_particleColor:new i.cb(y),u_direction:new i.bL(y)}),rainParticle:y=>({u_modelview:new i.bJ(y),u_projection:new i.bJ(y),u_time:new i.bM(y),u_cam_pos:new i.bL(y),u_texScreen:new i.bN(y),u_velocityConeAperture:new i.bM(y),u_velocity:new i.bM(y),u_boxSize:new i.bM(y),u_rainDropletSize:new i.bK(y),u_distortionStrength:new i.bM(y),u_rainDirection:new i.bL(y),u_color:new i.cb(y),u_screenSize:new i.bK(y),u_thinningCenterPos:new i.bK(y),u_thinningShape:new i.bL(y),u_thinningAffectedRatio:new i.bM(y),u_thinningParticleOffset:new i.bM(y),u_shapeDirectionalPower:new i.bM(y),u_shapeNormalPower:new i.bM(y),u_mode:new i.bM(y)}),vignette:y=>({u_vignetteShape:new i.bL(y),u_vignetteColor:new i.cb(y)}),occlusion:y=>({u_matrix:new i.bJ(y),u_anchorPos:new i.bL(y),u_screenSizePx:new i.bK(y),u_occluderSizePx:new i.bK(y),u_color:new i.cb(y)})};class dc{constructor(s,u,g,x){this.id=dc.uniqueIdxCounter,dc.uniqueIdxCounter++,this.context=s;const S=s.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||x||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=dc.uniqueIdxCounter,dc.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}dc.uniqueIdxCounter=0;const a1={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class s1{constructor(s,u,g,x,S,A){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.instanceCount=A,this.context=s;const L=s.gl;this.buffer=L.createBuffer(),s.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||S||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let g=0;g<this.attributes.length;g++){const x=u.attributes[this.attributes[g].name];x!==void 0&&s.enableVertexAttribArray(x)}}setVertexAttribPointers(s,u,g){for(let x=0;x<this.attributes.length;x++){const S=this.attributes[x],A=u.attributes[S.name];A!==void 0&&s.vertexAttribPointer(A,S.components,s[a1[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(s,u,g){for(let x=0;x<this.attributes.length;x++){const S=u.attributes[this.attributes[x].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(S,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ua{constructor(s,u,g,x,S){this.context=s,this.width=u,this.height=g;const A=this.framebuffer=s.gl.createFramebuffer();x&&(this.colorAttachment=new Wb(s,A)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new Gb(s,A):new Lf(s,A))}destroy(){const s=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&s.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&s.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&s.deleteTexture(u)}s.deleteFramebuffer(this.framebuffer)}}class td{constructor(s,u){this.gl=s,this.clearColor=new mD(this),this.clearDepth=new Db(this),this.clearStencil=new Lb(this),this.colorMask=new Nb(this),this.depthMask=new zb(this),this.stencilMask=new b2(this),this.stencilFunc=new w2(this),this.stencilOp=new gD(this),this.stencilTest=new rg(this),this.depthRange=new ng(this),this.depthTest=new S2(this),this.depthFunc=new Ss(this),this.blend=new jb(this),this.blendFunc=new bv(this),this.blendColor=new wv(this),this.blendEquation=new Fb(this),this.cullFace=new Bb(this),this.cullFaceSide=new $b(this),this.frontFace=new Sv(this),this.program=new Ub(this),this.activeTexture=new Vb(this),this.viewport=new Tv(this),this.bindFramebuffer=new T2(this),this.bindRenderbuffer=new E2(this),this.bindTexture=new Df(this),this.bindVertexBuffer=new yD(this),this.bindElementBuffer=new vD(this),this.bindVertexArrayOES=new _D(this),this.pixelStoreUnpack=new xD(this),this.pixelStoreUnpackPremultiplyAlpha=new bD(this),this.pixelStoreUnpackFlipY=new wD(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u,g){return new dc(this,s,u,g)}createVertexBuffer(s,u,g,x,S){return new s1(this,s,u,g,x,S)}createRenderbuffer(s,u,g){const x=this.gl,S=x.createRenderbuffer();return this.bindRenderbuffer.set(S),x.renderbufferStorage(x.RENDERBUFFER,s,u,g),this.bindRenderbuffer.set(null),S}createFramebuffer(s,u,g,x){return new Ua(this,s,u,g,x)}clear({color:s,depth:u,stencil:g,colorMask:x}){const S=this.gl;let A=0;s&&(A|=S.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(x||[!0,!0,!0,!0])),u!==void 0&&(A|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(A|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),S.clear(A)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){i.bn(s.blendFunction,Jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let sg;function Lv(y,s,u,g,x,S,A){const L=y.context,z=L.gl,U=y.transform,V=y.getOrCreateProgram("collisionBox"),X=[];let Y=0,re=0;for(let Te=0;Te<g.length;Te++){const Re=g[Te],Pe=s.getTile(Re),Ie=Pe.getBucket(u);if(!Ie)continue;const Oe=Eb(Re,Ie,U);let ze=Oe;x[0]===0&&x[1]===0||(ze=y.translatePosMatrix(Oe,Pe,x,S));const Ve=A?Ie.textCollisionBox:Ie.iconCollisionBox,dt=Ie.collisionCircleArray;if(dt.length>0){const rt=i.ad.mat4.create(),St=ze;i.ad.mat4.mul(rt,Ie.placementInvProjMatrix,U.glCoordMatrix),i.ad.mat4.mul(rt,rt,Ie.placementViewportMatrix),X.push({circleArray:dt,circleOffset:re,transform:St,invTransform:rt,projection:Ie.getProjection()}),Y+=dt.length/4,re=Y}Ve&&(y.terrain&&y.terrain.setupElevationDraw(Pe,V),V.draw(y,z.LINES,gr.disabled,Lr.disabled,y.colorModeForRenderPass(),Or.disabled,k2(ze,U,Pe,Ie.getProjection()),u.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,null,U.zoom,null,[Ve.collisionVertexBuffer,Ve.collisionVertexBufferExt]))}if(!A||!X.length)return;const ce=y.getOrCreateProgram("collisionCircle"),se=new i.cW;se.resize(4*Y),se._trim();let pe=0;for(const Te of X)for(let Re=0;Re<Te.circleArray.length/4;Re++){const Pe=4*Re,Ie=Te.circleArray[Pe+0],Oe=Te.circleArray[Pe+1],ze=Te.circleArray[Pe+2],Ve=Te.circleArray[Pe+3];se.emplace(pe++,Ie,Oe,ze,Ve,0),se.emplace(pe++,Ie,Oe,ze,Ve,1),se.emplace(pe++,Ie,Oe,ze,Ve,2),se.emplace(pe++,Ie,Oe,ze,Ve,3)}(!sg||sg.length<2*Y)&&(sg=function(Te){const Re=2*Te,Pe=new i.aV;Pe.resize(Re),Pe._trim();for(let Ie=0;Ie<Re;Ie++){const Oe=6*Ie;Pe.uint16[Oe+0]=4*Ie+0,Pe.uint16[Oe+1]=4*Ie+1,Pe.uint16[Oe+2]=4*Ie+2,Pe.uint16[Oe+3]=4*Ie+2,Pe.uint16[Oe+4]=4*Ie+3,Pe.uint16[Oe+5]=4*Ie+0}return Pe}(Y));const me=L.createIndexBuffer(sg,!0),be=L.createVertexBuffer(se,i.cX.members,!0);for(const Te of X){const Re={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Ee=U).getCameraToCenterDistance(Te.projection),u_viewport_size:[Ee.width,Ee.height]};ce.draw(y,z.TRIANGLES,gr.disabled,Lr.disabled,y.colorModeForRenderPass(),Or.disabled,Re,u.id,be,me,i.b8.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,U.zoom)}var Ee;be.destroy(),me.destroy()}const Bf=i.ad.mat4.create();function Nv(y){const s=y._camera.getWorldToCamera(y.worldSize,1),u=i.ad.mat4.multiply([],s,y.globeMatrix);i.ad.mat4.invert(u,u);const g=[0,0,0],x=[0,1,0,0];return i.ad.vec4.transformMat4(x,x,u),g[0]=x[0],g[1]=x[1],g[2]=x[2],i.ad.vec3.normalize(g,g),g}function z2({width:y,height:s,anchor:u,textOffset:g,textScale:x},S){const{horizontalAlign:A,verticalAlign:L}=i.bD(u),z=-(A-.5)*y,U=-(L-.5)*s,V=i.bC(u,g);return new i.P((z/x+V[0])*S,(U/x+V[1])*S)}function Js(y,s,u,g,x,S,A,L,z,U,V){const X=y.text.placedSymbolArray,Y=y.text.dynamicLayoutVertexArray,re=y.icon.dynamicLayoutVertexArray,ce={},se=y.getProjection(),pe=ws(L,se,S),me=S.elevation,be=se.upVectorScale(L.canonical,S.center.lat,S.worldSize).metersToTile;Y.clear();for(let Ee=0;Ee<X.length;Ee++){const Te=X.get(Ee),{tileAnchorX:Re,tileAnchorY:Pe,numGlyphs:Ie}=Te,Oe=Te.hidden||!Te.crossTileID||y.allowVerticalPlacement&&!Te.placedOrientation?null:g[Te.crossTileID];if(Oe){let ze=0,Ve=0,dt=0;if(me){const yt=me?me.getAtTileOffset(L,Re,Pe):0,[Et,ht,Ct]=se.upVector(L.canonical,Re,Pe);ze=yt*Et*be,Ve=yt*ht*be,dt=yt*Ct*be}let[rt,St,Tt,Dt]=Ol(Te.projectedAnchorX+ze,Te.projectedAnchorY+Ve,Te.projectedAnchorZ+dt,u?pe:A);const et=wf(S.getCameraToCenterDistance(se),Dt);let wt=x.evaluateSizeForFeature(y.textSizeData,U,Te)*et/i.bw;u&&(wt*=y.tilePixelRatio/z);const Ke=z2(Oe,wt);u?({x:rt,y:St,z:Tt}=se.projectTilePoint(Re+Ke.x,Pe+Ke.y,L.canonical),[rt,St,Tt]=Ol(rt+ze,St+Ve,Tt+dt,A)):(s&&Ke._rotate(-S.angle),rt+=Ke.x,St+=Ke.y,Tt=0);const bt=y.allowVerticalPlacement&&Te.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let yt=0;yt<Ie;yt++)i.bt(Y,rt,St,Tt,bt);V&&Te.associatedIconIndex>=0&&(ce[Te.associatedIconIndex]={x:rt,y:St,z:Tt,angle:bt})}else kl(Ie,Y)}if(V){re.clear();const Ee=y.icon.placedSymbolArray;for(let Te=0;Te<Ee.length;Te++){const Re=Ee.get(Te),{numGlyphs:Pe}=Re,Ie=ce[Te];if(Re.hidden||!Ie)kl(Pe,re);else{const{x:Oe,y:ze,z:Ve,angle:dt}=Ie;for(let rt=0;rt<Pe;rt++)i.bt(re,Oe,ze,Ve,dt)}}y.icon.dynamicLayoutVertexBuffer.updateData(re)}y.text.dynamicLayoutVertexBuffer.updateData(Y)}function Hn(y,s,u,g,x,S,A={}){const L=u.paint.get("icon-translate"),z=u.paint.get("text-translate"),U=u.paint.get("icon-translate-anchor"),V=u.paint.get("text-translate-anchor"),X=u.layout.get("icon-rotation-alignment"),Y=u.layout.get("text-rotation-alignment"),re=u.layout.get("icon-pitch-alignment"),ce=u.layout.get("text-pitch-alignment"),se=u.layout.get("icon-keep-upright"),pe=u.layout.get("text-keep-upright"),me=u.paint.get("icon-color-saturation"),be=u.paint.get("icon-color-contrast"),Ee=u.paint.get("icon-color-brightness-min"),Te=u.paint.get("icon-color-brightness-max"),Re=u.layout.get("symbol-elevation-reference")==="sea",Pe=y.context,Ie=Pe.gl,Oe=y.transform,ze=X==="map",Ve=Y==="map",dt=re==="map",rt=ce==="map",St=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Tt=!1;const Dt=y.depthModeForSublayer(0,gr.ReadOnly),et=[i.av(Oe.center.lng),i.aC(Oe.center.lat)],wt=u.layout.get("text-variable-anchor"),Ke=Oe.projection.name==="globe",bt=[],yt=[0,-1,0];for(const Et of g){const ht=s.getTile(Et),Ct=ht.getBucket(u);if(!Ct||Ct.projection.name==="mercator"&&Ke||Ct.fullyClipped)continue;const Gt=Ct.projection.name==="globe",qt=Gt?i.ag(Oe.zoom):0,Zt=ws(Et,Ct.getProjection(),Oe),sr=Oe.calculatePixelsToTileUnitsMatrix(ht),kr=wt&&Ct.hasTextData(),xr=Ct.hasIconTextFit()&&kr&&Ct.hasIconData(),Pr=Ct.getProjection().createInversionMatrix(Oe,Et.canonical),Ar=kn=>{Oe.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||y.terrain)&&(kn.push("DEPTH_D24"),kn.push("DEPTH_OCCLUSION"))},nn=()=>{const kn=ze&&u.layout.get("symbol-placement")!=="point",mn=[];Ar(mn);const Mi=kn||xr,Yi=u.paint.get("icon-image-cross-fade").constantOr(0);y.terrainRenderModeElevated()&&dt&&mn.push("PITCH_WITH_MAP_TERRAIN"),Gt&&(mn.push("PROJECTION_GLOBE_VIEW"),Mi&&mn.push("PROJECTED_POS_ON_VIEWPORT")),Yi>0&&mn.push("ICON_TRANSITION"),Ct.icon.zOffsetVertexBuffer&&mn.push("Z_OFFSET"),me===0&&be===0&&Ee===0&&Te===1||mn.push("COLOR_ADJUSTMENT"),Ct.sdfIcons&&mn.push("RENDER_SDF");const yo=Ct.icon.programConfigurations.get(u.id),To=y.getOrCreateProgram("symbol",{config:yo,defines:mn}),Cs=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],pa=Ct.iconSizeData,hn=i.bp(pa,Oe.zoom),pi=dt||Oe.pitch!==0,Sn=Vc(Zt,ht.tileID.canonical,dt,ze,Oe,Ct.getProjection(),sr),$n=Fi(Zt,ht.tileID.canonical,dt,ze,Oe,Ct.getProjection(),sr),Zo=y.translatePosMatrix($n,ht,L,U,!0),si=y.translatePosMatrix(Zt,ht,L,U),vo=Mi?Bf:Sn,pc=ze&&!dt&&!kn;let rs=yt;!Ke&&!Oe.mercatorFromTransition||ze||(rs=Nv(Oe));const tl=Gt?rs:yt,Va=u.getColorAdjustmentMatrix(me,be,Ee,Te),rl=Rv(pa.kind,hn,pc,dt,y,si,vo,Zo,Re,!1,Cs,[0,0],!0,Et,qt,et,Pr,tl,Ct.getProjection(),Va,Yi),ns=ht.imageAtlasTexture?ht.imageAtlasTexture:null,ru=u.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear,mc=Ct.sdfIcons||y.options.rotating||y.options.zooming||ru||pi?Ie.LINEAR:Ie.NEAREST,nu=Ct.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,R1=y.terrain&&dt&&kn?i.ad.mat4.invert(i.ad.mat4.create(),Sn):Bf;if(kn&&Ct.icon){const ep=Oe.elevation,e_=ep?ep.getAtTileOffsetFunc(Et,Oe.center.lat,Oe.worldSize,Ct.getProjection()):null,D1=Qo(Zt,ht.tileID.canonical,dt,ze,Oe,Ct.getProjection(),sr);Sf(Ct,Zt,y,!1,D1,$n,dt,se,e_,Et)}return{program:To,buffers:Ct.icon,uniformValues:rl,atlasTexture:ns,atlasTextureIcon:null,atlasInterpolation:mc,atlasInterpolationIcon:null,isSDF:Ct.sdfIcons,hasHalo:nu,tile:ht,labelPlaneMatrixInv:R1}},wn=()=>{const kn=Ve&&u.layout.get("symbol-placement")!=="point",mn=[],Mi=kn||wt||xr;y.terrainRenderModeElevated()&&rt&&mn.push("PITCH_WITH_MAP_TERRAIN"),Gt&&(mn.push("PROJECTION_GLOBE_VIEW"),Mi&&mn.push("PROJECTED_POS_ON_VIEWPORT")),Ct.text.zOffsetVertexBuffer&&mn.push("Z_OFFSET"),Ct.iconsInText&&mn.push("RENDER_TEXT_AND_SYMBOL"),mn.push("RENDER_SDF"),Ar(mn);const Yi=Ct.text.programConfigurations.get(u.id),yo=y.getOrCreateProgram("symbol",{config:Yi,defines:mn});let To,Cs=[0,0],pa=null;const hn=Ct.textSizeData;Ct.iconsInText&&(Cs=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],pa=ht.imageAtlasTexture?ht.imageAtlasTexture:null,To=rt||Oe.pitch!==0||y.options.rotating||y.options.zooming||hn.kind==="composite"||hn.kind==="camera"?Ie.LINEAR:Ie.NEAREST);const pi=ht.glyphAtlasTexture?ht.glyphAtlasTexture.size:[0,0],Sn=u.layout.get("text-size-scale-range"),$n=i.ay(y.scaleFactor,Sn[0],Sn[1]),Zo=i.bp(hn,Oe.zoom,$n),si=Vc(Zt,ht.tileID.canonical,rt,Ve,Oe,Ct.getProjection(),sr),vo=Fi(Zt,ht.tileID.canonical,rt,Ve,Oe,Ct.getProjection(),sr),pc=y.translatePosMatrix(vo,ht,z,V,!0),rs=y.translatePosMatrix(Zt,ht,z,V),tl=Mi?Bf:si,Va=Ve&&!rt&&!kn;let rl=yt;!Ke&&!Oe.mercatorFromTransition||Ve||(rl=Nv(Oe));const ns=Rv(hn.kind,Zo,Va,rt,y,rs,tl,pc,Re,!0,pi,Cs,!0,Et,qt,et,Pr,Gt?rl:yt,Ct.getProjection(),null,null,$n),ru=ht.glyphAtlasTexture?ht.glyphAtlasTexture:null,mc=Ie.LINEAR,nu=u.paint.get("text-halo-width").constantOr(1)!==0,R1=y.terrain&&rt&&kn?i.ad.mat4.invert(i.ad.mat4.create(),si):Bf;if(kn&&Ct.text){const ep=Oe.elevation,e_=ep?ep.getAtTileOffsetFunc(Et,Oe.center.lat,Oe.worldSize,Ct.getProjection()):null,D1=Qo(Zt,ht.tileID.canonical,rt,Ve,Oe,Ct.getProjection(),sr);Sf(Ct,Zt,y,!0,D1,vo,rt,pe,e_,Et)}return{program:yo,buffers:Ct.text,uniformValues:ns,atlasTexture:ru,atlasTextureIcon:pa,atlasInterpolation:mc,atlasInterpolationIcon:To,isSDF:!0,hasHalo:nu,tile:ht,labelPlaneMatrixInv:R1}},Kn=Ct.icon.segments.get().length,Yr=Ct.text.segments.get().length,fi=Kn&&!A.onlyText?nn():null,Nr=Yr&&!A.onlyIcons?wn():null,lr=u.paint.get("icon-opacity").constantOr(1),sn=u.paint.get("text-opacity").constantOr(1);if(St&&Ct.canOverlap){Tt=!0;const kn=lr&&!A.onlyText?Ct.icon.segments.get():[],mn=sn&&!A.onlyIcons?Ct.text.segments.get():[];for(const Mi of kn)bt.push({segments:new i.b8([Mi]),sortKey:Mi.sortKey,state:fi});for(const Mi of mn)bt.push({segments:new i.b8([Mi]),sortKey:Mi.sortKey,state:Nr})}else A.onlyText||bt.push({segments:lr?Ct.icon.segments:new i.b8([]),sortKey:0,state:fi}),A.onlyIcons||bt.push({segments:sn?Ct.text.segments:new i.b8([]),sortKey:0,state:Nr})}Tt&&bt.sort((Et,ht)=>Et.sortKey-ht.sortKey);for(const Et of bt){const ht=Et.state;if(ht)if(y.terrain?y.terrain.setupElevationDraw(ht.tile,ht.program,{useDepthForOcclusion:Oe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ht.labelPlaneMatrixInv}):y.setupDepthForOcclusion(Oe.depthOcclusionForSymbolsAndCircles,ht.program),Pe.activeTexture.set(Ie.TEXTURE0),ht.atlasTexture&&ht.atlasTexture.bind(ht.atlasInterpolation,Ie.CLAMP_TO_EDGE,!0),ht.atlasTextureIcon&&(Pe.activeTexture.set(Ie.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,Ie.CLAMP_TO_EDGE,!0)),y.uploadCommonLightUniforms(y.context,ht.program),ht.hasHalo){const Ct=ht.uniformValues;Ct.u_is_halo=1,$f(ht.buffers,Et.segments,u,y,ht.program,Dt,x,S,Ct,2),Ct.u_is_halo=0}else{if(ht.isSDF){const Ct=ht.uniformValues;ht.hasHalo&&(Ct.u_is_halo=1,$f(ht.buffers,Et.segments,u,y,ht.program,Dt,x,S,Ct,1)),Ct.u_is_halo=0}$f(ht.buffers,Et.segments,u,y,ht.program,Dt,x,S,ht.uniformValues,1)}}}function $f(y,s,u,g,x,S,A,L,z,U){const V=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.iconTransitioningVertexBuffer,y.globeExtVertexBuffer,y.zOffsetVertexBuffer];x.draw(g,g.context.gl.TRIANGLES,S,A,L,Or.disabled,z,u.id,y.layoutVertexBuffer,y.indexBuffer,s,u.paint,g.transform.zoom,y.programConfigurations.get(u.id),V,U)}function l1(y,s){const u=1<<y.canonical.z,g=(s.x*u-y.canonical.x-y.wrap*u)*i.ai,x=(s.y*u-y.canonical.y)*i.ai,S=i.d5(s.z,s.y);return i.ad.vec3.fromValues(g,x,S)}function c1(y,s,u,g,x){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const S=y.context.gl,A=new gr(y.context.gl.LEQUAL,gr.ReadWrite,y.depthRangeFor3D),L=new gr(y.context.gl.GREATER,gr.ReadWrite,y.depthRangeFor3D),z=function(re){const ce=i.c4(re.pitch);let se=.01;return re.isOrthographic&&(se=i.ah(1e-4,se,i.c9(ce>=$t?1:ce/$t))),2*se}(y.transform),U=y.transform.getFreeCameraOptions().position,V="elevatedStructuresDepthReconstruct",X=y.getOrCreateProgram(V,{defines:["DEPTH_RECONSTRUCTION"]}),Y=y.getOrCreateProgram(V);for(const re of g){const ce=s.getTile(re),se=ce.getBucket(u);if(!se)continue;const pe=se.elevatedStructures;if(!pe)continue;const me=se.elevationBufferData.heightRange,be=l1(re.toUnwrapped(),U),Ee=y.translatePosMatrix(re.projMatrix,ce,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let Te,Re,Pe,Ie;if(x==="initialize"){if(!me||me.min>=1||pe.depthSegments.segments[0].primitiveLength===0)continue;Te=ag(Ee,be,z,1,0),Re=A,Pe=pe.depthSegments,Ie=X}else if(x==="reset"){if(!me||me.min>=0||pe.maskSegments.segments[0].primitiveLength===0)continue;Te=ag(Ee,be,0,0,1),Re=L,Pe=pe.maskSegments,Ie=X}else if(x==="geometry"){if(pe.depthSegments.segments[0].primitiveLength===0)continue;Te=ag(Ee,be,z,1,0),Re=A,Pe=pe.depthSegments,Ie=Y}Ie.draw(y,S.TRIANGLES,Re,Lr.disabled,Jr.disabled,Or.disabled,Te,u.id,pe.vertexBuffer,pe.indexBuffer,Pe,u.paint,y.transform.zoom)}}function zv(y,s,u){const{painter:g,sourceCache:x,layer:S,coords:A,colorMode:L,elevationType:z,terrainEnabled:U,pass:V}=y,X=g.context.gl,Y=S.paint.get("fill-pattern");let re=z;z!=="road"||s&&!U||(re="none");const ce=re==="road",se=new gr(g.context.gl.LEQUAL,gr.ReadWrite,g.depthRangeFor3D),pe=Y&&Y.constantOr(1),me=(be,Ee)=>{let Te,Re,Pe,Ie,Oe;Ee?(Re=pe&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Te=X.LINES):(Re=pe?"fillPattern":"fill",Te=X.TRIANGLES);for(const ze of A){const Ve=x.getTile(ze);if(pe&&!Ve.patternsLoaded())continue;const dt=Ve.getBucket(S);if(!dt)continue;const rt=s?dt.elevationBufferData:dt.bufferData;if(rt.isEmpty())continue;g.prepareDrawTile();const St=rt.programConfigurations.get(S.id),Tt=g.isTileAffectedByFog(ze),Dt=[],et=[];ce&&(Dt.push("ELEVATED_ROADS"),et.push(rt.elevatedLayoutVertexBuffer));const wt=g.getOrCreateProgram(Re,{config:St,overrideFog:Tt,defines:Dt});pe&&(g.context.activeTexture.set(X.TEXTURE0),Ve.imageAtlasTexture&&Ve.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),St.updatePaintBuffers());const Ke=Y.constantOr(null);if(Ke&&Ve.imageAtlas){const Et=Ve.imageAtlas,ht=i.d0.from(Ke).getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Ct=Et.patternPositions.get(ht);Ct&&St.setConstantPatternPositions(Ct)}const bt=g.translatePosMatrix(ze.projMatrix,Ve,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor")),yt=S.paint.get("fill-emissive-strength");if(Ee){Ie=rt.lineIndexBuffer,Oe=rt.lineSegments;const Et=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[X.drawingBufferWidth,X.drawingBufferHeight];Pe=Re==="fillOutlinePattern"&&pe?Ov(bt,yt,g,Ve,Et):Iv(bt,yt,Et)}else Ie=rt.indexBuffer,Oe=rt.triangleSegments,Pe=pe?Qb(bt,yt,g,Ve):jf(bt,yt);g.uploadCommonUniforms(g.context,wt,ze.toUnwrapped()),wt.draw(g,Te,re!=="none"?se:be,u||g.stencilModeForClipping(ze),L,Or.disabled,Pe,S.id,rt.layoutVertexBuffer,Ie,Oe,S.paint,g.transform.zoom,St,et)}};g.renderPass===V&&me(g.depthModeForSublayer(1,g.renderPass==="opaque"?gr.ReadWrite:gr.ReadOnly),!1),re==="none"&&g.renderPass==="translucent"&&S.paint.get("fill-antialias")&&me(g.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,gr.ReadOnly),!0)}function lg(y,s,u,g,x,S,A,L){u.resetLayerRenderingStats(y);const z=y.context,U=z.gl,V=y.transform,X=u.paint.get("fill-extrusion-pattern"),Y=X.constantOr(1),re=u.paint.get("fill-extrusion-opacity"),ce=y.style.enable3dLights(),se=u.paint.get(ce&&!Y?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),pe=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),se],me=u.layout.get("fill-extrusion-edge-radius"),be=me>0&&!u.paint.get("fill-extrusion-rounded-roof"),Ee=be?0:me,Te=V.projection.name==="globe"?i.d6():0,Re=V.projection.name==="globe",Pe=Re?i.ag(V.zoom):0,Ie=[i.av(V.center.lng),i.aC(V.center.lat)],Oe=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ze=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(Oe?null:u.lut).toArray01().slice(0,3),Ve=u.paint.get("fill-extrusion-flood-light-intensity"),dt=u.paint.get("fill-extrusion-vertical-scale"),rt=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,St=u.paint.get("fill-extrusion-height-alignment"),Tt=u.paint.get("fill-extrusion-base-alignment"),Dt=Zc(y,u.paint.get("fill-extrusion-cutoff-fade-range")),et=[];let wt;Re&&et.push("PROJECTION_GLOBE_VIEW"),pe[0]>0&&et.push("FAUX_AO"),be&&et.push("ZERO_ROOF_RADIUS"),L&&et.push("HAS_CENTROID"),Ve>0&&et.push("FLOOD_LIGHT"),Dt.shouldRenderCutoff&&et.push("RENDER_CUTOFF"),rt&&et.push("RENDER_WALL_MODE");const Ke=y.renderPass==="shadow",bt=y.shadowRenderer,yt=Ke&&!!bt;y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!0);let Et=[0,0,0];if(bt){const Gt=y.style.directionalLight,qt=y.style.ambientLight;Gt&&qt&&(Et=Pf(y.style,Gt,qt)),Ke||(et.push("RENDER_SHADOWS","DEPTH_TEXTURE"),bt.useNormalOffset&&et.push("NORMAL_OFFSET")),wt=et.concat(["SHADOWS_SINGLE_CASCADE"])}const ht=yt?"fillExtrusionDepth":Y?"fillExtrusionPattern":"fillExtrusion",Ct=u.getLayerRenderingStats();for(const Gt of g){const qt=s.getTile(Gt),Zt=qt.getBucket(u);if(!Zt||Zt.projection.name!==V.projection.name)continue;let sr=!1;bt&&(sr=bt.getMaxCascadeForTile(Gt.toUnwrapped())===0);const kr=y.isTileAffectedByFog(Gt),xr=Zt.programConfigurations.get(u.id),Pr=y.getOrCreateProgram(ht,{config:xr,defines:sr?wt:et,overrideFog:kr});if(y.terrain&&y.terrain.setupElevationDraw(qt,Pr,{useMeterToDem:!0}),!Zt.centroidVertexBuffer){const Nr=Pr.attributes.a_centroid_pos;Nr!==void 0&&U.vertexAttrib2f(Nr,0,0)}!Ke&&bt&&bt.setupShadows(qt.tileID.toUnwrapped(),Pr,"vector-tile",qt.tileID.overscaledZ),Y&&(y.context.activeTexture.set(U.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),xr.updatePaintBuffers());const Ar=X.constantOr(null);if(Ar&&qt.imageAtlas){const Nr=qt.imageAtlas,lr=i.d0.from(Ar).getPrimary().scaleSelf(i.q.devicePixelRatio),sn=Nr.patternPositions.get(lr.toString());sn&&xr.setConstantPatternPositions(sn)}const nn=u.paint.get("fill-extrusion-vertical-gradient"),wn=1/Zt.tileToMeter;let Kn;if(Ke&&bt){if(Gf(qt.tileID,Zt,y))continue;const Nr=bt.calculateShadowPassMatrixFromTile(qt.tileID.toUnwrapped());Kn=zf(Nr,Ee,wn,dt,St,Tt)}else{const Nr=y.translatePosMatrix(Gt.expandedProjMatrix,qt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),lr=V.projection.createInversionMatrix(V,Gt.canonical);Kn=Y?Jb(Nr,y,nn,re,pe,Ee,wn,Gt,qt,Te,St,Tt,Pe,Ie,lr,ze,dt):Pv(Nr,y,nn,re,pe,Ee,wn,Gt,Te,St,Tt,Pe,Ie,lr,ze,dt,Ve,Et)}y.uploadCommonUniforms(z,Pr,Gt.toUnwrapped(),null,Dt);let Yr=Zt.segments;if(V.projection.name==="mercator"&&!Ke&&(Yr=Zt.getVisibleSegments(qt.tileID,y.terrain,y.transform.getFrustum(0)),!Yr.get().length))continue;if(Ct)if(Ke)for(const Nr of Yr.get())Ct.numRenderedVerticesInShadowPass+=Nr.primitiveLength;else for(const Nr of Yr.get())Ct.numRenderedVerticesInTransparentPass+=Nr.primitiveLength;const fi=[];(y.terrain||L)&&fi.push(Zt.centroidVertexBuffer),Re&&fi.push(Zt.layoutVertexExtBuffer),rt&&fi.push(Zt.wallVertexBuffer),Pr.draw(y,z.gl.TRIANGLES,x,S,A,Or.backCCW,Kn,u.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Yr,u.paint,y.transform.zoom,xr,fi)}y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!1)}function Uf(y,s,u,g,x,S,A,L,z,U,V,X,Y,re,ce,se,pe,me,be){const Ee=y.context,Te=Ee.gl,Re=y.transform,Pe=y.transform.zoom,Ie=[],Oe=Zc(y,u.paint.get("fill-extrusion-cutoff-fade-range"));U==="clear"?(Ie.push("CLEAR_SUBPASS"),be&&(Ie.push("CLEAR_FROM_TEXTURE"),Ee.activeTexture.set(Te.TEXTURE0),be.bind(Te.LINEAR,Te.CLAMP_TO_EDGE))):U==="sdf"&&Ie.push("SDF_SUBPASS"),pe&&Ie.push("HAS_CENTROID"),Oe.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF");const ze=u.layout.get("fill-extrusion-edge-radius"),Ve=(dt,rt,St,Tt,Dt)=>{const et=rt.programConfigurations.get(u.id),wt=y.isTileAffectedByFog(dt),Ke=y.getOrCreateProgram("fillExtrusionGroundEffect",{config:et,defines:Ie,overrideFog:wt}),bt=((Et,ht,Ct,Gt,qt,Zt,sr,kr,xr,Pr,Ar)=>({u_matrix:ht,u_opacity:Ct,u_ao_pass:Gt?1:0,u_meter_to_tile:qt,u_ao:Zt,u_flood_light_intensity:sr,u_flood_light_color:kr,u_attenuation:xr,u_edge_radius:Pr,u_fb:0,u_fb_size:Ar,u_dynamic_offset:1}))(0,Tt,V,z,Dt,[X,Y*Dt],re,ce,se,Pe>=17?0:ze*Dt,be?be.size[0]:0),yt=[];pe&&yt.push(rt.hiddenByLandmarkVertexBuffer),y.uploadCommonUniforms(Ee,Ke,dt.toUnwrapped(),null,Oe),Ke.draw(y,Ee.gl.TRIANGLES,x,S,A,L,bt,u.id,rt.vertexBuffer,rt.indexBuffer,St,u.paint,Pe,et,yt)};for(const dt of g){const rt=s.getTile(dt),St=rt.getBucket(u);if(!St||St.projection.name!==Re.projection.name||!St.groundEffect||St.groundEffect&&!St.groundEffect.hasData())continue;const Tt=St.groundEffect,Dt=1/St.tileToMeter;{const et=y.translatePosMatrix(dt.projMatrix,rt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),wt=Tt.getDefaultSegment();Ve(dt,Tt,wt,et,Dt)}if(me)for(let et=0;et<4;et++){const wt=i.d7[et](dt),Ke=s.getTile(wt);if(!Ke)continue;const bt=Ke.getBucket(u);if(!bt||bt.projection.name!==Re.projection.name||!bt.groundEffect||bt.groundEffect&&!bt.groundEffect.hasData())continue;const yt=bt.groundEffect;let Et,ht;et===0?(Et=[-i.ai,0,0],ht=1):et===1?(Et=[i.ai,0,0],ht=0):et===2?(Et=[0,-i.ai,0],ht=3):(Et=[0,i.ai,0],ht=2);const Ct=yt.regionSegments[ht];if(!Ct)continue;const Gt=new Float32Array(16);i.ad.mat4.translate(Gt,dt.projMatrix,Et),Ve(dt,yt,Ct,y.translatePosMatrix(Gt,rt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Dt)}}}function Vf(y,s,u,g,x,S,A){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const L=S?S.findDEMTileFor(u):null;if(!(L&&L.dem||A))return;S&&L&&L.dem&&g.selfDEMTileTimestamp!==L.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=L.dem._timestamp);const z=me=>new i.P(Math.ceil((me+i.da)*i.db),0),U=me=>{const be=s.getSource().minzoom,Ee=Re=>{const Pe=s.getTileByID(Re);if(Pe&&Pe.hasData())return Pe.getBucket(x)},Te=[0,-1,1];for(const Re of Te){if(me.overscaledZ+Re<be)continue;const Pe=Ee(me.calculateScaledKey(me.overscaledZ+Re));if(Pe)return Pe}},V=[0,0,0],X=(me,be)=>(V[0]=Math.min(me.min.y,be.min.y),V[1]=Math.max(me.max.y,be.max.y),V[2]=i.ai-be.min.x>me.max.x?be.min.x-i.ai:me.max.x,V),Y=(me,be)=>(V[0]=Math.min(me.min.x,be.min.x),V[1]=Math.max(me.max.x,be.max.x),V[2]=i.ai-be.min.y>me.max.y?be.min.y-i.ai:me.max.y,V),re=[(me,be)=>X(me,be),(me,be)=>X(be,me),(me,be)=>Y(me,be),(me,be)=>Y(be,me)],ce=(me,be,Ee,Te,Re,Pe,Ie)=>{if(!S)return 0;const Oe=[[Pe?Ee:me,Pe?me:Ee,0],[Pe?Ee:be,Pe?be:Ee,0]],ze=Ie<0?i.ai+Ie:Ie,Ve=[Pe?ze:(me+be)/2,Pe?(me+be)/2:ze,0];return Ee===0&&Ie<0||Ee!==0&&Ie>0?S.getForTilePoints(Re,[Ve],!0,Te):Oe.push(Ve),S.getForTilePoints(u,Oe,!0,L),Math.max(Oe[0][2],Oe[1][2],Ve[2])/S.exaggeration()};for(let me=0;me<4;me++){const be=g.borderFeatureIndices[me];if(be.length===0)continue;const Ee=i.d7[me](u),Te=U(Ee);if(!(Te&&Te instanceof i.d8))continue;const Re=S?S.findDEMTileFor(Ee):null;if(!(Re&&Re.dem||A)||(S&&Re&&Re.dem&&g.borderDEMTileTimestamp[me]!==Re.dem._timestamp&&(g.borderDoneWithNeighborZ[me]=-1,g.borderDEMTileTimestamp[me]=Re.dem._timestamp),g.borderDoneWithNeighborZ[me]===Te.canonical.z))continue;Te.centroidVertexArray.length===0&&Te.createCentroidsBuffer();const Pe=(me<2?1:5)-me,Ie=Te.borderDoneWithNeighborZ[Pe]!==g.canonical.z,Oe=Te.borderFeatureIndices[Pe];let ze=0;if(g.canonical.z!==Te.canonical.z){for(const Ve of be)g.showCentroid(g.featuresOnBorder[Ve]);if(Ie)for(const Ve of Oe)Te.showCentroid(Te.featuresOnBorder[Ve]);g.borderDoneWithNeighborZ[me]=Te.canonical.z,Te.borderDoneWithNeighborZ[Pe]=g.canonical.z}for(const Ve of be){const dt=g.featuresOnBorder[Ve],rt=g.centroidData[dt.centroidDataIndex],St=dt.borders[me];let Tt;for(;ze<Oe.length;){Tt=Te.featuresOnBorder[Oe[ze]];const Dt=Tt.borders[Pe];if(Dt[1]>St[0]+3||Dt[0]>St[0]-3)break;Te.showCentroid(Tt),ze++}if(Tt&&ze<Oe.length){const Dt=ze;let et=0;for(;!(Tt.borders[Pe][0]>St[1]-3)&&(et++,++ze!==Oe.length);)Tt=Te.featuresOnBorder[Oe[ze]];Tt=Te.featuresOnBorder[Oe[Dt]];let wt=!1;if(et>=1){const yt=Tt.borders[Pe];Math.abs(St[0]-yt[0])<3&&Math.abs(St[1]-yt[1])<3&&(et=1,wt=!0,ze=Dt+1)}else if(et===0){g.showCentroid(dt);continue}const Ke=Te.centroidData[Tt.centroidDataIndex];A&&wt&&(((se=rt).flags|(pe=Ke).flags)&i.d9?(se.flags|=i.d9,pe.flags|=i.d9):(se.flags&=~i.d9,pe.flags&=~i.d9));const bt=dt.intersectsCount()>1||Tt.intersectsCount()>1;if(et>1)ze=Dt,rt.centroidXY=Ke.centroidXY=new i.P(0,0);else if(Re&&Re.dem&&!bt){const yt=re[me](rt,Ke),Et=me%2?i.ai-1:0,ht=ce(yt[0],Math.min(i.ai-1,yt[1]),Et,Re,Ee,me<2,yt[2]);rt.centroidXY=Ke.centroidXY=z(ht)}else bt?rt.centroidXY=Ke.centroidXY=new i.P(0,0):(rt.centroidXY=g.encodeBorderCentroid(dt),Ke.centroidXY=Te.encodeBorderCentroid(Tt));g.writeCentroidToBuffer(rt),Te.writeCentroidToBuffer(Ke)}else g.showCentroid(dt)}g.borderDoneWithNeighborZ[me]=Te.canonical.z,Te.borderDoneWithNeighborZ[Pe]=g.canonical.z}var se,pe;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(y)}const Wf=[1,0,0],jt=[0,1,0],Jt=[0,0,1];function Gf(y,s,u){const g=u.transform,x=u.shadowRenderer;if(!x)return!0;const S=y.toUnwrapped(),A=g.tileSize*x._cascades[u.currentShadowCascade].scale;let L=s.maxHeight;if(g.elevation){const se=g.elevation.getMinMaxForTile(y);se&&(L+=se.max)}const z=[...x.shadowDirection];z[2]=-z[2];const U=x.computeSimplifiedTileShadowVolume(S,L,A,z);if(!U)return!1;const V=[Wf,jt,Jt,z,[z[0],0,z[2]],[0,z[1],z[2]]],X=g.projection.name==="globe",Y=g.scaleZoom(A),re=i.bR.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,Y,!X),ce=x.getCurrentCascadeFrustum();return re.intersectsPrecise(U.vertices,U.planes,V)===0||ce.intersectsPrecise(U.vertices,U.planes,V)===0}function Ei(y){return[y[0]*i.dc,y[1]*i.dc,y[2]*i.dc,0]}function at(y,s,u,g,x,S,A,L,z){const U=g.getSource(),V=u.globeSharedBuffers;if(!V)return;let X,Y,re;if(s&&(X=g.getTile(s)),U instanceof i.aK?(Y=U.texture,re=i.cJ(0,0,u.transform)):X&&s&&(Y=X.texture,re=i.cJ(s.canonical.z,s.canonical.x,u.transform)),!Y||!re)return;y||(re=i.ad.mat4.scale(i.ad.mat4.create(),re,[1,-1,1]));const ce=u.context,se=ce.gl,pe=x.paint.get("raster-resampling")==="nearest"?se.NEAREST:se.LINEAR,me=u.colorModeForDrapableLayerRenderPass(S),be=A.defines;be.push("GLOBE_POLES");const Ee=new gr(se.LEQUAL,gr.ReadWrite,u.depthRangeFor3D),Te=Float32Array.from(u.transform.expandedFarZProjMatrix),Re=Float32Array.from(i.bc(i.cI(new i.bT(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),ce.activeTexture.set(se.TEXTURE0),Y.bind(pe,se.CLAMP_TO_EDGE),ce.activeTexture.set(se.TEXTURE1),Y.bind(pe,se.CLAMP_TO_EDGE),"useMipmap"in Y&&ce.extTextureFilterAnisotropic&&u.transform.pitch>20&&se.texParameterf(se.TEXTURE_2D,ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ce.extTextureFilterAnisotropicMax);const[Pe,Ie,Oe,ze]=s?V.getPoleBuffers(s.canonical.z,!1):V.getPoleBuffers(0,!0),Ve=x.paint.get("raster-elevation");let dt;y?(dt=Pe,u.renderDefaultNorthPole=Ve!==0):(dt=Ie,u.renderDefaultSouthPole=Ve!==0);const rt=Ei(A.mix),St=((Dt,et,wt,Ke,bt,yt,Et,ht,Ct,Gt,qt,Zt,sr)=>t1(Dt,et,wt,new Float32Array(16),new Float32Array(9),[0,0],Ke,[0,0],[0,0,0,0],1,{opacity:1,mix:0},yt,[0,0],ht,2,Gt,qt,Zt,1,0,sr))(Te,Re,re,i.ag(u.transform.zoom),0,x,0,Ve,0,rt,A.offset,A.range,S),Tt=u.getOrCreateProgram("raster",{defines:be});u.uploadCommonUniforms(ce,Tt,null),Tt.draw(u,se.TRIANGLES,Ee,z,me,L,St,x.id,dt,Oe,ze)}function j2(y){const s=y._nearZ,u=y.projection.farthestPixelDistance(y),g=u-s,x=.2*y.height,S=s+x;return[s,u,(S-x-s)/g,(S-s)/g]}function jv(y,s,u,g){if(y)return s instanceof $c&&y instanceof $a?s.getTextureDescriptor(y,u,!0):{texture:y.texture,mix:Ei(g.mix),offset:g.offset,buffer:0,tileSize:1}}var u1=i.dd([{name:"a_index",type:"Int16",components:1}]);class d1{constructor(s,u,g,x){const S={width:g[0],height:g[1],data:null},A=s.gl;this.targetColorTexture=new i.T(s,S,A.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(s,S,A.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(u,x),this.lastInvalidatedAt=0}updateParticleTexture(s,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,x=u.width*u.height;this.particleTexture0=new i.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1});const S=new i.de;S.reserve(x);for(let A=0;A<x;A++)S.emplaceBack(A);this.particleIndexBuffer=this.context.createVertexBuffer(S,u1.members,!0),this.particleSegment=i.b8.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function F2(y,s,u){if(!y)return null;const g=s.getTextureDescriptor(y,u,!0);if(!g)return null;let{texture:x,mix:S,offset:A,tileSize:L,buffer:z,format:U}=g;if(!x||!U)return null;let V=!1;return U==="uint32"&&(V=!0,S[3]=0,S=Qt(i.df,S,[0,u.paint.get("raster-particle-max-speed")]),A=e1(i.df,A,[0,u.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[z/(L+2*z),L/(L+2*z)],tileSize:L,scalarData:V,scale:S,offset:A,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[U]]}}function B2(y){const s=y._nearZ,u=y.projection.farthestPixelDistance(y),g=u-s,x=.2*y.height,S=s+x;return[s,u,(S-x-s)/g,(S-s)/g]}const qf=new i.al(1,0,0,1),ED=new i.al(0,1,0,1),AD=new i.al(0,0,1,1),$2=new i.al(1,0,1,1),Fv=new i.al(0,1,1,1);function rd(y,s,u,g,x,S,A){const L=y.context,z=y.transform,U=L.gl,V=z.projection.name==="globe",X=V?["PROJECTION_GLOBE_VIEW"]:[];let Y=i.ad.mat4.clone(u.projMatrix);if(V&&i.ag(z.zoom)>0){const rt=i.bb(u.canonical,z),St=i.dg(rt);Y=i.ad.mat4.multiply(new Float32Array(16),z.globeMatrix,St),i.ad.mat4.multiply(Y,z.projMatrix,Y)}const re=i.ad.mat4.create();re[12]+=2*x/(i.q.devicePixelRatio*z.width),re[13]+=2*S/(i.q.devicePixelRatio*z.height),i.ad.mat4.multiply(Y,re,Y);const ce=y.getOrCreateProgram("debug",{defines:X}),se=s.getTileByID(u.key);y.terrain&&y.terrain.setupElevationDraw(se,ce);const pe=gr.disabled,me=Lr.disabled,be=y.colorModeForRenderPass(),Ee="$debug";L.activeTexture.set(U.TEXTURE0),y.emptyTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),V?se._makeGlobeTileDebugBuffers(y.context,z):se._makeDebugTileBoundsBuffers(y.context,z.projection);const Te=se._tileDebugBuffer||y.debugBuffer,Re=se._tileDebugIndexBuffer||y.debugIndexBuffer,Pe=se._tileDebugSegments||y.debugSegments;if(ce.draw(y,U.LINE_STRIP,pe,me,be,Or.disabled,R2(Y,g),Ee,Te,Re,Pe,null,null,null,[se._globeTileDebugBorderBuffer]),A){const rt=se.latestRawTileData,St=Math.floor((rt&&rt.byteLength||0)/1024);let Tt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Tt+=` => ${u.overscaledZ}`),Tt+=` ${se.state}`,Tt+=` ${St}kb`,function(Dt,et){Dt.initDebugOverlayCanvas();const wt=Dt.debugOverlayCanvas,Ke=Dt.context.gl,bt=Dt.debugOverlayCanvas.getContext("2d");bt.clearRect(0,0,wt.width,wt.height),bt.shadowColor="white",bt.shadowBlur=2,bt.lineWidth=1.5,bt.strokeStyle="white",bt.textBaseline="top",bt.font="bold 36px Open Sans, sans-serif",bt.fillText(et,5,5),bt.strokeText(et,5,5),Dt.debugOverlayTexture.update(wt),Dt.debugOverlayTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE)}(y,Tt)}const Ie=s.getTile(u).tileSize,Oe=512/Math.min(Ie,512)*(u.overscaledZ/z.zoom)*.5,ze=se._tileDebugTextBuffer||y.debugBuffer,Ve=se._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,dt=se._tileDebugTextSegments||y.debugSegments;ce.draw(y,U.TRIANGLES,pe,me,Jr.alphaBlended,Or.disabled,R2(Y,i.al.transparent,Oe),Ee,ze,Ve,dt,null,null,null,[se._globeTileDebugTextBuffer])}function h1(y,s,u,g){oh(y,0,s+u/2,y.transform.width,u,g)}function f1(y,s,u,g){oh(y,s-u/2,0,u,y.transform.height,g)}function oh(y,s,u,g,x,S){const A=y.context,L=A.gl;L.enable(L.SCISSOR_TEST),L.scissor(s*i.q.devicePixelRatio,u*i.q.devicePixelRatio,g*i.q.devicePixelRatio,x*i.q.devicePixelRatio),A.clear({color:S}),L.disable(L.SCISSOR_TEST)}const Bv=i.dd([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Hf}=Bv;function Jc(y,s,u,g){y.emplaceBack(s,u,g)}class U2{constructor(s){this.vertexArray=new i.dh,this.indices=new i.aV,Jc(this.vertexArray,-1,-1,1),Jc(this.vertexArray,1,-1,1),Jc(this.vertexArray,-1,1,1),Jc(this.vertexArray,1,1,1),Jc(this.vertexArray,-1,-1,-1),Jc(this.vertexArray,1,-1,-1),Jc(this.vertexArray,-1,1,-1),Jc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Hf),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=i.b8.simpleSegment(0,0,36,12)}}function zo(y,s,u,g,x,S){const A=y.context.gl,L=s.paint.get("sky-atmosphere-color"),z=s.paint.get("sky-atmosphere-halo-color"),U=s.paint.get("sky-atmosphere-sun-intensity"),V=((X,Y,re,ce,se)=>({u_matrix_3f:X,u_sun_direction:Y,u_sun_intensity:re,u_color_tint_r:[ce.r,ce.g,ce.b,ce.a],u_color_tint_m:[se.r,se.g,se.b,se.a],u_luminance:5e-5}))(i.ad.mat3.fromMat4(i.ad.mat3.create(),g),x,U,L,z);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+S,s.skyboxTexture,0),u.draw(y,A.TRIANGLES,gr.disabled,Lr.disabled,Jr.unblended,Or.frontCW,V,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const CD=i.dd([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class cg{constructor(s){const u=new i.di;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new i.aV;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(u,CD.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=i.b8.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Qn=i.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class xn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class V2{constructor(s){this.colorModeAlphaBlendedWriteRGB=new Jr([1,Ku,1,Ku],i.al.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Jr([1,0,1,0],i.al.transparent,[!1,!1,!1,!0]),this.params=new xn,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const u=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new cg(u);const g=this.params.sizeRange,x=this.params.intensityRange,S=function(V){const X=i.dl(30),Y=[];for(let re=0;re<V;++re){const ce=2*Math.PI*X(),se=Math.acos(1-2*X())-.5*Math.PI;Y.push(i.ad.vec3.fromValues(Math.cos(se)*Math.cos(ce),Math.cos(se)*Math.sin(ce),Math.sin(se)))}return Y}(this.params.starsCount),A=i.dl(300),L=new i.dj,z=new i.aV;let U=0;for(let V=0;V<S.length;++V){const X=i.ad.vec3.scale([],S[V],200),Y=Math.max(0,1+.01*g*(1*A()-.5)),re=Math.max(0,1+.01*x*(1*A()-.5));L.emplaceBack(X[0],X[1],X[2],-1,-1,Y,re),L.emplaceBack(X[0],X[1],X[2],1,-1,Y,re),L.emplaceBack(X[0],X[1],X[2],1,1,Y,re),L.emplaceBack(X[0],X[1],X[2],-1,1,Y,re),z.emplaceBack(U+0,U+1,U+2),z.emplaceBack(U+0,U+2,U+3),U+=4}this.starsVx=u.createVertexBuffer(L,Qn.members),this.starsIdx=u.createIndexBuffer(z),this.starsSegments=i.b8.simpleSegment(0,0,L.length,z.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,u){const g=s.context,x=g.gl,S=s.transform,A=new gr(x.LEQUAL,gr.ReadOnly,[0,1]),L=i.ag(S.zoom),z=s.style.getLut(u.scope),U=u.properties.get("color-use-theme")==="none",V=u.properties.get("color").toRenderColor(U?null:z).toArray01(),X=u.properties.get("high-color-use-theme")==="none",Y=u.properties.get("high-color").toRenderColor(X?null:z).toArray01(),re=u.properties.get("space-color-use-theme")==="none",ce=u.properties.get("space-color").toRenderColor(re?null:z).toArray01PremultipliedAlpha(),se=5e-4,pe=i.dk(u.properties.get("horizon-blend"),0,1,se,.25),me=i.cD(s,g,S)&&pe===se?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,be=s.frameCounter/1e3%1,Ee=i.ad.vec3.length(S.globeCenterInViewSpace),Te=Math.sqrt(Math.pow(Ee,2)-Math.pow(me,2)),Re=Math.acos(Te/Ee),Pe=Ie=>{const Oe=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ie&&Oe.push("ALPHA_PASS");const ze=s.getOrCreateProgram("globeAtmosphere",{defines:Oe}),Ve=((rt,St,Tt,Dt,et,wt,Ke,bt,yt,Et,ht,Ct)=>({u_frustum_tl:rt,u_frustum_tr:St,u_frustum_br:Tt,u_frustum_bl:Dt,u_horizon:et,u_transition:wt,u_fadeout_range:Ke,u_color:bt,u_high_color:yt,u_space_color:Et,u_temporal_offset:ht,u_horizon_angle:Ct}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,L,pe,V,Y,ce,be,Re);s.uploadCommonUniforms(g,ze);const dt=this.atmosphereBuffer;dt&&ze.draw(s,x.TRIANGLES,A,Lr.disabled,Ie?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Or.backCW,Ve,Ie?"atmosphere_glow_alpha":"atmosphere_glow",dt.vertexBuffer,dt.indexBuffer,dt.segments)};Pe(!1),Pe(!0)}drawStars(s,u){const g=i.ay(u.properties.get("star-intensity"),0,1);if(g===0)return;const x=s.context,S=x.gl,A=s.transform,L=s.getOrCreateProgram("stars"),z=i.ad.quat.identity([]);i.ad.quat.rotateX(z,z,-A._pitch),i.ad.quat.rotateZ(z,z,-A.angle),i.ad.quat.rotateX(z,z,i.ak(A._center.lat)),i.ad.quat.rotateY(z,z,-i.ak(A._center.lng));const U=i.ad.mat4.fromQuat(new Float32Array(16),z),V=i.ad.mat4.multiply([],A.starsProjMatrix,U),X=i.ad.mat3.fromMat4([],U),Y=i.ad.mat3.invert([],X),re=[0,1,0];i.ad.vec3.transformMat3(re,re,Y),i.ad.vec3.scale(re,re,this.params.sizeMultiplier);const ce=[1,0,0];i.ad.vec3.transformMat3(ce,ce,Y),i.ad.vec3.scale(ce,ce,this.params.sizeMultiplier);const se=(pe=re,me=ce,be=g,{u_matrix:Float32Array.from(V),u_up:pe,u_right:me,u_intensity_multiplier:be});var pe,me,be;s.uploadCommonUniforms(x,L),this.starsVx&&this.starsIdx&&L.draw(s,S.TRIANGLES,gr.disabled,Lr.disabled,this.colorModeAlphaBlendedWriteRGB,Or.disabled,se,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Qc(y,s){const u=[...y],g=s.cameraWorldSizeForFog/s.worldSize,x=i.ad.mat4.identity([]);return i.ad.mat4.scale(x,x,[g,g,1]),i.ad.mat4.multiply(u,x,u),i.ad.mat4.multiply(u,s.worldToFogMatrix,u),u}function Zf(y,s,u,g,x){const S=u.material,A=g.context,{baseColorTexture:L,metallicRoughnessTexture:z}=S.pbrMetallicRoughness,{normalTexture:U,occlusionTexture:V,emissionTexture:X}=S;function Y(ce,se,pe){if(ce&&(y.push(se),A.activeTexture.set(A.gl.TEXTURE0+pe),ce.gfxTexture)){const{minFilter:me,magFilter:be,wrapS:Ee,wrapT:Te}=ce.sampler;ce.gfxTexture.bindExtraParam(me,be,Ee,Te)}}Y(L,"HAS_TEXTURE_u_baseColorTexture",Ri.BaseColor),Y(z,"HAS_TEXTURE_u_metallicRoughnessTexture",Ri.MetallicRoughness),Y(U,"HAS_TEXTURE_u_normalTexture",Ri.Normal),Y(V,"HAS_TEXTURE_u_occlusionTexture",Ri.Occlusion),Y(X,"HAS_TEXTURE_u_emissionTexture",Ri.Emission),x&&(x.texture||(x.texture=new i.dn(g.context,x.image,[x.image.height,x.image.height,x.image.height],A.gl.RGBA8)),A.activeTexture.set(A.gl.TEXTURE0+Ri.LUT),x.texture&&x.texture.bind(A.gl.LINEAR,A.gl.CLAMP_TO_EDGE),y.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(y.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(u.texcoordBuffer)),u.colorBuffer&&(y.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(u.colorBuffer)),u.normalBuffer&&(y.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(u.normalBuffer)),u.pbrBuffer&&(y.push("HAS_ATTRIBUTE_a_pbr"),y.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(u.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||y.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||y.push("DIFFUSE_SHADED");const re=g.shadowRenderer;re&&(y.push("RENDER_SHADOWS","DEPTH_TEXTURE"),re.useNormalOffset&&y.push("NORMAL_OFFSET"))}function eu(y,s,u,g,x,S){const A=u.paint.get("model-opacity").constantOr(1),L=s.context,z=new gr(s.context.gl.LEQUAL,gr.ReadWrite,s.depthRangeFor3D),U=s.transform,V=y.mesh,X=V.material,Y=X.pbrMetallicRoughness,re=s.style.fog;let ce;ce=s.transform.projection.zAxisUnit==="pixels"?[...y.nodeModelMatrix]:i.ad.mat4.multiply([],g.zScaleMatrix,y.nodeModelMatrix),i.ad.mat4.multiply(ce,g.negCameraPosMatrix,ce);const se=i.ad.mat4.invert([],ce);i.ad.mat4.transpose(se,se);const pe=u.paint.get("model-color-use-theme").constantOr("default")==="none",me=u.paint.get("model-emissive-strength").constantOr(0),be=i1(new Float32Array(y.worldViewProjection),new Float32Array(ce),new Float32Array(se),null,s,A,Y.baseColorFactor.toRenderColor(null),X.emissiveFactor,Y.metallicFactor,Y.roughnessFactor,X,me,u),Ee={defines:[]},Te=[],Re=s.shadowRenderer;Re&&(Re.useNormalOffset=!1),Zf(Ee.defines,Te,V,s,pe?null:u.lut);let Pe=null;if(re){const ze=Qc(y.nodeModelMatrix,s.transform);if(Pe=new Float32Array(ze),U.projection.name!=="globe"){const Ve=V.aabb.min,dt=V.aabb.max,[rt,St]=re.getOpacityForBounds(ze,Ve[0],Ve[1],dt[0],dt[1]);Ee.overrideFog=rt>=Kt||St>=Kt}}const Ie=Zc(s,u.paint.get("model-cutoff-fade-range"));Ie.shouldRenderCutoff&&Ee.defines.push("RENDER_CUTOFF");const Oe=s.getOrCreateProgram("model",Ee);s.uploadCommonUniforms(L,Oe,null,Pe,Ie),s.renderPass!=="shadow"&&Re&&Re.setupShadowsFromMatrix(y.nodeModelMatrix,Oe),Oe.draw(s,L.gl.TRIANGLES,z,x,S,V.material.doubleSided?Or.disabled:Or.backCCW,be,u.id,V.vertexBuffer,V.indexBuffer,V.segments,u.paint,s.transform.zoom,void 0,Te)}function ah(y,s,u,g,x,S,A){let L;L=y.projection.name==="globe"?i.dp(u,y):[...u],i.ad.mat4.multiply(L,L,s.matrix);const z=i.ad.mat4.multiply([],g,L);if(s.meshes)for(const U of s.meshes){if(U.material.alphaMode!=="BLEND"){A.push({mesh:U,depth:0,modelIndex:x,worldViewProjection:z,nodeModelMatrix:L});continue}const V=i.ad.vec3.transformMat4([],U.centroid,z);!y.isOrthographic&&V[2]<=0||S.push({mesh:U,depth:V[2],modelIndex:x,worldViewProjection:z,nodeModelMatrix:L})}if(s.children)for(const U of s.children)ah(y,U,u,g,x,S,A)}function ug(y,s,u,g){const x=u.shadowRenderer;if(!x)return;const S=x.getShadowPassDepthMode(),A=x.getShadowPassColorMode(),L=x.calculateShadowPassMatrixFromMatrix(s),z=N2(L);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,S,Lr.disabled,A,Or.backCCW,z,g.id,y.vertexBuffer,y.indexBuffer,y.segments,g.paint,u.transform.zoom,void 0,void 0)}function p1(y,s,u){const g=s.updateZoomBasedPaintProperties(),x=function(S,A,L){let z,U,V,X=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&X>0){const Y=S.terrain,re=Y.findDEMTileFor(L);re&&re.dem?z=i.dr.create(Y,L,re):X=0}if(X===0&&(A.terrainElevationMin=0,A.terrainElevationMax=0),X===A.validForExaggeration&&(X===0||z&&z._demTile&&z._demTile.tileID===A.validForDEMTile.id&&z._dem._timestamp===A.validForDEMTile.timestamp))return!1;for(const Y in A.instancesPerModel){const re=A.instancesPerModel[Y];for(let ce=0;ce<re.instancedDataArray.length;++ce){const se=(z?X*z.getElevationAt(0|re.instancedDataArray.float32[16*ce],0|re.instancedDataArray.float32[16*ce+1],!0,!0):0)+re.instancesEvaluatedElevation[ce];re.instancedDataArray.float32[16*ce+6]=se,U=U?Math.min(A.terrainElevationMin,se):se,V=V?Math.max(A.terrainElevationMax,se):se}}return A.terrainElevationMin=U||0,A.terrainElevationMax=V||0,A.validForExaggeration=X,A.validForDEMTile=z&&z._demTile?{id:z._demTile.tileID,timestamp:z._dem._timestamp}:{id:void 0,timestamp:0},!0}(y,s,u);(g||x)&&(s.uploaded=!1,s.upload(y.context))}const Qs={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.ce([0,0,0],[i.ai,i.ai,0])};function m1(y,s){const u=1<<y.canonical.z,g=s.getFreeCameraOptions().position,x=s.elevation,S=y.canonical.x/u,A=(y.canonical.x+1)/u,L=y.canonical.y/u,z=(y.canonical.y+1)/u;let U=s._centerAltitude;if(x){const re=x.getMinMaxForTile(y);re&&re.max>U&&(U=re.max)}const V=i.ay(g.x,S,A)-g.x,X=i.ay(g.y,L,z)-g.y,Y=i.bH(U,s.center.lat)-g.z;return s._zoomFromMercatorZ(Math.sqrt(V*V+X*X+Y*Y))}function Dl(y,s,u,g,x,S,A){const L=y.context,z=y.renderPass==="shadow",U=y.shadowRenderer,V=z&&U?U.getShadowPassDepthMode():new gr(L.gl.LEQUAL,gr.ReadWrite,y.depthRangeFor3D),X=y.isTileAffectedByFog(S);if(u.meshes)for(const Y of u.meshes){const re=["MODEL_POSITION_ON_GPU"],ce=[];let se,pe,me;g.instancedDataArray.length>20&&re.push("INSTANCED_ARRAYS");const be=Zc(y,s.paint.get("model-cutoff-fade-range"));if(be.shouldRenderCutoff&&re.push("RENDER_CUTOFF"),z&&U)se=y.getOrCreateProgram("modelDepth",{defines:re}),pe=N2(A.shadowTileMatrix,A.shadowTileMatrix,Float32Array.from(u.matrix)),me=U.getShadowPassColorMode();else{Zf(re,ce,Y,y,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),se=y.getOrCreateProgram("model",{defines:re,overrideFog:X});const Te=Y.material,Re=Te.pbrMetallicRoughness,Pe=s.paint.get("model-opacity").constantOr(1),Ie=s.paint.get("model-emissive-strength").constantOr(0);pe=i1(S.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,y,Pe,Re.baseColorFactor.toRenderColor(null),Te.emissiveFactor,Re.metallicFactor,Re.roughnessFactor,Te,Ie,s,x),U&&(A.shadowUniformsInitialized?se.setShadowUniformValues(L,U.getShadowUniformValues()):(U.setupShadows(S.toUnwrapped(),se,"model-tile",S.overscaledZ),A.shadowUniformsInitialized=!0)),me=be.shouldRenderCutoff||Pe<1||Te.alphaMode!=="OPAQUE"?Jr.alphaBlended:Jr.unblended}y.uploadCommonUniforms(L,se,S.toUnwrapped(),null,be);const Ee=Y.material.doubleSided?Or.disabled:Or.backCCW;if(g.instancedDataArray.length>20)ce.push(g.instancedDataBuffer),se.draw(y,L.gl.TRIANGLES,V,Lr.disabled,me,Ee,pe,s.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,s.paint,y.transform.zoom,void 0,ce,g.instancedDataArray.length);else{const Te=z?"u_instance":"u_normal_matrix";for(let Re=0;Re<g.instancedDataArray.length;++Re)pe[Te]=new Float32Array(g.instancedDataArray.arrayBuffer,64*Re,16),se.draw(y,L.gl.TRIANGLES,V,Lr.disabled,me,Ee,pe,s.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,s.paint,y.transform.zoom,void 0,ce)}}if(u.children)for(const Y of u.children)Dl(y,s,Y,g,x,S,A)}const nd=[1,-1,1];function $v(y,s,u,g){if(!u.modelManager)return!0;const x=u.modelManager;if(!u.shadowRenderer)return!0;const S=u.shadowRenderer,A=s.aabb;let L=!0,z=y.maxHeight;if(z===0){let V=0;for(const X in y.instancesPerModel){const Y=x.getModel(X,g);Y?V=Math.max(V,Math.max(Math.max(Y.aabb.max[0],Y.aabb.max[1]),Y.aabb.max[2])):L=!1}z=y.maxScale*V*1.41+y.maxVerticalOffset,L&&(y.maxHeight=z)}A.max[2]=z,A.min[2]+=y.terrainElevationMin,A.max[2]+=y.terrainElevationMax,i.ad.vec3.transformMat4(A.min,A.min,s.tileMatrix),i.ad.vec3.transformMat4(A.max,A.max,s.tileMatrix);const U=A.intersects(S.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(y.isInsideFirstShadowMapFrustum=U===2),U===0}function Uv(y,s){const u=y.uniformValues.u_cutoff_params[0],g=y.uniformValues.u_cutoff_params[1],x=y.uniformValues.u_cutoff_params[2],S=y.uniformValues.u_cutoff_params[3];return g===u||S===x?1:i.ay(((s-u)/(g-u)-x)/(S-x),0,1)}function g1(y,s,u,g){if(s.pitch<20)return 1;const x=s.getWorldToCameraMatrix();i.ad.mat4.multiply(x,x,y);const S=i.ad.vec4.fromValues(u.min[0],u.min[1],u.min[2],1);let A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A,z=A;S[1]=u.max[1],A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A[1]<L[1]?A:L,z=A[1]>z[1]?A:z,S[0]=u.max[0],A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A[1]<L[1]?A:L,z=A[1]>z[1]?A:z,S[1]=u.min[1],A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A[1]<L[1]?A:L,z=A[1]>z[1]?A:z;const U=i.ay(g[0],0,1),V=100*s.pixelsPerMeter*i.ay(g[1],0,1),X=i.ay(g[2],0,1),Y=i.ad.vec4.lerp(i.ad.vec4.create(),L,z,U),re=Math.tan(.5*s.fovX),ce=-Y[2]*re;if(V===0)return Y[1]<-Math.abs(ce)?X:1;const se=(-Math.abs(ce)-Y[1])/V,pe=(be,Ee,Te)=>(1-Te)*be+Te*Ee,me=i.ay(pe(1,X,se),X,1);return pe(1,me,i.ay((s.pitch-20)/20,0,1))}class y1{}class sh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,u,g){{const X=this._storage.get(u.id);if(X)return X.lastUsedFrameIdx=s,X.buf}const x=g.gl,S=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),A=new ArrayBuffer(S),L=new Int16Array(A);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(A));const z=new i.dt;for(let X=0;X<S/2;X+=3){const Y=L[X],re=L[X+1],ce=L[X+2];z.emplaceBack(Y,re),z.emplaceBack(re,ce),z.emplaceBack(ce,Y)}const U=g.bindVertexArrayOES.current,V=new y1;return V.buf=new dc(g,z),V.lastUsedFrameIdx=s,this._storage.set(u.id,V),g.bindVertexArrayOES.set(U),V.buf}update(s){for(const[u,g]of this._storage)s-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(u))}destroy(){for(const[s,u]of this._storage)u.buf.destroy(),this._storage.delete(s)}}class v1{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const id=i.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class _1{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class dg{constructor(s,u){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const x1=i.dd([{type:"Float32",name:"a_pos_2f",components:2}]);class b1{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,u){const g=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const A=new i.du,L=new i.aV;A.emplaceBack(-1,-1),A.emplaceBack(1,-1),A.emplaceBack(1,1),A.emplaceBack(-1,1),L.emplaceBack(0,1,2),L.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(A,x1.members),this.vignetteIdx=s.context.createIndexBuffer(L)}const x=i.b8.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,g);const A={u_vignetteShape:(S={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:S.vignetteColor};g.draw(s,s.context.gl.TRIANGLES,gr.disabled,Lr.disabled,Jr.alphaBlended,Or.disabled,A,"vignette",this.vignetteVx,this.vignetteIdx,x)}var S}}class qo{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,u){const g=s.getFreeCameraOptions().position,x=g.toAltitude(),S=g.toLngLat(),A=i.ak(S.lng),L=i.ak(S.lat),z=s.pixelsPerMeter/u,U=A*i.dv,V=i.dv*Math.log(Math.tan(Math.PI/4+L/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const X=-this._offsetYPrev+V,Y=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+U)*z,this._accumulatedOffsetY+=X*z,this._accumulatedElevation+=Y*z,this._offsetXPrev=U,this._offsetYPrev=V,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Vv(y,s){return[-(y[0]-Math.floor(y[0]/s)*s),-(y[1]-Math.floor(y[1]/s)*s),-(y[2]-Math.floor(y[2]/s)*s)]}function Wv(y){const s=i.dl(1323123451230),u=[];for(let g=0;g<y;++g){const x=2*s()-1,S=2*s()-1,A=2*s()-1;u.push(i.ad.vec3.fromValues(x,S,A))}return u}function Ja(y,s,u,g,x){const S=i.ay((x-u)/(g-u),0,1);return(1-S)*y+S*s}class Gv{constructor(s){this._movement=new qo,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new b1,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,u){const g=s.transform;this._movement.update(g,this._ppmScaleFactor);const x=g.starsProjMatrix,S=i.ad.quat.identity([]);i.ad.quat.rotateX(S,S,i.ak(90)-g._pitch),i.ad.quat.rotateZ(S,S,-g.angle);const A=i.ad.mat4.fromQuat(new Float32Array(16),S),L=i.ad.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),z=i.ad.mat4.transpose([],L),U=i.ad.mat4.multiply([],z,A),V=Date.now()/1e3;return this._accumulatedTimeFromStart+=(V-this._prevTime)*u,this._prevTime=V,{projectionMatrix:x,modelviewMatrix:U}}}class w1 extends Gv{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new dg(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const g=Wv(this.particlesCount),x=new i.dw,S=new i.aV;let A=0;const L=i.dl(1323123451230);for(let z=0;z<g.length;++z){const U=g[z],V=[2*L()-1,L(),L(),L()];x.emplaceBack(U[0],U[1],U[2],-1,-1,...V),x.emplaceBack(U[0],U[1],U[2],1,-1,...V),x.emplaceBack(U[0],U[1],U[2],1,1,...V),x.emplaceBack(U[0],U[1],U[2],-1,1,...V),S.emplaceBack(A+0,A+1,A+2),S.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=u.createVertexBuffer(x,id.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=s.transform.zoom;if(u.revealStart>g)return;const x=Ja(0,1,u.revealStart,u.revealStart+u.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const S=structuredClone(this._params);let A=[-S.direction.x,S.direction.y,-100];i.ad.vec3.normalize(A,A);const L=structuredClone(this._vignetteParams);L.strength*=x,S.overrideStyleParameters||(S.intensity=s.style.rain.state.density,S.timeFactor=s.style.rain.state.intensity,S.color=structuredClone(s.style.rain.state.color),A=structuredClone(s.style.rain.state.direction),S.screenThinning.intensity=s.style.rain.state.centerThinning,S.dropletSizeX=s.style.rain.state.dropletSize[0],S.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],S.distortionStrength=100*s.style.rain.state.distortionStrength,L.strength=1,L.color=structuredClone(s.style.rain.state.vignetteColor));const z=this.updateOnRender(s,S.timeFactor),U=s.context,V=U.gl,X=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new i.T(U,{width:s.width,height:s.height,data:null},V.RGBA8)),S.distortionStrength>0&&(U.activeTexture.set(V.TEXTURE0),this.screenTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),V.copyTexSubImage2D(V.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const Y=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(U,Y),U.activeTexture.set(V.TEXTURE0),this.screenTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const re=[S.color.r,S.color.g,S.color.b,S.color.a],ce=(se,pe)=>{const me=Vv(this._movement.getPosition(),se),be=S.dropletSizeX,Ee=S.dropletSizeX*S.dropletSizeYScale,Te=s.width/2,Re=s.height/2,Pe=Ja(0,S.screenThinning.start,0,1,S.screenThinning.intensity),Ie=Ja(.001,S.screenThinning.range,0,1,S.screenThinning.intensity),Oe=Ja(0,S.screenThinning.particleOffset,0,1,S.screenThinning.intensity),ze=(Ve={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:me,velocityConeAperture:S.velocityConeAperture,velocity:S.velocity,boxSize:se,rainDropletSize:[be,Ee],distortionStrength:S.distortionStrength,rainDirection:A,color:re,screenSize:[X.width,X.height],thinningCenterPos:[Te,Re],thinningShape:[Pe,Ie,Math.pow(10,S.screenThinning.fadePower)],thinningAffectedRatio:S.screenThinning.affectedRatio,thinningParticleOffset:Oe,shapeDirectionalPower:S.shapeDirPower,shapeNormalPower:S.shapeNormalPower,mode:pe?0:1},{u_modelview:Float32Array.from(Ve.modelview),u_projection:Float32Array.from(Ve.projection),u_time:Ve.time,u_cam_pos:Ve.camPos,u_texScreen:0,u_velocityConeAperture:Ve.velocityConeAperture,u_velocity:Ve.velocity,u_boxSize:Ve.boxSize,u_rainDropletSize:Ve.rainDropletSize,u_distortionStrength:Ve.distortionStrength,u_rainDirection:Ve.rainDirection,u_color:Ve.color,u_screenSize:Ve.screenSize,u_thinningCenterPos:Ve.thinningCenterPos,u_thinningShape:Ve.thinningShape,u_thinningAffectedRatio:Ve.thinningAffectedRatio,u_thinningParticleOffset:Ve.thinningParticleOffset,u_shapeDirectionalPower:Ve.shapeDirectionalPower,u_shapeNormalPower:Ve.shapeNormalPower,u_mode:Ve.mode});var Ve;const dt=Math.round(S.intensity*this.particlesCount),rt=i.b8.simpleSegment(0,0,4*dt,2*dt);Y.draw(s,V.TRIANGLES,gr.disabled,Lr.disabled,Jr.alphaBlended,Or.disabled,ze,"rain_particles",this.particlesVx,this.particlesIdx,rt)};S.distortionStrength>0&&ce(S.boxSize,!0),ce(S.boxSize,!1),this._vignette.draw(s,L)}}const S1=i.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Xf extends Gv{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new dg(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const g=Wv(this.particlesCount),x=new i.dx,S=new i.aV;let A=0;const L=i.dl(1323123451230);for(let z=0;z<g.length;++z){const U=g[z],V=L(),X=L(),Y=L(),re=[z/g.length,V,X,Y],ce=[L(),L()];x.emplaceBack(U[0],U[1],U[2],-1,-1,...re,...ce),x.emplaceBack(U[0],U[1],U[2],1,-1,...re,...ce),x.emplaceBack(U[0],U[1],U[2],1,1,...re,...ce),x.emplaceBack(U[0],U[1],U[2],-1,1,...re,...ce),S.emplaceBack(A+0,A+1,A+2),S.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=u.createVertexBuffer(x,S1.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const u=structuredClone(this._params);let g=[-u.direction.x,u.direction.y,-100];i.ad.vec3.normalize(g,g);const x=structuredClone(this._vignetteParams),S=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},A=s.transform.zoom;if(S.revealStart>A)return;const L=Ja(0,1,S.revealStart,S.revealStart+S.revealRange,A);x.strength*=L,u.overrideStyleParameters||(u.intensity=s.style.snow.state.density,u.timeFactor=s.style.snow.state.intensity,u.color=structuredClone(s.style.snow.state.color),g=structuredClone(s.style.snow.state.direction),u.screenThinning.intensity=s.style.snow.state.centerThinning,u.billboardSize=2.79*s.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(s.style.snow.state.vignetteColor));const z=this.updateOnRender(s,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const U=s.context,V=U.gl,X=s.transform,Y=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(U,Y),((re,ce,se)=>{const pe=Vv(this._movement.getPosition(),re),me=X.width/2,be=X.height/2,Ee=Ja(0,se.screenThinning.start,0,1,se.screenThinning.intensity),Te=Ja(.001,se.screenThinning.range,0,1,se.screenThinning.intensity),Re=Ja(0,se.screenThinning.particleOffset,0,1,se.screenThinning.intensity),Pe=(Ie={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:pe,velocityConeAperture:se.velocityConeAperture,velocity:se.velocity,horizontalOscillationRadius:se.horizontalOscillationRadius,horizontalOscillationRate:se.horizontalOscillationRate,boxSize:re,billboardSize:1*se.billboardSize,simpleShapeParameters:[se.shapeFadeStart,se.shapeFadePower],screenSize:[X.width,X.height],thinningCenterPos:[me,be],thinningShape:[Ee,Te,Math.pow(10,se.screenThinning.fadePower)],thinningAffectedRatio:se.screenThinning.affectedRatio,thinningParticleOffset:Re,color:[se.color.r,se.color.g,se.color.b,se.color.a],direction:g},{u_modelview:Float32Array.from(Ie.modelview),u_projection:Float32Array.from(Ie.projection),u_time:Ie.time,u_cam_pos:Ie.camPos,u_velocityConeAperture:Ie.velocityConeAperture,u_velocity:Ie.velocity,u_horizontalOscillationRadius:Ie.horizontalOscillationRadius,u_horizontalOscillationRate:Ie.horizontalOscillationRate,u_boxSize:Ie.boxSize,u_billboardSize:Ie.billboardSize,u_simpleShapeParameters:Ie.simpleShapeParameters,u_screenSize:Ie.screenSize,u_thinningCenterPos:Ie.thinningCenterPos,u_thinningShape:Ie.thinningShape,u_thinningAffectedRatio:Ie.thinningAffectedRatio,u_thinningParticleOffset:Ie.thinningParticleOffset,u_particleColor:Ie.color,u_direction:Ie.direction});var Ie;const Oe=Math.round(se.intensity*this.particlesCount),ze=i.b8.simpleSegment(0,0,4*Oe,2*Oe);this.particlesVx&&this.particlesIdx&&Y.draw(s,V.TRIANGLES,gr.disabled,Lr.disabled,Jr.alphaBlended,Or.disabled,Pe,"snow_particles",this.particlesVx,this.particlesIdx,ze)})(u.boxSize,0,u),this._vignette.draw(s,x)}}const hg={symbol:function(y,s,u,g,x){if(y.renderPass!=="translucent")return;const S=Lr.disabled,A=y.colorModeForRenderPass(),L=u.layout.get("text-variable-anchor"),z=u.layout.get("text-size-scale-range"),U=i.ay(y.scaleFactor,z[0],z[1]);L&&function(Y,re,ce,se,pe,me,be,Ee){const Te=re.transform,Re=pe==="map",Pe=me==="map";for(const Ie of Y){const Oe=se.getTile(Ie),ze=Oe.getBucket(ce);if(!ze||!ze.text||!ze.text.segments.get().length)continue;const Ve=i.bp(ze.textSizeData,Te.zoom,Ee),dt=ws(Ie,ze.getProjection(),Te),rt=Te.calculatePixelsToTileUnitsMatrix(Oe),St=Vc(dt,Oe.tileID.canonical,Pe,Re,Te,ze.getProjection(),rt),Tt=ze.hasIconTextFit()&&ze.hasIconData();if(Ve){const Dt=Math.pow(2,Te.zoom-Oe.tileID.overscaledZ);Js(ze,Re,Pe,be,i.cY,Te,St,Ie,Dt,Ve,Tt)}}}(g,y,u,s,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x,U);const V=u.paint.get("icon-opacity").constantOr(1)!==0,X=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(V||X)?Hn(y,s,u,g,S,A):(V&&Hn(y,s,u,g,S,A,{onlyIcons:!0}),X&&Hn(y,s,u,g,S,A,{onlyText:!0})),s.map.showCollisionBoxes&&(Lv(y,s,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Lv(y,s,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(y,s,u,g){if(y.renderPass!=="translucent")return;const x=u.paint.get("circle-opacity"),S=u.paint.get("circle-stroke-width"),A=u.paint.get("circle-stroke-opacity"),L=u.layout.get("circle-sort-key").constantOr(1)!==void 0,z=u.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(S.constantOr(1)===0||A.constantOr(1)===0))return;const U=y.context,V=U.gl,X=y.transform,Y=y.depthModeForSublayer(0,gr.ReadOnly),re=Lr.disabled,ce=y.colorModeForDrapableLayerRenderPass(z),se=X.projection.name==="globe",pe=[i.av(X.center.lng),i.aC(X.center.lat)],me=[];for(let Ee=0;Ee<g.length;Ee++){const Te=g[Ee],Re=s.getTile(Te),Pe=Re.getBucket(u);if(!Pe||Pe.projection.name!==X.projection.name)continue;const Ie=Pe.programConfigurations.get(u.id),Oe=i.cZ(u),ze=y.isTileAffectedByFog(Te);se&&Oe.push("PROJECTION_GLOBE_VIEW"),Oe.push("DEPTH_D24"),y.terrain&&X.depthOcclusionForSymbolsAndCircles&&Oe.push("DEPTH_OCCLUSION");const Ve=y.getOrCreateProgram("circle",{config:Ie,defines:Oe,overrideFog:ze}),dt=Pe.layoutVertexBuffer,rt=Pe.globeExtVertexBuffer,St=Pe.indexBuffer,Tt=X.projection.createInversionMatrix(X,Te.canonical),Dt={programConfiguration:Ie,program:Ve,layoutVertexBuffer:dt,globeExtVertexBuffer:rt,indexBuffer:St,uniformValues:i.c_(y,Te,Re,Tt,pe,u),tile:Re};if(L){const et=Pe.segments.get();for(const wt of et)me.push({segments:new i.b8([wt]),sortKey:wt.sortKey,state:Dt})}else me.push({segments:Pe.segments,sortKey:0,state:Dt})}L&&me.sort((Ee,Te)=>Ee.sortKey-Te.sortKey);const be={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const Ee of me){const{programConfiguration:Te,program:Re,layoutVertexBuffer:Pe,globeExtVertexBuffer:Ie,indexBuffer:Oe,uniformValues:ze,tile:Ve}=Ee.state,dt=Ee.segments;y.terrain&&y.terrain.setupElevationDraw(Ve,Re,be),y.uploadCommonUniforms(U,Re,Ve.tileID.toUnwrapped()),Re.draw(y,V.TRIANGLES,Y,re,ce,Or.disabled,ze,u.id,Pe,Oe,dt,u.paint,X.zoom,Te,[Ie])}},heatmap:function(y,s,u,g){if(u.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const x=y.context,S=x.gl,A=Lr.disabled,L=new Jr([S.ONE,S.ONE,S.ONE,S.ONE],i.al.transparent,[!0,!0,!0,!0]);(function(re,ce,se,pe){const me=re.gl,be=ce.width*pe,Ee=ce.height*pe;re.activeTexture.set(me.TEXTURE1),re.viewport.set([0,0,be,Ee]);let Te=se.heatmapFbo;if(!Te||Te&&(Te.width!==be||Te.height!==Ee)){Te&&Te.destroy();const Re=me.createTexture();me.bindTexture(me.TEXTURE_2D,Re),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),Te=se.heatmapFbo=re.createFramebuffer(be,Ee,!0,null),function(Pe,Ie,Oe,ze,Ve,dt){const rt=Pe.gl;rt.texImage2D(rt.TEXTURE_2D,0,Pe.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,Ve,dt,0,rt.RGBA,Pe.extRenderToTextureHalfFloat?rt.HALF_FLOAT:rt.UNSIGNED_BYTE,null),ze.colorAttachment.set(Oe)}(re,0,Re,Te,be,Ee)}else me.bindTexture(me.TEXTURE_2D,Te.colorAttachment.get()),re.bindFramebuffer.set(Te.framebuffer)})(x,y,u,y.transform.projection.name==="globe"?.5:.25),x.clear({color:i.al.transparent});const z=y.transform,U=z.projection.name==="globe",V=U?["PROJECTION_GLOBE_VIEW"]:[],X=U?Or.frontCCW:Or.disabled,Y=[i.av(z.center.lng),i.aC(z.center.lat)];for(let re=0;re<g.length;re++){const ce=g[re];if(s.hasRenderableParent(ce))continue;const se=s.getTile(ce),pe=se.getBucket(u);if(!pe||pe.projection.name!==z.projection.name)continue;const me=y.isTileAffectedByFog(ce),be=pe.programConfigurations.get(u.id),Ee=y.getOrCreateProgram("heatmap",{config:be,defines:V,overrideFog:me}),{zoom:Te}=y.transform;y.terrain&&y.terrain.setupElevationDraw(se,Ee),y.uploadCommonUniforms(x,Ee,ce.toUnwrapped());const Re=z.projection.createInversionMatrix(z,ce.canonical);Ee.draw(y,S.TRIANGLES,gr.disabled,A,L,X,kv(y,ce,se,Re,Y,Te,u.paint.get("heatmap-intensity")),u.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,u.paint,y.transform.zoom,be,U?[pe.globeExtVertexBuffer]:null)}x.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(x,S){const A=x.context,L=A.gl,z=S.heatmapFbo;if(!z)return;A.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,z.colorAttachment.get()),A.activeTexture.set(L.TEXTURE1);let U=S.colorRampTexture;U||(U=S.colorRampTexture=new i.T(A,S.colorRamp,L.RGBA8)),U.bind(L.LINEAR,L.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,L.TRIANGLES,gr.disabled,Lr.disabled,x.colorModeForRenderPass(),Or.disabled,((V,X,Y,re)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,S),S.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,S.paint,x.transform.zoom)}(y,u))},line:function(y,s,u,g){if(y.renderPass!=="translucent")return;const x=u.paint.get("line-opacity"),S=u.paint.get("line-width");if(x.constantOr(1)===0||S.constantOr(1)===0)return;const A=u.paint.get("line-emissive-strength"),L=u.paint.get("line-occlusion-opacity"),z=u.layout.get("line-elevation-reference"),U=u.layout.get("line-width-unit")==="meters",V=z==="sea",X=y.context,Y=X.gl;if(u.hasElevatedBuckets&&y.transform.projection.name==="globe")return;const re=u.layout.get("line-cross-slope"),ce=re!==void 0,se=re<1,pe=y.colorModeForDrapableLayerRenderPass(A),me=y.terrain&&y.terrain.renderingToTexture,be=me?1:i.q.devicePixelRatio,Ee=u.paint.get("line-dasharray"),Te=Ee.constantOr(1),Re=u.layout.get("line-cap"),Pe=Ee.constantOr(null),Ie=Re.constantOr(null),Oe=u.paint.get("line-pattern"),ze=Oe.constantOr(1),Ve=Oe.constantOr(null),dt=u.paint.get("line-opacity").constantOr(1);let rt=!ze&&dt!==1||y.depthOcclusion&&L>0&&L<1;const St=u.paint.get("line-gradient"),Tt=ze?"linePattern":"line",Dt=i.c$(u);let et;if(me&&y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(rt=!1),L!==0&&y.depthOcclusion){const Ke=u.paint._values["line-opacity"];Ke&&Ke.value&&Ke.value.kind==="constant"?et=Ke.value:i.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}S.value.kind!=="constant"&&S.value.isLineProgressConstant===!1&&Dt.push("VARIABLE_LINE_WIDTH");const wt=(Ke,bt,yt,Et,ht,Ct)=>{for(const Gt of Ke){const qt=s.getTile(Gt);if(ze&&!qt.patternsLoaded())continue;const Zt=qt.getBucket(u);if(!Zt||Zt.hasZOffset&&!ht||!Zt.hasZOffset&&ht)continue;y.prepareDrawTile();const sr=Zt.programConfigurations.get(u.id),kr=y.isTileAffectedByFog(Gt),xr=y.getOrCreateProgram(Tt,{config:sr,defines:bt,overrideFog:kr,overrideRtt:!ht&&void 0});if(Ve&&qt.imageAtlas){const Nr=i.d0.from(Ve).getPrimary().scaleSelf(be).toString(),lr=qt.imageAtlas.patternPositions.get(Nr);lr&&sr.setConstantPatternPositions(lr)}if(!ze&&Pe&&Ie&&qt.lineAtlas){const Nr=qt.lineAtlas.getDash(Pe,Ie);Nr&&sr.setConstantPatternPositions(Nr)}let[Pr,Ar]=u.paint.get("line-trim-offset");(Ie==="round"||Ie==="square")&&Pr!==Ar&&(Pr===0&&(Pr-=1),Ar===1&&(Ar+=1));const nn=me?Gt.projMatrix:null,wn=U?1/Zt.tileToMeter/i.at(qt,1,y.transform.zoom):1,Kn=U?1/Zt.tileToMeter/i.at(qt,1,Math.floor(y.transform.zoom)):1,Yr=ze?i.d1(y,qt,u,nn,be,wn,Kn,[Pr,Ar]):i.d2(y,qt,u,nn,Zt.lineClipsArray.length,be,wn,Kn,[Pr,Ar]);if(St){const Nr=Zt.gradients[u.id];let lr=Nr.texture;if(u.gradientVersion!==Nr.version){let sn=256;if(u.stepInterpolant){const kn=s.getSource().maxzoom,mn=Gt.canonical.z===kn?Math.ceil(1<<y.transform.maxZoom-Gt.canonical.z):1;sn=i.ay(i.d3(Zt.maxLineLength/i.ai*1024*mn),256,X.maxTextureSize)}Nr.gradient=i.d4({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:sn,image:Nr.gradient||void 0,clips:Zt.lineClipsArray}),Nr.texture?Nr.texture.update(Nr.gradient):Nr.texture=new i.T(X,Nr.gradient,Y.RGBA8),Nr.version=u.gradientVersion,lr=Nr.texture}X.activeTexture.set(Y.TEXTURE1),lr.bind(u.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}Te&&(X.activeTexture.set(Y.TEXTURE0),qt.lineAtlasTexture&&qt.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),sr.updatePaintBuffers()),ze&&(X.activeTexture.set(Y.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),sr.updatePaintBuffers()),ht&&!V&&y.terrain.setupElevationDraw(qt,xr),y.uploadCommonUniforms(X,xr,Gt.toUnwrapped());const fi=Nr=>{et!=null&&(et.value=dt*L),xr.draw(y,Y.TRIANGLES,yt,Nr,pe,Or.disabled,Yr,u.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Zt.segments,u.paint,y.transform.zoom,sr,[Zt.layoutVertexBuffer2,Zt.patternVertexBuffer,Zt.zOffsetVertexBuffer]),et!=null&&(et.value=dt)};if(rt&&!ht){const Nr=y.stencilModeForClipping(Gt).ref;Nr===0&&me&&X.clear({stencil:0});const lr={func:Y.EQUAL,mask:255};Yr.u_alpha_discard_threshold=.8,fi(new Lr(lr,Nr,255,Y.KEEP,Y.KEEP,Y.INVERT)),Yr.u_alpha_discard_threshold=0,fi(new Lr(lr,Nr,255,Y.KEEP,Y.KEEP,Y.KEEP))}else Yr.u_alpha_discard_threshold=rt&&ht&&Ct?.8:0,fi(ht?Et:y.stencilModeForClipping(Gt))}};if(u.hasNonElevatedBuckets){const Ke=!me&&y.terrain;L!==0&&Ke?i.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):Ke?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):wt(g,Dt,y.depthModeForSublayer(0,gr.ReadOnly),Lr.disabled,!1,!0)}if(u.hasElevatedBuckets){Dt.push("ELEVATED"),ce&&Dt.push(se?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),V&&Dt.push("ELEVATION_REFERENCE_SEA");const Ke=rt?y.stencilModeFor3D():Lr.disabled,bt=new gr(y.depthOcclusion?Y.GREATER:Y.LEQUAL,gr.ReadOnly,y.depthRangeFor3D);y.forceTerrainMode=!0,wt(g,Dt,bt,Ke,!0,!0),rt&&wt(g,Dt,bt,Ke,!0,!1),y.forceTerrainMode=!1}rt&&(y.resetStencilClippingMasks(),me&&X.clear({stencil:0})),L===0||y.depthOcclusion||me||y.layersWithOcclusionOpacity.push(y.currentLayer)},fill:function(y,s,u,g){const x=u.paint.get("fill-color"),S=u.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const A=u.paint.get("fill-emissive-strength"),L=y.colorModeForDrapableLayerRenderPass(A),z=u.paint.get("fill-pattern"),U=y.opaquePassEnabledForLayer()&&!z.constantOr(1)&&x.constantOr(i.al.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";let V="none";u.layout.get("fill-elevation-reference")!=="none"?V="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(V="offset");const X=!(!y.terrain||!y.terrain.enabled),Y={painter:y,sourceCache:s,layer:u,coords:g,colorMode:L,elevationType:V,terrainEnabled:X,pass:U};if(V!=="offset"){if(zv(Y,!1),V==="road"){const re=!X&&y.renderPass==="translucent";re&&c1(y,s,u,g,"geometry"),zv(Y,!0,Lr.disabled),re&&function(ce){const{painter:se,sourceCache:pe,layer:me,coords:be,colorMode:Ee}=ce,Te=se.context.gl,Re=new gr(se.context.gl.LEQUAL,gr.ReadOnly,se.depthRangeFor3D);for(const Pe of be){const Ie=pe.getTile(Pe),Oe=Ie.getBucket(me);if(!Oe)continue;const ze=Oe.elevatedStructures;if(!ze||!ze.renderableSegments||ze.renderableSegments.segments[0].primitiveLength===0)continue;se.prepareDrawTile();const Ve=Oe.bufferData.programConfigurations.get(me.id),dt=se.isTileAffectedByFog(Pe),rt=se.getOrCreateProgram("elevatedStructures",{config:Ve,overrideFog:dt,defines:["NORMAL_OFFSET"]}),St={u_matrix:se.translatePosMatrix(Pe.projMatrix,Ie,me.paint.get("fill-translate"),me.paint.get("fill-translate-anchor"))};se.uploadCommonUniforms(se.context,rt,Pe.toUnwrapped()),rt.draw(se,Te.TRIANGLES,Re,Lr.disabled,Ee,Or.backCCW,St,me.id,ze.vertexBuffer,ze.indexBuffer,ze.renderableSegments,me.paint,se.transform.zoom,Ve,[ze.vertexBufferNormal])}}(Y)}}else zv(Y,!1,y.stencilModeFor3D())},"fill-extrusion":function(y,s,u,g){const x=u.paint.get("fill-extrusion-opacity"),S=y.context,A=S.gl,L=y.terrain,z=L&&L.renderingToTexture;if(x===0)return;const U=y.conflationActive&&y.style.isLayerClipped(u,s.getSource()),V=y.style.order.indexOf(u.fqid);if(U&&function(X,Y,re,ce,se){for(const pe of ce){const me=Y.getTile(pe).getBucket(re);me&&(me.updateReplacement(pe,X.replacementSource,se),me.uploadCentroid(X.context))}}(y,s,u,g,V),L||U)for(const X of g){const Y=s.getTile(X).getBucket(u);Y&&Vf(y.context,s,X,Y,u,L,U)}if(y.renderPass==="shadow"&&y.shadowRenderer){const X=y.shadowRenderer;if(L&&x<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ab)return;const Y=X.getShadowPassDepthMode(),re=X.getShadowPassColorMode();lg(y,s,u,g,Y,Lr.disabled,re,U)}else if(y.renderPass==="translucent"){const X=!u.paint.get("fill-extrusion-pattern").constantOr(1),Y=u.paint.get("fill-extrusion-color").constantOr(i.al.white);if(!z&&Y.a!==0){const re=new gr(y.context.gl.LEQUAL,gr.ReadWrite,y.depthRangeFor3D);x===1&&X?lg(y,s,u,g,re,Lr.disabled,Jr.unblended,U):(lg(y,s,u,g,re,Lr.disabled,Jr.disabled,U),lg(y,s,u,g,re,y.stencilModeFor3D(),y.colorModeForRenderPass(),U),y.resetStencilClippingMasks())}if(y.style.enable3dLights()&&X&&(!L&&y.transform.projection.name!=="globe"||z)){const re=u.paint.get("fill-extrusion-opacity"),ce=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),se=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),pe=u.paint.get("fill-extrusion-flood-light-intensity"),me=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",be=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(me?null:u.lut).toArray01().slice(0,3),Ee=ce>0&&se>0,Te=pe>0,Re=(Ie,Oe,ze)=>(1-ze)*Ie+ze*Oe,Pe=Ie=>{const Oe=y.depthModeForSublayer(1,gr.ReadOnly,A.LEQUAL,!0),ze=u.paint.get(Ie?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ve=Re(.1,3,ze),dt=y._showOverdrawInspector;if(!dt){const rt=new Lr({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),St=new Jr([A.ONE,A.ONE,A.ONE,A.ONE],i.al.transparent,[!1,!1,!1,!0],A.MIN);Uf(y,s,u,g,Oe,rt,St,Or.disabled,Ie,"sdf",re,ce,se,pe,be,Ve,U,!1)}{const rt=dt?Lr.disabled:new Lr({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),St=dt?y.colorModeForRenderPass():new Jr([A.ONE_MINUS_DST_ALPHA,A.DST_ALPHA,A.ONE,A.ONE],i.al.transparent,[!0,!0,!0,!0]);Uf(y,s,u,g,Oe,rt,St,Or.disabled,Ie,"color",re,ce,se,pe,be,Ve,U,!1)}};if(z){const Ie=(Oe,ze,Ve)=>{const dt=y.depthModeForSublayer(1,gr.ReadOnly,A.LEQUAL,!1),rt=u.paint.get(Oe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),St=Re(.1,3,rt);{const Tt=new Jr([A.ONE,A.ONE,A.ONE,A.ONE],i.al.transparent,[!1,!1,!1,!0]);Uf(y,s,u,g,dt,Lr.disabled,Tt,Or.disabled,Oe,"clear",re,ce,se,pe,be,St,U,ze)}{const Tt=new Lr({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),Dt=new Jr([A.ONE,A.ONE,A.ONE,A.ONE],i.al.transparent,[!1,!1,!1,!0],A.MIN);Uf(y,s,u,g,dt,Tt,Dt,Or.disabled,Oe,"sdf",re,ce,se,pe,be,St,U,ze)}{const Tt=Oe?A.ZERO:A.ONE_MINUS_DST_ALPHA,Dt=new Lr({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),et=new Jr([Tt,A.DST_ALPHA,A.ONE_MINUS_DST_ALPHA,A.ZERO],i.al.transparent,[!0,!0,!0,!0]);Uf(y,s,u,g,dt,Dt,et,Or.disabled,Oe,"color",re,ce,se,pe,be,St,U,ze)}{const Tt=new Jr([A.ONE,A.ONE,A.ONE,Oe?A.ZERO:A.ONE],i.al.transparent,[!1,!1,!1,!0],Oe?A.FUNC_ADD:A.MAX);Uf(y,s,u,g,dt,Lr.disabled,Tt,Or.disabled,Oe,"clear",re,ce,se,pe,be,St,U,ze,Ve)}};if(Ee||Te){let Oe;if(y.prepareDrawTile(),L){const ze=L.drapeBufferSize[0],Ve=L.drapeBufferSize[1];Oe=L.framebufferCopyTexture,Oe&&(!Oe||Oe.size[0]===ze&&Oe.size[1]===Ve)||(Oe&&Oe.destroy(),Oe=L.framebufferCopyTexture=new i.T(S,new i.r({width:ze,height:Ve}),A.RGBA8)),Oe.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.copyTexSubImage2D(A.TEXTURE_2D,0,0,0,0,0,ze,Ve)}Ee&&Ie(!0,!1,Oe),Te&&Ie(!1,!0,Oe)}}else Ee&&Pe(!0),Te&&Pe(!1),(Ee||Te)&&y.resetStencilClippingMasks()}}},hillshade:function(y,s,u,g){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent"||y.style.disableElevatedTerrain)return;const x=y.context,S=y.terrain&&y.terrain.renderingToTexture,[A,L]=y.renderPass!=="translucent"||S?[{},g]:y.stencilConfigForOverlap(g);for(const z of L){const U=s.getTile(z);if(U.needsHillshadePrepare&&y.renderPass==="offscreen")pD(y,U,u);else if(y.renderPass==="translucent"){const V=y.depthModeForSublayer(0,gr.ReadOnly),X=u.paint.get("hillshade-emissive-strength"),Y=y.colorModeForDrapableLayerRenderPass(X),re=S&&y.terrain?y.terrain.stencilModeForRTTOverlap(z):A[z.overscaledZ];Rf(y,z,U,u,V,re,Y)}}x.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,s,u,g,x,S){if(y.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const A=y.transform.projection.name==="globe",L=u.paint.get("raster-elevation")!==0,z=L&&A;if(y.renderElevatedRasterBackface&&!z)return;const U=y.context,V=U.gl,X=s.getSource(),Y=function(Pe,Ie,Oe,ze){const Ve=Ie.paint.get("raster-color"),dt=Pe.type==="raster-array",rt=[],St=Ie.paint.get("raster-resampling"),Tt=Ie.paint.get("raster-color-mix");let Dt=Ie.paint.get("raster-color-range");const et=[Tt[0],Tt[1],Tt[2],0],wt=Tt[3];let Ke=St==="nearest"?ze.NEAREST:ze.LINEAR;if(dt&&(rt.push("RASTER_ARRAY"),Ve||rt.push("RASTER_COLOR"),St==="linear"&&rt.push("RASTER_ARRAY_LINEAR"),Ke=ze.NEAREST,!Dt&&Pe.rasterLayers)){const bt=Pe.rasterLayers.find(({id:yt})=>yt===Ie.sourceLayer);bt&&bt.fields&&bt.fields.range&&(Dt=bt.fields.range)}if(Dt=Dt||[0,1],Ve){rt.push("RASTER_COLOR"),Oe.activeTexture.set(ze.TEXTURE2),Ie.updateColorRamp(Dt);let bt=Ie.colorRampTexture;bt||(bt=Ie.colorRampTexture=new i.T(Oe,Ie.colorRamp,ze.RGBA8)),bt.bind(ze.LINEAR,ze.CLAMP_TO_EDGE)}return{mix:et,range:Dt,offset:wt,defines:rt,resampling:Ke}}(X,u,U,V);if(X instanceof i.aK&&!g.length&&!A)return;const re=u.paint.get("raster-emissive-strength"),ce=y.colorModeForDrapableLayerRenderPass(re),se=y.terrain&&y.terrain.renderingToTexture,pe=!y.options.moving,me=u.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;if(X instanceof i.aK&&!g.length&&(X.onNorthPole||X.onSouthPole)){const Pe=L?y.stencilModeFor3D():Lr.disabled;return void at(!!X.onNorthPole,null,y,s,u,re,Y,Or.disabled,Pe)}if(!g.length)return;const[be,Ee]=X instanceof i.aK||se?[{},g]:y.stencilConfigForOverlap(g),Te=Ee[Ee.length-1].overscaledZ;z&&Y.defines.push("PROJECTION_GLOBE_VIEW"),L&&Y.defines.push("RENDER_CUTOFF");const Re=(Pe,Ie,Oe)=>{for(const ze of Pe){const Ve=ze.toUnwrapped(),dt=s.getTile(ze);if(se&&(!dt||!dt.hasData()))continue;U.activeTexture.set(V.TEXTURE0);const rt=jv(dt,X,u,Y);if(!rt||!rt.texture)continue;const{texture:St,mix:Tt,offset:Dt,tileSize:et,buffer:wt}=rt;let Ke,bt;se?(Ke=gr.disabled,bt=ze.projMatrix):L?(Ke=new gr(V.LEQUAL,gr.ReadWrite,y.depthRangeFor3D),bt=A?Float32Array.from(y.transform.expandedFarZProjMatrix):y.transform.calculateProjMatrix(Ve,pe)):(Ke=y.depthModeForSublayer(ze.overscaledZ-Te,u.paint.get("raster-opacity")===1?gr.ReadWrite:gr.ReadOnly,V.LESS),bt=y.transform.calculateProjMatrix(Ve,pe));const yt=y.terrain&&se?y.terrain.stencilModeForRTTOverlap(ze):be[ze.overscaledZ],Et=S?0:u.paint.get("raster-fade-duration");dt.registerFadeDuration(Et);const ht=s.findLoadedParent(ze,0),Ct=Av(dt,ht,s,y.transform,Et);let Gt,qt;y.terrain&&y.terrain.prepareDrawTile(),U.activeTexture.set(V.TEXTURE0),St.bind(me,V.CLAMP_TO_EDGE),U.activeTexture.set(V.TEXTURE1),ht?(ht.texture&&ht.texture.bind(me,V.CLAMP_TO_EDGE),Gt=Math.pow(2,ht.tileID.overscaledZ-dt.tileID.overscaledZ),qt=[dt.tileID.canonical.x*Gt%1,dt.tileID.canonical.y*Gt%1]):St.bind(me,V.CLAMP_TO_EDGE),"useMipmap"in St&&U.extTextureFilterAnisotropic&&y.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const Zt=y.transform;let sr;const kr=L?j2(Zt):[0,0,0,0];let xr,Pr,Ar,nn,wn,Kn=0;if(z&&X instanceof i.aK&&X.coordinates.length>3)xr=Float32Array.from(i.bc(i.cI(new i.bT(0,0,0)))),Pr=Float32Array.from(Zt.globeMatrix),Ar=Float32Array.from(i.cE(Zt)),nn=[i.av(Zt.center.lng),i.aC(Zt.center.lat)],sr=X.elevatedGlobePerspectiveTransform,wn=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(z){const lr=i.cF(ze.canonical);Kn=i.cG(lr.getCenter().lat),xr=Float32Array.from(i.bc(i.cI(ze.canonical))),Pr=Float32Array.from(Zt.globeMatrix),Ar=Float32Array.from(i.cE(Zt)),nn=[i.av(Zt.center.lng),i.aC(Zt.center.lat)],sr=[0,0],wn=Float32Array.from(i.cH(ze.canonical,lr,Kn,Zt.worldSize/Zt._pixelsPerMercatorPixel))}else sr=X instanceof i.aK?X.perspectiveTransform:[0,0],xr=new Float32Array(16),Pr=new Float32Array(9),Ar=new Float32Array(16),nn=[0,0],wn=new Float32Array(9);const Yr=t1(bt,xr,Pr,Ar,wn,qt||[0,0],i.ag(y.transform.zoom),nn,kr,Gt||1,Ct,u,sr,L?u.paint.get("raster-elevation"):0,2,Tt,Dt,Y.range,et,wt,re),fi=y.isTileAffectedByFog(ze),Nr=y.getOrCreateProgram("raster",{defines:Y.defines,overrideFog:fi});if(y.uploadCommonUniforms(U,Nr,Ve),X instanceof i.aK){const lr=X.elevatedGlobeVertexBuffer,sn=X.elevatedGlobeIndexBuffer;if(se||!A)X.boundsBuffer&&X.boundsSegments&&Nr.draw(y,V.TRIANGLES,Ke,Lr.disabled,ce,Or.disabled,Yr,u.id,X.boundsBuffer,y.quadTriangleIndexBuffer,X.boundsSegments);else if(lr&&sn){const kn=Zt.zoom<=i.c6?X.elevatedGlobeSegments:X.getSegmentsForLongitude(Zt.center.lng);kn&&Nr.draw(y,V.TRIANGLES,Ke,Lr.disabled,ce,Ie,Yr,u.id,lr,sn,kn)}}else if(z){Ke=new gr(V.LEQUAL,gr.ReadOnly,y.depthRangeFor3D);const lr=y.globeSharedBuffers;if(lr){const[sn,kn,mn]=lr.getGridBuffers(Kn,!1);Nr.draw(y,V.TRIANGLES,Ke,Oe||yt,y.colorModeForRenderPass(),Ie,Yr,u.id,sn,kn,mn)}}else{const{tileBoundsBuffer:lr,tileBoundsIndexBuffer:sn,tileBoundsSegments:kn}=y.getTileBoundsBuffers(dt);Nr.draw(y,V.TRIANGLES,Ke,yt,ce,Or.disabled,Yr,u.id,lr,sn,kn)}}if(!(X instanceof i.aK)&&z)for(const ze of Pe){const Ve=ze.canonical.y===(1<<ze.canonical.z)-1;ze.canonical.y===0&&at(!0,ze,y,s,u,re,Y,Ie,Oe||Lr.disabled),Ve&&at(!1,ze,y,s,u,re,Y,Ie===Or.frontCW?Or.backCW:Or.frontCW,Oe||Lr.disabled)}};z?Re(Ee,y.renderElevatedRasterBackface?Or.backCW:Or.frontCW,y.stencilModeFor3D()):Re(Ee,Or.disabled,void 0),y.resetStencilClippingMasks()},"raster-particle":function(y,s,u,g,x,S){y.renderPass==="offscreen"&&function(A,L,z,U){if(!U.length)return;const V=A.context,X=V.gl,Y=L.getSource();if(!(Y instanceof $c))return;const re=Math.ceil(Math.sqrt(z.paint.get("raster-particle-count")));let ce=z.particlePositionRGBAImage;if(!ce||ce.width!==re){const Ee=function(Te){const Re=Te*Te,Pe=new Uint8Array(4*Re),Ie=function(ze){return ze|=0,ze=Math.imul(2747636419^ze,2654435769),ze=Math.imul(ze^ze>>>16,2654435769),((ze=Math.imul(ze^ze>>>16,2654435769))>>>0)/4294967296},Oe=1/1.1;for(let ze=0;ze<Re;ze++){const Ve=Oe*(Ie(2*ze+0)+Ts),dt=Oe*(Ie(2*ze+1)+Ts),rt=255*Ve%1,St=255*dt%1,Tt=rt,Dt=dt-St/255,et=St;Pe[4*ze+0]=255*(Ve-rt/255),Pe[4*ze+1]=255*Tt,Pe[4*ze+2]=255*Dt,Pe[4*ze+3]=255*et}return Pe}(re);ce=z.particlePositionRGBAImage=new i.r({width:re,height:re},Ee)}let se=z.particleFramebuffer;se?se.width!==re&&(se.destroy(),se=z.particleFramebuffer=V.createFramebuffer(re,re,!0,null)):se=z.particleFramebuffer=V.createFramebuffer(re,re,!0,null);const pe=[];for(const Ee of U){const Te=L.getTile(Ee);if(!(Te instanceof $a))continue;const Re=F2(Te,Y,z);if(!Re)continue;const Pe=[Te.tileSize,Te.tileSize];let Ie=z.tileFramebuffer;Ie||(Ie=z.tileFramebuffer=V.createFramebuffer(Pe[0],Pe[1],!0,null));let Oe=Te.rasterParticleState;Oe||(Oe=Te.rasterParticleState=new d1(V,Ee,Pe,ce));const ze=Oe.update(z.lastInvalidatedAt);Oe.particleTextureDimension!==re&&Oe.updateParticleTexture(Ee,ce);const Ve=Oe.targetColorTexture;Oe.targetColorTexture=Oe.backgroundColorTexture,Oe.backgroundColorTexture=Ve;const dt=Oe.particleTexture0;Oe.particleTexture0=Oe.particleTexture1,Oe.particleTexture1=dt,pe.push([Ee,Re,Oe,ze])}if(pe.length===0)return;const me=i.q.now(),be=z.previousDrawTimestamp?.001*(me-z.previousDrawTimestamp):.0167;if(z.previousDrawTimestamp=me,z.hasColorMap()){V.activeTexture.set(X.TEXTURE0+2);let Ee=z.colorRampTexture;Ee||(Ee=z.colorRampTexture=new i.T(V,z.colorRamp,X.RGBA8)),Ee.bind(X.LINEAR,X.CLAMP_TO_EDGE)}V.bindFramebuffer.set(z.tileFramebuffer.framebuffer),function(Ee,Te,Re){const Pe=Ee.context,Ie=Pe.gl,Oe=Te.tileFramebuffer;Pe.activeTexture.set(Ie.TEXTURE0);const ze={u_texture:0,u_opacity:1.05*(dt=Te.paint.get("raster-particle-fade-opacity-factor"))/(dt+.05)},Ve=Ee.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var dt;for(const rt of Re){const[,,St,Tt]=rt;Oe.colorAttachment.set(St.targetColorTexture.texture),Pe.viewport.set([0,0,Oe.width,Oe.height]),Pe.clear({color:i.al.transparent}),Tt&&(St.backgroundColorTexture.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE),Ve.draw(Ee,Ie.TRIANGLES,gr.disabled,Lr.disabled,Jr.alphaBlended,Or.disabled,ze,Te.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments))}}(A,z,pe),function(Ee,Te,Re,Pe){const Ie=Ee.context,Oe=Ie.gl,ze=Re.tileFramebuffer,Ve=Ee.transform.projection.name==="globe",dt=Re.paint.get("raster-particle-max-speed");for(const rt of Pe){const[St,Tt,Dt]=rt;Ie.activeTexture.set(Oe.TEXTURE0+0),Tt.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),ze.colorAttachment.set(Dt.targetColorTexture.texture);const et=Ee.getOrCreateProgram("rasterParticleDraw",{defines:Tt.defines,overrideFog:!1});Ie.activeTexture.set(Oe.TEXTURE0+1);const wt=Tt.scalarData?[]:[0,1,2,3].map(yt=>i.d7[yt](St));wt.push(St);const Ke=St.canonical.x,bt=St.canonical.y;for(const yt of wt){const Et=Te.getTile(Ve?yt.wrapped():yt);if(!Et)continue;const ht=Et.rasterParticleState;if(!ht)continue;const Ct=yt.canonical.x+(1<<yt.canonical.z)*(yt.wrap-St.wrap),Gt=yt.canonical.y;ht.particleTexture0.bind(Oe.NEAREST,Oe.CLAMP_TO_EDGE);const qt=r1(1,ht.particleTexture0.size[0],[Ct-Ke,Gt-bt],0,Tt.texture.size,2,dt,Tt.textureOffset,Tt.scale,Tt.offset);et.draw(Ee,Oe.POINTS,gr.disabled,Lr.disabled,Jr.alphaBlended,Or.disabled,qt,Re.id,ht.particleIndexBuffer,void 0,ht.particleSegment)}}}(A,L,z,pe),V.bindFramebuffer.set(z.particleFramebuffer.framebuffer),function(Ee,Te,Re,Pe){const Ie=Ee.context,Oe=Ie.gl,ze=Te.paint.get("raster-particle-max-speed"),Ve=Pe*Te.paint.get("raster-particle-speed-factor")*.15,dt=function(St){return Math.pow(St,6)}(.01+1*Te.paint.get("raster-particle-reset-rate-factor")),rt=Te.particleFramebuffer;Ie.viewport.set([0,0,rt.width,rt.height]);for(const St of Re){const[,Tt,Dt]=St;Ie.activeTexture.set(Oe.TEXTURE0+0),Tt.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),Ie.activeTexture.set(Oe.TEXTURE0+1);const et=Dt.particleTexture0;et.bind(Oe.NEAREST,Oe.CLAMP_TO_EDGE);const wt=TD(1,et.size[0],0,Tt.texture.size,ze,Ve,dt,Tt.textureOffset,Tt.scale,Tt.offset);rt.colorAttachment.set(Dt.particleTexture1.texture),Ie.clear({color:i.al.transparent}),Ee.getOrCreateProgram("rasterParticleUpdate",{defines:Tt.defines}).draw(Ee,Oe.TRIANGLES,gr.disabled,Lr.disabled,Jr.unblended,Or.disabled,wt,Te.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments)}}(A,z,pe,be)}(y,s,u,g),y.renderPass==="translucent"&&(function(A,L,z,U,V){const X=A.context,Y=X.gl,re=L.getSource().tileSize,ce=5*(1-i.ae(i.bY,i.bY+1,A.transform.zoom))*re+z.paint.get("raster-particle-elevation"),se=!A.options.moving,pe=A.transform.projection.name==="globe";if(!U.length)return;const[me,be]=A.stencilConfigForOverlap(U),Ee=[];pe&&Ee.push("PROJECTION_GLOBE_VIEW");const Te=A.stencilModeFor3D();for(const Re of be){const Pe=Re.toUnwrapped(),Ie=L.getTile(Re);if(!Ie.rasterParticleState)continue;const Oe=Ie.rasterParticleState,ze=100;Ie.registerFadeDuration(ze);const Ve=L.findLoadedParent(Re,0),dt=Av(Ie,Ve,L,A.transform,ze);let rt,St;A.terrain&&A.terrain.prepareDrawTile(),X.activeTexture.set(Y.TEXTURE0),Oe.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),X.activeTexture.set(Y.TEXTURE1),Ve&&Ve.rasterParticleState?(Ve.rasterParticleState.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),rt=Math.pow(2,Ve.tileID.overscaledZ-Ie.tileID.overscaledZ),St=[Ie.tileID.canonical.x*rt%1,Ie.tileID.canonical.y*rt%1]):Oe.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Tt=pe?Float32Array.from(A.transform.expandedFarZProjMatrix):A.transform.calculateProjMatrix(Pe,se),Dt=A.transform,et=B2(Dt),wt=i.cF(Re.canonical),Ke=i.cG(wt.getCenter().lat);let bt,yt,Et,ht,Ct;pe?(bt=Float32Array.from(i.bc(i.cI(Re.canonical))),yt=Float32Array.from(Dt.globeMatrix),Et=Float32Array.from(i.cE(Dt)),ht=[i.av(Dt.center.lng),i.aC(Dt.center.lat)],Ct=Float32Array.from(i.cH(Re.canonical,wt,Ke,Dt.worldSize/Dt._pixelsPerMercatorPixel))):(bt=new Float32Array(16),yt=new Float32Array(9),Et=new Float32Array(16),ht=[0,0],Ct=new Float32Array(9));const Gt=vr(Tt,bt,yt,Et,Ct,St||[0,0],i.ag(A.transform.zoom),ht,et,rt||1,dt,ce),qt=A.isTileAffectedByFog(Re),Zt=A.getOrCreateProgram("rasterParticle",{defines:Ee,overrideFog:qt});if(A.uploadCommonUniforms(X,Zt,Pe),pe){const sr=new gr(Y.LEQUAL,gr.ReadOnly,A.depthRangeFor3D),kr=0,xr=A.globeSharedBuffers;if(xr){const[Pr,Ar,nn]=xr.getGridBuffers(Ke,kr!==0);Zt.draw(A,Y.TRIANGLES,sr,Te,Jr.alphaBlended,A.renderElevatedRasterBackface?Or.frontCCW:Or.backCCW,Gt,z.id,Pr,Ar,nn)}}else{const sr=A.depthModeForSublayer(0,gr.ReadOnly),kr=me[Re.overscaledZ],{tileBoundsBuffer:xr,tileBoundsIndexBuffer:Pr,tileBoundsSegments:Ar}=A.getTileBoundsBuffers(Ie);Zt.draw(A,Y.TRIANGLES,sr,kr,Jr.alphaBlended,Or.disabled,Gt,z.id,xr,Pr,Ar)}}A.resetStencilClippingMasks()}(y,s,u,g),y.style.map.triggerRepaint())},background:function(y,s,u,g){const x=u.paint.get("background-color"),S=u.paint.get("background-color-use-theme").constantOr("default")==="none",A=u.paint.get("background-opacity"),L=u.paint.get("background-emissive-strength"),z=u.paint.get("background-pitch-alignment")==="viewport";if(A===0)return;const U=y.context,V=U.gl,X=y.transform,Y=X.tileSize,re=u.paint.get("background-pattern");let ce;if(re!==void 0&&(re===null||(ce=y.imageManager.getPattern(i.I.from(re.toString()),u.scope,y.style.getLut(u.scope)),!ce)))return;const se=!re&&x.a===1&&A===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==se)return;const pe=Lr.disabled,me=y.depthModeForSublayer(0,se==="opaque"?gr.ReadWrite:gr.ReadOnly),be=y.colorModeForDrapableLayerRenderPass(L),Ee=re?"backgroundPattern":"background";let Te,Re=g;if(Re||(Te=y.getBackgroundTiles(),Re=Object.values(Te).map(Pe=>Pe.tileID)),re&&(U.activeTexture.set(V.TEXTURE0),y.imageManager.bind(y.context,u.scope)),z){const Pe=y.getOrCreateProgram(Ee,{overrideFog:!1,overrideRtt:!0}),Ie=new Float32Array(i.ad.mat4.identity([])),Oe=new i.aH(0,0,0,0,0),ze=re?L2(Ie,L,A,y,0,u.scope,ce,z,{tileID:Oe,tileSize:Y}):n1(Ie,L,A,x.toRenderColor(S?null:u.lut));Pe.draw(y,V.TRIANGLES,me,pe,be,Or.disabled,ze,u.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments)}else for(const Pe of Re){const Ie=y.isTileAffectedByFog(Pe),Oe=y.getOrCreateProgram(Ee,{overrideFog:Ie}),ze=Pe.toUnwrapped(),Ve=g?Pe.projMatrix:y.transform.calculateProjMatrix(ze);y.prepareDrawTile();const dt=s?s.getTile(Pe):Te?Te[Pe.key]:new Il(Pe,Y,X.zoom,y),rt=re?L2(Ve,L,A,y,0,u.scope,ce,z,{tileID:Pe,tileSize:Y}):n1(Ve,L,A,x.toRenderColor(S?null:u.lut));y.uploadCommonUniforms(U,Oe,ze);const{tileBoundsBuffer:St,tileBoundsIndexBuffer:Tt,tileBoundsSegments:Dt}=y.getTileBoundsBuffers(dt);Oe.draw(y,V.TRIANGLES,me,pe,be,Or.disabled,rt,u.id,St,Tt,Dt)}},sky:function(y,s,u){const g=y._atmosphere?i.ag(y.transform.zoom):1,x=u.paint.get("sky-opacity")*g;if(x===0)return;const S=y.context,A=u.paint.get("sky-type"),L=new gr(S.gl.LEQUAL,gr.ReadOnly,[0,1]),z=y.frameCounter/1e3%1;A==="atmosphere"?y.renderPass==="offscreen"?u.needsSkyboxCapture(y)&&(function(U,V,X,Y){const re=U.context,ce=re.gl;let se=V.skyboxFbo;if(!se){se=V.skyboxFbo=re.createFramebuffer(32,32,!0,null),V.skyboxGeometry=new U2(re),V.skyboxTexture=re.gl.createTexture(),ce.bindTexture(ce.TEXTURE_CUBE_MAP,V.skyboxTexture),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MAG_FILTER,ce.LINEAR);for(let Ee=0;Ee<6;++Ee)ce.texImage2D(ce.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,ce.RGBA,32,32,0,ce.RGBA,ce.UNSIGNED_BYTE,null)}re.bindFramebuffer.set(se.framebuffer),re.viewport.set([0,0,32,32]);const pe=V.getCenter(U,!0),me=U.getOrCreateProgram("skyboxCapture"),be=new Float64Array(16);i.ad.mat4.identity(be),i.ad.mat4.rotateY(be,be,.5*-Math.PI),zo(U,V,me,be,pe,0),i.ad.mat4.identity(be),i.ad.mat4.rotateY(be,be,.5*Math.PI),zo(U,V,me,be,pe,1),i.ad.mat4.identity(be),i.ad.mat4.rotateX(be,be,.5*-Math.PI),zo(U,V,me,be,pe,2),i.ad.mat4.identity(be),i.ad.mat4.rotateX(be,be,.5*Math.PI),zo(U,V,me,be,pe,3),i.ad.mat4.identity(be),zo(U,V,me,be,pe,4),i.ad.mat4.identity(be),i.ad.mat4.rotateY(be,be,Math.PI),zo(U,V,me,be,pe,5),re.viewport.set([0,0,U.width,U.height])}(y,u),u.markSkyboxValid(y)):y.renderPass==="sky"&&function(U,V,X,Y,re){const ce=U.context,se=ce.gl,pe=U.transform,me=U.getOrCreateProgram("skybox");ce.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,V.skyboxTexture);const be=((Ee,Te,Re,Pe,Ie)=>({u_matrix:Ee,u_sun_direction:Te,u_cubemap:0,u_opacity:Pe,u_temporal_offset:Ie}))(pe.skyboxMatrix,V.getCenter(U,!1),0,Y,re);U.uploadCommonUniforms(ce,me),me.draw(U,se.TRIANGLES,X,Lr.disabled,U.colorModeForRenderPass(),Or.backCW,be,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(y,u,L,x,z):A==="gradient"&&y.renderPass==="sky"&&function(U,V,X,Y,re){const ce=U.context,se=ce.gl,pe=U.transform,me=U.getOrCreateProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new U2(ce)),ce.activeTexture.set(se.TEXTURE0);let be=V.colorRampTexture;be||(be=V.colorRampTexture=new i.T(ce,V.colorRamp,se.RGBA8)),be.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Ee=((Te,Re,Pe,Ie,Oe)=>({u_matrix:Te,u_color_ramp:0,u_center_direction:Re,u_radius:i.ak(Pe),u_opacity:Ie,u_temporal_offset:Oe}))(pe.skyboxMatrix,V.getCenter(U,!1),V.paint.get("sky-gradient-radius"),Y,re);U.uploadCommonUniforms(ce,me),me.draw(U,se.TRIANGLES,X,Lr.disabled,U.colorModeForRenderPass(),Or.backCW,Ee,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(y,u,L,x,z)},debug:function(y,s,u,g,x,S){for(let A=0;A<u.length;A++)if(x){const U=new i.al(g.r*.8,g.g*.8,g.b*.8,1);rd(y,s,u[A],g,-1,-1,S),rd(y,s,u[A],g,-1,1,S),rd(y,s,u[A],g,1,1,S),rd(y,s,u[A],g,1,-1,S),rd(y,s,u[A],U,0,0,S)}else rd(y,s,u[A],g,0,0,S)},custom:function(y,s,u,g){const x=y.context,S=u.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&u.isDraped(s)){if(y.renderPass==="offscreen"){const A=S.prerender;if(A){if(y.setCustomLayerDefaults(),x.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const L=y.transform.pointMerc;A.call(S,x.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),i.ag(y.transform.zoom),[L.x,L.y],y.transform.pixelsPerMeterRatio)}else A.call(S,x.gl,y.transform.customLayerMatrix());x.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const L=S.renderToTile;if(L){const z=g[0].canonical,U=new i.ac(z.x+g[0].wrap*(1<<z.z),z.y,z.z);x.setDepthMode(gr.disabled),x.setStencilMode(Lr.disabled),x.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),L.call(S,x.gl,U),x.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),x.setColorMode(y.colorModeForRenderPass()),x.setStencilMode(Lr.disabled);const A=S.renderingMode==="3d"?new gr(y.context.gl.LEQUAL,gr.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,gr.ReadOnly);if(x.setDepthMode(A),y.transform.projection.name==="globe"){const L=y.transform.pointMerc;S.render(x.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),i.ag(y.transform.zoom),[L.x,L.y],y.transform.pixelsPerMeterRatio)}else S.render(x.gl,y.transform.customLayerMatrix());x.setDirty(),y.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(y,s,u,g){if(y.renderPass==="opaque")return;const x=u.paint.get("model-opacity").constantOr(1);if(x===0)return;const S=u.paint.get("model-cast-shadows");if(y.renderPass==="shadow"&&(!S||y.terrain&&x<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof i.ab))return;const A=y.shadowRenderer,L=u.paint.get("model-receive-shadows");A&&(A.useNormalOffset=!0,L||(A.enabled=!1));const z=()=>{A&&(A.useNormalOffset=!0,L||(A.enabled=!0))},U=s.getSource();if(y.renderPass==="light-beam"&&U.type!=="batched-model")return;if(U.type==="vector"||U.type==="geojson")return function(me,be,Ee,Te,Re){const Pe=me.transform;if(Pe.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Pe.projection.name} projection is not yet implemented`);const Ie=Pe.getFreeCameraOptions().position;if(!me.modelManager)return;const Oe=me.modelManager;Ee.modelManager=Oe;const ze=me.shadowRenderer;if(!Ee._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ve=Ee._unevaluatedLayout._values["model-id"],dt=Object.assign({},Ee.layout.get("model-id").parameters),rt=me.style.order.indexOf(Ee.fqid);for(const St of Te){const Tt=be.getTile(St).getBucket(Ee);if(!Tt||Tt.projection.name!==Pe.projection.name)continue;const Dt=Tt.getModelUris();Dt&&!Tt.modelsRequested&&(Oe.addModelsFromBucket(Dt,Re),Tt.modelsRequested=!0);const et=m1(St,Pe);dt.zoom=et;const wt=Ve.possiblyEvaluate(dt);if(p1(me,Tt,St),Qs.shadowUniformsInitialized=!1,Qs.useSingleShadowCascade=!!ze&&ze.getMaxCascadeForTile(St.toUnwrapped())===0,me.renderPass==="shadow"&&ze){if(me.currentShadowCascade===1&&Tt.isInsideFirstShadowMapFrustum)continue;const yt=Pe.calculatePosMatrix(St.toUnwrapped(),Pe.worldSize);if(Qs.tileMatrix.set(yt),Qs.shadowTileMatrix=Float32Array.from(ze.calculateShadowPassMatrixFromMatrix(yt)),Qs.aabb.min.fill(0),Qs.aabb.max[0]=Qs.aabb.max[1]=i.ai,Qs.aabb.max[2]=0,$v(Tt,Qs,me,Ee.scope))continue}const Ke=1<<St.canonical.z,bt=[((Ie.x-St.wrap)*Ke-St.canonical.x)*i.ai,(Ie.y*Ke-St.canonical.y)*i.ai,Ie.z*Ke*i.ai];me.conflationActive&&Object.keys(Tt.instancesPerModel).length>0&&me.style.isLayerClipped(Ee,be.getSource())&&Tt.updateReplacement(St,me.replacementSource,rt,Re)&&(Tt.uploaded=!1,Tt.upload(me.context));for(let yt in Tt.instancesPerModel){const Et=Tt.instancesPerModel[yt];Et.features.length>0&&(yt=wt.evaluate(Et.features[0].feature,{}));const ht=Oe.getModel(yt,Re);if(ht&&ht.uploaded)for(const Ct of ht.nodes)Dl(me,Ee,Ct,Et,bt,St,Qs)}}}(y,s,u,g,U.type==="vector"?u.scope:""),void z();if(!U.loaded())return;if(U.type==="batched-model")return function(me,be,Ee,Te){Ee.resetLayerRenderingStats(me);const Re=me.context,Pe=me.transform,Ie=me.style.fog,Oe=me.shadowRenderer;if(Pe.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Pe.projection.name} projection is not yet implemented`);const ze=me.transform.getFreeCameraOptions().position,Ve=i.ad.vec3.scale([],[ze.x,ze.y,ze.z],me.transform.worldSize),dt=i.ad.vec3.negate([],Ve),rt=i.ad.mat4.identity([]),St=i.dm(Pe.center.lat,Pe.zoom),Tt=i.ad.mat4.fromScaling([],[1,1,1/St]);i.ad.mat4.translate(rt,rt,dt);const Dt=Ee.paint.get("model-opacity").constantOr(1),et=new gr(Re.gl.LEQUAL,gr.ReadWrite,me.depthRangeFor3D),wt=new gr(Re.gl.LEQUAL,gr.ReadOnly,me.depthRangeFor3D),Ke=new i.ce([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),bt=me.renderPass==="shadow",yt=bt&&Oe?Oe.getCurrentCascadeFrustum():Pe.getFrustum(Pe.scaleZoom(Pe.worldSize)),Et=Ee.paint.get("model-front-cutoff"),ht=Et[2]<1,Ct=Zc(me,Ee.paint.get("model-cutoff-fade-range")),Gt=Ee.getLayerRenderingStats();(function(qt,Zt,sr,kr){const xr=qt.terrain?qt.terrain.exaggeration():0,Pr=qt.transform.zoom;for(const Ar of kr){const nn=Zt.getTile(Ar).getBucket(sr);nn&&(nn.setFilter(sr.filter),qt.conflationActive&&nn.updateReplacement(Ar,qt.replacementSource),nn.evaluateScale(qt,sr),qt.terrain&&xr>0&&nn.elevationUpdate(qt.terrain,xr,Ar,sr.source),nn.needsReEvaluation(qt,Pr,sr)&&nn.evaluate(sr))}})(me,be,Ee,Te),function(){let qt,Zt,sr;ht?(qt=Te.length-1,Zt=-1,sr=-1):(qt=0,Zt=Te.length,sr=1);const kr=new Float64Array(16),xr=i.ad.vec3.create(),Pr=new i.P(0,0);for(let Ar=qt;Ar!==Zt;Ar+=sr){const nn=Te[Ar],wn=be.getTile(nn).getBucket(Ee);if(!wn||!wn.uploaded)continue;let Kn=!1;Oe&&(Kn=Oe.getMaxCascadeForTile(nn.toUnwrapped())===0);const Yr=Pe.calculatePosMatrix(nn.toUnwrapped(),Pe.worldSize),fi=wn.modelTraits;!bt&&ht&&(i.ad.mat4.invert(kr,Yr),i.ad.vec3.transformMat4(xr,Ve,kr),Pr.x=xr[0],Pr.y=xr[1]);const Nr=[];wn.setFilter(Ee.filter);for(const lr of wn.getNodesInfo()){if(lr.hiddenByReplacement||!lr.node.meshes)continue;const sn=lr.node;let kn=0;me.terrain&&sn.elevation&&(kn=sn.elevation*me.terrain.exaggeration());const mn=(()=>{const $n=lr.aabb;return Ke.min=[...$n.min],Ke.max=[...$n.max],Ke.min[2]+=kn,Ke.max[2]+=kn,i.ad.vec3.transformMat4(Ke.min,Ke.min,Yr),i.ad.vec3.transformMat4(Ke.max,Ke.max,Yr),Ke})(),Mi=lr.evaluatedScale;if(Mi[0]<=1&&Mi[1]<=1&&Mi[2]<=1&&mn.intersects(yt)===0)continue;if(!bt&&ht){const $n=.16666666666666666;lr.cameraCollisionOpacity=Ve[0]>mn.min[0]&&Ve[0]<mn.max[0]&&Ve[1]>mn.min[1]&&Ve[1]<mn.max[1]&&Ve[2]*St<mn.max[2]&&sn.footprint&&i.bA(Pr,sn.footprint)?Math.max(lr.cameraCollisionOpacity-$n,0):Math.min(1,lr.cameraCollisionOpacity+$n)}const Yi=[...Yr],yo=sn.anchor?sn.anchor[0]:0,To=sn.anchor?sn.anchor[1]:0;i.ad.mat4.translate(Yi,Yi,[yo*(Mi[0]-1),To*(Mi[1]-1),kn]),i.ad.vec3.exactEquals(Mi,i.dq)||i.ad.mat4.scale(Yi,Yi,Mi);const Cs=i.ad.mat4.multiply([],Yi,sn.matrix),pa=i.ad.mat4.multiply([],Pe.expandedFarZProjMatrix,Cs),hn=i.ad.mat4.multiply([],Pe.expandedFarZProjMatrix,Yi),pi=i.ad.vec4.transformMat4([],[yo,To,kn,1],pa)[2];sn.hidden=!1;let Sn=Dt;bt||(ht&&(Sn*=lr.cameraCollisionOpacity,Sn*=g1(Yi,Pe,lr.aabb,Et)),Sn*=Uv(Ct,pi)),Sn!==0?Nr.push({nodeInfo:lr,depth:pi,opacity:Sn,wvpForNode:pa,wvpForTile:hn,nodeModelMatrix:Cs,tileModelMatrix:Yi}):sn.hidden=!0}bt||Nr.sort((lr,sn)=>!ht||lr.opacity===1&&sn.opacity===1?lr.depth<sn.depth?-1:1:lr.opacity===1?-1:sn.opacity===1?1:lr.depth>sn.depth?-1:1);for(const lr of Nr){const sn=lr.nodeInfo,kn=sn.node;let mn=i.ad.mat4.multiply([],Tt,lr.tileModelMatrix);i.ad.mat4.multiply(mn,rt,mn);const Mi=i.ad.mat4.invert([],mn);i.ad.mat4.transpose(Mi,Mi),i.ad.mat4.scale(Mi,Mi,nd),mn=i.ad.mat4.multiply(mn,mn,kn.matrix);const Yi=me.renderPass==="light-beam",yo=Ee.paint.get("model-color-use-theme").constantOr("default")==="none",To=fi&i.ds.HasMapboxMeshFeatures,Cs=To?0:sn.evaluatedRMEA[0][2];for(let pa=0;pa<kn.meshes.length;++pa){const hn=kn.meshes[pa],pi=pa===kn.lightMeshIndex;let Sn=lr.wvpForNode;if(pi){if(!Yi&&!me.terrain&&me.shadowRenderer){me.currentLayer<me.firstLightBeamLayer&&(me.firstLightBeamLayer=me.currentLayer);continue}Sn=lr.wvpForTile}else if(Yi)continue;const $n={defines:[]},Zo=[];if(!bt&&Oe&&(Oe.useNormalOffset=!!hn.normalBuffer),Zf($n.defines,Zo,hn,me,yo?null:Ee.lut),To||$n.defines.push("DIFFUSE_SHADED"),Kn&&$n.defines.push("SHADOWS_SINGLE_CASCADE"),Gt&&(bt?Gt.numRenderedVerticesInShadowPass+=hn.vertexArray.length:Gt.numRenderedVerticesInTransparentPass+=hn.vertexArray.length),bt){ug(hn,lr.nodeModelMatrix,me,Ee);continue}let si=null;if(Ie){const rl=Qc(lr.nodeModelMatrix,me.transform);if(si=new Float32Array(rl),Pe.projection.name!=="globe"){const ns=hn.aabb.min,ru=hn.aabb.max,[mc,nu]=Ie.getOpacityForBounds(rl,ns[0],ns[1],ru[0],ru[1]);$n.overrideFog=mc>=Kt||nu>=Kt}}const vo=hn.material;let pc;vo.occlusionTexture&&vo.occlusionTexture.offsetScale&&(pc=vo.occlusionTexture.offsetScale,$n.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const rs=me.getOrCreateProgram("model",$n);!bt&&Oe&&Oe.setupShadowsFromMatrix(lr.tileModelMatrix,rs,Oe.useNormalOffset),me.uploadCommonUniforms(Re,rs,null,si);const tl=vo.pbrMetallicRoughness;tl.metallicFactor=.9,tl.roughnessFactor=.5;const Va=i1(new Float32Array(Sn),new Float32Array(mn),new Float32Array(Mi),new Float32Array(kn.matrix),me,lr.opacity,tl.baseColorFactor.toRenderColor(null),vo.emissiveFactor,tl.metallicFactor,tl.roughnessFactor,vo,Cs,Ee,[0,0,0],pc);!pi&&(sn.hasTranslucentParts||lr.opacity<1)&&rs.draw(me,Re.gl.TRIANGLES,et,Lr.disabled,Jr.disabled,Or.backCCW,Va,Ee.id,hn.vertexBuffer,hn.indexBuffer,hn.segments,Ee.paint,me.transform.zoom,void 0,Zo),rs.draw(me,Re.gl.TRIANGLES,pi?wt:et,Lr.disabled,pi||lr.opacity<1||sn.hasTranslucentParts?Jr.alphaBlended:Jr.unblended,Or.backCCW,Va,Ee.id,hn.vertexBuffer,hn.indexBuffer,hn.segments,Ee.paint,me.transform.zoom,void 0,Zo)}}}}()}(y,s,u,g),void z();if(U.type!=="model")return;const V=U.getModels(),X=[],Y=y.transform.getFreeCameraOptions().position,re=i.ad.vec3.scale([],[Y.x,Y.y,Y.z],y.transform.worldSize);i.ad.vec3.negate(re,re);const ce=[],se=[];let pe=0;for(const me of V){const be=u.paint.get("model-rotation").constantOr(null),Ee=u.paint.get("model-scale").constantOr(null),Te=u.paint.get("model-translation").constantOr(null);me.computeModelMatrix(y,be,Ee,Te,!0,!0,!1);const Re=i.ad.mat4.identity([]),Pe=i.dm(me.position.lat,y.transform.zoom),Ie=i.ad.mat4.fromScaling([],[1,1,1/Pe]);i.ad.mat4.translate(Re,Re,re),X.push({zScaleMatrix:Ie,negCameraPosMatrix:Re});for(const Oe of me.nodes)ah(y.transform,Oe,me.matrix,y.transform.expandedFarZProjMatrix,pe,ce,se);pe++}if(ce.sort((me,be)=>be.depth-me.depth),y.renderPass!=="shadow"){if(x===1)for(const me of se)eu(me,y,u,X[me.modelIndex],Lr.disabled,y.colorModeForRenderPass());else{for(const me of se)eu(me,y,u,X[me.modelIndex],Lr.disabled,Jr.disabled);for(const me of se)eu(me,y,u,X[me.modelIndex],y.stencilModeFor3D(),y.colorModeForRenderPass());y.resetStencilClippingMasks()}for(const me of ce)eu(me,y,u,X[me.modelIndex],Lr.disabled,y.colorModeForRenderPass());z()}else{for(const me of se)ug(me.mesh,me.nodeModelMatrix,y,u);for(const me of ce)ug(me.mesh,me.nodeModelMatrix,y,u);z()}}},qv={line:function(y,s,u){if(y.hasElevatedBuckets=!1,y.hasNonElevatedBuckets=!1,y._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||y._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const g=s.getVisibleCoordinates();for(const x of g){const S=s.getTile(x).getBucket(y);if(S&&(S.hasZOffset?y.hasElevatedBuckets=!0:y.hasNonElevatedBuckets=!0,y.hasElevatedBuckets&&y.hasNonElevatedBuckets))break}}}else y.hasNonElevatedBuckets=!0},model:function(y,s,u){const g=s.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,g.type==="vector"?y.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const x=g.getModels();for(const S of x)S.upload(u.context)},raster:function(y,s,u){const g=s.getSource();if(!(g instanceof $c&&g.loaded()))return;const x=y.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const S=y.paint.get("raster-array-band")||g.getInitialBand(x);if(S==null)return;const A=s.getIds().map(L=>s.getTileByID(L));for(const L of A)L.updateNeeded(x,S)&&g.prepareTile(L,x,S)},"raster-particle":function(y,s,u){const g=s.getSource();if(!(g instanceof $c&&g.loaded()))return;const x=y.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const S=y.paint.get("raster-particle-array-band")||g.getInitialBand(x);if(S==null)return;const A=s.getIds().map(L=>s.getTileByID(L));for(const L of A)L.updateNeeded(x,S)&&g.prepareTile(L,x,S)}},Hv={fill:c1};class Zv{constructor(s,u,g,x,S){this.context=new td(s,u),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const A=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const z of A)this._debugParams.enabledLayers[z]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const z of A)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],z);this.occlusionParams=new v1(S),this.setup(),this.numSublayers=Xs.maxUnderzooming+Xs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dy,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Xc(this),this._wireframeDebugCache=new sh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const L=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,L,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x}updateTerrain(s,u){const g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new P2(this,s));const x=this._terrain;this.transform.elevation=g?x:null,x.update(s,this.transform,u),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(s){const u=s.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=u.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const S=g+.78*(x-g);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new P2(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,u){if(this.width=s*i.q.devicePixelRatio,this.height=u*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const s=this.context,u=new i.b5;u.emplaceBack(0,0),u.emplaceBack(i.ai,0),u.emplaceBack(0,i.ai),u.emplaceBack(i.ai,i.ai),this.tileExtentBuffer=s.createVertexBuffer(u,i.b7.members),this.tileExtentSegments=i.b8.simpleSegment(0,0,4,2);const g=new i.b5;g.emplaceBack(0,0),g.emplaceBack(i.ai,0),g.emplaceBack(0,i.ai),g.emplaceBack(i.ai,i.ai),this.debugBuffer=s.createVertexBuffer(g,i.b7.members),this.debugSegments=i.b8.simpleSegment(0,0,4,5);const x=new i.b5;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(x,i.b7.members),this.viewportSegments=i.b8.simpleSegment(0,0,4,2);const S=new i.aU;S.emplaceBack(0,0,0,0),S.emplaceBack(i.ai,0,i.ai,0),S.emplaceBack(0,i.ai,0,i.ai),S.emplaceBack(i.ai,i.ai,i.ai,i.ai),this.mercatorBoundsBuffer=s.createVertexBuffer(S,i.ba.members),this.mercatorBoundsSegments=i.b8.simpleSegment(0,0,4,2);const A=new i.aV;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(A);const L=new i.b6;for(const U of[0,1,3,2,0])L.emplaceBack(U);this.debugIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new i.T(s,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=i.ad.mat4.create();const z=this.context.gl;this.stencilClearMode=new Lr({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,gr.disabled,this.stencilClearMode,Jr.disabled,Or.disabled,Nf(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,u,g){if(!u||this.currentStencilSource===u.id||!s.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const z of g)if(this._tileClippingMaskIDs[z.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=u.id;const x=this.context,S=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(Jr.disabled),x.setDepthMode(gr.disabled);const A=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of g){const z=u.getTile(L),U=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:X,tileBoundsSegments:Y}=this.getTileBoundsBuffers(z);A.draw(this,S.TRIANGLES,gr.disabled,new Lr({func:S.ALWAYS,mask:0},U,255,S.KEEP,S.KEEP,S.REPLACE),Jr.disabled,Or.disabled,Nf(L.projMatrix),"$clipping",V,X,Y)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new Lr({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const u=this.context.gl;return new Lr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(s){const u=this.context.gl,g=s.sort((A,L)=>L.overscaledZ-A.overscaledZ),x=g[g.length-1].overscaledZ,S=g[0].overscaledZ-x+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const A={};for(let L=0;L<S;L++)A[L+x]=new Lr({func:u.GEQUAL,mask:255},L+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=S,[A,g]}return[{[x]:Lr.disabled},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Jr([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new i.al(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jr.unblended:Jr.alphaBlended}colorModeForDrapableLayerRenderPass(s){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Jr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new i.al(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,u,g,x=!1){if(this.depthOcclusion)return new gr(this.context.gl.GREATER,gr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return gr.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new gr(g||this.context.gl.LEQUAL,u,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,u=Math.ceil(this.width),g=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),S=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&g!==0&&(this.depthFBO=new Ua(this.context,u,g,!1,"texture"),this.depthTexture=new i.T(this.context,{width:u,height:g,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),s.bindTexture(s.TEXTURE_2D,S),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,u,g,0,0,u,g,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,u)=>s+u/this._fpsHistory.length,0))}render(s,u){const g=i.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=u;const x=this.style._mergedLayers,S=!(!this.terrain||!this.terrain.enabled),A=()=>this.style._getOrder(S).filter(et=>{const wt=x[et];return!(wt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[wt.type]});let L=A(),z=!1,U=!1;for(const et of L){const wt=x[et];wt.type==="circle"&&(z=!0),wt.type==="symbol"&&(wt.hasInitialOcclusionOpacityProperties?U=!0:z=!0)}let V=L.map(et=>x[et]);const X=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let Y=0,re=!1;for(const et in X){const wt=X[et];wt.used&&(wt.prepare(this.context),wt.getSource().usedInConflation&&++Y)}let ce=!1;for(const et of V)et.isHidden(this.transform.zoom)||(et.type==="clip"&&(ce=!0),this.prepareLayer(et));const se={},pe={},me={},be={},Ee={};for(const et in X){const wt=X[et];se[et]=wt.getVisibleCoordinates(),pe[et]=se[et].slice().reverse(),me[et]=wt.getVisibleCoordinates(!0).reverse(),be[et]=wt.getShadowCasterCoordinates(),Ee[et]=wt.sortCoordinatesByDistance(se[et])}const Te=et=>{const wt=this.style.getLayerSourceCache(et);return wt&&wt.used?wt.getSource():null};if(Y||ce||this._clippingActiveLastFrame){const et=[],wt=[];let Ke=0;for(const bt of V)this.isSourceForClippingOrConflation(bt,Te(bt))&&(et.push(bt),wt.push(Ke)),Ke++;if(et&&(ce||et.length>1)||this._clippingActiveLastFrame){ce=!1;const bt=[];for(let yt=0;yt<et.length;yt++){const Et=et[yt],ht=wt[yt],Ct=this.style.getLayerSourceCache(Et);if(!Ct||!Ct.used||!Ct.getSource().usedInConflation&&Et.type!=="clip")continue;let Gt=i.dA,qt=i.by.None;const Zt=[];let sr=!0;if(Et.type==="clip"){Gt=ht;for(const kr of Et.layout.get("clip-layer-types"))qt|=kr==="model"?i.by.Model:kr==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const kr of Et.layout.get("clip-layer-scope"))Zt.push(kr);Et.isHidden(this.transform.zoom)?sr=!1:ce=!0}sr&&bt.push({layer:Et.fqid,cache:Ct,order:Gt,clipMask:qt,clipScope:Zt})}this.replacementSource.setSources(bt),re=!0}}this._clippingActiveLastFrame=ce,re||this.replacementSource.clear(),this.conflationActive=re,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let et=0;et<V.length;et++){const wt=V[et],Ke=wt.cutoffRange();if(this.longestCutoffRange=Math.max(Ke,this.longestCutoffRange),Ke>0){const bt=Te(wt);bt&&(this.minCutoffZoom=Math.max(bt.minzoom,this.minCutoffZoom)),wt.minzoom&&(this.minCutoffZoom=Math.max(wt.minzoom,this.minCutoffZoom))}wt.is3D(S)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=et),this._lastOcclusionLayer=et)}const Re=this.style&&this.style.fog;Re?(this._fogVisible=Re.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Re.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(me),this.opaquePassCutoff=0,L=A(),V=L.map(et=>x[et]));const Pe=this._shadowRenderer;if(Pe){Pe.updateShadowParameters(this.transform,this.style.directionalLight);for(const et in X)for(const wt of se[et]){let Ke={min:0,max:0};this.terrain&&(Ke=this.terrain.getMinMaxForTile(wt)||Ke),Pe.addShadowReceiver(wt.toUnwrapped(),Ke.min,Ke.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dz(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new V2(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ie=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Oe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ie&&!this._snow&&(this._snow=new Xf(this)),!Ie&&this._snow&&(this._snow.destroy(),delete this._snow),Oe&&!this._rain&&(this._rain=new w1(this)),!Oe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!ur.has(this.context.gl))return;this.renderPass="offscreen";for(const et of V){const wt=s.getLayerSourceCache(et);if(!et.hasOffscreenPass()||et.isHidden(this.transform.zoom))continue;const Ke=wt?pe[wt.id]:void 0;(et.type==="custom"||et.type==="raster"||et.type==="raster-particle"||et.isSky()||Ke&&Ke.length)&&this.renderLayer(this,wt,et,Ke)}this.depthRangeFor3D=[0,1-(V.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,be)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ze=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ve=(()=>{if(u.showOverdrawInspector)return i.al.black;const et=this.style.fog;if(et&&this.transform.projection.supportsFog){const wt=this.style.getLut(et.scope);if(!ze){const Ke=et.properties.get("color-use-theme")==="none",bt=et.properties.get("color").toRenderColor(Ke?null:wt).toArray01();return new i.al(...bt)}if(ze){const Ke=et.properties.get("space-color-use-theme")==="none",bt=et.properties.get("space-color").toRenderColor(Ke?null:wt).toArray01();return new i.al(...bt)}}return i.al.transparent})();if(this.context.clear({color:Ve,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ze&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const et=V[this.currentLayer],wt=s.getLayerSourceCache(et);if(et.isSky())continue;const Ke=wt?(et.is3D(S)?Ee:pe)[wt.id]:void 0;this._renderTileClippingMasks(et,wt,Ke),this.renderLayer(this,wt,et,Ke)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ze&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ag(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const et=V[this.currentLayer],wt=s.getLayerSourceCache(et);et.isSky()&&this.renderLayer(this,wt,et,wt?pe[wt.id]:void 0)}function dt(et,wt){let Ke;return wt&&(Ke=(et.type==="symbol"?me:et.is3D(S)?Ee:pe)[wt.id]),Ke}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<L.length;){const et=V[this.currentLayer];if(et.type==="raster"||et.type==="raster-particle"){const wt=s.getLayerSourceCache(et);this.renderLayer(this,wt,et,dt(et,wt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let rt=0;Pe&&(rt=Pe.getShadowCastingLayerCount());let St=!1,Tt=-1;for(let et=0;et<L.length;++et){const wt=V[et];wt.isHidden(this.transform.zoom)||wt.is3D(S)&&(Tt=et)}U&&Tt===-1&&(z=!0);let Dt=!1;for(;this.currentLayer<L.length;){const et=V[this.currentLayer],wt=s.getLayerSourceCache(et);if(et.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(et)){if(et.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Dt&&et.is3D(S)&&!S){const Ke=this.currentLayer,bt=yt=>{for(this.currentLayer=0;this.currentLayer<V.length;this.currentLayer++){const Et=V[this.currentLayer];if(Hv[Et.type]){const ht=this.style.getLayerSourceCache(Et);Hv[Et.type](this,ht,Et,dt(Et,ht),yt)}}};bt("initialize"),bt("reset"),this.currentLayer=Ke,Dt=!0}if(z&&!St&&this.terrain&&!this.transform.isOrthographic&&(St=!0,this.blitDepth()),U&&Tt!==-1&&this.currentLayer===Tt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(et,wt,wt?se[wt.id]:void 0),this.renderLayer(this,wt,et,dt(et,wt)),!this.terrain&&Pe&&rt>0&&et.hasShadowPass()&&--rt==0&&(Pe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ke=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ke;this.currentLayer++){const bt=V[this.currentLayer];if(!bt.hasLightBeamPass())continue;const yt=s.getLayerSourceCache(bt);this.renderLayer(this,yt,bt,yt?pe[yt.id]:void 0)}this.currentLayer=Ke,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ke=this.currentLayer;this.depthOcclusion=!0;for(const bt of this.layersWithOcclusionOpacity){this.currentLayer=bt;const yt=V[this.currentLayer],Et=s.getLayerSourceCache(yt),ht=Et?pe[Et.id]:void 0;this.terrain||this._renderTileClippingMasks(yt,Et,Et?se[Et.id]:void 0),this.renderLayer(this,Et,yt,ht)}this.depthOcclusion=!1,this.currentLayer=Ke,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let et=null;V.forEach(wt=>{const Ke=s.getLayerSourceCache(wt);Ke&&!wt.isHidden(this.transform.zoom)&&Ke.getVisibleCoordinates().length&&(!et||et.getSource().maxzoom<Ke.getSource().maxzoom)&&(et=Ke)}),et&&this.options.showTileBoundaries&&hg.debug(this,et,et.getVisibleCoordinates(),i.al.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&hg.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.al(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(et){const wt=et.transform.padding;h1(et,et.transform.height-(wt.top||0),3,qf),h1(et,wt.bottom||0,3,ED),f1(et,wt.left||0,3,AD),f1(et,et.transform.width-(wt.right||0),3,$2);const Ke=et.transform.centerPoint;(function(bt,yt,Et,ht){oh(bt,yt-1,Et-10,2,20,ht),oh(bt,yt-10,Et-1,20,2,ht)})(et,Ke.x,et.transform.height-Ke.y,Fv)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),re||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:u}=this.transform.projection,g=!u||!u.includes(s.type);if(qv[s.type]&&(g||this.terrain&&s.type==="custom")){const x=this.style.getLayerSourceCache(s);qv[s.type](s,x,this)}this.gpuTimingEnd()}renderLayer(s,u,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(g.type)&&(!s.terrain||g.type!=="custom")||g.type==="clip"||hg[g.type](s,u,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,g=this.context.gl;let x=this.gpuTimers[s.id];x||(x=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:g.createQuery()}),x.calls++,g.beginQuery(u.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,u=this.context.gl,g=u.createQuery();this.deferredRenderGpuTimeQueries.push(g),u.beginQuery(s.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const u={};for(const g in s){const x=s[g],S=this.context.extTimerQuery,A=S.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(x.query),u[g]=A}return u}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let g=0;for(const x of s)g+=u.getQueryParameter(x,u.QUERY_RESULT)/1e6,u.deleteQuery(x);return g}translatePosMatrix(s,u,g,x,S){if(!g[0]&&!g[1])return s;const A=S?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(A){const U=Math.sin(A),V=Math.cos(A);g=[g[0]*V-g[1]*U,g[0]*U+g[1]*V]}const L=[S?g[0]:i.at(u,g[0],this.transform.zoom),S?g[1]:i.at(u,g[1],this.transform.zoom),0],z=new Float32Array(16);return i.ad.mat4.translate(z,s,L),z}saveTileTexture(s){const u=s.size[0],g=this._tileTextures[u];g?g.push(s):this._tileTextures[u]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,u,g){const x=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,S=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||S.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||x||u!==void 0&&!u||S.push("FOG","FOG_DITHERING"),x&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(s,u){this.cache=this.cache||{};const g=u&&u.defines||[],x=u&&u.config,S=this.currentGlobalDefines(s,u&&u.overrideFog,u&&u.overrideRtt).concat(g),A=O2.cacheKey(tg[s],s,S,x);return this.cache[A]||(this.cache[A]=new O2(this.context,s,tg[s],x,o1[s],S)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,u){if(this.style.enable3dLights()){const g=this.style.directionalLight,x=this.style.ambientLight;if(g&&x){const S=((A,L,z)=>{const U=A.properties.get("direction"),V=A.properties.get("color-use-theme")==="none",X=A.properties.get("color").toRenderColor(V?null:z.getLut(A.scope)).toArray01(),Y=A.properties.get("intensity"),re=L.properties.get("color-use-theme")==="none",ce=L.properties.get("color").toRenderColor(re?null:z.getLut(L.scope)).toArray01(),se=L.properties.get("intensity"),pe=[U.x,U.y,U.z],me=i.cN(ce,se),be=i.cN(X,Y);return{u_lighting_ambient_color:me,u_lighting_directional_dir:pe,u_lighting_directional_color:be,u_ground_radiance:I2(pe,be,me)}})(g,x,this.style);u.setLightsUniformValues(s,S)}}}uploadCommonUniforms(s,u,g,x,S){if(this.uploadCommonLightUniforms(s,u),this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const L=A.getOpacity(this.transform.pitch),z=((U,V,X,Y,re,ce,se,pe,me,be,Ee,Te)=>{const Re=U.transform,Pe=V.properties.get("color-use-theme")==="none",Ie=V.properties.get("color").toRenderColor(Pe?null:U.style.getLut(V.scope)).toArray01();Ie[3]=Y;const Oe=U.frameCounter/1e3%1,[ze,Ve]=V.properties.get("vertical-range");return{u_fog_matrix:X?Re.calculateFogTileMatrix(X):Te||U.identityMat,u_fog_range:V.getFovAdjustedRange(Re._fov),u_fog_color:Ie,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ze,Ve),Ve],u_fog_temporal_offset:Oe,u_frustum_tl:re,u_frustum_tr:ce,u_frustum_br:se,u_frustum_bl:pe,u_globe_pos:me,u_globe_radius:be,u_viewport:Ee,u_globe_transition:i.ag(Re.zoom),u_is_globe:+(Re.projection.name==="globe")}})(this,A,g,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],x);u.setFogUniformValues(s,z)}S&&u.setCutoffUniformValues(s,S.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,u=s.createTexture();return s.bindTexture(s.TEXTURE_2D,u),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)u[x.key]=s[x.key]||new Il(x,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,u){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[s.key];return u||(this._cachedTileFogOpacities[s.key]=u=this.style.fog.getOpacityForTile(s)),u[0]>=Kt||u[1]>=Kt}setupDepthForOcclusion(s,u,g){const x=this.context,S=x.gl,A=!!g;var L;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(S.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((L=this.depthRangeFor3D)[1]-L[0]),-1-2*L[0]/(L[1]-L[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),x.activeTexture.set(S.TEXTURE0),A||u.setTerrainUniformValues(x,g)}}function Xv(y,s){let u=!1,g=null;const x=()=>{g=null,u&&(y(),g=setTimeout(x,s),u=!1)};return()=>(u=!0,g||x(),g)}class T1{constructor(s){this._hashName=s&&encodeURIComponent(s),i.aQ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Xv(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const u=E1(s);if(this._hashName){const g=this._hashName;let x=!1;const S=location.hash.slice(1).split("&").map(A=>{const L=A.split("=")[0];return L===g?(x=!0,`${L}=${u}`):A}).filter(A=>A);return x||S.push(`${g}=${u}`),`#${S.join("&")}`}return`#${u}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(g))){const g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(u[3]||0):s.getBearing();return s.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function E1(y,s){const u=y.getCenter(),g=Math.round(100*y.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,x),A=Math.round(u.lng*S)/S,L=Math.round(u.lat*S)/S,z=y.getBearing(),U=y.getPitch();let V=s?`/${A}/${L}/${g}`:`${g}/${L}/${A}`;return(z||U)&&(V+="/"+Math.round(10*z)/10),U&&(V+=`/${Math.round(U)}`),V}const fg={linearity:.3,easing:i.dB(0,0,.3,1)},W2=i.l({deceleration:2500,maxSpeed:1400},fg),G2=i.l({deceleration:20,maxSpeed:1400},fg),q2=i.l({deceleration:1e3,maxSpeed:360},fg),H2=i.l({deceleration:1e3,maxSpeed:90},fg);class Z2{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=i.q.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)u.zoom+=S.zoomDelta||0,u.bearing+=S.bearingDelta||0,u.pitch+=S.pitchDelta||0,S.panDelta&&u.pan._add(S.panDelta),S.around&&(u.around=S.around),S.pinchAround&&(u.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const S=mg(u.pan.mag(),g,i.l({},W2,s||{}));x.offset=u.pan.mult(S.amount/u.pan.mag()),x.center=this._map.transform.center,pg(x,S)}if(u.zoom){const S=mg(u.zoom,g,G2);x.zoom=this._map.transform.zoom+S.amount,pg(x,S)}if(u.bearing){const S=mg(u.bearing,g,q2);x.bearing=this._map.transform.bearing+i.ay(S.amount,-179,179),pg(x,S)}if(u.pitch){const S=mg(u.pitch,g,H2);x.pitch=this._map.transform.pitch+S.amount,pg(x,S)}if(x.zoom||x.bearing){const S=u.pinchAround===void 0?u.around:u.pinchAround;x.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function pg(y,s){(!y.duration||y.duration<s.duration)&&(y.duration=s.duration,y.easing=s.easing)}function mg(y,s,u){const{maxSpeed:g,linearity:x,deceleration:S}=u,A=i.ay(y*x/(s/1e3),-g,g),L=Math.abs(A)/(S*x);return{easing:u.easing,duration:1e3*L,amount:A*(L/2)}}class Qa extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g,x={}){const S=ve(u.getCanvasContainer(),g),A=u.unproject(S);super(s,i.l({point:S,lngLat:A,originalEvent:g},x)),this._defaultPrevented=!1,this.target=u}}class gg extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g){const x=s==="touchend"?g.changedTouches:g.touches,S=Fe(u.getCanvasContainer(),x),A=S.map(z=>u.unproject(z)),L=S.reduce((z,U,V,X)=>z.add(U.div(X.length)),new i.P(0,0));super(s,{points:S,point:L,lngLats:A,lngLat:u.unproject(L),originalEvent:g}),this._defaultPrevented=!1}}class X2 extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class Y2{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new X2(this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new Qa(s.type,this._map,s))}mouseup(s){this._map.fire(new Qa(s.type,this._map,s))}preclick(s){const u=i.l({},s);u.type="preclick",this._map.fire(new Qa(u.type,this._map,u))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(s),this._map.fire(new Qa(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new Qa(s.type,this._map,s))}mouseover(s){this._map.fire(new Qa(s.type,this._map,s))}mouseout(s){this._map.fire(new Qa(s.type,this._map,s))}touchstart(s){return this._firePreventable(new gg(s.type,this._map,s))}touchmove(s){this._map.fire(new gg(s.type,this._map,s))}touchend(s){this._map.fire(new gg(s.type,this._map,s))}touchcancel(s){this._map.fire(new gg(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class MD{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new Qa(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Qa(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class PD{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&s.button===0&&(Q(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const g=u,x=this._startPos,S=this._lastPos;if(!x||!S||S.equals(g)||!this._box&&g.dist(x)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=B("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const A=Math.min(x.x,g.x),L=Math.max(x.x,g.x),z=Math.min(x.y,g.y),U=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${z}px)`,this._box.style.width=L-A+"px",this._box.style.height=U-z+"px")})}mouseupWindow(s,u){if(!this._active)return;const g=this._startPos,x=u;if(g&&s.button===0){if(this.reset(),ae(),g.x!==x.x||g.y!==x.y)return this._map.fire(new i.A("boxzoomend",{originalEvent:s})),{cameraAnimation:S=>S.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),oe(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new i.A(s,{originalEvent:u}))}}function hi(y,s){const u={};for(let g=0;g<y.length;g++)u[y[g].identifier]=s[g];return u}class K2{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const S=new i.P(0,0);for(const A of x)S._add(A);return S.div(x.length)}(u),this.touches=hi(g,u)))}touchmove(s,u,g){if(this.aborted||!this.centroid)return;const x=hi(g,u);for(const S in this.touches){const A=x[S];(!A||A.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(s,u,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class A1{constructor(s){this.singleTap=new K2(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,u,g){this.singleTap.touchstart(s,u,g)}touchmove(s,u,g){this.singleTap.touchmove(s,u,g)}touchend(s,u,g){const x=this.singleTap.touchend(s,u,g);if(x){const S=s.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(S&&A||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class ID{constructor(){this._zoomIn=new A1({numTouches:1,numTaps:2}),this._zoomOut=new A1({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,g){this._zoomIn.touchstart(s,u,g),this._zoomOut.touchstart(s,u,g)}touchmove(s,u,g){this._zoomIn.touchmove(s,u,g),this._zoomOut.touchmove(s,u,g)}touchend(s,u,g){const x=this._zoomIn.touchend(s,u,g),S=this._zoomOut.touchend(s,u,g);return x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(x)},{originalEvent:s})}):S?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(S)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const yg={0:1,2:2},C1={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class vg{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,u){return!1}_move(s,u){return{}}mousedown(s,u){if(this._lastPoint)return;const g=ke(s);this._correctButton(s,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(s,u){const g=this._lastPoint;if(g){if(s.preventDefault(),this._eventButton!=null&&function(x,S){const A=yg[S];return x.buttons===void 0||(x.buttons&A)!==A}(s,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(s){this._lastPoint&&ke(s)===this._eventButton&&(this._moved&&ae(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yv extends vg{mousedown(s,u){super.mousedown(s,u),this._lastPoint&&(this._active=!0)}_correctButton(s,u){return u===0&&!s.ctrlKey}_move(s,u){return{around:u,panDelta:u.sub(s)}}}class hc extends vg{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?C1[s.pitchRotateKey]:void 0}_correctButton(s,u){return this._pitchRotateKey?u===0&&s[this._pitchRotateKey]:u===0&&s.ctrlKey||u===2}_move(s,u){const g=.8*(u.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class _g extends vg{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?C1[s.pitchRotateKey]:void 0}_correctButton(s,u){return this._pitchRotateKey?u===0&&s[this._pitchRotateKey]:u===0&&s.ctrlKey||u===2}_move(s,u){const g=-.5*(u.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Wi{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),i.aQ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(s,u,g){return this._calculateTransform(s,u,g)}touchmove(s,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!i.dC())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,u,g)}}touchend(s,u,g){this._calculateTransform(s,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,g){g.length>0&&(this._active=!0);const x=hi(g,u),S=new i.P(0,0),A=new i.P(0,0);let L=0;for(const U in x){const V=x[U],X=this._touches[U];X&&(S._add(V),A._add(V.sub(X)),L++,x[U]=V)}if(this._touches=x,L<this._minTouches||!A.mag())return;const z=A.div(L);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(L),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class el{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,u,g){return{}}touchstart(s,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,g){const x=this._firstTwoTouches;if(!x)return;s.preventDefault();const[S,A]=x,L=Yf(g,u,S),z=Yf(g,u,A);if(!L||!z)return;const U=this._aroundCenter?null:L.add(z).div(2);return this._move([L,z],U,s)}touchend(s,u,g){if(!this._firstTwoTouches)return;const[x,S]=this._firstTwoTouches,A=Yf(g,u,x),L=Yf(g,u,S);A&&L||(this._active&&ae(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Yf(y,s,u){for(let g=0;g<y.length;g++)if(y[g].identifier===u)return s[g]}function xg(y,s){return Math.log(y/s)/Math.LN2}class J2 extends el{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(xg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xg(this._distance,g),pinchAround:u}}}function Q2(y,s){return 180*y.angleWith(s)/Math.PI}class bg extends el{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u){const g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Q2(this._vector,g),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const x=Q2(s,g);return Math.abs(x)<u}}function M1(y){return Math.abs(y.y)>Math.abs(y.x)}class OD extends el{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,M1(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,g){const x=this._lastPoints;if(!x)return;const S=s[0].sub(x[0]),A=s[1].sub(x[1]);return this._map._cooperativeGestures&&!i.dC()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(S,A,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(S.y+A.y)/2*-.5})}gestureBeginsVertically(s,u,g){if(this._valid!==void 0)return this._valid;const x=s.mag()>=2,S=u.mag()>=2;if(!x&&!S)return;if(!x||!S)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const A=s.y>0==u.y>0;return M1(s)&&M1(u)&&A}}const P1={panStep:100,bearingStep:15,pitchStep:10};class I1{constructor(){const s=P1;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,g=0,x=0,S=0,A=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),S=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),S=1);break;case 38:s.shiftKey?x=1:(s.preventDefault(),A=-1);break;case 40:s.shiftKey?x=-1:(s.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:L=>{const z=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:wg,zoom:u?Math.round(z)+u*(s.shiftKey?2:1):z,bearing:L.getBearing()+g*this._bearingStep,pitch:L.getPitch()+x*this._pitchStep,offset:[-S*this._panStep,-A*this._panStep],center:L.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function wg(y){return y*(2-y)}const lh=4.000244140625,tu=1/450;class Ll{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=tu,i.aQ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||i.dC()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=i.q.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%lh==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=ve(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>lh?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&V!==0&&(V=1/V);const X=u(),Y=Math.pow(2,X),re=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):Y;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(re*V))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),x=this._startZoom,S=this._easing;let A,L=!1;if(this._type==="wheel"&&x&&S){const U=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),V=S(U);A=i.ah(x,g,V),U<1?this._frameId||(this._frameId=!0):L=!0}else A=g,L=!0;this._active=!0,L&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let z=A-u();return z*this._lastDelta<0&&(z=0),{noInertia:!0,needsRenderFrame:!L,zoomDelta:z,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=i.dD;if(this._prevEase){const g=this._prevEase,x=(i.q.now()-g.start)/g.duration,S=g.easing(x+.01)-g.easing(x),A=.27/Math.sqrt(S*S+1e-4)*.01,L=Math.sqrt(.0729-A*A);u=i.dB(A,L,.25,1)}return this._prevEase={start:i.q.now(),duration:s,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class od{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ch{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,u){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ad{constructor(){this._tap=new A1({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,u,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,u,g))}touchmove(s,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=u[0],S=x.y-this._swipePoint.y;return this._swipePoint=x,s.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(s,u,g)}touchend(s,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(s,u,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kD{constructor(s,u,g){this._el=s,this._mousePan=u,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class RD{constructor(s,u,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class DD{constructor(s,u,g,x){this._el=s,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Kv=y=>y.zoom||y.drag||y.pitch||y.rotate;class eA extends i.A{}class Oa{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,u){const g=i.ad.vec3.sub([],u,s);this.radius=i.ad.vec3.length(g[2]<0?i.ad.vec3.div([],g,this.constants):[g[0],g[1],0])}projectRay(s){i.ad.vec3.div(s,s,this.constants),i.ad.vec3.normalize(s,s),i.ad.vec3.mul(s,s,this.constants);const u=i.ad.vec3.scale([],s,this.radius);if(u[2]>0){const g=i.ad.vec3.scale([],[0,0,1],i.ad.vec3.dot(u,[0,0,1])),x=i.ad.vec3.scale([],i.ad.vec3.normalize([],[u[0],u[1],0]),this.radius),S=i.ad.vec3.add([],u,i.ad.vec3.scale([],i.ad.vec3.sub([],i.ad.vec3.add([],x,g),u),2));u[0]=S[0],u[1]=S[1]}return u}}function Kf(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class tA{constructor(s,u){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Z2(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Oa,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),i.aQ(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,S,A]of this._listeners){const L=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(S,L,A)}}destroy(){for(const[s,u,g]of this._listeners){const x=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(u,x,g)}}_addDefaultHandlers(s){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new Y2(u,s));const x=u.boxZoom=new PD(u,s);this._add("boxZoom",x);const S=new ID,A=new ch;u.doubleClickZoom=new od(A,S),this._add("tapZoom",S),this._add("clickZoom",A);const L=new ad;this._add("tapDragZoom",L);const z=u.touchPitch=new OD(u);this._add("touchPitch",z);const U=new hc(s),V=new _g(s);u.dragRotate=new RD(s,U,V),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const X=new Yv(s),Y=new Wi(u,s);u.dragPan=new kD(g,X,Y),this._add("mousePan",X),this._add("touchPan",Y,["touchZoom","touchRotate"]);const re=new bg,ce=new J2;u.touchZoomRotate=new DD(g,ce,re,L),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),this._add("blockableMapEvent",new MD(u));const se=u.scrollZoom=new Ll(u,this);this._add("scrollZoom",se,["mousePan"]);const pe=u.keyboard=new I1;this._add("keyboard",pe);for(const me of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[me]&&u[me].enable(s[me])}_add(s,u,g){this._handlers.push({handlerName:s,handler:u,allowed:g}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Kv(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,u,g){for(const x in s)if(x!==g&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const u=[];for(const g of s)this._el.contains(g.target)&&u.push(g);return u}handleEvent(s,u){this._updatingCamera=!0;const g=s.type==="renderFrame",x=g?void 0:s,S={needsRenderFrame:!1},A={},L={},z=s.touches?this._getMapTouches(s.touches):void 0,U=z?Fe(this._el,z):g?void 0:ve(this._el,s);for(const{handlerName:Y,handler:re,allowed:ce}of this._handlers){if(!re.isEnabled())continue;let se;this._blockedByActive(L,ce,Y)?re.reset():re[u||s.type]&&(se=re[u||s.type](s,U,z),this.mergeHandlerResult(S,A,se,Y,x),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||re.isActive())&&(L[Y]=re)}const V={};for(const Y in this._previousActiveHandlers)L[Y]||(V[Y]=x);this._previousActiveHandlers=L,(Object.keys(V).length||Kf(S))&&(this._changes.push([S,A,V]),this._triggerRenderFrame()),(Object.keys(L).length||Kf(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=S;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(s,u,g,x,S){if(!g)return;i.l(s,g);const A={handlerName:x,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(u.zoom=A),g.panDelta!==void 0&&(u.drag=A),g.pitchDelta!==void 0&&(u.pitch=A),g.bearingDelta!==void 0&&(u.rotate=A)}_applyChanges(){const s={},u={},g={};for(const[x,S,A]of this._changes)x.panDelta&&(s.panDelta=(s.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(s.around=x.around),x.aroundCoord!==void 0&&(s.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(s.pinchAround=x.pinchAround),x.noInertia&&(s.noInertia=x.noInertia),i.l(u,S),i.l(g,A);this._updateMapTransform(s,u,g),this._changes=[]}_updateMapTransform(s,u,g){const x=this._map,S=x.transform,A=be=>[be.x,be.y,be.z];if((be=>{const Ee=this._eventsInProgress.drag;return Ee&&!this._handlersById[Ee.handlerName].isActive()})()&&!Kf(s)){const be=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),be!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&x._stop(!0),!Kf(s))return void this._fireEvents(u,g,!0);let{panDelta:L,zoomDelta:z,bearingDelta:U,pitchDelta:V,around:X,aroundCoord:Y,pinchAround:re}=s;S._isCameraConstrained&&(z>0&&(z=0),S._isCameraConstrained=!1),re!==void 0&&(X=re),(z||(be=>u[be]&&!this._eventsInProgress[be])("drag"))&&X&&(this._dragOrigin=A(S.pointCoordinate3D(X)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",x._stop(!0),X=X||x.transform.centerPoint,U&&(S.bearing+=U),V&&(S.pitch+=V),S._updateCameraState();const ce=[0,0,0];if(L)if(S.projection.name==="mercator"){const be=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X).dir),Ee=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X.sub(L)).dir);ce[0]=Ee[0]-be[0],ce[1]=Ee[1]-be[1]}else{const be=S.pointCoordinate(X);if(S.projection.name==="globe"){L=L.rotate(-S.angle);const Ee=S._pixelsPerMercatorPixel/S.worldSize;ce[0]=-L.x*i.dE(i.aT(be.y))*Ee,ce[1]=-L.y*i.dE(S.center.lat)*Ee}else{const Ee=S.pointCoordinate(X.sub(L));be&&Ee&&(ce[0]=Ee.x-be.x,ce[1]=Ee.y-be.y)}}const se=S.zoom,pe=[0,0,0];if(z){const be=A(Y||S.pointCoordinate3D(X)),Ee={dir:i.ad.vec3.normalize([],i.ad.vec3.sub([],be,S._camera.position))};if(Ee.dir[2]<0){const Te=S.zoomDeltaToMovement(be,z);i.ad.vec3.scale(pe,Ee.dir,Te)}}const me=i.ad.vec3.add(ce,ce,pe);S._translateCameraConstrained(me),z&&Math.abs(S.zoom-se)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,g,!0)}_fireEvents(s,u,g){const x=Kv(this._eventsInProgress),S=Kv(s),A={};for(const V in s){const{originalEvent:X}=s[V];this._eventsInProgress[V]||(A[`${V}start`]=X),this._eventsInProgress[V]=s[V]}!x&&S&&this._fireEvent("movestart",S.originalEvent);for(const V in A)this._fireEvent(V,A[V]);S&&this._fireEvent("move",S.originalEvent);for(const V in s){const{originalEvent:X}=s[V];this._fireEvent(V,X)}const L={};let z;for(const V in this._eventsInProgress){const{handlerName:X,originalEvent:Y}=this._eventsInProgress[V];this._handlersById[X].isActive()||(delete this._eventsInProgress[V],z=u[X]||Y,L[`${V}end`]=z)}for(const V in L)this._fireEvent(V,L[V]);const U=Kv(this._eventsInProgress);if(g&&(x||S)&&!U){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;V?(X(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:z})):(this._map.fire(new i.A("moveend",{originalEvent:z})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new i.A(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new eA("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const rA="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Jf extends i.E{constructor(s,u){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,i.aQ(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}panBy(s,u,g){return s=i.P.convert(s).mult(-1),this.panTo(this.transform.center,i.l({offset:s},u),g)}panTo(s,u,g){return this.easeTo(i.l({center:s},u),g)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,g){return this.easeTo(i.l({zoom:s},u),g)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,g){return this.easeTo(i.l({bearing:s},u),g)}resetNorth(s,u){return this.rotateTo(0,i.l({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}cameraForBounds(s,u){s=i.aB.convert(s);const g=u&&u.bearing||0,x=u&&u.pitch||0,S=s.getNorthWest(),A=s.getSouthEast();return this._cameraForBounds(this.transform,S,A,g,x,u)}_extendPadding(s){const u={top:0,right:0,bottom:0,left:0};return s==null?i.l({},u,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:i.l({},u,s)}_extendCameraOptions(s){return(s=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,u){const g=u.max[0]-u.min[0],x=u.max[1]-u.min[1];return g/x>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):x/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,u,g,x,S,A){const L=s.clone(),z=this._extendCameraOptions(A);L.bearing=x,L.pitch=S;const U=i.bO.convert(u),V=i.bO.convert(g),X=.5*(U.lat+V.lat),Y=.5*(U.lng+V.lng),re=i.dF(X,Y),ce=i.ad.vec3.normalize([],re),se=i.ad.vec3.normalize([],i.ad.vec3.cross([],ce,[0,1,0])),pe=i.ad.vec3.cross([],se,ce),me=[se[0],se[1],se[2],0,pe[0],pe[1],pe[2],0,ce[0],ce[1],ce[2],0,0,0,0,1],be=[re,i.dF(U.lat,U.lng),i.dF(V.lat,U.lng),i.dF(V.lat,V.lng),i.dF(U.lat,V.lng),i.dF(X,U.lng),i.dF(X,V.lng),i.dF(U.lat,Y),i.dF(V.lat,Y)];let Ee=i.ce.fromPoints(be.map(yt=>[i.ad.vec3.dot(se,yt),i.ad.vec3.dot(pe,yt),i.ad.vec3.dot(ce,yt)]));const Te=i.ad.vec3.transformMat4([],Ee.center,me);i.ad.vec3.squaredLength(Te)===0&&i.ad.vec3.set(Te,0,0,1),i.ad.vec3.normalize(Te,Te),i.ad.vec3.scale(Te,Te,i.az),L.center=i.dG(Te);const Re=L.getWorldToCameraMatrix(),Pe=i.ad.mat4.invert(new Float64Array(16),Re);Ee=i.ce.applyTransform(Ee,i.ad.mat4.multiply([],Re,me));const Ie=this._extendAABB(Ee,L,z,x);if(!Ie)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ee=Ie,i.ad.vec3.transformMat4(Te,Te,Re);const Oe=.5*(Ee.max[2]-Ee.min[2]),ze=this._minimumAABBFrustumDistance(L,Ee),Ve=i.ad.vec3.scale([],[0,0,1],Oe),dt=i.ad.vec3.add(Ve,Te,Ve),rt=ze+(L.pitch===0?0:i.ad.vec3.distance(Te,dt)),St=L.globeCenterInViewSpace,Tt=i.ad.vec3.sub([],Te,[St[0],St[1],St[2]]);i.ad.vec3.normalize(Tt,Tt),i.ad.vec3.scale(Tt,Tt,rt);const Dt=i.ad.vec3.add([],Te,Tt);i.ad.vec3.transformMat4(Dt,Dt,Pe);const et=i.dv/i.az,wt=i.ad.vec3.length(Dt),Ke=i.bH(Math.max(wt*et-i.dv,Number.EPSILON),0),bt=Math.min(L.zoomFromMercatorZAdjusted(Ke),z.maxZoom);return bt>.5*(i.c6+i.bY)?(L.setProjection({name:"mercator"}),L.zoom=bt,this._cameraForBounds(L,u,g,x,S,A)):{center:L.center,zoom:bt,bearing:x,pitch:S}}_extendAABB(s,u,g,x){const S=.5*((g.padding.left||0)+(g.padding.right||0)),A=.5*((g.padding.top||0)+(g.padding.bottom||0)),L=A,z=S,U=S,V=A,X=u.width-(z+U),Y=u.height-(L+V),re=i.ad.vec3.sub([],s.max,s.min),ce=Math.min(X/re[0],Y/re[1]),se=Math.min(u.scaleZoom(u.scale*ce),g.maxZoom);if(isNaN(se))return null;const pe=u.scale/u.zoomScale(se),me=new i.ce([s.min[0]-z*pe,s.min[1]-V*pe,s.min[2]],[s.max[0]+U*pe,s.max[1]+L*pe,s.max[2]]),be=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new i.P(g.offset.x,g.offset.y):i.P.convert(g.offset)).rotate(-i.ak(x));return me.center[0]-=be.x*pe,me.center[1]+=be.y*pe,me}queryTerrainElevation(s,u){const g=this.transform.elevation;return g?(u=i.l({},{exaggerated:!0},u),g.getAtPoint(i.ac.fromLngLat(s),null,u.exaggerated)):null}_cameraForBounds(s,u,g,x,S,A){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,u,g,x,S,A);const L=s.clone(),z=this._extendCameraOptions(A);L.bearing=x,L.pitch=S;const U=i.bO.convert(u),V=i.bO.convert(g),X=new i.bO(U.lng,V.lat),Y=new i.bO(V.lng,U.lat),re=L.project(U),ce=L.project(V),se=this.queryTerrainElevation(U),pe=this.queryTerrainElevation(V),me=this.queryTerrainElevation(X),be=this.queryTerrainElevation(Y),Ee=[[re.x,re.y,Math.min(se||0,pe||0,me||0,be||0)],[ce.x,ce.y,Math.max(se||0,pe||0,me||0,be||0)]];let Te=i.ce.fromPoints(Ee);const Re=L.getWorldToCameraMatrix(),Pe=i.ad.mat4.invert(new Float64Array(16),Re);Te=i.ce.applyTransform(Te,Re);const Ie=this._extendAABB(Te,L,z,x);if(!Ie)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Ie;const Oe=.5*i.ad.vec3.sub([],Te.max,Te.min)[2],ze=this._minimumAABBFrustumDistance(L,Te),Ve=[0,0,1,0];i.ad.vec4.transformMat4(Ve,Ve,Re),i.ad.vec4.normalize(Ve,Ve);const dt=i.ad.vec3.scale([],Ve,ze+Oe),rt=i.ad.vec3.add([],Te.center,dt);i.ad.vec3.transformMat4(Te.center,Te.center,Pe),i.ad.vec3.transformMat4(rt,rt,Pe);const St=L.unproject(new i.P(Te.center[0],Te.center[1])),Tt=i.dH(L.projection,St),Dt=Math.pow(2,Tt),et=Math.min(L._zoomFromMercatorZ(rt[2]*L.pixelsPerMeter*Dt/L.worldSize),z.maxZoom);return L.mercatorFromTransition&&et<.5*(i.c6+i.bY)?(L.setProjection({name:"globe"}),L.zoom=et,this._cameraForBounds(L,u,g,x,S,A)):{center:St,zoom:et,bearing:x,pitch:S}}fitBounds(s,u,g){const x=this.cameraForBounds(s,u);return this._fitInternal(x,u,g)}fitScreenCoordinates(s,u,g,x,S){const A=i.P.convert(s),L=i.P.convert(u),z=new i.P(Math.min(A.x,L.x),Math.min(A.y,L.y)),U=new i.P(Math.max(A.x,L.x),Math.max(A.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(A,L))return this;const V=this.transform.pointLocation3D(z),X=this.transform.pointLocation3D(U),Y=this.transform.pointLocation3D(new i.P(z.x,U.y)),re=this.transform.pointLocation3D(new i.P(U.x,z.y)),ce=[Math.min(V.lng,X.lng,Y.lng,re.lng),Math.min(V.lat,X.lat,Y.lat,re.lat)],se=[Math.max(V.lng,X.lng,Y.lng,re.lng),Math.max(V.lat,X.lat,Y.lat,re.lat)],pe=x&&x.pitch?x.pitch:this.getPitch(),me=this._cameraForBounds(this.transform,ce,se,g,pe,x);return this._fitInternal(me,x,S)}_fitInternal(s,u,g){return s?(u=i.l(s,u)).linear?this.easeTo(u,g):this.flyTo(u,g):this}jumpTo(s,u){this.stop();const g=s.preloadOnly?this.transform.clone():this.transform;let x=!1,S=!1,A=!1;"zoom"in s&&g.zoom!==+s.zoom&&(x=!0,g.zoom=+s.zoom),s.center!==void 0&&(g.center=i.bO.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(S=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(A=!0,g.pitch=+s.pitch);const L=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!g.isPaddingEqual(L))if(s.retainPadding===!1){const z=g.clone();z.padding=L,g.setLocationAtPoint(g.center,z.centerPoint)}else g.padding=L;return s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new i.A("movestart",u)).fire(new i.A("move",u)),x&&this.fire(new i.A("zoomstart",u)).fire(new i.A("zoom",u)).fire(new i.A("zoomend",u)),S&&this.fire(new i.A("rotatestart",u)).fire(new i.A("rotate",u)).fire(new i.A("rotateend",u)),A&&this.fire(new i.A("pitchstart",u)).fire(new i.A("pitch",u)).fire(new i.A("pitchend",u)),this.fire(new i.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(rA),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return i.w(rA),this;this.stop();const x=g.zoom,S=g.pitch,A=g.bearing;g.setFreeCameraOptions(s);const L=x!==g.zoom,z=S!==g.pitch,U=A!==g.bearing;return this.fire(new i.A("movestart",u)).fire(new i.A("move",u)),L&&this.fire(new i.A("zoomstart",u)).fire(new i.A("zoom",u)).fire(new i.A("zoomend",u)),U&&this.fire(new i.A("rotatestart",u)).fire(new i.A("rotate",u)).fire(new i.A("rotateend",u)),z&&this.fire(new i.A("pitchstart",u)).fire(new i.A("pitch",u)).fire(new i.A("pitchend",u)),this.fire(new i.A("moveend",u)),this}easeTo(s,u){this._stop(!1,s.easeId),((s=i.l({offset:[0,0],duration:500,easing:i.dD},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const g=this.transform,x=this.getZoom(),S=this.getBearing(),A=this.getPitch(),L=this.getPadding(),z="zoom"in s?+s.zoom:x,U="bearing"in s?this._normalizeBearing(s.bearing,S):S,V="pitch"in s?+s.pitch:A,X=this._extendPadding(s.padding),Y=i.P.convert(s.offset);let re,ce,se;if(g.projection.name==="globe"){const Ve=i.ac.fromLngLat(g.center),dt=Y.rotate(-g.angle);Ve.x+=dt.x/g.worldSize,Ve.y+=dt.y/g.worldSize;const rt=Ve.toLngLat(),St=i.bO.convert(s.center||rt);this._normalizeCenter(St),re=g.centerPoint.add(dt),ce=new i.P(Ve.x,Ve.y).mult(g.worldSize),se=new i.P(i.av(St.lng),i.aC(St.lat)).mult(g.worldSize).sub(ce)}else{re=g.centerPoint.add(Y);const Ve=g.pointLocation(re),dt=i.bO.convert(s.center||Ve);this._normalizeCenter(dt),ce=g.project(Ve),se=g.project(dt).sub(ce)}const pe=g.zoomScale(z-x);let me,be;s.around&&(me=i.bO.convert(s.around),be=g.locationPoint(me));const Ee=this._zooming||z!==x,Te=this._rotating||S!==U,Re=this._pitching||V!==A,Pe=!g.isPaddingEqual(X),Ie=s.retainPadding===!1?g.clone():g,Oe=Ve=>dt=>{if(Ee&&(Ve.zoom=i.ah(x,z,dt)),Te&&(Ve.bearing=i.ah(S,U,dt)),Re&&(Ve.pitch=i.ah(A,V,dt)),Pe&&(Ie.interpolatePadding(L,X,dt),re=Ie.centerPoint.add(Y)),me)Ve.setLocationAtPoint(me,be);else{const rt=Ve.zoomScale(Ve.zoom-x),St=z>x?Math.min(2,pe):Math.max(.5,pe),Tt=Math.pow(St,1-dt),Dt=Ve.unproject(ce.add(se.mult(dt*Tt)).mult(rt));Ve.setLocationAtPoint(Ve.renderWorldCopies?Dt.wrap():Dt,re)}return s.preloadOnly||this._fireMoveEvents(u),Ve};if(s.preloadOnly){const Ve=this._emulate(Oe,s.duration,g);return this._preloadTiles(Ve),this}const ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ee,this._rotating=Te,this._pitching=Re,this._padding=Pe,this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,ze),this._ease(Oe(g),Ve=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(u,Ve)},s),this}_prepareEase(s,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||g.moving||this.fire(new i.A("movestart",s)),this._zooming&&!g.zooming&&this.fire(new i.A("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new i.A("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new i.A("pitchstart",s))}_fireMoveEvents(s){this.fire(new i.A("move",s)),this._zooming&&this.fire(new i.A("zoom",s)),this._rotating&&this.fire(new i.A("rotate",s)),this._pitching&&this.fire(new i.A("pitch",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.A("zoomend",s)),x&&this.fire(new i.A("rotateend",s)),S&&this.fire(new i.A("pitchend",s)),this.fire(new i.A("moveend",s))}flyTo(s,u){if(this._prefersReducedMotion(s)){const yt=i.aA(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(yt,u)}this.stop(),s=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dD},s);const g=this.transform,x=this.getZoom(),S=this.getBearing(),A=this.getPitch(),L=this.getPadding(),z="zoom"in s?i.ay(+s.zoom,g.minZoom,g.maxZoom):x,U="bearing"in s?this._normalizeBearing(s.bearing,S):S,V="pitch"in s?+s.pitch:A,X=this._extendPadding(s.padding),Y=g.zoomScale(z-x),re=i.P.convert(s.offset);let ce=g.centerPoint.add(re);const se=g.pointLocation(ce),pe=i.bO.convert(s.center||se);this._normalizeCenter(pe);const me=g.project(se),be=g.project(pe).sub(me);let Ee=s.curve;const Te=Math.max(g.width,g.height),Re=Te/Y,Pe=be.mag();if("minZoom"in s){const yt=i.ay(Math.min(s.minZoom,x,z),g.minZoom,g.maxZoom),Et=Te/g.zoomScale(yt-x);Ee=Math.sqrt(Et/Pe*2)}const Ie=Ee*Ee;function Oe(yt){const Et=(Re*Re-Te*Te+(yt?-1:1)*Ie*Ie*Pe*Pe)/(2*(yt?Re:Te)*Ie*Pe);return Math.log(Math.sqrt(Et*Et+1)-Et)}function ze(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function Ve(yt){return(Math.exp(yt)+Math.exp(-yt))/2}const dt=Oe(0);let rt=function(yt){return Ve(dt)/Ve(dt+Ee*yt)},St=function(yt){return Te*((Ve(dt)*(ze(Et=dt+Ee*yt)/Ve(Et))-ze(dt))/Ie)/Pe;var Et},Tt=(Oe(1)-dt)/Ee;if(Math.abs(Pe)<1e-6||!isFinite(Tt)){if(Math.abs(Te-Re)<1e-6)return this.easeTo(s,u);const yt=Re<Te?-1:1;Tt=Math.abs(Math.log(Re/Te))/Ee,St=function(){return 0},rt=function(Et){return Math.exp(yt*Ee*Et)}}s.duration="duration"in s?+s.duration:1e3*Tt/("screenSpeed"in s?+s.screenSpeed/Ee:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const Dt=S!==U,et=V!==A,wt=!g.isPaddingEqual(X),Ke=s.retainPadding===!1?g.clone():g,bt=yt=>Et=>{const ht=Et*Tt,Ct=1/rt(ht);yt.zoom=Et===1?z:x+yt.scaleZoom(Ct),Dt&&(yt.bearing=i.ah(S,U,Et)),et&&(yt.pitch=i.ah(A,V,Et)),wt&&(Ke.interpolatePadding(L,X,Et),ce=Ke.centerPoint.add(re));const Gt=Et===1?pe:yt.unproject(me.add(be.mult(St(ht))).mult(Ct));return yt.setLocationAtPoint(yt.renderWorldCopies?Gt.wrap():Gt,ce),yt._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(u),yt};if(s.preloadOnly){const yt=this._emulate(bt,s.duration,g);return this._preloadTiles(yt),this}return this._zooming=!0,this._rotating=Dt,this._pitching=et,this._padding=wt,this._prepareEase(u,!1),this._ease(bt(g),()=>this._afterEase(u),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!s){const g=this.handlers;g&&g.stop(!1)}return this}_ease(s,u,g){g.animate===!1||g.duration===0?(s(1),u()):(this._easeStart=i.q.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,u){s=i.bF(s,-180,180);const g=Math.abs(s-u);return Math.abs(s-360-u)<g&&(s-=360),Math.abs(s+360-u)<g&&(s+=360),s}_normalizeCenter(s){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const g=s.lng-u.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,u,g){const x=Math.ceil(15*u/1e3),S=[],A=s(g.clone());for(let L=0;L<=x;L++){const z=A(L/x);S.push(z.clone())}return S}_preloadTiles(s,u){}}class Jv{constructor(s={}){this.options=s,i.aQ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const u=this.options&&this.options.compact,g=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=B("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const x=B("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",g),this._innerContainer=B("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(s){const g=u.reduce((x,S,A)=>(S.value&&(x+=`${S.key}=${S.value}${A<u.length-1?"&":""}`),x),"?");s.href=`${i.e.FEEDBACK_URL}/${g}#${E1(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._mergedSourceCaches;for(const x in u){const S=u[x];if(S.used){const A=S.getSource();A.attribution&&s.indexOf(A.attribution)<0&&s.push(A.attribution)}}s.sort((x,S)=>x.length-S.length),s=s.filter((x,S)=>{for(let A=S+1;A<s.length;A++)if(s[A].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Es{constructor(){i.aQ(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=B("div","mapboxgl-ctrl");const u=B("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const u in s){const g=s[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class As{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const x of g)if(x.id===s)return void(x.cancelled=!0)}run(s=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Qf{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const u=i.cC((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,u,g){this._start=this.getValue(u),this._end=s,this._startTime=u,this._endTime=u+g}}const uh={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class dh extends i.A{constructor(s,u,g,x){const{point:S,lngLat:A,originalEvent:L,target:z}=s;super(s.type,{point:S,lngLat:A,originalEvent:L,target:z}),this.preventDefault=()=>{s.preventDefault()},this.id=u,this.interaction=g,this.feature=x}}class O1{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,u){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const g=u.filter;let x=u.type;g&&this.filters.set(s,i.a_(g)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const S=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,u)):S.size===0&&this.map.on(x,this.handleType),S.size===0&&this.interactionsByType.set(x,S),S.set(s,u),this.typeById.set(s,x)}get(s){const u=this.typeById.get(s);if(!u)return;const g=this.interactionsByType.get(u);return g?g.get(s):void 0}remove(s){const u=this.typeById.get(s);if(!u)return;this.typeById.delete(s),this.filters.delete(s);const g=this.interactionsByType.get(u);g&&(g.delete(s),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(u,this.handleType))}queryTargets(s,u){const g=[];for(const[x,S]of u)S.target&&g.push({targetId:x,target:S.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(s,g,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());u.length&&(s.type="mouseenter",this.handleType(s,u));const g=new Map;for(const[x,{feature:S}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||g.set(S.id,S);g.size&&(s.type="mouseleave",this.handleType(s,Array.from(g.values())))}handleOut(s){const u=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);u.length&&(s.type="mouseleave",this.handleType(s,u)),this.hoveredFeatures.clear()}handleType(s,u){const g=Array.from(this.interactionsByType.get(s.type)).reverse(),x=!!u;u=u||this.queryTargets(s.point,g);const S=s.type==="mouseenter";let A=!1;const L=new Set;for(const z of u){for(const[U,V]of g){if(!V.target)continue;const X=z.variants?z.variants[U]:null;if(X){for(const Y of X){if(yf(Y,z,L,U))continue;const re=new i.cx(z,Y),ce=Um(Y,z,U);x&&(re.state=this.map.getFeatureState(re));const se=S?this.prevHoveredFeatures.get(ce):null,pe=new dh(s,U,V,re),me=se?se.stop:V.handler(pe);if(S&&this.hoveredFeatures.set(ce,{feature:z,stop:me}),me!==!1){A=!0;break}}if(A)break}}if(A)break}if(!A)for(const[z,U]of g){const{handler:V,target:X}=U;if(!X&&V(new dh(s,z,U,null))!==!1)break}}}function bn(y,s){if(Array.isArray(y)&&Array.isArray(s)){const u=new Set(y),g=new Set(s);return u.size===g.size&&y.every(x=>g.has(x))}return i.bn(y,s)}const sd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},LD={showCompass:!0,showZoom:!0,visualizePitch:!1};class ND{constructor(s,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new hc({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new _g({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),i.aQ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(s,u){this.mouseRotate.mousedown(s,u),this.mousePitch&&this.mousePitch.mousedown(s,u),Q()}move(s,u){const g=this.map,x=this.mouseRotate.mousemoveWindow(s,u),S=x&&x.bearingDelta;if(S&&g.setBearing(g.getBearing()+S),this.mousePitch){const A=this.mousePitch.mousemoveWindow(s,u),L=A&&A.pitchDelta;L&&g.setPitch(g.getPitch()+L)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){oe(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(i.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ve(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ve(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Fe(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=Fe(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Qv(y,s,u){if(y=new i.bO(y.lng,y.lat),s){const g=new i.bO(y.lng-360,y.lat),x=new i.bO(y.lng+360,y.lat),S=360*Math.ceil(Math.abs(y.lng-u.center.lng)/360),A=u.locationPoint3D(y).distSqr(s),L=s.x<0||s.y<0||s.x>u.width||s.y>u.height;u.locationPoint3D(g).distSqr(s)<A&&(L||Math.abs(g.lng-u.center.lng)<S)?y=g:u.locationPoint3D(x).distSqr(s)<A&&(L||Math.abs(x.lng-u.center.lng)<S)&&(y=x)}for(;Math.abs(y.lng-u.center.lng)>180;){const g=u.locationPoint3D(y);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;y.lng>u.center.lng?y.lng-=360:y.lng+=360}return y}const fc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},es={anchor:"center",color:"#3FB1CE",scale:1,draggable:!1,clickTolerance:0,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class ta extends i.E{constructor(s,u){super(),(s instanceof HTMLElement||u)&&(s=i.l({element:s},u)),i.aQ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),s=i.l({},es,s),this._anchor=s.anchor,this._color=s.color,this._scale=s.scale,this._draggable=s.draggable,this._clickTolerance=s.clickTolerance,this._rotation=s.rotation,this._rotationAlignment=s.rotationAlignment,this._pitchAlignment=s.pitchAlignment,this._occludedOpacity=s.occludedOpacity,this._altitude=s.altitude,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=i.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const g=this._element.classList;for(const S in fc)g.remove(`mapboxgl-marker-anchor-${S}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`);const x=s&&s.className?s.className.trim().split(/\s+/):[];g.add(...x),this._popup=null}_createDefaultMarker(){const s=B("div"),u=q("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const g=q("radialGradient",{id:"shadowGradient"},q("defs",{},u));q("stop",{offset:"10%","stop-opacity":.4},g),q("stop",{offset:"100%","stop-opacity":.05},g),q("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return q("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),q("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),q("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=i.bO.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||es.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const u=s.code,g=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(s){const u=s.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,u=this._pos;if(!s||!u)return!1;const g=s.unproject(u,this._altitude),x=s.getFreeCameraOptions();if(!x.position)return!1;const S=x.position.toLngLat();return S.distanceTo(g)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const u=this._pos;if(!u||u.x<0||u.x>s.transform.width||u.y<0||u.y>s.transform.height)return void this._clearFadeTimer();const g=s.unproject(u,this._altitude);let x;s._showingGlobe()&&i.dK(s.transform,this._lngLat)?x=0:(x=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${fc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const s=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!s||g!=="map")return"";if(!u._showingGlobe()){const z=u.getPitch();return z?`rotateX(${z}deg)`:""}const x=i.c4(i.dL(u.transform,this._lngLat)),S=s.sub(i.dM(u.transform)),A=Math.abs(S.x)+Math.abs(S.y);if(A===0)return"";const L=x/A;return`rotateX(${-S.y*L}deg) rotateY(${S.x*L}deg)`}_calculateZTransform(){const s=this._pos,u=this._map;if(!u||!s)return"";let g=0;const x=this.getRotationAlignment();if(x==="map")if(u._showingGlobe()){const S=u.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),A=u.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(S);g=i.c4(Math.atan2(A.y,A.x))-90}else g=-u.getBearing();else if(x==="horizon"){const S=i.ae(4,6,u.getZoom()),A=i.dM(u.transform);A.y+=S*u.transform.height;const L=s.sub(A),z=i.c4(Math.atan2(L.y,L.x));g=(z>90?z-270:z+90)*(1-S)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Qv(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=i.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const u=this._map;if(!u)return;const g=this._pointerdownPos,x=this._positionDelta;if(g&&x){if(!this._isDragging){const S=this._clickTolerance||u._clickTolerance;if(s.point.dist(g)<S)return;this._isDragging=!0}this._pos=s.point.sub(x),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.A("dragstart"))),this.fire(new i.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.A("dragend")),this._state="inactive"}_addDragHandler(s){const u=this._map,g=this._pos;u&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const u=this._map;return u&&(s?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||es.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||es.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||es.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||es.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ts={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ho={maxWidth:100,unit:"metric"},k1={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Bi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},nA=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ld(y=new i.P(0,0),s="bottom"){if(typeof y=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(s){case"top":return new i.P(0,y);case"top-left":return new i.P(u,u);case"top-right":return new i.P(-u,u);case"bottom":return new i.P(0,-y);case"bottom-left":return new i.P(u,-u);case"bottom-right":return new i.P(-u,-u);case"left":return new i.P(y,0);case"right":return new i.P(-y,0)}return new i.P(0,0)}return y instanceof i.P||Array.isArray(y)?i.P.convert(y):i.P.convert(y[s]||[0,0])}return{version:_,supported:$.supported,setRTLTextPlugin:i.dN,getRTLTextPluginStatus:i.dO,Map:class extends Jf{constructor(y){E.mark(b.create);const s=y;if((y=i.l({},sd,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&i.dI(window)&&(y.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new fv(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies,null,null),y),this._repaint=!!y.repaint,this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new As,this._domRenderTaskQueue=new As,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aW(),this._locale=i.l({},uh,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._tessellationStep=y.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=y.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Qf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=y.scaleFactor,this._requestManager=new Ze(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,this._contextCreateOptions=y.contextCreateOptions?Object.assign({},y.contextCreateOptions):{},typeof y.container=="string"){const u=document.getElementById(y.container);if(!u)throw new Error(`Container '${y.container.toString()}' not found.`);this._container=u}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),this._spriteFormat=y.spriteFormat,i.aQ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new _1),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new tA(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,(y.style||!y.testMode)&&this.setStyle(y.style||i.e.DEFAULT_STYLE,{config:y.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this.indoor=new g2(this),y.hash&&(this._hash=new T1(typeof y.hash=="string"&&y.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch});const u=y.bounds;u&&(this.resize(),this.fitBounds(u,i.l({},y.fitBoundsOptions,{duration:0})))}this.resize(),y.attributionControl&&this.addControl(new Jv({customAttribution:y.customAttribution})),this._logoControl=new Es,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new i.A(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new i.A(`${u.dataType}dataloading`,u))}),this._interactions=new O1(this)}_getMapId(){return this._mapId}addControl(y,s){if(s===void 0&&(s=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new i.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=y.onAdd(this);this._controls.push(y);const g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new i.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(y);return s>-1&&this._controls.splice(s,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new i.A("movestart",y)).fire(new i.A("move",y)),this.fire(new i.A("resize",y)),s&&this.fire(new i.A("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(i.aB.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(y){return this._scaleFactor=y,this.painter.scaleFactor=y,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(s=>s==="auto"?navigator.language:s):y}setLanguage(y){const s=this._parseLanguage(y);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,s=y.projection.name;let u;s==="globe"&&y.zoom>=i.bY?(y.setMercatorFromTransition(),u=!0):s==="mercator"&&y.zoom<i.bY&&(y.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,s){return this._updateProjection(y||s||{name:"mercator"})}_updateProjection(y){let s;return s=y.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(y,s){return this.transform.locationPoint3D(i.bO.convert(y),s)}unproject(y,s){return this.transform.pointLocation3D(i.P.convert(y),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,s,u){const g=x=>{let S=[];if(Array.isArray(s)){const A=s.filter(L=>this.getLayer(L));S=A.length?this.queryRenderedFeatures(x,{layers:A}):[]}else S=this.queryRenderedFeatures(x,{target:s});return S};if(y==="mouseenter"||y==="mouseover"){let x=!1;return{listener:u,targets:s,delegates:{mousemove:A=>{const L=g(A.point);L.length?x||(x=!0,u.call(this,new Qa(y,this,A.originalEvent,{features:L}))):x=!1},mouseout:()=>{x=!1}}}}if(y==="mouseleave"||y==="mouseout"){let x=!1;return{listener:u,targets:s,delegates:{mousemove:L=>{g(L.point).length?x=!0:x&&(x=!1,u.call(this,new Qa(y,this,L.originalEvent)))},mouseout:L=>{x&&(x=!1,u.call(this,new Qa(y,this,L.originalEvent)))}}}}{const x=S=>{const A=g(S.point);A.length&&(S.features=A,u.call(this,S),delete S.features)};return{listener:u,targets:s,delegates:{[y]:x}}}}on(y,s,u){if(typeof s=="function"||u===void 0)return super.on(y,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(y,s,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(y,s,u){if(typeof s=="function"||u===void 0)return super.once(y,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(y,s,u);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(y,s,u){if(typeof s=="function"||u===void 0)return super.off(y,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._delegatedListeners?this._delegatedListeners[y]:void 0;return g&&(x=>{for(let S=0;S<x.length;S++){const A=x[S];if(A.listener===u&&bn(A.targets,s)){for(const L in A.delegates)this.off(L,A.delegates[L]);return x.splice(S,1),this}}})(g),this}queryRenderedFeatures(y,s){if(!this.style)return[];if(y===void 0||y instanceof i.P||Array.isArray(y)||s!==void 0||(s=y,y=void 0),y=y||[[0,0],[this.transform.width,this.transform.height]],!s){const S=this.style.queryRenderedFeatures(y,void 0,this.transform),A=this.style.queryRenderedFeatureset(y,void 0,this.transform);return S.concat(A)}let u=!0;if(s.target&&(u=this._isTargetValid(s.target),u&&!s.layers))return this.style.queryRenderedFeatureset(y,s,this.transform);let g=!0;if(s.layers&&Array.isArray(s.layers)){for(const S of s.layers)if(!this._isValidId(S)){g=!1;break}if(g&&!s.target)return this.style.queryRenderedFeatures(y,s,this.transform)}let x=[];return g&&(x=x.concat(this.style.queryRenderedFeatures(y,s,this.transform))),u&&(x=x.concat(this.style.queryRenderedFeatureset(y,s,this.transform))),x}querySourceFeatures(y,s){return!y||typeof y=="string"&&!this._isValidId(y)?[]:this.style.querySourceFeatures(y,s)}isPointOnSurface(y){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&i.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(y))}addInteraction(y,s){return this._interactions.add(y,s),this}removeInteraction(y){return this._interactions.remove(y),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(y){return this._cooperativeGestures=y,this}setStyle(y,s){return s=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&y&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(y,(u,g)=>{u?(i.w(`Unable to perform style diff: ${String(u.message||u.error||u)}. Rebuilding the style from scratch.`),this._updateStyle(y,s)):g&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(y,s))}_getUIString(y){const s=this._locale[y];if(s==null)throw new Error(`Missing UI string '${y}'`);return s}_updateStyle(y,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y){const u=i.l({},s);s&&s.config&&(u.initialConfig=s.config,delete u.config),this.style=new Rl(this,u).load(y),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Rl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(y){return y==null?(this.fire(new i.z(new Error("IDs can't be empty."))),!1):!i.cs(y)||(this.fire(new i.z(new Error(`IDs can't contain special symbols: "${y}".`))),!1)}_isTargetValid(y){return"featuresetId"in y?this._isValidId("importId"in y?y.importId:y.featuresetId):"layerId"in y&&this._isValidId(y.layerId)}_areTargetsValid(y){if(Array.isArray(y)){for(const s of y)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(y)}addSource(y,s){return this._isValidId(y)?(this._lazyInitEmptyStyle(),this.style.addSource(y,s),this._update(!0)):this}isSourceLoaded(y){return!!this._isValidId(y)&&!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(y,s,u){this._lazyInitEmptyStyle(),this.style.addSourceType(y,s,u)}removeSource(y){return this._isValidId(y)?(this.style.removeSource(y),this._updateTerrain(),this._update(!0)):this}getSource(y){return this._isValidId(y)?this.style.getOwnSource(y):null}addImage(y,s,{pixelRatio:u=1,sdf:g=!1,stretchX:x,stretchY:S,content:A}={}){this._lazyInitEmptyStyle();const L=i.I.from(y);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:z,height:U,data:V}=i.q.getImageData(s);this.style.addImage(L,{data:new i.r({width:z,height:U},V),pixelRatio:u,stretchX:x,stretchY:S,content:A,sdf:g,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new i.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:U}=s,V=s;this.style.addImage(L,{data:new i.r({width:z,height:U},new Uint8Array(V.data)),pixelRatio:u,stretchX:x,stretchY:S,content:A,sdf:g,usvg:!1,version:0,userImage:V}),V.onAdd&&V.onAdd(this,y)}}updateImage(y,s){this._lazyInitEmptyStyle();const u=i.I.from(y),g=this.style.getImage(u);if(!g)return void this.fire(new i.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?i.q.getImageData(s):s,{width:S,height:A,data:L}=x;if(S===void 0||A===void 0)return void this.fire(new i.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||A!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new i.z(new Error(`The width and height of the updated image (${S}, ${A})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const z=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let U=!1;g.usvg?(g.data=new i.r({width:S,height:A},new Uint8Array(L)),g.usvg=!1,g.icon=void 0,U=!0):g.data.replace(L,z),this.style.updateImage(u,g,U)}hasImage(y){return y?!!this.style&&!!this.style.getImage(i.I.from(y)):(this.fire(new i.z(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(i.I.from(y))}loadImage(y,s){i.o(this._requestManager.transformRequest(y,i.R.Image),(u,g)=>{s(u,g instanceof HTMLImageElement?i.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(y=>y.name)}addModel(y,s){this._lazyInitEmptyStyle(),this.style.addModel(y,s)}hasModel(y){return y?this.style.hasModel(y):(this.fire(new i.z(new Error("Missing required model id"))),!1)}removeModel(y){this.style.removeModel(y)}listModels(){return this.style.listModels()}addLayer(y,s){return this._isValidId(y.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(y,s),this._update(!0)):this}getSlot(y){const s=this.getLayer(y);return s&&s.slot||null}setSlot(y,s){return this.style.setSlot(y,s),this.style.mergeLayers(),this._update(!0)}addImport(y,s){return this.style.addImport(y,s),this}updateImport(y,s){return typeof s!="string"&&s.id!==y?(this.removeImport(y),this.addImport(s)):(this.style.updateImport(y,s),this._update(!0))}removeImport(y){return this.style.removeImport(y),this}moveImport(y,s){return this.style.moveImport(y,s),this._update(!0)}moveLayer(y,s){return this._isValidId(y)?(this.style.moveLayer(y,s),this._update(!0)):this}removeLayer(y){return this._isValidId(y)?(this.style.removeLayer(y),this._update(!0)):this}getLayer(y){if(!this._isValidId(y))return null;const s=this.style.getOwnLayer(y);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(y,s,u){return this._isValidId(y)?(this.style.setLayerZoomRange(y,s,u),this._update(!0)):this}setFilter(y,s,u={}){return this._isValidId(y)?(this.style.setFilter(y,s,u),this._update(!0)):this}getFilter(y){return this._isValidId(y)?this.style.getFilter(y):null}setPaintProperty(y,s,u,g={}){return this._isValidId(y)?(this.style.setPaintProperty(y,s,u,g),this._update(!0)):this}getPaintProperty(y,s){return this._isValidId(y)?this.style.getPaintProperty(y,s):null}setLayoutProperty(y,s,u,g={}){return this._isValidId(y)?(this.style.setLayoutProperty(y,s,u,g),this._update(!0)):this}getLayoutProperty(y,s){return this._isValidId(y)?this.style.getLayoutProperty(y,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(y){return this.style.setGlyphsUrl(y),this._update(!0)}getSchema(y){return this.style.getSchema(y)}setSchema(y,s){return this.style.setSchema(y,s),this._update(!0)}getConfig(y){return this.style.getConfig(y)}setConfig(y,s){return this.style.setConfig(y,s),this._update(!0)}getConfigProperty(y,s){return this.style.getConfigProperty(y,s)}setConfigProperty(y,s,u){return this.style.setConfigProperty(y,s,u),this._update(!0)}getFeaturesetDescriptors(y){return this.style.getFeaturesetDescriptors(y)}setLights(y){if(this._lazyInitEmptyStyle(),y&&y.length===1&&y[0].type==="flat"){const s=y[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(y),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const y=this.style.getLights()||[];return y.length===0&&y.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),y}setLight(y,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:y}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(y){return this._lazyInitEmptyStyle(),this.style.setSnow(y),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(y){return this._lazyInitEmptyStyle(),this.style.setRain(y),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(y){return this._lazyInitEmptyStyle(),this.style.setColorTheme(y),this._update(!0)}setImportColorTheme(y,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(y,s),this._update(!0)}setCamera(y){return this.style.setCamera(y),this._triggerCameraUpdate(y)}_triggerCameraUpdate(y){return this._update(this.transform.setOrthographicProjectionAtLowPitch(y["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(y),this.transform):0}setFeatureState(y,s){return y.source&&!this._isValidId(y.source)?this:(this.style.setFeatureState(y,s),this._update())}removeFeatureState(y,s){return y.source&&!this._isValidId(y.source)?this:(this.style.removeFeatureState(y,s),this._update())}getFeatureState(y){return y.source&&!this._isValidId(y.source)?null:this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let u,g,x,S=this._container;for(;S&&(!g||!x);){const A=window.getComputedStyle(S).transform;A&&A!=="none"&&(u=A.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(x=u[3])),S=S.parentElement}this._containerWidth=g?Math.abs(y/g):y,this._containerHeight=x?Math.abs(s/x):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=B("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=B("div","mapboxgl-canvas-container",y);this._canvas=B("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=B("div","mapboxgl-control-container",y),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{g[x]=B("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,s){const u=i.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(y),this._canvas.height=u*Math.ceil(s),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${s}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const s=this._markers.indexOf(y);s!==-1&&this._markers.splice(s,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const s=this._popups.indexOf(y);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const y=i.l({},$.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",y);s?(Ot(s,!0),this.painter=new Zv(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(s)):this.fire(new i.z(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.A("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.A("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let s;this.fire(new i.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,g=i.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=x.createQuery(),x.beginQuery(u.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,V=this.transform.pitch,X=i.q.now(),Y=new i.aa(U,{now:X,fadeDuration:S,pitch:V,transition:this.style.transition});this.style.update(Y)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.isMoving()||this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(g);const L=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),L&&(this._placementDirty=L.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,E.mark(b.load),this.fire(new i.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const U=i.q.now()-g;x.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const V=x.getQueryParameter(s,x.QUERY_RESULT)/1e6;x.deleteQuery(s),this.fire(new i.A("gpu-timing-frame",{cpuTime:U,gpuTime:V}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const V=this.painter.queryGpuTimers(U);this.fire(new i.A("gpu-timing-layer",{layerTimes:V}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const V=this.painter.queryGpuTimeDeferredRender(U);this.fire(new i.A("gpu-timing-deferred-render",{gpuTime:V}))},50)}const z=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(z||this._repaint)this.triggerRepaint();else{const U=this.idle();if(U&&(A=this._updateAverageElevation(g,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new i.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const V=this._calculateSpeedIndex();this.fire(new i.A("speedindexcompleted",{speedIndex:V})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,E.mark(b.fullLoad),this._performanceMetricsCollection&&hr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const s of this._markers)y&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!y||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(y,s=!1){const u=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(s||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const x=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=y;const A=Math.abs(x-S);if(A>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(S),u(S);this._averageElevation.easeTo(S,y,300)}else if(A>1e-4)return this._averageElevation.jumpTo(S),u(S)}return!!this._averageElevation.isEasing(y)&&u(this._averageElevation.getValue(y))}_authenticate(){ge(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===tt||y.status===401)){const s=this.painter.context.gl;Ot(s,!1),this._logoControl instanceof Es&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),nr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&ir(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function x(S){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,S,0);const A=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,A),A}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(x(y),s.canvasCopies.map(x),s.timeStamps)}_canvasPixelComparison(y,s,u){let g=u[1]-u[0];const x=y.length/4;for(let S=0;S<s.length;S++){const A=s[S];let L=0;for(let z=0;z<A.length;z+=4)A[z]===y[z]&&A[z+1]===y[z+1]&&A[z+2]===y[z+2]&&A[z+3]===y[z+3]&&(L+=1);g+=(u[S+2]-u[S+1])*(1-L/x)}return g}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),ur.delete(this.painter.context.gl),Vt.remove(),ct.remove(),this._removed=!0,this.fire(new i.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=i.q.frame(s=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(s)}))}_preloadTiles(y){const s=this.style?this.style.getSourceCaches():[];return i.bl(s,(u,g)=>u._preloadTiles(y,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(y){this._showParseStatus!==y&&(this._showParseStatus=y,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(y){this._showLayers2DWireframe!==y&&(this._showLayers2DWireframe=y,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(y){this._showLayers3DWireframe!==y&&(this._showLayers3DWireframe=y,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,this._tp.refreshUI(),y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,this._tp.refreshUI(),y&&this._update())}_setCacheLimits(y,s){i.dJ(y,s)}get version(){return _}},NavigationControl:class{constructor(y={}){this.options=i.l({},LD,y),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(i.aQ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),B("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),B("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aQ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:s}):u.resetNorth({},{originalEvent:s}))}),this._compassIcon=B("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const s=y.getZoom(),u=s===y.getMaxZoom(),g=s===y.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ND(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,s){const u=B("button",y,this._container);return u.type="button",u.addEventListener("click",s),u}_setButtonTitle(y,s){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${s}`);y.setAttribute("aria-label",u),y.firstElementChild&&y.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends i.E{constructor(y={}){super();const s=navigator.geolocation;this.options=i.l({geolocation:s},ts,y),i.aQ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Xv(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const s=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,y(u)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>s(u.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(y){const s=this._map.getMaxBounds(),u=y.coords;return!!s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new i.A("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("geolocate",y)),this._finish()}}_updateCamera(y){const s=new i.bO(y.coords.longitude,y.coords.latitude),u=y.coords.accuracy,g=this._map.getBearing(),x=i.l({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(u),x,{geolocateSource:!0})}_updateMarker(y){if(y){const s=new i.bO(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,s=i.bH(1,y._center.lat)*y.worldSize,u=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=B("button","mapboxgl-ctrl-geolocate",this._container),B("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B("div","mapboxgl-user-location"),this._dotElement.appendChild(B("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(B("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ta({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=B("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ta({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.A("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Jv,ScaleControl:class{constructor(y={}){this.options=i.l({},Ho,y),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aQ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,s=this._map,u=s._containerHeight/2,g=s._containerWidth/2-y/2,x=s.unproject([g,u]),S=s.unproject([g+y,u]),A=x.distanceTo(S);if(this.options.unit==="imperial"){const L=3.2808*A;L>5280?this._setScale(y,L/5280,"mile"):this._setScale(y,L,"foot")}else this.options.unit==="nautical"?this._setScale(y,A/1852,"nautical-mile"):A>=1e3?this._setScale(y,A/1e3,"kilometer"):this._setScale(y,A,"meter")}_setScale(y,s,u){this._map._requestDomTask(()=>{const g=function(S){const A=Math.pow(10,`${Math.floor(S)}`.length-1);let L=S/A;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(z){const U=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*U)/U}(L),A*L}(s),x=g/s;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${k1[u]}`,this._container.style.width=y*x+"px"})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y={}){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:i.w("Full screen control 'container' must be a DOM element.")),i.aQ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=B("button","mapboxgl-ctrl-fullscreen",this._controlContainer);B("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(y){super(),this.options=i.l(Object.create(Bi),y),this._altitude=this.options.altitude,i.aQ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new i.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new i.A("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=i.bO.convert(y),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(y){return this._altitude=y,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const s=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=y;g=u.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=B("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(y),this.options.closeButton){const u=this._closeButton=B("button","mapboxgl-popup-close-button",s);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let s;return this._classList.delete(y)?s=!1:(this._classList.add(y),s=!0),this._updateClassList(),s}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const s=this._map,u=this._container,g=this._pos;if(!s||!u||!g)return"bottom";const x=u.offsetWidth,S=u.offsetHeight,A=g.x<x/2,L=g.x>s.transform.width-x/2;if(g.y+y<S)return A?"top-left":L?"top-right":"top";if(g.y>s.transform.height-S){if(A)return"bottom-left";if(L)return"bottom-right"}return A?"left":L?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),y.className=s.join(" ")}_update(y){const s=this._map,u=this._content;if(!s||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=B("div","mapboxgl-popup",s.getContainer()),this._tip=B("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qv(this._lngLat,this._pos,s.transform)),!this._trackPointer||y){const x=this._pos=this._trackPointer&&y instanceof i.P?y:s.project(this._lngLat,this._altitude),S=ld(this.options.offset),A=this._anchor=this._getAnchor(S.y),L=ld(this.options.offset,A),z=x.add(L).round();s._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${fc[A]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&s._showingGlobe()){const x=i.dK(s.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(nA);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:ta,Style:Rl,LngLat:i.bO,LngLatBounds:i.aB,Point:i.P,MercatorCoordinate:i.ac,FreeCameraOptions:Mb,Evented:i.E,config:i.e,prewarm:i.dP,clearPrewarmedResources:i.dQ,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(y){i.e.ACCESS_TOKEN=y},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(y){i.e.API_URL=y},get workerCount(){return i.dR.workerCount},set workerCount(y){i.dR.workerCount=y},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){i.e.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){i.dS(y)},get workerUrl(){return i.dT.workerUrl},set workerUrl(y){i.dT.workerUrl=y},get workerClass(){return i.dT.workerClass},set workerClass(y){i.dT.workerClass=y},get workerParams(){return i.dT.workerParams},set workerParams(y){i.dT.workerParams=y},get dracoUrl(){return i.dU()},set dracoUrl(y){i.dV(y)},get meshoptUrl(){return i.dW()},set meshoptUrl(y){i.dX(y)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var h=a;return h})})(Hae);var tqe=Hae.exports;const Od=yi(tqe),i4=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on(l,h,i){if(r[l]===void 0)throw new Error(`Invalid event type: ${l}`);r[l].push({selector:h,fn:i})},render(l){t.store.featureChanged(l)}},a=function(l,h){const i=r[l];let _=i.length;for(;_--;){const b=i[_];if(b.selector(h)){b.fn.call(n,h)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(l){a("drag",l)},click(l){a("click",l)},mousemove(l){a("mousemove",l)},mousedown(l){a("mousedown",l)},mouseup(l){a("mouseup",l)},mouseout(l){a("mouseout",l)},keydown(l){a("keydown",l)},keyup(l){a("keyup",l)},touchstart(l){a("touchstart",l)},touchmove(l){a("touchmove",l)},touchend(l){a("touchend",l)},tap(l){a("tap",l)}}};var uU={},kR={};kR.RADIUS=6378137;kR.FLATTENING=1/298.257223563;kR.POLAR_RADIUS=63567523142e-4;var uX=kR;uU.geometry=Xae;uU.ring=o4;function Xae(e){var t=0,r;switch(e.type){case"Polygon":return dX(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)t+=dX(e.coordinates[r]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)t+=Xae(e.geometries[r]);return t}}function dX(e){var t=0;if(e&&e.length>0){t+=Math.abs(o4(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(o4(e[r]))}return t}function o4(e){var t,r,n,a,l,h,i,_=0,b=e.length;if(b>2){for(i=0;i<b;i++)i===b-2?(a=b-2,l=b-1,h=0):i===b-1?(a=b-1,l=0,h=1):(a=i,l=i+1,h=i+2),t=e[a],r=e[l],n=e[h],_+=(MN(n[0])-MN(t[0]))*Math.sin(MN(r[1]));_=_*uX.RADIUS*uX.RADIUS/2}return _}function MN(e){return e*Math.PI/180}const cl={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},Mc={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},wo={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},pl={POLYGON:"polygon",LINE:"line_string",POINT:"point"},on={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},ii={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},Us={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},HE={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},fs={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},ja={ACTIVE:"true",INACTIVE:"false"},Yae=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],rqe=-90,a4=-85,nqe=90,s4=85,iqe=-270,oqe=270,Kae=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:nqe,LAT_MIN:rqe,LAT_RENDERED_MAX:s4,LAT_RENDERED_MIN:a4,LNG_MAX:oqe,LNG_MIN:iqe,activeStates:ja,classes:cl,cursors:wo,events:Us,geojsonTypes:on,interactions:Yae,meta:fs,modes:ii,sources:Mc,types:pl,updateActions:HE},Symbol.toStringTag,{value:"Module"})),hX={Point:0,LineString:1,MultiLineString:1,Polygon:2};function aqe(e,t){const r=hX[e.geometry.type]-hX[t.geometry.type];return r===0&&e.geometry.type===on.POLYGON?e.area-t.area:r}function Jae(e){return e.map(t=>(t.geometry.type===on.POLYGON&&(t.area=uU.geometry({type:on.FEATURE,property:{},geometry:t.geometry})),t)).sort(aqe).map(t=>(delete t.area,t))}function Qae(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function Dc(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Dc.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Dc.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Dc.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Dc.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Dc.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const sqe=[fs.FEATURE,fs.MIDPOINT,fs.VERTEX],Px={click:lqe,touch:cqe};function lqe(e,t,r){return ese(e,t,r,r.options.clickBuffer)}function cqe(e,t,r){return ese(e,t,r,r.options.touchBuffer)}function ese(e,t,r,n){if(r.map===null)return[];const a=e?Qae(e,n):t,l={};r.options.styles&&(l.layers=r.options.styles.map(b=>b.id).filter(b=>r.map.getLayer(b)!=null));const h=r.map.queryRenderedFeatures(a,l).filter(b=>sqe.indexOf(b.properties.meta)!==-1),i=new Dc,_=[];return h.forEach(b=>{const E=b.properties.id;i.has(E)||(i.add(E),_.push(b))}),Jae(_)}function pM(e,t){const r=Px.click(e,null,t),n={mouse:wo.NONE};return r[0]&&(n.mouse=r[0].properties.active===ja.ACTIVE?wo.MOVE:wo.POINTER,n.feature=r[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(n.mouse=wo.ADD),t.ui.queueMapClasses(n),t.ui.updateMapClasses(),r[0]}function dU(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}const uqe=4,dqe=12,hqe=500;function l4(e,t,r={}){const n=r.fineTolerance!=null?r.fineTolerance:uqe,a=r.grossTolerance!=null?r.grossTolerance:dqe,l=r.interval!=null?r.interval:hqe;e.point=e.point||t.point,e.time=e.time||t.time;const h=dU(e.point,t.point);return h<n||h<a&&t.time-e.time<l}const fqe=25,pqe=250;function c4(e,t,r={}){const n=r.tolerance!=null?r.tolerance:fqe,a=r.interval!=null?r.interval:pqe;return e.point=e.point||t.point,e.time=e.time||t.time,dU(e.point,t.point)<n&&t.time-e.time<a}let mqe=(e,t=21)=>(r=t)=>{let n="",a=r|0;for(;a--;)n+=e[Math.random()*e.length|0];return n};const gqe=mqe("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function hU(){return gqe()}const qs=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||hU(),this.type=t.geometry.type};qs.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};qs.prototype.incomingCoords=function(e){this.setCoordinates(e)};qs.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};qs.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};qs.prototype.setProperty=function(e,t){this.properties[e]=t};qs.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:on.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};qs.prototype.internal=function(e){const t={id:this.id,meta:fs.FEATURE,"meta:type":this.type,active:ja.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:on.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const Fm=function(e,t){qs.call(this,e,t)};Fm.prototype=Object.create(qs.prototype);Fm.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};Fm.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};Fm.prototype.getCoordinate=function(){return this.getCoordinates()};const Kd=function(e,t){qs.call(this,e,t)};Kd.prototype=Object.create(qs.prototype);Kd.prototype.isValid=function(){return this.coordinates.length>1};Kd.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};Kd.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};Kd.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};Kd.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};const lc=function(e,t){qs.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};lc.prototype=Object.create(qs.prototype);lc.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};lc.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};lc.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};lc.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(l=>parseInt(l,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};lc.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};lc.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};lc.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};lc.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),a=parseInt(n[0],10),l=parseInt(n[1],10);this.coordinates[a]===void 0&&(this.coordinates[a]=[]),this.coordinates[a][l]=[t,r]};const yqe={MultiPoint:Fm,MultiLineString:Kd,MultiPolygon:lc},RR=(e,t,r,n,a)=>{const l=r.split("."),h=parseInt(l[0],10),i=l[1]?l.slice(1).join("."):null;return e[h][t](i,n,a)},$s=function(e,t){if(qs.call(this,e,t),delete this.coordinates,this.model=yqe[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};$s.prototype=Object.create(qs.prototype);$s.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:hU(),type:on.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};$s.prototype.isValid=function(){return this.features.every(e=>e.isValid())};$s.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};$s.prototype.getCoordinate=function(e){return RR(this.features,"getCoordinate",e)};$s.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===on.POLYGON?e.getCoordinates():e.coordinates)))};$s.prototype.updateCoordinate=function(e,t,r){RR(this.features,"updateCoordinate",e,t,r),this.changed()};$s.prototype.addCoordinate=function(e,t,r){RR(this.features,"addCoordinate",e,t,r),this.changed()};$s.prototype.removeCoordinate=function(e){RR(this.features,"removeCoordinate",e),this.changed()};$s.prototype.getFeatures=function(){return this.features};function qn(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}qn.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};qn.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};qn.prototype.getSelected=function(){return this._ctx.store.getSelected()};qn.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};qn.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};qn.prototype.getFeature=function(e){return this._ctx.store.get(e)};qn.prototype.select=function(e){return this._ctx.store.select(e)};qn.prototype.deselect=function(e){return this._ctx.store.deselect(e)};qn.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};qn.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)};qn.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};qn.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};qn.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};qn.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};qn.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)};qn.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};qn.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};qn.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return Px[r](e,t,this._ctx)};qn.prototype.newFeature=function(e){const t=e.geometry.type;return t===on.POINT?new Fm(this._ctx,e):t===on.LINE_STRING?new Kd(this._ctx,e):t===on.POLYGON?new lc(this._ctx,e):new $s(this._ctx,e)};qn.prototype.isInstanceOf=function(e,t){if(e===on.POINT)return t instanceof Fm;if(e===on.LINE_STRING)return t instanceof Kd;if(e===on.POLYGON)return t instanceof lc;if(e==="MultiFeature")return t instanceof $s;throw new Error(`Unknown feature class: ${e}`)};qn.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};qn.prototype.onSetup=function(){};qn.prototype.onDrag=function(){};qn.prototype.onClick=function(){};qn.prototype.onMouseMove=function(){};qn.prototype.onMouseDown=function(){};qn.prototype.onMouseUp=function(){};qn.prototype.onMouseOut=function(){};qn.prototype.onKeyUp=function(){};qn.prototype.onKeyDown=function(){};qn.prototype.onTouchStart=function(){};qn.prototype.onTouchMove=function(){};qn.prototype.onTouchEnd=function(){};qn.prototype.onTap=function(){};qn.prototype.onStop=function(){};qn.prototype.onTrash=function(){};qn.prototype.onCombineFeature=function(){};qn.prototype.onUncombineFeature=function(){};qn.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const tse={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},vqe=Object.keys(tse);function _qe(e){const t=Object.keys(e);return function(r,n={}){let a={};const l=t.reduce((i,_)=>(i[_]=e[_],i),new qn(r));function h(i){return _=>l[i](a,_)}return{start(){a=l.onSetup(n),vqe.forEach(i=>{const _=tse[i];let b=()=>!1;e[_]&&(b=()=>!0),this.on(i,b,h(_))})},stop(){l.onStop(a)},trash(){l.onTrash(a)},combineFeatures(){l.onCombineFeatures(a)},uncombineFeatures(){l.onUncombineFeatures(a)},render(i,_){l.toDisplayFeatures(a,i,_)}}}}function xqe(e){const t=Object.keys(e.options.modes).reduce((I,F)=>(I[F]=_qe(e.options.modes[F]),I),{});let r={},n={};const a={};let l=null,h=null;a.drag=function(I,F){F({point:I.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:wo.DRAG}),h.drag(I)):I.originalEvent.stopPropagation()},a.mousedrag=function(I){a.drag(I,F=>!l4(r,F))},a.touchdrag=function(I){a.drag(I,F=>!c4(n,F))},a.mousemove=function(I){if((I.originalEvent.buttons!==void 0?I.originalEvent.buttons:I.originalEvent.which)===1)return a.mousedrag(I);const $=pM(I,e);I.featureTarget=$,h.mousemove(I)},a.mousedown=function(I){r={time:new Date().getTime(),point:I.point};const F=pM(I,e);I.featureTarget=F,h.mousedown(I)},a.mouseup=function(I){const F=pM(I,e);I.featureTarget=F,l4(r,{point:I.point,time:new Date().getTime()})?h.click(I):h.mouseup(I)},a.mouseout=function(I){h.mouseout(I)},a.touchstart=function(I){if(!e.options.touchEnabled)return;n={time:new Date().getTime(),point:I.point};const F=Px.touch(I,null,e)[0];I.featureTarget=F,h.touchstart(I)},a.touchmove=function(I){if(e.options.touchEnabled)return h.touchmove(I),a.touchdrag(I)},a.touchend=function(I){if(I.originalEvent.preventDefault(),!e.options.touchEnabled)return;const F=Px.touch(I,null,e)[0];I.featureTarget=F,c4(n,{time:new Date().getTime(),point:I.point})?h.tap(I):h.touchend(I)};const i=I=>!(I===8||I===46||I>=48&&I<=57);a.keydown=function(I){(I.srcElement||I.target).classList.contains(cl.CANVAS)&&((I.keyCode===8||I.keyCode===46)&&e.options.controls.trash?(I.preventDefault(),h.trash()):i(I.keyCode)?h.keydown(I):I.keyCode===49&&e.options.controls.point?_(ii.DRAW_POINT):I.keyCode===50&&e.options.controls.line_string?_(ii.DRAW_LINE_STRING):I.keyCode===51&&e.options.controls.polygon&&_(ii.DRAW_POLYGON))},a.keyup=function(I){i(I.keyCode)&&h.keyup(I)},a.zoomend=function(){e.store.changeZoom()},a.data=function(I){if(I.dataType==="style"){const{setup:F,map:$,options:B,store:q}=e;B.styles.some(H=>$.getLayer(H.id))||(F.addLayers(),q.setDirty(),q.render())}};function _(I,F,$={}){h.stop();const B=t[I];if(B===void 0)throw new Error(`${I} is not valid`);l=I;const q=B(e,F);h=i4(q,e),$.silent||e.map.fire(Us.MODE_CHANGE,{mode:I}),e.store.setDirty(),e.store.render()}const b={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function E(I){let F=!1;Object.keys(I).forEach($=>{if(b[$]===void 0)throw new Error("Invalid action type");b[$]!==I[$]&&(F=!0),b[$]=I[$]}),F&&e.map.fire(Us.ACTIONABLE,{actions:b})}return{start(){l=e.options.defaultMode,h=i4(t[l](e),e)},changeMode:_,actionable:E,currentModeName(){return l},currentModeRender(I,F){return h.render(I,F)},fire(I,F){e.map&&e.map.fire(I,F)},addEventListeners(){e.map.on("mousemove",a.mousemove),e.map.on("mousedown",a.mousedown),e.map.on("mouseup",a.mouseup),e.map.on("data",a.data),e.map.on("touchmove",a.touchmove),e.map.on("touchstart",a.touchstart),e.map.on("touchend",a.touchend),e.container.addEventListener("mouseout",a.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",a.keydown),e.container.addEventListener("keyup",a.keyup))},removeEventListeners(){e.map.off("mousemove",a.mousemove),e.map.off("mousedown",a.mousedown),e.map.off("mouseup",a.mouseup),e.map.off("data",a.data),e.map.off("touchmove",a.touchmove),e.map.off("touchstart",a.touchstart),e.map.off("touchend",a.touchend),e.container.removeEventListener("mouseout",a.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",a.keydown),e.container.removeEventListener("keyup",a.keyup))},trash(I){h.trash(I)},combineFeatures(){h.combineFeatures()},uncombineFeatures(){h.uncombineFeatures()},getMode(){return l}}}function ZE(e){return[].concat(e).filter(t=>t!==void 0)}function bqe(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(Mc.HOT)!==void 0))return _();const r=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:r});let n=[],a=[];e.isDirty?a=e.getAllIds():(n=e.getChangedIds().filter(b=>e.get(b)!==void 0),a=e.sources.hot.filter(b=>b.properties.id&&n.indexOf(b.properties.id)===-1&&e.get(b.properties.id)!==void 0).map(b=>b.properties.id)),e.sources.hot=[];const l=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(b=>{const E=b.properties.id||b.properties.parent;return n.indexOf(E)===-1});const h=l!==e.sources.cold.length||a.length>0;n.forEach(b=>i(b,"hot")),a.forEach(b=>i(b,"cold"));function i(b,E){const I=e.get(b).internal(r);e.ctx.events.currentModeRender(I,F=>{F.properties.mode=r,e.sources[E].push(F)})}h&&e.ctx.map.getSource(Mc.COLD).setData({type:on.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(Mc.HOT).setData({type:on.FEATURE_COLLECTION,features:e.sources.hot}),_();function _(){e.isDirty=!1,e.clearChangedIds()}}function io(e){this._features={},this._featureIds=new Dc,this._selectedFeatureIds=new Dc,this._selectedCoordinates=[],this._changedFeatureIds=new Dc,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]};let t;this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,bqe.call(this),this._emitSelectionChange&&(this.ctx.events.fire(Us.SELECTION_CHANGE,{features:this.getSelected().map(r=>r.toGeoJSON()),points:this.getSelectedCoordinates().map(r=>({type:on.FEATURE,properties:{},geometry:{type:on.POINT,coordinates:r.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(Us.RENDER,{})}))},this.isDirty=!1}io.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};io.prototype.setDirty=function(){return this.isDirty=!0,this};io.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0){const n=this.get(e);this.ctx.events.fire(Us.CREATE,{features:[n.toGeoJSON()]})}return this};io.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0&&this.ctx.events.fire(Us.UPDATE,{action:t.action?t.action:HE.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this};io.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};io.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};io.prototype.getAllIds=function(){return this._featureIds.values()};io.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this};io.prototype.delete=function(e,t={}){const r=[];return ZE(e).forEach(n=>{this._featureIds.has(n)&&(this._featureIds.delete(n),this._selectedFeatureIds.delete(n),t.silent||r.indexOf(this._features[n])===-1&&r.push(this._features[n].toGeoJSON()),delete this._features[n],this.isDirty=!0)}),r.length&&this.ctx.events.fire(Us.DELETE,{features:r}),rse(this,t),this};io.prototype.get=function(e){return this._features[e]};io.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};io.prototype.select=function(e,t={}){return ZE(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};io.prototype.deselect=function(e,t={}){return ZE(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),rse(this,t),this};io.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};io.prototype.setSelected=function(e,t={}){return e=ZE(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};io.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};io.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};io.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};io.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))};io.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};io.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};io.prototype.setFeatureProperty=function(e,t,r,n={}){this.get(e).setProperty(t,r),this.featureChanged(e,{silent:n.silent,action:HE.CHANGE_PROPERTIES})};function rse(e,t={}){const r=e._selectedCoordinates.filter(n=>e._selectedFeatureIds.has(n.feature_id));e._selectedCoordinates.length!==r.length&&!t.silent&&(e._emitSelectionChange=!0),e._selectedCoordinates=r}io.prototype.storeMapConfig=function(){Yae.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};io.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};io.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};const wqe=["mode","feature","mouse"];function Sqe(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},a={mode:null,feature:null,mouse:null};function l(){h({mode:null,feature:null,mouse:null}),i()}function h(F){a=Object.assign(a,F)}function i(){if(!e.container)return;const F=[],$=[];wqe.forEach(B=>{a[B]!==n[B]&&(F.push(`${B}-${n[B]}`),a[B]!==null&&$.push(`${B}-${a[B]}`))}),F.length>0&&e.container.classList.remove(...F),$.length>0&&e.container.classList.add(...$),n=Object.assign(n,a)}function _(F,$={}){const B=document.createElement("button");return B.className=`${cl.CONTROL_BUTTON} ${$.className}`,B.setAttribute("title",$.title),$.container.appendChild(B),B.addEventListener("click",q=>{if(q.preventDefault(),q.stopPropagation(),q.target===r){b(),$.onDeactivate();return}E(F),$.onActivate()},!0),B}function b(){r&&(r.classList.remove(cl.ACTIVE_BUTTON),r=null)}function E(F){b();const $=t[F];$&&$&&F!=="trash"&&($.classList.add(cl.ACTIVE_BUTTON),r=$)}function C(){const F=e.options.controls,$=document.createElement("div");return $.className=`${cl.CONTROL_GROUP} ${cl.CONTROL_BASE}`,F&&(F[pl.LINE]&&(t[pl.LINE]=_(pl.LINE,{container:$,className:cl.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(ii.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),F[pl.POLYGON]&&(t[pl.POLYGON]=_(pl.POLYGON,{container:$,className:cl.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(ii.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),F[pl.POINT]&&(t[pl.POINT]=_(pl.POINT,{container:$,className:cl.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(ii.DRAW_POINT),onDeactivate:()=>e.events.trash()})),F.trash&&(t.trash=_("trash",{container:$,className:cl.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),F.combine_features&&(t.combine_features=_("combineFeatures",{container:$,className:cl.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),F.uncombine_features&&(t.uncombine_features=_("uncombineFeatures",{container:$,className:cl.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),$}function I(){Object.keys(t).forEach(F=>{const $=t[F];$.parentNode&&$.parentNode.removeChild($),delete t[F]})}return{setActiveButton:E,queueMapClasses:h,updateMapClasses:i,clearMapClasses:l,addButtons:C,removeButtons:I}}function Tqe(e){let t=null,r=null;const n={onRemove(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(a){if(e.map=a,e.events=xqe(e),e.ui=Sqe(e),e.container=a.getContainer(),e.store=new io(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=a.boxZoom.isEnabled(),a.boxZoom.disable();const l=a.dragPan.isEnabled();a.dragPan.disable(),a.dragPan.enable(),l||a.dragPan.disable()}return a.loaded()?n.connect():(a.on("load",n.connect),r=setInterval(()=>{a.loaded()&&n.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(Mc.COLD,{data:{type:on.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Mc.HOT,{data:{type:on.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(a=>{e.map.addLayer(a)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(a=>{e.map.getLayer(a.id)&&e.map.removeLayer(a.id)}),e.map.getSource(Mc.COLD)&&e.map.removeSource(Mc.COLD),e.map.getSource(Mc.HOT)&&e.map.removeSource(Mc.HOT)}};return e.setup=n,n}const PN="#3bb2d0",zw="#fbb03b",fX="#fff",nse=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],zw,PN],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],zw,PN],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":fX}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],zw,PN]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":fX}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":zw}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":zw}}];function DR(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}}function ise(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0}function nv(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===ja.ACTIVE&&e.featureTarget.properties.meta===fs.FEATURE}function fU(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===ja.INACTIVE&&e.featureTarget.properties.meta===fs.FEATURE}function LR(e){return e.featureTarget===void 0}function pU(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===fs.FEATURE}function XE(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===fs.VERTEX}function PO(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1}function NR(e){return e.keyCode===27}function zR(e){return e.keyCode===13}function Eqe(){return!0}const Aqe=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:nv,isEnterKey:zR,isEscapeKey:NR,isFeature:pU,isInactiveFeature:fU,isOfMetaType:DR,isShiftDown:PO,isShiftMousedown:ise,isTrue:Eqe,isVertex:XE,noTarget:LR},Symbol.toStringTag,{value:"Module"}));function Qp(e,t){this.x=e,this.y=t}Qp.prototype={clone(){return new Qp(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,a=r*this.x+t*this.y;return this.x=n,this.y=a,this},_rotateAround(e,t){const r=Math.cos(e),n=Math.sin(e),a=t.x+r*(this.x-t.x)-n*(this.y-t.y),l=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=a,this.y=l,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Qp};Qp.convert=function(e){if(e instanceof Qp)return e;if(Array.isArray(e))return new Qp(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new Qp(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};function mU(e,t){const r=t.getBoundingClientRect();return new Qp(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}function Ix(e,t,r,n){return{type:on.FEATURE,properties:{meta:fs.VERTEX,parent:e,coord_path:r,active:n?ja.ACTIVE:ja.INACTIVE},geometry:{type:on.POINT,coordinates:t}}}function ose(e,t,r){const n=t.geometry.coordinates,a=r.geometry.coordinates;if(n[1]>s4||n[1]<a4||a[1]>s4||a[1]<a4)return null;const l={lng:(n[0]+a[0])/2,lat:(n[1]+a[1])/2};return{type:on.FEATURE,properties:{meta:fs.MIDPOINT,parent:e,lng:l.lng,lat:l.lat,coord_path:r.properties.coord_path},geometry:{type:on.POINT,coordinates:[l.lng,l.lat]}}}function jR(e,t={},r=null){const{type:n,coordinates:a}=e.geometry,l=e.properties&&e.properties.id;let h=[];n===on.POINT?h.push(Ix(l,a,r,_(r))):n===on.POLYGON?a.forEach((E,C)=>{i(E,r!==null?`${r}.${C}`:String(C))}):n===on.LINE_STRING?i(a,r):n.indexOf(on.MULTI_PREFIX)===0&&b();function i(E,C){let I="",F=null;E.forEach(($,B)=>{const q=C!=null?`${C}.${B}`:String(B),G=Ix(l,$,q,_(q));if(t.midpoints&&F){const J=ose(l,F,G);J&&h.push(J)}F=G;const H=JSON.stringify($);I!==H&&h.push(G),B===0&&(I=H)})}function _(E){return t.selectedPaths?t.selectedPaths.indexOf(E)!==-1:!1}function b(){const E=n.replace(on.MULTI_PREFIX,"");a.forEach((C,I)=>{const F={type:on.FEATURE,properties:e.properties,geometry:{type:E,coordinates:C}};h=h.concat(jR(F,t,I))})}return h}const Fu={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:WC,LAT_MAX:GC,LAT_RENDERED_MIN:pX,LAT_RENDERED_MAX:mX,LNG_MIN:gX,LNG_MAX:yX}=Kae;function Cqe(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],r=[e.geometry.coordinates].flat(t),n=r.map(i=>i[0]),a=r.map(i=>i[1]),l=i=>Math.min.apply(null,i),h=i=>Math.max.apply(null,i);return[l(n),l(a),h(n),h(a)]}function gU(e,t){let r=WC,n=GC,a=WC,l=GC,h=yX,i=gX;e.forEach(b=>{const E=Cqe(b),C=E[1],I=E[3],F=E[0],$=E[2];C>r&&(r=C),I<n&&(n=I),I>a&&(a=I),C<l&&(l=C),F<h&&(h=F),$>i&&(i=$)});const _=t;return r+_.lat>mX&&(_.lat=mX-r),a+_.lat>GC&&(_.lat=GC-a),n+_.lat<pX&&(_.lat=pX-n),l+_.lat<WC&&(_.lat=WC-l),h+_.lng<=gX&&(_.lng+=Math.ceil(Math.abs(_.lng)/360)*360),i+_.lng>=yX&&(_.lng-=Math.ceil(Math.abs(_.lng)/360)*360),_}function yU(e,t){const r=gU(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const a=n.getCoordinates(),l=b=>{const E={lng:b[0]+r.lng,lat:b[1]+r.lat};return[E.lng,E.lat]},h=b=>b.map(E=>l(E)),i=b=>b.map(E=>h(E));let _;n.type===on.POINT?_=l(a):n.type===on.LINE_STRING||n.type===on.MULTI_POINT?_=a.map(l):n.type===on.POLYGON||n.type===on.MULTI_LINE_STRING?_=a.map(h):n.type===on.MULTI_POLYGON&&(_=a.map(i)),n.incomingCoords(_)})}const Hi={};Hi.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};Hi.fireUpdate=function(){this.fire(Us.UPDATE,{action:HE.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};Hi.fireActionable=function(){const e=this.getSelected(),t=e.filter(l=>this.isInstanceOf("MultiFeature",l));let r=!1;if(e.length>1){r=!0;const l=e[0].type.replace("Multi","");e.forEach(h=>{h.type.replace("Multi","")!==l&&(r=!1)})}const n=t.length>0,a=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:a})};Hi.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new Dc).values():[]};Hi.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};Hi.onStop=function(){Fu.enable(this)};Hi.onMouseMove=function(e,t){return pU(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0};Hi.onMouseOut=function(e){return e.dragMoving?this.fireUpdate():!0};Hi.onTap=Hi.onClick=function(e,t){if(LR(t))return this.clickAnywhere(e,t);if(DR(fs.VERTEX)(t))return this.clickOnVertex(e,t);if(pU(t))return this.clickOnFeature(e,t)};Hi.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),Fu.enable(this),this.stopExtendedInteractions(e)};Hi.clickOnVertex=function(e,t){this.changeMode(ii.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:wo.MOVE})};Hi.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Hi.clickOnFeature=function(e,t){Fu.disable(this),this.stopExtendedInteractions(e);const r=PO(t),n=this.getSelectedIds(),a=t.featureTarget.properties.id,l=this.isSelected(a);if(!r&&l&&this.getFeature(a).type!==on.POINT)return this.changeMode(ii.DIRECT_SELECT,{featureId:a});l&&r?(this.deselect(a),this.updateUIClasses({mouse:wo.POINTER}),n.length===1&&Fu.enable(this)):!l&&r?(this.select(a),this.updateUIClasses({mouse:wo.MOVE})):!l&&!r&&(n.forEach(h=>this.doRender(h)),this.setSelected(a),this.updateUIClasses({mouse:wo.MOVE})),this.doRender(a)};Hi.onMouseDown=function(e,t){if(e.initialDragPanState=this.map.dragPan.isEnabled(),nv(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&ise(t))return this.startBoxSelect(e,t)};Hi.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=mU(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};Hi.onTouchStart=function(e,t){if(nv(t))return this.startOnActiveFeature(e,t)};Hi.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};Hi.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:wo.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(cl.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=mU(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),a=Math.max(e.boxSelectStartLocation.x,r.x),l=Math.min(e.boxSelectStartLocation.y,r.y),h=Math.max(e.boxSelectStartLocation.y,r.y),i=`translate(${n}px, ${l}px)`;e.boxSelectElement.style.transform=i,e.boxSelectElement.style.WebkitTransform=i,e.boxSelectElement.style.width=`${a-n}px`,e.boxSelectElement.style.height=`${h-l}px`};Hi.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};yU(this.getSelected(),r),e.dragMoveLocation=t.lngLat};Hi.onTouchEnd=Hi.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,mU(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),a=this.getUniqueIds(n).filter(l=>!this.isSelected(l));a.length&&(this.select(a),a.forEach(l=>this.doRender(l)),this.updateUIClasses({mouse:wo.MOVE}))}this.stopExtendedInteractions(e)};Hi.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?ja.ACTIVE:ja.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==ja.ACTIVE||t.geometry.type===on.POINT)&&jR(t).forEach(r)};Hi.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};Hi.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let a=0;a<e.length;a++){const l=e[a];if(l.type.replace("Multi","")!==n)return;l.type.includes("Multi")?l.getCoordinates().forEach(h=>{t.push(h)}):t.push(l.getCoordinates()),r.push(l.toGeoJSON())}if(r.length>1){const a=this.newFeature({type:on.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.fire(Us.COMBINE_FEATURES,{createdFeatures:[a.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};Hi.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const a=e[n];this.isInstanceOf("MultiFeature",a)&&(a.getFeatures().forEach(l=>{this.addFeature(l),l.properties=a.properties,t.push(l.toGeoJSON()),this.select([l.id])}),this.deleteFeature(a.id,{silent:!0}),r.push(a.toGeoJSON()))}t.length>1&&this.fire(Us.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};const ase=DR(fs.VERTEX),sse=DR(fs.MIDPOINT),Zi={};Zi.fireUpdate=function(){this.fire(Us.UPDATE,{action:HE.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};Zi.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};Zi.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Zi.stopDragging=function(e){e.canDragMove&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};Zi.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!PO(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:PO(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const a=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(a)};Zi.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};Zi.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};Zi.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};Zi.dragFeature=function(e,t,r){yU(this.getSelected(),r),e.dragMoveLocation=t.lngLat};Zi.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(h=>e.feature.getCoordinate(h)),a=n.map(h=>({type:on.FEATURE,properties:{},geometry:{type:on.POINT,coordinates:h}})),l=gU(a,r);for(let h=0;h<n.length;h++){const i=n[h];e.feature.updateCoordinate(e.selectedCoordPaths[h],i[0]+l.lng,i[1]+l.lat)}};Zi.clickNoTarget=function(){this.changeMode(ii.SIMPLE_SELECT)};Zi.clickInactive=function(){this.changeMode(ii.SIMPLE_SELECT)};Zi.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};Zi.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===on.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),Fu.disable(this),this.setActionableState({trash:!0}),n};Zi.onStop=function(){Fu.enable(this),this.clearSelectedCoordinates()};Zi.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=ja.ACTIVE,r(t),jR(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=ja.INACTIVE,r(t)),this.fireActionable(e)};Zi.onTrash=function(e){e.selectedCoordPaths.sort((t,r)=>r.localeCompare(t,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(ii.SIMPLE_SELECT,{}))};Zi.onMouseMove=function(e,t){const r=nv(t),n=ase(t),a=sse(t),l=e.selectedCoordPaths.length===0;return r&&l?this.updateUIClasses({mouse:wo.MOVE}):n&&!l?this.updateUIClasses({mouse:wo.MOVE}):this.updateUIClasses({mouse:wo.NONE}),(n||r||a)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0};Zi.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0};Zi.onTouchStart=Zi.onMouseDown=function(e,t){if(ase(t))return this.onVertex(e,t);if(nv(t))return this.onFeature(e,t);if(sse(t))return this.onMidpoint(e,t)};Zi.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};Zi.onClick=function(e,t){if(LR(t))return this.clickNoTarget(e,t);if(nv(t))return this.clickActiveFeature(e,t);if(fU(t))return this.clickInactive(e,t);this.stopDragging(e)};Zi.onTap=function(e,t){if(LR(t))return this.clickNoTarget(e,t);if(nv(t))return this.clickActiveFeature(e,t);if(fU(t))return this.clickInactive(e,t)};Zi.onTouchEnd=Zi.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const Ud={};Ud.onSetup=function(){const e=this.newFeature({type:on.FEATURE,properties:{},geometry:{type:on.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:wo.ADD}),this.activateUIButton(pl.POINT),this.setActionableState({trash:!0}),{point:e}};Ud.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT)};Ud.onTap=Ud.onClick=function(e,t){this.updateUIClasses({mouse:wo.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(Us.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.point.id]})};Ud.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Ud.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?ja.ACTIVE:ja.INACTIVE,!n)return r(t)};Ud.onTrash=Ud.stopDrawingAndRemove;Ud.onKeyUp=function(e,t){if(NR(t)||zR(t))return this.stopDrawingAndRemove(e,t)};function IO(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}const Bu={};Bu.onSetup=function(){const e=this.newFeature({type:on.FEATURE,properties:{},geometry:{type:on.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),Fu.disable(this),this.updateUIClasses({mouse:wo.ADD}),this.activateUIButton(pl.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};Bu.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&IO(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:wo.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};Bu.clickOnVertex=function(e){return this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Bu.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),XE(t)&&this.updateUIClasses({mouse:wo.POINTER})};Bu.onTap=Bu.onClick=function(e,t){return XE(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};Bu.onKeyUp=function(e,t){NR(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT)):zR(t)&&this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Bu.onStop=function(e){this.updateUIClasses({mouse:wo.NONE}),Fu.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(Us.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT,{},{silent:!0})))};Bu.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?ja.ACTIVE:ja.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const a=t.geometry.coordinates[0].length;if(!(a<3)){if(t.properties.meta=fs.FEATURE,r(Ix(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),a>3){const l=t.geometry.coordinates[0].length-3;r(Ix(e.polygon.id,t.geometry.coordinates[0][l],`0.${l}`,!1))}if(a<=4){const l=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:on.FEATURE,properties:t.properties,geometry:{coordinates:l,type:on.LINE_STRING}}),a===3)return}return r(t)}};Bu.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT)};const $u={};$u.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,a="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let l=e.from;if(l&&l.type==="Feature"&&l.geometry&&l.geometry.type==="Point"&&(l=l.geometry),l&&l.type==="Point"&&l.coordinates&&l.coordinates.length===2&&(l=l.coordinates),!l||!Array.isArray(l))throw new Error("Please use the `from` property to indicate which point to continue the line from");const h=r.coordinates.length-1;if(r.coordinates[h][0]===l[0]&&r.coordinates[h][1]===l[1])n=h+1,r.addCoordinate(n,...r.coordinates[h]);else if(r.coordinates[0][0]===l[0]&&r.coordinates[0][1]===l[1])a="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:on.FEATURE,properties:{},geometry:{type:on.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),Fu.disable(this),this.updateUIClasses({mouse:wo.ADD}),this.activateUIButton(pl.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:a}};$u.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&IO(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&IO(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:wo.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};$u.clickOnVertex=function(e){return this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.line.id]})};$u.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),XE(t)&&this.updateUIClasses({mouse:wo.POINTER})};$u.onTap=$u.onClick=function(e,t){if(XE(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};$u.onKeyUp=function(e,t){zR(t)?this.changeMode(ii.SIMPLE_SELECT,{featureIds:[e.line.id]}):NR(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT))};$u.onStop=function(e){Fu.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(Us.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT,{},{silent:!0})))};$u.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(ii.SIMPLE_SELECT)};$u.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?ja.ACTIVE:ja.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=fs.FEATURE,r(Ix(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};const lse={simple_select:Hi,direct_select:Zi,draw_point:Ud,draw_polygon:Bu,draw_line_string:$u},Mqe={defaultMode:ii.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:nse,modes:lse,controls:{},userProperties:!1,suppressAPIEvents:!0},Pqe={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Iqe={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function vX(e,t){return e.map(r=>r.source?r:Object.assign({},r,{id:`${r.id}.${t}`,source:t==="hot"?Mc.HOT:Mc.COLD}))}function Oqe(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Object.assign({},Iqe,e.controls):t.controls=Object.assign({},Pqe,e.controls),t=Object.assign({},Mqe,t),t.styles=vX(t.styles,"cold").concat(vX(t.styles,"hot")),t}var kqe=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,l;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(l=Object.keys(t),n=l.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,l[a]))return!1;for(a=n;a--!==0;){var h=l[a];if(!e(t[h],r[h]))return!1}return!0}return t!==t&&r!==r};const _X=yi(kqe);var Rqe=Lqe,Dqe={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Lqe(e){if(!e||!e.type)return null;var t=Dqe[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}const Nqe=yi(Rqe);function cse(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())}const zqe={Polygon:lc,LineString:Kd,Point:Fm,MultiPolygon:$s,MultiLineString:$s,MultiPoint:$s};function jqe(e,t){t.modes=ii;const r=e.options.suppressAPIEvents!==void 0?!!e.options.suppressAPIEvents:!0;return t.getFeatureIdsAt=function(n){return Px.click({point:n},null,e).map(l=>l.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:on.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(n=>e.store.get(n)).map(n=>n.toGeoJSON())}},t.getSelectedPoints=function(){return{type:on.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(n=>({type:on.FEATURE,properties:{},geometry:{type:on.POINT,coordinates:n.coordinates}}))}},t.set=function(n){if(n.type===void 0||n.type!==on.FEATURE_COLLECTION||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");const a=e.store.createRenderBatch();let l=e.store.getAllIds().slice();const h=t.add(n),i=new Dc(h);return l=l.filter(_=>!i.has(_)),l.length&&t.delete(l),a(),h},t.add=function(n){const l=JSON.parse(JSON.stringify(Nqe(n))).features.map(h=>{if(h.id=h.id||hU(),h.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(h.id)===void 0||e.store.get(h.id).type!==h.geometry.type){const i=zqe[h.geometry.type];if(i===void 0)throw new Error(`Invalid geometry type: ${h.geometry.type}.`);const _=new i(e,h);e.store.add(_,{silent:r})}else{const i=e.store.get(h.id),_=i.properties;i.properties=h.properties,_X(_,h.properties)||e.store.featureChanged(i.id,{silent:r}),_X(i.getCoordinates(),h.geometry.coordinates)||i.incomingCoords(h.geometry.coordinates)}return h.id});return e.store.render(),l},t.get=function(n){const a=e.store.get(n);if(a)return a.toGeoJSON()},t.getAll=function(){return{type:on.FEATURE_COLLECTION,features:e.store.getAll().map(n=>n.toGeoJSON())}},t.delete=function(n){return e.store.delete(n,{silent:r}),t.getMode()===ii.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(ii.SIMPLE_SELECT,void 0,{silent:r}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:r}),t.getMode()===ii.DIRECT_SELECT?e.events.changeMode(ii.SIMPLE_SELECT,void 0,{silent:r}):e.store.render(),t},t.changeMode=function(n,a={}){return n===ii.SIMPLE_SELECT&&t.getMode()===ii.SIMPLE_SELECT?(cse(a.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(a.featureIds,{silent:r}),e.store.render()),t):(n===ii.DIRECT_SELECT&&t.getMode()===ii.DIRECT_SELECT&&a.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(n,a,{silent:r}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:r}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:r}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:r}),t},t.setFeatureProperty=function(n,a,l){return e.store.setFeatureProperty(n,a,l,{silent:r}),t},t}const Fqe=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:Aqe,ModeHandler:i4,StringSet:Dc,constrainFeatureMovement:gU,createMidPoint:ose,createSupplementaryPoints:jR,createVertex:Ix,doubleClickZoom:Fu,euclideanDistance:dU,featuresAt:Px,getFeatureAtAndSetCursors:pM,isClick:l4,isEventAtCoordinates:IO,isTap:c4,mapEventToBoundingBox:Qae,moveFeatures:yU,sortFeatures:Jae,stringSetsAreEqual:cse,theme:nse,toDenseArray:ZE},Symbol.toStringTag,{value:"Module"})),Bqe=function(e,t){e=Oqe(e);const r={options:e};t=jqe(r,t),r.api=t;const n=Tqe(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=pl,t.options=e,t};function FR(e){Bqe(e,this)}FR.modes=lse;FR.constants=Kae;FR.lib=Fqe;Od.accessToken="pk.eyJ1IjoiY2FybG9zaDIiLCJhIjoiY203aWxlNHU5MXNwNjJzcTNmZGZscThqaSJ9.mt9vzXHbWRtOj6rqrpSD5g";const $qe=({onPolygonComplete:e,orders:t=[]})=>{const r=ne.useRef(null),n=ne.useRef(null),a=ne.useRef(null),l=ne.useRef([]),[h,i]=ne.useState(!1),_=()=>{l.current.forEach(I=>I.remove()),l.current=[]},b=()=>{n.current&&(_(),t.forEach(I=>{if(I.lat&&I.lng){const F=new Od.Marker().setLngLat([I.lng,I.lat]).setPopup(new Od.Popup({offset:25}).setHTML(`<div>
                  <p><strong>Dirección:</strong> ${I.street} ${I.number}</p>
                  <p><strong>Código Postal:</strong> ${I.postal_code}</p>
                </div>`)).addTo(n.current);l.current.push(F)}}))};ne.useEffect(()=>{if(r.current)return n.current=new Od.Map({container:r.current,style:"mapbox://styles/mapbox/streets-v12",center:[-99.1332,19.4326],zoom:11}),a.current=new FR({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}}),n.current.addControl(a.current),n.current.addControl(new Od.NavigationControl,"top-right"),n.current.on("draw.create",I=>{if(I.features&&I.features.length>0&&I.features[0].geometry&&I.features[0].geometry.coordinates){const F=I.features[0].geometry.coordinates[0];e==null||e(F),i(!1)}}),n.current.on("draw.delete",()=>{i(!1)}),n.current.on("load",()=>{b()}),()=>{_(),n.current&&n.current.remove()}},[]),ne.useEffect(()=>{b()},[t]);const E=()=>{a.current&&!h&&(a.current.changeMode("draw_polygon"),i(!0))},C=()=>{a.current&&(a.current.deleteAll(),i(!1))};return j.jsxs(Yd,{className:"h-[600px] flex flex-col",children:[j.jsx("div",{className:"p-4 border-b",children:j.jsxs("div",{className:"flex gap-2",children:[j.jsxs(Yn,{onClick:E,disabled:h,variant:"outline",className:"flex items-center gap-2",children:[j.jsx(u0,{className:"h-4 w-4"}),"Dibujar Zona"]}),j.jsxs(Yn,{onClick:C,variant:"outline",className:"flex items-center gap-2",children:[j.jsx(Vge,{className:"h-4 w-4"}),"Borrar"]})]})}),j.jsx("div",{className:"flex-1 relative",children:j.jsx("div",{ref:r,className:"absolute inset-0"})})]})},Uqe=()=>{const{data:e}=Yy({queryKey:["orders"],queryFn:async()=>{const{data:r,error:n}=await Oi.from("orders").select("*").not("lat","is",null).not("lng","is",null);if(n)throw n;return r}}),t=r=>{console.log("Polígono completado:",r)};return j.jsxs("div",{className:"animate-fade-in space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Paquetes"})}),j.jsxs("div",{className:"grid gap-6",children:[j.jsx($qe,{onPolygonComplete:t,orders:e}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(w0,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Gestión de Paquetes"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Aquí podrás gestionar todos los paquetes, agruparlos, imprimir etiquetas y revisar su estado actual."})]})]})]})},Vqe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Inventario"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(Cge,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Sistema de Gestión de Inventario"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Maneja tu inventario general, organízalo por ubicación, gestiona el inbound y outbound, y más."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),Wqe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Flota"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(fT,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Gestión de Flota y Conductores"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Administra tus conductores y vehículos, revisa documentación, asignaciones y ranking de desempeño."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),Gqe=()=>{const{data:e,isLoading:t}=Yy({queryKey:["operators"],queryFn:async()=>{const{data:r,error:n}=await Oi.from("operators").select("*").order("created_at",{ascending:!1});if(n)throw n;return r}});return j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Operadores"}),j.jsx(vy,{to:"/admin/operators/new",children:j.jsxs(Yn,{children:[j.jsx(Gz,{className:"mr-2 h-4 w-4"}),"Nuevo Operador"]})})]}),j.jsxs(Yd,{children:[j.jsxs(mb,{children:[j.jsx(gb,{children:"Lista de Operadores"}),j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsxs("div",{className:"relative flex-1",children:[j.jsx(_k,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),j.jsx(wi,{placeholder:"Buscar operador...",className:"pl-8"})]}),j.jsx(Yn,{variant:"outline",size:"icon",children:j.jsx(EQ,{className:"h-4 w-4"})})]})]}),j.jsx(jm,{children:t?j.jsx("div",{className:"py-6 text-center",children:j.jsx("p",{children:"Cargando operadores..."})}):e&&e.length>0?j.jsxs(F$,{children:[j.jsx(B$,{children:j.jsxs(ay,{children:[j.jsx(Hl,{children:"ID"}),j.jsx(Hl,{children:"Nombre"}),j.jsx(Hl,{children:"Correo"}),j.jsx(Hl,{children:"Teléfono"}),j.jsx(Hl,{children:"CURP"}),j.jsx(Hl,{children:"Acciones"})]})}),j.jsx($$,{children:e.map(r=>j.jsxs(ay,{children:[j.jsx(Ns,{className:"font-medium",children:r.short_id}),j.jsx(Ns,{children:`${r.name} ${r.lastname} ${r.second_lastname}`}),j.jsx(Ns,{children:r.email}),j.jsx(Ns,{children:r.phone}),j.jsx(Ns,{children:r.curp}),j.jsx(Ns,{children:j.jsx(vy,{to:`/admin/operators/${r.id}/edit`,children:j.jsx(Yn,{variant:"ghost",size:"icon",children:j.jsx(Bge,{className:"h-4 w-4"})})})})]},r.id))})]}):j.jsxs("div",{className:"py-6 text-center",children:[j.jsx("h3",{className:"mt-2 text-lg font-semibold",children:"No hay operadores registrados"}),j.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:'Empieza agregando un nuevo operador con el botón "Nuevo Operador".'}),j.jsx(vy,{to:"/admin/operators/new",className:"mt-6 inline-flex",children:j.jsxs(Yn,{children:[j.jsx(Gz,{className:"mr-2 h-4 w-4"}),"Nuevo Operador"]})})]})})]})]})};var YE=e=>e.type==="checkbox",sy=e=>e instanceof Date,zs=e=>e==null;const use=e=>typeof e=="object";var Ko=e=>!zs(e)&&!Array.isArray(e)&&use(e)&&!sy(e),dse=e=>Ko(e)&&e.target?YE(e.target)?e.target.checked:e.target.value:e,qqe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,hse=(e,t)=>e.has(qqe(t)),Hqe=e=>{const t=e.constructor&&e.constructor.prototype;return Ko(t)&&t.hasOwnProperty("isPrototypeOf")},vU=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ul(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(vU&&(e instanceof Blob||e instanceof FileList))&&(r||Ko(e)))if(t=r?[]:{},!r&&!Hqe(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=ul(e[n]));else return e;return t}var BR=e=>Array.isArray(e)?e.filter(Boolean):[],$o=e=>e===void 0,Er=(e,t,r)=>{if(!t||!Ko(e))return r;const n=BR(t.split(/[,[\].]+?/)).reduce((a,l)=>zs(a)?a:a[l],e);return $o(n)||n===e?$o(e[t])?r:e[t]:n},Tc=e=>typeof e=="boolean",_U=e=>/^\w*$/.test(e),fse=e=>BR(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Ii=(e,t,r)=>{let n=-1;const a=_U(t)?[t]:fse(t),l=a.length,h=l-1;for(;++n<l;){const i=a[n];let _=r;if(n!==h){const b=e[i];_=Ko(b)||Array.isArray(b)?b:isNaN(+a[n+1])?{}:[]}if(i==="__proto__")return;e[i]=_,e=e[i]}return e};const OO={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Au={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},gh={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},pse=Ae.createContext(null),KE=()=>Ae.useContext(pse),mse=e=>{const{children:t,...r}=e;return Ae.createElement(pse.Provider,{value:r},t)};var gse=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(a,l,{get:()=>{const h=l;return t._proxyFormState[h]!==Au.all&&(t._proxyFormState[h]=!n||Au.all),r&&(r[h]=!0),e[h]}});return a},fl=e=>Ko(e)&&!Object.keys(e).length,yse=(e,t,r,n)=>{r(e);const{name:a,...l}=e;return fl(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(h=>t[h]===(!n||Au.all))},GS=e=>Array.isArray(e)?e:[e],vse=(e,t,r)=>!e||!t||e===t||GS(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function xU(e){const t=Ae.useRef(e);t.current=e,Ae.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function Zqe(e){const t=KE(),{control:r=t.control,disabled:n,name:a,exact:l}=e||{},[h,i]=Ae.useState(r._formState),_=Ae.useRef(!0),b=Ae.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),E=Ae.useRef(a);return E.current=a,xU({disabled:n,next:C=>_.current&&vse(E.current,C.name,l)&&yse(C,b.current,r._updateFormState)&&i({...r._formState,...C}),subject:r._subjects.state}),Ae.useEffect(()=>(_.current=!0,b.current.isValid&&r._updateValid(!0),()=>{_.current=!1}),[r]),gse(h,r,b.current,!1)}var kd=e=>typeof e=="string",_se=(e,t,r,n,a)=>kd(e)?(n&&t.watch.add(e),Er(r,e,a)):Array.isArray(e)?e.map(l=>(n&&t.watch.add(l),Er(r,l))):(n&&(t.watchAll=!0),r);function Xqe(e){const t=KE(),{control:r=t.control,name:n,defaultValue:a,disabled:l,exact:h}=e||{},i=Ae.useRef(n);i.current=n,xU({disabled:l,subject:r._subjects.values,next:E=>{vse(i.current,E.name,h)&&b(ul(_se(i.current,r._names,E.values||r._formValues,!1,a)))}});const[_,b]=Ae.useState(r._getWatch(n,a));return Ae.useEffect(()=>r._removeUnmounted()),_}function Yqe(e){const t=KE(),{name:r,disabled:n,control:a=t.control,shouldUnregister:l}=e,h=hse(a._names.array,r),i=Xqe({control:a,name:r,defaultValue:Er(a._formValues,r,Er(a._defaultValues,r,e.defaultValue)),exact:!0}),_=Zqe({control:a,name:r,exact:!0}),b=Ae.useRef(a.register(r,{...e.rules,value:i,...Tc(e.disabled)?{disabled:e.disabled}:{}}));return Ae.useEffect(()=>{const E=a._options.shouldUnregister||l,C=(I,F)=>{const $=Er(a._fields,I);$&&$._f&&($._f.mount=F)};if(C(r,!0),E){const I=ul(Er(a._options.defaultValues,r));Ii(a._defaultValues,r,I),$o(Er(a._formValues,r))&&Ii(a._formValues,r,I)}return()=>{(h?E&&!a._state.action:E)?a.unregister(r):C(r,!1)}},[r,a,h,l]),Ae.useEffect(()=>{Er(a._fields,r)&&a._updateDisabledField({disabled:n,fields:a._fields,name:r,value:Er(a._fields,r)._f.value})},[n,r,a]),{field:{name:r,value:i,...Tc(n)||_.disabled?{disabled:_.disabled||n}:{},onChange:Ae.useCallback(E=>b.current.onChange({target:{value:dse(E),name:r},type:OO.CHANGE}),[r]),onBlur:Ae.useCallback(()=>b.current.onBlur({target:{value:Er(a._formValues,r),name:r},type:OO.BLUR}),[r,a]),ref:Ae.useCallback(E=>{const C=Er(a._fields,r);C&&E&&(C._f.ref={focus:()=>E.focus(),select:()=>E.select(),setCustomValidity:I=>E.setCustomValidity(I),reportValidity:()=>E.reportValidity()})},[a._fields,r])},formState:_,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Er(_.errors,r)},isDirty:{enumerable:!0,get:()=>!!Er(_.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Er(_.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Er(_.validatingFields,r)},error:{enumerable:!0,get:()=>Er(_.errors,r)}})}}const Kqe=e=>e.render(Yqe(e));var xse=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},xX=e=>({isOnSubmit:!e||e===Au.onSubmit,isOnBlur:e===Au.onBlur,isOnChange:e===Au.onChange,isOnAll:e===Au.all,isOnTouch:e===Au.onTouched}),bX=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const qS=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const l=Er(e,a);if(l){const{_f:h,...i}=l;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],a)&&!n)return!0;if(h.ref&&t(h.ref,h.name)&&!n)return!0;if(qS(i,t))break}else if(Ko(i)&&qS(i,t))break}}};var Jqe=(e,t,r)=>{const n=GS(Er(e,r));return Ii(n,"root",t[r]),Ii(e,r,n),e},bU=e=>e.type==="file",Lh=e=>typeof e=="function",kO=e=>{if(!vU)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},mM=e=>kd(e),wU=e=>e.type==="radio",RO=e=>e instanceof RegExp;const wX={value:!1,isValid:!1},SX={value:!0,isValid:!0};var bse=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!$o(e[0].attributes.value)?$o(e[0].value)||e[0].value===""?SX:{value:e[0].value,isValid:!0}:SX:wX}return wX};const TX={isValid:!1,value:null};var wse=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,TX):TX;function EX(e,t,r="validate"){if(mM(e)||Array.isArray(e)&&e.every(mM)||Tc(e)&&!e)return{type:r,message:mM(e)?e:"",ref:t}}var C_=e=>Ko(e)&&!RO(e)?e:{value:e,message:""},AX=async(e,t,r,n,a)=>{const{ref:l,refs:h,required:i,maxLength:_,minLength:b,min:E,max:C,pattern:I,validate:F,name:$,valueAsNumber:B,mount:q,disabled:G}=e._f,H=Er(t,$);if(!q||G)return{};const J=h?h[0]:l,Q=je=>{n&&J.reportValidity&&(J.setCustomValidity(Tc(je)?"":je||""),J.reportValidity())},oe={},de=wU(l),ae=YE(l),ve=de||ae,Fe=(B||bU(l))&&$o(l.value)&&$o(H)||kO(l)&&l.value===""||H===""||Array.isArray(H)&&!H.length,ke=xse.bind(null,$,r,oe),Ce=(je,tt,Ze,Qe=gh.maxLength,st=gh.minLength)=>{const ot=je?tt:Ze;oe[$]={type:je?Qe:st,message:ot,ref:l,...ke(je?Qe:st,ot)}};if(a?!Array.isArray(H)||!H.length:i&&(!ve&&(Fe||zs(H))||Tc(H)&&!H||ae&&!bse(h).isValid||de&&!wse(h).isValid)){const{value:je,message:tt}=mM(i)?{value:!!i,message:i}:C_(i);if(je&&(oe[$]={type:gh.required,message:tt,ref:J,...ke(gh.required,tt)},!r))return Q(tt),oe}if(!Fe&&(!zs(E)||!zs(C))){let je,tt;const Ze=C_(C),Qe=C_(E);if(!zs(H)&&!isNaN(H)){const st=l.valueAsNumber||H&&+H;zs(Ze.value)||(je=st>Ze.value),zs(Qe.value)||(tt=st<Qe.value)}else{const st=l.valueAsDate||new Date(H),ot=zt=>new Date(new Date().toDateString()+" "+zt),Be=l.type=="time",lt=l.type=="week";kd(Ze.value)&&H&&(je=Be?ot(H)>ot(Ze.value):lt?H>Ze.value:st>new Date(Ze.value)),kd(Qe.value)&&H&&(tt=Be?ot(H)<ot(Qe.value):lt?H<Qe.value:st<new Date(Qe.value))}if((je||tt)&&(Ce(!!je,Ze.message,Qe.message,gh.max,gh.min),!r))return Q(oe[$].message),oe}if((_||b)&&!Fe&&(kd(H)||a&&Array.isArray(H))){const je=C_(_),tt=C_(b),Ze=!zs(je.value)&&H.length>+je.value,Qe=!zs(tt.value)&&H.length<+tt.value;if((Ze||Qe)&&(Ce(Ze,je.message,tt.message),!r))return Q(oe[$].message),oe}if(I&&!Fe&&kd(H)){const{value:je,message:tt}=C_(I);if(RO(je)&&!H.match(je)&&(oe[$]={type:gh.pattern,message:tt,ref:l,...ke(gh.pattern,tt)},!r))return Q(tt),oe}if(F){if(Lh(F)){const je=await F(H,t),tt=EX(je,J);if(tt&&(oe[$]={...tt,...ke(gh.validate,tt.message)},!r))return Q(tt.message),oe}else if(Ko(F)){let je={};for(const tt in F){if(!fl(je)&&!r)break;const Ze=EX(await F[tt](H,t),J,tt);Ze&&(je={...Ze,...ke(tt,Ze.message)},Q(Ze.message),r&&(oe[$]=je))}if(!fl(je)&&(oe[$]={ref:J,...je},!r))return oe}}return Q(!0),oe};function Qqe(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=$o(e)?n++:e[t[n++]];return e}function eHe(e){for(const t in e)if(e.hasOwnProperty(t)&&!$o(e[t]))return!1;return!0}function ya(e,t){const r=Array.isArray(t)?t:_U(t)?[t]:fse(t),n=r.length===1?e:Qqe(e,r),a=r.length-1,l=r[a];return n&&delete n[l],a!==0&&(Ko(n)&&fl(n)||Array.isArray(n)&&eHe(n))&&ya(e,r.slice(0,-1)),e}var IN=()=>{let e=[];return{get observers(){return e},next:a=>{for(const l of e)l.next&&l.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(l=>l!==a)}}),unsubscribe:()=>{e=[]}}},u4=e=>zs(e)||!use(e);function Np(e,t){if(u4(e)||u4(t))return e===t;if(sy(e)&&sy(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r){const l=e[a];if(!n.includes(a))return!1;if(a!=="ref"){const h=t[a];if(sy(l)&&sy(h)||Ko(l)&&Ko(h)||Array.isArray(l)&&Array.isArray(h)?!Np(l,h):l!==h)return!1}}return!0}var Sse=e=>e.type==="select-multiple",tHe=e=>wU(e)||YE(e),ON=e=>kO(e)&&e.isConnected,Tse=e=>{for(const t in e)if(Lh(e[t]))return!0;return!1};function DO(e,t={}){const r=Array.isArray(e);if(Ko(e)||r)for(const n in e)Array.isArray(e[n])||Ko(e[n])&&!Tse(e[n])?(t[n]=Array.isArray(e[n])?[]:{},DO(e[n],t[n])):zs(e[n])||(t[n]=!0);return t}function Ese(e,t,r){const n=Array.isArray(e);if(Ko(e)||n)for(const a in e)Array.isArray(e[a])||Ko(e[a])&&!Tse(e[a])?$o(t)||u4(r[a])?r[a]=Array.isArray(e[a])?DO(e[a],[]):{...DO(e[a])}:Ese(e[a],zs(t)?{}:t[a],r[a]):r[a]=!Np(e[a],t[a]);return r}var jw=(e,t)=>Ese(e,t,DO(t)),Ase=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>$o(e)?e:t?e===""?NaN:e&&+e:r&&kd(e)?new Date(e):n?n(e):e;function kN(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return bU(t)?t.files:wU(t)?wse(e.refs).value:Sse(t)?[...t.selectedOptions].map(({value:r})=>r):YE(t)?bse(e.refs).value:Ase($o(t.value)?e.ref.value:t.value,e)}var rHe=(e,t,r,n)=>{const a={};for(const l of e){const h=Er(t,l);h&&Ii(a,l,h._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},Fw=e=>$o(e)?e:RO(e)?e.source:Ko(e)?RO(e.value)?e.value.source:e.value:e;const CX="AsyncFunction";var nHe=e=>(!e||!e.validate)&&!!(Lh(e.validate)&&e.validate.constructor.name===CX||Ko(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===CX)),iHe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function MX(e,t,r){const n=Er(e,r);if(n||_U(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const l=a.join("."),h=Er(t,l),i=Er(e,l);if(h&&!Array.isArray(h)&&r!==l)return{name:r};if(i&&i.type)return{name:l,error:i};a.pop()}return{name:r}}var oHe=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,aHe=(e,t)=>!BR(Er(e,t)).length&&ya(e,t);const sHe={mode:Au.onSubmit,reValidateMode:Au.onChange,shouldFocusError:!0};function lHe(e={}){let t={...sHe,...e},r={submitCount:0,isDirty:!1,isLoading:Lh(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=Ko(t.defaultValues)||Ko(t.values)?ul(t.defaultValues||t.values)||{}:{},l=t.shouldUnregister?{}:ul(a),h={action:!1,mount:!1,watch:!1},i={mount:new Set,unMount:new Set,array:new Set,watch:new Set},_,b=0;const E={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},C={values:IN(),array:IN(),state:IN()},I=xX(t.mode),F=xX(t.reValidateMode),$=t.criteriaMode===Au.all,B=Ge=>vt=>{clearTimeout(b),b=setTimeout(Ge,vt)},q=async Ge=>{if(!e.disabled&&(E.isValid||Ge)){const vt=t.resolver?fl((await ve()).errors):await ke(n,!0);vt!==r.isValid&&C.state.next({isValid:vt})}},G=(Ge,vt)=>{!e.disabled&&(E.isValidating||E.validatingFields)&&((Ge||Array.from(i.mount)).forEach(kt=>{kt&&(vt?Ii(r.validatingFields,kt,vt):ya(r.validatingFields,kt))}),C.state.next({validatingFields:r.validatingFields,isValidating:!fl(r.validatingFields)}))},H=(Ge,vt=[],kt,fr,dr=!0,ar=!0)=>{if(fr&&kt&&!e.disabled){if(h.action=!0,ar&&Array.isArray(Er(n,Ge))){const Yt=kt(Er(n,Ge),fr.argA,fr.argB);dr&&Ii(n,Ge,Yt)}if(ar&&Array.isArray(Er(r.errors,Ge))){const Yt=kt(Er(r.errors,Ge),fr.argA,fr.argB);dr&&Ii(r.errors,Ge,Yt),aHe(r.errors,Ge)}if(E.touchedFields&&ar&&Array.isArray(Er(r.touchedFields,Ge))){const Yt=kt(Er(r.touchedFields,Ge),fr.argA,fr.argB);dr&&Ii(r.touchedFields,Ge,Yt)}E.dirtyFields&&(r.dirtyFields=jw(a,l)),C.state.next({name:Ge,isDirty:je(Ge,vt),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Ii(l,Ge,vt)},J=(Ge,vt)=>{Ii(r.errors,Ge,vt),C.state.next({errors:r.errors})},Q=Ge=>{r.errors=Ge,C.state.next({errors:r.errors,isValid:!1})},oe=(Ge,vt,kt,fr)=>{const dr=Er(n,Ge);if(dr){const ar=Er(l,Ge,$o(kt)?Er(a,Ge):kt);$o(ar)||fr&&fr.defaultChecked||vt?Ii(l,Ge,vt?ar:kN(dr._f)):Qe(Ge,ar),h.mount&&q()}},de=(Ge,vt,kt,fr,dr)=>{let ar=!1,Yt=!1;const Zr={name:Ge};if(!e.disabled){const oi=!!(Er(n,Ge)&&Er(n,Ge)._f&&Er(n,Ge)._f.disabled);if(!kt||fr){E.isDirty&&(Yt=r.isDirty,r.isDirty=Zr.isDirty=je(),ar=Yt!==Zr.isDirty);const Bn=oi||Np(Er(a,Ge),vt);Yt=!!(!oi&&Er(r.dirtyFields,Ge)),Bn||oi?ya(r.dirtyFields,Ge):Ii(r.dirtyFields,Ge,!0),Zr.dirtyFields=r.dirtyFields,ar=ar||E.dirtyFields&&Yt!==!Bn}if(kt){const Bn=Er(r.touchedFields,Ge);Bn||(Ii(r.touchedFields,Ge,kt),Zr.touchedFields=r.touchedFields,ar=ar||E.touchedFields&&Bn!==kt)}ar&&dr&&C.state.next(Zr)}return ar?Zr:{}},ae=(Ge,vt,kt,fr)=>{const dr=Er(r.errors,Ge),ar=E.isValid&&Tc(vt)&&r.isValid!==vt;if(e.delayError&&kt?(_=B(()=>J(Ge,kt)),_(e.delayError)):(clearTimeout(b),_=null,kt?Ii(r.errors,Ge,kt):ya(r.errors,Ge)),(kt?!Np(dr,kt):dr)||!fl(fr)||ar){const Yt={...fr,...ar&&Tc(vt)?{isValid:vt}:{},errors:r.errors,name:Ge};r={...r,...Yt},C.state.next(Yt)}},ve=async Ge=>{G(Ge,!0);const vt=await t.resolver(l,t.context,rHe(Ge||i.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return G(Ge),vt},Fe=async Ge=>{const{errors:vt}=await ve(Ge);if(Ge)for(const kt of Ge){const fr=Er(vt,kt);fr?Ii(r.errors,kt,fr):ya(r.errors,kt)}else r.errors=vt;return vt},ke=async(Ge,vt,kt={valid:!0})=>{for(const fr in Ge){const dr=Ge[fr];if(dr){const{_f:ar,...Yt}=dr;if(ar){const Zr=i.array.has(ar.name),oi=dr._f&&nHe(dr._f);oi&&E.validatingFields&&G([fr],!0);const Bn=await AX(dr,l,$,t.shouldUseNativeValidation&&!vt,Zr);if(oi&&E.validatingFields&&G([fr]),Bn[ar.name]&&(kt.valid=!1,vt))break;!vt&&(Er(Bn,ar.name)?Zr?Jqe(r.errors,Bn,ar.name):Ii(r.errors,ar.name,Bn[ar.name]):ya(r.errors,ar.name))}!fl(Yt)&&await ke(Yt,vt,kt)}}return kt.valid},Ce=()=>{for(const Ge of i.unMount){const vt=Er(n,Ge);vt&&(vt._f.refs?vt._f.refs.every(kt=>!ON(kt)):!ON(vt._f.ref))&&ir(Ge)}i.unMount=new Set},je=(Ge,vt)=>!e.disabled&&(Ge&&vt&&Ii(l,Ge,vt),!Np(Lt(),a)),tt=(Ge,vt,kt)=>_se(Ge,i,{...h.mount?l:$o(vt)?a:kd(Ge)?{[Ge]:vt}:vt},kt,vt),Ze=Ge=>BR(Er(h.mount?l:a,Ge,e.shouldUnregister?Er(a,Ge,[]):[])),Qe=(Ge,vt,kt={})=>{const fr=Er(n,Ge);let dr=vt;if(fr){const ar=fr._f;ar&&(!ar.disabled&&Ii(l,Ge,Ase(vt,ar)),dr=kO(ar.ref)&&zs(vt)?"":vt,Sse(ar.ref)?[...ar.ref.options].forEach(Yt=>Yt.selected=dr.includes(Yt.value)):ar.refs?YE(ar.ref)?ar.refs.length>1?ar.refs.forEach(Yt=>(!Yt.defaultChecked||!Yt.disabled)&&(Yt.checked=Array.isArray(dr)?!!dr.find(Zr=>Zr===Yt.value):dr===Yt.value)):ar.refs[0]&&(ar.refs[0].checked=!!dr):ar.refs.forEach(Yt=>Yt.checked=Yt.value===dr):bU(ar.ref)?ar.ref.value="":(ar.ref.value=dr,ar.ref.type||C.values.next({name:Ge,values:{...l}})))}(kt.shouldDirty||kt.shouldTouch)&&de(Ge,dr,kt.shouldTouch,kt.shouldDirty,!0),kt.shouldValidate&&zt(Ge)},st=(Ge,vt,kt)=>{for(const fr in vt){const dr=vt[fr],ar=`${Ge}.${fr}`,Yt=Er(n,ar);(i.array.has(Ge)||Ko(dr)||Yt&&!Yt._f)&&!sy(dr)?st(ar,dr,kt):Qe(ar,dr,kt)}},ot=(Ge,vt,kt={})=>{const fr=Er(n,Ge),dr=i.array.has(Ge),ar=ul(vt);Ii(l,Ge,ar),dr?(C.array.next({name:Ge,values:{...l}}),(E.isDirty||E.dirtyFields)&&kt.shouldDirty&&C.state.next({name:Ge,dirtyFields:jw(a,l),isDirty:je(Ge,ar)})):fr&&!fr._f&&!zs(ar)?st(Ge,ar,kt):Qe(Ge,ar,kt),bX(Ge,i)&&C.state.next({...r}),C.values.next({name:h.mount?Ge:void 0,values:{...l}})},Be=async Ge=>{h.mount=!0;const vt=Ge.target;let kt=vt.name,fr=!0;const dr=Er(n,kt),ar=()=>vt.type?kN(dr._f):dse(Ge),Yt=Zr=>{fr=Number.isNaN(Zr)||sy(Zr)&&isNaN(Zr.getTime())||Np(Zr,Er(l,kt,Zr))};if(dr){let Zr,oi;const Bn=ar(),Ti=Ge.type===OO.BLUR||Ge.type===OO.FOCUS_OUT,So=!iHe(dr._f)&&!t.resolver&&!Er(r.errors,kt)&&!dr._f.deps||oHe(Ti,Er(r.touchedFields,kt),r.isSubmitted,F,I),Wo=bX(kt,i,Ti);Ii(l,kt,Bn),Ti?(dr._f.onBlur&&dr._f.onBlur(Ge),_&&_(0)):dr._f.onChange&&dr._f.onChange(Ge);const la=de(kt,Bn,Ti,!1),ys=!fl(la)||Wo;if(!Ti&&C.values.next({name:kt,type:Ge.type,values:{...l}}),So)return E.isValid&&(e.mode==="onBlur"?Ti&&q():q()),ys&&C.state.next({name:kt,...Wo?{}:la});if(!Ti&&Wo&&C.state.next({...r}),t.resolver){const{errors:Ba}=await ve([kt]);if(Yt(Bn),fr){const vs=MX(r.errors,n,kt),go=MX(Ba,n,vs.name||kt);Zr=go.error,kt=go.name,oi=fl(Ba)}}else G([kt],!0),Zr=(await AX(dr,l,$,t.shouldUseNativeValidation))[kt],G([kt]),Yt(Bn),fr&&(Zr?oi=!1:E.isValid&&(oi=await ke(n,!0)));fr&&(dr._f.deps&&zt(dr._f.deps),ae(kt,oi,Zr,la))}},lt=(Ge,vt)=>{if(Er(r.errors,vt)&&Ge.focus)return Ge.focus(),1},zt=async(Ge,vt={})=>{let kt,fr;const dr=GS(Ge);if(t.resolver){const ar=await Fe($o(Ge)?Ge:dr);kt=fl(ar),fr=Ge?!dr.some(Yt=>Er(ar,Yt)):kt}else Ge?(fr=(await Promise.all(dr.map(async ar=>{const Yt=Er(n,ar);return await ke(Yt&&Yt._f?{[ar]:Yt}:Yt)}))).every(Boolean),!(!fr&&!r.isValid)&&q()):fr=kt=await ke(n);return C.state.next({...!kd(Ge)||E.isValid&&kt!==r.isValid?{}:{name:Ge},...t.resolver||!Ge?{isValid:kt}:{},errors:r.errors}),vt.shouldFocus&&!fr&&qS(n,lt,Ge?dr:i.mount),fr},Lt=Ge=>{const vt={...h.mount?l:a};return $o(Ge)?vt:kd(Ge)?Er(vt,Ge):Ge.map(kt=>Er(vt,kt))},Bt=(Ge,vt)=>({invalid:!!Er((vt||r).errors,Ge),isDirty:!!Er((vt||r).dirtyFields,Ge),error:Er((vt||r).errors,Ge),isValidating:!!Er(r.validatingFields,Ge),isTouched:!!Er((vt||r).touchedFields,Ge)}),ct=Ge=>{Ge&&GS(Ge).forEach(vt=>ya(r.errors,vt)),C.state.next({errors:Ge?r.errors:{}})},nr=(Ge,vt,kt)=>{const fr=(Er(n,Ge,{_f:{}})._f||{}).ref,dr=Er(r.errors,Ge)||{},{ref:ar,message:Yt,type:Zr,...oi}=dr;Ii(r.errors,Ge,{...oi,...vt,ref:fr}),C.state.next({name:Ge,errors:r.errors,isValid:!1}),kt&&kt.shouldFocus&&fr&&fr.focus&&fr.focus()},mr=(Ge,vt)=>Lh(Ge)?C.values.subscribe({next:kt=>Ge(tt(void 0,vt),kt)}):tt(Ge,vt,!0),ir=(Ge,vt={})=>{for(const kt of Ge?GS(Ge):i.mount)i.mount.delete(kt),i.array.delete(kt),vt.keepValue||(ya(n,kt),ya(l,kt)),!vt.keepError&&ya(r.errors,kt),!vt.keepDirty&&ya(r.dirtyFields,kt),!vt.keepTouched&&ya(r.touchedFields,kt),!vt.keepIsValidating&&ya(r.validatingFields,kt),!t.shouldUnregister&&!vt.keepDefaultValue&&ya(a,kt);C.values.next({values:{...l}}),C.state.next({...r,...vt.keepDirty?{isDirty:je()}:{}}),!vt.keepIsValid&&q()},Ut=({disabled:Ge,name:vt,field:kt,fields:fr,value:dr})=>{if(Tc(Ge)&&h.mount||Ge){const ar=Ge?void 0:$o(dr)?kN(kt?kt._f:Er(fr,vt)._f):dr;Ii(l,vt,ar),de(vt,ar,!1,!1,!0)}},hr=(Ge,vt={})=>{let kt=Er(n,Ge);const fr=Tc(vt.disabled)||Tc(e.disabled);return Ii(n,Ge,{...kt||{},_f:{...kt&&kt._f?kt._f:{ref:{name:Ge}},name:Ge,mount:!0,...vt}}),i.mount.add(Ge),kt?Ut({field:kt,disabled:Tc(vt.disabled)?vt.disabled:e.disabled,name:Ge,value:vt.value}):oe(Ge,!0,vt.value),{...fr?{disabled:vt.disabled||e.disabled}:{},...t.progressive?{required:!!vt.required,min:Fw(vt.min),max:Fw(vt.max),minLength:Fw(vt.minLength),maxLength:Fw(vt.maxLength),pattern:Fw(vt.pattern)}:{},name:Ge,onChange:Be,onBlur:Be,ref:dr=>{if(dr){hr(Ge,vt),kt=Er(n,Ge);const ar=$o(dr.value)&&dr.querySelectorAll&&dr.querySelectorAll("input,select,textarea")[0]||dr,Yt=tHe(ar),Zr=kt._f.refs||[];if(Yt?Zr.find(oi=>oi===ar):ar===kt._f.ref)return;Ii(n,Ge,{_f:{...kt._f,...Yt?{refs:[...Zr.filter(ON),ar,...Array.isArray(Er(a,Ge))?[{}]:[]],ref:{type:ar.type,name:Ge}}:{ref:ar}}}),oe(Ge,!1,void 0,ar)}else kt=Er(n,Ge,{}),kt._f&&(kt._f.mount=!1),(t.shouldUnregister||vt.shouldUnregister)&&!(hse(i.array,Ge)&&h.action)&&i.unMount.add(Ge)}}},Vt=()=>t.shouldFocusError&&qS(n,lt,i.mount),ge=Ge=>{Tc(Ge)&&(C.state.next({disabled:Ge}),qS(n,(vt,kt)=>{const fr=Er(n,kt);fr&&(vt.disabled=fr._f.disabled||Ge,Array.isArray(fr._f.refs)&&fr._f.refs.forEach(dr=>{dr.disabled=fr._f.disabled||Ge}))},0,!1))},ur=(Ge,vt)=>async kt=>{let fr;kt&&(kt.preventDefault&&kt.preventDefault(),kt.persist&&kt.persist());let dr=ul(l);if(C.state.next({isSubmitting:!0}),t.resolver){const{errors:ar,values:Yt}=await ve();r.errors=ar,dr=Yt}else await ke(n);if(ya(r.errors,"root"),fl(r.errors)){C.state.next({errors:{}});try{await Ge(dr,kt)}catch(ar){fr=ar}}else vt&&await vt({...r.errors},kt),Vt(),setTimeout(Vt);if(C.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:fl(r.errors)&&!fr,submitCount:r.submitCount+1,errors:r.errors}),fr)throw fr},Ot=(Ge,vt={})=>{Er(n,Ge)&&($o(vt.defaultValue)?ot(Ge,ul(Er(a,Ge))):(ot(Ge,vt.defaultValue),Ii(a,Ge,ul(vt.defaultValue))),vt.keepTouched||ya(r.touchedFields,Ge),vt.keepDirty||(ya(r.dirtyFields,Ge),r.isDirty=vt.defaultValue?je(Ge,ul(Er(a,Ge))):je()),vt.keepError||(ya(r.errors,Ge),E.isValid&&q()),C.state.next({...r}))},tr=(Ge,vt={})=>{const kt=Ge?ul(Ge):a,fr=ul(kt),dr=fl(Ge),ar=dr?a:fr;if(vt.keepDefaultValues||(a=kt),!vt.keepValues){if(vt.keepDirtyValues){const Yt=new Set([...i.mount,...Object.keys(jw(a,l))]);for(const Zr of Array.from(Yt))Er(r.dirtyFields,Zr)?Ii(ar,Zr,Er(l,Zr)):ot(Zr,Er(ar,Zr))}else{if(vU&&$o(Ge))for(const Yt of i.mount){const Zr=Er(n,Yt);if(Zr&&Zr._f){const oi=Array.isArray(Zr._f.refs)?Zr._f.refs[0]:Zr._f.ref;if(kO(oi)){const Bn=oi.closest("form");if(Bn){Bn.reset();break}}}}n={}}l=e.shouldUnregister?vt.keepDefaultValues?ul(a):{}:ul(ar),C.array.next({values:{...ar}}),C.values.next({values:{...ar}})}i={mount:vt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!E.isValid||!!vt.keepIsValid||!!vt.keepDirtyValues,h.watch=!!e.shouldUnregister,C.state.next({submitCount:vt.keepSubmitCount?r.submitCount:0,isDirty:dr?!1:vt.keepDirty?r.isDirty:!!(vt.keepDefaultValues&&!Np(Ge,a)),isSubmitted:vt.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:dr?{}:vt.keepDirtyValues?vt.keepDefaultValues&&l?jw(a,l):r.dirtyFields:vt.keepDefaultValues&&Ge?jw(a,Ge):vt.keepDirty?r.dirtyFields:{},touchedFields:vt.keepTouched?r.touchedFields:{},errors:vt.keepErrors?r.errors:{},isSubmitSuccessful:vt.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},xt=(Ge,vt)=>tr(Lh(Ge)?Ge(l):Ge,vt);return{control:{register:hr,unregister:ir,getFieldState:Bt,handleSubmit:ur,setError:nr,_executeSchema:ve,_getWatch:tt,_getDirty:je,_updateValid:q,_removeUnmounted:Ce,_updateFieldArray:H,_updateDisabledField:Ut,_getFieldArray:Ze,_reset:tr,_resetDefaultValues:()=>Lh(t.defaultValues)&&t.defaultValues().then(Ge=>{xt(Ge,t.resetOptions),C.state.next({isLoading:!1})}),_updateFormState:Ge=>{r={...r,...Ge}},_disableForm:ge,_subjects:C,_proxyFormState:E,_setErrors:Q,get _fields(){return n},get _formValues(){return l},get _state(){return h},set _state(Ge){h=Ge},get _defaultValues(){return a},get _names(){return i},set _names(Ge){i=Ge},get _formState(){return r},set _formState(Ge){r=Ge},get _options(){return t},set _options(Ge){t={...t,...Ge}}},trigger:zt,register:hr,handleSubmit:ur,watch:mr,setValue:ot,getValues:Lt,reset:xt,resetField:Ot,clearErrors:ct,unregister:ir,setError:nr,setFocus:(Ge,vt={})=>{const kt=Er(n,Ge),fr=kt&&kt._f;if(fr){const dr=fr.refs?fr.refs[0]:fr.ref;dr.focus&&(dr.focus(),vt.shouldSelect&&dr.select())}},getFieldState:Bt}}function SU(e={}){const t=Ae.useRef(),r=Ae.useRef(),[n,a]=Ae.useState({isDirty:!1,isValidating:!1,isLoading:Lh(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Lh(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...lHe(e),formState:n});const l=t.current.control;return l._options=e,xU({subject:l._subjects.state,next:h=>{yse(h,l._proxyFormState,l._updateFormState,!0)&&a({...l._formState})}}),Ae.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),Ae.useEffect(()=>{if(l._proxyFormState.isDirty){const h=l._getDirty();h!==n.isDirty&&l._subjects.state.next({isDirty:h})}},[l,n.isDirty]),Ae.useEffect(()=>{e.values&&!Np(e.values,r.current)?(l._reset(e.values,l._options.resetOptions),r.current=e.values,a(h=>({...h}))):l._resetDefaultValues()},[e.values,l]),Ae.useEffect(()=>{e.errors&&l._setErrors(e.errors)},[e.errors,l]),Ae.useEffect(()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),Ae.useEffect(()=>{e.shouldUnregister&&l._subjects.values.next({values:l._getWatch()})},[e.shouldUnregister,l]),Ae.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[n]),t.current.formState=gse(n,l),t.current}const Cse=mse,Mse=ne.createContext({}),Ds=({...e})=>j.jsx(Mse.Provider,{value:{name:e.name},children:j.jsx(Kqe,{...e})}),$R=()=>{const e=ne.useContext(Mse),t=ne.useContext(Pse),{getFieldState:r,formState:n}=KE(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...a}},Pse=ne.createContext({}),_a=ne.forwardRef(({className:e,...t},r)=>{const n=ne.useId();return j.jsx(Pse.Provider,{value:{id:n},children:j.jsx("div",{ref:r,className:Tr("space-y-2",e),...t})})});_a.displayName="FormItem";const xa=ne.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=$R();return j.jsx(MO,{ref:r,className:Tr(n&&"text-destructive",e),htmlFor:a,...t})});xa.displayName="FormLabel";const ba=ne.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:l}=$R();return j.jsx(Yh,{ref:t,id:n,"aria-describedby":r?`${a} ${l}`:`${a}`,"aria-invalid":!!r,...e})});ba.displayName="FormControl";const cHe=ne.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=$R();return j.jsx("p",{ref:r,id:n,className:Tr("text-sm text-muted-foreground",e),...t})});cHe.displayName="FormDescription";const cs=ne.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:l}=$R(),h=a?String(a==null?void 0:a.message):t;return h?j.jsx("p",{ref:n,id:l,className:Tr("text-sm font-medium text-destructive",e),...r,children:h}):null});cs.displayName="FormMessage";const PX=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Er(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},Ise=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?PX(n.ref,r,e):n.refs&&n.refs.forEach(a=>PX(a,r,e))}},uHe=(e,t)=>{t.shouldUseNativeValidation&&Ise(e,t);const r={};for(const n in e){const a=Er(t.fields,n),l=Object.assign(e[n]||{},{ref:a&&a.ref});if(dHe(t.names||Object.keys(e),n)){const h=Object.assign({},Er(r,n));Ii(h,"root",l),Ii(r,n,h)}else Ii(r,n,l)}return r},dHe=(e,t)=>e.some(r=>r.startsWith(t+"."));var hHe=function(e,t){for(var r={};e.length;){var n=e[0],a=n.code,l=n.message,h=n.path.join(".");if(!r[h])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];r[h]={message:i.message,type:i.code}}else r[h]={message:l,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(E){return E.errors.forEach(function(C){return e.push(C)})}),t){var _=r[h].types,b=_&&_[n.code];r[h]=xse(h,t,r,a,b?[].concat(b,n.message):n.message)}e.shift()}return r},Ose=function(e,t,r){return r===void 0&&(r={}),function(n,a,l){try{return Promise.resolve(function(h,i){try{var _=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(b){return l.shouldUseNativeValidation&&Ise({},l),{errors:{},values:r.raw?n:b}})}catch(b){return i(b)}return _&&_.then?_.then(void 0,i):_}(0,function(h){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(h))return{values:{},errors:uHe(hHe(h.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw h}))}catch(h){return Promise.reject(h)}}};function xi(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ic(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function js(e,t){const r=xi(e);return isNaN(t)?ic(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Uu(e,t){const r=xi(e);if(isNaN(t))return ic(e,NaN);if(!t)return r;const n=r.getDate(),a=ic(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const l=a.getDate();return n>=l?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const TU=6048e5,fHe=864e5;let pHe={};function JE(){return pHe}function Vd(e,t){var i,_,b,E;const r=JE(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((E=(b=r.locale)==null?void 0:b.options)==null?void 0:E.weekStartsOn)??0,a=xi(e),l=a.getDay(),h=(l<n?7:0)+l-n;return a.setDate(a.getDate()-h),a.setHours(0,0,0,0),a}function By(e){return Vd(e,{weekStartsOn:1})}function kse(e){const t=xi(e),r=t.getFullYear(),n=ic(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=By(n),l=ic(e,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const h=By(l);return t.getTime()>=a.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function Ox(e){const t=xi(e);return t.setHours(0,0,0,0),t}function LO(e){const t=xi(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Rd(e,t){const r=Ox(e),n=Ox(t),a=+r-LO(r),l=+n-LO(n);return Math.round((a-l)/fHe)}function mHe(e){const t=kse(e),r=ic(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),By(r)}function d4(e,t){const r=t*7;return js(e,r)}function gHe(e,t){return Uu(e,t*12)}function yHe(e){let t;return e.forEach(function(r){const n=xi(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function vHe(e){let t;return e.forEach(r=>{const n=xi(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function xl(e,t){const r=Ox(e),n=Ox(t);return+r==+n}function EU(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function _He(e){if(!EU(e)&&typeof e!="number")return!1;const t=xi(e);return!isNaN(Number(t))}function rE(e,t){const r=xi(e),n=xi(t),a=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return a*12+l}function xHe(e,t,r){const n=Vd(e,r),a=Vd(t,r),l=+n-LO(n),h=+a-LO(a);return Math.round((l-h)/TU)}function AU(e){const t=xi(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function El(e){const t=xi(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Rse(e){const t=xi(e),r=ic(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function CU(e,t){var i,_,b,E;const r=JE(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((E=(b=r.locale)==null?void 0:b.options)==null?void 0:E.weekStartsOn)??0,a=xi(e),l=a.getDay(),h=(l<n?-7:0)+6-(l-n);return a.setDate(a.getDate()+h),a.setHours(23,59,59,999),a}function Dse(e){return CU(e,{weekStartsOn:1})}const bHe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},wHe=(e,t,r)=>{let n;const a=bHe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function RN(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const SHe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},THe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},EHe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},AHe={date:RN({formats:SHe,defaultWidth:"full"}),time:RN({formats:THe,defaultWidth:"full"}),dateTime:RN({formats:EHe,defaultWidth:"full"})},CHe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},MHe=(e,t,r,n)=>CHe[e];function Bw(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):h;a=e.formattingValues[i]||e.formattingValues[h]}else{const h=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[i]||e.values[h]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const PHe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},IHe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},OHe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kHe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},RHe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},DHe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},LHe=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},NHe={ordinalNumber:LHe,era:Bw({values:PHe,defaultWidth:"wide"}),quarter:Bw({values:IHe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Bw({values:OHe,defaultWidth:"wide"}),day:Bw({values:kHe,defaultWidth:"wide"}),dayPeriod:Bw({values:RHe,defaultWidth:"wide",formattingValues:DHe,defaultFormattingWidth:"wide"})};function $w(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const h=l[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],_=Array.isArray(i)?jHe(i,C=>C.test(h)):zHe(i,C=>C.test(h));let b;b=e.valueCallback?e.valueCallback(_):_,b=r.valueCallback?r.valueCallback(b):b;const E=t.slice(h.length);return{value:b,rest:E}}}function zHe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function jHe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function FHe(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],l=t.match(e.parsePattern);if(!l)return null;let h=e.valueCallback?e.valueCallback(l[0]):l[0];h=r.valueCallback?r.valueCallback(h):h;const i=t.slice(a.length);return{value:h,rest:i}}}const BHe=/^(\d+)(th|st|nd|rd)?/i,$He=/\d+/i,UHe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},VHe={any:[/^b/i,/^(a|c)/i]},WHe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},GHe={any:[/1/i,/2/i,/3/i,/4/i]},qHe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},HHe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ZHe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},XHe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},YHe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},KHe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},JHe={ordinalNumber:FHe({matchPattern:BHe,parsePattern:$He,valueCallback:e=>parseInt(e,10)}),era:$w({matchPatterns:UHe,defaultMatchWidth:"wide",parsePatterns:VHe,defaultParseWidth:"any"}),quarter:$w({matchPatterns:WHe,defaultMatchWidth:"wide",parsePatterns:GHe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:$w({matchPatterns:qHe,defaultMatchWidth:"wide",parsePatterns:HHe,defaultParseWidth:"any"}),day:$w({matchPatterns:ZHe,defaultMatchWidth:"wide",parsePatterns:XHe,defaultParseWidth:"any"}),dayPeriod:$w({matchPatterns:YHe,defaultMatchWidth:"any",parsePatterns:KHe,defaultParseWidth:"any"})},Lse={code:"en-US",formatDistance:wHe,formatLong:AHe,formatRelative:MHe,localize:NHe,match:JHe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function QHe(e){const t=xi(e);return Rd(t,Rse(t))+1}function Nse(e){const t=xi(e),r=+By(t)-+mHe(t);return Math.round(r/TU)+1}function zse(e,t){var E,C,I,F;const r=xi(e),n=r.getFullYear(),a=JE(),l=(t==null?void 0:t.firstWeekContainsDate)??((C=(E=t==null?void 0:t.locale)==null?void 0:E.options)==null?void 0:C.firstWeekContainsDate)??a.firstWeekContainsDate??((F=(I=a.locale)==null?void 0:I.options)==null?void 0:F.firstWeekContainsDate)??1,h=ic(e,0);h.setFullYear(n+1,0,l),h.setHours(0,0,0,0);const i=Vd(h,t),_=ic(e,0);_.setFullYear(n,0,l),_.setHours(0,0,0,0);const b=Vd(_,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=b.getTime()?n:n-1}function e7e(e,t){var i,_,b,E;const r=JE(),n=(t==null?void 0:t.firstWeekContainsDate)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.firstWeekContainsDate)??r.firstWeekContainsDate??((E=(b=r.locale)==null?void 0:b.options)==null?void 0:E.firstWeekContainsDate)??1,a=zse(e,t),l=ic(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),Vd(l,t)}function jse(e,t){const r=xi(e),n=+Vd(r,t)-+e7e(r,t);return Math.round(n/TU)+1}function Li(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const gp={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Li(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Li(r+1,2)},d(e,t){return Li(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Li(e.getHours()%12||12,t.length)},H(e,t){return Li(e.getHours(),t.length)},m(e,t){return Li(e.getMinutes(),t.length)},s(e,t){return Li(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Li(a,t.length)}},M_={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},IX={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return gp.y(e,t)},Y:function(e,t,r,n){const a=zse(e,n),l=a>0?a:1-a;if(t==="YY"){const h=l%100;return Li(h,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):Li(l,t.length)},R:function(e,t){const r=kse(e);return Li(r,t.length)},u:function(e,t){const r=e.getFullYear();return Li(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Li(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Li(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return gp.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Li(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=jse(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Li(a,t.length)},I:function(e,t,r){const n=Nse(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Li(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):gp.d(e,t)},D:function(e,t,r){const n=QHe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Li(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return Li(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return Li(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Li(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=M_.noon:n===0?a=M_.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=M_.evening:n>=12?a=M_.afternoon:n>=4?a=M_.morning:a=M_.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return gp.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):gp.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Li(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Li(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):gp.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):gp.s(e,t)},S:function(e,t){return gp.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return kX(n);case"XXXX":case"XX":return Wg(n);case"XXXXX":case"XXX":default:return Wg(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return kX(n);case"xxxx":case"xx":return Wg(n);case"xxxxx":case"xxx":default:return Wg(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+OX(n,":");case"OOOO":default:return"GMT"+Wg(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+OX(n,":");case"zzzz":default:return"GMT"+Wg(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Li(n,t.length)},T:function(e,t,r){const n=e.getTime();return Li(n,t.length)}};function OX(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?r+String(a):r+String(a)+t+Li(l,2)}function kX(e,t){return e%60===0?(e>0?"-":"+")+Li(Math.abs(e)/60,2):Wg(e,t)}function Wg(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Li(Math.trunc(n/60),2),l=Li(n%60,2);return r+a+t+l}const RX=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Fse=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},t7e=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return RX(e,t);let l;switch(n){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",RX(n,t)).replace("{{time}}",Fse(a,t))},r7e={p:Fse,P:t7e},n7e=/^D+$/,i7e=/^Y+$/,o7e=["D","DD","YY","YYYY"];function a7e(e){return n7e.test(e)}function s7e(e){return i7e.test(e)}function l7e(e,t,r){const n=c7e(e,t,r);if(console.warn(n),o7e.includes(e))throw new RangeError(n)}function c7e(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const u7e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d7e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,h7e=/^'([^]*?)'?$/,f7e=/''/g,p7e=/[a-zA-Z]/;function pf(e,t,r){var E,C,I,F,$,B,q,G;const n=JE(),a=(r==null?void 0:r.locale)??n.locale??Lse,l=(r==null?void 0:r.firstWeekContainsDate)??((C=(E=r==null?void 0:r.locale)==null?void 0:E.options)==null?void 0:C.firstWeekContainsDate)??n.firstWeekContainsDate??((F=(I=n.locale)==null?void 0:I.options)==null?void 0:F.firstWeekContainsDate)??1,h=(r==null?void 0:r.weekStartsOn)??((B=($=r==null?void 0:r.locale)==null?void 0:$.options)==null?void 0:B.weekStartsOn)??n.weekStartsOn??((G=(q=n.locale)==null?void 0:q.options)==null?void 0:G.weekStartsOn)??0,i=xi(e);if(!_He(i))throw new RangeError("Invalid time value");let _=t.match(d7e).map(H=>{const J=H[0];if(J==="p"||J==="P"){const Q=r7e[J];return Q(H,a.formatLong)}return H}).join("").match(u7e).map(H=>{if(H==="''")return{isToken:!1,value:"'"};const J=H[0];if(J==="'")return{isToken:!1,value:m7e(H)};if(IX[J])return{isToken:!0,value:H};if(J.match(p7e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+J+"`");return{isToken:!1,value:H}});a.localize.preprocessor&&(_=a.localize.preprocessor(i,_));const b={firstWeekContainsDate:l,weekStartsOn:h,locale:a};return _.map(H=>{if(!H.isToken)return H.value;const J=H.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&s7e(J)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&a7e(J))&&l7e(J,t,String(e));const Q=IX[J[0]];return Q(i,J,a.localize,b)}).join("")}function m7e(e){const t=e.match(h7e);return t?t[1].replace(f7e,"'"):e}function g7e(e){const t=xi(e),r=t.getFullYear(),n=t.getMonth(),a=ic(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function y7e(e){return Math.trunc(+xi(e)/1e3)}function v7e(e){const t=xi(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function _7e(e,t){return xHe(v7e(e),El(e),t)+1}function h4(e,t){const r=xi(e),n=xi(t);return r.getTime()>n.getTime()}function Bse(e,t){const r=xi(e),n=xi(t);return+r<+n}function MU(e,t){const r=xi(e),n=xi(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function x7e(e,t){const r=xi(e),n=xi(t);return r.getFullYear()===n.getFullYear()}function DN(e,t){return js(e,-t)}function LN(e,t){const r=xi(e),n=r.getFullYear(),a=r.getDate(),l=ic(e,0);l.setFullYear(n,t,15),l.setHours(0,0,0,0);const h=g7e(l);return r.setMonth(t,Math.min(a,h)),r}function DX(e,t){const r=xi(e);return isNaN(+r)?ic(e,NaN):(r.setFullYear(t),r)}var mi;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const l={};for(const h of a)l[h]=h;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),h={};for(const i of l)h[i]=a[i];return e.objectValues(h)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const h in a)Object.prototype.hasOwnProperty.call(a,h)&&l.push(h);return l},e.find=(a,l)=>{for(const h of a)if(l(h))return h},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,l=" | "){return a.map(h=>typeof h=="string"?`'${h}'`:h).join(l)}e.joinValues=n,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(mi||(mi={}));var f4;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(f4||(f4={}));const jr=mi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),zp=e=>{switch(typeof e){case"undefined":return jr.undefined;case"string":return jr.string;case"number":return isNaN(e)?jr.nan:jr.number;case"boolean":return jr.boolean;case"function":return jr.function;case"bigint":return jr.bigint;case"symbol":return jr.symbol;case"object":return Array.isArray(e)?jr.array:e===null?jr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?jr.promise:typeof Map<"u"&&e instanceof Map?jr.map:typeof Set<"u"&&e instanceof Set?jr.set:typeof Date<"u"&&e instanceof Date?jr.date:jr.object;default:return jr.unknown}},yr=mi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),b7e=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ec extends Error{constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const r=t||function(l){return l.message},n={_errors:[]},a=l=>{for(const h of l.issues)if(h.code==="invalid_union")h.unionErrors.map(a);else if(h.code==="invalid_return_type")a(h.returnTypeError);else if(h.code==="invalid_arguments")a(h.argumentsError);else if(h.path.length===0)n._errors.push(r(h));else{let i=n,_=0;for(;_<h.path.length;){const b=h.path[_];_===h.path.length-1?(i[b]=i[b]||{_errors:[]},i[b]._errors.push(r(h))):i[b]=i[b]||{_errors:[]},i=i[b],_++}}};return a(this),n}static assert(t){if(!(t instanceof ec))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,mi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}ec.create=e=>new ec(e);const kx=(e,t)=>{let r;switch(e.code){case yr.invalid_type:e.received===jr.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case yr.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,mi.jsonStringifyReplacer)}`;break;case yr.unrecognized_keys:r=`Unrecognized key(s) in object: ${mi.joinValues(e.keys,", ")}`;break;case yr.invalid_union:r="Invalid input";break;case yr.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${mi.joinValues(e.options)}`;break;case yr.invalid_enum_value:r=`Invalid enum value. Expected ${mi.joinValues(e.options)}, received '${e.received}'`;break;case yr.invalid_arguments:r="Invalid function arguments";break;case yr.invalid_return_type:r="Invalid function return type";break;case yr.invalid_date:r="Invalid date";break;case yr.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:mi.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case yr.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case yr.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case yr.custom:r="Invalid input";break;case yr.invalid_intersection_types:r="Intersection results could not be merged";break;case yr.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case yr.not_finite:r="Number must be finite";break;default:r=t.defaultError,mi.assertNever(e)}return{message:r}};let $se=kx;function w7e(e){$se=e}function NO(){return $se}const zO=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,l=[...r,...a.path||[]],h={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let i="";const _=n.filter(b=>!!b).slice().reverse();for(const b of _)i=b(h,{data:t,defaultError:i}).message;return{...a,path:l,message:i}},S7e=[];function Rr(e,t){const r=NO(),n=zO({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===kx?void 0:kx].filter(a=>!!a)});e.common.issues.push(n)}class gs{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return An;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const l=await a.key,h=await a.value;n.push({key:l,value:h})}return gs.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:l,value:h}=a;if(l.status==="aborted"||h.status==="aborted")return An;l.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof h.value<"u"||a.alwaysSet)&&(n[l.value]=h.value)}return{status:t.value,value:n}}}const An=Object.freeze({status:"aborted"}),f0=e=>({status:"dirty",value:e}),Vs=e=>({status:"valid",value:e}),p4=e=>e.status==="aborted",m4=e=>e.status==="dirty",nE=e=>e.status==="valid",iE=e=>typeof Promise<"u"&&e instanceof Promise;function jO(e,t,r,n){if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Use(e,t,r,n,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var rn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(rn||(rn={}));var Jw,Qw;class Wd{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const LX=(e,t)=>{if(nE(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new ec(e.common.issues);return this._error=r,this._error}}};function Nn(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(h,i)=>{var _,b;const{message:E}=e;return h.code==="invalid_enum_value"?{message:E??i.defaultError}:typeof i.data>"u"?{message:(_=E??n)!==null&&_!==void 0?_:i.defaultError}:h.code!=="invalid_type"?{message:i.defaultError}:{message:(b=E??r)!==null&&b!==void 0?b:i.defaultError}},description:a}}class Gn{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return zp(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:zp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new gs,ctx:{common:t.parent.common,data:t.data,parsedType:zp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(iE(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:zp(t)},l=this._parseSync({data:t,path:a.path,parent:a});return LX(a,l)}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:zp(t)},a=this._parse({data:t,path:n.path,parent:n}),l=await(iE(a)?a:Promise.resolve(a));return LX(n,l)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,l)=>{const h=t(a),i=()=>l.addIssue({code:yr.custom,...n(a)});return typeof Promise<"u"&&h instanceof Promise?h.then(_=>_?!0:(i(),!1)):h?!0:(i(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Vu({schema:this,typeName:yn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return Fd.create(this,this._def)}nullable(){return Em.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ru.create(this,this._def)}promise(){return Dx.create(this,this._def)}or(t){return lE.create([this,t],this._def)}and(t){return cE.create(this,t,this._def)}transform(t){return new Vu({...Nn(this._def),schema:this,typeName:yn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new pE({...Nn(this._def),innerType:this,defaultValue:r,typeName:yn.ZodDefault})}brand(){return new PU({typeName:yn.ZodBranded,type:this,...Nn(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new mE({...Nn(this._def),innerType:this,catchValue:r,typeName:yn.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return QE.create(this,t)}readonly(){return gE.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const T7e=/^c[^\s-]{8,}$/i,E7e=/^[0-9a-z]+$/,A7e=/^[0-9A-HJKMNP-TV-Z]{26}$/,C7e=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,M7e=/^[a-z0-9_-]{21}$/i,P7e=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,I7e=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,O7e="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let NN;const k7e=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,R7e=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,D7e=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Vse="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",L7e=new RegExp(`^${Vse}$`);function Wse(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function N7e(e){return new RegExp(`^${Wse(e)}$`)}function Gse(e){let t=`${Vse}T${Wse(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function z7e(e,t){return!!((t==="v4"||!t)&&k7e.test(e)||(t==="v6"||!t)&&R7e.test(e))}class Pu extends Gn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==jr.string){const l=this._getOrReturnCtx(t);return Rr(l,{code:yr.invalid_type,expected:jr.string,received:l.parsedType}),An}const n=new gs;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="length"){const h=t.data.length>l.value,i=t.data.length<l.value;(h||i)&&(a=this._getOrReturnCtx(t,a),h?Rr(a,{code:yr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):i&&Rr(a,{code:yr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),n.dirty())}else if(l.kind==="email")I7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"email",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="emoji")NN||(NN=new RegExp(O7e,"u")),NN.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"emoji",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="uuid")C7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"uuid",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="nanoid")M7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"nanoid",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid")T7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"cuid",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid2")E7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"cuid2",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="ulid")A7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"ulid",code:yr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Rr(a,{validation:"url",code:yr.invalid_string,message:l.message}),n.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"regex",code:yr.invalid_string,message:l.message}),n.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),n.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.invalid_string,validation:{startsWith:l.value},message:l.message}),n.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.invalid_string,validation:{endsWith:l.value},message:l.message}),n.dirty()):l.kind==="datetime"?Gse(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.invalid_string,validation:"datetime",message:l.message}),n.dirty()):l.kind==="date"?L7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.invalid_string,validation:"date",message:l.message}),n.dirty()):l.kind==="time"?N7e(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.invalid_string,validation:"time",message:l.message}),n.dirty()):l.kind==="duration"?P7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"duration",code:yr.invalid_string,message:l.message}),n.dirty()):l.kind==="ip"?z7e(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"ip",code:yr.invalid_string,message:l.message}),n.dirty()):l.kind==="base64"?D7e.test(t.data)||(a=this._getOrReturnCtx(t,a),Rr(a,{validation:"base64",code:yr.invalid_string,message:l.message}),n.dirty()):mi.assertNever(l);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:yr.invalid_string,...rn.errToObj(n)})}_addCheck(t){return new Pu({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...rn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...rn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...rn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...rn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...rn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...rn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...rn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...rn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...rn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...rn.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...rn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...rn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...rn.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...rn.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...rn.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...rn.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...rn.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...rn.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...rn.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...rn.errToObj(r)})}nonempty(t){return this.min(1,rn.errToObj(t))}trim(){return new Pu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Pu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Pu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Pu.create=e=>{var t;return new Pu({checks:[],typeName:yn.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Nn(e)})};function j7e(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,l=parseInt(e.toFixed(a).replace(".","")),h=parseInt(t.toFixed(a).replace(".",""));return l%h/Math.pow(10,a)}class wm extends Gn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==jr.number){const l=this._getOrReturnCtx(t);return Rr(l,{code:yr.invalid_type,expected:jr.number,received:l.parsedType}),An}let n;const a=new gs;for(const l of this._def.checks)l.kind==="int"?mi.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?j7e(t.data,l.value)!==0&&(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.not_finite,message:l.message}),a.dirty()):mi.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,rn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,rn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,rn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,rn.toString(r))}setLimit(t,r,n,a){return new wm({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:rn.toString(a)}]})}_addCheck(t){return new wm({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:rn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:rn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:rn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:rn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:rn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:rn.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:rn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:rn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:rn.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&mi.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}wm.create=e=>new wm({checks:[],typeName:yn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Nn(e)});class Sm extends Gn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==jr.bigint){const l=this._getOrReturnCtx(t);return Rr(l,{code:yr.invalid_type,expected:jr.bigint,received:l.parsedType}),An}let n;const a=new gs;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),Rr(n,{code:yr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):mi.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,rn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,rn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,rn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,rn.toString(r))}setLimit(t,r,n,a){return new Sm({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:rn.toString(a)}]})}_addCheck(t){return new Sm({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:rn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:rn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:rn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:rn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:rn.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Sm.create=e=>{var t;return new Sm({checks:[],typeName:yn.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Nn(e)})};class oE extends Gn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==jr.boolean){const n=this._getOrReturnCtx(t);return Rr(n,{code:yr.invalid_type,expected:jr.boolean,received:n.parsedType}),An}return Vs(t.data)}}oE.create=e=>new oE({typeName:yn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Nn(e)});class $y extends Gn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==jr.date){const l=this._getOrReturnCtx(t);return Rr(l,{code:yr.invalid_type,expected:jr.date,received:l.parsedType}),An}if(isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Rr(l,{code:yr.invalid_date}),An}const n=new gs;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),n.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),Rr(a,{code:yr.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),n.dirty()):mi.assertNever(l);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new $y({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:rn.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:rn.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}$y.create=e=>new $y({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:yn.ZodDate,...Nn(e)});class FO extends Gn{_parse(t){if(this._getType(t)!==jr.symbol){const n=this._getOrReturnCtx(t);return Rr(n,{code:yr.invalid_type,expected:jr.symbol,received:n.parsedType}),An}return Vs(t.data)}}FO.create=e=>new FO({typeName:yn.ZodSymbol,...Nn(e)});class aE extends Gn{_parse(t){if(this._getType(t)!==jr.undefined){const n=this._getOrReturnCtx(t);return Rr(n,{code:yr.invalid_type,expected:jr.undefined,received:n.parsedType}),An}return Vs(t.data)}}aE.create=e=>new aE({typeName:yn.ZodUndefined,...Nn(e)});class sE extends Gn{_parse(t){if(this._getType(t)!==jr.null){const n=this._getOrReturnCtx(t);return Rr(n,{code:yr.invalid_type,expected:jr.null,received:n.parsedType}),An}return Vs(t.data)}}sE.create=e=>new sE({typeName:yn.ZodNull,...Nn(e)});class Rx extends Gn{constructor(){super(...arguments),this._any=!0}_parse(t){return Vs(t.data)}}Rx.create=e=>new Rx({typeName:yn.ZodAny,...Nn(e)});class wy extends Gn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Vs(t.data)}}wy.create=e=>new wy({typeName:yn.ZodUnknown,...Nn(e)});class af extends Gn{_parse(t){const r=this._getOrReturnCtx(t);return Rr(r,{code:yr.invalid_type,expected:jr.never,received:r.parsedType}),An}}af.create=e=>new af({typeName:yn.ZodNever,...Nn(e)});class BO extends Gn{_parse(t){if(this._getType(t)!==jr.undefined){const n=this._getOrReturnCtx(t);return Rr(n,{code:yr.invalid_type,expected:jr.void,received:n.parsedType}),An}return Vs(t.data)}}BO.create=e=>new BO({typeName:yn.ZodVoid,...Nn(e)});class Ru extends Gn{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==jr.array)return Rr(r,{code:yr.invalid_type,expected:jr.array,received:r.parsedType}),An;if(a.exactLength!==null){const h=r.data.length>a.exactLength.value,i=r.data.length<a.exactLength.value;(h||i)&&(Rr(r,{code:h?yr.too_big:yr.too_small,minimum:i?a.exactLength.value:void 0,maximum:h?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Rr(r,{code:yr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Rr(r,{code:yr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((h,i)=>a.type._parseAsync(new Wd(r,h,r.path,i)))).then(h=>gs.mergeArray(n,h));const l=[...r.data].map((h,i)=>a.type._parseSync(new Wd(r,h,r.path,i)));return gs.mergeArray(n,l)}get element(){return this._def.type}min(t,r){return new Ru({...this._def,minLength:{value:t,message:rn.toString(r)}})}max(t,r){return new Ru({...this._def,maxLength:{value:t,message:rn.toString(r)}})}length(t,r){return new Ru({...this._def,exactLength:{value:t,message:rn.toString(r)}})}nonempty(t){return this.min(1,t)}}Ru.create=(e,t)=>new Ru({type:e,minLength:null,maxLength:null,exactLength:null,typeName:yn.ZodArray,...Nn(t)});function R_(e){if(e instanceof Mo){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Fd.create(R_(n))}return new Mo({...e._def,shape:()=>t})}else return e instanceof Ru?new Ru({...e._def,type:R_(e.element)}):e instanceof Fd?Fd.create(R_(e.unwrap())):e instanceof Em?Em.create(R_(e.unwrap())):e instanceof Gd?Gd.create(e.items.map(t=>R_(t))):e}class Mo extends Gn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=mi.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==jr.object){const b=this._getOrReturnCtx(t);return Rr(b,{code:yr.invalid_type,expected:jr.object,received:b.parsedType}),An}const{status:n,ctx:a}=this._processInputParams(t),{shape:l,keys:h}=this._getCached(),i=[];if(!(this._def.catchall instanceof af&&this._def.unknownKeys==="strip"))for(const b in a.data)h.includes(b)||i.push(b);const _=[];for(const b of h){const E=l[b],C=a.data[b];_.push({key:{status:"valid",value:b},value:E._parse(new Wd(a,C,a.path,b)),alwaysSet:b in a.data})}if(this._def.catchall instanceof af){const b=this._def.unknownKeys;if(b==="passthrough")for(const E of i)_.push({key:{status:"valid",value:E},value:{status:"valid",value:a.data[E]}});else if(b==="strict")i.length>0&&(Rr(a,{code:yr.unrecognized_keys,keys:i}),n.dirty());else if(b!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const b=this._def.catchall;for(const E of i){const C=a.data[E];_.push({key:{status:"valid",value:E},value:b._parse(new Wd(a,C,a.path,E)),alwaysSet:E in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const b=[];for(const E of _){const C=await E.key,I=await E.value;b.push({key:C,value:I,alwaysSet:E.alwaysSet})}return b}).then(b=>gs.mergeObjectSync(n,b)):gs.mergeObjectSync(n,_)}get shape(){return this._def.shape()}strict(t){return rn.errToObj,new Mo({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,l,h,i;const _=(h=(l=(a=this._def).errorMap)===null||l===void 0?void 0:l.call(a,r,n).message)!==null&&h!==void 0?h:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=rn.errToObj(t).message)!==null&&i!==void 0?i:_}:{message:_}}}:{}})}strip(){return new Mo({...this._def,unknownKeys:"strip"})}passthrough(){return new Mo({...this._def,unknownKeys:"passthrough"})}extend(t){return new Mo({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Mo({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:yn.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Mo({...this._def,catchall:t})}pick(t){const r={};return mi.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Mo({...this._def,shape:()=>r})}omit(t){const r={};return mi.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Mo({...this._def,shape:()=>r})}deepPartial(){return R_(this)}partial(t){const r={};return mi.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new Mo({...this._def,shape:()=>r})}required(t){const r={};return mi.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let l=this.shape[n];for(;l instanceof Fd;)l=l._def.innerType;r[n]=l}}),new Mo({...this._def,shape:()=>r})}keyof(){return qse(mi.objectKeys(this.shape))}}Mo.create=(e,t)=>new Mo({shape:()=>e,unknownKeys:"strip",catchall:af.create(),typeName:yn.ZodObject,...Nn(t)});Mo.strictCreate=(e,t)=>new Mo({shape:()=>e,unknownKeys:"strict",catchall:af.create(),typeName:yn.ZodObject,...Nn(t)});Mo.lazycreate=(e,t)=>new Mo({shape:e,unknownKeys:"strip",catchall:af.create(),typeName:yn.ZodObject,...Nn(t)});class lE extends Gn{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(l){for(const i of l)if(i.result.status==="valid")return i.result;for(const i of l)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const h=l.map(i=>new ec(i.ctx.common.issues));return Rr(r,{code:yr.invalid_union,unionErrors:h}),An}if(r.common.async)return Promise.all(n.map(async l=>{const h={...r,common:{...r.common,issues:[]},parent:null};return{result:await l._parseAsync({data:r.data,path:r.path,parent:h}),ctx:h}})).then(a);{let l;const h=[];for(const _ of n){const b={...r,common:{...r.common,issues:[]},parent:null},E=_._parseSync({data:r.data,path:r.path,parent:b});if(E.status==="valid")return E;E.status==="dirty"&&!l&&(l={result:E,ctx:b}),b.common.issues.length&&h.push(b.common.issues)}if(l)return r.common.issues.push(...l.ctx.common.issues),l.result;const i=h.map(_=>new ec(_));return Rr(r,{code:yr.invalid_union,unionErrors:i}),An}}get options(){return this._def.options}}lE.create=(e,t)=>new lE({options:e,typeName:yn.ZodUnion,...Nn(t)});const _h=e=>e instanceof dE?_h(e.schema):e instanceof Vu?_h(e.innerType()):e instanceof hE?[e.value]:e instanceof Tm?e.options:e instanceof fE?mi.objectValues(e.enum):e instanceof pE?_h(e._def.innerType):e instanceof aE?[void 0]:e instanceof sE?[null]:e instanceof Fd?[void 0,..._h(e.unwrap())]:e instanceof Em?[null,..._h(e.unwrap())]:e instanceof PU||e instanceof gE?_h(e.unwrap()):e instanceof mE?_h(e._def.innerType):[];class UR extends Gn{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==jr.object)return Rr(r,{code:yr.invalid_type,expected:jr.object,received:r.parsedType}),An;const n=this.discriminator,a=r.data[n],l=this.optionsMap.get(a);return l?r.common.async?l._parseAsync({data:r.data,path:r.path,parent:r}):l._parseSync({data:r.data,path:r.path,parent:r}):(Rr(r,{code:yr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),An)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const l of r){const h=_h(l.shape[t]);if(!h.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of h){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,l)}}return new UR({typeName:yn.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...Nn(n)})}}function g4(e,t){const r=zp(e),n=zp(t);if(e===t)return{valid:!0,data:e};if(r===jr.object&&n===jr.object){const a=mi.objectKeys(t),l=mi.objectKeys(e).filter(i=>a.indexOf(i)!==-1),h={...e,...t};for(const i of l){const _=g4(e[i],t[i]);if(!_.valid)return{valid:!1};h[i]=_.data}return{valid:!0,data:h}}else if(r===jr.array&&n===jr.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const h=e[l],i=t[l],_=g4(h,i);if(!_.valid)return{valid:!1};a.push(_.data)}return{valid:!0,data:a}}else return r===jr.date&&n===jr.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class cE extends Gn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(l,h)=>{if(p4(l)||p4(h))return An;const i=g4(l.value,h.value);return i.valid?((m4(l)||m4(h))&&r.dirty(),{status:r.value,value:i.data}):(Rr(n,{code:yr.invalid_intersection_types}),An)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([l,h])=>a(l,h)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}cE.create=(e,t,r)=>new cE({left:e,right:t,typeName:yn.ZodIntersection,...Nn(r)});class Gd extends Gn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==jr.array)return Rr(n,{code:yr.invalid_type,expected:jr.array,received:n.parsedType}),An;if(n.data.length<this._def.items.length)return Rr(n,{code:yr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),An;!this._def.rest&&n.data.length>this._def.items.length&&(Rr(n,{code:yr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const l=[...n.data].map((h,i)=>{const _=this._def.items[i]||this._def.rest;return _?_._parse(new Wd(n,h,n.path,i)):null}).filter(h=>!!h);return n.common.async?Promise.all(l).then(h=>gs.mergeArray(r,h)):gs.mergeArray(r,l)}get items(){return this._def.items}rest(t){return new Gd({...this._def,rest:t})}}Gd.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Gd({items:e,typeName:yn.ZodTuple,rest:null,...Nn(t)})};class uE extends Gn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==jr.object)return Rr(n,{code:yr.invalid_type,expected:jr.object,received:n.parsedType}),An;const a=[],l=this._def.keyType,h=this._def.valueType;for(const i in n.data)a.push({key:l._parse(new Wd(n,i,n.path,i)),value:h._parse(new Wd(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?gs.mergeObjectAsync(r,a):gs.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Gn?new uE({keyType:t,valueType:r,typeName:yn.ZodRecord,...Nn(n)}):new uE({keyType:Pu.create(),valueType:t,typeName:yn.ZodRecord,...Nn(r)})}}class $O extends Gn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==jr.map)return Rr(n,{code:yr.invalid_type,expected:jr.map,received:n.parsedType}),An;const a=this._def.keyType,l=this._def.valueType,h=[...n.data.entries()].map(([i,_],b)=>({key:a._parse(new Wd(n,i,n.path,[b,"key"])),value:l._parse(new Wd(n,_,n.path,[b,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const _ of h){const b=await _.key,E=await _.value;if(b.status==="aborted"||E.status==="aborted")return An;(b.status==="dirty"||E.status==="dirty")&&r.dirty(),i.set(b.value,E.value)}return{status:r.value,value:i}})}else{const i=new Map;for(const _ of h){const b=_.key,E=_.value;if(b.status==="aborted"||E.status==="aborted")return An;(b.status==="dirty"||E.status==="dirty")&&r.dirty(),i.set(b.value,E.value)}return{status:r.value,value:i}}}}$O.create=(e,t,r)=>new $O({valueType:t,keyType:e,typeName:yn.ZodMap,...Nn(r)});class Uy extends Gn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==jr.set)return Rr(n,{code:yr.invalid_type,expected:jr.set,received:n.parsedType}),An;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(Rr(n,{code:yr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(Rr(n,{code:yr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const l=this._def.valueType;function h(_){const b=new Set;for(const E of _){if(E.status==="aborted")return An;E.status==="dirty"&&r.dirty(),b.add(E.value)}return{status:r.value,value:b}}const i=[...n.data.values()].map((_,b)=>l._parse(new Wd(n,_,n.path,b)));return n.common.async?Promise.all(i).then(_=>h(_)):h(i)}min(t,r){return new Uy({...this._def,minSize:{value:t,message:rn.toString(r)}})}max(t,r){return new Uy({...this._def,maxSize:{value:t,message:rn.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Uy.create=(e,t)=>new Uy({valueType:e,minSize:null,maxSize:null,typeName:yn.ZodSet,...Nn(t)});class O0 extends Gn{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==jr.function)return Rr(r,{code:yr.invalid_type,expected:jr.function,received:r.parsedType}),An;function n(i,_){return zO({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,NO(),kx].filter(b=>!!b),issueData:{code:yr.invalid_arguments,argumentsError:_}})}function a(i,_){return zO({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,NO(),kx].filter(b=>!!b),issueData:{code:yr.invalid_return_type,returnTypeError:_}})}const l={errorMap:r.common.contextualErrorMap},h=r.data;if(this._def.returns instanceof Dx){const i=this;return Vs(async function(..._){const b=new ec([]),E=await i._def.args.parseAsync(_,l).catch(F=>{throw b.addIssue(n(_,F)),b}),C=await Reflect.apply(h,this,E);return await i._def.returns._def.type.parseAsync(C,l).catch(F=>{throw b.addIssue(a(C,F)),b})})}else{const i=this;return Vs(function(..._){const b=i._def.args.safeParse(_,l);if(!b.success)throw new ec([n(_,b.error)]);const E=Reflect.apply(h,this,b.data),C=i._def.returns.safeParse(E,l);if(!C.success)throw new ec([a(E,C.error)]);return C.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new O0({...this._def,args:Gd.create(t).rest(wy.create())})}returns(t){return new O0({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new O0({args:t||Gd.create([]).rest(wy.create()),returns:r||wy.create(),typeName:yn.ZodFunction,...Nn(n)})}}class dE extends Gn{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}dE.create=(e,t)=>new dE({getter:e,typeName:yn.ZodLazy,...Nn(t)});class hE extends Gn{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Rr(r,{received:r.data,code:yr.invalid_literal,expected:this._def.value}),An}return{status:"valid",value:t.data}}get value(){return this._def.value}}hE.create=(e,t)=>new hE({value:e,typeName:yn.ZodLiteral,...Nn(t)});function qse(e,t){return new Tm({values:e,typeName:yn.ZodEnum,...Nn(t)})}class Tm extends Gn{constructor(){super(...arguments),Jw.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return Rr(r,{expected:mi.joinValues(n),received:r.parsedType,code:yr.invalid_type}),An}if(jO(this,Jw)||Use(this,Jw,new Set(this._def.values)),!jO(this,Jw).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return Rr(r,{received:r.data,code:yr.invalid_enum_value,options:n}),An}return Vs(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Tm.create(t,{...this._def,...r})}exclude(t,r=this._def){return Tm.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Jw=new WeakMap;Tm.create=qse;class fE extends Gn{constructor(){super(...arguments),Qw.set(this,void 0)}_parse(t){const r=mi.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==jr.string&&n.parsedType!==jr.number){const a=mi.objectValues(r);return Rr(n,{expected:mi.joinValues(a),received:n.parsedType,code:yr.invalid_type}),An}if(jO(this,Qw)||Use(this,Qw,new Set(mi.getValidEnumValues(this._def.values))),!jO(this,Qw).has(t.data)){const a=mi.objectValues(r);return Rr(n,{received:n.data,code:yr.invalid_enum_value,options:a}),An}return Vs(t.data)}get enum(){return this._def.values}}Qw=new WeakMap;fE.create=(e,t)=>new fE({values:e,typeName:yn.ZodNativeEnum,...Nn(t)});class Dx extends Gn{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==jr.promise&&r.common.async===!1)return Rr(r,{code:yr.invalid_type,expected:jr.promise,received:r.parsedType}),An;const n=r.parsedType===jr.promise?r.data:Promise.resolve(r.data);return Vs(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Dx.create=(e,t)=>new Dx({type:e,typeName:yn.ZodPromise,...Nn(t)});class Vu extends Gn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===yn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:h=>{Rr(n,h),h.fatal?r.abort():r.dirty()},get path(){return n.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const h=a.transform(n.data,l);if(n.common.async)return Promise.resolve(h).then(async i=>{if(r.value==="aborted")return An;const _=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return _.status==="aborted"?An:_.status==="dirty"||r.value==="dirty"?f0(_.value):_});{if(r.value==="aborted")return An;const i=this._def.schema._parseSync({data:h,path:n.path,parent:n});return i.status==="aborted"?An:i.status==="dirty"||r.value==="dirty"?f0(i.value):i}}if(a.type==="refinement"){const h=i=>{const _=a.refinement(i,l);if(n.common.async)return Promise.resolve(_);if(_ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?An:(i.status==="dirty"&&r.dirty(),h(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?An:(i.status==="dirty"&&r.dirty(),h(i.value).then(()=>({status:r.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const h=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!nE(h))return h;const i=a.transform(h.value,l);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(h=>nE(h)?Promise.resolve(a.transform(h.value,l)).then(i=>({status:r.value,value:i})):h);mi.assertNever(a)}}Vu.create=(e,t,r)=>new Vu({schema:e,typeName:yn.ZodEffects,effect:t,...Nn(r)});Vu.createWithPreprocess=(e,t,r)=>new Vu({schema:t,effect:{type:"preprocess",transform:e},typeName:yn.ZodEffects,...Nn(r)});class Fd extends Gn{_parse(t){return this._getType(t)===jr.undefined?Vs(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Fd.create=(e,t)=>new Fd({innerType:e,typeName:yn.ZodOptional,...Nn(t)});class Em extends Gn{_parse(t){return this._getType(t)===jr.null?Vs(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Em.create=(e,t)=>new Em({innerType:e,typeName:yn.ZodNullable,...Nn(t)});class pE extends Gn{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===jr.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}pE.create=(e,t)=>new pE({innerType:e,typeName:yn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Nn(t)});class mE extends Gn{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return iE(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new ec(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ec(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}mE.create=(e,t)=>new mE({innerType:e,typeName:yn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Nn(t)});class UO extends Gn{_parse(t){if(this._getType(t)!==jr.nan){const n=this._getOrReturnCtx(t);return Rr(n,{code:yr.invalid_type,expected:jr.nan,received:n.parsedType}),An}return{status:"valid",value:t.data}}}UO.create=e=>new UO({typeName:yn.ZodNaN,...Nn(e)});const F7e=Symbol("zod_brand");class PU extends Gn{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class QE extends Gn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?An:l.status==="dirty"?(r.dirty(),f0(l.value)):this._def.out._parseAsync({data:l.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?An:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new QE({in:t,out:r,typeName:yn.ZodPipeline})}}class gE extends Gn{_parse(t){const r=this._def.innerType._parse(t),n=a=>(nE(a)&&(a.value=Object.freeze(a.value)),a);return iE(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}gE.create=(e,t)=>new gE({innerType:e,typeName:yn.ZodReadonly,...Nn(t)});function Hse(e,t={},r){return e?Rx.create().superRefine((n,a)=>{var l,h;if(!e(n)){const i=typeof t=="function"?t(n):typeof t=="string"?{message:t}:t,_=(h=(l=i.fatal)!==null&&l!==void 0?l:r)!==null&&h!==void 0?h:!0,b=typeof i=="string"?{message:i}:i;a.addIssue({code:"custom",...b,fatal:_})}}):Rx.create()}const B7e={object:Mo.lazycreate};var yn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(yn||(yn={}));const $7e=(e,t={message:`Input not instance of ${e.name}`})=>Hse(r=>r instanceof e,t),Zse=Pu.create,Xse=wm.create,U7e=UO.create,V7e=Sm.create,Yse=oE.create,W7e=$y.create,G7e=FO.create,q7e=aE.create,H7e=sE.create,Z7e=Rx.create,X7e=wy.create,Y7e=af.create,K7e=BO.create,J7e=Ru.create,Q7e=Mo.create,e9e=Mo.strictCreate,t9e=lE.create,r9e=UR.create,n9e=cE.create,i9e=Gd.create,o9e=uE.create,a9e=$O.create,s9e=Uy.create,l9e=O0.create,c9e=dE.create,u9e=hE.create,d9e=Tm.create,h9e=fE.create,f9e=Dx.create,NX=Vu.create,p9e=Fd.create,m9e=Em.create,g9e=Vu.createWithPreprocess,y9e=QE.create,v9e=()=>Zse().optional(),_9e=()=>Xse().optional(),x9e=()=>Yse().optional(),b9e={string:e=>Pu.create({...e,coerce:!0}),number:e=>wm.create({...e,coerce:!0}),boolean:e=>oE.create({...e,coerce:!0}),bigint:e=>Sm.create({...e,coerce:!0}),date:e=>$y.create({...e,coerce:!0})},w9e=An;var Fo=Object.freeze({__proto__:null,defaultErrorMap:kx,setErrorMap:w7e,getErrorMap:NO,makeIssue:zO,EMPTY_PATH:S7e,addIssueToContext:Rr,ParseStatus:gs,INVALID:An,DIRTY:f0,OK:Vs,isAborted:p4,isDirty:m4,isValid:nE,isAsync:iE,get util(){return mi},get objectUtil(){return f4},ZodParsedType:jr,getParsedType:zp,ZodType:Gn,datetimeRegex:Gse,ZodString:Pu,ZodNumber:wm,ZodBigInt:Sm,ZodBoolean:oE,ZodDate:$y,ZodSymbol:FO,ZodUndefined:aE,ZodNull:sE,ZodAny:Rx,ZodUnknown:wy,ZodNever:af,ZodVoid:BO,ZodArray:Ru,ZodObject:Mo,ZodUnion:lE,ZodDiscriminatedUnion:UR,ZodIntersection:cE,ZodTuple:Gd,ZodRecord:uE,ZodMap:$O,ZodSet:Uy,ZodFunction:O0,ZodLazy:dE,ZodLiteral:hE,ZodEnum:Tm,ZodNativeEnum:fE,ZodPromise:Dx,ZodEffects:Vu,ZodTransformer:Vu,ZodOptional:Fd,ZodNullable:Em,ZodDefault:pE,ZodCatch:mE,ZodNaN:UO,BRAND:F7e,ZodBranded:PU,ZodPipeline:QE,ZodReadonly:gE,custom:Hse,Schema:Gn,ZodSchema:Gn,late:B7e,get ZodFirstPartyTypeKind(){return yn},coerce:b9e,any:Z7e,array:J7e,bigint:V7e,boolean:Yse,date:W7e,discriminatedUnion:r9e,effect:NX,enum:d9e,function:l9e,instanceof:$7e,intersection:n9e,lazy:c9e,literal:u9e,map:a9e,nan:U7e,nativeEnum:h9e,never:Y7e,null:H7e,nullable:m9e,number:Xse,object:Q7e,oboolean:x9e,onumber:_9e,optional:p9e,ostring:v9e,pipeline:y9e,preprocess:g9e,promise:f9e,record:o9e,set:s9e,strictObject:e9e,string:Zse,symbol:G7e,transformer:NX,tuple:i9e,undefined:q7e,union:t9e,unknown:X7e,void:K7e,NEVER:w9e,ZodIssueCode:yr,quotelessJson:b7e,ZodError:ec});const S9e=Fo.object({brand:Fo.string().min(2,{message:"La marca debe tener al menos 2 caracteres"}),model:Fo.string().min(2,{message:"El modelo debe tener al menos 2 caracteres"}),year:Fo.number().min(1900,{message:"El año debe ser válido"}),plate:Fo.string().min(5,{message:"La placa debe tener al menos 5 caracteres"}),color:Fo.string().optional()});Fo.object({document_type:Fo.string(),file:Fo.instanceof(File)});const T9e=Fo.object({id:Fo.string().optional(),name:Fo.string().min(2,{message:"El nombre debe tener al menos 2 caracteres"}),lastname:Fo.string().min(2,{message:"El apellido paterno debe tener al menos 2 caracteres"}),secondLastname:Fo.string().min(2,{message:"El apellido materno debe tener al menos 2 caracteres"}),sex:Fo.enum(["masculino","femenino","otro"],{required_error:"Por favor selecciona una opción"}),birthDate:Fo.date({required_error:"La fecha de nacimiento es requerida"}),curp:Fo.string().min(18,{message:"El CURP debe tener 18 caracteres"}).max(18),rfc:Fo.string().min(10,{message:"El RFC debe tener entre 10 y 13 caracteres"}).max(13),email:Fo.string().email({message:"Email inválido"}),phone:Fo.string().min(10,{message:"El teléfono debe tener al menos 10 dígitos"}),offerSource:Fo.string().min(1,{message:"Por favor indica cómo se enteró de la oferta"}),activeTab:Fo.enum(["personal","documents","vehicles"]).default("personal")}),E9e=({defaultValues:e})=>{const[t,r]=ne.useState([]),{toast:n}=Xy(),a=SU({resolver:Ose(T9e),defaultValues:e||{name:"",lastname:"",secondLastname:"",sex:void 0,email:"",phone:"",offerSource:"",activeTab:"personal"}});ne.useEffect(()=>{e!=null&&e.id&&l()},[e==null?void 0:e.id]);const l=async()=>{if(!(e!=null&&e.id))return;const{data:b}=await Oi.from("operator_documents").select("*").eq("operator_id",e.id);b&&r(b)};return{form:a,documents:t,handleDocumentUpload:async(b,E)=>{if(!(!(e!=null&&e.id)||!b))try{const C=b.name.split(".").pop(),I=`${e.id}/${E}_${Date.now()}.${C}`,{error:F}=await Oi.storage.from("operator-documents").upload(I,b);if(F)throw F;const{data:$,error:B}=await Oi.from("operator_documents").insert({operator_id:e.id,document_type:E,file_name:b.name,file_path:I}).select().single();if(B)throw B;r([...t,$]),n({title:"Éxito",description:"Documento cargado correctamente"})}catch(C){throw console.error("Error:",C),C}},handleDocumentDelete:async(b,E)=>{try{const{error:C}=await Oi.storage.from("operator-documents").remove([E]);if(C)throw C;const{error:I}=await Oi.from("operator_documents").delete().eq("id",b);if(I)throw I;r(t.filter(F=>F.id!==b)),n({title:"Éxito",description:"Documento eliminado correctamente"})}catch(C){throw console.error("Error:",C),C}},onSubmit:async b=>{try{const E=pf(b.birthDate,"yyyy-MM-dd"),C={name:b.name,lastname:b.lastname,second_lastname:b.secondLastname,sex:b.sex,birth_date:E,curp:b.curp,rfc:b.rfc,email:b.email,phone:b.phone,offer_source:b.offerSource};let I,F=e==null?void 0:e.id;if(e!=null&&e.id){const{error:$}=await Oi.from("operators").update(C).eq("id",e.id);I=$}else{const{data:$,error:B}=await Oi.from("operators").insert(C).select().single();I=B,$&&(F=$.id,a.setValue("id",F))}if(I)throw I;n({title:"Éxito",description:e!=null&&e.id?"La información del operador ha sido actualizada.":"La información del operador ha sido guardada."}),a.watch("activeTab")==="personal"&&a.setValue("activeTab","documents")}catch(E){console.error("Error:",E),n({variant:"destructive",title:"Error",description:"Hubo un error al guardar la información."})}}}};var IU="Radio",[A9e,Kse]=lf(IU),[C9e,M9e]=A9e(IU),Jse=ne.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:l,disabled:h,value:i="on",onCheck:_,form:b,...E}=e,[C,I]=ne.useState(null),F=Ci(t,q=>I(q)),$=ne.useRef(!1),B=C?b||!!C.closest("form"):!0;return j.jsxs(C9e,{scope:r,checked:a,disabled:h,children:[j.jsx(Mn.button,{type:"button",role:"radio","aria-checked":a,"data-state":tle(a),"data-disabled":h?"":void 0,disabled:h,value:i,...E,ref:F,onClick:Kr(e.onClick,q=>{a||_==null||_(),B&&($.current=q.isPropagationStopped(),$.current||q.stopPropagation())})}),B&&j.jsx(P9e,{control:C,bubbles:!$.current,name:n,value:i,checked:a,required:l,disabled:h,form:b,style:{transform:"translateX(-100%)"}})]})});Jse.displayName=IU;var Qse="RadioIndicator",ele=ne.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...a}=e,l=M9e(Qse,r);return j.jsx(Gu,{present:n||l.checked,children:j.jsx(Mn.span,{"data-state":tle(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:t})})});ele.displayName=Qse;var P9e=e=>{const{control:t,checked:r,bubbles:n=!0,...a}=e,l=ne.useRef(null),h=V$(r),i=p5(t);return ne.useEffect(()=>{const _=l.current,b=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(b,"checked").set;if(h!==r&&C){const I=new Event("click",{bubbles:n});C.call(_,r),_.dispatchEvent(I)}},[h,r,n]),j.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function tle(e){return e?"checked":"unchecked"}var I9e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],OU="RadioGroup",[O9e,NQe]=lf(OU,[IR,Kse]),rle=IR(),nle=Kse(),[k9e,R9e]=O9e(OU),ile=ne.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:l,required:h=!1,disabled:i=!1,orientation:_,dir:b,loop:E=!0,onValueChange:C,...I}=e,F=rle(r),$=wR(b),[B,q]=Kh({prop:l,defaultProp:a,onChange:C});return j.jsx(k9e,{scope:r,name:n,required:h,disabled:i,value:B,onValueChange:q,children:j.jsx(Doe,{asChild:!0,...F,orientation:_,dir:$,loop:E,children:j.jsx(Mn.div,{role:"radiogroup","aria-required":h,"aria-orientation":_,"data-disabled":i?"":void 0,dir:$,...I,ref:t})})})});ile.displayName=OU;var ole="RadioGroupItem",ale=ne.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=e,l=R9e(ole,r),h=l.disabled||n,i=rle(r),_=nle(r),b=ne.useRef(null),E=Ci(t,b),C=l.value===a.value,I=ne.useRef(!1);return ne.useEffect(()=>{const F=B=>{I9e.includes(B.key)&&(I.current=!0)},$=()=>I.current=!1;return document.addEventListener("keydown",F),document.addEventListener("keyup",$),()=>{document.removeEventListener("keydown",F),document.removeEventListener("keyup",$)}},[]),j.jsx(Loe,{asChild:!0,...i,focusable:!h,active:C,children:j.jsx(Jse,{disabled:h,required:l.required,checked:C,..._,...a,name:l.name,ref:E,onCheck:()=>l.onValueChange(a.value),onKeyDown:Kr(F=>{F.key==="Enter"&&F.preventDefault()}),onFocus:Kr(a.onFocus,()=>{var F;I.current&&((F=b.current)==null||F.click())})})})});ale.displayName=ole;var D9e="RadioGroupIndicator",sle=ne.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,a=nle(r);return j.jsx(ele,{...a,...n,ref:t})});sle.displayName=D9e;var lle=ile,cle=ale,L9e=sle;const ule=ne.forwardRef(({className:e,...t},r)=>j.jsx(lle,{className:Tr("grid gap-2",e),...t,ref:r}));ule.displayName=lle.displayName;const gM=ne.forwardRef(({className:e,...t},r)=>j.jsx(cle,{ref:r,className:Tr("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:j.jsx(L9e,{className:"flex items-center justify-center",children:j.jsx(Dge,{className:"h-2.5 w-2.5 fill-current text-current"})})}));gM.displayName=cle.displayName;var kU="Popover",[dle,zQe]=lf(kU,[Zx]),e2=Zx(),[N9e,Bm]=dle(kU),hle=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:h=!1}=e,i=e2(t),_=ne.useRef(null),[b,E]=ne.useState(!1),[C=!1,I]=Kh({prop:n,defaultProp:a,onChange:l});return j.jsx(eee,{...i,children:j.jsx(N9e,{scope:t,contentId:jh(),triggerRef:_,open:C,onOpenChange:I,onOpenToggle:ne.useCallback(()=>I(F=>!F),[I]),hasCustomAnchor:b,onCustomAnchorAdd:ne.useCallback(()=>E(!0),[]),onCustomAnchorRemove:ne.useCallback(()=>E(!1),[]),modal:h,children:r})})};hle.displayName=kU;var fle="PopoverAnchor",z9e=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Bm(fle,r),l=e2(r),{onCustomAnchorAdd:h,onCustomAnchorRemove:i}=a;return ne.useEffect(()=>(h(),()=>i()),[h,i]),j.jsx(Sk,{...l,...n,ref:t})});z9e.displayName=fle;var ple="PopoverTrigger",mle=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Bm(ple,r),l=e2(r),h=Ci(t,a.triggerRef),i=j.jsx(Mn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":xle(a.open),...n,ref:h,onClick:Kr(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:j.jsx(Sk,{asChild:!0,...l,children:i})});mle.displayName=ple;var RU="PopoverPortal",[j9e,F9e]=dle(RU,{forceMount:void 0}),gle=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,l=Bm(RU,t);return j.jsx(j9e,{scope:t,forceMount:r,children:j.jsx(Gu,{present:r||l.open,children:j.jsx(ME,{asChild:!0,container:a,children:n})})})};gle.displayName=RU;var Lx="PopoverContent",yle=ne.forwardRef((e,t)=>{const r=F9e(Lx,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,l=Bm(Lx,e.__scopePopover);return j.jsx(Gu,{present:n||l.open,children:l.modal?j.jsx(B9e,{...a,ref:t}):j.jsx($9e,{...a,ref:t})})});yle.displayName=Lx;var B9e=ne.forwardRef((e,t)=>{const r=Bm(Lx,e.__scopePopover),n=ne.useRef(null),a=Ci(t,n),l=ne.useRef(!1);return ne.useEffect(()=>{const h=n.current;if(h)return W$(h)},[]),j.jsx(ER,{as:Yh,allowPinchZoom:!0,children:j.jsx(vle,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kr(e.onCloseAutoFocus,h=>{var i;h.preventDefault(),l.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:Kr(e.onPointerDownOutside,h=>{const i=h.detail.originalEvent,_=i.button===0&&i.ctrlKey===!0,b=i.button===2||_;l.current=b},{checkForDefaultPrevented:!1}),onFocusOutside:Kr(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),$9e=ne.forwardRef((e,t)=>{const r=Bm(Lx,e.__scopePopover),n=ne.useRef(!1),a=ne.useRef(!1);return j.jsx(vle,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=l.target;((b=r.triggerRef.current)==null?void 0:b.contains(h))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),vle=ne.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:h,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:b,onInteractOutside:E,...C}=e,I=Bm(Lx,r),F=e2(r);return U$(),j.jsx(SR,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:j.jsx(Vx,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:E,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:b,onDismiss:()=>I.onOpenChange(!1),children:j.jsx(y5,{"data-state":xle(I.open),role:"dialog",id:I.contentId,...F,...C,ref:t,style:{...C.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),_le="PopoverClose",U9e=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Bm(_le,r);return j.jsx(Mn.button,{type:"button",...n,ref:t,onClick:Kr(e.onClick,()=>a.onOpenChange(!1))})});U9e.displayName=_le;var V9e="PopoverArrow",W9e=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=e2(r);return j.jsx(v5,{...a,...n,ref:t})});W9e.displayName=V9e;function xle(e){return e?"open":"closed"}var G9e=hle,q9e=mle,H9e=gle,ble=yle;const Z9e=G9e,X9e=q9e,wle=ne.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>j.jsx(H9e,{children:j.jsx(ble,{ref:a,align:t,sideOffset:r,className:Tr("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));wle.displayName=ble.displayName;var En=function(){return En=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},En.apply(this,arguments)};function Y9e(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Sle(e,t,r){for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}function t2(e){return e.mode==="multiple"}function r2(e){return e.mode==="range"}function VR(e){return e.mode==="single"}var K9e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function J9e(e,t){return pf(e,"LLLL y",t)}function Q9e(e,t){return pf(e,"d",t)}function eZe(e,t){return pf(e,"LLLL",t)}function tZe(e){return"".concat(e)}function rZe(e,t){return pf(e,"cccccc",t)}function nZe(e,t){return pf(e,"yyyy",t)}var iZe=Object.freeze({__proto__:null,formatCaption:J9e,formatDay:Q9e,formatMonthCaption:eZe,formatWeekNumber:tZe,formatWeekdayName:rZe,formatYearCaption:nZe}),oZe=function(e,t,r){return pf(e,"do MMMM (EEEE)",r)},aZe=function(){return"Month: "},sZe=function(){return"Go to next month"},lZe=function(){return"Go to previous month"},cZe=function(e,t){return pf(e,"cccc",t)},uZe=function(e){return"Week n. ".concat(e)},dZe=function(){return"Year: "},hZe=Object.freeze({__proto__:null,labelDay:oZe,labelMonthDropdown:aZe,labelNext:sZe,labelPrevious:lZe,labelWeekNumber:uZe,labelWeekday:cZe,labelYearDropdown:dZe});function fZe(){var e="buttons",t=K9e,r=Lse,n={},a={},l=1,h={},i=new Date;return{captionLayout:e,classNames:t,formatters:iZe,labels:hZe,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:l,styles:h,today:i,mode:"default"}}function pZe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,l=e.fromDate,h=e.toDate;return n?l=El(n):t&&(l=new Date(t,0,1)),a?h=AU(a):r&&(h=new Date(r,11,31)),{fromDate:l?Ox(l):void 0,toDate:h?Ox(h):void 0}}var Tle=ne.createContext(void 0);function mZe(e){var t,r=e.initialProps,n=fZe(),a=pZe(r),l=a.fromDate,h=a.toDate,i=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;i!=="buttons"&&(!l||!h)&&(i="buttons");var _;(VR(r)||t2(r)||r2(r))&&(_=r.onSelect);var b=En(En(En({},n),r),{captionLayout:i,classNames:En(En({},n.classNames),r.classNames),components:En({},r.components),formatters:En(En({},n.formatters),r.formatters),fromDate:l,labels:En(En({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:En(En({},n.modifiers),r.modifiers),modifiersClassNames:En(En({},n.modifiersClassNames),r.modifiersClassNames),onSelect:_,styles:En(En({},n.styles),r.styles),toDate:h});return j.jsx(Tle.Provider,{value:b,children:e.children})}function oo(){var e=ne.useContext(Tle);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Ele(e){var t=oo(),r=t.locale,n=t.classNames,a=t.styles,l=t.formatters.formatCaption;return j.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:l(e.displayMonth,{locale:r})})}function gZe(e){return j.jsx("svg",En({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:j.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Ale(e){var t,r,n=e.onChange,a=e.value,l=e.children,h=e.caption,i=e.className,_=e.style,b=oo(),E=(r=(t=b.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:gZe;return j.jsxs("div",{className:i,style:_,children:[j.jsx("span",{className:b.classNames.vhidden,children:e["aria-label"]}),j.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:b.classNames.dropdown,style:b.styles.dropdown,value:a,onChange:n,children:l}),j.jsxs("div",{className:b.classNames.caption_label,style:b.styles.caption_label,"aria-hidden":"true",children:[h,j.jsx(E,{className:b.classNames.dropdown_icon,style:b.styles.dropdown_icon})]})]})}function yZe(e){var t,r=oo(),n=r.fromDate,a=r.toDate,l=r.styles,h=r.locale,i=r.formatters.formatMonthCaption,_=r.classNames,b=r.components,E=r.labels.labelMonthDropdown;if(!n)return j.jsx(j.Fragment,{});if(!a)return j.jsx(j.Fragment,{});var C=[];if(x7e(n,a))for(var I=El(n),F=n.getMonth();F<=a.getMonth();F++)C.push(LN(I,F));else for(var I=El(new Date),F=0;F<=11;F++)C.push(LN(I,F));var $=function(q){var G=Number(q.target.value),H=LN(El(e.displayMonth),G);e.onChange(H)},B=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:Ale;return j.jsx(B,{name:"months","aria-label":E(),className:_.dropdown_month,style:l.dropdown_month,onChange:$,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:h}),children:C.map(function(q){return j.jsx("option",{value:q.getMonth(),children:i(q,{locale:h})},q.getMonth())})})}function vZe(e){var t,r=e.displayMonth,n=oo(),a=n.fromDate,l=n.toDate,h=n.locale,i=n.styles,_=n.classNames,b=n.components,E=n.formatters.formatYearCaption,C=n.labels.labelYearDropdown,I=[];if(!a)return j.jsx(j.Fragment,{});if(!l)return j.jsx(j.Fragment,{});for(var F=a.getFullYear(),$=l.getFullYear(),B=F;B<=$;B++)I.push(DX(Rse(new Date),B));var q=function(H){var J=DX(El(r),Number(H.target.value));e.onChange(J)},G=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:Ale;return j.jsx(G,{name:"years","aria-label":C(),className:_.dropdown_year,style:i.dropdown_year,onChange:q,value:r.getFullYear(),caption:E(r,{locale:h}),children:I.map(function(H){return j.jsx("option",{value:H.getFullYear(),children:E(H,{locale:h})},H.getFullYear())})})}function _Ze(e,t){var r=ne.useState(e),n=r[0],a=r[1],l=t===void 0?n:t;return[l,a]}function xZe(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,l=e.toDate,h=e.fromDate,i=e.numberOfMonths,_=i===void 0?1:i;if(l&&rE(l,a)<0){var b=-1*(_-1);a=Uu(l,b)}return h&&rE(a,h)<0&&(a=h),El(a)}function bZe(){var e=oo(),t=xZe(e),r=_Ze(t,e.month),n=r[0],a=r[1],l=function(h){var i;if(!e.disableNavigation){var _=El(h);a(_),(i=e.onMonthChange)===null||i===void 0||i.call(e,_)}};return[n,l]}function wZe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=El(e),l=El(Uu(a,n)),h=rE(l,a),i=[],_=0;_<h;_++){var b=Uu(a,_);i.push(b)}return r&&(i=i.reverse()),i}function SZe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,h=n?l:1,i=El(e);if(!r)return Uu(i,h);var _=rE(r,e);if(!(_<l))return Uu(i,h)}}function TZe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,h=n?l:1,i=El(e);if(!r)return Uu(i,-h);var _=rE(i,r);if(!(_<=0))return Uu(i,-h)}}var Cle=ne.createContext(void 0);function EZe(e){var t=oo(),r=bZe(),n=r[0],a=r[1],l=wZe(n,t),h=SZe(n,t),i=TZe(n,t),_=function(C){return l.some(function(I){return MU(C,I)})},b=function(C,I){_(C)||(I&&Bse(C,I)?a(Uu(C,1+t.numberOfMonths*-1)):a(C))},E={currentMonth:n,displayMonths:l,goToMonth:a,goToDate:b,previousMonth:i,nextMonth:h,isDateDisplayed:_};return j.jsx(Cle.Provider,{value:E,children:e.children})}function n2(){var e=ne.useContext(Cle);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function zX(e){var t,r=oo(),n=r.classNames,a=r.styles,l=r.components,h=n2().goToMonth,i=function(E){h(Uu(E,e.displayIndex?-e.displayIndex:0))},_=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:Ele,b=j.jsx(_,{id:e.id,displayMonth:e.displayMonth});return j.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[j.jsx("div",{className:n.vhidden,children:b}),j.jsx(yZe,{onChange:i,displayMonth:e.displayMonth}),j.jsx(vZe,{onChange:i,displayMonth:e.displayMonth})]})}function AZe(e){return j.jsx("svg",En({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:j.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function CZe(e){return j.jsx("svg",En({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:j.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var VO=ne.forwardRef(function(e,t){var r=oo(),n=r.classNames,a=r.styles,l=[n.button_reset,n.button];e.className&&l.push(e.className);var h=l.join(" "),i=En(En({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),j.jsx("button",En({},e,{ref:t,type:"button",className:h,style:i}))});function MZe(e){var t,r,n=oo(),a=n.dir,l=n.locale,h=n.classNames,i=n.styles,_=n.labels,b=_.labelPrevious,E=_.labelNext,C=n.components;if(!e.nextMonth&&!e.previousMonth)return j.jsx(j.Fragment,{});var I=b(e.previousMonth,{locale:l}),F=[h.nav_button,h.nav_button_previous].join(" "),$=E(e.nextMonth,{locale:l}),B=[h.nav_button,h.nav_button_next].join(" "),q=(t=C==null?void 0:C.IconRight)!==null&&t!==void 0?t:CZe,G=(r=C==null?void 0:C.IconLeft)!==null&&r!==void 0?r:AZe;return j.jsxs("div",{className:h.nav,style:i.nav,children:[!e.hidePrevious&&j.jsx(VO,{name:"previous-month","aria-label":I,className:F,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?j.jsx(q,{className:h.nav_icon,style:i.nav_icon}):j.jsx(G,{className:h.nav_icon,style:i.nav_icon})}),!e.hideNext&&j.jsx(VO,{name:"next-month","aria-label":$,className:B,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?j.jsx(G,{className:h.nav_icon,style:i.nav_icon}):j.jsx(q,{className:h.nav_icon,style:i.nav_icon})})]})}function jX(e){var t=oo().numberOfMonths,r=n2(),n=r.previousMonth,a=r.nextMonth,l=r.goToMonth,h=r.displayMonths,i=h.findIndex(function($){return MU(e.displayMonth,$)}),_=i===0,b=i===h.length-1,E=t>1&&(_||!b),C=t>1&&(b||!_),I=function(){n&&l(n)},F=function(){a&&l(a)};return j.jsx(MZe,{displayMonth:e.displayMonth,hideNext:E,hidePrevious:C,nextMonth:a,previousMonth:n,onPreviousClick:I,onNextClick:F})}function PZe(e){var t,r=oo(),n=r.classNames,a=r.disableNavigation,l=r.styles,h=r.captionLayout,i=r.components,_=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:Ele,b;return a?b=j.jsx(_,{id:e.id,displayMonth:e.displayMonth}):h==="dropdown"?b=j.jsx(zX,{displayMonth:e.displayMonth,id:e.id}):h==="dropdown-buttons"?b=j.jsxs(j.Fragment,{children:[j.jsx(zX,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),j.jsx(jX,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):b=j.jsxs(j.Fragment,{children:[j.jsx(_,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),j.jsx(jX,{displayMonth:e.displayMonth,id:e.id})]}),j.jsx("div",{className:n.caption,style:l.caption,children:b})}function IZe(e){var t=oo(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?j.jsx("tfoot",{className:a,style:n.tfoot,children:j.jsx("tr",{children:j.jsx("td",{colSpan:8,children:r})})}):j.jsx(j.Fragment,{})}function OZe(e,t,r){for(var n=r?By(new Date):Vd(new Date,{locale:e,weekStartsOn:t}),a=[],l=0;l<7;l++){var h=js(n,l);a.push(h)}return a}function kZe(){var e=oo(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,l=e.weekStartsOn,h=e.ISOWeek,i=e.formatters.formatWeekdayName,_=e.labels.labelWeekday,b=OZe(a,l,h);return j.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&j.jsx("td",{style:r.head_cell,className:t.head_cell}),b.map(function(E,C){return j.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":_(E,{locale:a}),children:i(E,{locale:a})},C)})]})}function RZe(){var e,t=oo(),r=t.classNames,n=t.styles,a=t.components,l=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:kZe;return j.jsx("thead",{style:n.head,className:r.head,children:j.jsx(l,{})})}function DZe(e){var t=oo(),r=t.locale,n=t.formatters.formatDay;return j.jsx(j.Fragment,{children:n(e.date,{locale:r})})}var DU=ne.createContext(void 0);function LZe(e){if(!t2(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return j.jsx(DU.Provider,{value:t,children:e.children})}return j.jsx(NZe,{initialProps:e.initialProps,children:e.children})}function NZe(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,l=t.max,h=function(b,E,C){var I,F;(I=t.onDayClick)===null||I===void 0||I.call(t,b,E,C);var $=!!(E.selected&&a&&(n==null?void 0:n.length)===a);if(!$){var B=!!(!E.selected&&l&&(n==null?void 0:n.length)===l);if(!B){var q=n?Sle([],n):[];if(E.selected){var G=q.findIndex(function(H){return xl(b,H)});q.splice(G,1)}else q.push(b);(F=t.onSelect)===null||F===void 0||F.call(t,q,b,E,C)}}},i={disabled:[]};n&&i.disabled.push(function(b){var E=l&&n.length>l-1,C=n.some(function(I){return xl(I,b)});return!!(E&&!C)});var _={selected:n,onDayClick:h,modifiers:i};return j.jsx(DU.Provider,{value:_,children:r})}function LU(){var e=ne.useContext(DU);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function zZe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?xl(a,e)&&xl(n,e)?void 0:xl(a,e)?{from:a,to:void 0}:xl(n,e)?void 0:h4(n,e)?{from:e,to:a}:{from:n,to:e}:a?h4(e,a)?{from:a,to:e}:{from:e,to:a}:n?Bse(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var NU=ne.createContext(void 0);function jZe(e){if(!r2(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return j.jsx(NU.Provider,{value:t,children:e.children})}return j.jsx(FZe,{initialProps:e.initialProps,children:e.children})}function FZe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},l=a.from,h=a.to,i=t.min,_=t.max,b=function(F,$,B){var q,G;(q=t.onDayClick)===null||q===void 0||q.call(t,F,$,B);var H=zZe(F,n);(G=t.onSelect)===null||G===void 0||G.call(t,H,F,$,B)},E={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(E.range_start=[l],h?(E.range_end=[h],xl(l,h)||(E.range_middle=[{after:l,before:h}])):E.range_end=[l]):h&&(E.range_start=[h],E.range_end=[h]),i&&(l&&!h&&E.disabled.push({after:DN(l,i-1),before:js(l,i-1)}),l&&h&&E.disabled.push({after:l,before:js(l,i-1)}),!l&&h&&E.disabled.push({after:DN(h,i-1),before:js(h,i-1)})),_){if(l&&!h&&(E.disabled.push({before:js(l,-_+1)}),E.disabled.push({after:js(l,_-1)})),l&&h){var C=Rd(h,l)+1,I=_-C;E.disabled.push({before:DN(l,I)}),E.disabled.push({after:js(h,I)})}!l&&h&&(E.disabled.push({before:js(h,-_+1)}),E.disabled.push({after:js(h,_-1)}))}return j.jsx(NU.Provider,{value:{selected:n,onDayClick:b,modifiers:E},children:r})}function zU(){var e=ne.useContext(NU);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function yM(e){return Array.isArray(e)?Sle([],e):e!==void 0?[e]:[]}function BZe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=yM(a)}),t}var Wu;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Wu||(Wu={}));var $Ze=Wu.Selected,yh=Wu.Disabled,UZe=Wu.Hidden,VZe=Wu.Today,zN=Wu.RangeEnd,jN=Wu.RangeMiddle,FN=Wu.RangeStart,WZe=Wu.Outside;function GZe(e,t,r){var n,a=(n={},n[$Ze]=yM(e.selected),n[yh]=yM(e.disabled),n[UZe]=yM(e.hidden),n[VZe]=[e.today],n[zN]=[],n[jN]=[],n[FN]=[],n[WZe]=[],n);return e.fromDate&&a[yh].push({before:e.fromDate}),e.toDate&&a[yh].push({after:e.toDate}),t2(e)?a[yh]=a[yh].concat(t.modifiers[yh]):r2(e)&&(a[yh]=a[yh].concat(r.modifiers[yh]),a[FN]=r.modifiers[FN],a[jN]=r.modifiers[jN],a[zN]=r.modifiers[zN]),a}var Mle=ne.createContext(void 0);function qZe(e){var t=oo(),r=LU(),n=zU(),a=GZe(t,r,n),l=BZe(t.modifiers),h=En(En({},a),l);return j.jsx(Mle.Provider,{value:h,children:e.children})}function Ple(){var e=ne.useContext(Mle);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function HZe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function ZZe(e){return!!(e&&typeof e=="object"&&"from"in e)}function XZe(e){return!!(e&&typeof e=="object"&&"after"in e)}function YZe(e){return!!(e&&typeof e=="object"&&"before"in e)}function KZe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function JZe(e,t){var r,n=t.from,a=t.to;if(n&&a){var l=Rd(a,n)<0;l&&(r=[a,n],n=r[0],a=r[1]);var h=Rd(e,n)>=0&&Rd(a,e)>=0;return h}return a?xl(a,e):n?xl(n,e):!1}function QZe(e){return EU(e)}function eXe(e){return Array.isArray(e)&&e.every(EU)}function tXe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(QZe(r))return xl(e,r);if(eXe(r))return r.includes(e);if(ZZe(r))return JZe(e,r);if(KZe(r))return r.dayOfWeek.includes(e.getDay());if(HZe(r)){var n=Rd(r.before,e),a=Rd(r.after,e),l=n>0,h=a<0,i=h4(r.before,r.after);return i?h&&l:l||h}return XZe(r)?Rd(e,r.after)>0:YZe(r)?Rd(r.before,e)>0:typeof r=="function"?r(e):!1})}function jU(e,t,r){var n=Object.keys(t).reduce(function(l,h){var i=t[h];return tXe(e,i)&&l.push(h),l},[]),a={};return n.forEach(function(l){return a[l]=!0}),r&&!MU(e,r)&&(a.outside=!0),a}function rXe(e,t){for(var r=El(e[0]),n=AU(e[e.length-1]),a,l,h=r;h<=n;){var i=jU(h,t),_=!i.disabled&&!i.hidden;if(!_){h=js(h,1);continue}if(i.selected)return h;i.today&&!l&&(l=h),a||(a=h),h=js(h,1)}return l||a}var nXe=365;function Ile(e,t){var r=t.moveBy,n=t.direction,a=t.context,l=t.modifiers,h=t.retry,i=h===void 0?{count:0,lastFocused:e}:h,_=a.weekStartsOn,b=a.fromDate,E=a.toDate,C=a.locale,I={day:js,week:d4,month:Uu,year:gHe,startOfWeek:function(q){return a.ISOWeek?By(q):Vd(q,{locale:C,weekStartsOn:_})},endOfWeek:function(q){return a.ISOWeek?Dse(q):CU(q,{locale:C,weekStartsOn:_})}},F=I[r](e,n==="after"?1:-1);n==="before"&&b?F=yHe([b,F]):n==="after"&&E&&(F=vHe([E,F]));var $=!0;if(l){var B=jU(F,l);$=!B.disabled&&!B.hidden}return $?F:i.count>nXe?i.lastFocused:Ile(F,{moveBy:r,direction:n,context:a,modifiers:l,retry:En(En({},i),{count:i.count+1})})}var Ole=ne.createContext(void 0);function iXe(e){var t=n2(),r=Ple(),n=ne.useState(),a=n[0],l=n[1],h=ne.useState(),i=h[0],_=h[1],b=rXe(t.displayMonths,r),E=a??(i&&t.isDateDisplayed(i))?i:b,C=function(){_(a),l(void 0)},I=function(q){l(q)},F=oo(),$=function(q,G){if(a){var H=Ile(a,{moveBy:q,direction:G,context:F,modifiers:r});xl(a,H)||(t.goToDate(H,a),I(H))}},B={focusedDay:a,focusTarget:E,blur:C,focus:I,focusDayAfter:function(){return $("day","after")},focusDayBefore:function(){return $("day","before")},focusWeekAfter:function(){return $("week","after")},focusWeekBefore:function(){return $("week","before")},focusMonthBefore:function(){return $("month","before")},focusMonthAfter:function(){return $("month","after")},focusYearBefore:function(){return $("year","before")},focusYearAfter:function(){return $("year","after")},focusStartOfWeek:function(){return $("startOfWeek","before")},focusEndOfWeek:function(){return $("endOfWeek","after")}};return j.jsx(Ole.Provider,{value:B,children:e.children})}function FU(){var e=ne.useContext(Ole);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function oXe(e,t){var r=Ple(),n=jU(e,r,t);return n}var BU=ne.createContext(void 0);function aXe(e){if(!VR(e.initialProps)){var t={selected:void 0};return j.jsx(BU.Provider,{value:t,children:e.children})}return j.jsx(sXe,{initialProps:e.initialProps,children:e.children})}function sXe(e){var t=e.initialProps,r=e.children,n=function(l,h,i){var _,b,E;if((_=t.onDayClick)===null||_===void 0||_.call(t,l,h,i),h.selected&&!t.required){(b=t.onSelect)===null||b===void 0||b.call(t,void 0,l,h,i);return}(E=t.onSelect)===null||E===void 0||E.call(t,l,l,h,i)},a={selected:t.selected,onDayClick:n};return j.jsx(BU.Provider,{value:a,children:r})}function kle(){var e=ne.useContext(BU);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function lXe(e,t){var r=oo(),n=kle(),a=LU(),l=zU(),h=FU(),i=h.focusDayAfter,_=h.focusDayBefore,b=h.focusWeekAfter,E=h.focusWeekBefore,C=h.blur,I=h.focus,F=h.focusMonthBefore,$=h.focusMonthAfter,B=h.focusYearBefore,q=h.focusYearAfter,G=h.focusStartOfWeek,H=h.focusEndOfWeek,J=function(ot){var Be,lt,zt,Lt;VR(r)?(Be=n.onDayClick)===null||Be===void 0||Be.call(n,e,t,ot):t2(r)?(lt=a.onDayClick)===null||lt===void 0||lt.call(a,e,t,ot):r2(r)?(zt=l.onDayClick)===null||zt===void 0||zt.call(l,e,t,ot):(Lt=r.onDayClick)===null||Lt===void 0||Lt.call(r,e,t,ot)},Q=function(ot){var Be;I(e),(Be=r.onDayFocus)===null||Be===void 0||Be.call(r,e,t,ot)},oe=function(ot){var Be;C(),(Be=r.onDayBlur)===null||Be===void 0||Be.call(r,e,t,ot)},de=function(ot){var Be;(Be=r.onDayMouseEnter)===null||Be===void 0||Be.call(r,e,t,ot)},ae=function(ot){var Be;(Be=r.onDayMouseLeave)===null||Be===void 0||Be.call(r,e,t,ot)},ve=function(ot){var Be;(Be=r.onDayPointerEnter)===null||Be===void 0||Be.call(r,e,t,ot)},Fe=function(ot){var Be;(Be=r.onDayPointerLeave)===null||Be===void 0||Be.call(r,e,t,ot)},ke=function(ot){var Be;(Be=r.onDayTouchCancel)===null||Be===void 0||Be.call(r,e,t,ot)},Ce=function(ot){var Be;(Be=r.onDayTouchEnd)===null||Be===void 0||Be.call(r,e,t,ot)},je=function(ot){var Be;(Be=r.onDayTouchMove)===null||Be===void 0||Be.call(r,e,t,ot)},tt=function(ot){var Be;(Be=r.onDayTouchStart)===null||Be===void 0||Be.call(r,e,t,ot)},Ze=function(ot){var Be;(Be=r.onDayKeyUp)===null||Be===void 0||Be.call(r,e,t,ot)},Qe=function(ot){var Be;switch(ot.key){case"ArrowLeft":ot.preventDefault(),ot.stopPropagation(),r.dir==="rtl"?i():_();break;case"ArrowRight":ot.preventDefault(),ot.stopPropagation(),r.dir==="rtl"?_():i();break;case"ArrowDown":ot.preventDefault(),ot.stopPropagation(),b();break;case"ArrowUp":ot.preventDefault(),ot.stopPropagation(),E();break;case"PageUp":ot.preventDefault(),ot.stopPropagation(),ot.shiftKey?B():F();break;case"PageDown":ot.preventDefault(),ot.stopPropagation(),ot.shiftKey?q():$();break;case"Home":ot.preventDefault(),ot.stopPropagation(),G();break;case"End":ot.preventDefault(),ot.stopPropagation(),H();break}(Be=r.onDayKeyDown)===null||Be===void 0||Be.call(r,e,t,ot)},st={onClick:J,onFocus:Q,onBlur:oe,onKeyDown:Qe,onKeyUp:Ze,onMouseEnter:de,onMouseLeave:ae,onPointerEnter:ve,onPointerLeave:Fe,onTouchCancel:ke,onTouchEnd:Ce,onTouchMove:je,onTouchStart:tt};return st}function cXe(){var e=oo(),t=kle(),r=LU(),n=zU(),a=VR(e)?t.selected:t2(e)?r.selected:r2(e)?n.selected:void 0;return a}function uXe(e){return Object.values(Wu).includes(e)}function dXe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(uXe(n)){var l=e.classNames["day_".concat(n)];l&&r.push(l)}}),r}function hXe(e,t){var r=En({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=En(En({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function fXe(e,t,r){var n,a,l,h=oo(),i=FU(),_=oXe(e,t),b=lXe(e,_),E=cXe(),C=!!(h.onDayClick||h.mode!=="default");ne.useEffect(function(){var de;_.outside||i.focusedDay&&C&&xl(i.focusedDay,e)&&((de=r.current)===null||de===void 0||de.focus())},[i.focusedDay,e,r,C,_.outside]);var I=dXe(h,_).join(" "),F=hXe(h,_),$=!!(_.outside&&!h.showOutsideDays||_.hidden),B=(l=(a=h.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:DZe,q=j.jsx(B,{date:e,displayMonth:t,activeModifiers:_}),G={style:F,className:I,children:q,role:"gridcell"},H=i.focusTarget&&xl(i.focusTarget,e)&&!_.outside,J=i.focusedDay&&xl(i.focusedDay,e),Q=En(En(En({},G),(n={disabled:_.disabled,role:"gridcell"},n["aria-selected"]=_.selected,n.tabIndex=J||H?0:-1,n)),b),oe={isButton:C,isHidden:$,activeModifiers:_,selectedDays:E,buttonProps:Q,divProps:G};return oe}function pXe(e){var t=ne.useRef(null),r=fXe(e.date,e.displayMonth,t);return r.isHidden?j.jsx("div",{role:"gridcell"}):r.isButton?j.jsx(VO,En({name:"day",ref:t},r.buttonProps)):j.jsx("div",En({},r.divProps))}function mXe(e){var t=e.number,r=e.dates,n=oo(),a=n.onWeekNumberClick,l=n.styles,h=n.classNames,i=n.locale,_=n.labels.labelWeekNumber,b=n.formatters.formatWeekNumber,E=b(Number(t),{locale:i});if(!a)return j.jsx("span",{className:h.weeknumber,style:l.weeknumber,children:E});var C=_(Number(t),{locale:i}),I=function(F){a(t,r,F)};return j.jsx(VO,{name:"week-number","aria-label":C,className:h.weeknumber,style:l.weeknumber,onClick:I,children:E})}function gXe(e){var t,r,n=oo(),a=n.styles,l=n.classNames,h=n.showWeekNumber,i=n.components,_=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:pXe,b=(r=i==null?void 0:i.WeekNumber)!==null&&r!==void 0?r:mXe,E;return h&&(E=j.jsx("td",{className:l.cell,style:a.cell,children:j.jsx(b,{number:e.weekNumber,dates:e.dates})})),j.jsxs("tr",{className:l.row,style:a.row,children:[E,e.dates.map(function(C){return j.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:j.jsx(_,{displayMonth:e.displayMonth,date:C})},y7e(C))})]})}function FX(e,t,r){for(var n=r!=null&&r.ISOWeek?Dse(t):CU(t,r),a=r!=null&&r.ISOWeek?By(e):Vd(e,r),l=Rd(n,a),h=[],i=0;i<=l;i++)h.push(js(a,i));var _=h.reduce(function(b,E){var C=r!=null&&r.ISOWeek?Nse(E):jse(E,r),I=b.find(function(F){return F.weekNumber===C});return I?(I.dates.push(E),b):(b.push({weekNumber:C,dates:[E]}),b)},[]);return _}function yXe(e,t){var r=FX(El(e),AU(e),t);if(t!=null&&t.useFixedWeeks){var n=_7e(e,t);if(n<6){var a=r[r.length-1],l=a.dates[a.dates.length-1],h=d4(l,6-n),i=FX(d4(l,1),h,t);r.push.apply(r,i)}}return r}function vXe(e){var t,r,n,a=oo(),l=a.locale,h=a.classNames,i=a.styles,_=a.hideHead,b=a.fixedWeeks,E=a.components,C=a.weekStartsOn,I=a.firstWeekContainsDate,F=a.ISOWeek,$=yXe(e.displayMonth,{useFixedWeeks:!!b,ISOWeek:F,locale:l,weekStartsOn:C,firstWeekContainsDate:I}),B=(t=E==null?void 0:E.Head)!==null&&t!==void 0?t:RZe,q=(r=E==null?void 0:E.Row)!==null&&r!==void 0?r:gXe,G=(n=E==null?void 0:E.Footer)!==null&&n!==void 0?n:IZe;return j.jsxs("table",{id:e.id,className:h.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!_&&j.jsx(B,{}),j.jsx("tbody",{className:h.tbody,style:i.tbody,children:$.map(function(H){return j.jsx(q,{displayMonth:e.displayMonth,dates:H.dates,weekNumber:H.weekNumber},H.weekNumber)})}),j.jsx(G,{displayMonth:e.displayMonth})]})}function _Xe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var xXe=_Xe()?ne.useLayoutEffect:ne.useEffect,BN=!1,bXe=0;function BX(){return"react-day-picker-".concat(++bXe)}function wXe(e){var t,r=e??(BN?BX():null),n=ne.useState(r),a=n[0],l=n[1];return xXe(function(){a===null&&l(BX())},[]),ne.useEffect(function(){BN===!1&&(BN=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function SXe(e){var t,r,n=oo(),a=n.dir,l=n.classNames,h=n.styles,i=n.components,_=n2().displayMonths,b=wXe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),E=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,C=[l.month],I=h.month,F=e.displayIndex===0,$=e.displayIndex===_.length-1,B=!F&&!$;a==="rtl"&&(t=[F,$],$=t[0],F=t[1]),F&&(C.push(l.caption_start),I=En(En({},I),h.caption_start)),$&&(C.push(l.caption_end),I=En(En({},I),h.caption_end)),B&&(C.push(l.caption_between),I=En(En({},I),h.caption_between));var q=(r=i==null?void 0:i.Caption)!==null&&r!==void 0?r:PZe;return j.jsxs("div",{className:C.join(" "),style:I,children:[j.jsx(q,{id:b,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),j.jsx(vXe,{id:E,"aria-labelledby":b,displayMonth:e.displayMonth})]},e.displayIndex)}function TXe(e){var t=oo(),r=t.classNames,n=t.styles;return j.jsx("div",{className:r.months,style:n.months,children:e.children})}function EXe(e){var t,r,n=e.initialProps,a=oo(),l=FU(),h=n2(),i=ne.useState(!1),_=i[0],b=i[1];ne.useEffect(function(){a.initialFocus&&l.focusTarget&&(_||(l.focus(l.focusTarget),b(!0)))},[a.initialFocus,_,l.focus,l.focusTarget,l]);var E=[a.classNames.root,a.className];a.numberOfMonths>1&&E.push(a.classNames.multiple_months),a.showWeekNumber&&E.push(a.classNames.with_weeknumber);var C=En(En({},a.styles.root),a.style),I=Object.keys(n).filter(function($){return $.startsWith("data-")}).reduce(function($,B){var q;return En(En({},$),(q={},q[B]=n[B],q))},{}),F=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:TXe;return j.jsx("div",En({className:E.join(" "),style:C,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},I,{children:j.jsx(F,{children:h.displayMonths.map(function($,B){return j.jsx(SXe,{displayIndex:B,displayMonth:$},B)})})}))}function AXe(e){var t=e.children,r=Y9e(e,["children"]);return j.jsx(mZe,{initialProps:r,children:j.jsx(EZe,{children:j.jsx(aXe,{initialProps:r,children:j.jsx(LZe,{initialProps:r,children:j.jsx(jZe,{initialProps:r,children:j.jsx(qZe,{children:j.jsx(iXe,{children:t})})})})})})})}function CXe(e){return j.jsx(AXe,En({},e,{children:j.jsx(EXe,{initialProps:e})}))}function Rle({className:e,classNames:t,showOutsideDays:r=!0,...n}){return j.jsx(CXe,{showOutsideDays:r,className:Tr("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Tr(Sj({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Tr(Sj({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>j.jsx(n5,{className:"h-4 w-4"}),IconRight:({...a})=>j.jsx(i5,{className:"h-4 w-4"})},...n})}Rle.displayName="Calendar";const MXe=()=>{const{control:e,watch:t}=KE(),r=Jy();return j.jsxs(Yd,{children:[j.jsxs(mb,{children:[j.jsx(gb,{children:"Información Personal"}),j.jsx(qE,{children:"Ingrese los datos personales del operador."})]}),j.jsxs(jm,{className:"space-y-4",children:[j.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[j.jsx(Ds,{control:e,name:"name",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Nombre"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Nombre",...n})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e,name:"lastname",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Apellido Paterno"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Apellido paterno",...n})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e,name:"secondLastname",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Apellido Materno"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Apellido materno",...n})}),j.jsx(cs,{})]})})]}),j.jsx(Ds,{control:e,name:"sex",render:({field:n})=>j.jsxs(_a,{className:"space-y-3",children:[j.jsx(xa,{children:"Sexo"}),j.jsx(ba,{children:j.jsxs(ule,{onValueChange:n.onChange,defaultValue:n.value,className:"flex flex-col space-y-1 sm:flex-row sm:space-x-4 sm:space-y-0",children:[j.jsxs(_a,{className:"flex items-center space-x-3 space-y-0",children:[j.jsx(ba,{children:j.jsx(gM,{value:"masculino"})}),j.jsx(xa,{className:"font-normal",children:"Masculino"})]}),j.jsxs(_a,{className:"flex items-center space-x-3 space-y-0",children:[j.jsx(ba,{children:j.jsx(gM,{value:"femenino"})}),j.jsx(xa,{className:"font-normal",children:"Femenino"})]}),j.jsxs(_a,{className:"flex items-center space-x-3 space-y-0",children:[j.jsx(ba,{children:j.jsx(gM,{value:"otro"})}),j.jsx(xa,{className:"font-normal",children:"Otro"})]})]})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e,name:"birthDate",render:({field:n})=>j.jsxs(_a,{className:"flex flex-col",children:[j.jsx(xa,{children:"Fecha de Nacimiento"}),j.jsxs(Z9e,{children:[j.jsx(X9e,{asChild:!0,children:j.jsx(ba,{children:j.jsxs(Yn,{variant:"outline",className:Tr("w-full pl-3 text-left font-normal",!n.value&&"text-muted-foreground"),children:[n.value?pf(n.value,"dd/MM/yyyy"):j.jsx("span",{children:"Seleccionar fecha"}),j.jsx(Ige,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),j.jsx(wle,{className:"w-auto p-0",align:"start",children:j.jsx(Rle,{mode:"single",selected:n.value,onSelect:n.onChange,disabled:a=>a>new Date||a<new Date("1900-01-01"),initialFocus:!0})})]}),j.jsx(cs,{})]})}),j.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[j.jsx(Ds,{control:e,name:"curp",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"CURP"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"CURP",...n})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e,name:"rfc",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"RFC"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"RFC",...n})}),j.jsx(cs,{})]})})]}),j.jsx(Ds,{control:e,name:"email",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Correo Electrónico"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"correo@ejemplo.com",...n})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e,name:"phone",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Teléfono Celular"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"+52 1234567890",...n})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e,name:"offerSource",render:({field:n})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"¿Cómo se enteró de nuestra oferta de trabajo?"}),j.jsxs(Eoe,{onValueChange:n.onChange,defaultValue:n.value,children:[j.jsx(ba,{children:j.jsx(q$,{children:j.jsx(Aoe,{placeholder:"Seleccionar origen"})})}),j.jsxs(H$,{children:[j.jsx(Cd,{value:"internet",children:"Internet"}),j.jsx(Cd,{value:"recomendacion",children:"Recomendación"}),j.jsx(Cd,{value:"bolsa_trabajo",children:"Bolsa de trabajo"}),j.jsx(Cd,{value:"redes_sociales",children:"Redes sociales"}),j.jsx(Cd,{value:"otro",children:"Otro"})]})]}),j.jsx(cs,{})]})})]}),j.jsxs(Mae,{className:"flex justify-end space-x-2 mt-4",children:[j.jsx(Yn,{variant:"outline",type:"button",onClick:()=>r("/admin/operators"),children:"Cancelar"}),j.jsx(Yn,{type:"submit",children:"Guardar y Continuar"})]})]})},PXe=({docType:e,isUploaded:t,doc:r,documentUrl:n,isLoading:a,onPreview:l,onDelete:h,onFileUpload:i,onError:_})=>j.jsx(Yd,{className:Tr("relative overflow-hidden transition-colors",t?"bg-green-50 border-green-200":"bg-background"),children:j.jsx(jm,{className:"p-4",children:j.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[j.jsx(TQ,{className:Tr("h-8 w-8",t?"text-green-500":"text-muted-foreground")}),j.jsx("p",{className:"font-medium text-center",children:e}),t&&r?j.jsxs("div",{className:"w-full space-y-2",children:[j.jsx("p",{className:"text-sm text-center text-muted-foreground",children:r.file_name}),j.jsxs("div",{className:"flex gap-2 justify-center",children:[j.jsxs(Yn,{variant:"outline",size:"sm",onClick:b=>{n?l(b,n,r.file_name):_()},className:"gap-2",disabled:!n,type:"button",children:[j.jsx(Nge,{className:"h-4 w-4"}),"Ver documento"]}),j.jsx(Yn,{variant:"destructive",size:"sm",onClick:()=>{h(r.id,r.file_path)},type:"button",children:"Eliminar"})]})]}):j.jsx(wi,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:b=>{var C;const E=(C=b.target.files)==null?void 0:C[0];E&&i(E,e)},disabled:a,className:"w-full"})]})})}),IXe=({open:e,onOpenChange:t,previewUrl:r,previewType:n})=>j.jsx(dae,{open:e,onOpenChange:t,children:j.jsxs(oU,{className:"max-w-4xl h-[90vh] flex flex-col p-0 overflow-hidden",children:[j.jsx(aU,{className:"p-6 pb-2",children:j.jsx(sU,{children:"Vista previa del documento"})}),j.jsx("div",{className:"flex-1 overflow-auto p-6 pt-0",children:r&&n==="pdf"?j.jsx("object",{data:r,type:"application/pdf",width:"100%",height:"100%",className:"min-h-[600px]",children:j.jsxs("p",{children:["Tu navegador no puede mostrar el PDF.",j.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:"Haz clic aquí para descargarlo"})]})}):r&&n==="image"?j.jsx("div",{className:"w-full h-full flex items-center justify-center",children:j.jsx("img",{src:r,alt:"Document preview",className:"max-w-full max-h-[calc(90vh-120px)] object-contain"})}):null})]})}),OXe=e=>{const[t,r]=ne.useState({}),[n,a]=ne.useState(null),[l,h]=ne.useState(!1),[i,_]=ne.useState("image");return Xy(),ne.useEffect(()=>{const E=async()=>{const C={};for(const I of e)try{const{data:F,error:$}=await Oi.storage.from("operator-documents").createSignedUrl(I.file_path,3600);if($){console.error("Error creating signed URL:",$);continue}F&&F.signedUrl&&(C[I.id]=F.signedUrl)}catch(F){console.error("Error getting signed URL for document:",F)}r(C)};e.length>0&&E()},[e]),{documentUrls:t,previewUrl:n,previewOpen:l,previewType:i,setPreviewOpen:h,handlePreviewDocument:(E,C,I)=>{E.preventDefault(),E.stopPropagation(),a(C);const F=I.toLowerCase().endsWith(".pdf")?"pdf":"image";_(F),h(!0)}}},kXe=({documents:e,onDocumentUpload:t,onDocumentDelete:r})=>{const[n,a]=ne.useState(!1),{toast:l}=Xy(),{documentUrls:h,previewUrl:i,previewOpen:_,previewType:b,setPreviewOpen:E,handlePreviewDocument:C}=OXe(e),I=async(q,G)=>{try{a(!0),await t(q,G)}catch(H){console.error("Error uploading document:",H),l({variant:"destructive",title:"Error",description:"Error al subir el documento"})}finally{a(!1)}},F=q=>e.some(G=>G.document_type===q),$=q=>e.find(G=>G.document_type===q),B=["INE","Licencia","Comprobante de domicilio","CURP","Carta de Antecedentes","Examen Toxicológico"];return j.jsxs(j.Fragment,{children:[j.jsxs(Yd,{children:[j.jsxs(mb,{children:[j.jsx(gb,{children:"Documentos del Operador"}),j.jsx(qE,{children:"Gestiona los documentos del operador"})]}),j.jsx(jm,{children:j.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:B.map(q=>{const G=F(q),H=$(q);return j.jsx(PXe,{docType:q,isUploaded:G,doc:H,documentUrl:H?h[H.id]:void 0,isLoading:n,onPreview:C,onDelete:r,onFileUpload:I,onError:()=>{l({variant:"destructive",title:"Error",description:"No se pudo obtener el enlace del documento. Inténtalo nuevamente."})}},q)})})})]}),j.jsx(IXe,{open:_,onOpenChange:E,previewUrl:i,previewType:b})]})},RXe=({form:e})=>j.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[j.jsx(Ds,{control:e.control,name:"brand",render:({field:t})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Marca"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Marca del vehículo",...t})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e.control,name:"model",render:({field:t})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Modelo"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Modelo del vehículo",...t})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e.control,name:"year",render:({field:t})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Año"}),j.jsx(ba,{children:j.jsx(wi,{type:"number",placeholder:"Año del vehículo",...t,onChange:r=>t.onChange(Number(r.target.value))})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e.control,name:"plate",render:({field:t})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Placa"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Número de placa",...t})}),j.jsx(cs,{})]})}),j.jsx(Ds,{control:e.control,name:"color",render:({field:t})=>j.jsxs(_a,{children:[j.jsx(xa,{children:"Color"}),j.jsx(ba,{children:j.jsx(wi,{placeholder:"Color del vehículo",...t})}),j.jsx(cs,{})]})})]}),y4={async registerVehicle(e,t){try{if(!e)throw new Error("ID del operador no proporcionado");console.log("Registrando vehículo para operador:",e),console.log("Datos del vehículo:",t);const r={operator_id:e,brand:t.brand,model:t.model,year:Number(t.year),plate:t.plate,color:t.color||null};console.log("Guardando datos del vehículo:",r);const{data:n,error:a}=await Oi.from("operator_vehicles").insert(r).select().single();if(a)throw console.error("Error al guardar vehículo:",a),a;return console.log("Vehículo registrado exitosamente:",n),n}catch(r){throw console.error("Error en registerVehicle:",r),r}},async getVehiclesByOperator(e){try{if(!e)throw new Error("ID del operador no proporcionado");const{data:t,error:r}=await Oi.from("operator_vehicles").select("*").eq("operator_id",e);if(r)throw console.error("Error al obtener vehículos:",r),r;return t||[]}catch(t){throw console.error("Error en getVehiclesByOperator:",t),t}},async deleteVehicle(e){try{if(!e)throw new Error("ID del vehículo no proporcionado");const{error:t}=await Oi.from("operator_vehicles").delete().eq("id",e);if(t)throw console.error("Error al eliminar vehículo:",t),t;return console.log("Vehículo eliminado exitosamente"),!0}catch(t){throw console.error("Error en deleteVehicle:",t),t}}},DXe=({operatorId:e,onComplete:t})=>{const{toast:r}=Xy(),[n,a]=Ae.useState(!1),l=SU({resolver:Ose(S9e),defaultValues:{brand:"",model:"",year:0,plate:"",color:""}}),h=async i=>{try{a(!0),console.log("Enviando datos del vehículo:",i),console.log("ID del operador:",e),await y4.registerVehicle(e,i),r({title:"Éxito",description:"Vehículo registrado correctamente"}),l.reset(),t()}catch(_){console.error("Error al registrar vehículo:",_),r({variant:"destructive",title:"Error",description:"No se pudo registrar el vehículo. Por favor intente nuevamente."})}finally{a(!1)}};return j.jsxs(Yd,{children:[j.jsxs(mb,{children:[j.jsx(gb,{children:"Nuevo Vehículo"}),j.jsx(qE,{children:"Ingrese los datos del vehículo"})]}),j.jsx(jm,{children:j.jsx(Cse,{...l,children:j.jsxs("form",{onSubmit:l.handleSubmit(h),className:"space-y-6",children:[j.jsx(RXe,{form:l}),j.jsxs(Yn,{type:"submit",className:"w-full",disabled:n,children:[j.jsx(bQ,{className:"mr-2 h-4 w-4"}),n?"Registrando...":"Registrar Vehículo"]})]})})})]})},LXe=({operatorId:e})=>{const[t,r]=ne.useState([]),[n,a]=ne.useState(!0),{toast:l}=Xy(),h=async()=>{try{a(!0),console.log("Cargando vehículos para operador:",e);const _=await y4.getVehiclesByOperator(e);r(_)}catch(_){console.error("Error al cargar vehículos:",_),l({variant:"destructive",title:"Error",description:"No se pudieron cargar los vehículos. Por favor intente nuevamente."})}finally{a(!1)}};ne.useEffect(()=>{e&&h()},[e]);const i=async _=>{try{await y4.deleteVehicle(_),l({title:"Éxito",description:"Vehículo eliminado correctamente"}),h()}catch(b){console.error("Error al eliminar vehículo:",b),l({variant:"destructive",title:"Error",description:"No se pudo eliminar el vehículo. Por favor intente nuevamente."})}};return j.jsxs(Yd,{children:[j.jsxs(mb,{children:[j.jsx(gb,{children:"Vehículos del Operador"}),j.jsx(qE,{children:"Lista de vehículos registrados"})]}),j.jsxs(jm,{className:"space-y-6",children:[n?j.jsx("div",{className:"text-center py-4",children:"Cargando vehículos..."}):t.length>0?j.jsx("div",{className:"space-y-4",children:t.map(_=>j.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx(bQ,{className:"h-6 w-6 text-blue-500"}),j.jsxs("div",{children:[j.jsxs("p",{className:"font-medium",children:[_.brand," ",_.model," (",_.year,")"]}),j.jsxs("p",{className:"text-sm text-muted-foreground",children:["Placa: ",_.plate]}),_.color&&j.jsxs("p",{className:"text-sm text-muted-foreground",children:["Color: ",_.color]})]})]}),j.jsx(Yn,{variant:"destructive",size:"icon",onClick:()=>i(_.id),children:j.jsx(Uge,{className:"h-4 w-4"})})]},_.id))}):j.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No hay vehículos registrados"}),j.jsx(DXe,{operatorId:e,onComplete:h})]})]})},Dle=({defaultValues:e})=>{const{form:t,documents:r,handleDocumentUpload:n,handleDocumentDelete:a,onSubmit:l}=E9e({defaultValues:e});return j.jsx(mse,{...t,children:j.jsx(Cse,{...t,children:j.jsx("form",{onSubmit:t.handleSubmit(l),className:"space-y-6",children:j.jsxs(Y$,{defaultValue:"personal",value:t.watch("activeTab"),onValueChange:h=>{(h==="personal"||h==="documents"||h==="vehicles")&&t.setValue("activeTab",h)},className:"w-full",children:[j.jsxs(OR,{className:"grid w-full grid-cols-3",children:[j.jsx(Mu,{value:"personal",children:"Datos Personales"}),j.jsx(Mu,{value:"documents",children:"Documentos"}),j.jsx(Mu,{value:"vehicles",children:"Vehículos"})]}),j.jsx(dm,{value:"personal",className:"space-y-4 mt-4",children:j.jsx(MXe,{})}),j.jsx(dm,{value:"documents",className:"space-y-4 mt-4",children:j.jsx(kXe,{operatorId:e==null?void 0:e.id,documents:r,onDocumentUpload:n,onDocumentDelete:a})}),j.jsx(dm,{value:"vehicles",className:"space-y-4 mt-4",children:(e==null?void 0:e.id)&&j.jsx(LXe,{operatorId:e.id})})]})})})})},NXe=()=>j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(vy,{to:"/admin/operators",children:j.jsx(Yn,{variant:"ghost",size:"icon",className:"mr-2",children:j.jsx(mI,{className:"h-5 w-5"})})}),j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Registro de Operador"})]})}),j.jsx(Dle,{})]}),zXe=()=>{const{id:e}=N0e(),t=Jy(),{toast:r}=Xy(),{data:n,isLoading:a,error:l}=Yy({queryKey:["operator",e],queryFn:async()=>{const{data:h,error:i}=await Oi.from("operators").select("*").eq("id",e).single();if(i)throw i;if(!h)throw new Error("Operador no encontrado");return{id:h.id,name:h.name,lastname:h.lastname,secondLastname:h.second_lastname,sex:h.sex,birthDate:new Date(h.birth_date),curp:h.curp,rfc:h.rfc,email:h.email,phone:h.phone,offerSource:h.offer_source,activeTab:"personal"}},meta:{onError:h=>{console.error("Error fetching operator:",h),r({variant:"destructive",title:"Error",description:"No se pudo cargar la información del operador"})}}});return a?j.jsx("div",{children:"Cargando..."}):l||!n?j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(vy,{to:"/admin/operators",children:j.jsx(Yn,{variant:"ghost",size:"icon",className:"mr-2",children:j.jsx(mI,{className:"h-5 w-5"})})}),j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Error"})]})}),j.jsxs("div",{className:"bg-destructive/10 p-4 rounded-md",children:[j.jsx("p",{children:"No se pudo encontrar el operador. Verifique el ID e intente nuevamente."}),j.jsx(Yn,{className:"mt-4",onClick:()=>t("/admin/operators"),children:"Volver al listado"})]})]}):j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(vy,{to:"/admin/operators",children:j.jsx(Yn,{variant:"ghost",size:"icon",className:"mr-2",children:j.jsx(mI,{className:"h-5 w-5"})})}),j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Editar Operador"})]})}),j.jsx(Dle,{defaultValues:n})]})},jXe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"TMS"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(Oge,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Sistema de Gestión de Transporte"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Visualiza el historial de entregas, gestiona nóminas automatizadas y consulta el ranking de desempeño."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),FXe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Tracking"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(u0,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Seguimiento en Tiempo Real"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Visualiza la ubicación de tus entregas en tiempo real, filtra por rutas o conductores y recibe alertas."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),BXe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Documentación"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(TQ,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Gestión de Documentos"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Administra la documentación de vehículos y conductores, consulta estado de validación y expiraciones próximas."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),$Xe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Configuración"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(Wz,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Configuración del Sistema"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Ajusta parámetros del sistema, gestiona roles y permisos, administra API Keys y personaliza tu tenant."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),UXe=()=>{const e=Ky();return ne.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),j.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:j.jsxs("div",{className:"text-center",children:[j.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),j.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),j.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Lle=ne.forwardRef(({className:e,...t},r)=>j.jsx("textarea",{className:Tr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Lle.displayName="Textarea";var VXe=Object.defineProperty,WXe=Object.defineProperties,GXe=Object.getOwnPropertyDescriptors,WO=Object.getOwnPropertySymbols,Nle=Object.prototype.hasOwnProperty,zle=Object.prototype.propertyIsEnumerable,$X=(e,t,r)=>t in e?VXe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ui=(e,t)=>{for(var r in t||(t={}))Nle.call(t,r)&&$X(e,r,t[r]);if(WO)for(var r of WO(t))zle.call(t,r)&&$X(e,r,t[r]);return e},fm=(e,t)=>WXe(e,GXe(t)),WR=(e,t)=>{var r={};for(var n in e)Nle.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&WO)for(var n of WO(e))t.indexOf(n)<0&&zle.call(e,n)&&(r[n]=e[n]);return r},$U=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},Ha=(e,t,r)=>($U(e,t,"read from private field"),r?r.call(e):t.get(e)),Zl=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},wu=(e,t,r,n)=>($U(e,t,"write to private field"),t.set(e,r),r),qXe=(e,t,r,n)=>({set _(a){wu(e,t,a)},get _(){return Ha(e,t,n)}}),Nx=(e,t,r)=>($U(e,t,"access private method"),r),bl=(e,t,r)=>new Promise((n,a)=>{var l=_=>{try{i(r.next(_))}catch(b){a(b)}},h=_=>{try{i(r.throw(_))}catch(b){a(b)}},i=_=>_.done?n(_.value):Promise.resolve(_.value).then(l,h);i((r=r.apply(e,t)).next())}),jle="https://api.mapbox.com/autofill/v1",HXe="suggest",ZXe="retrieve",XXe=`${jle}/${HXe}`,YXe=`${jle}/${ZXe}`,Vo=class{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(e){if(e instanceof Vo)return new Vo(e.lng,e.lat);if(Array.isArray(e)&&e.length===2)return new Vo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null&&("lng"in e||"lon"in e)&&"lat"in e)return new Vo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}},Kl=class{constructor(e,t){this._sw=Vo.convert(e),this._ne=Vo.convert(t)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Vo(this.getWest(),this.getNorth())}getSouthEast(){return new Vo(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(e){if(!e)throw new Error("Invalid LngLatBounds convert value: falsy");if(e instanceof Kl)return new Kl(e.getSouthWest(),e.getNorthEast());if(Array.isArray(e)&&e.length===2)return new Kl(Vo.convert(e[0]),Vo.convert(e[1]));if(Array.isArray(e)&&e.length===4)return new Kl(Vo.convert([e[0],e[1]]),Vo.convert([e[2],e[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function KXe(){const t=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[t.slice(0,8),t.slice(8,12),"4"+t.slice(12,15)+"-8"+t.slice(15,18),t.slice(18,30)].join("-")}var jc=class{constructor(e){this.id=e??KXe()}toString(){return this.id}static convert(e){return new jc(e instanceof jc?e.id:e.toString())}},JXe="Unknown error",QXe=class extends Error{constructor(e,t){super(String(e.message||e.error||JXe)),this.name="MapboxError",this.statusCode=t}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function Nh(e){return bl(this,null,function*(){if(!e.ok){const t=yield e.json();throw new QXe(t,e.status)}})}var UX=globalThis.fetch,eYe=globalThis.AbortController;function Dd(){if(!UX)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:UX,AbortController:eYe}}function Vy(...e){const t=[];for(const r of e){if(!r)continue;const n=Object.entries(r);for(const[a,l]of n)l!=null&&t.push(`${a}=${encodeURIComponent(String(l))}`)}return t.join("&")}var vM,v4,Fle,Ble=class{constructor(e={}){Zl(this,v4),Zl(this,vM,void 0);const t=e,{accessToken:r}=t,n=WR(t,["accessToken"]);this.accessToken=r,this.defaults=Ui(Ui({},Ble.defaults),n)}get responseHeaders(){return Ha(this,vM)}suggest(e,t){return bl(this,null,function*(){if(!e)throw new Error("searchText is required");const{sessionToken:r,signal:n}=t,a=fm(Ui(Ui({},this.defaults),t),{sessionToken:r}),l=new URL(`${XXe}/${encodeURIComponent(e)}`);l.search=Nx(this,v4,Fle).call(this,a);const{fetch:h}=Dd(),i=yield h(l.toString(),{signal:n});wu(this,vM,i.headers),yield Nh(i);const _=yield i.json();return fm(Ui({},_),{suggestions:_.suggestions.map(b=>fm(Ui({},b),{original_search_text:e})),url:l.toString()})})}retrieve(e,t){return bl(this,null,function*(){if(!e)throw new Error("suggestion is required");if(!this.canRetrieve(e))throw new Error("suggestion cannot be retrieved");const{sessionToken:r,signal:n}=t,a=jc.convert(r),l=new URL(`${YXe}/${e.action.id}`);l.search=Vy({access_token:this.accessToken,session_token:a.id});const{fetch:h}=Dd(),i=yield h(l.toString(),{signal:n});yield Nh(i);const _=yield i.json();return _.url=l.toString(),_})}canRetrieve(e){const t=e.action;return typeof(t==null?void 0:t.id)=="string"}},$le=Ble;vM=new WeakMap;v4=new WeakSet;Fle=function(e){return Vy({types:"address",access_token:this.accessToken,streets:e.streets,language:e.language,country:e.country,limit:e.limit},e.sessionToken&&{session_token:jc.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:Vo.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:Kl.convert(e.bbox).toFlatArray().join(",")})};$le.defaults={language:"en",proximity:"ip",streets:!0};var GR="https://api.mapbox.com/search/searchbox/v1",tYe="suggest",rYe="retrieve",nYe="category",iYe="reverse",oYe=`${GR}/${tYe}`,aYe=`${GR}/${rYe}`,sYe=`${GR}/${nYe}`,lYe=`${GR}/${iYe}`,_M,_4,Ule=class{constructor(e={}){Zl(this,_M);const t=e,{accessToken:r}=t,n=WR(t,["accessToken"]);this.accessToken=r,this.defaults=Ui(Ui({},Ule.defaults),n)}suggest(e,t){return bl(this,null,function*(){if(!e)throw new Error("searchText is required");const{sessionToken:r,signal:n}=t,a=fm(Ui(Ui({},this.defaults),t),{q:e,sessionToken:r});if(a.eta_type&&(!a.origin||!a.navigation_profile))throw new Error("to provide eta estimate: eta, navigation_profile, and origin are required");if(a.origin&&!a.navigation_profile)throw new Error("to provide distance estimate: both navigation_profile and origin are required");const l=new URL(oYe);l.search=Nx(this,_M,_4).call(this,a);const{fetch:h}=Dd(),i=yield h(l.toString(),{signal:n});yield Nh(i);const _=yield i.json();return _.url=l.toString(),_})}retrieve(e,t){return bl(this,null,function*(){if(!e)throw new Error("suggestion is required");const{sessionToken:r,signal:n,language:a}=t,l=jc.convert(r),h=Ui(Ui({},this.defaults),a&&{language:a}),i=new URL(`${aYe}/${encodeURIComponent(e.mapbox_id)}`);i.search=Vy({access_token:this.accessToken,session_token:l.id},{language:h.language});const{fetch:_}=Dd(),b=yield _(i.toString(),{signal:n});yield Nh(b);const E=yield b.json();return E.url=i.toString(),E})}category(e){return bl(this,arguments,function*(t,r={}){if(!t)throw new Error("category is required");const n=Ui(Ui({},this.defaults),r),a=new URL(`${sYe}/${encodeURIComponent(t)}`);a.search=Nx(this,_M,_4).call(this,n);const{fetch:l}=Dd(),h=yield l(a.toString(),{signal:n.signal});yield Nh(h);const i=yield h.json();return i.url=a.toString(),i})}reverse(e){return bl(this,arguments,function*(t,r={}){if(!t)throw new Error("lngLat is required");const[n,a]=typeof t=="string"?t.split(",").map(E=>parseFloat(E)):Vo.convert(t).toArray();if(isNaN(n)||isNaN(a))throw new Error("lngLat is required");const l=Ui(Ui({},this.defaults),r),h=new URL(lYe);h.search=Vy({access_token:this.accessToken,language:l.language,limit:l.limit,longitude:n,latitude:a},l.types&&{types:typeof l.types=="string"?l.types:[...l.types].join(",")});const{fetch:i}=Dd(),_=yield i(h.toString(),{signal:l.signal});yield Nh(_);const b=yield _.json();return b.url=h.toString(),b})}},Vle=Ule;_M=new WeakSet;_4=function(e){return Vy({q:e.q,access_token:this.accessToken,language:e.language,limit:e.limit,navigation_profile:e.navigation_profile,route:e.route,route_geometry:e.route_geometry,sar_type:e.sar_type,time_deviation:e.time_deviation,eta_type:e.eta_type,country:e.country,poi_category:e.poi_category,rich_metadata_provider:e.rich_metadata_provider,poi_category_exclusions:e.poi_category_exclusions},e.sessionToken&&{session_token:jc.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:Vo.convert(e.proximity).toArray().join(",")},e.origin&&{origin:typeof e.origin=="string"?e.origin:Vo.convert(e.origin).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:Kl.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};Vle.defaults={language:"en"};var cYe="https://api.mapbox.com/autofill/v1",uYe="retrieve",dYe=`${cYe}/${uYe}`,x4,Wle,Gle=class{constructor(e={}){Zl(this,x4);const t=e,{accessToken:r}=t,n=WR(t,["accessToken"]);this.accessToken=r,this.defaults=Ui(Ui({},Gle.defaults),n)}validate(e,t){return bl(this,null,function*(){if(!e)throw new Error("searchText is required");const{sessionToken:r,signal:n}=t,a=fm(Ui(Ui({},this.defaults),t),{sessionToken:r}),l=new URL(`${dYe}/${encodeURIComponent(e)}`);l.search=Nx(this,x4,Wle).call(this,a);const{fetch:h}=Dd(),i=yield h(l.toString(),{signal:n});yield Nh(i);const _=yield i.json();return _.url=l.toString(),_.features.length>0&&(_.features=[_.features[0]]),_})}},qle=Gle;x4=new WeakSet;Wle=function(e){return Vy({access_token:this.accessToken,language:e.language,country:e.country},e.sessionToken&&{session_token:jc.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:Vo.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:Kl.convert(e.bbox).toFlatArray().join(",")})};qle.defaults={language:"en",proximity:"ip"};var Hle="https://api.mapbox.com/search/geocode/v6",hYe=`${Hle}/forward`,fYe=`${Hle}/reverse`,pYe=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/,mYe=/[\s,]+/,eS,xM,b4,gYe=class{constructor(e={}){Zl(this,xM),Zl(this,eS,void 0);const t=e,{accessToken:r}=t,n=WR(t,["accessToken"]);this.accessToken=r,this.defaults=Ui({},n)}get responseHeaders(){return Ha(this,eS)}forward(e,t){return bl(this,null,function*(){if(!e)throw new Error("searchText is required");let r;t&&({signal:r}=t);const n=fm(Ui(Ui({},this.defaults),t),{q:e}),a=new URL(`${hYe}`);a.search=Nx(this,xM,b4).call(this,n);const{fetch:l}=Dd(),h=r?{signal:r}:{},i=yield l(a.toString(),h);wu(this,eS,i.headers),yield Nh(i);const _=yield i.json();return _.url=a.toString(),_})}reverse(e,t){return bl(this,null,function*(){if(!e)throw new Error("lngLat is required");let r;t&&({signal:r}=t);let n;if(typeof e=="string"){const[E,C]=e.split(",");n=new Vo(Number(E),Number(C))}else n=Vo.convert(e);const a=fm(Ui(Ui({},this.defaults),t),{longitude:n.lng,latitude:n.lat}),l=new URL(`${fYe}`);l.search=Nx(this,xM,b4).call(this,a,!0);const{fetch:h}=Dd(),i=r?{signal:r}:{},_=yield h(l.toString(),i);wu(this,eS,_.headers),yield Nh(_);const b=yield _.json();return b.url=l.toString(),b})}suggest(e,t){return bl(this,null,function*(){if(pYe.test(e)){const n=e.trim().split(mYe).map(a=>a.trim()).join(",");return this.reverse(n,t)}else return this.forward(e,t)})}retrieve(e){return bl(this,null,function*(){return e})}};eS=new WeakMap;xM=new WeakSet;b4=function(e,t=!1){return t&&["proximity","autocomplete","bbox"].forEach(r=>{r in e&&delete e[r]}),Vy({q:e.q,longitude:e.longitude,latitude:e.latitude,access_token:this.accessToken,permanent:e.permanent,language:e.language,country:e.country,limit:e.limit,autocomplete:e.autocomplete,worldview:e.worldview},e.sessionToken&&{session_token:jc.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:Vo.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:Kl.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};var Zle=(e=>(e.exact="exact",e.high="high",e.medium="medium",e.low="low",e))(Zle||{}),tS,yYe=class{constructor(){Zl(this,tS,{})}addEventListener(e,t){const r=Ha(this,tS);r[e]||(r[e]=[]),r[e].push(t)}removeEventListener(e,t){const r=Ha(this,tS);if(!r[e])return;const n=r[e],a=n.indexOf(t);a!==-1&&n.splice(a,1)}fire(e,t){const r=Ha(this,tS);if(!r[e])return;const n=r[e];for(const a of n)a(t)}};tS=new WeakMap;function Xle(e,t,r){let n=null;return(...a)=>{n!==null&&clearTimeout(n);const l=r&&r();n=setTimeout(()=>{n=null,!(l!=null&&l.aborted)&&e(...a)},t)}}function $N(){const{AbortController:e}=Dd();return new e}var rS,bM,wM,D_,wp,SM,UU=class extends yYe{constructor(e,t=0){super(),Zl(this,rS,new jc),Zl(this,bM,0),Zl(this,wM,!1),Zl(this,D_,void 0),Zl(this,wp,$N()),Zl(this,SM,void 0),wu(this,SM,Xle((r,...n)=>bl(this,[r,...n],function*(a,l={}){if(Ha(this,wp).abort(),wu(this,wp,$N()),!a){wu(this,D_,null),this.fire("suggest",Ha(this,D_));return}try{const h=yield this.search.suggest(a,fm(Ui({sessionToken:this.sessionToken},l),{signal:Ha(this,wp).signal}));wu(this,D_,h),this.fire("suggest",h)}catch(h){if(h.name==="AbortError")return;this.fire("suggesterror",h)}}),t,()=>Ha(this,wp).signal)),Object.defineProperties(this,{search:{value:e,writable:!1},debounce:{value:t,writable:!1}})}get sessionToken(){return Ha(this,wM)?Ha(this,rS).id:`${Ha(this,rS).id}.${Ha(this,bM)}`}set sessionToken(e){wu(this,wM,!0),wu(this,rS,new jc(e))}get suggestions(){return Ha(this,D_)}suggest(e,t){return Ha(this,SM).call(this,e,t),new Promise((r,n)=>{let a,l;a=h=>{this.removeEventListener("suggest",a),this.removeEventListener("suggesterror",l),r(h)},l=h=>{this.removeEventListener("suggest",a),this.removeEventListener("suggesterror",l),n(h)},this.addEventListener("suggest",a),this.addEventListener("suggesterror",l)})}clear(){this.suggest("")}retrieve(e,t){return bl(this,null,function*(){const r=yield this.search.retrieve(e,Ui({sessionToken:this.sessionToken},t));return this.fire("retrieve",r),r})}canRetrieve(e){return this.search.canRetrieve?this.search.canRetrieve(e):!0}canSuggest(e){return this.search.canSuggest?this.search.canSuggest(e):!0}abort(){Ha(this,wp).abort(),wu(this,wp,$N())}incrementSession(){qXe(this,bM)._++}};rS=new WeakMap;bM=new WeakMap;wM=new WeakMap;D_=new WeakMap;wp=new WeakMap;SM=new WeakMap;function VU(e){const{properties:t}=e;return Ui({},t)}function qR(e){return e.split("-")[0]}function WU(e){return e.split("-")[1]}function GU(e){return["top","bottom"].includes(qR(e))?"x":"y"}function Yle(e){return e==="y"?"height":"width"}function VX(e,t,r){let{reference:n,floating:a}=e;const l=n.x+n.width/2-a.width/2,h=n.y+n.height/2-a.height/2,i=GU(t),_=Yle(i),b=n[_]/2-a[_]/2,E=i==="x";let C;switch(qR(t)){case"top":C={x:l,y:n.y-a.height};break;case"bottom":C={x:l,y:n.y+n.height};break;case"right":C={x:n.x+n.width,y:h};break;case"left":C={x:n.x-a.width,y:h};break;default:C={x:n.x,y:n.y}}switch(WU(t)){case"start":C[i]-=b*(r&&E?-1:1);break;case"end":C[i]+=b*(r&&E?-1:1)}return C}const vYe=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:h}=r,i=await(h.isRTL==null?void 0:h.isRTL(t));let _=await h.getElementRects({reference:e,floating:t,strategy:a}),{x:b,y:E}=VX(_,n,i),C=n,I={},F=0;for(let $=0;$<l.length;$++){const{name:B,fn:q}=l[$],{x:G,y:H,data:J,reset:Q}=await q({x:b,y:E,initialPlacement:n,placement:C,strategy:a,middlewareData:I,rects:_,platform:h,elements:{reference:e,floating:t}});b=G??b,E=H??E,I={...I,[B]:{...I[B],...J}},Q&&F<=50&&(F++,typeof Q=="object"&&(Q.placement&&(C=Q.placement),Q.rects&&(_=Q.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:a}):Q.rects),{x:b,y:E}=VX(_,C,i)),$=-1)}return{x:b,y:E,placement:C,strategy:a,middlewareData:I}};function _Ye(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function GO(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function xYe(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:h,elements:i,strategy:_}=e,{boundary:b="clippingAncestors",rootBoundary:E="viewport",elementContext:C="floating",altBoundary:I=!1,padding:F=0}=t,$=_Ye(F),B=i[I?C==="floating"?"reference":"floating":C],q=GO(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(B)))==null||r?B:B.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:b,rootBoundary:E,strategy:_})),G=GO(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({rect:C==="floating"?{...h.floating,x:n,y:a}:h.reference,offsetParent:await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),strategy:_}):h[C]);return{top:q.top-G.top+$.top,bottom:G.bottom-q.bottom+$.bottom,left:q.left-G.left+$.left,right:G.right-q.right+$.right}}const bYe={left:"right",right:"left",bottom:"top",top:"bottom"};function qO(e){return e.replace(/left|right|bottom|top/g,t=>bYe[t])}function wYe(e,t,r){r===void 0&&(r=!1);const n=WU(e),a=GU(e),l=Yle(a);let h=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(h=qO(h)),{main:h,cross:qO(h)}}const SYe={start:"end",end:"start"};function WX(e){return e.replace(/start|end/g,t=>SYe[t])}const TYe=["top","right","bottom","left"];TYe.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]);const EYe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r;const{placement:n,middlewareData:a,rects:l,initialPlacement:h,platform:i,elements:_}=t,{mainAxis:b=!0,crossAxis:E=!0,fallbackPlacements:C,fallbackStrategy:I="bestFit",flipAlignment:F=!0,...$}=e,B=qR(n),q=C||(B===h||!F?[qO(h)]:function(ve){const Fe=qO(ve);return[WX(ve),Fe,WX(Fe)]}(h)),G=[h,...q],H=await xYe(t,$),J=[];let Q=((r=a.flip)==null?void 0:r.overflows)||[];if(b&&J.push(H[B]),E){const{main:ve,cross:Fe}=wYe(n,l,await(i.isRTL==null?void 0:i.isRTL(_.floating)));J.push(H[ve],H[Fe])}if(Q=[...Q,{placement:n,overflows:J}],!J.every(ve=>ve<=0)){var oe,de;const ve=((oe=(de=a.flip)==null?void 0:de.index)!=null?oe:0)+1,Fe=G[ve];if(Fe)return{data:{index:ve,overflows:Q},reset:{placement:Fe}};let ke="bottom";switch(I){case"bestFit":{var ae;const Ce=(ae=Q.map(je=>[je,je.overflows.filter(tt=>tt>0).reduce((tt,Ze)=>tt+Ze,0)]).sort((je,tt)=>je[1]-tt[1])[0])==null?void 0:ae[0].placement;Ce&&(ke=Ce);break}case"initialPlacement":ke=h}if(n!==ke)return{reset:{placement:ke}}}return{}}}},AYe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:r,y:n}=t,a=await async function(l,h){const{placement:i,platform:_,elements:b}=l,E=await(_.isRTL==null?void 0:_.isRTL(b.floating)),C=qR(i),I=WU(i),F=GU(i)==="x",$=["left","top"].includes(C)?-1:1,B=E&&F?-1:1,q=typeof h=="function"?h(l):h;let{mainAxis:G,crossAxis:H,alignmentAxis:J}=typeof q=="number"?{mainAxis:q,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...q};return I&&typeof J=="number"&&(H=I==="end"?-1*J:J),F?{x:H*B,y:G*$}:{x:G*$,y:H*B}}(t,e);return{x:r+a.x,y:n+a.y,data:a}}}};function Kle(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function mf(e){if(e==null)return window;if(!Kle(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function i2(e){return mf(e).getComputedStyle(e)}function Vh(e){return Kle(e)?"":e?(e.nodeName||"").toLowerCase():""}function Jle(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function qd(e){return e instanceof mf(e).HTMLElement}function Am(e){return e instanceof mf(e).Element}function qU(e){return typeof ShadowRoot>"u"?!1:e instanceof mf(e).ShadowRoot||e instanceof ShadowRoot}function HR(e){const{overflow:t,overflowX:r,overflowY:n}=i2(e);return/auto|scroll|overlay|hidden/.test(t+n+r)}function CYe(e){return["table","td","th"].includes(Vh(e))}function GX(e){const t=/firefox/i.test(Jle()),r=i2(e);return r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].includes(r.willChange)||t&&r.willChange==="filter"||t&&!!r.filter&&r.filter!=="none"}function Qle(){return!/^((?!chrome|android).)*safari/i.test(Jle())}const qX=Math.min,HS=Math.max,HO=Math.round;function Wh(e,t,r){var n,a,l,h;t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect();let _=1,b=1;t&&qd(e)&&(_=e.offsetWidth>0&&HO(i.width)/e.offsetWidth||1,b=e.offsetHeight>0&&HO(i.height)/e.offsetHeight||1);const E=Am(e)?mf(e):window,C=!Qle()&&r,I=(i.left+(C&&(n=(a=E.visualViewport)==null?void 0:a.offsetLeft)!=null?n:0))/_,F=(i.top+(C&&(l=(h=E.visualViewport)==null?void 0:h.offsetTop)!=null?l:0))/b,$=i.width/_,B=i.height/b;return{width:$,height:B,top:F,right:I+$,bottom:F+B,left:I,x:I,y:F}}function pm(e){return(t=e,(t instanceof mf(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function ZR(e){return Am(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function ece(e){return Wh(pm(e)).left+ZR(e).scrollLeft}function MYe(e,t,r){const n=qd(t),a=pm(t),l=Wh(e,n&&function(_){const b=Wh(_);return HO(b.width)!==_.offsetWidth||HO(b.height)!==_.offsetHeight}(t),r==="fixed");let h={scrollLeft:0,scrollTop:0};const i={x:0,y:0};if(n||!n&&r!=="fixed")if((Vh(t)!=="body"||HR(a))&&(h=ZR(t)),qd(t)){const _=Wh(t,!0);i.x=_.x+t.clientLeft,i.y=_.y+t.clientTop}else a&&(i.x=ece(a));return{x:l.left+h.scrollLeft-i.x,y:l.top+h.scrollTop-i.y,width:l.width,height:l.height}}function tce(e){return Vh(e)==="html"?e:e.assignedSlot||e.parentNode||(qU(e)?e.host:null)||pm(e)}function HX(e){return qd(e)&&getComputedStyle(e).position!=="fixed"?e.offsetParent:null}function w4(e){const t=mf(e);let r=HX(e);for(;r&&CYe(r)&&getComputedStyle(r).position==="static";)r=HX(r);return r&&(Vh(r)==="html"||Vh(r)==="body"&&getComputedStyle(r).position==="static"&&!GX(r))?t:r||function(n){let a=tce(n);for(qU(a)&&(a=a.host);qd(a)&&!["html","body"].includes(Vh(a));){if(GX(a))return a;a=a.parentNode}return null}(e)||t}function ZX(e){if(qd(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=Wh(e);return{width:t.width,height:t.height}}function rce(e){const t=tce(e);return["html","body","#document"].includes(Vh(t))?e.ownerDocument.body:qd(t)&&HR(t)?t:rce(t)}function ZO(e,t){var r;t===void 0&&(t=[]);const n=rce(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),l=mf(n),h=a?[l].concat(l.visualViewport||[],HR(n)?n:[]):n,i=t.concat(h);return a?i:i.concat(ZO(h))}function XX(e,t,r){return t==="viewport"?GO(function(n,a){const l=mf(n),h=pm(n),i=l.visualViewport;let _=h.clientWidth,b=h.clientHeight,E=0,C=0;if(i){_=i.width,b=i.height;const I=Qle();(I||!I&&a==="fixed")&&(E=i.offsetLeft,C=i.offsetTop)}return{width:_,height:b,x:E,y:C}}(e,r)):Am(t)?function(n,a){const l=Wh(n,!1,a==="fixed"),h=l.top+n.clientTop,i=l.left+n.clientLeft;return{top:h,left:i,x:i,y:h,right:i+n.clientWidth,bottom:h+n.clientHeight,width:n.clientWidth,height:n.clientHeight}}(t,r):GO(function(n){var a;const l=pm(n),h=ZR(n),i=(a=n.ownerDocument)==null?void 0:a.body,_=HS(l.scrollWidth,l.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),b=HS(l.scrollHeight,l.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0);let E=-h.scrollLeft+ece(n);const C=-h.scrollTop;return i2(i||l).direction==="rtl"&&(E+=HS(l.clientWidth,i?i.clientWidth:0)-_),{width:_,height:b,x:E,y:C}}(pm(e)))}function PYe(e){const t=ZO(e),r=["absolute","fixed"].includes(i2(e).position)&&qd(e)?w4(e):e;return Am(r)?t.filter(n=>Am(n)&&function(a,l){const h=l.getRootNode==null?void 0:l.getRootNode();if(a.contains(l))return!0;if(h&&qU(h)){let i=l;do{if(i&&a===i)return!0;i=i.parentNode||i.host}while(i)}return!1}(n,r)&&Vh(n)!=="body"):[]}const IYe={getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const l=[...r==="clippingAncestors"?PYe(t):[].concat(r),n],h=l[0],i=l.reduce((_,b)=>{const E=XX(t,b,a);return _.top=HS(E.top,_.top),_.right=qX(E.right,_.right),_.bottom=qX(E.bottom,_.bottom),_.left=HS(E.left,_.left),_},XX(t,h,a));return{width:i.right-i.left,height:i.bottom-i.top,x:i.left,y:i.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:n}=e;const a=qd(r),l=pm(r);if(r===l)return t;let h={scrollLeft:0,scrollTop:0};const i={x:0,y:0};if((a||!a&&n!=="fixed")&&((Vh(r)!=="body"||HR(l))&&(h=ZR(r)),qd(r))){const _=Wh(r,!0);i.x=_.x+r.clientLeft,i.y=_.y+r.clientTop}return{...t,x:t.x-h.scrollLeft+i.x,y:t.y-h.scrollTop+i.y}},isElement:Am,getDimensions:ZX,getOffsetParent:w4,getDocumentElement:pm,getElementRects:e=>{let{reference:t,floating:r,strategy:n}=e;return{reference:MYe(t,w4(r),n),floating:{...ZX(r),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>i2(e).direction==="rtl"};function OYe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:h=!0,animationFrame:i=!1}=n,_=a&&!i,b=l&&!i,E=_||b?[...Am(e)?ZO(e):[],...ZO(t)]:[];E.forEach($=>{_&&$.addEventListener("scroll",r,{passive:!0}),b&&$.addEventListener("resize",r)});let C,I=null;if(h){let $=!0;I=new ResizeObserver(()=>{$||r(),$=!1}),Am(e)&&!i&&I.observe(e),I.observe(t)}let F=i?Wh(e):null;return i&&function $(){const B=Wh(e);!F||B.x===F.x&&B.y===F.y&&B.width===F.width&&B.height===F.height||r(),F=B,C=requestAnimationFrame($)}(),r(),()=>{var $;E.forEach(B=>{_&&B.removeEventListener("scroll",r),b&&B.removeEventListener("resize",r)}),($=I)==null||$.disconnect(),I=null,i&&cancelAnimationFrame(C)}}const kYe=(e,t,r)=>vYe(e,t,{platform:IYe,...r});var nce={exports:{}};(function(e){(function(t){var r=!1,n,a;function l(){if(typeof n<"u")return n;var C=document.documentElement,I=document.createElement("div");return I.setAttribute("style","width:99px;height:99px;position:absolute;top:-9999px;overflow:scroll;"),C.appendChild(I),n=I.offsetWidth-I.clientWidth,C.removeChild(I),n}function h(){return document.documentElement.scrollHeight>window.innerHeight}function i(C){if(!(typeof document>"u"||r)){var I=document.documentElement;a=window.pageYOffset,h()?I.style.width="calc(100% - "+l()+"px)":I.style.width="100%",I.style.position="fixed",I.style.top=-a+"px",I.style.overflow="hidden",r=!0}}function _(){if(!(typeof document>"u"||!r)){var C=document.documentElement;C.style.width="",C.style.position="",C.style.top="",C.style.overflow="",window.scroll(0,a),r=!1}}function b(){if(r){_();return}i()}var E={on:i,off:_,toggle:b};e.exports=E})()})(nce);var RYe=nce.exports;const YX=yi(RYe);/*!
* tabbable 5.3.3
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var ice=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],XO=ice.join(","),oce=typeof Element>"u",Wy=oce?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,S4=!oce&&Element.prototype.getRootNode?function(e){return e.getRootNode()}:function(e){return e.ownerDocument},ace=function(t,r,n){var a=Array.prototype.slice.apply(t.querySelectorAll(XO));return r&&Wy.call(t,XO)&&a.unshift(t),a=a.filter(n),a},sce=function e(t,r,n){for(var a=[],l=Array.from(t);l.length;){var h=l.shift();if(h.tagName==="SLOT"){var i=h.assignedElements(),_=i.length?i:h.children,b=e(_,!0,n);n.flatten?a.push.apply(a,b):a.push({scope:h,candidates:b})}else{var E=Wy.call(h,XO);E&&n.filter(h)&&(r||!t.includes(h))&&a.push(h);var C=h.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(h),I=!n.shadowRootFilter||n.shadowRootFilter(h);if(C&&I){var F=e(C===!0?h.children:C.children,!0,n);n.flatten?a.push.apply(a,F):a.push({scope:h,candidates:F})}else l.unshift.apply(l,h.children)}}return a},lce=function(t,r){return t.tabIndex<0&&(r||/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||t.isContentEditable)&&isNaN(parseInt(t.getAttribute("tabindex"),10))?0:t.tabIndex},DYe=function(t,r){return t.tabIndex===r.tabIndex?t.documentOrder-r.documentOrder:t.tabIndex-r.tabIndex},cce=function(t){return t.tagName==="INPUT"},LYe=function(t){return cce(t)&&t.type==="hidden"},NYe=function(t){var r=t.tagName==="DETAILS"&&Array.prototype.slice.apply(t.children).some(function(n){return n.tagName==="SUMMARY"});return r},zYe=function(t,r){for(var n=0;n<t.length;n++)if(t[n].checked&&t[n].form===r)return t[n]},jYe=function(t){if(!t.name)return!0;var r=t.form||S4(t),n=function(i){return r.querySelectorAll('input[type="radio"][name="'+i+'"]')},a;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")a=n(window.CSS.escape(t.name));else try{a=n(t.name)}catch(h){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",h.message),!1}var l=zYe(a,t.form);return!l||l===t},FYe=function(t){return cce(t)&&t.type==="radio"},BYe=function(t){return FYe(t)&&!jYe(t)},KX=function(t){var r=t.getBoundingClientRect(),n=r.width,a=r.height;return n===0&&a===0},$Ye=function(t,r){var n=r.displayCheck,a=r.getShadowRoot;if(getComputedStyle(t).visibility==="hidden")return!0;var l=Wy.call(t,"details>summary:first-of-type"),h=l?t.parentElement:t;if(Wy.call(h,"details:not([open]) *"))return!0;var i=S4(t).host,_=(i==null?void 0:i.ownerDocument.contains(i))||t.ownerDocument.contains(t);if(!n||n==="full"){if(typeof a=="function"){for(var b=t;t;){var E=t.parentElement,C=S4(t);if(E&&!E.shadowRoot&&a(E)===!0)return KX(t);t.assignedSlot?t=t.assignedSlot:!E&&C!==t.ownerDocument?t=C.host:t=E}t=b}if(_)return!t.getClientRects().length}else if(n==="non-zero-area")return KX(t);return!1},UYe=function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var r=t.parentElement;r;){if(r.tagName==="FIELDSET"&&r.disabled){for(var n=0;n<r.children.length;n++){var a=r.children.item(n);if(a.tagName==="LEGEND")return Wy.call(r,"fieldset[disabled] *")?!0:!a.contains(t)}return!0}r=r.parentElement}return!1},YO=function(t,r){return!(r.disabled||LYe(r)||$Ye(r,t)||NYe(r)||UYe(r))},T4=function(t,r){return!(BYe(r)||lce(r)<0||!YO(t,r))},VYe=function(t){var r=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(r)||r>=0)},WYe=function e(t){var r=[],n=[];return t.forEach(function(a,l){var h=!!a.scope,i=h?a.scope:a,_=lce(i,h),b=h?e(a.candidates):i;_===0?h?r.push.apply(r,b):r.push(i):n.push({documentOrder:l,tabIndex:_,item:a,isScope:h,content:b})}),n.sort(DYe).reduce(function(a,l){return l.isScope?a.push.apply(a,l.content):a.push(l.content),a},[]).concat(r)},GYe=function(t,r){r=r||{};var n;return r.getShadowRoot?n=sce([t],r.includeContainer,{filter:T4.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:VYe}):n=ace(t,r.includeContainer,T4.bind(null,r)),WYe(n)},qYe=function(t,r){r=r||{};var n;return r.getShadowRoot?n=sce([t],r.includeContainer,{filter:YO.bind(null,r),flatten:!0,getShadowRoot:r.getShadowRoot}):n=ace(t,r.includeContainer,YO.bind(null,r)),n},qC=function(t,r){if(r=r||{},!t)throw new Error("No node provided");return Wy.call(t,XO)===!1?!1:T4(r,t)},HYe=ice.concat("iframe").join(","),UN=function(t,r){if(r=r||{},!t)throw new Error("No node provided");return Wy.call(t,HYe)===!1?!1:YO(r,t)};/*!
* focus-trap 6.9.4
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function JX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JX(Object(r),!0).forEach(function(n){ZYe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZYe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var eY=function(){var e=[];return{activateTrap:function(r){if(e.length>0){var n=e[e.length-1];n!==r&&n.pause()}var a=e.indexOf(r);a===-1||e.splice(a,1),e.push(r)},deactivateTrap:function(r){var n=e.indexOf(r);n!==-1&&e.splice(n,1),e.length>0&&e[e.length-1].unpause()}}}(),XYe=function(t){return t.tagName&&t.tagName.toLowerCase()==="input"&&typeof t.select=="function"},YYe=function(t){return t.key==="Escape"||t.key==="Esc"||t.keyCode===27},KYe=function(t){return t.key==="Tab"||t.keyCode===9},tY=function(t){return setTimeout(t,0)},rY=function(t,r){var n=-1;return t.every(function(a,l){return r(a)?(n=l,!1):!0}),n},Uw=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return typeof t=="function"?t.apply(void 0,n):t},HC=function(t){return t.target.shadowRoot&&typeof t.composedPath=="function"?t.composedPath()[0]:t.target},JYe=function(t,r){var n=(r==null?void 0:r.document)||document,a=QX({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},r),l={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},h,i=function(de,ae,ve){return de&&de[ae]!==void 0?de[ae]:a[ve||ae]},_=function(de){return l.containerGroups.findIndex(function(ae){var ve=ae.container,Fe=ae.tabbableNodes;return ve.contains(de)||Fe.find(function(ke){return ke===de})})},b=function(de){var ae=a[de];if(typeof ae=="function"){for(var ve=arguments.length,Fe=new Array(ve>1?ve-1:0),ke=1;ke<ve;ke++)Fe[ke-1]=arguments[ke];ae=ae.apply(void 0,Fe)}if(ae===!0&&(ae=void 0),!ae){if(ae===void 0||ae===!1)return ae;throw new Error("`".concat(de,"` was specified but was not a node, or did not return a node"))}var Ce=ae;if(typeof ae=="string"&&(Ce=n.querySelector(ae),!Ce))throw new Error("`".concat(de,"` as selector refers to no known node"));return Ce},E=function(){var de=b("initialFocus");if(de===!1)return!1;if(de===void 0)if(_(n.activeElement)>=0)de=n.activeElement;else{var ae=l.tabbableGroups[0],ve=ae&&ae.firstTabbableNode;de=ve||b("fallbackFocus")}if(!de)throw new Error("Your focus-trap needs to have at least one focusable element");return de},C=function(){if(l.containerGroups=l.containers.map(function(de){var ae=GYe(de,a.tabbableOptions),ve=qYe(de,a.tabbableOptions);return{container:de,tabbableNodes:ae,focusableNodes:ve,firstTabbableNode:ae.length>0?ae[0]:null,lastTabbableNode:ae.length>0?ae[ae.length-1]:null,nextTabbableNode:function(ke){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,je=ve.findIndex(function(tt){return tt===ke});if(!(je<0))return Ce?ve.slice(je+1).find(function(tt){return qC(tt,a.tabbableOptions)}):ve.slice(0,je).reverse().find(function(tt){return qC(tt,a.tabbableOptions)})}}}),l.tabbableGroups=l.containerGroups.filter(function(de){return de.tabbableNodes.length>0}),l.tabbableGroups.length<=0&&!b("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},I=function oe(de){if(de!==!1&&de!==n.activeElement){if(!de||!de.focus){oe(E());return}de.focus({preventScroll:!!a.preventScroll}),l.mostRecentlyFocusedNode=de,XYe(de)&&de.select()}},F=function(de){var ae=b("setReturnFocus",de);return ae||(ae===!1?!1:de)},$=function(de){var ae=HC(de);if(!(_(ae)>=0)){if(Uw(a.clickOutsideDeactivates,de)){h.deactivate({returnFocus:a.returnFocusOnDeactivate&&!UN(ae,a.tabbableOptions)});return}Uw(a.allowOutsideClick,de)||de.preventDefault()}},B=function(de){var ae=HC(de),ve=_(ae)>=0;ve||ae instanceof Document?ve&&(l.mostRecentlyFocusedNode=ae):(de.stopImmediatePropagation(),I(l.mostRecentlyFocusedNode||E()))},q=function(de){var ae=HC(de);C();var ve=null;if(l.tabbableGroups.length>0){var Fe=_(ae),ke=Fe>=0?l.containerGroups[Fe]:void 0;if(Fe<0)de.shiftKey?ve=l.tabbableGroups[l.tabbableGroups.length-1].lastTabbableNode:ve=l.tabbableGroups[0].firstTabbableNode;else if(de.shiftKey){var Ce=rY(l.tabbableGroups,function(ot){var Be=ot.firstTabbableNode;return ae===Be});if(Ce<0&&(ke.container===ae||UN(ae,a.tabbableOptions)&&!qC(ae,a.tabbableOptions)&&!ke.nextTabbableNode(ae,!1))&&(Ce=Fe),Ce>=0){var je=Ce===0?l.tabbableGroups.length-1:Ce-1,tt=l.tabbableGroups[je];ve=tt.lastTabbableNode}}else{var Ze=rY(l.tabbableGroups,function(ot){var Be=ot.lastTabbableNode;return ae===Be});if(Ze<0&&(ke.container===ae||UN(ae,a.tabbableOptions)&&!qC(ae,a.tabbableOptions)&&!ke.nextTabbableNode(ae))&&(Ze=Fe),Ze>=0){var Qe=Ze===l.tabbableGroups.length-1?0:Ze+1,st=l.tabbableGroups[Qe];ve=st.firstTabbableNode}}}else ve=b("fallbackFocus");ve&&(de.preventDefault(),I(ve))},G=function(de){if(YYe(de)&&Uw(a.escapeDeactivates,de)!==!1){de.preventDefault(),h.deactivate();return}if(KYe(de)){q(de);return}},H=function(de){var ae=HC(de);_(ae)>=0||Uw(a.clickOutsideDeactivates,de)||Uw(a.allowOutsideClick,de)||(de.preventDefault(),de.stopImmediatePropagation())},J=function(){if(l.active)return eY.activateTrap(h),l.delayInitialFocusTimer=a.delayInitialFocus?tY(function(){I(E())}):I(E()),n.addEventListener("focusin",B,!0),n.addEventListener("mousedown",$,{capture:!0,passive:!1}),n.addEventListener("touchstart",$,{capture:!0,passive:!1}),n.addEventListener("click",H,{capture:!0,passive:!1}),n.addEventListener("keydown",G,{capture:!0,passive:!1}),h},Q=function(){if(l.active)return n.removeEventListener("focusin",B,!0),n.removeEventListener("mousedown",$,!0),n.removeEventListener("touchstart",$,!0),n.removeEventListener("click",H,!0),n.removeEventListener("keydown",G,!0),h};return h={get active(){return l.active},get paused(){return l.paused},activate:function(de){if(l.active)return this;var ae=i(de,"onActivate"),ve=i(de,"onPostActivate"),Fe=i(de,"checkCanFocusTrap");Fe||C(),l.active=!0,l.paused=!1,l.nodeFocusedBeforeActivation=n.activeElement,ae&&ae();var ke=function(){Fe&&C(),J(),ve&&ve()};return Fe?(Fe(l.containers.concat()).then(ke,ke),this):(ke(),this)},deactivate:function(de){if(!l.active)return this;var ae=QX({onDeactivate:a.onDeactivate,onPostDeactivate:a.onPostDeactivate,checkCanReturnFocus:a.checkCanReturnFocus},de);clearTimeout(l.delayInitialFocusTimer),l.delayInitialFocusTimer=void 0,Q(),l.active=!1,l.paused=!1,eY.deactivateTrap(h);var ve=i(ae,"onDeactivate"),Fe=i(ae,"onPostDeactivate"),ke=i(ae,"checkCanReturnFocus"),Ce=i(ae,"returnFocus","returnFocusOnDeactivate");ve&&ve();var je=function(){tY(function(){Ce&&I(F(l.nodeFocusedBeforeActivation)),Fe&&Fe()})};return Ce&&ke?(ke(F(l.nodeFocusedBeforeActivation)).then(je,je),this):(je(),this)},pause:function(){return l.paused||!l.active?this:(l.paused=!0,Q(),this)},unpause:function(){return!l.paused||!l.active?this:(l.paused=!1,C(),J(),this)},updateContainerElements:function(de){var ae=[].concat(de).filter(Boolean);return l.containers=ae.map(function(ve){return typeof ve=="string"?n.querySelector(ve):ve}),l.active&&C(),this}},h.updateContainerElements(t),h},uce={exports:{}};(function(e){(function(t,r,n){e.exports?e.exports=n():t[r]=n()})(Na,"subtag",function(){var t="",r=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(_){return _.match(r)||[]}function a(_){return n(_).filter(function(b,E){return b&&E})}function l(_){return _=n(_),{language:_[1]||t,extlang:_[2]||t,script:_[3]||t,region:_[4]||t}}function h(_,b,E){Object.defineProperty(_,b,{value:E,enumerable:!0})}function i(_,b,E){function C(I){return n(I)[_]||t}h(C,"pattern",b),h(l,E,C)}return i(1,/^[a-zA-Z]{2,3}$/,"language"),i(2,/^[a-zA-Z]{3}$/,"extlang"),i(3,/^[a-zA-Z]{4}$/,"script"),i(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),h(l,"split",a),l})})(uce);var QYe=uce.exports;const dce=yi(QYe);var hce={exports:{}};(function(e,t){var r=function(){var n={},a=Math.PI/180,l=180/Math.PI,h=6378137,i=20037508342789244e-9;function _(E){return Number(E)===E&&E%1!==0}function b(E){if(E=E||{},this.size=E.size||256,this.expansion=E.antimeridian===!0?2:1,!n[this.size]){var C=this.size,I=n[this.size]={};I.Bc=[],I.Cc=[],I.zc=[],I.Ac=[];for(var F=0;F<30;F++)I.Bc.push(C/360),I.Cc.push(C/(2*Math.PI)),I.zc.push(C/2),I.Ac.push(C),C*=2}this.Bc=n[this.size].Bc,this.Cc=n[this.size].Cc,this.zc=n[this.size].zc,this.Ac=n[this.size].Ac}return b.prototype.px=function(E,C){if(_(C)){var I=this.size*Math.pow(2,C),F=I/2,$=I/360,B=I/(2*Math.PI),q=I,G=Math.min(Math.max(Math.sin(a*E[1]),-.9999),.9999),H=F+E[0]*$,J=F+.5*Math.log((1+G)/(1-G))*-B;return H>q*this.expansion&&(H=q*this.expansion),J>q&&(J=q),[H,J]}else{var F=this.zc[C],G=Math.min(Math.max(Math.sin(a*E[1]),-.9999),.9999),H=Math.round(F+E[0]*this.Bc[C]),J=Math.round(F+.5*Math.log((1+G)/(1-G))*-this.Cc[C]);return H>this.Ac[C]*this.expansion&&(H=this.Ac[C]*this.expansion),J>this.Ac[C]&&(J=this.Ac[C]),[H,J]}},b.prototype.ll=function(E,C){if(_(C)){var I=this.size*Math.pow(2,C),F=I/360,$=I/(2*Math.PI),B=I/2,q=(E[1]-B)/-$,G=(E[0]-B)/F,H=l*(2*Math.atan(Math.exp(q))-.5*Math.PI);return[G,H]}else{var q=(E[1]-this.zc[C])/-this.Cc[C],G=(E[0]-this.zc[C])/this.Bc[C],H=l*(2*Math.atan(Math.exp(q))-.5*Math.PI);return[G,H]}},b.prototype.bbox=function(E,C,I,F,$){F&&(C=Math.pow(2,I)-1-C);var B=[E*this.size,(+C+1)*this.size],q=[(+E+1)*this.size,C*this.size],G=this.ll(B,I).concat(this.ll(q,I));return $==="900913"?this.convert(G,"900913"):G},b.prototype.xyz=function(E,C,I,F){F==="900913"&&(E=this.convert(E,"WGS84"));var $=[E[0],E[1]],B=[E[2],E[3]],q=this.px($,C),G=this.px(B,C),H=[Math.floor(q[0]/this.size),Math.floor((G[0]-1)/this.size)],J=[Math.floor(G[1]/this.size),Math.floor((q[1]-1)/this.size)],Q={minX:Math.min.apply(Math,H)<0?0:Math.min.apply(Math,H),minY:Math.min.apply(Math,J)<0?0:Math.min.apply(Math,J),maxX:Math.max.apply(Math,H),maxY:Math.max.apply(Math,J)};if(I){var oe={minY:Math.pow(2,C)-1-Q.maxY,maxY:Math.pow(2,C)-1-Q.minY};Q.minY=oe.minY,Q.maxY=oe.maxY}return Q},b.prototype.convert=function(E,C){return C==="900913"?this.forward(E.slice(0,2)).concat(this.forward(E.slice(2,4))):this.inverse(E.slice(0,2)).concat(this.inverse(E.slice(2,4)))},b.prototype.forward=function(E){var C=[h*E[0]*a,h*Math.log(Math.tan(Math.PI*.25+.5*E[1]*a))];return C[0]>i&&(C[0]=i),C[0]<-i&&(C[0]=-i),C[1]>i&&(C[1]=i),C[1]<-i&&(C[1]=-i),C},b.prototype.inverse=function(E){return[E[0]*l/h,(Math.PI*.5-2*Math.atan(Math.exp(-E[1]/h)))*l]},b}();e.exports=r})(hce);var eKe=hce.exports;const tKe=yi(eKe);var rKe=Object.defineProperty,nKe=Object.defineProperties,iKe=Object.getOwnPropertyDescriptors,nY=Object.getOwnPropertySymbols,oKe=Object.prototype.hasOwnProperty,aKe=Object.prototype.propertyIsEnumerable,iY=(e,t,r)=>t in e?rKe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ei=(e,t)=>{for(var r in t||(t={}))oKe.call(t,r)&&iY(e,r,t[r]);if(nY)for(var r of nY(t))aKe.call(t,r)&&iY(e,r,t[r]);return e},tc=(e,t)=>nKe(e,iKe(t)),HU=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},ue=(e,t,r)=>(HU(e,t,"read from private field"),r?r.call(e):t.get(e)),Pt=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},wr=(e,t,r,n)=>(HU(e,t,"write to private field"),t.set(e,r),r),ZS=(e,t,r)=>(HU(e,t,"access private method"),r),zx=(e,t,r)=>new Promise((n,a)=>{var l=_=>{try{i(r.next(_))}catch(b){a(b)}},h=_=>{try{i(r.throw(_))}catch(b){a(b)}},i=_=>_.done?n(_.value):Promise.resolve(_.value).then(l,h);i((r=r.apply(e,t)).next())}),oY=document.implementation.createHTMLDocument();function iv(e,t){const r={};for(const[n,a]of Object.entries(t))r[n]=e.querySelector(a);return r}function sKe(e){return Array.from(e.childNodes||[]).filter(t=>t.nodeType===Node.ELEMENT_NODE)}function oc(e){const t=document.createElement("template");return t.innerHTML=e,t.content.firstElementChild}function lKe(e){const t=oY.createElement("style");return t.textContent=e,oY.head.appendChild(t),t.sheet}function cKe(e){return window.getComputedStyle(e).display!=="none"}function hd(e,t){if(!e)return;Object.getOwnPropertyDescriptor(e.constructor.prototype,"value").set.call(e,t);const n=e;n._valueTracker&&n._valueTracker.setValue("");const a=new Event("input",{bubbles:!0});a.simulated=!0,e.dispatchEvent(a);const l=new Event("change",{bubbles:!0});l.simulated=!0,e.dispatchEvent(l)}function fce(e,t=!1){let r,n;const a=e.getBoundingClientRect();if(e.style.display==="none"||a.height===0&&a.width===0){const l=e.cloneNode(t);e.parentElement.appendChild(l),l.style.setProperty("display","block","important");const h=l.getBoundingClientRect();r=h.width,n=h.height,l.style.setProperty("display","none"),l.remove()}else r=a.width,n=a.height;return{height:Math.floor(n),width:Math.floor(r)}}function uKe(e){const t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)}var dKe=new RegExp("[_a-zA-Z]+[_a-zA-Z0-9-]*","g"),hKe=new RegExp(`\\.${dKe.source}`,"g"),fKe=new RegExp("^\\s*(@(?:media|supports)[^{]*){(.*)}\\s*$");function TM(e,t){return e.replace(hKe,r=>"."+t(r.slice(1)))}function pce(e,t){const n=lKe(e).cssRules;function a(h){if(h instanceof CSSStyleRule)return`${TM(h.selectorText,t)} { ${h.style.cssText} }`;const i=fKe.exec(h.cssText.split(`
`).join(""));if(i&&i.length>2){const _=i[1],b=i[2];return`${_} { ${pce(b,t)} }`}return h.cssText}let l="";for(const h of Array.from(n))l+=a(h)+`

`;return l.trim()}function aY(e,t){const r=Array.from(e.querySelectorAll("[class]"));r.push(e);for(const n of r){const{classList:a}=n;for(const l of Array.from(a))a.remove(l),a.add(t(l))}return e}var ZU=1.4;function mce(e,t,r=.5){const{center:n,zoom:a}=e.cameraForBounds(t),l=Math.max(a-r,0);return{center:n,zoom:l,speed:ZU}}function gce(e){switch(e){case"street":return 15;case"neighborhood":case"postcode":case"locality":case"oaza":return 14;case"place":case"city":return 13;case"district":return 9;case"region":case"prefecture":return 6;case"country":return 4;default:return 16}}function yce(e,t){return`https://api.mapbox.com/styles/v1/${e}/${t}/static/`}var XU='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.8 3.8a1 1 0 0 1 1.4 0L9 7.58l3.8-3.8a1 1 0 1 1 1.4 1.42L10.42 9l3.8 3.8a1 1 0 0 1-1.42 1.4L9 10.42l-3.8 3.8a1 1 0 0 1-1.4-1.42L7.58 9l-3.8-3.8a1 1 0 0 1 0-1.4Z" fill="currentColor"/></svg>',vce='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/></svg>',pKe=yce("mapbox","satellite-streets-v11"),mKe="20d01",gKe=["mapbox.com","mapbox.cn","tilestream.net"],yKe=oc(`
<template>
  <div class="MapboxSearch">
    <div class="Label" role="label" aria-live="polite" aria-atomic="true">
    </div>
    <div class="Results" aria-hidden="true">
      <div class="ResultsList" role="listbox">
      </div>
      <div class="ResultsAttribution" aria-hidden="true">
        <a href="https://www.mapbox.com/search-service" target="_blank" tabindex="-1">
          Powered by Mapbox
        </a>
      </div>
    </div>
  </div>
</template>
`),vKe=oc(`
<template>
  <div class="Suggestion" role="option" tabindex="-1">
    <div class="SuggestionIcon" aria-hidden="true"></div>
    <div class="SuggestionText">
      <div class="SuggestionName"></div>
      <div class="SuggestionDesc"></div>
    </div>
  </div>
</template>
`),_Ke=oc(`
<template>
  <div class="SearchBox">
    <div class="SearchIcon"></div>
    <input class="Input" type="text" />
    <div class="ActionIcon">
      <button aria-label="Clear" class="ClearBtn" type="button">${XU}</button>
      <div class="LoadingIcon">${vce}</div>
    </div>
  </div>
</template>
`),xKe=oc(`
<template>
  <div class="Geocoder">
    <div class="SearchIcon"></div>
    <input class="Input" type="text" />
    <div class="ActionIcon">
      <button aria-label="Clear" class="ClearBtn" type="button">${XU}</button>
      <div class="LoadingIcon">${vce}</div>
    </div>
  </div>
</template>
`);function Sy(){return"mbx"+new jc().id.slice(0,8)}function jx(e){try{return JSON.parse(e)}catch{return null}}function YU(e,t){if(e==null||t==null||typeof e!="object"||typeof t!="object")return e===t;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r)if(!YU(e[a],t[a]))return!1;return!0}function sY(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}function bKe(e){return!!e.match(/localhost|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|::1|\.local|^$/gi)}function wKe(e){return!!gKe.some(t=>e.includes(t))}var nS,L_,N_,$m=class extends HTMLElement{constructor(){super(...arguments),Pt(this,nS,Sy()),Pt(this,L_,void 0),Pt(this,N_,e=>`${ue(this,nS)}--${e}`)}get template(){return null}get templateStyle(){return null}get templateUserStyle(){return null}clonedCallback(e,t){const r=l=>l.replace(e,t);aY(this,r);const n=Array.from(this.querySelectorAll("style"));for(const l of n)l.textContent=TM(l.textContent,r);n.length&&wr(this,L_,n[n.length-1]);const a=Array.from(this.querySelectorAll(`[id^="${e}"]`));for(const l of a)l.id=l.id.replace(e,t)}connectedCallback(){if(this.childElementCount>0){const n=this.dataset.seed,a=ue(this,nS);n&&n!==a&&(this.clonedCallback(n,a),this.dataset.seed=a);return}this.dataset.seed=ue(this,nS);const e=this.template;if(e){const n=this.prepareTemplate(e);this.appendChild(n)}const t=this.templateStyle;if(t){const n=document.createElement("style");n.textContent=this.prepareCSS(t),this.appendChild(n)}const r=document.createElement("style");this.templateUserStyle&&(r.textContent=this.prepareCSS(this.templateUserStyle)),this.appendChild(r),wr(this,L_,r)}prepareTemplate(e){const t=e.content.firstElementChild;return aY(t.cloneNode(!0),ue(this,N_))}prepareCSS(e){return pce(e,ue(this,N_))}updateTemplateUserStyle(e){ue(this,L_)&&(ue(this,L_).textContent=this.prepareCSS(e))}querySelector(e){return super.querySelector(TM(e,ue(this,N_)))}querySelectorAll(e){return super.querySelectorAll(TM(e,ue(this,N_)))}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}dispatchEvent(e){return super.dispatchEvent(e)}};nS=new WeakMap;L_=new WeakMap;N_=new WeakMap;var SKe='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9 16A7 7 0 1 0 9 2a7 7 0 0 0 0 14ZM6.88 4.88a2.58 2.58 0 0 1 1.83-.75h1.08a2.58 2.58 0 0 1 2.59 2.58v.16c0 1-.53 1.94-1.4 2.46l-.56.34c-.27.16-.45.42-.52.71-.03.14-.14.25-.28.25H8.38a.23.23 0 0 1-.24-.25c.08-.91.59-1.74 1.38-2.21l.56-.34c.34-.2.54-.57.54-.96V6.7a.83.83 0 0 0-.83-.83H8.71a.83.83 0 0 0-.84.83v.18a.87.87 0 1 1-1.75 0V6.7c0-.69.28-1.34.76-1.83ZM10 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" fill="currentColor"/></svg>',TKe='<svg width="48" height="56" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#a)"><path d="m24 50.4 13.79-14.12a18.82 18.82 0 0 0 4.23-20.86 19.23 19.23 0 0 0-7.19-8.6 19.76 19.76 0 0 0-21.66 0c-3.21 2.11-5.71 5.1-7.19 8.6a18.82 18.82 0 0 0 4.23 20.86L24 50.4Z" fill="currentColor"/><path d="M37.26 35.75 24 49.34 10.75 35.76l-.01-.01A18.07 18.07 0 0 1 6.68 15.7a18.48 18.48 0 0 1 6.9-8.26 19 19 0 0 1 20.84 0 18.48 18.48 0 0 1 6.9 8.26 18.07 18.07 0 0 1-4.06 20.04Z" stroke="#fff" stroke-width="1.5"/></g><circle cx="24" cy="22.45" fill="#fff" r="5.85"/><defs><filter id="a" x=".5" y=".6" width="47" height="54.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1"/><feGaussianBlur stdDeviation="2"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_17_871"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_17_871" result="shape"/></filter></defs></svg>',EKe=`<svg width="24" height="24" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.08 14.94 5.625 3.06h1.17l-3.42 11.88H1.08Zm15.885 0L12.42 3.06h-1.17l3.42 11.88h2.295Zm-6.86-1.44H7.946l.128-2.61h1.912l.119 2.61Zm-.217-4.77H8.181l.088-1.8h1.537l.082 1.8ZM9.74 5.49h-1.4l.049-.99h1.306l.045.99Z" fill="currentColor" />
</svg>`,AKe=`<!-- TODO: I'm not sure if the way I added the circle will "scale" properly, need to check that -->
<svg width="24" height="24" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
  <path fill="none" stroke="currentColor" stroke-width="1.5" d="M4 7a5 5 0 1 1 10 0c0 3.025-3.28 6.713-5 9-1.72-2.287-5-5.975-5-9z"></path>
    <circle cx="9" cy="7" r="2" fill="currentColor"></circle>
</svg>`,CKe=`<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
  <path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>
</svg>`,MKe="@mapbox/search-js-web",XR="1.0.0",PKe=`https://api.mapbox.com/search-js/v${XR}/img/style-toggle-satellite.jpg`,IKe=`https://api.mapbox.com/search-js/v${XR}/img/style-toggle-default.jpg`,OKe=767,kKe=`@media only screen and (max-width: ${OKe}px)`,KU={variables:{unit:["mobile","16px","14px"],unitHeader:["mobile","24px","18px"],minWidth:"min(300px, 100vw)",spacing:"0.75em",padding:"0.5em 0.75em",paddingFooterLabel:"0.5em 0.75em",paddingModal:"1.25em",colorText:"rgba(0, 0, 0, 0.75)",colorPrimary:"#4264FB",colorSecondary:"#667F91",colorBackground:"#fff",colorBackgroundHover:"#f5f5f5",colorBackgroundActive:"#f0f0f0",colorBackdrop:"rgba(102, 127, 145, 0.3)",border:"none",borderRadius:"4px",boxShadow:`
      0 0 10px 2px rgba(0, 0, 0, 0.05),
      0 0 6px 1px rgba(0, 0, 0, 0.1),
      0 0 0 1px rgba(0, 0, 0, 0.1)
    `,lineHeight:"1.2em",fontFamily:`
      -apple-system, BlinkMacSystemFont,
      avenir next, avenir,
      segoe ui,
      helvetica neue, helvetica,
      Ubuntu, roboto, noto, arial, sans-serif
    `,fontWeight:"normal",fontWeightSemibold:"600",fontWeightBold:"bold",duration:"150ms",curve:"ease-out"},icons:{close:XU,question:SKe,marker:TKe,street:EKe,addressMarker:AKe,search:CKe},images:{styleToggleDefault:IKe,styleToggleSatellite:PKe}};function Cl(e,t={}){const r=ei(ei({},KU.variables),t.variables||{});let n=t.cssText||"",a="";for(const[l,h]of Object.entries(r)){if(!Array.isArray(h)){a+=`--${l}: ${h};`;continue}if(h[0]!=="mobile"){const b=JSON.stringify(h);throw new Error(`Unsupported expression in theme variables: ${l} ${b}`)}const[,i,_]=h;n+=`${kKe} { ${e} { --${l}: ${i} !important; } }`,a+=`--${l}: ${_};`}return n+`${e} { ${a} }`}function Oc(e,t={}){return ei(ei({},KU.icons),t.icons||{})[e]}function RKe(e,t={}){return ei(ei({},KU.images),t.images||{})[e]}var z_,E4,lY=class{constructor(e,t,r){Pt(this,z_,void 0),Pt(this,E4,{placement:"bottom-start",flip:!1,offset:10}),this.update=()=>zx(this,null,function*(){const n={placement:this.options.placement,middleware:[AYe(this.options.offset),this.options.flip&&EYe()].filter(Boolean)},{x:a,y:l}=yield kYe(this.referenceEl,this.floatingEl,n);Object.assign(this.floatingEl.style,{left:`${a}px`,top:`${l}px`})}),this.referenceEl=e,this.floatingEl=t,wr(this,z_,ei(ei({},ue(this,E4)),r)),this.destroy=OYe(this.referenceEl,this.floatingEl,this.update)}get options(){return ue(this,z_)}set options(e){wr(this,z_,ei(ei({},ue(this,z_)),e))}};z_=new WeakMap;E4=new WeakMap;var ov="*{box-sizing:border-box!important}[role=button]{cursor:pointer}.MapboxSearch{--width:0;display:none}.Results{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);min-width:var(--minWidth);overflow-y:auto;position:absolute;transform:translateZ(0);transition:visibility var(--duration);width:var(--width);z-index:1000}.Results:not([aria-hidden=true]){visibility:visible}.Results[aria-hidden=true]{animation:fadein var(--duration) var(--curve) reverse forwards;visibility:hidden}.Suggestion{align-items:center;display:flex;padding:var(--padding)}.Suggestion:hover{cursor:pointer}.Suggestion[aria-selected=true]{background-color:var(--colorBackgroundHover)}.Suggestion:active{background-color:var(--colorBackgroundActive)}.SuggestionName{font-weight:var(--fontWeightBold)}.SuggestionIcon{margin-right:6px}.SuggestionIcon[aria-hidden=true]{display:none}.ResultsAttribution{padding:var(--paddingFooterLabel)}.ResultsAttribution a{color:var(--colorSecondary)}.ResultsAttribution a:not(:hover){text-decoration:none}.ResultsList{list-style:none;margin:0;padding:0}.Label{display:none}.Geocoder,.SearchBox{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--padding);padding-bottom:0;padding-top:0;position:relative;width:100%}.SearchIcon{fill:#757575;left:.5em}.ActionIcon,.SearchIcon{bottom:0;height:20px;margin:auto 0;position:absolute;top:0;width:20px}.ActionIcon{right:.5em}.ActionIcon>button{background:none;border:none;color:inherit;cursor:pointer;font:inherit;height:100%;outline:inherit;padding:0;width:100%}.ActionIcon>button:hover{background:none!important}.ClearBtn{display:none}.ClearBtn:hover{color:#909090}.LoadingIcon{-moz-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;-webkit-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;display:none;height:100%}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.Input{background-color:transparent;border:0;color:#404040;color:rgba(0,0,0,.75);font:inherit;height:36px;margin:0;overflow:hidden;padding:0 40px;text-overflow:ellipsis;white-space:nowrap;width:100%}.Input::-ms-clear{display:none}.Input:focus{border:thin dotted;border-radius:var(--borderRadius);box-shadow:none;color:#404040;color:rgba(0,0,0,.75);outline:0}mapbox-address-confirmation-feature[aria-hidden=true],mapbox-address-confirmation-no-feature[aria-hidden=true]{display:none}.MapboxAddressConfirmation{align-items:center;background-color:var(--colorBackdrop);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;transform:translateZ(0);z-index:1000}.MapboxAddressConfirmation:not([aria-hidden=true]){animation:fadein var(--duration) var(--curve) forwards;visibility:visible}.MapboxAddressConfirmation[aria-hidden=true]{visibility:hidden}.ContentFeature,.ContentNoFeature{width:var(--minWidth)}.Modal{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--paddingModal);width:100%}@media screen and (max-width:480px){.MapboxAddressConfirmation{align-items:flex-end}.ContentFeature,.ContentNoFeature{width:100%}.Modal{border-bottom-left-radius:0;border-bottom-right-radius:0}}.ModalHeader{align-items:center;color:var(--colorPrimary);display:flex;font-size:var(--unitHeader);font-weight:var(--fontWeightBold);margin-bottom:var(--spacing);user-select:none;width:100%}.ModalMap{height:calc(var(--minWidth)*9/16);margin-left:calc(var(--paddingModal)*-1);width:calc(100% + var(--paddingModal)*2)}.ModalMap[aria-hidden=true]{display:none}.Icon{height:var(--unitHeader);width:var(--unitHeader)}.Icon.IconClose{color:var(--colorSecondary)}.ModalHeaderTitle{flex:1;margin-left:.25em}.ModalFooter{color:var(--colorSecondary);margin-top:var(--spacing);text-align:center}.ModalFooter[aria-hidden=true]{display:none}.ModalSubheader{font-weight:var(--fontWeightBold);user-select:none}.ModalDescription{color:var(--colorPrimary)}.ModalAddress,.ModalSubheader{margin-bottom:var(--spacing)}.ModalAddress.ModalAddressApprove{color:var(--colorPrimary)}.Button{border-radius:var(--borderRadius);cursor:pointer;font-weight:var(--fontWeightSemibold);margin-top:var(--spacing);padding:var(--padding);text-align:center;user-select:none;width:100%}.Button[aria-hidden=true]{display:none}.Button.ButtonPrimary{background-color:var(--colorPrimary);color:var(--colorBackground)}.Button.ButtonSecondary{border:1px solid var(--colorSecondary);color:var(--colorSecondary)}@keyframes fadein{0%{opacity:0}to{opacity:1}}.MapboxAddressMinimap{font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight)}.MapboxAddressMinimap[aria-hidden=true]{display:none}.MinimapImageContainer{border-radius:var(--borderRadius);overflow:hidden}.MinimapImage{height:unset;max-height:unset;max-width:unset;position:relative;width:unset}.MinimapInnerFrame{border:var(--border);border-radius:inherit;height:inherit;left:0;overflow:hidden;position:absolute;top:0;width:inherit}.MinimapMarker{left:50%;position:absolute;top:50%}.MinimapMarker>svg{color:var(--colorPrimary);display:block!important}.MinimapAttributionLogo{bottom:0;left:0;margin:0 0 6px 6px;position:absolute}.MinimapAttributionLogo a{cursor:pointer;display:block;height:23px;width:88px}.MinimapAttributionText{background-color:hsla(0,0%,100%,.65);bottom:0;font:11px/16px Helvetica Neue,Arial,Helvetica,sans-serif;padding:0 5px;position:absolute;right:0}.MinimapAttributionText a{color:rgba(0,0,0,.75);text-decoration:none}.MinimapAttributionText a:hover{color:inherit;text-decoration:underline}.MinimapAttributionText a:not(:first-child){margin-left:3px}.MinimapStyleToggle{background-position:0;background-repeat:no-repeat;background-size:contain;border:2px solid #fff;border-radius:3px;box-shadow:var(--boxShadow);cursor:pointer;height:2em;position:absolute;right:var(--spacing);top:var(--spacing);width:2em}.MinimapFooter{color:var(--colorSecondary);font-family:var(--fontFamily);font-size:var(--unit);margin-top:var(--spacing)}.MinimapFooter[aria-hidden=true]{display:none}.MinimapEditButtons{bottom:26px;display:flex;font-family:var(--fontFamily);position:absolute;right:var(--spacing)}.MinimapEditButtons .Button{box-shadow:var(--boxShadow)}.MinimapButtonCancel{background-color:var(--colorBackground);margin-left:var(--spacing)}.draggable{cursor:move;cursor:grab}.draggable:active{cursor:grabbing}",Gi=class extends CustomEvent{constructor(e,t){super(e,{composed:!0,detail:t})}clone(e){const t=new Gi(this.type,this.detail);return e&&Object.defineProperty(t,"target",{value:e}),t}},DKe="Type in 2 or more characters for results.",LKe="When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.",NKe="No search results.",zKe=(e,t,r)=>`${t} ${t===1?"result is":"results are"} available. ${e}. ${r} of ${t} is selected.`,jKe=e=>`${e} ${e===1?"result is":"results are"} available. Use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.`;function _ce(e){const t=e.currentTarget;(e.key===" "||e.key==="Enter")&&(e.preventDefault(),e.stopPropagation(),t.dispatchEvent(new MouseEvent("click",{bubbles:!0,composed:!0})))}var xce="search-listbox__description",JU=e=>{const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.setAttribute("role","status"),t.setAttribute("style","border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;margin-bottom: -1px;margin-right: -1px;overflow: hidden;padding: 0px;position: absolute;white-space: nowrap;width: 1px;");const r=document.createElement("div");return r.setAttribute("id",`${e}--${xce}`),t.appendChild(r),t},cY=(e,t)=>{var r;const n=(r=document.body.querySelector(`[id="${t}--${xce}"]`))!=null?r:null;n&&(n.textContent=e)},FKe=e=>{e.name=e.name+" address-search",e.setAttribute("data-lpignore","true")},BKe=(e,t,r)=>{let n=null;const a=!t||t.length===0;if((e==null?void 0:e.length)<2)n=DKe+" "+LKe;else if(a)n=NKe;else if(r!==void 0){const l=t[r],h=l.name||l.feature_name||l.properties.name;n=zKe(h,t.length,r+1)}else n=jKe(t.length);return n},A4=(e,t)=>{switch(t){case 0:return e.matching_name||e.feature_name||e.address_line1;case 2:return e.name;case 1:return e.properties.name;default:return""}},$Ke=(e,t)=>{switch(t){case 0:return e.description;case 2:return e.feature_type==="poi"?e.full_address:e.place_formatted;case 1:return e.properties.place_formatted;default:return""}};function VN(e,t){return`${e}-${t}`}var as,Os,iS,xh,oS,EM,aS,AM,C4,M4,bce,CM,MM,PM,XS,sS,j_,IM,o2=class extends $m{constructor(){super(...arguments),Pt(this,AM),Pt(this,M4),this.suggestions=null,Pt(this,as,null),Pt(this,Os,void 0),Pt(this,iS,void 0),Pt(this,xh,void 0),Pt(this,oS,void 0),Pt(this,EM,null),Pt(this,aS,void 0),Pt(this,CM,{}),Pt(this,MM,{}),Pt(this,PM,e=>{const{Results:t}=ue(this,Os),r=e.target;if(r.dataset.mapboxSuccess){delete r.dataset.mapboxSuccess;return}const n=r.value;this.renderAriaMessage(),t.setAttribute("aria-busy","true"),this.dispatchEvent(new Gi("input",{lastInput:e.data,inputText:n}))}),this.renderAriaMessage=()=>{var e;const t=BKe((e=this.input)==null?void 0:e.value,this.suggestions,this.selectedIndex);cY(t,this.dataset.seed)},this.clearAriaMessage=()=>{cY("",this.dataset.seed)},this.handleSuggest=e=>{if(this.suggestions=e,(!e||e.length===0)&&this.renderAriaMessage(),!e){this.hideResults();return}ZS(this,M4,bce).call(this),e.length&&ZS(this,AM,C4).call(this);const{Results:t}=ue(this,Os);t.setAttribute("aria-busy","false")},this.handleError=()=>{const{Results:e}=ue(this,Os);e.setAttribute("aria-busy","false"),this.hideResults()},Pt(this,XS,(e,t)=>zx(this,null,function*(){const r=this.input;r&&(r.dataset.mapboxSuccess="true");const n={suggestion:e,selectedIndex:t};this.dispatchEvent(new Gi("select",n)),this.hideResults()})),Pt(this,sS,()=>{const e=this.input;delete e.dataset.mapboxSuccess,this.dispatchEvent(new Gi("focus")),this.renderAriaMessage(),ZS(this,AM,C4).call(this)}),Pt(this,j_,()=>{document.activeElement!==this.input&&(this.dispatchEvent(new Gi("blur")),this.clearAriaMessage(),this.hideResults())}),this.handleArrowUp=()=>{this.selectedIndex===void 0?this.selectedIndex=this.suggestions.length-1:this.selectedIndex===0?this.selectedIndex=void 0:this.selectedIndex=Math.max(0,this.selectedIndex-1)},this.handleArrowDown=()=>{this.selectedIndex===void 0?this.selectedIndex=0:this.selectedIndex===this.suggestions.length-1?this.selectedIndex=void 0:this.selectedIndex=Math.min(this.selectedIndex+1,this.suggestions.length-1)},Pt(this,IM,e=>{var t;if((t=this.suggestions)!=null&&t.length){if(e.key==="ArrowDown"){e.preventDefault(),this.handleArrowDown();return}if(e.key==="ArrowUp"){e.preventDefault(),this.handleArrowUp();return}if(e.key==="Escape"){this.hideResults();return}if(this.selectedIndex!==void 0){if(e.key==="Tab"){ue(this,XS).call(this,this.suggestions[this.selectedIndex],this.selectedIndex);return}if(e.key==="Enter"){e.preventDefault(),ue(this,XS).call(this,this.suggestions[this.selectedIndex],this.selectedIndex);return}}}})}get template(){return yKe}get templateStyle(){return ov}get templateUserStyle(){return Cl(".MapboxSearch",this.theme)}get input(){return ue(this,oS)}set input(e){const t=ue(this,oS);t&&(t.removeEventListener("input",ue(this,PM)),t.removeEventListener("focus",ue(this,sS)),t.removeEventListener("blur",ue(this,j_)),t.removeEventListener("keydown",ue(this,IM)),ue(this,as)&&ue(this,as).destroy()),e&&(e.addEventListener("input",ue(this,PM)),e.addEventListener("focus",ue(this,sS)),e.addEventListener("blur",ue(this,j_)),e.addEventListener("keydown",ue(this,IM)),e.setAttribute("role","combobox"),e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-controls",ue(this,xh)),this.isConnected&&wr(this,as,new lY(e,ue(this,Os).Results,this.popoverOptions))),wr(this,oS,e)}get searchService(){return ue(this,EM)}set searchService(e){wr(this,EM,e)}get selectedIndex(){return ue(this,aS)}set selectedIndex(e){const t=ue(this,aS);wr(this,aS,e);const{ResultsList:r}=ue(this,Os),n=VN(ue(this,xh),e);if(e!==void 0?(this.input.setAttribute("aria-activedescendant",n),r.setAttribute("aria-activedescendant",n)):(this.input.removeAttribute("aria-activedescendant"),r.removeAttribute("aria-activedescendant")),t!==e){const a=VN(ue(this,xh),t),l=r.querySelector(`#${a}`);if(l==null||l.removeAttribute("aria-selected"),l==null||l.setAttribute("tabindex","-1"),e!==void 0){const h=r.querySelector(`#${n}`);h==null||h.setAttribute("aria-selected","true"),h==null||h.setAttribute("tabindex","0")}}this.renderAriaMessage()}hideResults(){const{Results:e,ResultsList:t}=ue(this,Os);e.setAttribute("aria-hidden","true"),this.input.setAttribute("aria-expanded","false"),t.removeAttribute("aria-activedescendant"),this.input.removeAttribute("aria-activedescendant")}renderItem(e){const t=this.prepareTemplate(vKe);return t.id=VN(ue(this,xh),e),t}fillItem(e,t,r,n){const a=e.querySelector('[class$="SuggestionIcon"]'),l=e.querySelector('[class$="SuggestionName"]'),h=e.querySelector('[class$="SuggestionDesc"]');this.searchService===0?(a.innerHTML=Oc(t.accuracy==="street"?"street":"addressMarker",this.theme),a.removeAttribute("aria-hidden")):a.setAttribute("aria-hidden","true"),l.textContent=h.textContent="",l.textContent=A4(t,this.searchService),h.textContent=$Ke(t,this.searchService),r===this.selectedIndex?e.setAttribute("aria-selected","true"):e.removeAttribute("aria-selected"),e.setAttribute("aria-posinset",(r+1).toString()),e.setAttribute("aria-setsize",n.toString())}get theme(){return ue(this,CM)}set theme(e){wr(this,CM,e),!(!ue(this,Os)||!e)&&this.updateTemplateUserStyle(Cl(".MapboxSearch",e))}get popoverOptions(){return ue(this,MM)}set popoverOptions(e){wr(this,MM,e),ue(this,as)&&(ue(this,as).options=e,ue(this,as).update())}connectedCallback(){super.connectedCallback(),this.dataSeed=this.dataset.seed,wr(this,iS,this.dataset.seed+"-Label"),wr(this,xh,this.dataset.seed+"-ResultsList"),this.input&&this.input.setAttribute("aria-controls",ue(this,xh)),wr(this,Os,iv(this,{MapboxSearch:".MapboxSearch",Results:".Results",ResultsList:".ResultsList",Label:".Label"}));const{Results:e,ResultsList:t,Label:r}=ue(this,Os);r.id=ue(this,iS),t.id=ue(this,xh),t.setAttribute("aria-labelledby",ue(this,iS)),e.addEventListener("blur",ue(this,j_)),!ue(this,as)&&this.input&&wr(this,as,new lY(this.input,ue(this,Os).Results,this.popoverOptions)),requestAnimationFrame(()=>{ue(this,as)&&ue(this,as).update()})}disconnectedCallback(){this.input=null;const{Results:e}=ue(this,Os);e.removeEventListener("blur",ue(this,j_)),ue(this,as)&&ue(this,as).destroy()}focus(){document.activeElement===this.input?ue(this,sS).call(this):this.input.focus()}blur(){this.input.blur()}updatePopover(){ue(this,as)&&ue(this,as).update()}};as=new WeakMap;Os=new WeakMap;iS=new WeakMap;xh=new WeakMap;oS=new WeakMap;EM=new WeakMap;aS=new WeakMap;AM=new WeakSet;C4=function(){if(!this.suggestions||!this.suggestions.length)return;const{Results:e,MapboxSearch:t}=ue(this,Os),r=this.input.getBoundingClientRect();t.style.setProperty("--width",`${r.width}px`),t.style.setProperty("display","block"),this.input.setAttribute("aria-expanded","true"),e.removeAttribute("aria-hidden"),this.selectedIndex=void 0};M4=new WeakSet;bce=function(){const{ResultsList:e}=ue(this,Os);if(!this.suggestions||!this.suggestions.length){e.innerHTML="",this.hideResults();return}const t=sKe(e);if(this.suggestions.length>t.length)for(let r=t.length;r<this.suggestions.length;r++){const n=this.renderItem(r);t.push(n),n.onmouseenter=()=>{this.selectedIndex=r},n.onmouseleave=()=>{this.selectedIndex=void 0},e.appendChild(n)}if(this.suggestions.length<t.length)for(let r=this.suggestions.length;r<t.length;r++)t[r].remove();for(let r=0;r<this.suggestions.length;r++){const n=this.suggestions[r],a=t[r];this.fillItem(a,n,r,this.suggestions.length),a.onclick=()=>{ue(this,XS).call(this,n,r)}}};CM=new WeakMap;MM=new WeakMap;PM=new WeakMap;XS=new WeakMap;sS=new WeakMap;j_=new WeakMap;IM=new WeakMap;window.MapboxSearchListbox=o2;window.customElements.get("mapbox-search-listbox")||customElements.define("mapbox-search-listbox",o2);var UKe=new Set(["street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code"]),VKe=new Set(["off","on","true","false"]);function wce(e){let t=e.parentNode;for(;t;){if(t instanceof HTMLFormElement)return t;t=t.parentNode}return null}function WKe(e){const t=e||document;return Array.from(t.querySelectorAll('input[autocomplete~="address-line1"], input[autocomplete~="street-address"]'))}var GKe="section-",qKe="section-default",HKe="section-shipping",ZKe="section-billing";function QU(e){const t=Array.from(e.querySelectorAll("[autocomplete]")).filter(n=>{const a=n.tagName.toLowerCase();return a==="input"||a==="select"||a==="textarea"}),r=[];for(const n of t){if(!cKe(n))continue;const a=n.getAttribute("autocomplete")||"";if(!a||VKe.has(a))continue;const l=a.toLowerCase().split(" ");if(l.length>3)continue;const h=l[l.length-1];if(!UKe.has(h))continue;l.pop();let i=qKe;if(l.length){const _=l[l.length-1];_==="shipping"&&(i=HKe,l.pop()),_==="billing"&&(i=ZKe,l.pop())}if(l.length){const _=l[l.length-1];_.startsWith(GKe)&&(i=_)}r.push({input:n,section:i,field:h})}return r}function a2(e,t){const r=[],n=[],a=QU(e);let l=null;for(const{input:h,section:i,field:_}of a){let b=r.length-1,E=!1;if(r.length?(n[b]!==i||r[b][_])&&(E=!0):E=!0,E){if(l)break;r.push({[_]:h}),n.push(i),b++}else r[b][_]=h;h===t&&(l=r[b])}return l??{}}function Sce(e,t,r){var n;const a=a2(e,t),l=[r.address_line1,r.address_line2,r.address_line3].filter(i=>!!i).join(", ");hd(a["street-address"],a["address-line2"]?r.address_line1||"":l),hd(a["address-line1"],r.address_line1||""),hd(a["address-line2"],r.address_line2||""),hd(a["address-level1"],r.address_level1||""),hd(a["address-level2"],r.address_level2||""),hd(a["address-level3"],r.address_level3||"");const h=r.country_code||((n=r.metadata)==null?void 0:n.iso_3166_1)||"";if(a.country&&a.country instanceof HTMLSelectElement){let i=a.country.querySelector("option").value;i===""&&(i=a.country.querySelectorAll("option")[1].value);const _=i===i.toUpperCase();hd(a.country,_?h.toUpperCase():h)}else hd(a.country,h);hd(a["country-name"],r.country||""),hd(a["postal-code"],r.postcode||"")}function XKe(e,t){const r=a2(e,t),n={};for(const[a,l]of Object.entries(r))l!=null&&l.value&&(n[a]=l.value);return n}function Tce(e){const t=[];return e["street-address"]?t.push(e["street-address"]):t.push(e["address-line1"]||""),t.push(e["address-line2"]||""),t.push(e["address-line3"]||""),t.push(e["address-level3"]||""),t.push(e["address-level2"]||""),t.push(e["address-level1"]||""),t.push(e["postal-code"]||""),e["country-name"]?t.push(e["country-name"]):t.push(e.country||""),t.filter(r=>!!r).map(r=>r.trim()).join(", ")}function Ece(e,t){const r=wce(t);if(!r)return;const n=VU(e);Sce(r,t,n);const a=a2(r,t);a["address-line2"]&&!n.address_line2&&a["address-line2"].focus()}function YKe(e){var t;const r={},n=[e.properties.address_line1,e.properties.address_line2,e.properties.address_line3].filter(a=>!!a).join(", ");return r["street-address"]=n,r["address-line1"]=e.properties.address_line1,r["address-line2"]=e.properties.address_line2,r["address-line3"]=e.properties.address_line3,r["address-level1"]=e.properties.address_level1,r["address-level2"]=e.properties.address_level2,r["address-level3"]=e.properties.address_level3,r.country=(t=e.properties.metadata)==null?void 0:t.iso_3166_1,r["country-name"]=e.properties.country,r["postal-code"]=e.properties.postcode,r}function KKe(e,t){for(const[r,n]of Object.entries(e))if(t[r]!==n)return!0;return!1}var JKe=e=>e.filter((t,r,n)=>{const a=A4(t,0);return t.accuracy!=="street"||n.findIndex(l=>a===A4(l,0))===r}),p0=(e,t,r)=>{const l=r?t||"address-line1":"new-password";e&&(e.autocomplete=l)},QKe=(e,t,r)=>{if(!e||!r)return;p0(e,t,!0);const n={properties:tc(ei({},r),{address_line1:r.address_line1+" ",postcode:null})};Ece(n,e),p0(e,t,!1),e==null||e.focus()},eJe=class{constructor(){this.feedbackEnabled=!0,this.autofillSessionToken=new jc,this.autofillSessionEnabled=!1,this.detectBrowserAutofillEnabled=!1}},Du=new eJe;Object.defineProperty(Du,"autofillSessionToken",{configurable:!1,writable:!1});var tJe=oc(`
<template>
  <div class="MapboxAddressConfirmation" aria-hidden="true">
    <mapbox-address-confirmation-feature class="ContentFeature"></mapbox-address-confirmation-feature>
    <mapbox-address-confirmation-no-feature class="ContentNoFeature"></mapbox-address-confirmation-no-feature>
  </div>
</template>
`),OM,bc,F_,kM,e6=class extends $m{constructor(){super(...arguments),Pt(this,OM,!1),Pt(this,bc,void 0),Pt(this,F_,void 0),Pt(this,kM,{})}get template(){return tJe}get templateStyle(){return ov}get templateUserStyle(){return Cl(".MapboxAddressConfirmation",this.theme)}get theme(){return ue(this,kM)}set theme(e){if(wr(this,kM,e),!ue(this,bc)||!e)return;this.updateTemplateUserStyle(Cl(".MapboxAddressConfirmation",e));const{ContentFeature:t,ContentNoFeature:r}=ue(this,bc);t.theme=e,r.theme=e}connectedCallback(){super.connectedCallback(),wr(this,bc,iv(this,{MapboxAddressConfirmation:".MapboxAddressConfirmation",ContentFeature:".ContentFeature",ContentNoFeature:".ContentNoFeature"}));const{MapboxAddressConfirmation:e}=ue(this,bc);e.setAttribute("aria-hidden","true");const t=this.theme;if(t){const{ContentFeature:r,ContentNoFeature:n}=ue(this,bc);r.theme=t,n.theme=t}}disconnectedCallback(){wr(this,F_,null)}hide(){var e;if(wr(this,OM,!1),!ue(this,bc))return;const{MapboxAddressConfirmation:t}=ue(this,bc);t.setAttribute("aria-hidden","true"),(e=ue(this,F_))==null||e.deactivate(),YX.off()}show(e,t,r){return zx(this,null,function*(){var n;if(!ue(this,bc))return{type:"cancel"};const{MapboxAddressConfirmation:a,ContentFeature:l,ContentNoFeature:h}=ue(this,bc),{accessToken:i,minimap:_=!1,theme:b,footer:E}=t;this.theme=b,r?(l.removeAttribute("aria-hidden"),h.setAttribute("aria-hidden","true"),l.minimap=_,l.accessToken=i,l.footer=E,l.update(r,e)):(l.setAttribute("aria-hidden","true"),h.removeAttribute("aria-hidden"),h.update(e)),wr(this,OM,!0),a.removeAttribute("aria-hidden"),YX.on();const C=r?l:h;return wr(this,F_,JYe(a,{fallbackFocus:C,escapeDeactivates:()=>(this.hide(),!0)})),(n=ue(this,F_))==null||n.activate(),new Promise(I=>{const F=C,$=B=>{F.removeEventListener("result",$);const q=B.detail;this.hide(),I(q==="change"?{type:"change",feature:r}:{type:q})};F.addEventListener("result",$)})})}tryShow(e,t){return zx(this,null,function*(){if(!ue(this,bc))return{type:"cancel"};const{accessToken:r,options:n={}}=t,a=new qle(ei({accessToken:r},n)),l=Tce(e),i=(yield a.validate(l,{sessionToken:Du.autofillSessionToken})).features[0];if(i){const _=E=>E.properties.match_code.confidence===Zle.exact,{skipConfirmModal:b=_}=t;if(b(i))return{type:"nochange"}}return yield this.show(e,t,i)})}};OM=new WeakMap;bc=new WeakMap;F_=new WeakMap;kM=new WeakMap;window.MapboxAddressConfirmation=e6;window.customElements.get("mapbox-address-confirmation")||customElements.define("mapbox-address-confirmation",e6);var WN=new e6;function rJe(e){return zx(this,arguments,function*(t,r={}){var n;const{sections:a=[]}=r;WN.parentNode||document.body.appendChild(WN);let l={type:"nochange"};const h=WKe(t),i=QU(t),_=Array.from(document.querySelectorAll("mapbox-search-listbox"));for(const b of h){if(a.length){const B=i.find(q=>q.input===b);if(!B||!a.includes(B.section))continue}const E=XKe(t,b),C=_.find(B=>B.input===b),I=C==null?void 0:C.autofillHost;if(I){const B=I.retrieveFeature;if(B){const q=YKe(B);if(!KKe(E,q))continue}}const F=r.accessToken||Du.accessToken,$=yield WN.tryShow(E,tc(ei({},r),{accessToken:F}));if($.type==="change"){const B=a2(t,b);if((n=B["address-line2"])!=null&&n.value&&($.feature.properties.address_line2=B["address-line2"].value),C)I.simulateRetrieve($.feature);else{b.dataset.mapboxSuccess="true";const q=VU($.feature);Sce(t,b,q)}}$.type==="change"&&l.type!=="cancel"&&(l=$),$.type==="cancel"&&(l=$)}return l})}function Ace(e,t,r,n,a){if(t){const l=oc(`
        <span>
          <span></span>
          <br />
          <span></span>
        </span>
      `),[h,i]=Array.from(l.querySelectorAll("span > span"));if(r&&n)h.textContent=r,i.textContent=n;else{const _=t.split(",");h.textContent=_[0].trim(),i.textContent=_.slice(1).join(",").trim()}if(!a){if(e["address-line2"]){const _=document.createElement("span");_.textContent=e["address-line2"],l.insertBefore(_,i),l.insertBefore(document.createElement("br"),i)}if(e["address-line3"]){const _=document.createElement("span");_.textContent=e["address-line3"],l.insertBefore(_,i),l.insertBefore(document.createElement("br"),i)}}return l}else{const l=e["street-address"]||e["address-line1"]||"",h=e["address-line2"],i=e["address-line3"],_=[e["address-level4"]||"",e["address-level3"]||"",e["address-level2"]||"",`${e["address-level1"]||""} ${e["postal-code"]||""}`,e.country||e["country-name"]||""].filter(Boolean).join(", "),E=[l,h,i,_].filter(Boolean).map(I=>`<span>${I}</span>`).join("<br />");return oc(`
        <span>${E}</span>
      `)}}function nJe(e,t,r,n){return zx(this,null,function*(){if(!r)return;const a=wce(e),l=Object.values(a2(a,e));if(!t.detail.elements.some(I=>l.includes(I)))return;const h=QU(a),_=h.find(I=>I.input===e).section,b=Array.from(new Set(h.filter(I=>t.detail.elements.includes(I.input)).map(I=>I.section)));if(!b.includes(_))return;const E=typeof r=="object"&&r.sections||[];if(E.length&&!E.some(I=>b.includes(I)))return;let C=typeof r=="object"?r:{};C=tc(ei({},C),{accessToken:n,sections:[_]}),yield rJe(a,C)})}var iJe="https://contribute-api.mapbox.com/v1",oJe="https://contribute-api-staging.tilestream.net/v1",aJe="edit-suggestion";function Cce(e,t){if(!Du.feedbackEnabled)return;const r=window.location.hostname,a=`${bKe(r)||wKe(r)?oJe:iJe}/${aJe}/address?access_token=${e}`,{originalCoordinate:l,originalAddress:h,changes:i}=t,_={action:"update",reason:"incorrect_address",location:{longitude:l[0],latitude:l[1]},userEmail:"no-reply-autofill@mapbox.com",changes:i,placeName:h};fetch(a,{method:"POST",headers:new Headers({"User-Agent":`mapbox-search-js.${XR}.${navigator.userAgent}`,"Content-Type":"application/json"}),body:JSON.stringify(_)})}var sJe=oc(`
<template>
  <div class="MapboxAddressConfirmationFeature">
    <div class="Modal" aria-modal="true" role="dialog">
      <div class="ModalHeader">
        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>
        <div class="ModalHeaderTitle">Did you mean?</div>
        <svg
          viewBox="0 0 18 18"
          class="Icon IconClose"
          tabindex="0"
          role="button"
          title="Close"
          aria-label="Close"
          aria-expanded="true"
        ></svg>
      </div>

      <div class="ModalAddress ModalAddressApprove"></div>
            
      <div class="ModalMap">
        <mapbox-address-minimap class="Minimap"></mapbox-address-minimap>
      </div>

      <div
        class="Button ButtonPrimary ButtonApprove"
        tabindex="0"
        role="button"
        aria-label="Yes"
      >
        Yes
      </div>
      
      <div
        class="Button ButtonSecondary ButtonReject"
        tabindex="0"
        role="button"
        aria-label="No, use the address I provided"
      >
        No, use the address I provided
      </div>

      <div class="ModalFooter">
          Your confirmation helps improve address data accuracy.
      </div>
    </div>
  </div>
</template>
`),bh,RM,lS,DM,LM,NM,zM,jM,Mce=class extends $m{constructor(){super(...arguments),Pt(this,bh,void 0),Pt(this,RM,{}),this.minimap=!1,Pt(this,lS,void 0),Pt(this,DM,void 0),this.update=(e,t)=>{var r;wr(this,lS,e),wr(this,DM,t);const{ModalMap:n,Minimap:a,ModalAddressApprove:l}=ue(this,bh);if(this.minimap){if(n.removeAttribute("aria-hidden"),a.accessToken=this.accessToken,typeof this.minimap=="object"){const{defaultMapStyle:i,theme:_,mapStyleMode:b,satelliteToggle:E}=this.minimap;i&&(a.defaultMapStyle=this.minimap.defaultMapStyle),_&&(a.theme=this.minimap.theme),b&&(a.mapStyleMode=b),E!==void 0&&(a.satelliteToggle=E)}a.feature=e}else n.setAttribute("aria-hidden","true");const h=e.properties.place_name||e.properties.full_address||e.properties.address;l.innerHTML="",l.appendChild(Ace(t,h,e.properties.feature_name,e.properties.description,((r=e.properties.place_type)==null?void 0:r[0])==="secondary_address"))},Pt(this,LM,()=>{this.dispatchEvent(new Gi("result","cancel"))}),this.approve=()=>{this.dispatchEvent(new Gi("result","change"))},this.reject=()=>{this.dispatchEvent(new Gi("result","nochange")),Cce(this.accessToken,{originalCoordinate:ue(this,lS).geometry.coordinates,originalAddress:ue(this,lS).properties.full_address,changes:{address:Tce(ue(this,DM))}})},Pt(this,NM,Sy()),Pt(this,zM,Sy()),Pt(this,jM,Sy())}get template(){return sJe}get templateStyle(){return ov}get templateUserStyle(){return Cl(".MapboxAddressConfirmationFeature",this.theme)}get theme(){return ue(this,RM)}set theme(e){if(wr(this,RM,e),!ue(this,bh)||!e)return;this.updateTemplateUserStyle(Cl(".MapboxAddressConfirmationFeature",e));const{IconQuestion:t,IconClose:r}=ue(this,bh);t.innerHTML=Oc("question",e),r.innerHTML=Oc("close",e)}set footer(e){if(e===void 0)return;const t=this.querySelector(".ModalFooter");typeof e=="string"?(t.textContent=e,t.removeAttribute("aria-hidden")):e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback(),wr(this,bh,iv(this,{MapboxAddressConfirmationFeature:".MapboxAddressConfirmationFeature",Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",ModalMap:".ModalMap",Minimap:".Minimap",IconQuestion:".IconQuestion",IconClose:".IconClose",ButtonApprove:".ButtonApprove",ButtonReject:".ButtonReject",ModalAddressApprove:".ModalAddressApprove"}));const{Modal:e,ModalHeaderTitle:t,IconClose:r,ButtonApprove:n,ButtonReject:a,ModalAddressApprove:l}=ue(this,bh);e.setAttribute("aria-labelledby",ue(this,zM)),e.setAttribute("aria-describedby",ue(this,jM)),r.setAttribute("aria-controls",ue(this,NM)),e.id=ue(this,NM),t.id=ue(this,zM),l.id=ue(this,jM);const h=Array.from(this.querySelectorAll('[role="button"]'));for(const _ of h)_.addEventListener("keydown",_ce);r.addEventListener("click",ue(this,LM)),n.addEventListener("click",this.approve),a.addEventListener("click",this.reject);const i=this.theme;if(i){const{IconQuestion:_,IconClose:b}=ue(this,bh);_.innerHTML=Oc("question",i),b.innerHTML=Oc("close",i)}}disconnectedCallback(){const{IconClose:e,ButtonApprove:t}=ue(this,bh);e.removeEventListener("click",ue(this,LM)),t.removeEventListener("click",this.approve)}};bh=new WeakMap;RM=new WeakMap;lS=new WeakMap;DM=new WeakMap;LM=new WeakMap;NM=new WeakMap;zM=new WeakMap;jM=new WeakMap;window.MapboxAddressConfirmationFeature=Mce;window.customElements.get("mapbox-address-confirmation-feature")||customElements.define("mapbox-address-confirmation-feature",Mce);var lJe=oc(`
<template>
  <div class="MapboxAddressConfirmationNoFeature">
    <div class="Modal" aria-modal="true" role="dialog">
      <div class="ModalHeader">
        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>
        <div class="ModalHeaderTitle">Confirm address</div>
        <svg
          viewBox="0 0 18 18"
          class="Icon IconClose"
          tabindex="0"
          role="button"
          title="Close"
          aria-label="Close"
          aria-expanded="true"
        ></svg>
      </div>
      <div class="ModalDescription">
        We couldn't verify this address. Please check that your information is correct before continuing.
      </div>
      <br />
      <div class="ModalSubheader">
        You entered
      </div>
      <div class="ModalAddress"></div>
      <div
        class="Button ButtonPrimary"
        tabindex="0"
        role="button"
        aria-label="Use the address I provided"
      >
        Use the address I provided
      </div>
    </div>
  </div>
</template>
`),wh,FM,BM,$M,UM,VM,Pce=class extends $m{constructor(){super(...arguments),Pt(this,wh,void 0),Pt(this,FM,{}),this.update=e=>{const{ModalAddress:t}=ue(this,wh);t.innerHTML="",t.appendChild(Ace(e))},Pt(this,BM,()=>{this.dispatchEvent(new Gi("result","cancel"))}),this.reject=()=>{this.dispatchEvent(new Gi("result","nochange"))},Pt(this,$M,Sy()),Pt(this,UM,Sy()),Pt(this,VM,Sy())}get template(){return lJe}get templateStyle(){return ov}get templateUserStyle(){return Cl(".MapboxAddressConfirmationNoFeature",this.theme)}get theme(){return ue(this,FM)}set theme(e){if(wr(this,FM,e),!ue(this,wh)||!e)return;this.updateTemplateUserStyle(Cl(".MapboxAddressConfirmationNoFeature",e));const{IconQuestion:t,IconClose:r}=ue(this,wh);t.innerHTML=Oc("question",e),r.innerHTML=Oc("close",e)}connectedCallback(){super.connectedCallback(),wr(this,wh,iv(this,{Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",IconQuestion:".IconQuestion",IconClose:".IconClose",ModalAddress:".ModalAddress",ButtonReject:".Button"}));const{Modal:e,ModalHeaderTitle:t,IconClose:r,ModalAddress:n,ButtonReject:a}=ue(this,wh);e.setAttribute("aria-labelledby",ue(this,UM)),e.setAttribute("aria-describedby",ue(this,VM)),r.setAttribute("aria-controls",ue(this,$M)),e.id=ue(this,$M),t.id=ue(this,UM),n.id=ue(this,VM);const l=Array.from(this.querySelectorAll('[role="button"]'));for(const i of l)i.addEventListener("keydown",_ce);r.addEventListener("click",ue(this,BM)),a.addEventListener("click",this.reject);const h=this.theme;if(h){const{IconQuestion:i,IconClose:_}=ue(this,wh);i.innerHTML=Oc("question",h),_.innerHTML=Oc("close",h)}}disconnectedCallback(){const{IconClose:e,ButtonReject:t}=ue(this,wh);e.removeEventListener("click",ue(this,BM)),t.removeEventListener("click",this.reject)}};wh=new WeakMap;FM=new WeakMap;BM=new WeakMap;$M=new WeakMap;UM=new WeakMap;VM=new WeakMap;window.MapboxAddressConfirmationNoFeature=Pce;window.customElements.get("mapbox-address-confirmation-no-feature")||customElements.define("mapbox-address-confirmation-no-feature",Pce);var cJe='input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{animation-name:onbrowserautofillstart}input:not(:-webkit-autofill),select:not(:-webkit-autofill),textarea:not(:-webkit-autofill){animation-name:onbrowserautofillcancel}@keyframes onbrowserautofillstart{0%{animation-name:"onbrowserautofillstart"}to{animation-name:"onbrowserautofillstart"}}@keyframes onbrowserautofillcancel{0%{animation-name:"onbrowserautofillcancel"}to{animation-name:"onbrowserautofillcancel"}}',KO="browser-autofilled",P4=[];function uJe(){window.dispatchEvent(new window.CustomEvent("browserautofill",{bubbles:!0,cancelable:!0,detail:{elements:P4}})),P4=[]}var dJe=Xle(uJe,5);function Ice(e){e.hasAttribute(KO)||(e.setAttribute(KO,""),P4.push(e),dJe())}function Oce(e){e.hasAttribute(KO)&&e.removeAttribute(KO)}function hJe(e){e.animationName==="onbrowserautofillstart"?Ice(e.target):Oce(e.target)}function fJe(e){const t=e.target;t.nodeName.toLowerCase()!=="select"&&!e.simulated&&!(e instanceof Gi)&&(e.inputType==="insertReplacementText"||!("data"in e))?Ice(t):Oce(t)}function pJe(){Du.detectBrowserAutofillEnabled||(Du.detectBrowserAutofillEnabled=!0,uKe(cJe),document.addEventListener("animationstart",hJe,!0),document.addEventListener("input",fJe,!0))}var t6=(e,t)=>{if(typeof e=="string")if(e==="ip"){const r=t==null?void 0:t.get("ip-proximity");return r&&typeof r=="string"?r.split(",").map(parseFloat):[999,999]}else return e.split(",").map(Number);else return Vo.convert(e).toArray()},mJe=e=>{const t={};return e.bbox&&(typeof e.bbox=="string"?t.bbox=e.bbox.split(",").map(Number):t.bbox=Kl.convert(e.bbox).toFlatArray()),e.proximity&&(t.proximity=t6(e.proximity)),e.country&&(t.country=e.country.split(",")),e.language&&(t.language=e.language.split(",")),e.types&&(typeof e.types=="string"?t.types=e.types.split(","):t.types=Array.from(e.types)),e.limit&&(typeof e.limit=="string"?t.limit=parseInt(e.limit):t.limit=e.limit),t},gJe=(e,t)=>{const r={};return e.bbox&&(typeof e.bbox=="string"?r.bbox=e.bbox.split(",").map(Number):r.bbox=Kl.convert(e.bbox).toFlatArray()),e.proximity&&(r.proximity=t6(e.proximity,t)),e.country&&(r.country=e.country.split(",")),e.language&&(r.language=e.language.split(",")),e.types&&(typeof e.types=="string"?r.types=e.types.split(","):r.types=Array.from(e.types)),e.limit&&(typeof e.limit=="string"?r.limit=parseInt(e.limit):r.limit=e.limit),typeof e.autocomplete=="boolean"&&(r.autocomplete=e.autocomplete),e.worldview&&(r.worldview=e.worldview),e.permanent&&(r.permanent=e.permanent),r},yJe=(e,t)=>{const r={};return e.bbox&&(typeof e.bbox=="string"?r.bbox=e.bbox.split(",").map(Number):r.bbox=Kl.convert(e.bbox).toFlatArray()),e.proximity&&(r.proximity=t6(e.proximity,t)),e.country&&(r.country=e.country.split(",")),e.language&&(r.language=e.language.split(",")),e.limit&&(typeof e.limit=="string"?r.limit=parseInt(e.limit):r.limit=e.limit),e.streets!==void 0&&e.streets!==null&&(typeof e.streets=="string"?r.streets=e.streets==="true":r.streets=e.streets),r},vJe=(e,t,r)=>{switch(t){case 2:return mJe(e);case 1:return gJe(e,r);case 0:return yJe(e,r)}},_Je=e=>({suggestionIds:e.map(t=>t.mapbox_id||""),suggestionNames:e.map(t=>t.feature_type==="poi"?[t.name,t.full_address].filter(Boolean).join(", "):t.full_address?t.full_address:t.name),suggestionTypes:e.map(t=>t.feature_type||""),suggestionSources:e.map(()=>"mapbox")}),xJe=e=>({suggestionIds:e.map(t=>t.properties.mapbox_id||t.id||""),suggestionNames:e.map(t=>t.properties.full_address||""),suggestionTypes:e.map(t=>t.properties.feature_type||""),suggestionSources:e.map(()=>"mapbox")}),bJe=e=>({suggestionIds:e.map(t=>t.mapbox_id||""),suggestionNames:e.map(t=>t.full_address||""),suggestionTypes:e.map(t=>{var r;return((r=t.place_type)==null?void 0:r[0])||""}),suggestionSources:e.map(()=>"mapbox")}),wJe=(e,t)=>{switch(t){case 2:return _Je(e);case 1:return xJe(e);case 0:return bJe(e)}},uY=(e,t)=>{switch(e){case 2:return"search/searchbox/v1/suggest";case 1:return`search/geocode/v6/${/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/.test(t)?"reverse":"forward"}`;case 0:return"autofill/v1/suggest"}},I4,O4,Gg,WM,k4,qg,cS,uS,dS,hS,R4,B_,Sh,D4,L4,N4,fS,z4,j4,F4,B4,$4,U4,pS,Hg,mS,r6=class{constructor(e){Pt(this,I4,"https://api.mapbox.com"),Pt(this,O4,"events/v2"),Pt(this,Gg,void 0),Pt(this,WM,void 0),Pt(this,k4,navigator.language||null),Pt(this,qg,[]),Pt(this,cS,""),Pt(this,uS,0),Pt(this,dS,!0),Pt(this,hS,1e3),Pt(this,R4,100),Pt(this,B_,void 0),Pt(this,Sh,void 0),this.start=(t,r,n,a)=>{wr(this,Gg,r.accessToken);const l=ue(this,fS).call(this,"search.start",{queryString:t,options:r,map:n,responseHeaders:a});l&&ue(this,mS).call(this,l)},this.input=(t,r,n,a,l)=>{if(wr(this,Gg,n.accessToken),ue(this,dS)&&(this.start(t,n,a,l),wr(this,dS,!1)),!r)return;const h=ue(this,fS).call(this,"search.keystroke",{lastInput:r,queryString:t,options:n,map:a,responseHeaders:l});h&&ue(this,mS).call(this,h)},this.select=(t,r,n,a,l,h)=>{wr(this,Gg,a.accessToken);const i=ue(this,fS).call(this,"search.select",{queryString:t,selectedIndex:r,suggestions:n,options:a,map:l,responseHeaders:h});i&&(i.resultIndex===ue(this,uS)&&i.queryString===ue(this,cS)||i.resultIndex===-1||(wr(this,uS,i.resultIndex),wr(this,cS,i.queryString),ue(this,mS).call(this,i)))},this.clear=()=>{wr(this,dS,!0),wr(this,cS,""),wr(this,uS,0),ue(this,Hg).call(this)},Pt(this,D4,t=>{const r=`${ue(this,I4)}/${ue(this,O4)}?access_token=${ue(this,Gg)}`,n=ue(this,L4).call(this,t);try{fetch(r,n)}catch(a){ue(this,N4).call(this,a)}}),Pt(this,L4,t=>(Array.isArray(t)||(t=[t]),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})),Pt(this,N4,t=>{console.log(t)}),Pt(this,fS,(t,r)=>{if(t==="search.select"&&!(typeof r.selectedIndex=="number"||r.suggestions)||t==="search.keystroke"&&!r.lastInput)return null;const n=vJe(r.options,ue(this,Sh),r.responseHeaders),a=ue(this,z4).call(this,t,r,n);return t==="search.keystroke"?ue(this,j4).call(this,a,r,n):t==="search.select"&&ue(this,F4).call(this,a,r,n),ue(this,U4).call(this,a)?a:null}),Pt(this,z4,(t,r,n)=>{let a={event:t,version:ue(this,$4).call(this,t),created:+new Date,sessionIdentifier:r.options.sessionToken,userAgent:ue(this,WM),keyboardLocale:ue(this,k4),queryString:r.queryString};if(n&&(a=ei(ei({},a),n)),t==="search.start")for(const l of["streets","permanent"])delete a[l];if(r.map){const l=r.map.getZoom()||void 0,h=r.map.getCenter();a=tc(ei({},a),{mapZoom:l,mapCenterLat:h.lat,mapCenterLng:h.lng})}return a}),Pt(this,j4,(t,r,n)=>{switch(ue(this,Sh)){case 0:n.streets&&(t.streets=n.streets);break;case 1:n.permanent&&(t.permanent=n.permanent);break}t.path=uY(ue(this,Sh),r.queryString),t.lastAction=r.lastInput}),Pt(this,F4,(t,r,n)=>{switch(ue(this,Sh)){case 0:n.streets&&(t.streets=n.streets);break;case 1:n.permanent&&(t.permanent=n.permanent);break}t.path=uY(ue(this,Sh),r.queryString);const{selectedIndex:a,suggestions:l}=r;if(l&&l.length>0){const h=wJe(l,ue(this,Sh));t.resultIndex=a,t.resultPlaceName=h.suggestionNames[a],t.resultId=h.suggestionIds[a],t.resultId.startsWith("dXJuOm1ie")&&(t.resultMapboxId=t.resultId),t.suggestionIds=h.suggestionIds,t.suggestionNames=h.suggestionNames,t.suggestionTypes=h.suggestionTypes,t.suggestionSources=h.suggestionSources}}),Pt(this,B4,()=>`mapbox.${MKe.split("/")[1]}.${XR}.${navigator.userAgent}`),Pt(this,$4,t=>["search.keystroke","search.select"].includes(t)?"2.2":"2.0"),Pt(this,U4,t=>{if(!t||!t.event)return!1;const r=["event","created","sessionIdentifier","queryString"],n=["event","created","sessionIdentifier","queryString","lastAction"],a=["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"],l=t.event;return l==="search.start"?ue(this,pS).call(this,t,r):l==="search.keystroke"?ue(this,pS).call(this,t,n):l==="search.select"?ue(this,pS).call(this,t,a):!0}),Pt(this,pS,(t,r)=>r.every(n=>n==="queryString"?typeof t[n]=="string"&&t[n].length>0:t[n]!==void 0)),Pt(this,Hg,()=>{ue(this,qg).length>0&&ue(this,Gg)&&(ue(this,D4).call(this,ue(this,qg)),wr(this,qg,[])),ue(this,B_)&&clearTimeout(ue(this,B_)),ue(this,hS)&&wr(this,B_,setTimeout(ue(this,Hg),ue(this,hS)))}),Pt(this,mS,(t,r)=>{ue(this,qg).push(t),(ue(this,qg).length>=ue(this,R4)||r)&&ue(this,Hg).call(this)}),this.remove=()=>{ue(this,Hg).call(this)},wr(this,Sh,e),wr(this,WM,ue(this,B4).call(this)),wr(this,B_,setTimeout(ue(this,Hg),ue(this,hS)))}};I4=new WeakMap;O4=new WeakMap;Gg=new WeakMap;WM=new WeakMap;k4=new WeakMap;qg=new WeakMap;cS=new WeakMap;uS=new WeakMap;dS=new WeakMap;hS=new WeakMap;R4=new WeakMap;B_=new WeakMap;Sh=new WeakMap;D4=new WeakMap;L4=new WeakMap;N4=new WeakMap;fS=new WeakMap;z4=new WeakMap;j4=new WeakMap;F4=new WeakMap;B4=new WeakMap;$4=new WeakMap;U4=new WeakMap;pS=new WeakMap;Hg=new WeakMap;mS=new WeakMap;var Sp,il,ol,Di,$_,Tp,gS,GM,qM,yS,HM,ZM,XM,YM,KM,JM,QM,V4,n6=class extends $m{constructor(){super(...arguments),Pt(this,Sp,new $le),Pt(this,il,new UU(ue(this,Sp))),Pt(this,ol,void 0),Pt(this,Di,new o2),Pt(this,$_,new r6(0)),Pt(this,Tp,void 0),this.options={},this.confirmOnBrowserAutofill=!1,Pt(this,gS,!1),Pt(this,GM,e=>{const t=e!=null&&e.suggestions?JKe(e.suggestions):null;ue(this,Di).handleSuggest(t),this.dispatchEvent(new Gi("suggest",e))}),Pt(this,qM,e=>{ue(this,Di).handleError(),this.dispatchEvent(new Gi("suggesterror",e))}),Pt(this,yS,e=>{var t;if(this.dispatchEvent(new Gi("retrieve",e)),this.retrieveFeature=(t=e.features)==null?void 0:t[0],!ue(this,ol))return;const r=e;!r||!r.features||!r.features.length||Ece(r.features[0],ue(this,ol))}),Pt(this,HM,()=>{var e;try{const t=(e=this.querySelector("input"))!=null?e:null;wr(this,ol,t),ue(this,Di).input=t}catch(t){wr(this,ol,null),ue(this,Di).input=null,console.error(t.message||t)}}),Pt(this,ZM,new MutationObserver(ue(this,HM))),Pt(this,XM,e=>{ue(this,Di).blur(),nJe(ue(this,ol),e,this.confirmOnBrowserAutofill,this.accessToken)}),this.retrieveFeature=null,this.interceptSearch=null,Pt(this,YM,e=>{this.dispatchEvent(new Gi("input",e.detail.inputText));const{lastInput:t,inputText:r}=e.detail,n=this.browserAutofillEnabled===!0&&(r==null?void 0:r.length)<=2;if(p0(ue(this,ol),ue(this,Tp),n),!r){ue(this,V4).call(this);return}const a=this.interceptSearch&&this.interceptSearch(r),l=this.interceptSearch?a:r;if(this.interceptSearch&&!a||(l==null?void 0:l.length)<=2){ue(this,Di).handleSuggest(null);return}ue(this,il).suggest(l,this.options),ue(this,$_).input(l,t,tc(ei({},this.options),{sessionToken:ue(this,il).sessionToken,accessToken:this.accessToken}),null,ue(this,Sp).responseHeaders)}),Pt(this,KM,e=>{const{suggestion:t,selectedIndex:r}=e.detail;t.accuracy!=="street"?(p0(ue(this,ol),ue(this,Tp),!0),ue(this,il).retrieve(t,this.options),ue(this,$_).select(this.input.value,r,ue(this,Di).suggestions,tc(ei({},this.options),{sessionToken:ue(this,il).sessionToken,accessToken:this.accessToken}),null,ue(this,Sp).responseHeaders)):QKe(ue(this,ol),ue(this,Tp),t)}),Pt(this,JM,()=>{p0(ue(this,ol),ue(this,Tp),!0),ue(this,il).abort()}),Pt(this,QM,()=>{var e;const t=this.browserAutofillEnabled===!0&&((e=ue(this,ol).value)==null?void 0:e.length)<=2;p0(ue(this,ol),ue(this,Tp),t)}),Pt(this,V4,()=>{ue(this,Di).handleSuggest(null),ue(this,$_).clear()})}get accessToken(){return ue(this,Sp).accessToken}set accessToken(e){ue(this,Sp).accessToken=e}get input(){return ue(this,ol)}get theme(){return ue(this,Di).theme}set theme(e){ue(this,Di).theme=e}get popoverOptions(){return ue(this,Di).popoverOptions}set popoverOptions(e){ue(this,Di).popoverOptions=e}get browserAutofillEnabled(){return ue(this,gS)}set browserAutofillEnabled(e){wr(this,gS,e)}connectedCallback(){var e;super.connectedCallback(),Du.autofillSessionEnabled=!0,ue(this,il).sessionToken=Du.autofillSessionToken.id,ue(this,Di).autofillHost=this,ue(this,Di).searchService=0;const t=(e=this.querySelector("input"))!=null?e:null;ue(this,ZM).observe(this,{subtree:!0,childList:!0}),ue(this,HM).call(this),ue(this,Di).addEventListener("input",ue(this,YM)),ue(this,Di).addEventListener("select",ue(this,KM)),ue(this,Di).addEventListener("blur",ue(this,JM)),ue(this,Di).addEventListener("focus",ue(this,QM)),ue(this,il).addEventListener("suggest",ue(this,GM)),ue(this,il).addEventListener("suggesterror",ue(this,qM)),ue(this,il).addEventListener("retrieve",ue(this,yS)),document.body.appendChild(ue(this,Di)),t&&(t.insertAdjacentElement("beforebegin",JU(ue(this,Di).dataSeed)),FKe(t),wr(this,Tp,t.autocomplete)),pJe(),window.addEventListener("browserautofill",ue(this,XM))}disconnectedCallback(){ue(this,Di).remove(),ue(this,Di).removeEventListener("input",ue(this,YM)),ue(this,Di).removeEventListener("select",ue(this,KM)),ue(this,Di).removeEventListener("blur",ue(this,JM)),ue(this,Di).removeEventListener("focus",ue(this,QM)),ue(this,il).removeEventListener("suggest",ue(this,GM)),ue(this,il).removeEventListener("suggesterror",ue(this,qM)),ue(this,il).removeEventListener("retrieve",ue(this,yS)),ue(this,$_).remove(),ue(this,ZM).disconnect(),window.removeEventListener("browserautofill",ue(this,XM))}attributeChangedCallback(e,t,r){if(e==="access-token"){ue(this,Sp).accessToken=r;return}if(e==="browser-autofill-enabled"){wr(this,gS,!!r);return}if(e==="theme"){this.theme=jx(r);return}if(e==="popover-options"){this.popoverOptions=jx(r);return}const n=e.split("-").join("_");r||delete this.options[n],this.options[n]=r}focus(){ue(this,Di).focus()}simulateRetrieve(e){const t=this.input;t&&(t.dataset.mapboxSuccess="true"),ue(this,Di).hideResults();const r={type:"FeatureCollection",features:[e],url:""};ue(this,yS).call(this,r)}};Sp=new WeakMap;il=new WeakMap;ol=new WeakMap;Di=new WeakMap;$_=new WeakMap;Tp=new WeakMap;gS=new WeakMap;GM=new WeakMap;qM=new WeakMap;yS=new WeakMap;HM=new WeakMap;ZM=new WeakMap;XM=new WeakMap;YM=new WeakMap;KM=new WeakMap;JM=new WeakMap;QM=new WeakMap;V4=new WeakMap;n6.observedAttributes=["access-token","browser-autofill-enabled","theme","popover-options","css-text","language","country","bbox","limit","proximity","streets"];window.MapboxAddressAutofill=n6;window.customElements.get("mapbox-address-autofill")||customElements.define("mapbox-address-autofill",n6);var SJe={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"},kce={placeholder:SJe},TJe=9,pd,U_,al,fu,md,Ji,V_,W4,Rce,W_,eP,tP,rP,Zg,nP,iP,vS,oP,aP,Ep,sP,lP,i6=class extends $m{constructor(){super(...arguments),Pt(this,W4),Pt(this,pd,void 0),Pt(this,U_,new Vle({})),Pt(this,al,new UU(ue(this,U_))),Pt(this,fu,null),Pt(this,md,void 0),Pt(this,Ji,new o2),Pt(this,V_,new r6(2)),this.options={},Pt(this,W_,void 0),Pt(this,eP,e=>{ue(this,Ep).call(this),ue(this,Ji).handleSuggest((e==null?void 0:e.suggestions)||null),this.dispatchEvent(new Gi("suggest",e))}),Pt(this,tP,e=>{ue(this,Ep).call(this),ue(this,Ji).handleError(),this.dispatchEvent(new Gi("suggesterror",e))}),Pt(this,rP,e=>{ue(this,Ep).call(this),this.dispatchEvent(new Gi("retrieve",e));const t=e;if(!t||!t.features.length)return;const r=VU(t.features[0]);ue(this,md).value=r.name;const n=ue(this,fu);if(!n)return;const a=t.features[0];if(!a)return;const l=a.properties.feature_type,h=a.properties.bbox;if(h)n.flyTo(mce(n,Kl.convert(h).toFlatArray()));else{const i=a.geometry.coordinates,_=gce(l);n.flyTo({center:i,zoom:_,speed:ZU})}this.marker&&this.mapboxgl&&ue(this,iP).call(this,a)}),Pt(this,Zg,void 0),Pt(this,nP,()=>{ue(this,Zg)&&(ue(this,Zg).remove(),wr(this,Zg,null))}),Pt(this,iP,e=>{if(!ue(this,fu)||(ue(this,nP).call(this),!e))return;const r=ei(ei({},{color:"#4668F2"}),typeof this.marker=="object"&&this.marker);wr(this,Zg,new this.mapboxgl.Marker(r)),e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&ue(this,Zg).setLngLat(e.geometry.coordinates).addTo(ue(this,fu))}),this.interceptSearch=null,Pt(this,vS,e=>{this.dispatchEvent(new Gi("input",e.detail.inputText));const{lastInput:t,inputText:r}=e.detail;if(!r){ue(this,sP).call(this);return}const n=this.interceptSearch&&this.interceptSearch(r),a=this.interceptSearch?n:r;if(this.interceptSearch&&!n){ue(this,Ji).hideResults();return}ue(this,al).suggest(a,this.options),ue(this,V_).input(a,t,tc(ei({},this.options),{sessionToken:ue(this,al).sessionToken,accessToken:this.accessToken}),ue(this,fu)),ue(this,Ep).call(this,!0)}),Pt(this,oP,e=>{const{suggestion:t,selectedIndex:r}=e.detail;ue(this,al).retrieve(t,this.options),ue(this,V_).select(this.value,r,ue(this,Ji).suggestions,tc(ei({},this.options),{sessionToken:ue(this,al).sessionToken,accessToken:this.accessToken}),ue(this,fu)),ue(this,Ep).call(this,!0)}),Pt(this,aP,()=>{ue(this,al).abort()}),Pt(this,Ep,(e=!1)=>{e?(ue(this,pd).ClearBtn.style.display="none",ue(this,pd).LoadingIcon.style.display="block"):(ue(this,pd).LoadingIcon.style.display="none",ue(this,pd).ClearBtn.style.display=this.value?"block":"none")}),Pt(this,sP,()=>{this.value="",ue(this,Ep).call(this),ue(this,iP).call(this,null),ue(this,Ji).handleSuggest(null),ue(this,V_).clear(),ue(this,al).incrementSession(),this.dispatchEvent(new Gi("clear"))}),this.marker=!0,Pt(this,lP,()=>{const e=ue(this,fu),t=ei({},this.options);if(e.getZoom()<=TJe){delete t.proximity,this.options=t;return}const r=e.getCenter();this.options=tc(ei({},t),{proximity:r})})}get accessToken(){return ue(this,U_).accessToken}set accessToken(e){ue(this,U_).accessToken=e}get value(){return ue(this,md).value}set value(e){ue(this,md).value=e||""}get input(){return ue(this,md)}get template(){return _Ke}get templateStyle(){return ov}get templateUserStyle(){return Cl(".SearchBox",ue(this,Ji).theme)}get theme(){return ue(this,Ji).theme}set theme(e){if(ue(this,Ji).theme=e,!ue(this,pd)||!e)return;this.updateTemplateUserStyle(Cl(".SearchBox",e)),ue(this,Ji).updatePopover();const{SearchIcon:t}=ue(this,pd);t.innerHTML=Oc("search",e)}get popoverOptions(){return ue(this,Ji).popoverOptions}set popoverOptions(e){ue(this,Ji).popoverOptions=e}get placeholder(){return ue(this,W_)||ZS(this,W4,Rce).call(this)}set placeholder(e){wr(this,W_,e),ue(this,md)&&(ue(this,md).placeholder=this.placeholder,ue(this,md).setAttribute("aria-label",this.placeholder))}connectedCallback(){super.connectedCallback(),wr(this,pd,iv(this,{SearchBox:".SearchBox",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"})),this.theme=ei({},this.theme);const{Input:e,ClearBtn:t}=ue(this,pd);wr(this,md,e),ue(this,Ji).input=e,ue(this,Ji).searchService=2,ue(this,Ji).addEventListener("input",ue(this,vS)),ue(this,Ji).addEventListener("select",ue(this,oP)),ue(this,Ji).addEventListener("blur",ue(this,aP)),ue(this,al).addEventListener("suggest",ue(this,eP)),ue(this,al).addEventListener("suggesterror",ue(this,tP)),ue(this,al).addEventListener("retrieve",ue(this,rP)),t.addEventListener("click",ue(this,sP)),this.placeholder=ue(this,W_),this.parentElement.appendChild(ue(this,Ji)),e&&(e.previousElementSibling.hasAttribute("aria-live")&&e.previousElementSibling.remove(),e.insertAdjacentElement("beforebegin",JU(ue(this,Ji).dataSeed)))}disconnectedCallback(){ue(this,Ji).remove(),ue(this,Ji).input=null,ue(this,Ji).removeEventListener("input",ue(this,vS)),ue(this,Ji).removeEventListener("select",ue(this,oP)),ue(this,Ji).removeEventListener("blur",ue(this,aP)),ue(this,al).removeEventListener("suggest",ue(this,eP)),ue(this,al).removeEventListener("suggesterror",ue(this,tP)),ue(this,al).removeEventListener("retrieve",ue(this,rP)),ue(this,V_).remove()}attributeChangedCallback(e,t,r){if(e==="access-token"){ue(this,U_).accessToken=r;return}if(e==="theme"){this.theme=jx(r);return}if(e==="popover-options"){this.popoverOptions=jx(r);return}if(e==="placeholder"){this.placeholder=r;return}const n=e.split("-").join("_");r||delete this.options[n],this.options[n]=r,n==="language"&&(this.placeholder=ue(this,W_))}focus(){ue(this,Ji).focus()}search(e){this.value=e;const t={lastInput:e,inputText:e};ue(this,vS).call(this,new Gi("input",t))}bindMap(e){ue(this,fu)&&ue(this,fu).off("moveend",ue(this,lP)),e&&e.on("moveend",ue(this,lP)),wr(this,fu,e)}unbindMap(){this.bindMap(null)}onAdd(e){this.bindMap(e),this.remove();const t=document.createElement("div");return t.className="mapboxgl-ctrl",t.style.width="300px",t.appendChild(this),t}onRemove(){this.remove(),this.unbindMap(),ue(this,nP).call(this)}getDefaultPosition(){return"top-right"}};pd=new WeakMap;U_=new WeakMap;al=new WeakMap;fu=new WeakMap;md=new WeakMap;Ji=new WeakMap;V_=new WeakMap;W4=new WeakSet;Rce=function(){if(this.options.language){const e=this.options.language.split(",")[0],t=dce.language(e),r=kce.placeholder[t];if(r)return r}return"Search"};W_=new WeakMap;eP=new WeakMap;tP=new WeakMap;rP=new WeakMap;Zg=new WeakMap;nP=new WeakMap;iP=new WeakMap;vS=new WeakMap;oP=new WeakMap;aP=new WeakMap;Ep=new WeakMap;sP=new WeakMap;lP=new WeakMap;i6.observedAttributes=["access-token","theme","popover-options","placeholder","language","country","bbox","limit","navigation-profile","origin","proximity","eta-type","types"];window.MapboxSearchBox=i6;window.customElements.get("mapbox-search-box")||customElements.define("mapbox-search-box",i6);var EJe=9,gd,Ap,sl,pu,yd,Qi,G_,G4,Dce,q_,cP,uP,dP,Xg,hP,fP,_S,pP,mP,Cp,gP,yP,o6=class extends $m{constructor(){super(...arguments),Pt(this,G4),Pt(this,gd,void 0),Pt(this,Ap,new gYe({})),Pt(this,sl,new UU(ue(this,Ap))),Pt(this,pu,null),Pt(this,yd,void 0),Pt(this,Qi,new o2),Pt(this,G_,new r6(1)),this.options={},Pt(this,q_,void 0),Pt(this,cP,e=>{ue(this,Cp).call(this),ue(this,Qi).handleSuggest((e==null?void 0:e.features)||null),this.dispatchEvent(new Gi("suggest",e))}),Pt(this,uP,e=>{ue(this,Cp).call(this),ue(this,Qi).handleError(),this.dispatchEvent(new Gi("suggesterror",e))}),Pt(this,dP,e=>{ue(this,Cp).call(this),this.dispatchEvent(new Gi("retrieve",e));const t=e;if(!t)return;ue(this,yd).value=t.properties.full_address;const r=ue(this,pu);if(!r)return;const n=t.properties.feature_type,a=t.properties.bbox;if(a)r.flyTo(mce(r,Kl.convert(a).toFlatArray()));else{const l=t.geometry.coordinates,h=gce(n);r.flyTo({center:l,zoom:h,speed:ZU})}this.marker&&this.mapboxgl&&ue(this,fP).call(this,t)}),Pt(this,Xg,void 0),Pt(this,hP,()=>{ue(this,Xg)&&(ue(this,Xg).remove(),wr(this,Xg,null))}),Pt(this,fP,e=>{if(!ue(this,pu)||(ue(this,hP).call(this),!e))return;const r=ei(ei({},{color:"#4668F2"}),typeof this.marker=="object"&&this.marker);wr(this,Xg,new this.mapboxgl.Marker(r)),e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&ue(this,Xg).setLngLat(e.geometry.coordinates).addTo(ue(this,pu))}),this.interceptSearch=null,Pt(this,_S,e=>{this.dispatchEvent(new Gi("input",e.detail.inputText));const{lastInput:t,inputText:r}=e.detail;if(!r){ue(this,gP).call(this);return}const n=this.interceptSearch&&this.interceptSearch(r),a=this.interceptSearch?n:r;if(this.interceptSearch&&!n){ue(this,Qi).hideResults();return}ue(this,sl).suggest(a,this.options),ue(this,G_).input(a,t,tc(ei({},this.options),{sessionToken:ue(this,sl).sessionToken,accessToken:this.accessToken}),ue(this,pu),ue(this,Ap).responseHeaders),ue(this,Cp).call(this,!0)}),Pt(this,pP,e=>{const{suggestion:t,selectedIndex:r}=e.detail;ue(this,sl).retrieve(t,this.options),ue(this,G_).select(this.value,r,ue(this,Qi).suggestions,tc(ei({},this.options),{sessionToken:ue(this,sl).sessionToken,accessToken:this.accessToken}),ue(this,pu),ue(this,Ap).responseHeaders),ue(this,Cp).call(this,!0)}),Pt(this,mP,()=>{ue(this,sl).abort()}),Pt(this,Cp,(e=!1)=>{e?(ue(this,gd).ClearBtn.style.display="none",ue(this,gd).LoadingIcon.style.display="block"):(ue(this,gd).LoadingIcon.style.display="none",ue(this,gd).ClearBtn.style.display=this.value?"block":"none")}),Pt(this,gP,()=>{this.value="",ue(this,Cp).call(this),ue(this,fP).call(this,null),ue(this,Qi).handleSuggest(null),ue(this,G_).clear(),ue(this,sl).incrementSession(),this.dispatchEvent(new Gi("clear"))}),this.marker=!0,Pt(this,yP,()=>{const e=ue(this,pu),t=ei({},this.options);if(e.getZoom()<=EJe){delete t.proximity,this.options=t;return}const r=e.getCenter();this.options=tc(ei({},t),{proximity:r})})}get accessToken(){return ue(this,Ap).accessToken}set accessToken(e){ue(this,Ap).accessToken=e}get value(){return ue(this,yd).value}set value(e){ue(this,yd).value=e||""}get input(){return ue(this,yd)}get template(){return xKe}get templateStyle(){return ov}get templateUserStyle(){return Cl(".Geocoder",ue(this,Qi).theme)}get theme(){return ue(this,Qi).theme}set theme(e){if(ue(this,Qi).theme=e,!ue(this,gd)||!e)return;this.updateTemplateUserStyle(Cl(".Geocoder",e)),ue(this,Qi).updatePopover();const{SearchIcon:t}=ue(this,gd);t.innerHTML=Oc("search",e)}get popoverOptions(){return ue(this,Qi).popoverOptions}set popoverOptions(e){ue(this,Qi).popoverOptions=e}get placeholder(){return ue(this,q_)||ZS(this,G4,Dce).call(this)}set placeholder(e){wr(this,q_,e),ue(this,yd)&&(ue(this,yd).placeholder=this.placeholder,ue(this,yd).setAttribute("aria-label",this.placeholder))}connectedCallback(){super.connectedCallback(),wr(this,gd,iv(this,{Geocoder:".Geocoder",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"})),this.theme=ei({},this.theme);const{Input:e,ClearBtn:t}=ue(this,gd);wr(this,yd,e),ue(this,Qi).input=e,ue(this,Qi).searchService=1,ue(this,Qi).addEventListener("input",ue(this,_S)),ue(this,Qi).addEventListener("select",ue(this,pP)),ue(this,Qi).addEventListener("blur",ue(this,mP)),ue(this,sl).addEventListener("suggest",ue(this,cP)),ue(this,sl).addEventListener("suggesterror",ue(this,uP)),ue(this,sl).addEventListener("retrieve",ue(this,dP)),t.addEventListener("click",ue(this,gP)),this.placeholder=ue(this,q_),this.parentElement.appendChild(ue(this,Qi)),e&&(e.previousElementSibling.hasAttribute("aria-live")&&e.previousElementSibling.remove(),e.insertAdjacentElement("beforebegin",JU(ue(this,Qi).dataSeed)))}disconnectedCallback(){ue(this,Qi).remove(),ue(this,Qi).input=null,ue(this,Qi).removeEventListener("input",ue(this,_S)),ue(this,Qi).removeEventListener("select",ue(this,pP)),ue(this,Qi).removeEventListener("blur",ue(this,mP)),ue(this,sl).removeEventListener("suggest",ue(this,cP)),ue(this,sl).removeEventListener("suggesterror",ue(this,uP)),ue(this,sl).removeEventListener("retrieve",ue(this,dP)),ue(this,G_).remove()}attributeChangedCallback(e,t,r){if(e==="access-token"){ue(this,Ap).accessToken=r;return}if(e==="theme"){this.theme=jx(r);return}if(e==="popover-options"){this.popoverOptions=jx(r);return}if(e==="placeholder"){this.placeholder=r;return}const n=e.split("-").join("_");r||delete this.options[n],this.options[n]=r,n==="language"&&(this.placeholder=ue(this,q_))}focus(){ue(this,Qi).focus()}search(e){this.value=e;const t={lastInput:e,inputText:e};ue(this,_S).call(this,new Gi("input",t))}bindMap(e){ue(this,pu)&&ue(this,pu).off("moveend",ue(this,yP)),e&&e.on("moveend",ue(this,yP)),wr(this,pu,e)}unbindMap(){this.bindMap(null)}onAdd(e){this.bindMap(e),this.remove();const t=document.createElement("div");return t.className="mapboxgl-ctrl",t.style.width="300px",t.appendChild(this),t}onRemove(){this.remove(),this.unbindMap(),ue(this,hP).call(this)}getDefaultPosition(){return"top-right"}};gd=new WeakMap;Ap=new WeakMap;sl=new WeakMap;pu=new WeakMap;yd=new WeakMap;Qi=new WeakMap;G_=new WeakMap;G4=new WeakSet;Dce=function(){if(this.options.language){const e=this.options.language.split(",")[0],t=dce.language(e),r=kce.placeholder[t];if(r)return r}return"Search"};q_=new WeakMap;cP=new WeakMap;uP=new WeakMap;dP=new WeakMap;Xg=new WeakMap;hP=new WeakMap;fP=new WeakMap;_S=new WeakMap;pP=new WeakMap;mP=new WeakMap;Cp=new WeakMap;gP=new WeakMap;yP=new WeakMap;o6.observedAttributes=["access-token","theme","popover-options","placeholder","autocomplete","language","country","bbox","limit","proximity","types","worldview","permanent"];window.MapboxGeocoder=o6;window.customElements.get("mapbox-geocoder")||customElements.define("mapbox-geocoder",o6);var dY=new tKe({size:512,antimeridian:!0}),P_=1280;function hY(e,t){const{width:r,height:n}=fce(e,!0);switch(t){case"center":return[0,0];case"top":return[0,n/2];case"bottom":return[0,-1*n/2];case"left":return[r/2,0];case"right":return[-1*r/2,0];case"top-left":return[r/2,n/2];case"top-right":return[-1*r/2,n/2];case"bottom-left":return[r/2,-1*n/2];case"bottom-right":return[-1*r/2,-1*n/2]}}var vP,q4,H_,_P,xP,H4,bP,wP,Z4,SP,TP,Z_,X4,EP,AJe=class{constructor(e,t,r,n,a,l){Pt(this,vP,void 0),Pt(this,q4,()=>{[this.anchorOffsetX,this.anchorOffsetY]=hY(this.markerElement,this.anchor),this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}),Pt(this,H_,{anchorX:0,anchorY:0,globalX:0,globalY:0,correctionX:0,correctionY:0}),Pt(this,_P,!1),Pt(this,xP,void 0),Pt(this,H4,i=>{this.isActive&&(i.preventDefault(),i.stopPropagation(),ue(this,Z_).call(this,i),window.addEventListener("pointermove",ue(this,wP)),window.addEventListener("pointerup",ue(this,bP)))}),Pt(this,bP,()=>{window.removeEventListener("pointermove",ue(this,wP)),window.removeEventListener("pointerup",ue(this,bP))}),Pt(this,wP,i=>{i.preventDefault(),i.stopPropagation();const _=this.curPointerXPos-i.pageX,b=this.curPointerYPos-i.pageY;this.markerDeltaX+=_,this.markerDeltaY-=b,this.markerDeltaX=Math.max(Math.min(this.imgElement.width/2,this.markerDeltaX),this.imgElement.width/2*-1),this.markerDeltaY=Math.max(Math.min(this.imgElement.height/2,this.markerDeltaY),this.imgElement.height/2*-1);const E=this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],C=this.imgCenterPx[1]-this.imgCenterAdjustedPx[1],I=this.markerDeltaX-E,F=this.markerDeltaY+C;this.markerTransform={globalX:I,globalY:F},ue(this,Z_).call(this,i)}),Pt(this,Z4,i=>{this.isActive&&(i.preventDefault(),i.stopPropagation(),ue(this,Z_).call(this,i),window.addEventListener("pointermove",ue(this,TP)),window.addEventListener("pointerup",ue(this,SP)))}),Pt(this,SP,()=>{window.removeEventListener("pointermove",ue(this,TP)),window.removeEventListener("pointerup",ue(this,SP))}),Pt(this,TP,i=>{i.preventDefault();let _=Math.round(this.imgContainerElement.scrollTop+(this.curPointerYPos-i.pageY));_=Math.max(Math.min(this.imgElement.height-this.imgContainerElement.clientHeight,_),0);let b=Math.round(this.imgContainerElement.scrollLeft+(this.curPointerXPos-i.pageX));b=Math.max(Math.min(this.imgElement.width-this.imgContainerElement.clientWidth,b),0),this.imgContainerElement.scrollTop=_,this.imgContainerElement.scrollLeft=b;const E=Math.round(b-(this.imgElement.width-this.imgContainerElement.clientWidth)/2),C=Math.round((this.imgElement.height-this.imgContainerElement.clientHeight)/2-_);if(this.imgCenterAdjustedPx=[this.imgCenterPx[0]+E,this.imgCenterPx[1]-C],!this.keepMarkerCentered){const I=this.markerDeltaX+E,F=this.markerDeltaY+C;this.markerTransform={globalX:I,globalY:F}}ue(this,EP).call(this,b,_),ue(this,Z_).call(this,i)}),Pt(this,Z_,i=>{this.curPointerXPos=i.pageX,this.curPointerYPos=i.pageY}),Pt(this,X4,()=>{const{anchorX:i,anchorY:_,globalX:b,globalY:E,correctionX:C,correctionY:I}=ue(this,H_),F=i-b+C,$=_+E+I;this.markerElement.style.transform=`translate(calc(-50% + ${F}px), calc(-50% + ${$}px))`}),this.reCenter=()=>{const i=(this.imgElement.height-this.imgContainerElement.clientHeight)/2,_=(this.imgElement.width-this.imgContainerElement.clientWidth)/2;this.imgContainerElement.scrollTop=i,this.imgContainerElement.scrollLeft=_,this.imgCenterAdjustedPx=this.imgCenterPx,this.markerDeltaX=this.markerDeltaY=0,this.markerTransform={globalX:0,globalY:0,correctionX:0,correctionY:0}},this.handleMinimapResize=()=>{if(!this.imgElement.height||!this.imgElement.width)return;const i=this.imgCenterOffset.x,_=this.imgCenterOffset.y,b=this.imgElement.width/2-i-this.imgContainerElement.clientWidth/2,E=this.imgElement.height/2-_-this.imgContainerElement.clientHeight/2;this.imgContainerElement.scrollLeft=b,this.imgContainerElement.scrollTop=E,ue(this,EP).call(this,b,E)},Pt(this,EP,(i,_)=>{const b=this.imgCenterOffset.x,E=this.imgCenterOffset.y,{correctionX:C,correctionY:I}=this.markerTransform,F={};if(i/2<b*-1){const $=b*-1-i/2;F.correctionX=$*2}else i<0?F.correctionX=i:C!==0&&(F.correctionX=0);if(_/2<E*-1){const $=E*-1-_/2;F.correctionY=$*2}else _<0?F.correctionY=_:I!==0&&(F.correctionY=0);this.markerTransform=F}),this.markerElement=r,this.imgContainerElement=e,this.imgElement=t,this.keepMarkerCentered=n,this.zoom=a,this.anchor=l,this.curPointerXPos=0,this.curPointerYPos=0,this.markerDeltaX=0,this.markerDeltaY=0,this.imgContainerElement.addEventListener("pointerdown",ue(this,Z4)),this.keepMarkerCentered||this.markerElement.addEventListener("pointerdown",ue(this,H4)),new ResizeObserver(ue(this,q4)).observe(this.markerElement)}get anchor(){return ue(this,vP)}set anchor(e){wr(this,vP,e),[this.anchorOffsetX,this.anchorOffsetY]=hY(this.markerElement,e),this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}get markerTransform(){return ue(this,H_)}set markerTransform(e){wr(this,H_,ei(ei({},ue(this,H_)),e)),ue(this,X4).call(this)}get isActive(){return ue(this,_P)}set isActive(e){this.imgContainerElement.style.touchAction=e?"none":"",wr(this,_P,e)}get coordinate(){const e=this.keepMarkerCentered?this.imgCenterAdjustedPx:[this.imgCenterPx[0]-this.markerDeltaX,this.imgCenterPx[1]+this.markerDeltaY];if(YU(e,this.imgCenterPx))return ue(this,xP);{const t=dY.ll(e,this.zoom);return[sY(t[0],6),sY(t[1],6)]}}set coordinate(e){wr(this,xP,e),this.imgCenterPx=this.imgCenterAdjustedPx=dY.px(e,this.zoom)}get imgCenterOffset(){return{x:this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],y:this.imgCenterPx[1]-this.imgCenterAdjustedPx[1]}}};vP=new WeakMap;q4=new WeakMap;H_=new WeakMap;_P=new WeakMap;xP=new WeakMap;H4=new WeakMap;bP=new WeakMap;wP=new WeakMap;Z4=new WeakMap;SP=new WeakMap;TP=new WeakMap;Z_=new WeakMap;X4=new WeakMap;EP=new WeakMap;var CJe='<svg width="88" height="23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill-rule="evenodd"><defs><path id="g" d="M11.5 2.25a9.25 9.25 0 1 1 0 18.5 9.25 9.25 0 0 1 0-18.5zM7 15.98c-.05-.33-.83-5.8 2.23-8.87a4.4 4.4 0 0 1 3.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39a4.4 4.4 0 0 1-1.28 3.13C12.72 16.93 7 16 7 16v-.02zm8.3-5.48-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z"/><path id="b" d="M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19A3.77 3.77 0 0 1 50.86 15v3.77c0 .13-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01.01-.01c.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V15a3.7 3.7 0 0 1-2.73 1.19c-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.38-.19a4.24 4.24 0 0 0-4.16 3.29 4.07 4.07 0 0 0 0 1.77 4.23 4.23 0 0 0 4.17 3.3 4.22 4.22 0 0 0 4.26-4.19 4.2 4.2 0 0 0-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18a4 4 0 0 1 3.84 3.28c.13.59.13 1.2 0 1.8a4 4 0 0 1-3.84 3.29A3.77 3.77 0 0 1 60.86 15v.77c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4a.23.23 0 0 1-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55a2.73 2.73 0 0 1 2.44-1.56c1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.62 0h-1.61a.27.27 0 0 1-.12-.03c-.1-.06-.13-.19-.06-.28l2.43-3.71-2.4-3.65a.21.21 0 0 1-.02-.12.2.2 0 0 1 .2-.21h1.61c.13 0 .24.06.3.17L82 10.54l1.4-2.37a.34.34 0 0 1 .3-.17h1.6l.12.03c.1.06.13.19.06.28l-2.37 3.65 2.43 3.7.01.13a.2.2 0 0 1-.2.21h-1.61a.33.33 0 0 1-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 0 1-.3.17zm-7.12-1.49A2.47 2.47 0 0 1 70.7 12a2.47 2.47 0 0 1 2.42-2.52 2.47 2.47 0 0 1 2.42 2.51 2.48 2.48 0 0 1-2.42 2.52zm-19.87 0a2.48 2.48 0 0 1-2.42-2.48v-.07a2.47 2.47 0 0 1 2.4-2.49 2.47 2.47 0 0 1 2.41 2.51 2.47 2.47 0 0 1-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51a2.47 2.47 0 0 1 2.4-2.52 2.46 2.46 0 0 1 2.41 2.48l.02.08zm18.12 2.47a2.47 2.47 0 0 1-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51a2.47 2.47 0 0 1-2.42 2.51z"/></defs><mask id="c"><rect width="100%" height="100%" fill="#fff"/><use xlink:href="#g"/><use xlink:href="#b"/></mask><g opacity=".3" stroke="#000" stroke-width="3"><circle mask="url(#c)" cx="11.5" cy="11.5" r="9.25"/><use xlink:href="#b" mask="url(#c)"/></g><g opacity=".9" fill="#fff"><use xlink:href="#g"/><use xlink:href="#b"/></g></svg>',fY=16,MJe=oc(`
<template>
  <div class="MapboxAddressMinimap" aria-hidden="true">
    <div class="MinimapImageContainer">
      <img class="MinimapImage" draggable="false"></img>
      <div class="MinimapInnerFrame">
        <div class="MinimapMarker"></div>
        <div class="MinimapAttribution">
          <div class="MinimapAttributionLogo">
            <a target="_blank" rel="noopener nofollow" href="https://www.mapbox.com/" aria-label="Mapbox logo">
              ${CJe}
            </a>
          </div>
          <div class="MinimapAttributionText">
            <a target="_blank" href='https://www.mapbox.com/about/maps/'>© Mapbox</a><a target="_blank" href='http://www.openstreetmap.org/copyright'>© OpenStreetMap</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
`),PJe=oc(`
<template>
  <button type="button" class="MinimapStyleToggle"></button>
</template>
`),IJe=oc(`
<template>
  <div class="MinimapFooter">Adjust the marker on the map if it doesn't precisely match your location. This helps improve address data quality.</div>
</template>
`),Y4="Adjust pin",K4="Save",J4="Cancel",OJe=oc(`
<template>
  <div class="MinimapEditButtons">
    <div class="Button ButtonPrimary MinimapButtonAdjust">${Y4}</div>
    <div class="Button ButtonPrimary MinimapButtonSave" aria-hidden="true">${K4}</div>
    <div class="Button MinimapButtonCancel" aria-hidden="true">${J4}</div>
  </div>
</template>
`),AP,X_,xS,Th,Yg,vd,_d,eo,ka,CP,MP,PP,Y_,IP,OP,kP,RP,DP,LP,bS,NP,zP,jP,FP,Q4,eB,BP,wS,SS,$P,UP,tB,VP,rB,a6=class extends $m{constructor(){super(...arguments),Pt(this,AP,!1),this.keepMarkerCentered=!1,this.markerAnchor="bottom",Pt(this,X_,!1),Pt(this,xS,!1),Pt(this,Th,void 0),Pt(this,Yg,""),Pt(this,vd,void 0),Pt(this,_d,void 0),Pt(this,eo,void 0),Pt(this,ka,void 0),Pt(this,CP,void 0),Pt(this,MP,{}),Pt(this,PP,!1),Pt(this,Y_,"default"),Pt(this,IP,void 0),Pt(this,OP,void 0),Pt(this,kP,void 0),Pt(this,RP,["mapbox","streets-v11"]),Pt(this,DP,void 0),Pt(this,LP,void 0),Pt(this,bS,()=>{const{ImageContainer:e,ButtonAdjust:t,ButtonSave:r,ButtonCancel:n}=ue(this,eo);ue(this,X_)?(e.classList.add(`${this.dataset.seed}--draggable`),ue(this,ka).isActive=!0,t.setAttribute("aria-hidden","true"),r.removeAttribute("aria-hidden"),n.removeAttribute("aria-hidden")):(e.classList.remove(`${this.dataset.seed}--draggable`),ue(this,ka).isActive=!1,t.removeAttribute("aria-hidden"),r.setAttribute("aria-hidden","true"),n.setAttribute("aria-hidden","true"))}),Pt(this,NP,()=>{wr(this,X_,!0),ue(this,bS).call(this)}),Pt(this,zP,()=>{if(this.feature.properties.full_address&&!YU(this.feature.geometry.coordinates,ue(this,ka).coordinate)){const[e,t]=ue(this,ka).coordinate;Cce(this.accessToken,{originalCoordinate:this.feature.geometry.coordinates,originalAddress:this.feature.properties.full_address,changes:{location:{longitude:e,latitude:t}}})}this.onSaveMarkerLocation&&this.onSaveMarkerLocation(ue(this,ka).coordinate),wr(this,X_,!1),ue(this,bS).call(this)}),Pt(this,jP,()=>{ue(this,ka).reCenter(),wr(this,X_,!1),ue(this,bS).call(this)}),Pt(this,FP,()=>{this.mapStyleMode=this.mapStyleMode==="default"?"satellite":"default"}),Pt(this,Q4,()=>{ue(this,xS)||ue(this,ka).reCenter(),wr(this,xS,!0),ue(this,ka)&&ue(this,ka).handleMinimapResize()}),Pt(this,eB,()=>{wr(this,xS,!1)}),Pt(this,BP,e=>{if(ue(this,vd)===0||ue(this,_d)===0)return"";const[t,r]=this.defaultMapStyle,n=yce(t,r),a=this.mapStyleMode==="default"?n:pKe,l=mKe+Du.autofillSessionToken.toString();let h=a+Vo.convert(e).toArray().join(",")+","+fY+",0/"+Math.min(ue(this,vd)*2,P_)+"x"+Math.min(ue(this,_d)*2,P_)+"?access_token="+this.accessToken+"&attribution=false&logo=false";return Du.autofillSessionEnabled&&(h+=`&sku=${l}`),h}),Pt(this,wS,()=>{if(ue(this,Th)){const e=ue(this,Th).geometry.coordinates;wr(this,Yg,ue(this,BP).call(this,e));const{Image:t}=ue(this,eo);t.src=ue(this,Yg)}}),Pt(this,SS,e=>`url("${RKe(e==="default"?"styleToggleDefault":"styleToggleSatellite",this.theme)}")`),Pt(this,$P,()=>{const{MapboxAddressMinimap:e,ImageContainer:t,Image:r}=ue(this,eo),{width:n,height:a}=fce(this.container),[l,h]=[ue(this,vd),ue(this,_d)];wr(this,vd,Math.min(n,P_)),wr(this,_d,Math.min(a,P_)),e.style.setProperty("width",`${ue(this,vd)}px`),e.style.setProperty("height",`${ue(this,_d)}px`),t.style.setProperty("height",`${ue(this,_d)}px`),t.style.setProperty("width",`${ue(this,vd)}px`);const[i,_]=[r.width,r.height];ue(this,vd)>l&&ue(this,vd)>i/2&&i<P_||ue(this,_d)>h&&ue(this,_d)>_/2&&_<P_?ue(this,wS).call(this):ue(this,ka)&&ue(this,ka).handleMinimapResize()}),Pt(this,UP,()=>{if(this.querySelector(".MinimapFooter"))return;const t=this.prepareTemplate(IJe),r=this.querySelector(".MapboxAddressMinimap");if(!r||(r.appendChild(t),this.querySelector(".MinimapEditButtons")))return;const a=this.prepareTemplate(OJe);this.querySelector(".MinimapInnerFrame").appendChild(a),wr(this,eo,tc(ei({},ue(this,eo)),{EditButtons:this.querySelector(".MinimapEditButtons"),ButtonAdjust:this.querySelector(".MinimapButtonAdjust"),ButtonSave:this.querySelector(".MinimapButtonSave"),ButtonCancel:this.querySelector(".MinimapButtonCancel")}));const{ButtonAdjust:h,ButtonSave:i,ButtonCancel:_}=ue(this,eo);h.addEventListener("click",ue(this,NP)),i.addEventListener("click",ue(this,zP)),_.addEventListener("click",ue(this,jP))}),Pt(this,tB,()=>{if(!ue(this,eo))return;const{EditButtons:e,ButtonAdjust:t,ButtonSave:r,ButtonCancel:n}=ue(this,eo),a=this.querySelector(".MinimapFooter");a==null||a.remove(),e==null||e.remove(),t&&(t.remove(),t.removeEventListener("click",ue(this,NP))),r&&(r.remove(),r.removeEventListener("click",ue(this,zP))),n&&(n.remove(),n.removeEventListener("click",ue(this,jP))),delete ue(this,eo).EditButtons,delete ue(this,eo).ButtonAdjust,delete ue(this,eo).ButtonSave,delete ue(this,eo).ButtonCancel}),Pt(this,VP,()=>{if(this.querySelector(".MinimapStyleToggle"))return;const t=this.prepareTemplate(PJe),r=this.querySelector(".MinimapInnerFrame");r&&(r.appendChild(t),ue(this,eo).MapStyleToggle=t,t.addEventListener("click",ue(this,FP)),t.style.backgroundImage=ue(this,SS).call(this,this.mapStyleMode==="default"?"satellite":"default"),t.setAttribute("title",`Switch to ${this.mapStyleMode==="default"?"Satellite":"Default"}`))}),Pt(this,rB,()=>{if(!ue(this,eo))return;const{MapStyleToggle:e}=ue(this,eo);e&&(e.remove(),e.removeEventListener("click",ue(this,FP)),delete ue(this,eo).MapStyleToggle)})}get canAdjustMarker(){return ue(this,AP)}set canAdjustMarker(e){wr(this,AP,e),e?ue(this,UP).call(this):ue(this,tB).call(this)}get accessToken(){return ue(this,CP)||Du.accessToken}set accessToken(e){wr(this,CP,e)}get feature(){return ue(this,Th)}set feature(e){wr(this,Th,e),e?this.show():this.hide()}get template(){return MJe}get templateStyle(){return ov}get templateUserStyle(){return Cl(".MapboxAddressMinimap",this.theme)}get satelliteToggle(){return ue(this,PP)}set satelliteToggle(e){wr(this,PP,e),e?ue(this,VP).call(this):ue(this,rB).call(this)}get theme(){return ue(this,MP)}set theme(e){if(wr(this,MP,e),!ue(this,eo)||!e)return;this.updateTemplateUserStyle(Cl(".MapboxAddressMinimap",e));const{Marker:t,MapStyleToggle:r}=ue(this,eo);t.innerHTML=Oc("marker",e),r&&(r.style.backgroundImage=ue(this,SS).call(this,this.mapStyleMode==="default"?"satellite":"default"))}get adjustBtnText(){return ue(this,IP)||Y4}set adjustBtnText(e){wr(this,IP,e);const t=this.querySelector(".MinimapButtonAdjust");t.textContent=e||Y4}get saveBtnText(){return ue(this,OP)||K4}set saveBtnText(e){wr(this,OP,e);const t=this.querySelector(".MinimapButtonSave");t.textContent=e||K4}get cancelBtnText(){return ue(this,kP)||J4}set cancelBtnText(e){wr(this,kP,e);const t=this.querySelector(".MinimapButtonCancel");t.textContent=e||J4}get mapStyleMode(){return ue(this,Y_)}set mapStyleMode(e){const t=ue(this,Y_);if(t===e||(wr(this,Y_,e),!ue(this,eo)))return;const{MapStyleToggle:r}=ue(this,eo);r&&(r.style.backgroundImage=ue(this,SS).call(this,t),r.setAttribute("title",`Switch to ${t==="satellite"?"Satellite":"Default"}`),ue(this,wS).call(this))}get defaultMapStyle(){return ue(this,RP)}set defaultMapStyle(e){wr(this,RP,e),ue(this,wS).call(this)}get footer(){return ue(this,DP)}set footer(e){wr(this,DP,e);const t=this.querySelector(".MinimapFooter");t&&(typeof e=="string"?(t.textContent=e,t.removeAttribute("aria-hidden")):e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true"))}get container(){return ue(this,LP)}set container(e){e&&(e.style.position="relative",wr(this,LP,e))}show(){if(!ue(this,Th))return;const e=ue(this,Th).geometry.coordinates;ue(this,ka).coordinate=e,wr(this,Yg,ue(this,BP).call(this,e));const{MapboxAddressMinimap:t,Image:r}=ue(this,eo);r.src=ue(this,Yg),t.removeAttribute("aria-hidden")}hide(){const{MapboxAddressMinimap:e}=ue(this,eo);e.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback(),wr(this,eo,iv(this,{MapboxAddressMinimap:".MapboxAddressMinimap",ImageContainer:".MinimapImageContainer",Image:".MinimapImage",Marker:".MinimapMarker",MapStyleToggle:".MinimapStyleToggle",EditButtons:".MinimapEditButtons",ButtonAdjust:".MinimapButtonAdjust",ButtonSave:".MinimapButtonSave",ButtonCancel:".MinimapButtonCancel"})),this.mapStyleMode=ue(this,Y_),this.theme=ei({},this.theme),this.canAdjustMarker&&ue(this,UP).call(this),this.satelliteToggle&&ue(this,VP).call(this),this.container=this.parentElement,new ResizeObserver(ue(this,$P)).observe(this.container),ue(this,$P).call(this);const{MapboxAddressMinimap:t,ImageContainer:r,Image:n,Marker:a}=ue(this,eo);wr(this,ka,new AJe(r,n,a,this.keepMarkerCentered,fY,this.markerAnchor)),ue(this,ka).reCenter(),n.onload=ue(this,Q4),n.onerror=ue(this,eB),n.src=ue(this,Yg),ue(this,Th)?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}attributeChangedCallback(e,t,r){if(e==="access-token")this.accessToken=r;else if(e==="can-adjust-marker")this.canAdjustMarker=r==="true";else if(e==="keep-marker-centered")this.keepMarkerCentered=r==="true";else if(e==="marker-anchor"){const n=r;this.markerAnchor=n,ue(this,ka)&&(ue(this,ka).anchor=n)}else e==="satellite-toggle"&&(this.satelliteToggle=r==="true")}};AP=new WeakMap;X_=new WeakMap;xS=new WeakMap;Th=new WeakMap;Yg=new WeakMap;vd=new WeakMap;_d=new WeakMap;eo=new WeakMap;ka=new WeakMap;CP=new WeakMap;MP=new WeakMap;PP=new WeakMap;Y_=new WeakMap;IP=new WeakMap;OP=new WeakMap;kP=new WeakMap;RP=new WeakMap;DP=new WeakMap;LP=new WeakMap;bS=new WeakMap;NP=new WeakMap;zP=new WeakMap;jP=new WeakMap;FP=new WeakMap;Q4=new WeakMap;eB=new WeakMap;BP=new WeakMap;wS=new WeakMap;SS=new WeakMap;$P=new WeakMap;UP=new WeakMap;tB=new WeakMap;VP=new WeakMap;rB=new WeakMap;a6.observedAttributes=["access-token","can-adjust-marker","keep-marker-centered","marker-anchor","satellite-toggle"];window.MapboxAddressMinimap=a6;window.customElements.get("mapbox-address-minimap")||customElements.define("mapbox-address-minimap",a6);var kJe=Ae.forwardRef((e,t)=>{const{accessToken:r,options:n,theme:a,popoverOptions:l,confirmOnBrowserAutofill:h,browserAutofillEnabled:i,children:_,onChange:b,onSuggest:E,onSuggestError:C,onRetrieve:I,interceptSearch:F}=e,$=ne.useRef();return ne.useImperativeHandle(t,()=>({focus:()=>{if($.current)return $.current.focus();throw new Error("AddressAutofill is not mounted")}})),ne.useEffect(()=>{$.current&&($.current.options=n)},[$.current,n]),ne.useEffect(()=>{$.current&&($.current.interceptSearch=F)},[$.current,n]),ne.useEffect(()=>{$.current&&($.current.theme=a)},[$.current,a]),ne.useEffect(()=>{$.current&&($.current.popoverOptions=l)},[$.current,l]),ne.useEffect(()=>{$.current&&($.current.confirmOnBrowserAutofill=h)},[$.current,h]),ne.useEffect(()=>{$.current&&($.current.browserAutofillEnabled=i)},[$.current,i]),ne.useEffect(()=>{const B=$.current;if(!B||!E)return;const q=G=>E(G.detail);return B.addEventListener("suggest",q),()=>{B.removeEventListener("suggest",q)}},[$.current,E]),ne.useEffect(()=>{const B=$.current;if(!B||!C)return;const q=G=>C(G.detail);return B.addEventListener("suggesterror",q),()=>{B.removeEventListener("suggesterror",q)}},[$.current,C]),ne.useEffect(()=>{const B=$.current;if(!B||!I)return;const q=G=>I(G.detail);return B.addEventListener("retrieve",q),()=>{B.removeEventListener("retrieve",q)}},[$.current,I]),ne.useEffect(()=>{const B=$.current;if(!B||!b)return;const q=G=>{G.target===G.currentTarget&&b(G.detail)};return B.addEventListener("input",q),()=>{B.removeEventListener("input",q)}},[$.current,b]),ne.useEffect(()=>{$.current&&($.current.accessToken=r)},[$.current,r]),Ae.createElement("mapbox-address-autofill",{ref:$},_)});Ae.forwardRef((e,t)=>{const{accessToken:r,options:n,theme:a,popoverOptions:l,placeholder:h,map:i,marker:_,mapboxgl:b,value:E,onChange:C,onSuggest:I,onSuggestError:F,onRetrieve:$,onClear:B,interceptSearch:q}=e,G=ne.useRef();return ne.useImperativeHandle(t,()=>({focus:()=>{if(G.current)return G.current.focus();throw new Error("SearchBox is not mounted")},search:H=>{if(G.current)return G.current.search(H);throw new Error("SearchBox is not mounted")}})),ne.useEffect(()=>{G.current&&(G.current.options=n||{})},[G.current,n]),ne.useEffect(()=>{G.current&&(G.current.interceptSearch=q)},[G.current,q]),ne.useEffect(()=>{G.current&&(G.current.theme=a)},[G.current,a]),ne.useEffect(()=>{G.current&&(G.current.popoverOptions=l)},[G.current,l]),ne.useEffect(()=>{G.current&&(G.current.placeholder=h)},[G.current,h]),ne.useEffect(()=>{G.current&&(G.current.value=E||"")},[G.current,E]),ne.useEffect(()=>{const H=G.current;if(H)return H.bindMap(i),()=>{H.unbindMap()}},[G.current,i]),ne.useEffect(()=>{G.current&&(G.current.marker=_)},[G.current,_]),ne.useEffect(()=>{G.current&&(G.current.mapboxgl=b)},[G.current,b]),ne.useEffect(()=>{const H=G.current;if(!H||!I)return;const J=Q=>I(Q.detail);return H.addEventListener("suggest",J),()=>{H.removeEventListener("suggest",J)}},[G.current,I]),ne.useEffect(()=>{const H=G.current;if(!H||!F)return;const J=Q=>F(Q.detail);return H.addEventListener("suggesterror",J),()=>{H.removeEventListener("suggesterror",J)}},[G.current,F]),ne.useEffect(()=>{const H=G.current;if(!H||!$)return;const J=Q=>$(Q.detail);return H.addEventListener("retrieve",J),()=>{H.removeEventListener("retrieve",J)}},[G.current,$]),ne.useEffect(()=>{const H=G.current;if(!H||!C)return;const J=Q=>{Q.target===Q.currentTarget&&C(Q.detail)};return H.addEventListener("input",J),()=>{H.removeEventListener("input",J)}},[G.current,C]),ne.useEffect(()=>{const H=G.current;if(!H||!B)return;const J=()=>{B()};return H.addEventListener("clear",J),()=>{H.removeEventListener("clear",J)}},[G.current,B]),ne.useEffect(()=>{G.current&&(G.current.accessToken=r)},[G.current,r]),Ae.createElement("mapbox-search-box",{ref:G})});Ae.forwardRef((e,t)=>{const{accessToken:r,options:n,theme:a,popoverOptions:l,placeholder:h,map:i,marker:_,mapboxgl:b,value:E,onChange:C,onSuggest:I,onSuggestError:F,onRetrieve:$,onClear:B,interceptSearch:q}=e,G=ne.useRef();return ne.useImperativeHandle(t,()=>({focus:()=>{if(G.current)return G.current.focus();throw new Error("Geocoder is not mounted")},search:H=>{if(G.current)return G.current.search(H);throw new Error("Geocoder is not mounted")}})),ne.useEffect(()=>{G.current&&(G.current.options=n||{})},[G.current,n]),ne.useEffect(()=>{G.current&&(G.current.interceptSearch=q)},[G.current,q]),ne.useEffect(()=>{G.current&&(G.current.theme=a)},[G.current,a]),ne.useEffect(()=>{G.current&&(G.current.popoverOptions=l)},[G.current,l]),ne.useEffect(()=>{G.current&&(G.current.placeholder=h)},[G.current,h]),ne.useEffect(()=>{G.current&&(G.current.value=E||"")},[G.current,E]),ne.useEffect(()=>{const H=G.current;if(H)return H.bindMap(i),()=>{H.unbindMap()}},[G.current,i]),ne.useEffect(()=>{G.current&&(G.current.marker=_)},[G.current,_]),ne.useEffect(()=>{G.current&&(G.current.mapboxgl=b)},[G.current,b]),ne.useEffect(()=>{const H=G.current;if(!H||!I)return;const J=Q=>I(Q.detail);return H.addEventListener("suggest",J),()=>{H.removeEventListener("suggest",J)}},[G.current,I]),ne.useEffect(()=>{const H=G.current;if(!H||!F)return;const J=Q=>F(Q.detail);return H.addEventListener("suggesterror",J),()=>{H.removeEventListener("suggesterror",J)}},[G.current,F]),ne.useEffect(()=>{const H=G.current;if(!H||!$)return;const J=Q=>$(Q.detail);return H.addEventListener("retrieve",J),()=>{H.removeEventListener("retrieve",J)}},[G.current,$]),ne.useEffect(()=>{const H=G.current;if(!H||!C)return;const J=Q=>{Q.target===Q.currentTarget&&C(Q.detail)};return H.addEventListener("input",J),()=>{H.removeEventListener("input",J)}},[G.current,C]),ne.useEffect(()=>{const H=G.current;if(!H||!B)return;const J=()=>{B()};return H.addEventListener("clear",J),()=>{H.removeEventListener("clear",J)}},[G.current,B]),ne.useEffect(()=>{G.current&&(G.current.accessToken=r)},[G.current,r]),Ae.createElement("mapbox-geocoder",{ref:G})});Od.accessToken="pk.eyJ1IjoiY2FybG9zaDIiLCJhIjoiY203aWxlNHU5MXNwNjJzcTNmZGZscThqaSJ9.mt9vzXHbWRtOj6rqrpSD5g";const RJe=({onAddressSelect:e})=>{const t=ne.useRef(null),r=ne.useRef(null),n=ne.useRef(null),[a,l]=ne.useState("");ne.useEffect(()=>{if(t.current)return r.current=new Od.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v12",center:[-99.1332,19.4326],zoom:10}),r.current.addControl(new Od.NavigationControl),n.current=new Od.Marker({color:"#FF0000"}),()=>{r.current&&r.current.remove()}},[]);const h=async i=>{var C,I;if(!i.features||!i.features.length||!r.current||!n.current)return;const _=i.features[0],b=_.geometry.coordinates;r.current.flyTo({center:b,zoom:16}),n.current.setLngLat(b).addTo(r.current);const E={street:((C=_.properties.address_line1)==null?void 0:C.split(" ").slice(1).join(" "))||"",number:((I=_.properties.address_line1)==null?void 0:I.split(" ")[0])||"",neighborhood:_.properties.neighborhood||_.properties.locality||"",postal_code:_.properties.postcode||"",administrative_area:_.properties.region||"",sub_administrative_area:_.properties.place||"",lat:b[1],lng:b[0]};e(E)};return j.jsxs(Yd,{className:"h-full flex flex-col",children:[j.jsxs("div",{className:"p-4 border-b",children:[j.jsx("div",{className:"mb-4",children:j.jsxs("div",{className:"relative",children:[j.jsx(_k,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground z-10"}),j.jsx("div",{id:"address-autofill-container",children:(()=>{const i=kJe;return j.jsx(i,{accessToken:Od.accessToken,onRetrieve:h,children:j.jsx(wi,{placeholder:"Buscar dirección...",className:"pl-8",autoComplete:"street-address",value:a,onChange:_=>l(_.target.value)})})})()})]})}),j.jsx("div",{className:"text-sm text-muted-foreground",children:j.jsxs("p",{className:"flex items-center",children:[j.jsx(jge,{className:"h-4 w-4 mr-1"}),"Busca una dirección o selecciona un punto en el mapa"]})})]}),j.jsx("div",{className:"flex-1 relative",children:j.jsx("div",{ref:t,className:"absolute inset-0"})})]})},{createElement:Fx,createContext:DJe,createRef:jQe,forwardRef:Lce,useCallback:ll,useContext:Nce,useEffect:Ty,useImperativeHandle:zce,useLayoutEffect:LJe,useMemo:NJe,useRef:ml,useState:k0}=tk,pY=tk[`useId${Math.random()}`.slice(0,5)],zJe=LJe,YR=DJe(null);YR.displayName="PanelGroupContext";const Ey=zJe,jJe=typeof pY=="function"?pY:()=>null;let FJe=0;function s6(e=null){const t=jJe(),r=ml(e||t||null);return r.current===null&&(r.current=""+FJe++),e??r.current}function jce({children:e,className:t="",collapsedSize:r,collapsible:n,defaultSize:a,forwardedRef:l,id:h,maxSize:i,minSize:_,onCollapse:b,onExpand:E,onResize:C,order:I,style:F,tagName:$="div",...B}){const q=Nce(YR);if(q===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:G,expandPanel:H,getPanelSize:J,getPanelStyle:Q,groupId:oe,isPanelCollapsed:de,reevaluatePanelConstraints:ae,registerPanel:ve,resizePanel:Fe,unregisterPanel:ke}=q,Ce=s6(h),je=ml({callbacks:{onCollapse:b,onExpand:E,onResize:C},constraints:{collapsedSize:r,collapsible:n,defaultSize:a,maxSize:i,minSize:_},id:Ce,idIsFromProps:h!==void 0,order:I});ml({didLogMissingDefaultSizeWarning:!1}),Ey(()=>{const{callbacks:Ze,constraints:Qe}=je.current,st={...Qe};je.current.id=Ce,je.current.idIsFromProps=h!==void 0,je.current.order=I,Ze.onCollapse=b,Ze.onExpand=E,Ze.onResize=C,Qe.collapsedSize=r,Qe.collapsible=n,Qe.defaultSize=a,Qe.maxSize=i,Qe.minSize=_,(st.collapsedSize!==Qe.collapsedSize||st.collapsible!==Qe.collapsible||st.maxSize!==Qe.maxSize||st.minSize!==Qe.minSize)&&ae(je.current,st)}),Ey(()=>{const Ze=je.current;return ve(Ze),()=>{ke(Ze)}},[I,Ce,ve,ke]),zce(l,()=>({collapse:()=>{G(je.current)},expand:Ze=>{H(je.current,Ze)},getId(){return Ce},getSize(){return J(je.current)},isCollapsed(){return de(je.current)},isExpanded(){return!de(je.current)},resize:Ze=>{Fe(je.current,Ze)}}),[G,H,J,de,Ce,Fe]);const tt=Q(je.current,a);return Fx($,{...B,children:e,className:t,id:h,style:{...tt,...F},"data-panel":"","data-panel-collapsible":n||void 0,"data-panel-group-id":oe,"data-panel-id":Ce,"data-panel-size":parseFloat(""+tt.flexGrow).toFixed(1)})}const Fce=Lce((e,t)=>Fx(jce,{...e,forwardedRef:t}));jce.displayName="Panel";Fce.displayName="forwardRef(Panel)";let nB=null,ly=null;function BJe(e,t){if(t){const r=(t&Wce)!==0,n=(t&Gce)!==0,a=(t&qce)!==0,l=(t&Hce)!==0;if(r)return a?"se-resize":l?"ne-resize":"e-resize";if(n)return a?"sw-resize":l?"nw-resize":"w-resize";if(a)return"s-resize";if(l)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function $Je(){ly!==null&&(document.head.removeChild(ly),nB=null,ly=null)}function GN(e,t){const r=BJe(e,t);nB!==r&&(nB=r,ly===null&&(ly=document.createElement("style"),document.head.appendChild(ly)),ly.innerHTML=`*{cursor: ${r}!important;}`)}function Bce(e){return e.type==="keydown"}function $ce(e){return e.type.startsWith("pointer")}function Uce(e){return e.type.startsWith("mouse")}function KR(e){if($ce(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Uce(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function UJe(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function VJe(e,t,r){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function WJe(e,t){if(e===t)throw new Error("Cannot compare node with itself");const r={a:yY(e),b:yY(t)};let n;for(;r.a.at(-1)===r.b.at(-1);)e=r.a.pop(),t=r.b.pop(),n=e;Wn(n,"Stacking order can only be calculated for elements with a common ancestor");const a={a:gY(mY(r.a)),b:gY(mY(r.b))};if(a.a===a.b){const l=n.childNodes,h={a:r.a.at(-1),b:r.b.at(-1)};let i=l.length;for(;i--;){const _=l[i];if(_===h.a)return 1;if(_===h.b)return-1}}return Math.sign(a.a-a.b)}const GJe=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function qJe(e){var t;const r=getComputedStyle((t=Vce(e))!==null&&t!==void 0?t:e).display;return r==="flex"||r==="inline-flex"}function HJe(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||qJe(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||GJe.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function mY(e){let t=e.length;for(;t--;){const r=e[t];if(Wn(r,"Missing node"),HJe(r))return r}return null}function gY(e){return e&&Number(getComputedStyle(e).zIndex)||0}function yY(e){const t=[];for(;e;)t.push(e),e=Vce(e);return t}function Vce(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const Wce=1,Gce=2,qce=4,Hce=8,ZJe=UJe()==="coarse";let Lu=[],R0=!1,jp=new Map,JR=new Map;const yE=new Set;function XJe(e,t,r,n,a){var l;const{ownerDocument:h}=t,i={direction:r,element:t,hitAreaMargins:n,setResizeHandlerState:a},_=(l=jp.get(h))!==null&&l!==void 0?l:0;return jp.set(h,_+1),yE.add(i),JO(),function(){var E;JR.delete(e),yE.delete(i);const C=(E=jp.get(h))!==null&&E!==void 0?E:1;if(jp.set(h,C-1),JO(),C===1&&jp.delete(h),Lu.includes(i)){const I=Lu.indexOf(i);I>=0&&Lu.splice(I,1),c6(),a("up",!0,null)}}}function vY(e){const{target:t}=e,{x:r,y:n}=KR(e);R0=!0,l6({target:t,x:r,y:n}),JO(),Lu.length>0&&(QO("down",e),e.preventDefault(),e.stopPropagation())}function Vw(e){const{x:t,y:r}=KR(e);if(R0&&e.buttons===0&&(R0=!1,QO("up",e)),!R0){const{target:n}=e;l6({target:n,x:t,y:r})}QO("move",e),c6(),Lu.length>0&&e.preventDefault()}function I_(e){const{target:t}=e,{x:r,y:n}=KR(e);JR.clear(),R0=!1,Lu.length>0&&e.preventDefault(),QO("up",e),l6({target:t,x:r,y:n}),c6(),JO()}function l6({target:e,x:t,y:r}){Lu.splice(0);let n=null;e instanceof HTMLElement&&(n=e),yE.forEach(a=>{const{element:l,hitAreaMargins:h}=a,i=l.getBoundingClientRect(),{bottom:_,left:b,right:E,top:C}=i,I=ZJe?h.coarse:h.fine;if(t>=b-I&&t<=E+I&&r>=C-I&&r<=_+I){if(n!==null&&document.contains(n)&&l!==n&&!l.contains(n)&&!n.contains(l)&&WJe(n,l)>0){let $=n,B=!1;for(;$&&!$.contains(l);){if(VJe($.getBoundingClientRect(),i)){B=!0;break}$=$.parentElement}if(B)return}Lu.push(a)}})}function qN(e,t){JR.set(e,t)}function c6(){let e=!1,t=!1;Lu.forEach(n=>{const{direction:a}=n;a==="horizontal"?e=!0:t=!0});let r=0;JR.forEach(n=>{r|=n}),e&&t?GN("intersection",r):e?GN("horizontal",r):t?GN("vertical",r):$Je()}function JO(){jp.forEach((e,t)=>{const{body:r}=t;r.removeEventListener("contextmenu",I_),r.removeEventListener("pointerdown",vY),r.removeEventListener("pointerleave",Vw),r.removeEventListener("pointermove",Vw)}),window.removeEventListener("pointerup",I_),window.removeEventListener("pointercancel",I_),yE.size>0&&(R0?(Lu.length>0&&jp.forEach((e,t)=>{const{body:r}=t;e>0&&(r.addEventListener("contextmenu",I_),r.addEventListener("pointerleave",Vw),r.addEventListener("pointermove",Vw))}),window.addEventListener("pointerup",I_),window.addEventListener("pointercancel",I_)):jp.forEach((e,t)=>{const{body:r}=t;e>0&&(r.addEventListener("pointerdown",vY,{capture:!0}),r.addEventListener("pointermove",Vw))}))}function QO(e,t){yE.forEach(r=>{const{setResizeHandlerState:n}=r,a=Lu.includes(r);n(e,a,t)})}function YJe(){const[e,t]=k0(0);return ll(()=>t(r=>r+1),[])}function Wn(e,t){if(!e)throw console.error(t),Error(t)}const u6=10;function Gy(e,t,r=u6){return e.toFixed(r)===t.toFixed(r)?0:e>t?1:-1}function Ph(e,t,r=u6){return Gy(e,t,r)===0}function Gl(e,t,r){return Gy(e,t,r)===0}function KJe(e,t,r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){const a=e[n],l=t[n];if(!Gl(a,l,r))return!1}return!0}function m0({panelConstraints:e,panelIndex:t,size:r}){const n=e[t];Wn(n!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:l,maxSize:h=100,minSize:i=0}=n;if(Gy(r,i)<0)if(l){const _=(a+i)/2;Gy(r,_)<0?r=a:r=i}else r=i;return r=Math.min(h,r),r=parseFloat(r.toFixed(u6)),r}function TS({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:n,prevLayout:a,trigger:l}){if(Gl(e,0))return t;const h=[...t],[i,_]=n;Wn(i!=null,"Invalid first pivot index"),Wn(_!=null,"Invalid second pivot index");let b=0;if(l==="keyboard"){{const C=e<0?_:i,I=r[C];Wn(I,`Panel constraints not found for index ${C}`);const{collapsedSize:F=0,collapsible:$,minSize:B=0}=I;if($){const q=t[C];if(Wn(q!=null,`Previous layout not found for panel index ${C}`),Gl(q,F)){const G=B-q;Gy(G,Math.abs(e))>0&&(e=e<0?0-G:G)}}}{const C=e<0?i:_,I=r[C];Wn(I,`No panel constraints found for index ${C}`);const{collapsedSize:F=0,collapsible:$,minSize:B=0}=I;if($){const q=t[C];if(Wn(q!=null,`Previous layout not found for panel index ${C}`),Gl(q,B)){const G=q-F;Gy(G,Math.abs(e))>0&&(e=e<0?0-G:G)}}}}{const C=e<0?1:-1;let I=e<0?_:i,F=0;for(;;){const B=t[I];Wn(B!=null,`Previous layout not found for panel index ${I}`);const G=m0({panelConstraints:r,panelIndex:I,size:100})-B;if(F+=G,I+=C,I<0||I>=r.length)break}const $=Math.min(Math.abs(e),Math.abs(F));e=e<0?0-$:$}{let I=e<0?i:_;for(;I>=0&&I<r.length;){const F=Math.abs(e)-Math.abs(b),$=t[I];Wn($!=null,`Previous layout not found for panel index ${I}`);const B=$-F,q=m0({panelConstraints:r,panelIndex:I,size:B});if(!Gl($,q)&&(b+=$-q,h[I]=q,b.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?I--:I++}}if(KJe(a,h))return a;{const C=e<0?_:i,I=t[C];Wn(I!=null,`Previous layout not found for panel index ${C}`);const F=I+b,$=m0({panelConstraints:r,panelIndex:C,size:F});if(h[C]=$,!Gl($,F)){let B=F-$,G=e<0?_:i;for(;G>=0&&G<r.length;){const H=h[G];Wn(H!=null,`Previous layout not found for panel index ${G}`);const J=H+B,Q=m0({panelConstraints:r,panelIndex:G,size:J});if(Gl(H,Q)||(B-=Q-H,h[G]=Q),Gl(B,0))break;e>0?G--:G++}}}const E=h.reduce((C,I)=>I+C,0);return Gl(E,100)?h:a}function JJe({layout:e,panelsArray:t,pivotIndices:r}){let n=0,a=100,l=0,h=0;const i=r[0];Wn(i!=null,"No pivot index found"),t.forEach((C,I)=>{const{constraints:F}=C,{maxSize:$=100,minSize:B=0}=F;I===i?(n=B,a=$):(l+=B,h+=$)});const _=Math.min(a,100-l),b=Math.max(n,100-h),E=e[i];return{valueMax:_,valueMin:b,valueNow:E}}function vE(e,t=document){return Array.from(t.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${e}"]`))}function Zce(e,t,r=document){const a=vE(e,r).findIndex(l=>l.getAttribute("data-panel-resize-handle-id")===t);return a??null}function Xce(e,t,r){const n=Zce(e,t,r);return n!=null?[n,n+1]:[-1,-1]}function Yce(e,t=document){var r;if(t instanceof HTMLElement&&(t==null||(r=t.dataset)===null||r===void 0?void 0:r.panelGroupId)==e)return t;const n=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return n||null}function QR(e,t=document){const r=t.querySelector(`[data-panel-resize-handle-id="${e}"]`);return r||null}function QJe(e,t,r,n=document){var a,l,h,i;const _=QR(t,n),b=vE(e,n),E=_?b.indexOf(_):-1,C=(a=(l=r[E])===null||l===void 0?void 0:l.id)!==null&&a!==void 0?a:null,I=(h=(i=r[E+1])===null||i===void 0?void 0:i.id)!==null&&h!==void 0?h:null;return[C,I]}function eQe({committedValuesRef:e,eagerValuesRef:t,groupId:r,layout:n,panelDataArray:a,panelGroupElement:l,setLayout:h}){ml({didWarnAboutMissingResizeHandle:!1}),Ey(()=>{if(!l)return;const i=vE(r,l);for(let _=0;_<a.length-1;_++){const{valueMax:b,valueMin:E,valueNow:C}=JJe({layout:n,panelsArray:a,pivotIndices:[_,_+1]}),I=i[_];if(I!=null){const F=a[_];Wn(F,`No panel data found for index "${_}"`),I.setAttribute("aria-controls",F.id),I.setAttribute("aria-valuemax",""+Math.round(b)),I.setAttribute("aria-valuemin",""+Math.round(E)),I.setAttribute("aria-valuenow",C!=null?""+Math.round(C):"")}}return()=>{i.forEach((_,b)=>{_.removeAttribute("aria-controls"),_.removeAttribute("aria-valuemax"),_.removeAttribute("aria-valuemin"),_.removeAttribute("aria-valuenow")})}},[r,n,a,l]),Ty(()=>{if(!l)return;const i=t.current;Wn(i,"Eager values not found");const{panelDataArray:_}=i,b=Yce(r,l);Wn(b!=null,`No group found for id "${r}"`);const E=vE(r,l);Wn(E,`No resize handles found for group id "${r}"`);const C=E.map(I=>{const F=I.getAttribute("data-panel-resize-handle-id");Wn(F,"Resize handle element has no handle id attribute");const[$,B]=QJe(r,F,_,l);if($==null||B==null)return()=>{};const q=G=>{if(!G.defaultPrevented)switch(G.key){case"Enter":{G.preventDefault();const H=_.findIndex(J=>J.id===$);if(H>=0){const J=_[H];Wn(J,`No panel data found for index ${H}`);const Q=n[H],{collapsedSize:oe=0,collapsible:de,minSize:ae=0}=J.constraints;if(Q!=null&&de){const ve=TS({delta:Gl(Q,oe)?ae-oe:oe-Q,initialLayout:n,panelConstraints:_.map(Fe=>Fe.constraints),pivotIndices:Xce(r,F,l),prevLayout:n,trigger:"keyboard"});n!==ve&&h(ve)}}break}}};return I.addEventListener("keydown",q),()=>{I.removeEventListener("keydown",q)}});return()=>{C.forEach(I=>I())}},[l,e,t,r,n,a,h])}function _Y(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Kce(e,t){const r=e==="horizontal",{x:n,y:a}=KR(t);return r?n:a}function tQe(e,t,r,n,a){const l=r==="horizontal",h=QR(t,a);Wn(h,`No resize handle element found for id "${t}"`);const i=h.getAttribute("data-panel-group-id");Wn(i,"Resize handle element has no group id attribute");let{initialCursorPosition:_}=n;const b=Kce(r,e),E=Yce(i,a);Wn(E,`No group element found for id "${i}"`);const C=E.getBoundingClientRect(),I=l?C.width:C.height;return(b-_)/I*100}function rQe(e,t,r,n,a,l){if(Bce(e)){const h=r==="horizontal";let i=0;e.shiftKey?i=100:a!=null?i=a:i=10;let _=0;switch(e.key){case"ArrowDown":_=h?0:i;break;case"ArrowLeft":_=h?-i:0;break;case"ArrowRight":_=h?i:0;break;case"ArrowUp":_=h?0:-i;break;case"End":_=100;break;case"Home":_=-100;break}return _}else return n==null?0:tQe(e,t,r,n,l)}function nQe({panelDataArray:e}){const t=Array(e.length),r=e.map(l=>l.constraints);let n=0,a=100;for(let l=0;l<e.length;l++){const h=r[l];Wn(h,`Panel constraints not found for index ${l}`);const{defaultSize:i}=h;i!=null&&(n++,t[l]=i,a-=i)}for(let l=0;l<e.length;l++){const h=r[l];Wn(h,`Panel constraints not found for index ${l}`);const{defaultSize:i}=h;if(i!=null)continue;const _=e.length-n,b=a/_;n++,t[l]=b,a-=b}return t}function O_(e,t,r){t.forEach((n,a)=>{const l=e[a];Wn(l,`Panel data not found for index ${a}`);const{callbacks:h,constraints:i,id:_}=l,{collapsedSize:b=0,collapsible:E}=i,C=r[_];if(C==null||n!==C){r[_]=n;const{onCollapse:I,onExpand:F,onResize:$}=h;$&&$(n,C),E&&(I||F)&&(F&&(C==null||Ph(C,b))&&!Ph(n,b)&&F(),I&&(C==null||!Ph(C,b))&&Ph(n,b)&&I())}})}function ZC(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function iQe({defaultSize:e,dragState:t,layout:r,panelData:n,panelIndex:a,precision:l=3}){const h=r[a];let i;return h==null?i=e!=null?e.toPrecision(l):"1":n.length===1?i="1":i=h.toPrecision(l),{flexBasis:0,flexGrow:i,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function oQe(e,t=10){let r=null;return(...a)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{e(...a)},t)}}function xY(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,r)=>{localStorage.setItem(t,r)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function Jce(e){return`react-resizable-panels:${e}`}function Qce(e){return e.map(t=>{const{constraints:r,id:n,idIsFromProps:a,order:l}=t;return a?n:l?`${l}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((t,r)=>t.localeCompare(r)).join(",")}function eue(e,t){try{const r=Jce(e),n=t.getItem(r);if(n){const a=JSON.parse(n);if(typeof a=="object"&&a!=null)return a}}catch{}return null}function aQe(e,t,r){var n,a;const l=(n=eue(e,r))!==null&&n!==void 0?n:{},h=Qce(t);return(a=l[h])!==null&&a!==void 0?a:null}function sQe(e,t,r,n,a){var l;const h=Jce(e),i=Qce(t),_=(l=eue(e,a))!==null&&l!==void 0?l:{};_[i]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{a.setItem(h,JSON.stringify(_))}catch(b){console.error(b)}}function bY({layout:e,panelConstraints:t}){const r=[...e],n=r.reduce((l,h)=>l+h,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(l=>`${l}%`).join(", ")}`);if(!Gl(n,100)&&r.length>0)for(let l=0;l<t.length;l++){const h=r[l];Wn(h!=null,`No layout data found for index ${l}`);const i=100/n*h;r[l]=i}let a=0;for(let l=0;l<t.length;l++){const h=r[l];Wn(h!=null,`No layout data found for index ${l}`);const i=m0({panelConstraints:t,panelIndex:l,size:h});h!=i&&(a+=h-i,r[l]=i)}if(!Gl(a,0))for(let l=0;l<t.length;l++){const h=r[l];Wn(h!=null,`No layout data found for index ${l}`);const i=h+a,_=m0({panelConstraints:t,panelIndex:l,size:i});if(h!==_&&(a-=_-h,r[l]=_,Gl(a,0)))break}return r}const lQe=100,ES={getItem:e=>(xY(ES),ES.getItem(e)),setItem:(e,t)=>{xY(ES),ES.setItem(e,t)}},wY={};function tue({autoSaveId:e=null,children:t,className:r="",direction:n,forwardedRef:a,id:l=null,onLayout:h=null,keyboardResizeBy:i=null,storage:_=ES,style:b,tagName:E="div",...C}){const I=s6(l),F=ml(null),[$,B]=k0(null),[q,G]=k0([]),H=YJe(),J=ml({}),Q=ml(new Map),oe=ml(0),de=ml({autoSaveId:e,direction:n,dragState:$,id:I,keyboardResizeBy:i,onLayout:h,storage:_}),ae=ml({layout:q,panelDataArray:[],panelDataArrayChanged:!1});ml({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),zce(a,()=>({getId:()=>de.current.id,getLayout:()=>{const{layout:ct}=ae.current;return ct},setLayout:ct=>{const{onLayout:nr}=de.current,{layout:mr,panelDataArray:ir}=ae.current,Ut=bY({layout:ct,panelConstraints:ir.map(hr=>hr.constraints)});_Y(mr,Ut)||(G(Ut),ae.current.layout=Ut,nr&&nr(Ut),O_(ir,Ut,J.current))}}),[]),Ey(()=>{de.current.autoSaveId=e,de.current.direction=n,de.current.dragState=$,de.current.id=I,de.current.onLayout=h,de.current.storage=_}),eQe({committedValuesRef:de,eagerValuesRef:ae,groupId:I,layout:q,panelDataArray:ae.current.panelDataArray,setLayout:G,panelGroupElement:F.current}),Ty(()=>{const{panelDataArray:ct}=ae.current;if(e){if(q.length===0||q.length!==ct.length)return;let nr=wY[e];nr==null&&(nr=oQe(sQe,lQe),wY[e]=nr);const mr=[...ct],ir=new Map(Q.current);nr(e,mr,ir,q,_)}},[e,q,_]),Ty(()=>{});const ve=ll(ct=>{const{onLayout:nr}=de.current,{layout:mr,panelDataArray:ir}=ae.current;if(ct.constraints.collapsible){const Ut=ir.map(ur=>ur.constraints),{collapsedSize:hr=0,panelSize:Vt,pivotIndices:ge}=zg(ir,ct,mr);if(Wn(Vt!=null,`Panel size not found for panel "${ct.id}"`),!Ph(Vt,hr)){Q.current.set(ct.id,Vt);const Ot=K_(ir,ct)===ir.length-1?Vt-hr:hr-Vt,tr=TS({delta:Ot,initialLayout:mr,panelConstraints:Ut,pivotIndices:ge,prevLayout:mr,trigger:"imperative-api"});ZC(mr,tr)||(G(tr),ae.current.layout=tr,nr&&nr(tr),O_(ir,tr,J.current))}}},[]),Fe=ll((ct,nr)=>{const{onLayout:mr}=de.current,{layout:ir,panelDataArray:Ut}=ae.current;if(ct.constraints.collapsible){const hr=Ut.map(xt=>xt.constraints),{collapsedSize:Vt=0,panelSize:ge=0,minSize:ur=0,pivotIndices:Ot}=zg(Ut,ct,ir),tr=nr??ur;if(Ph(ge,Vt)){const xt=Q.current.get(ct.id),un=xt!=null&&xt>=tr?xt:tr,Ln=K_(Ut,ct)===Ut.length-1?ge-un:un-ge,Ge=TS({delta:Ln,initialLayout:ir,panelConstraints:hr,pivotIndices:Ot,prevLayout:ir,trigger:"imperative-api"});ZC(ir,Ge)||(G(Ge),ae.current.layout=Ge,mr&&mr(Ge),O_(Ut,Ge,J.current))}}},[]),ke=ll(ct=>{const{layout:nr,panelDataArray:mr}=ae.current,{panelSize:ir}=zg(mr,ct,nr);return Wn(ir!=null,`Panel size not found for panel "${ct.id}"`),ir},[]),Ce=ll((ct,nr)=>{const{panelDataArray:mr}=ae.current,ir=K_(mr,ct);return iQe({defaultSize:nr,dragState:$,layout:q,panelData:mr,panelIndex:ir})},[$,q]),je=ll(ct=>{const{layout:nr,panelDataArray:mr}=ae.current,{collapsedSize:ir=0,collapsible:Ut,panelSize:hr}=zg(mr,ct,nr);return Wn(hr!=null,`Panel size not found for panel "${ct.id}"`),Ut===!0&&Ph(hr,ir)},[]),tt=ll(ct=>{const{layout:nr,panelDataArray:mr}=ae.current,{collapsedSize:ir=0,collapsible:Ut,panelSize:hr}=zg(mr,ct,nr);return Wn(hr!=null,`Panel size not found for panel "${ct.id}"`),!Ut||Gy(hr,ir)>0},[]),Ze=ll(ct=>{const{panelDataArray:nr}=ae.current;nr.push(ct),nr.sort((mr,ir)=>{const Ut=mr.order,hr=ir.order;return Ut==null&&hr==null?0:Ut==null?-1:hr==null?1:Ut-hr}),ae.current.panelDataArrayChanged=!0,H()},[H]);Ey(()=>{if(ae.current.panelDataArrayChanged){ae.current.panelDataArrayChanged=!1;const{autoSaveId:ct,onLayout:nr,storage:mr}=de.current,{layout:ir,panelDataArray:Ut}=ae.current;let hr=null;if(ct){const ge=aQe(ct,Ut,mr);ge&&(Q.current=new Map(Object.entries(ge.expandToSizes)),hr=ge.layout)}hr==null&&(hr=nQe({panelDataArray:Ut}));const Vt=bY({layout:hr,panelConstraints:Ut.map(ge=>ge.constraints)});_Y(ir,Vt)||(G(Vt),ae.current.layout=Vt,nr&&nr(Vt),O_(Ut,Vt,J.current))}}),Ey(()=>{const ct=ae.current;return()=>{ct.layout=[]}},[]);const Qe=ll(ct=>function(mr){mr.preventDefault();const ir=F.current;if(!ir)return()=>null;const{direction:Ut,dragState:hr,id:Vt,keyboardResizeBy:ge,onLayout:ur}=de.current,{layout:Ot,panelDataArray:tr}=ae.current,{initialLayout:xt}=hr??{},un=Xce(Vt,ct,ir);let Fr=rQe(mr,ct,Ut,hr,ge,ir);const Ln=Ut==="horizontal";document.dir==="rtl"&&Ln&&(Fr=-Fr);const Ge=tr.map(fr=>fr.constraints),vt=TS({delta:Fr,initialLayout:xt??Ot,panelConstraints:Ge,pivotIndices:un,prevLayout:Ot,trigger:Bce(mr)?"keyboard":"mouse-or-touch"}),kt=!ZC(Ot,vt);($ce(mr)||Uce(mr))&&oe.current!=Fr&&(oe.current=Fr,!kt&&Fr!==0?Ln?qN(ct,Fr<0?Wce:Gce):qN(ct,Fr<0?qce:Hce):qN(ct,0)),kt&&(G(vt),ae.current.layout=vt,ur&&ur(vt),O_(tr,vt,J.current))},[]),st=ll((ct,nr)=>{const{onLayout:mr}=de.current,{layout:ir,panelDataArray:Ut}=ae.current,hr=Ut.map(xt=>xt.constraints),{panelSize:Vt,pivotIndices:ge}=zg(Ut,ct,ir);Wn(Vt!=null,`Panel size not found for panel "${ct.id}"`);const Ot=K_(Ut,ct)===Ut.length-1?Vt-nr:nr-Vt,tr=TS({delta:Ot,initialLayout:ir,panelConstraints:hr,pivotIndices:ge,prevLayout:ir,trigger:"imperative-api"});ZC(ir,tr)||(G(tr),ae.current.layout=tr,mr&&mr(tr),O_(Ut,tr,J.current))},[]),ot=ll((ct,nr)=>{const{layout:mr,panelDataArray:ir}=ae.current,{collapsedSize:Ut=0,collapsible:hr}=nr,{collapsedSize:Vt=0,collapsible:ge,maxSize:ur=100,minSize:Ot=0}=ct.constraints,{panelSize:tr}=zg(ir,ct,mr);tr!=null&&(hr&&ge&&Ph(tr,Ut)?Ph(Ut,Vt)||st(ct,Vt):tr<Ot?st(ct,Ot):tr>ur&&st(ct,ur))},[st]),Be=ll((ct,nr)=>{const{direction:mr}=de.current,{layout:ir}=ae.current;if(!F.current)return;const Ut=QR(ct,F.current);Wn(Ut,`Drag handle element not found for id "${ct}"`);const hr=Kce(mr,nr);B({dragHandleId:ct,dragHandleRect:Ut.getBoundingClientRect(),initialCursorPosition:hr,initialLayout:ir})},[]),lt=ll(()=>{B(null)},[]),zt=ll(ct=>{const{panelDataArray:nr}=ae.current,mr=K_(nr,ct);mr>=0&&(nr.splice(mr,1),delete J.current[ct.id],ae.current.panelDataArrayChanged=!0,H())},[H]),Lt=NJe(()=>({collapsePanel:ve,direction:n,dragState:$,expandPanel:Fe,getPanelSize:ke,getPanelStyle:Ce,groupId:I,isPanelCollapsed:je,isPanelExpanded:tt,reevaluatePanelConstraints:ot,registerPanel:Ze,registerResizeHandle:Qe,resizePanel:st,startDragging:Be,stopDragging:lt,unregisterPanel:zt,panelGroupElement:F.current}),[ve,$,n,Fe,ke,Ce,I,je,tt,ot,Ze,Qe,st,Be,lt,zt]),Bt={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Fx(YR.Provider,{value:Lt},Fx(E,{...C,children:t,className:r,id:l,ref:F,style:{...Bt,...b},"data-panel-group":"","data-panel-group-direction":n,"data-panel-group-id":I}))}const rue=Lce((e,t)=>Fx(tue,{...e,forwardedRef:t}));tue.displayName="PanelGroup";rue.displayName="forwardRef(PanelGroup)";function K_(e,t){return e.findIndex(r=>r===t||r.id===t.id)}function zg(e,t,r){const n=K_(e,t),l=n===e.length-1?[n-1,n]:[n,n+1],h=r[n];return{...t.constraints,panelSize:h,pivotIndices:l}}function cQe({disabled:e,handleId:t,resizeHandler:r,panelGroupElement:n}){Ty(()=>{if(e||r==null||n==null)return;const a=QR(t,n);if(a==null)return;const l=h=>{if(!h.defaultPrevented)switch(h.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{h.preventDefault(),r(h);break}case"F6":{h.preventDefault();const i=a.getAttribute("data-panel-group-id");Wn(i,`No group element found for id "${i}"`);const _=vE(i,n),b=Zce(i,t,n);Wn(b!==null,`No resize element found for id "${t}"`);const E=h.shiftKey?b>0?b-1:_.length-1:b+1<_.length?b+1:0;_[E].focus();break}}};return a.addEventListener("keydown",l),()=>{a.removeEventListener("keydown",l)}},[n,e,t,r])}function nue({children:e=null,className:t="",disabled:r=!1,hitAreaMargins:n,id:a,onBlur:l,onDragging:h,onFocus:i,style:_={},tabIndex:b=0,tagName:E="div",...C}){var I,F;const $=ml(null),B=ml({onDragging:h});Ty(()=>{B.current.onDragging=h});const q=Nce(YR);if(q===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:G,groupId:H,registerResizeHandle:J,startDragging:Q,stopDragging:oe,panelGroupElement:de}=q,ae=s6(a),[ve,Fe]=k0("inactive"),[ke,Ce]=k0(!1),[je,tt]=k0(null),Ze=ml({state:ve});Ey(()=>{Ze.current.state=ve}),Ty(()=>{if(r)tt(null);else{const Be=J(ae);tt(()=>Be)}},[r,ae,J]);const Qe=(I=n==null?void 0:n.coarse)!==null&&I!==void 0?I:15,st=(F=n==null?void 0:n.fine)!==null&&F!==void 0?F:5;return Ty(()=>{if(r||je==null)return;const Be=$.current;return Wn(Be,"Element ref not attached"),XJe(ae,Be,G,{coarse:Qe,fine:st},(zt,Lt,Bt)=>{if(Lt)switch(zt){case"down":{Fe("drag"),Wn(Bt,'Expected event to be defined for "down" action'),Q(ae,Bt);const{onDragging:ct}=B.current;ct&&ct(!0);break}case"move":{const{state:ct}=Ze.current;ct!=="drag"&&Fe("hover"),Wn(Bt,'Expected event to be defined for "move" action'),je(Bt);break}case"up":{Fe("hover"),oe();const{onDragging:ct}=B.current;ct&&ct(!1);break}}else Fe("inactive")})},[Qe,G,r,st,J,ae,je,Q,oe]),cQe({disabled:r,handleId:ae,resizeHandler:je,panelGroupElement:de}),Fx(E,{...C,children:e,className:t,id:a,onBlur:()=>{Ce(!1),l==null||l()},onFocus:()=>{Ce(!0),i==null||i()},ref:$,role:"separator",style:{...{touchAction:"none",userSelect:"none"},..._},tabIndex:b,"data-panel-group-direction":G,"data-panel-group-id":H,"data-resize-handle":"","data-resize-handle-active":ve==="drag"?"pointer":ke?"keyboard":void 0,"data-resize-handle-state":ve,"data-panel-resize-handle-enabled":!r,"data-panel-resize-handle-id":ae})}nue.displayName="PanelResizeHandle";const uQe=({className:e,...t})=>j.jsx(rue,{className:Tr("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t}),SY=Fce,dQe=({withHandle:e,className:t,...r})=>j.jsx(nue,{className:Tr("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...r,children:e&&j.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:j.jsx(zge,{className:"h-2.5 w-2.5"})})}),hQe=()=>{const e=Jy(),{register:t,handleSubmit:r,setValue:n,formState:{errors:a,isSubmitting:l}}=SU(),h=async _=>{try{const{data:b,error:E}=await Oi.auth.getUser();if(E)throw E;if(!b.user){Md.error("Usuario no autenticado");return}const{error:C}=await Oi.from("orders").insert({..._,is_manual:!0,user_id:b.user.id,country:"MX"});if(C)throw C;Md.success("Orden manual creada exitosamente"),e("/admin/orders")}catch(b){console.error("Error creating manual order:",b),Md.error("Error al crear la orden manual")}},i=_=>{Object.entries(_).forEach(([b,E])=>{E&&n(b,E)}),Md.success("Dirección seleccionada correctamente")};return j.jsxs("div",{className:"py-6",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(Yn,{variant:"ghost",size:"sm",onClick:()=>e("/admin/orders"),className:"mr-2",children:j.jsx(mI,{className:"h-4 w-4"})}),j.jsx("h1",{className:"text-2xl font-bold",children:"Nueva Orden Manual"})]})}),j.jsx("form",{onSubmit:r(h),children:j.jsxs(uQe,{direction:"horizontal",className:"min-h-[600px] rounded-lg border",children:[j.jsx(SY,{defaultSize:50,minSize:30,children:j.jsxs("div",{className:"h-full overflow-y-auto p-6 space-y-6 bg-white",children:[j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"street",children:"Calle"}),j.jsx(wi,{id:"street",...t("street",{required:"La calle es requerida"}),placeholder:"Calle"}),a.street&&j.jsx("p",{className:"text-sm text-red-500",children:a.street.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"number",children:"Número"}),j.jsx(wi,{id:"number",...t("number",{required:"El número es requerido"}),placeholder:"Número exterior"}),a.number&&j.jsx("p",{className:"text-sm text-red-500",children:a.number.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"int_number",children:"Número Interior"}),j.jsx(wi,{id:"int_number",...t("int_number"),placeholder:"Número interior (opcional)"})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"neighborhood",children:"Colonia"}),j.jsx(wi,{id:"neighborhood",...t("neighborhood",{required:"La colonia es requerida"}),placeholder:"Colonia"}),a.neighborhood&&j.jsx("p",{className:"text-sm text-red-500",children:a.neighborhood.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"postal_code",children:"Código Postal"}),j.jsx(wi,{id:"postal_code",...t("postal_code",{required:"El código postal es requerido"}),placeholder:"Código postal"}),a.postal_code&&j.jsx("p",{className:"text-sm text-red-500",children:a.postal_code.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"administrative_area",children:"Estado"}),j.jsx(wi,{id:"administrative_area",...t("administrative_area",{required:"El estado es requerido"}),placeholder:"Estado"}),a.administrative_area&&j.jsx("p",{className:"text-sm text-red-500",children:a.administrative_area.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"sub_administrative_area",children:"Ciudad"}),j.jsx(wi,{id:"sub_administrative_area",...t("sub_administrative_area",{required:"La ciudad es requerida"}),placeholder:"Ciudad"}),a.sub_administrative_area&&j.jsx("p",{className:"text-sm text-red-500",children:a.sub_administrative_area.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"reference",children:"Referencia"}),j.jsx(wi,{id:"reference",...t("reference"),placeholder:"Referencia (opcional)"})]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"notes",children:"Notas"}),j.jsx(Lle,{id:"notes",...t("notes"),placeholder:"Notas adicionales (opcional)",className:"h-24"})]}),j.jsx("input",{type:"hidden",...t("lat")}),j.jsx("input",{type:"hidden",...t("lng")}),j.jsxs("div",{className:"flex justify-end space-x-4",children:[j.jsx(Yn,{type:"button",variant:"outline",onClick:()=>e("/admin/orders"),children:"Cancelar"}),j.jsxs(Yn,{type:"submit",disabled:l,children:[j.jsx($ge,{className:"h-4 w-4 mr-2"}),l?"Creando...":"Crear Orden"]})]})]})}),j.jsx(dQe,{withHandle:!0}),j.jsx(SY,{defaultSize:50,minSize:30,children:j.jsx(RJe,{onAddressSelect:i})})]})})]})},fQe=new V_e,pQe=()=>j.jsx(axe,{basename:"/r4logistica-demo",children:j.jsx(Z_e,{client:fQe,children:j.jsxs(C_e,{children:[j.jsx(Aye,{}),j.jsx(tve,{}),j.jsxs(J0e,{children:[j.jsx(ia,{path:"/",element:j.jsx(X0e,{to:"/login",replace:!0})}),j.jsx(ia,{path:"/login",element:j.jsx(k1e,{})}),j.jsxs(ia,{path:"/admin",element:j.jsx(O1e,{}),children:[j.jsx(ia,{index:!0,element:j.jsx(l8e,{})}),j.jsx(ia,{path:"create-user",element:j.jsx(R1e,{})}),j.jsx(ia,{path:"orders",element:j.jsx(sGe,{})}),j.jsx(ia,{path:"manual-order",element:j.jsx(hQe,{})}),j.jsx(ia,{path:"routes",element:j.jsx(eqe,{})}),j.jsx(ia,{path:"packages",element:j.jsx(Uqe,{})}),j.jsx(ia,{path:"inventory",element:j.jsx(Vqe,{})}),j.jsx(ia,{path:"fleet",element:j.jsx(Wqe,{})}),j.jsx(ia,{path:"operators",element:j.jsx(Gqe,{})}),j.jsx(ia,{path:"operators/new",element:j.jsx(NXe,{})}),j.jsx(ia,{path:"operators/:id/edit",element:j.jsx(zXe,{})}),j.jsx(ia,{path:"tms",element:j.jsx(jXe,{})}),j.jsx(ia,{path:"tracking",element:j.jsx(FXe,{})}),j.jsx(ia,{path:"documents",element:j.jsx(BXe,{})}),j.jsx(ia,{path:"settings",element:j.jsx($Xe,{})})]}),j.jsx(ia,{path:"*",element:j.jsx(UXe,{})})]})]})})});HJ(document.getElementById("root")).render(j.jsx(pQe,{}));export{yi as g};
