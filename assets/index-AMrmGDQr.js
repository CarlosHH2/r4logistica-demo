var aW=e=>{throw TypeError(e)};var OL=(e,t,r)=>t.has(e)||aW("Cannot "+r);var St=(e,t,r)=>(OL(e,t,"read from private field"),r?r.call(e):t.get(e)),Sn=(e,t,r)=>t.has(e)?aW("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Wr=(e,t,r,n)=>(OL(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ni=(e,t,r)=>(OL(e,t,"access private method"),r);var PA=(e,t,r,n)=>({set _(a){Wr(e,t,a,r)},get _(){return St(e,t,n)}});function Gde(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function qde(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var WX={exports:{}},OO={},GX={exports:{}},Yn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE=Symbol.for("react.element"),Hde=Symbol.for("react.portal"),Zde=Symbol.for("react.fragment"),Xde=Symbol.for("react.strict_mode"),Yde=Symbol.for("react.profiler"),Kde=Symbol.for("react.provider"),Jde=Symbol.for("react.context"),Qde=Symbol.for("react.forward_ref"),ehe=Symbol.for("react.suspense"),the=Symbol.for("react.memo"),rhe=Symbol.for("react.lazy"),sW=Symbol.iterator;function nhe(e){return e===null||typeof e!="object"?null:(e=sW&&e[sW]||e["@@iterator"],typeof e=="function"?e:null)}var qX={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HX=Object.assign,ZX={};function Ax(e,t,r){this.props=e,this.context=t,this.refs=ZX,this.updater=r||qX}Ax.prototype.isReactComponent={};Ax.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ax.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function XX(){}XX.prototype=Ax.prototype;function P4(e,t,r){this.props=e,this.context=t,this.refs=ZX,this.updater=r||qX}var I4=P4.prototype=new XX;I4.constructor=P4;HX(I4,Ax.prototype);I4.isPureReactComponent=!0;var lW=Array.isArray,YX=Object.prototype.hasOwnProperty,O4={current:null},KX={key:!0,ref:!0,__self:!0,__source:!0};function JX(e,t,r){var n,a={},l=null,f=null;if(t!=null)for(n in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(l=""+t.key),t)YX.call(t,n)&&!KX.hasOwnProperty(n)&&(a[n]=t[n]);var i=arguments.length-2;if(i===1)a.children=r;else if(1<i){for(var _=Array(i),b=0;b<i;b++)_[b]=arguments[b+2];a.children=_}if(e&&e.defaultProps)for(n in i=e.defaultProps,i)a[n]===void 0&&(a[n]=i[n]);return{$$typeof:aE,type:e,key:l,ref:f,props:a,_owner:O4.current}}function ihe(e,t){return{$$typeof:aE,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function k4(e){return typeof e=="object"&&e!==null&&e.$$typeof===aE}function ohe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var cW=/\/+/g;function kL(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ohe(""+e.key):t.toString(36)}function CM(e,t,r,n,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(l){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case aE:case Hde:f=!0}}if(f)return f=e,a=a(f),e=n===""?"."+kL(f,0):n,lW(a)?(r="",e!=null&&(r=e.replace(cW,"$&/")+"/"),CM(a,t,r,"",function(b){return b})):a!=null&&(k4(a)&&(a=ihe(a,r+(!a.key||f&&f.key===a.key?"":(""+a.key).replace(cW,"$&/")+"/")+e)),t.push(a)),1;if(f=0,n=n===""?".":n+":",lW(e))for(var i=0;i<e.length;i++){l=e[i];var _=n+kL(l,i);f+=CM(l,t,r,_,a)}else if(_=nhe(e),typeof _=="function")for(e=_.call(e),i=0;!(l=e.next()).done;)l=l.value,_=n+kL(l,i++),f+=CM(l,t,r,_,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function IA(e,t,r){if(e==null)return e;var n=[],a=0;return CM(e,n,"","",function(l){return t.call(r,l,a++)}),n}function ahe(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rs={current:null},PM={transition:null},she={ReactCurrentDispatcher:Rs,ReactCurrentBatchConfig:PM,ReactCurrentOwner:O4};function QX(){throw Error("act(...) is not supported in production builds of React.")}Yn.Children={map:IA,forEach:function(e,t,r){IA(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return IA(e,function(){t++}),t},toArray:function(e){return IA(e,function(t){return t})||[]},only:function(e){if(!k4(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Yn.Component=Ax;Yn.Fragment=Zde;Yn.Profiler=Yde;Yn.PureComponent=P4;Yn.StrictMode=Xde;Yn.Suspense=ehe;Yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=she;Yn.act=QX;Yn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=HX({},e.props),a=e.key,l=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,f=O4.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(_ in t)YX.call(t,_)&&!KX.hasOwnProperty(_)&&(n[_]=t[_]===void 0&&i!==void 0?i[_]:t[_])}var _=arguments.length-2;if(_===1)n.children=r;else if(1<_){i=Array(_);for(var b=0;b<_;b++)i[b]=arguments[b+2];n.children=i}return{$$typeof:aE,type:e.type,key:a,ref:l,props:n,_owner:f}};Yn.createContext=function(e){return e={$$typeof:Jde,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Kde,_context:e},e.Consumer=e};Yn.createElement=JX;Yn.createFactory=function(e){var t=JX.bind(null,e);return t.type=e,t};Yn.createRef=function(){return{current:null}};Yn.forwardRef=function(e){return{$$typeof:Qde,render:e}};Yn.isValidElement=k4;Yn.lazy=function(e){return{$$typeof:rhe,_payload:{_status:-1,_result:e},_init:ahe}};Yn.memo=function(e,t){return{$$typeof:the,type:e,compare:t===void 0?null:t}};Yn.startTransition=function(e){var t=PM.transition;PM.transition={};try{e()}finally{PM.transition=t}};Yn.unstable_act=QX;Yn.useCallback=function(e,t){return Rs.current.useCallback(e,t)};Yn.useContext=function(e){return Rs.current.useContext(e)};Yn.useDebugValue=function(){};Yn.useDeferredValue=function(e){return Rs.current.useDeferredValue(e)};Yn.useEffect=function(e,t){return Rs.current.useEffect(e,t)};Yn.useId=function(){return Rs.current.useId()};Yn.useImperativeHandle=function(e,t,r){return Rs.current.useImperativeHandle(e,t,r)};Yn.useInsertionEffect=function(e,t){return Rs.current.useInsertionEffect(e,t)};Yn.useLayoutEffect=function(e,t){return Rs.current.useLayoutEffect(e,t)};Yn.useMemo=function(e,t){return Rs.current.useMemo(e,t)};Yn.useReducer=function(e,t,r){return Rs.current.useReducer(e,t,r)};Yn.useRef=function(e){return Rs.current.useRef(e)};Yn.useState=function(e){return Rs.current.useState(e)};Yn.useSyncExternalStore=function(e,t,r){return Rs.current.useSyncExternalStore(e,t,r)};Yn.useTransition=function(){return Rs.current.useTransition()};Yn.version="18.3.1";GX.exports=Yn;var ne=GX.exports;const ze=hi(ne),kO=Gde({__proto__:null,default:ze},[ne]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lhe=ne,che=Symbol.for("react.element"),uhe=Symbol.for("react.fragment"),dhe=Object.prototype.hasOwnProperty,hhe=lhe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fhe={key:!0,ref:!0,__self:!0,__source:!0};function eY(e,t,r){var n,a={},l=null,f=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(f=t.ref);for(n in t)dhe.call(t,n)&&!fhe.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:che,type:e,key:l,ref:f,props:a,_owner:hhe.current}}OO.Fragment=uhe;OO.jsx=eY;OO.jsxs=eY;WX.exports=OO;var j=WX.exports,tY={exports:{}},Yl={},rY={exports:{}},nY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Be,ct){var jt=Be.length;Be.push(ct);e:for(;0<jt;){var Lt=jt-1>>>1,$t=Be[Lt];if(0<a($t,ct))Be[Lt]=ct,Be[jt]=$t,jt=Lt;else break e}}function r(Be){return Be.length===0?null:Be[0]}function n(Be){if(Be.length===0)return null;var ct=Be[0],jt=Be.pop();if(jt!==ct){Be[0]=jt;e:for(var Lt=0,$t=Be.length,ut=$t>>>1;Lt<ut;){var tr=2*(Lt+1)-1,mr=Be[tr],rr=tr+1,Ut=Be[rr];if(0>a(mr,jt))rr<$t&&0>a(Ut,mr)?(Be[Lt]=Ut,Be[rr]=jt,Lt=rr):(Be[Lt]=mr,Be[tr]=jt,Lt=tr);else if(rr<$t&&0>a(Ut,jt))Be[Lt]=Ut,Be[rr]=jt,Lt=rr;else break e}}return ct}function a(Be,ct){var jt=Be.sortIndex-ct.sortIndex;return jt!==0?jt:Be.id-ct.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var f=Date,i=f.now();e.unstable_now=function(){return f.now()-i}}var _=[],b=[],E=1,C=null,R=3,F=!1,U=!1,$=!1,H=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function J(Be){for(var ct=r(b);ct!==null;){if(ct.callback===null)n(b);else if(ct.startTime<=Be)n(b),ct.sortIndex=ct.expirationTime,t(_,ct);else break;ct=r(b)}}function te(Be){if($=!1,J(Be),!U)if(r(_)!==null)U=!0,st(oe);else{var ct=r(b);ct!==null&&at(te,ct.startTime-Be)}}function oe(Be,ct){U=!1,$&&($=!1,q(ve),ve=-1),F=!0;var jt=R;try{for(J(ct),C=r(_);C!==null&&(!(C.expirationTime>ct)||Be&&!Re());){var Lt=C.callback;if(typeof Lt=="function"){C.callback=null,R=C.priorityLevel;var $t=Lt(C.expirationTime<=ct);ct=e.unstable_now(),typeof $t=="function"?C.callback=$t:C===r(_)&&n(_),J(ct)}else n(_);C=r(_)}if(C!==null)var ut=!0;else{var tr=r(b);tr!==null&&at(te,tr.startTime-ct),ut=!1}return ut}finally{C=null,R=jt,F=!1}}var he=!1,le=null,ve=-1,We=5,Ie=-1;function Re(){return!(e.unstable_now()-Ie<We)}function $e(){if(le!==null){var Be=e.unstable_now();Ie=Be;var ct=!0;try{ct=le(!0,Be)}finally{ct?ot():(he=!1,le=null)}}else he=!1}var ot;if(typeof G=="function")ot=function(){G($e)};else if(typeof MessageChannel<"u"){var Je=new MessageChannel,rt=Je.port2;Je.port1.onmessage=$e,ot=function(){rt.postMessage(null)}}else ot=function(){H($e,0)};function st(Be){le=Be,he||(he=!0,ot())}function at(Be,ct){ve=H(function(){Be(e.unstable_now())},ct)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Be){Be.callback=null},e.unstable_continueExecution=function(){U||F||(U=!0,st(oe))},e.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):We=0<Be?Math.floor(1e3/Be):5},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return r(_)},e.unstable_next=function(Be){switch(R){case 1:case 2:case 3:var ct=3;break;default:ct=R}var jt=R;R=ct;try{return Be()}finally{R=jt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Be,ct){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var jt=R;R=Be;try{return ct()}finally{R=jt}},e.unstable_scheduleCallback=function(Be,ct,jt){var Lt=e.unstable_now();switch(typeof jt=="object"&&jt!==null?(jt=jt.delay,jt=typeof jt=="number"&&0<jt?Lt+jt:Lt):jt=Lt,Be){case 1:var $t=-1;break;case 2:$t=250;break;case 5:$t=1073741823;break;case 4:$t=1e4;break;default:$t=5e3}return $t=jt+$t,Be={id:E++,callback:ct,priorityLevel:Be,startTime:jt,expirationTime:$t,sortIndex:-1},jt>Lt?(Be.sortIndex=jt,t(b,Be),r(_)===null&&Be===r(b)&&($?(q(ve),ve=-1):$=!0,at(te,jt-Lt))):(Be.sortIndex=$t,t(_,Be),U||F||(U=!0,st(oe))),Be},e.unstable_shouldYield=Re,e.unstable_wrapCallback=function(Be){var ct=R;return function(){var jt=R;R=ct;try{return Be.apply(this,arguments)}finally{R=jt}}}})(nY);rY.exports=nY;var phe=rY.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mhe=ne,ql=phe;function ur(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iY=new Set,kS={};function ky(e,t){R0(e,t),R0(e+"Capture",t)}function R0(e,t){for(kS[e]=t,e=0;e<t.length;e++)iY.add(t[e])}var Nh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bN=Object.prototype.hasOwnProperty,ghe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uW={},dW={};function yhe(e){return bN.call(dW,e)?!0:bN.call(uW,e)?!1:ghe.test(e)?dW[e]=!0:(uW[e]=!0,!1)}function vhe(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _he(e,t,r,n){if(t===null||typeof t>"u"||vhe(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ds(e,t,r,n,a,l,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=f}var $a={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$a[e]=new Ds(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$a[t]=new Ds(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$a[e]=new Ds(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$a[e]=new Ds(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$a[e]=new Ds(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$a[e]=new Ds(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$a[e]=new Ds(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$a[e]=new Ds(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$a[e]=new Ds(e,5,!1,e.toLowerCase(),null,!1,!1)});var R4=/[\-:]([a-z])/g;function D4(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(R4,D4);$a[t]=new Ds(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(R4,D4);$a[t]=new Ds(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(R4,D4);$a[t]=new Ds(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$a[e]=new Ds(e,1,!1,e.toLowerCase(),null,!1,!1)});$a.xlinkHref=new Ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$a[e]=new Ds(e,1,!1,e.toLowerCase(),null,!0,!0)});function L4(e,t,r,n){var a=$a.hasOwnProperty(t)?$a[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(_he(t,r,a,n)&&(r=null),n||a===null?yhe(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Xh=mhe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,OA=Symbol.for("react.element"),j_=Symbol.for("react.portal"),F_=Symbol.for("react.fragment"),N4=Symbol.for("react.strict_mode"),wN=Symbol.for("react.profiler"),oY=Symbol.for("react.provider"),aY=Symbol.for("react.context"),z4=Symbol.for("react.forward_ref"),SN=Symbol.for("react.suspense"),TN=Symbol.for("react.suspense_list"),j4=Symbol.for("react.memo"),mp=Symbol.for("react.lazy"),sY=Symbol.for("react.offscreen"),hW=Symbol.iterator;function J1(e){return e===null||typeof e!="object"?null:(e=hW&&e[hW]||e["@@iterator"],typeof e=="function"?e:null)}var Mo=Object.assign,RL;function Aw(e){if(RL===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);RL=t&&t[1]||""}return`
`+RL+e}var DL=!1;function LL(e,t){if(!e||DL)return"";DL=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var n=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){n=b}e.call(t.prototype)}else{try{throw Error()}catch(b){n=b}e()}}catch(b){if(b&&n&&typeof b.stack=="string"){for(var a=b.stack.split(`
`),l=n.stack.split(`
`),f=a.length-1,i=l.length-1;1<=f&&0<=i&&a[f]!==l[i];)i--;for(;1<=f&&0<=i;f--,i--)if(a[f]!==l[i]){if(f!==1||i!==1)do if(f--,i--,0>i||a[f]!==l[i]){var _=`
`+a[f].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=f&&0<=i);break}}}finally{DL=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Aw(e):""}function xhe(e){switch(e.tag){case 5:return Aw(e.type);case 16:return Aw("Lazy");case 13:return Aw("Suspense");case 19:return Aw("SuspenseList");case 0:case 2:case 15:return e=LL(e.type,!1),e;case 11:return e=LL(e.type.render,!1),e;case 1:return e=LL(e.type,!0),e;default:return""}}function EN(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case F_:return"Fragment";case j_:return"Portal";case wN:return"Profiler";case N4:return"StrictMode";case SN:return"Suspense";case TN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case aY:return(e.displayName||"Context")+".Consumer";case oY:return(e._context.displayName||"Context")+".Provider";case z4:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case j4:return t=e.displayName||null,t!==null?t:EN(e.type)||"Memo";case mp:t=e._payload,e=e._init;try{return EN(e(t))}catch{}}return null}function bhe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return EN(t);case 8:return t===N4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Qp(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lY(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function whe(e){var t=lY(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,l=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(f){n=""+f,l.call(this,f)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(f){n=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function kA(e){e._valueTracker||(e._valueTracker=whe(e))}function cY(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=lY(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function wP(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function AN(e,t){var r=t.checked;return Mo({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function fW(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Qp(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function uY(e,t){t=t.checked,t!=null&&L4(e,"checked",t,!1)}function MN(e,t){uY(e,t);var r=Qp(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?CN(e,t.type,r):t.hasOwnProperty("defaultValue")&&CN(e,t.type,Qp(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function pW(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function CN(e,t,r){(t!=="number"||wP(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Mw=Array.isArray;function r0(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Qp(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function PN(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ur(91));return Mo({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mW(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ur(92));if(Mw(r)){if(1<r.length)throw Error(ur(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Qp(r)}}function dY(e,t){var r=Qp(t.value),n=Qp(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function gW(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hY(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function IN(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hY(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var RA,fY=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(RA=RA||document.createElement("div"),RA.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=RA.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function RS(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var lS={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},She=["Webkit","ms","Moz","O"];Object.keys(lS).forEach(function(e){She.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),lS[t]=lS[e]})});function pY(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||lS.hasOwnProperty(e)&&lS[e]?(""+t).trim():t+"px"}function mY(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=pY(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var The=Mo({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ON(e,t){if(t){if(The[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ur(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ur(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ur(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ur(62))}}function kN(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RN=null;function F4(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var DN=null,n0=null,i0=null;function yW(e){if(e=cE(e)){if(typeof DN!="function")throw Error(ur(280));var t=e.stateNode;t&&(t=zO(t),DN(e.stateNode,e.type,t))}}function gY(e){n0?i0?i0.push(e):i0=[e]:n0=e}function yY(){if(n0){var e=n0,t=i0;if(i0=n0=null,yW(e),t)for(e=0;e<t.length;e++)yW(t[e])}}function vY(e,t){return e(t)}function _Y(){}var NL=!1;function xY(e,t,r){if(NL)return e(t,r);NL=!0;try{return vY(e,t,r)}finally{NL=!1,(n0!==null||i0!==null)&&(_Y(),yY())}}function DS(e,t){var r=e.stateNode;if(r===null)return null;var n=zO(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ur(231,t,typeof r));return r}var LN=!1;if(Nh)try{var Q1={};Object.defineProperty(Q1,"passive",{get:function(){LN=!0}}),window.addEventListener("test",Q1,Q1),window.removeEventListener("test",Q1,Q1)}catch{LN=!1}function Ehe(e,t,r,n,a,l,f,i,_){var b=Array.prototype.slice.call(arguments,3);try{t.apply(r,b)}catch(E){this.onError(E)}}var cS=!1,SP=null,TP=!1,NN=null,Ahe={onError:function(e){cS=!0,SP=e}};function Mhe(e,t,r,n,a,l,f,i,_){cS=!1,SP=null,Ehe.apply(Ahe,arguments)}function Che(e,t,r,n,a,l,f,i,_){if(Mhe.apply(this,arguments),cS){if(cS){var b=SP;cS=!1,SP=null}else throw Error(ur(198));TP||(TP=!0,NN=b)}}function Ry(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function bY(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vW(e){if(Ry(e)!==e)throw Error(ur(188))}function Phe(e){var t=e.alternate;if(!t){if(t=Ry(e),t===null)throw Error(ur(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var l=a.alternate;if(l===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===r)return vW(a),e;if(l===n)return vW(a),t;l=l.sibling}throw Error(ur(188))}if(r.return!==n.return)r=a,n=l;else{for(var f=!1,i=a.child;i;){if(i===r){f=!0,r=a,n=l;break}if(i===n){f=!0,n=a,r=l;break}i=i.sibling}if(!f){for(i=l.child;i;){if(i===r){f=!0,r=l,n=a;break}if(i===n){f=!0,n=l,r=a;break}i=i.sibling}if(!f)throw Error(ur(189))}}if(r.alternate!==n)throw Error(ur(190))}if(r.tag!==3)throw Error(ur(188));return r.stateNode.current===r?e:t}function wY(e){return e=Phe(e),e!==null?SY(e):null}function SY(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=SY(e);if(t!==null)return t;e=e.sibling}return null}var TY=ql.unstable_scheduleCallback,_W=ql.unstable_cancelCallback,Ihe=ql.unstable_shouldYield,Ohe=ql.unstable_requestPaint,Wo=ql.unstable_now,khe=ql.unstable_getCurrentPriorityLevel,B4=ql.unstable_ImmediatePriority,EY=ql.unstable_UserBlockingPriority,EP=ql.unstable_NormalPriority,Rhe=ql.unstable_LowPriority,AY=ql.unstable_IdlePriority,RO=null,Ad=null;function Dhe(e){if(Ad&&typeof Ad.onCommitFiberRoot=="function")try{Ad.onCommitFiberRoot(RO,e,void 0,(e.current.flags&128)===128)}catch{}}var wu=Math.clz32?Math.clz32:zhe,Lhe=Math.log,Nhe=Math.LN2;function zhe(e){return e>>>=0,e===0?32:31-(Lhe(e)/Nhe|0)|0}var DA=64,LA=4194304;function Cw(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function AP(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,l=e.pingedLanes,f=r&268435455;if(f!==0){var i=f&~a;i!==0?n=Cw(i):(l&=f,l!==0&&(n=Cw(l)))}else f=r&~a,f!==0?n=Cw(f):l!==0&&(n=Cw(l));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-wu(t),a=1<<r,n|=e[r],t&=~a;return n}function jhe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fhe(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var f=31-wu(l),i=1<<f,_=a[f];_===-1?(!(i&r)||i&n)&&(a[f]=jhe(i,t)):_<=t&&(e.expiredLanes|=i),l&=~i}}function zN(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function MY(){var e=DA;return DA<<=1,!(DA&4194240)&&(DA=64),e}function zL(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function sE(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wu(t),e[t]=r}function Bhe(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-wu(r),l=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~l}}function $4(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-wu(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ri=0;function CY(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var PY,U4,IY,OY,kY,jN=!1,NA=[],Bp=null,$p=null,Up=null,LS=new Map,NS=new Map,_p=[],$he="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xW(e,t){switch(e){case"focusin":case"focusout":Bp=null;break;case"dragenter":case"dragleave":$p=null;break;case"mouseover":case"mouseout":Up=null;break;case"pointerover":case"pointerout":LS.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":NS.delete(t.pointerId)}}function ew(e,t,r,n,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:l,targetContainers:[a]},t!==null&&(t=cE(t),t!==null&&U4(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Uhe(e,t,r,n,a){switch(t){case"focusin":return Bp=ew(Bp,e,t,r,n,a),!0;case"dragenter":return $p=ew($p,e,t,r,n,a),!0;case"mouseover":return Up=ew(Up,e,t,r,n,a),!0;case"pointerover":var l=a.pointerId;return LS.set(l,ew(LS.get(l)||null,e,t,r,n,a)),!0;case"gotpointercapture":return l=a.pointerId,NS.set(l,ew(NS.get(l)||null,e,t,r,n,a)),!0}return!1}function RY(e){var t=jg(e.target);if(t!==null){var r=Ry(t);if(r!==null){if(t=r.tag,t===13){if(t=bY(r),t!==null){e.blockedOn=t,kY(e.priority,function(){IY(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function IM(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=FN(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);RN=n,r.target.dispatchEvent(n),RN=null}else return t=cE(r),t!==null&&U4(t),e.blockedOn=r,!1;t.shift()}return!0}function bW(e,t,r){IM(e)&&r.delete(t)}function Vhe(){jN=!1,Bp!==null&&IM(Bp)&&(Bp=null),$p!==null&&IM($p)&&($p=null),Up!==null&&IM(Up)&&(Up=null),LS.forEach(bW),NS.forEach(bW)}function tw(e,t){e.blockedOn===t&&(e.blockedOn=null,jN||(jN=!0,ql.unstable_scheduleCallback(ql.unstable_NormalPriority,Vhe)))}function zS(e){function t(a){return tw(a,e)}if(0<NA.length){tw(NA[0],e);for(var r=1;r<NA.length;r++){var n=NA[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Bp!==null&&tw(Bp,e),$p!==null&&tw($p,e),Up!==null&&tw(Up,e),LS.forEach(t),NS.forEach(t),r=0;r<_p.length;r++)n=_p[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<_p.length&&(r=_p[0],r.blockedOn===null);)RY(r),r.blockedOn===null&&_p.shift()}var o0=Xh.ReactCurrentBatchConfig,MP=!0;function Whe(e,t,r,n){var a=Ri,l=o0.transition;o0.transition=null;try{Ri=1,V4(e,t,r,n)}finally{Ri=a,o0.transition=l}}function Ghe(e,t,r,n){var a=Ri,l=o0.transition;o0.transition=null;try{Ri=4,V4(e,t,r,n)}finally{Ri=a,o0.transition=l}}function V4(e,t,r,n){if(MP){var a=FN(e,t,r,n);if(a===null)HL(e,t,n,CP,r),xW(e,n);else if(Uhe(a,e,t,r,n))n.stopPropagation();else if(xW(e,n),t&4&&-1<$he.indexOf(e)){for(;a!==null;){var l=cE(a);if(l!==null&&PY(l),l=FN(e,t,r,n),l===null&&HL(e,t,n,CP,r),l===a)break;a=l}a!==null&&n.stopPropagation()}else HL(e,t,n,null,r)}}var CP=null;function FN(e,t,r,n){if(CP=null,e=F4(n),e=jg(e),e!==null)if(t=Ry(e),t===null)e=null;else if(r=t.tag,r===13){if(e=bY(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return CP=e,null}function DY(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(khe()){case B4:return 1;case EY:return 4;case EP:case Rhe:return 16;case AY:return 536870912;default:return 16}default:return 16}}var Rp=null,W4=null,OM=null;function LY(){if(OM)return OM;var e,t=W4,r=t.length,n,a="value"in Rp?Rp.value:Rp.textContent,l=a.length;for(e=0;e<r&&t[e]===a[e];e++);var f=r-e;for(n=1;n<=f&&t[r-n]===a[l-n];n++);return OM=a.slice(e,1<n?1-n:void 0)}function kM(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zA(){return!0}function wW(){return!1}function Kl(e){function t(r,n,a,l,f){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=l,this.target=f,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(r=e[i],this[i]=r?r(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?zA:wW,this.isPropagationStopped=wW,this}return Mo(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=zA)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=zA)},persist:function(){},isPersistent:zA}),t}var Mx={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},G4=Kl(Mx),lE=Mo({},Mx,{view:0,detail:0}),qhe=Kl(lE),jL,FL,rw,DO=Mo({},lE,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:q4,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==rw&&(rw&&e.type==="mousemove"?(jL=e.screenX-rw.screenX,FL=e.screenY-rw.screenY):FL=jL=0,rw=e),jL)},movementY:function(e){return"movementY"in e?e.movementY:FL}}),SW=Kl(DO),Hhe=Mo({},DO,{dataTransfer:0}),Zhe=Kl(Hhe),Xhe=Mo({},lE,{relatedTarget:0}),BL=Kl(Xhe),Yhe=Mo({},Mx,{animationName:0,elapsedTime:0,pseudoElement:0}),Khe=Kl(Yhe),Jhe=Mo({},Mx,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Qhe=Kl(Jhe),efe=Mo({},Mx,{data:0}),TW=Kl(efe),tfe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rfe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nfe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ife(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nfe[e])?!!t[e]:!1}function q4(){return ife}var ofe=Mo({},lE,{key:function(e){if(e.key){var t=tfe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kM(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?rfe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:q4,charCode:function(e){return e.type==="keypress"?kM(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kM(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),afe=Kl(ofe),sfe=Mo({},DO,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),EW=Kl(sfe),lfe=Mo({},lE,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:q4}),cfe=Kl(lfe),ufe=Mo({},Mx,{propertyName:0,elapsedTime:0,pseudoElement:0}),dfe=Kl(ufe),hfe=Mo({},DO,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ffe=Kl(hfe),pfe=[9,13,27,32],H4=Nh&&"CompositionEvent"in window,uS=null;Nh&&"documentMode"in document&&(uS=document.documentMode);var mfe=Nh&&"TextEvent"in window&&!uS,NY=Nh&&(!H4||uS&&8<uS&&11>=uS),AW=" ",MW=!1;function zY(e,t){switch(e){case"keyup":return pfe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jY(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var B_=!1;function gfe(e,t){switch(e){case"compositionend":return jY(t);case"keypress":return t.which!==32?null:(MW=!0,AW);case"textInput":return e=t.data,e===AW&&MW?null:e;default:return null}}function yfe(e,t){if(B_)return e==="compositionend"||!H4&&zY(e,t)?(e=LY(),OM=W4=Rp=null,B_=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return NY&&t.locale!=="ko"?null:t.data;default:return null}}var vfe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function CW(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!vfe[e.type]:t==="textarea"}function FY(e,t,r,n){gY(n),t=PP(t,"onChange"),0<t.length&&(r=new G4("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var dS=null,jS=null;function _fe(e){YY(e,0)}function LO(e){var t=V_(e);if(cY(t))return e}function xfe(e,t){if(e==="change")return t}var BY=!1;if(Nh){var $L;if(Nh){var UL="oninput"in document;if(!UL){var PW=document.createElement("div");PW.setAttribute("oninput","return;"),UL=typeof PW.oninput=="function"}$L=UL}else $L=!1;BY=$L&&(!document.documentMode||9<document.documentMode)}function IW(){dS&&(dS.detachEvent("onpropertychange",$Y),jS=dS=null)}function $Y(e){if(e.propertyName==="value"&&LO(jS)){var t=[];FY(t,jS,e,F4(e)),xY(_fe,t)}}function bfe(e,t,r){e==="focusin"?(IW(),dS=t,jS=r,dS.attachEvent("onpropertychange",$Y)):e==="focusout"&&IW()}function wfe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return LO(jS)}function Sfe(e,t){if(e==="click")return LO(t)}function Tfe(e,t){if(e==="input"||e==="change")return LO(t)}function Efe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Cu=typeof Object.is=="function"?Object.is:Efe;function FS(e,t){if(Cu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!bN.call(t,a)||!Cu(e[a],t[a]))return!1}return!0}function OW(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function kW(e,t){var r=OW(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=OW(r)}}function UY(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?UY(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function VY(){for(var e=window,t=wP();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=wP(e.document)}return t}function Z4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Afe(e){var t=VY(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&UY(r.ownerDocument.documentElement,r)){if(n!==null&&Z4(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,l=Math.min(n.start,a);n=n.end===void 0?l:Math.min(n.end,a),!e.extend&&l>n&&(a=n,n=l,l=a),a=kW(r,l);var f=kW(r,n);a&&f&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>n?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Mfe=Nh&&"documentMode"in document&&11>=document.documentMode,$_=null,BN=null,hS=null,$N=!1;function RW(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$N||$_==null||$_!==wP(n)||(n=$_,"selectionStart"in n&&Z4(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),hS&&FS(hS,n)||(hS=n,n=PP(BN,"onSelect"),0<n.length&&(t=new G4("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$_)))}function jA(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var U_={animationend:jA("Animation","AnimationEnd"),animationiteration:jA("Animation","AnimationIteration"),animationstart:jA("Animation","AnimationStart"),transitionend:jA("Transition","TransitionEnd")},VL={},WY={};Nh&&(WY=document.createElement("div").style,"AnimationEvent"in window||(delete U_.animationend.animation,delete U_.animationiteration.animation,delete U_.animationstart.animation),"TransitionEvent"in window||delete U_.transitionend.transition);function NO(e){if(VL[e])return VL[e];if(!U_[e])return e;var t=U_[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in WY)return VL[e]=t[r];return e}var GY=NO("animationend"),qY=NO("animationiteration"),HY=NO("animationstart"),ZY=NO("transitionend"),XY=new Map,DW="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fm(e,t){XY.set(e,t),ky(t,[e])}for(var WL=0;WL<DW.length;WL++){var GL=DW[WL],Cfe=GL.toLowerCase(),Pfe=GL[0].toUpperCase()+GL.slice(1);fm(Cfe,"on"+Pfe)}fm(GY,"onAnimationEnd");fm(qY,"onAnimationIteration");fm(HY,"onAnimationStart");fm("dblclick","onDoubleClick");fm("focusin","onFocus");fm("focusout","onBlur");fm(ZY,"onTransitionEnd");R0("onMouseEnter",["mouseout","mouseover"]);R0("onMouseLeave",["mouseout","mouseover"]);R0("onPointerEnter",["pointerout","pointerover"]);R0("onPointerLeave",["pointerout","pointerover"]);ky("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ky("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ky("onBeforeInput",["compositionend","keypress","textInput","paste"]);ky("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ky("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ky("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ife=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pw));function LW(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Che(n,t,void 0,e),e.currentTarget=null}function YY(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var l=void 0;if(t)for(var f=n.length-1;0<=f;f--){var i=n[f],_=i.instance,b=i.currentTarget;if(i=i.listener,_!==l&&a.isPropagationStopped())break e;LW(a,i,b),l=_}else for(f=0;f<n.length;f++){if(i=n[f],_=i.instance,b=i.currentTarget,i=i.listener,_!==l&&a.isPropagationStopped())break e;LW(a,i,b),l=_}}}if(TP)throw e=NN,TP=!1,NN=null,e}function so(e,t){var r=t[qN];r===void 0&&(r=t[qN]=new Set);var n=e+"__bubble";r.has(n)||(KY(t,e,2,!1),r.add(n))}function qL(e,t,r){var n=0;t&&(n|=4),KY(r,e,n,t)}var FA="_reactListening"+Math.random().toString(36).slice(2);function BS(e){if(!e[FA]){e[FA]=!0,iY.forEach(function(r){r!=="selectionchange"&&(Ife.has(r)||qL(r,!1,e),qL(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[FA]||(t[FA]=!0,qL("selectionchange",!1,t))}}function KY(e,t,r,n){switch(DY(t)){case 1:var a=Whe;break;case 4:a=Ghe;break;default:a=V4}r=a.bind(null,t,r,e),a=void 0,!LN||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function HL(e,t,r,n,a){var l=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var f=n.tag;if(f===3||f===4){var i=n.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(f===4)for(f=n.return;f!==null;){var _=f.tag;if((_===3||_===4)&&(_=f.stateNode.containerInfo,_===a||_.nodeType===8&&_.parentNode===a))return;f=f.return}for(;i!==null;){if(f=jg(i),f===null)return;if(_=f.tag,_===5||_===6){n=l=f;continue e}i=i.parentNode}}n=n.return}xY(function(){var b=l,E=F4(r),C=[];e:{var R=XY.get(e);if(R!==void 0){var F=G4,U=e;switch(e){case"keypress":if(kM(r)===0)break e;case"keydown":case"keyup":F=afe;break;case"focusin":U="focus",F=BL;break;case"focusout":U="blur",F=BL;break;case"beforeblur":case"afterblur":F=BL;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=SW;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=Zhe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=cfe;break;case GY:case qY:case HY:F=Khe;break;case ZY:F=dfe;break;case"scroll":F=qhe;break;case"wheel":F=ffe;break;case"copy":case"cut":case"paste":F=Qhe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=EW}var $=(t&4)!==0,H=!$&&e==="scroll",q=$?R!==null?R+"Capture":null:R;$=[];for(var G=b,J;G!==null;){J=G;var te=J.stateNode;if(J.tag===5&&te!==null&&(J=te,q!==null&&(te=DS(G,q),te!=null&&$.push($S(G,te,J)))),H)break;G=G.return}0<$.length&&(R=new F(R,U,null,r,E),C.push({event:R,listeners:$}))}}if(!(t&7)){e:{if(R=e==="mouseover"||e==="pointerover",F=e==="mouseout"||e==="pointerout",R&&r!==RN&&(U=r.relatedTarget||r.fromElement)&&(jg(U)||U[zh]))break e;if((F||R)&&(R=E.window===E?E:(R=E.ownerDocument)?R.defaultView||R.parentWindow:window,F?(U=r.relatedTarget||r.toElement,F=b,U=U?jg(U):null,U!==null&&(H=Ry(U),U!==H||U.tag!==5&&U.tag!==6)&&(U=null)):(F=null,U=b),F!==U)){if($=SW,te="onMouseLeave",q="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&($=EW,te="onPointerLeave",q="onPointerEnter",G="pointer"),H=F==null?R:V_(F),J=U==null?R:V_(U),R=new $(te,G+"leave",F,r,E),R.target=H,R.relatedTarget=J,te=null,jg(E)===b&&($=new $(q,G+"enter",U,r,E),$.target=J,$.relatedTarget=H,te=$),H=te,F&&U)t:{for($=F,q=U,G=0,J=$;J;J=n_(J))G++;for(J=0,te=q;te;te=n_(te))J++;for(;0<G-J;)$=n_($),G--;for(;0<J-G;)q=n_(q),J--;for(;G--;){if($===q||q!==null&&$===q.alternate)break t;$=n_($),q=n_(q)}$=null}else $=null;F!==null&&NW(C,R,F,$,!1),U!==null&&H!==null&&NW(C,H,U,$,!0)}}e:{if(R=b?V_(b):window,F=R.nodeName&&R.nodeName.toLowerCase(),F==="select"||F==="input"&&R.type==="file")var oe=xfe;else if(CW(R))if(BY)oe=Tfe;else{oe=wfe;var he=bfe}else(F=R.nodeName)&&F.toLowerCase()==="input"&&(R.type==="checkbox"||R.type==="radio")&&(oe=Sfe);if(oe&&(oe=oe(e,b))){FY(C,oe,r,E);break e}he&&he(e,R,b),e==="focusout"&&(he=R._wrapperState)&&he.controlled&&R.type==="number"&&CN(R,"number",R.value)}switch(he=b?V_(b):window,e){case"focusin":(CW(he)||he.contentEditable==="true")&&($_=he,BN=b,hS=null);break;case"focusout":hS=BN=$_=null;break;case"mousedown":$N=!0;break;case"contextmenu":case"mouseup":case"dragend":$N=!1,RW(C,r,E);break;case"selectionchange":if(Mfe)break;case"keydown":case"keyup":RW(C,r,E)}var le;if(H4)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else B_?zY(e,r)&&(ve="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ve="onCompositionStart");ve&&(NY&&r.locale!=="ko"&&(B_||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&B_&&(le=LY()):(Rp=E,W4="value"in Rp?Rp.value:Rp.textContent,B_=!0)),he=PP(b,ve),0<he.length&&(ve=new TW(ve,e,null,r,E),C.push({event:ve,listeners:he}),le?ve.data=le:(le=jY(r),le!==null&&(ve.data=le)))),(le=mfe?gfe(e,r):yfe(e,r))&&(b=PP(b,"onBeforeInput"),0<b.length&&(E=new TW("onBeforeInput","beforeinput",null,r,E),C.push({event:E,listeners:b}),E.data=le))}YY(C,t)})}function $S(e,t,r){return{instance:e,listener:t,currentTarget:r}}function PP(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=DS(e,r),l!=null&&n.unshift($S(e,l,a)),l=DS(e,t),l!=null&&n.push($S(e,l,a))),e=e.return}return n}function n_(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function NW(e,t,r,n,a){for(var l=t._reactName,f=[];r!==null&&r!==n;){var i=r,_=i.alternate,b=i.stateNode;if(_!==null&&_===n)break;i.tag===5&&b!==null&&(i=b,a?(_=DS(r,l),_!=null&&f.unshift($S(r,_,i))):a||(_=DS(r,l),_!=null&&f.push($S(r,_,i)))),r=r.return}f.length!==0&&e.push({event:t,listeners:f})}var Ofe=/\r\n?/g,kfe=/\u0000|\uFFFD/g;function zW(e){return(typeof e=="string"?e:""+e).replace(Ofe,`
`).replace(kfe,"")}function BA(e,t,r){if(t=zW(t),zW(e)!==t&&r)throw Error(ur(425))}function IP(){}var UN=null,VN=null;function WN(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var GN=typeof setTimeout=="function"?setTimeout:void 0,Rfe=typeof clearTimeout=="function"?clearTimeout:void 0,jW=typeof Promise=="function"?Promise:void 0,Dfe=typeof queueMicrotask=="function"?queueMicrotask:typeof jW<"u"?function(e){return jW.resolve(null).then(e).catch(Lfe)}:GN;function Lfe(e){setTimeout(function(){throw e})}function ZL(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),zS(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);zS(t)}function Vp(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function FW(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Cx=Math.random().toString(36).slice(2),yd="__reactFiber$"+Cx,US="__reactProps$"+Cx,zh="__reactContainer$"+Cx,qN="__reactEvents$"+Cx,Nfe="__reactListeners$"+Cx,zfe="__reactHandles$"+Cx;function jg(e){var t=e[yd];if(t)return t;for(var r=e.parentNode;r;){if(t=r[zh]||r[yd]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=FW(e);e!==null;){if(r=e[yd])return r;e=FW(e)}return t}e=r,r=e.parentNode}return null}function cE(e){return e=e[yd]||e[zh],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function V_(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ur(33))}function zO(e){return e[US]||null}var HN=[],W_=-1;function pm(e){return{current:e}}function uo(e){0>W_||(e.current=HN[W_],HN[W_]=null,W_--)}function eo(e,t){W_++,HN[W_]=e.current,e.current=t}var em={},os=pm(em),ul=pm(!1),fy=em;function D0(e,t){var r=e.type.contextTypes;if(!r)return em;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in r)a[l]=t[l];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function dl(e){return e=e.childContextTypes,e!=null}function OP(){uo(ul),uo(os)}function BW(e,t,r){if(os.current!==em)throw Error(ur(168));eo(os,t),eo(ul,r)}function JY(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ur(108,bhe(e)||"Unknown",a));return Mo({},r,n)}function kP(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||em,fy=os.current,eo(os,e),eo(ul,ul.current),!0}function $W(e,t,r){var n=e.stateNode;if(!n)throw Error(ur(169));r?(e=JY(e,t,fy),n.__reactInternalMemoizedMergedChildContext=e,uo(ul),uo(os),eo(os,e)):uo(ul),eo(ul,r)}var _h=null,jO=!1,XL=!1;function QY(e){_h===null?_h=[e]:_h.push(e)}function jfe(e){jO=!0,QY(e)}function mm(){if(!XL&&_h!==null){XL=!0;var e=0,t=Ri;try{var r=_h;for(Ri=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}_h=null,jO=!1}catch(a){throw _h!==null&&(_h=_h.slice(e+1)),TY(B4,mm),a}finally{Ri=t,XL=!1}}return null}var G_=[],q_=0,RP=null,DP=0,yc=[],vc=0,py=null,bh=1,wh="";function Tg(e,t){G_[q_++]=DP,G_[q_++]=RP,RP=e,DP=t}function eK(e,t,r){yc[vc++]=bh,yc[vc++]=wh,yc[vc++]=py,py=e;var n=bh;e=wh;var a=32-wu(n)-1;n&=~(1<<a),r+=1;var l=32-wu(t)+a;if(30<l){var f=a-a%5;l=(n&(1<<f)-1).toString(32),n>>=f,a-=f,bh=1<<32-wu(t)+a|r<<a|n,wh=l+e}else bh=1<<l|r<<a|n,wh=e}function X4(e){e.return!==null&&(Tg(e,1),eK(e,1,0))}function Y4(e){for(;e===RP;)RP=G_[--q_],G_[q_]=null,DP=G_[--q_],G_[q_]=null;for(;e===py;)py=yc[--vc],yc[vc]=null,wh=yc[--vc],yc[vc]=null,bh=yc[--vc],yc[vc]=null}var Ul=null,Bl=null,go=!1,mu=null;function tK(e,t){var r=bc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function UW(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ul=e,Bl=Vp(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ul=e,Bl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=py!==null?{id:bh,overflow:wh}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=bc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ul=e,Bl=null,!0):!1;default:return!1}}function ZN(e){return(e.mode&1)!==0&&(e.flags&128)===0}function XN(e){if(go){var t=Bl;if(t){var r=t;if(!UW(e,t)){if(ZN(e))throw Error(ur(418));t=Vp(r.nextSibling);var n=Ul;t&&UW(e,t)?tK(n,r):(e.flags=e.flags&-4097|2,go=!1,Ul=e)}}else{if(ZN(e))throw Error(ur(418));e.flags=e.flags&-4097|2,go=!1,Ul=e}}}function VW(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ul=e}function $A(e){if(e!==Ul)return!1;if(!go)return VW(e),go=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!WN(e.type,e.memoizedProps)),t&&(t=Bl)){if(ZN(e))throw rK(),Error(ur(418));for(;t;)tK(e,t),t=Vp(t.nextSibling)}if(VW(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ur(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Bl=Vp(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Bl=null}}else Bl=Ul?Vp(e.stateNode.nextSibling):null;return!0}function rK(){for(var e=Bl;e;)e=Vp(e.nextSibling)}function L0(){Bl=Ul=null,go=!1}function K4(e){mu===null?mu=[e]:mu.push(e)}var Ffe=Xh.ReactCurrentBatchConfig;function nw(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ur(309));var n=r.stateNode}if(!n)throw Error(ur(147,e));var a=n,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(f){var i=a.refs;f===null?delete i[l]:i[l]=f},t._stringRef=l,t)}if(typeof e!="string")throw Error(ur(284));if(!r._owner)throw Error(ur(290,e))}return e}function UA(e,t){throw e=Object.prototype.toString.call(t),Error(ur(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function WW(e){var t=e._init;return t(e._payload)}function nK(e){function t(q,G){if(e){var J=q.deletions;J===null?(q.deletions=[G],q.flags|=16):J.push(G)}}function r(q,G){if(!e)return null;for(;G!==null;)t(q,G),G=G.sibling;return null}function n(q,G){for(q=new Map;G!==null;)G.key!==null?q.set(G.key,G):q.set(G.index,G),G=G.sibling;return q}function a(q,G){return q=Hp(q,G),q.index=0,q.sibling=null,q}function l(q,G,J){return q.index=J,e?(J=q.alternate,J!==null?(J=J.index,J<G?(q.flags|=2,G):J):(q.flags|=2,G)):(q.flags|=1048576,G)}function f(q){return e&&q.alternate===null&&(q.flags|=2),q}function i(q,G,J,te){return G===null||G.tag!==6?(G=r3(J,q.mode,te),G.return=q,G):(G=a(G,J),G.return=q,G)}function _(q,G,J,te){var oe=J.type;return oe===F_?E(q,G,J.props.children,te,J.key):G!==null&&(G.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===mp&&WW(oe)===G.type)?(te=a(G,J.props),te.ref=nw(q,G,J),te.return=q,te):(te=FM(J.type,J.key,J.props,null,q.mode,te),te.ref=nw(q,G,J),te.return=q,te)}function b(q,G,J,te){return G===null||G.tag!==4||G.stateNode.containerInfo!==J.containerInfo||G.stateNode.implementation!==J.implementation?(G=n3(J,q.mode,te),G.return=q,G):(G=a(G,J.children||[]),G.return=q,G)}function E(q,G,J,te,oe){return G===null||G.tag!==7?(G=ny(J,q.mode,te,oe),G.return=q,G):(G=a(G,J),G.return=q,G)}function C(q,G,J){if(typeof G=="string"&&G!==""||typeof G=="number")return G=r3(""+G,q.mode,J),G.return=q,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case OA:return J=FM(G.type,G.key,G.props,null,q.mode,J),J.ref=nw(q,null,G),J.return=q,J;case j_:return G=n3(G,q.mode,J),G.return=q,G;case mp:var te=G._init;return C(q,te(G._payload),J)}if(Mw(G)||J1(G))return G=ny(G,q.mode,J,null),G.return=q,G;UA(q,G)}return null}function R(q,G,J,te){var oe=G!==null?G.key:null;if(typeof J=="string"&&J!==""||typeof J=="number")return oe!==null?null:i(q,G,""+J,te);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case OA:return J.key===oe?_(q,G,J,te):null;case j_:return J.key===oe?b(q,G,J,te):null;case mp:return oe=J._init,R(q,G,oe(J._payload),te)}if(Mw(J)||J1(J))return oe!==null?null:E(q,G,J,te,null);UA(q,J)}return null}function F(q,G,J,te,oe){if(typeof te=="string"&&te!==""||typeof te=="number")return q=q.get(J)||null,i(G,q,""+te,oe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case OA:return q=q.get(te.key===null?J:te.key)||null,_(G,q,te,oe);case j_:return q=q.get(te.key===null?J:te.key)||null,b(G,q,te,oe);case mp:var he=te._init;return F(q,G,J,he(te._payload),oe)}if(Mw(te)||J1(te))return q=q.get(J)||null,E(G,q,te,oe,null);UA(G,te)}return null}function U(q,G,J,te){for(var oe=null,he=null,le=G,ve=G=0,We=null;le!==null&&ve<J.length;ve++){le.index>ve?(We=le,le=null):We=le.sibling;var Ie=R(q,le,J[ve],te);if(Ie===null){le===null&&(le=We);break}e&&le&&Ie.alternate===null&&t(q,le),G=l(Ie,G,ve),he===null?oe=Ie:he.sibling=Ie,he=Ie,le=We}if(ve===J.length)return r(q,le),go&&Tg(q,ve),oe;if(le===null){for(;ve<J.length;ve++)le=C(q,J[ve],te),le!==null&&(G=l(le,G,ve),he===null?oe=le:he.sibling=le,he=le);return go&&Tg(q,ve),oe}for(le=n(q,le);ve<J.length;ve++)We=F(le,q,ve,J[ve],te),We!==null&&(e&&We.alternate!==null&&le.delete(We.key===null?ve:We.key),G=l(We,G,ve),he===null?oe=We:he.sibling=We,he=We);return e&&le.forEach(function(Re){return t(q,Re)}),go&&Tg(q,ve),oe}function $(q,G,J,te){var oe=J1(J);if(typeof oe!="function")throw Error(ur(150));if(J=oe.call(J),J==null)throw Error(ur(151));for(var he=oe=null,le=G,ve=G=0,We=null,Ie=J.next();le!==null&&!Ie.done;ve++,Ie=J.next()){le.index>ve?(We=le,le=null):We=le.sibling;var Re=R(q,le,Ie.value,te);if(Re===null){le===null&&(le=We);break}e&&le&&Re.alternate===null&&t(q,le),G=l(Re,G,ve),he===null?oe=Re:he.sibling=Re,he=Re,le=We}if(Ie.done)return r(q,le),go&&Tg(q,ve),oe;if(le===null){for(;!Ie.done;ve++,Ie=J.next())Ie=C(q,Ie.value,te),Ie!==null&&(G=l(Ie,G,ve),he===null?oe=Ie:he.sibling=Ie,he=Ie);return go&&Tg(q,ve),oe}for(le=n(q,le);!Ie.done;ve++,Ie=J.next())Ie=F(le,q,ve,Ie.value,te),Ie!==null&&(e&&Ie.alternate!==null&&le.delete(Ie.key===null?ve:Ie.key),G=l(Ie,G,ve),he===null?oe=Ie:he.sibling=Ie,he=Ie);return e&&le.forEach(function($e){return t(q,$e)}),go&&Tg(q,ve),oe}function H(q,G,J,te){if(typeof J=="object"&&J!==null&&J.type===F_&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case OA:e:{for(var oe=J.key,he=G;he!==null;){if(he.key===oe){if(oe=J.type,oe===F_){if(he.tag===7){r(q,he.sibling),G=a(he,J.props.children),G.return=q,q=G;break e}}else if(he.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===mp&&WW(oe)===he.type){r(q,he.sibling),G=a(he,J.props),G.ref=nw(q,he,J),G.return=q,q=G;break e}r(q,he);break}else t(q,he);he=he.sibling}J.type===F_?(G=ny(J.props.children,q.mode,te,J.key),G.return=q,q=G):(te=FM(J.type,J.key,J.props,null,q.mode,te),te.ref=nw(q,G,J),te.return=q,q=te)}return f(q);case j_:e:{for(he=J.key;G!==null;){if(G.key===he)if(G.tag===4&&G.stateNode.containerInfo===J.containerInfo&&G.stateNode.implementation===J.implementation){r(q,G.sibling),G=a(G,J.children||[]),G.return=q,q=G;break e}else{r(q,G);break}else t(q,G);G=G.sibling}G=n3(J,q.mode,te),G.return=q,q=G}return f(q);case mp:return he=J._init,H(q,G,he(J._payload),te)}if(Mw(J))return U(q,G,J,te);if(J1(J))return $(q,G,J,te);UA(q,J)}return typeof J=="string"&&J!==""||typeof J=="number"?(J=""+J,G!==null&&G.tag===6?(r(q,G.sibling),G=a(G,J),G.return=q,q=G):(r(q,G),G=r3(J,q.mode,te),G.return=q,q=G),f(q)):r(q,G)}return H}var N0=nK(!0),iK=nK(!1),LP=pm(null),NP=null,H_=null,J4=null;function Q4(){J4=H_=NP=null}function eB(e){var t=LP.current;uo(LP),e._currentValue=t}function YN(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function a0(e,t){NP=e,J4=H_=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(al=!0),e.firstContext=null)}function Mc(e){var t=e._currentValue;if(J4!==e)if(e={context:e,memoizedValue:t,next:null},H_===null){if(NP===null)throw Error(ur(308));H_=e,NP.dependencies={lanes:0,firstContext:e}}else H_=H_.next=e;return t}var Fg=null;function tB(e){Fg===null?Fg=[e]:Fg.push(e)}function oK(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,tB(t)):(r.next=a.next,a.next=r),t.interleaved=r,jh(e,n)}function jh(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var gp=!1;function rB(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aK(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ch(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Wp(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,yi&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,jh(e,r)}return a=n.interleaved,a===null?(t.next=t,tB(n)):(t.next=a.next,a.next=t),n.interleaved=t,jh(e,r)}function RM(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,$4(e,r)}}function GW(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var f={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?a=l=f:l=l.next=f,r=r.next}while(r!==null);l===null?a=l=t:l=l.next=t}else a=l=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function zP(e,t,r,n){var a=e.updateQueue;gp=!1;var l=a.firstBaseUpdate,f=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var _=i,b=_.next;_.next=null,f===null?l=b:f.next=b,f=_;var E=e.alternate;E!==null&&(E=E.updateQueue,i=E.lastBaseUpdate,i!==f&&(i===null?E.firstBaseUpdate=b:i.next=b,E.lastBaseUpdate=_))}if(l!==null){var C=a.baseState;f=0,E=b=_=null,i=l;do{var R=i.lane,F=i.eventTime;if((n&R)===R){E!==null&&(E=E.next={eventTime:F,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var U=e,$=i;switch(R=t,F=r,$.tag){case 1:if(U=$.payload,typeof U=="function"){C=U.call(F,C,R);break e}C=U;break e;case 3:U.flags=U.flags&-65537|128;case 0:if(U=$.payload,R=typeof U=="function"?U.call(F,C,R):U,R==null)break e;C=Mo({},C,R);break e;case 2:gp=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,R=a.effects,R===null?a.effects=[i]:R.push(i))}else F={eventTime:F,lane:R,tag:i.tag,payload:i.payload,callback:i.callback,next:null},E===null?(b=E=F,_=C):E=E.next=F,f|=R;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;R=i,i=R.next,R.next=null,a.lastBaseUpdate=R,a.shared.pending=null}}while(!0);if(E===null&&(_=C),a.baseState=_,a.firstBaseUpdate=b,a.lastBaseUpdate=E,t=a.shared.interleaved,t!==null){a=t;do f|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);gy|=f,e.lanes=f,e.memoizedState=C}}function qW(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ur(191,a));a.call(n)}}}var uE={},Md=pm(uE),VS=pm(uE),WS=pm(uE);function Bg(e){if(e===uE)throw Error(ur(174));return e}function nB(e,t){switch(eo(WS,t),eo(VS,e),eo(Md,uE),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:IN(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=IN(t,e)}uo(Md),eo(Md,t)}function z0(){uo(Md),uo(VS),uo(WS)}function sK(e){Bg(WS.current);var t=Bg(Md.current),r=IN(t,e.type);t!==r&&(eo(VS,e),eo(Md,r))}function iB(e){VS.current===e&&(uo(Md),uo(VS))}var So=pm(0);function jP(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var YL=[];function oB(){for(var e=0;e<YL.length;e++)YL[e]._workInProgressVersionPrimary=null;YL.length=0}var DM=Xh.ReactCurrentDispatcher,KL=Xh.ReactCurrentBatchConfig,my=0,Eo=null,ma=null,Ea=null,FP=!1,fS=!1,GS=0,Bfe=0;function Xa(){throw Error(ur(321))}function aB(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Cu(e[r],t[r]))return!1;return!0}function sB(e,t,r,n,a,l){if(my=l,Eo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,DM.current=e===null||e.memoizedState===null?Wfe:Gfe,e=r(n,a),fS){l=0;do{if(fS=!1,GS=0,25<=l)throw Error(ur(301));l+=1,Ea=ma=null,t.updateQueue=null,DM.current=qfe,e=r(n,a)}while(fS)}if(DM.current=BP,t=ma!==null&&ma.next!==null,my=0,Ea=ma=Eo=null,FP=!1,t)throw Error(ur(300));return e}function lB(){var e=GS!==0;return GS=0,e}function hd(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ea===null?Eo.memoizedState=Ea=e:Ea=Ea.next=e,Ea}function Cc(){if(ma===null){var e=Eo.alternate;e=e!==null?e.memoizedState:null}else e=ma.next;var t=Ea===null?Eo.memoizedState:Ea.next;if(t!==null)Ea=t,ma=e;else{if(e===null)throw Error(ur(310));ma=e,e={memoizedState:ma.memoizedState,baseState:ma.baseState,baseQueue:ma.baseQueue,queue:ma.queue,next:null},Ea===null?Eo.memoizedState=Ea=e:Ea=Ea.next=e}return Ea}function qS(e,t){return typeof t=="function"?t(e):t}function JL(e){var t=Cc(),r=t.queue;if(r===null)throw Error(ur(311));r.lastRenderedReducer=e;var n=ma,a=n.baseQueue,l=r.pending;if(l!==null){if(a!==null){var f=a.next;a.next=l.next,l.next=f}n.baseQueue=a=l,r.pending=null}if(a!==null){l=a.next,n=n.baseState;var i=f=null,_=null,b=l;do{var E=b.lane;if((my&E)===E)_!==null&&(_=_.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),n=b.hasEagerState?b.eagerState:e(n,b.action);else{var C={lane:E,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};_===null?(i=_=C,f=n):_=_.next=C,Eo.lanes|=E,gy|=E}b=b.next}while(b!==null&&b!==l);_===null?f=n:_.next=i,Cu(n,t.memoizedState)||(al=!0),t.memoizedState=n,t.baseState=f,t.baseQueue=_,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do l=a.lane,Eo.lanes|=l,gy|=l,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function QL(e){var t=Cc(),r=t.queue;if(r===null)throw Error(ur(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,l=t.memoizedState;if(a!==null){r.pending=null;var f=a=a.next;do l=e(l,f.action),f=f.next;while(f!==a);Cu(l,t.memoizedState)||(al=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),r.lastRenderedState=l}return[l,n]}function lK(){}function cK(e,t){var r=Eo,n=Cc(),a=t(),l=!Cu(n.memoizedState,a);if(l&&(n.memoizedState=a,al=!0),n=n.queue,cB(hK.bind(null,r,n,e),[e]),n.getSnapshot!==t||l||Ea!==null&&Ea.memoizedState.tag&1){if(r.flags|=2048,HS(9,dK.bind(null,r,n,a,t),void 0,null),Ma===null)throw Error(ur(349));my&30||uK(r,t,a)}return a}function uK(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Eo.updateQueue,t===null?(t={lastEffect:null,stores:null},Eo.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function dK(e,t,r,n){t.value=r,t.getSnapshot=n,fK(t)&&pK(e)}function hK(e,t,r){return r(function(){fK(t)&&pK(e)})}function fK(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Cu(e,r)}catch{return!0}}function pK(e){var t=jh(e,1);t!==null&&Su(t,e,1,-1)}function HW(e){var t=hd();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qS,lastRenderedState:e},t.queue=e,e=e.dispatch=Vfe.bind(null,Eo,e),[t.memoizedState,e]}function HS(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Eo.updateQueue,t===null?(t={lastEffect:null,stores:null},Eo.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function mK(){return Cc().memoizedState}function LM(e,t,r,n){var a=hd();Eo.flags|=e,a.memoizedState=HS(1|t,r,void 0,n===void 0?null:n)}function FO(e,t,r,n){var a=Cc();n=n===void 0?null:n;var l=void 0;if(ma!==null){var f=ma.memoizedState;if(l=f.destroy,n!==null&&aB(n,f.deps)){a.memoizedState=HS(t,r,l,n);return}}Eo.flags|=e,a.memoizedState=HS(1|t,r,l,n)}function ZW(e,t){return LM(8390656,8,e,t)}function cB(e,t){return FO(2048,8,e,t)}function gK(e,t){return FO(4,2,e,t)}function yK(e,t){return FO(4,4,e,t)}function vK(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function _K(e,t,r){return r=r!=null?r.concat([e]):null,FO(4,4,vK.bind(null,t,e),r)}function uB(){}function xK(e,t){var r=Cc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&aB(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function bK(e,t){var r=Cc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&aB(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function wK(e,t,r){return my&21?(Cu(r,t)||(r=MY(),Eo.lanes|=r,gy|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,al=!0),e.memoizedState=r)}function $fe(e,t){var r=Ri;Ri=r!==0&&4>r?r:4,e(!0);var n=KL.transition;KL.transition={};try{e(!1),t()}finally{Ri=r,KL.transition=n}}function SK(){return Cc().memoizedState}function Ufe(e,t,r){var n=qp(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},TK(e))EK(t,r);else if(r=oK(e,t,r,n),r!==null){var a=Ps();Su(r,e,n,a),AK(r,t,n)}}function Vfe(e,t,r){var n=qp(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(TK(e))EK(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var f=t.lastRenderedState,i=l(f,r);if(a.hasEagerState=!0,a.eagerState=i,Cu(i,f)){var _=t.interleaved;_===null?(a.next=a,tB(t)):(a.next=_.next,_.next=a),t.interleaved=a;return}}catch{}finally{}r=oK(e,t,a,n),r!==null&&(a=Ps(),Su(r,e,n,a),AK(r,t,n))}}function TK(e){var t=e.alternate;return e===Eo||t!==null&&t===Eo}function EK(e,t){fS=FP=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function AK(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,$4(e,r)}}var BP={readContext:Mc,useCallback:Xa,useContext:Xa,useEffect:Xa,useImperativeHandle:Xa,useInsertionEffect:Xa,useLayoutEffect:Xa,useMemo:Xa,useReducer:Xa,useRef:Xa,useState:Xa,useDebugValue:Xa,useDeferredValue:Xa,useTransition:Xa,useMutableSource:Xa,useSyncExternalStore:Xa,useId:Xa,unstable_isNewReconciler:!1},Wfe={readContext:Mc,useCallback:function(e,t){return hd().memoizedState=[e,t===void 0?null:t],e},useContext:Mc,useEffect:ZW,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,LM(4194308,4,vK.bind(null,t,e),r)},useLayoutEffect:function(e,t){return LM(4194308,4,e,t)},useInsertionEffect:function(e,t){return LM(4,2,e,t)},useMemo:function(e,t){var r=hd();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=hd();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ufe.bind(null,Eo,e),[n.memoizedState,e]},useRef:function(e){var t=hd();return e={current:e},t.memoizedState=e},useState:HW,useDebugValue:uB,useDeferredValue:function(e){return hd().memoizedState=e},useTransition:function(){var e=HW(!1),t=e[0];return e=$fe.bind(null,e[1]),hd().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Eo,a=hd();if(go){if(r===void 0)throw Error(ur(407));r=r()}else{if(r=t(),Ma===null)throw Error(ur(349));my&30||uK(n,t,r)}a.memoizedState=r;var l={value:r,getSnapshot:t};return a.queue=l,ZW(hK.bind(null,n,l,e),[e]),n.flags|=2048,HS(9,dK.bind(null,n,l,r,t),void 0,null),r},useId:function(){var e=hd(),t=Ma.identifierPrefix;if(go){var r=wh,n=bh;r=(n&~(1<<32-wu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=GS++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Bfe++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Gfe={readContext:Mc,useCallback:xK,useContext:Mc,useEffect:cB,useImperativeHandle:_K,useInsertionEffect:gK,useLayoutEffect:yK,useMemo:bK,useReducer:JL,useRef:mK,useState:function(){return JL(qS)},useDebugValue:uB,useDeferredValue:function(e){var t=Cc();return wK(t,ma.memoizedState,e)},useTransition:function(){var e=JL(qS)[0],t=Cc().memoizedState;return[e,t]},useMutableSource:lK,useSyncExternalStore:cK,useId:SK,unstable_isNewReconciler:!1},qfe={readContext:Mc,useCallback:xK,useContext:Mc,useEffect:cB,useImperativeHandle:_K,useInsertionEffect:gK,useLayoutEffect:yK,useMemo:bK,useReducer:QL,useRef:mK,useState:function(){return QL(qS)},useDebugValue:uB,useDeferredValue:function(e){var t=Cc();return ma===null?t.memoizedState=e:wK(t,ma.memoizedState,e)},useTransition:function(){var e=QL(qS)[0],t=Cc().memoizedState;return[e,t]},useMutableSource:lK,useSyncExternalStore:cK,useId:SK,unstable_isNewReconciler:!1};function lu(e,t){if(e&&e.defaultProps){t=Mo({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function KN(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Mo({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var BO={isMounted:function(e){return(e=e._reactInternals)?Ry(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ps(),a=qp(e),l=Ch(n,a);l.payload=t,r!=null&&(l.callback=r),t=Wp(e,l,a),t!==null&&(Su(t,e,a,n),RM(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ps(),a=qp(e),l=Ch(n,a);l.tag=1,l.payload=t,r!=null&&(l.callback=r),t=Wp(e,l,a),t!==null&&(Su(t,e,a,n),RM(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ps(),n=qp(e),a=Ch(r,n);a.tag=2,t!=null&&(a.callback=t),t=Wp(e,a,n),t!==null&&(Su(t,e,n,r),RM(t,e,n))}};function XW(e,t,r,n,a,l,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,l,f):t.prototype&&t.prototype.isPureReactComponent?!FS(r,n)||!FS(a,l):!0}function MK(e,t,r){var n=!1,a=em,l=t.contextType;return typeof l=="object"&&l!==null?l=Mc(l):(a=dl(t)?fy:os.current,n=t.contextTypes,l=(n=n!=null)?D0(e,a):em),t=new t(r,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=BO,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function YW(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&BO.enqueueReplaceState(t,t.state,null)}function JN(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},rB(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=Mc(l):(l=dl(t)?fy:os.current,a.context=D0(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(KN(e,t,l,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&BO.enqueueReplaceState(a,a.state,null),zP(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function j0(e,t){try{var r="",n=t;do r+=xhe(n),n=n.return;while(n);var a=r}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function e3(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function QN(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Hfe=typeof WeakMap=="function"?WeakMap:Map;function CK(e,t,r){r=Ch(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){UP||(UP=!0,cz=n),QN(e,t)},r}function PK(e,t,r){r=Ch(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){QN(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){QN(e,t),typeof n!="function"&&(Gp===null?Gp=new Set([this]):Gp.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),r}function KW(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Hfe;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=spe.bind(null,e,t,r),t.then(e,e))}function JW(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function QW(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ch(-1,1),t.tag=2,Wp(r,t,1))),r.lanes|=1),e)}var Zfe=Xh.ReactCurrentOwner,al=!1;function Ts(e,t,r,n){t.child=e===null?iK(t,null,r,n):N0(t,e.child,r,n)}function eG(e,t,r,n,a){r=r.render;var l=t.ref;return a0(t,a),n=sB(e,t,r,n,l,a),r=lB(),e!==null&&!al?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Fh(e,t,a)):(go&&r&&X4(t),t.flags|=1,Ts(e,t,n,a),t.child)}function tG(e,t,r,n,a){if(e===null){var l=r.type;return typeof l=="function"&&!vB(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=l,IK(e,t,l,n,a)):(e=FM(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var f=l.memoizedProps;if(r=r.compare,r=r!==null?r:FS,r(f,n)&&e.ref===t.ref)return Fh(e,t,a)}return t.flags|=1,e=Hp(l,n),e.ref=t.ref,e.return=t,t.child=e}function IK(e,t,r,n,a){if(e!==null){var l=e.memoizedProps;if(FS(l,n)&&e.ref===t.ref)if(al=!1,t.pendingProps=n=l,(e.lanes&a)!==0)e.flags&131072&&(al=!0);else return t.lanes=e.lanes,Fh(e,t,a)}return ez(e,t,r,n,a)}function OK(e,t,r){var n=t.pendingProps,a=n.children,l=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},eo(X_,Rl),Rl|=r;else{if(!(r&1073741824))return e=l!==null?l.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,eo(X_,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=l!==null?l.baseLanes:r,eo(X_,Rl),Rl|=n}else l!==null?(n=l.baseLanes|r,t.memoizedState=null):n=r,eo(X_,Rl),Rl|=n;return Ts(e,t,a,r),t.child}function kK(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ez(e,t,r,n,a){var l=dl(r)?fy:os.current;return l=D0(t,l),a0(t,a),r=sB(e,t,r,n,l,a),n=lB(),e!==null&&!al?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Fh(e,t,a)):(go&&n&&X4(t),t.flags|=1,Ts(e,t,r,a),t.child)}function rG(e,t,r,n,a){if(dl(r)){var l=!0;kP(t)}else l=!1;if(a0(t,a),t.stateNode===null)NM(e,t),MK(t,r,n),JN(t,r,n,a),n=!0;else if(e===null){var f=t.stateNode,i=t.memoizedProps;f.props=i;var _=f.context,b=r.contextType;typeof b=="object"&&b!==null?b=Mc(b):(b=dl(r)?fy:os.current,b=D0(t,b));var E=r.getDerivedStateFromProps,C=typeof E=="function"||typeof f.getSnapshotBeforeUpdate=="function";C||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(i!==n||_!==b)&&YW(t,f,n,b),gp=!1;var R=t.memoizedState;f.state=R,zP(t,n,f,a),_=t.memoizedState,i!==n||R!==_||ul.current||gp?(typeof E=="function"&&(KN(t,r,E,n),_=t.memoizedState),(i=gp||XW(t,r,i,n,R,_,b))?(C||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=_),f.props=n,f.state=_,f.context=b,n=i):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{f=t.stateNode,aK(e,t),i=t.memoizedProps,b=t.type===t.elementType?i:lu(t.type,i),f.props=b,C=t.pendingProps,R=f.context,_=r.contextType,typeof _=="object"&&_!==null?_=Mc(_):(_=dl(r)?fy:os.current,_=D0(t,_));var F=r.getDerivedStateFromProps;(E=typeof F=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(i!==C||R!==_)&&YW(t,f,n,_),gp=!1,R=t.memoizedState,f.state=R,zP(t,n,f,a);var U=t.memoizedState;i!==C||R!==U||ul.current||gp?(typeof F=="function"&&(KN(t,r,F,n),U=t.memoizedState),(b=gp||XW(t,r,b,n,R,U,_)||!1)?(E||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(n,U,_),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(n,U,_)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||i===e.memoizedProps&&R===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&R===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=U),f.props=n,f.state=U,f.context=_,n=b):(typeof f.componentDidUpdate!="function"||i===e.memoizedProps&&R===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&R===e.memoizedState||(t.flags|=1024),n=!1)}return tz(e,t,r,n,l,a)}function tz(e,t,r,n,a,l){kK(e,t);var f=(t.flags&128)!==0;if(!n&&!f)return a&&$W(t,r,!1),Fh(e,t,l);n=t.stateNode,Zfe.current=t;var i=f&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&f?(t.child=N0(t,e.child,null,l),t.child=N0(t,null,i,l)):Ts(e,t,i,l),t.memoizedState=n.state,a&&$W(t,r,!0),t.child}function RK(e){var t=e.stateNode;t.pendingContext?BW(e,t.pendingContext,t.pendingContext!==t.context):t.context&&BW(e,t.context,!1),nB(e,t.containerInfo)}function nG(e,t,r,n,a){return L0(),K4(a),t.flags|=256,Ts(e,t,r,n),t.child}var rz={dehydrated:null,treeContext:null,retryLane:0};function nz(e){return{baseLanes:e,cachePool:null,transitions:null}}function DK(e,t,r){var n=t.pendingProps,a=So.current,l=!1,f=(t.flags&128)!==0,i;if((i=f)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),eo(So,a&1),e===null)return XN(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=n.children,e=n.fallback,l?(n=t.mode,l=t.child,f={mode:"hidden",children:f},!(n&1)&&l!==null?(l.childLanes=0,l.pendingProps=f):l=VO(f,n,0,null),e=ny(e,n,r,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=nz(r),t.memoizedState=rz,e):dB(t,f));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return Xfe(e,t,f,n,i,a,r);if(l){l=n.fallback,f=t.mode,a=e.child,i=a.sibling;var _={mode:"hidden",children:n.children};return!(f&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=_,t.deletions=null):(n=Hp(a,_),n.subtreeFlags=a.subtreeFlags&14680064),i!==null?l=Hp(i,l):(l=ny(l,f,r,null),l.flags|=2),l.return=t,n.return=t,n.sibling=l,t.child=n,n=l,l=t.child,f=e.child.memoizedState,f=f===null?nz(r):{baseLanes:f.baseLanes|r,cachePool:null,transitions:f.transitions},l.memoizedState=f,l.childLanes=e.childLanes&~r,t.memoizedState=rz,n}return l=e.child,e=l.sibling,n=Hp(l,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function dB(e,t){return t=VO({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function VA(e,t,r,n){return n!==null&&K4(n),N0(t,e.child,null,r),e=dB(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Xfe(e,t,r,n,a,l,f){if(r)return t.flags&256?(t.flags&=-257,n=e3(Error(ur(422))),VA(e,t,f,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=n.fallback,a=t.mode,n=VO({mode:"visible",children:n.children},a,0,null),l=ny(l,a,f,null),l.flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,t.mode&1&&N0(t,e.child,null,f),t.child.memoizedState=nz(f),t.memoizedState=rz,l);if(!(t.mode&1))return VA(e,t,f,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var i=n.dgst;return n=i,l=Error(ur(419)),n=e3(l,n,void 0),VA(e,t,f,n)}if(i=(f&e.childLanes)!==0,al||i){if(n=Ma,n!==null){switch(f&-f){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|f)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,jh(e,a),Su(n,e,a,-1))}return yB(),n=e3(Error(ur(421))),VA(e,t,f,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=lpe.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,Bl=Vp(a.nextSibling),Ul=t,go=!0,mu=null,e!==null&&(yc[vc++]=bh,yc[vc++]=wh,yc[vc++]=py,bh=e.id,wh=e.overflow,py=t),t=dB(t,n.children),t.flags|=4096,t)}function iG(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),YN(e.return,t,r)}function t3(e,t,r,n,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=r,l.tailMode=a)}function LK(e,t,r){var n=t.pendingProps,a=n.revealOrder,l=n.tail;if(Ts(e,t,n.children,r),n=So.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&iG(e,r,t);else if(e.tag===19)iG(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(eo(So,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&jP(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),t3(t,!1,a,r,l);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&jP(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}t3(t,!0,r,null,l);break;case"together":t3(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function NM(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fh(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),gy|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ur(153));if(t.child!==null){for(e=t.child,r=Hp(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Hp(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Yfe(e,t,r){switch(t.tag){case 3:RK(t),L0();break;case 5:sK(t);break;case 1:dl(t.type)&&kP(t);break;case 4:nB(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;eo(LP,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(eo(So,So.current&1),t.flags|=128,null):r&t.child.childLanes?DK(e,t,r):(eo(So,So.current&1),e=Fh(e,t,r),e!==null?e.sibling:null);eo(So,So.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return LK(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),eo(So,So.current),n)break;return null;case 22:case 23:return t.lanes=0,OK(e,t,r)}return Fh(e,t,r)}var NK,iz,zK,jK;NK=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};iz=function(){};zK=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Bg(Md.current);var l=null;switch(r){case"input":a=AN(e,a),n=AN(e,n),l=[];break;case"select":a=Mo({},a,{value:void 0}),n=Mo({},n,{value:void 0}),l=[];break;case"textarea":a=PN(e,a),n=PN(e,n),l=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=IP)}ON(r,n);var f;r=null;for(b in a)if(!n.hasOwnProperty(b)&&a.hasOwnProperty(b)&&a[b]!=null)if(b==="style"){var i=a[b];for(f in i)i.hasOwnProperty(f)&&(r||(r={}),r[f]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(kS.hasOwnProperty(b)?l||(l=[]):(l=l||[]).push(b,null));for(b in n){var _=n[b];if(i=a!=null?a[b]:void 0,n.hasOwnProperty(b)&&_!==i&&(_!=null||i!=null))if(b==="style")if(i){for(f in i)!i.hasOwnProperty(f)||_&&_.hasOwnProperty(f)||(r||(r={}),r[f]="");for(f in _)_.hasOwnProperty(f)&&i[f]!==_[f]&&(r||(r={}),r[f]=_[f])}else r||(l||(l=[]),l.push(b,r)),r=_;else b==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,i=i?i.__html:void 0,_!=null&&i!==_&&(l=l||[]).push(b,_)):b==="children"?typeof _!="string"&&typeof _!="number"||(l=l||[]).push(b,""+_):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(kS.hasOwnProperty(b)?(_!=null&&b==="onScroll"&&so("scroll",e),l||i===_||(l=[])):(l=l||[]).push(b,_))}r&&(l=l||[]).push("style",r);var b=l;(t.updateQueue=b)&&(t.flags|=4)}};jK=function(e,t,r,n){r!==n&&(t.flags|=4)};function iw(e,t){if(!go)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ya(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Kfe(e,t,r){var n=t.pendingProps;switch(Y4(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ya(t),null;case 1:return dl(t.type)&&OP(),Ya(t),null;case 3:return n=t.stateNode,z0(),uo(ul),uo(os),oB(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&($A(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,mu!==null&&(hz(mu),mu=null))),iz(e,t),Ya(t),null;case 5:iB(t);var a=Bg(WS.current);if(r=t.type,e!==null&&t.stateNode!=null)zK(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ur(166));return Ya(t),null}if(e=Bg(Md.current),$A(t)){n=t.stateNode,r=t.type;var l=t.memoizedProps;switch(n[yd]=t,n[US]=l,e=(t.mode&1)!==0,r){case"dialog":so("cancel",n),so("close",n);break;case"iframe":case"object":case"embed":so("load",n);break;case"video":case"audio":for(a=0;a<Pw.length;a++)so(Pw[a],n);break;case"source":so("error",n);break;case"img":case"image":case"link":so("error",n),so("load",n);break;case"details":so("toggle",n);break;case"input":fW(n,l),so("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},so("invalid",n);break;case"textarea":mW(n,l),so("invalid",n)}ON(r,l),a=null;for(var f in l)if(l.hasOwnProperty(f)){var i=l[f];f==="children"?typeof i=="string"?n.textContent!==i&&(l.suppressHydrationWarning!==!0&&BA(n.textContent,i,e),a=["children",i]):typeof i=="number"&&n.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&BA(n.textContent,i,e),a=["children",""+i]):kS.hasOwnProperty(f)&&i!=null&&f==="onScroll"&&so("scroll",n)}switch(r){case"input":kA(n),pW(n,l,!0);break;case"textarea":kA(n),gW(n);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(n.onclick=IP)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{f=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hY(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=f.createElement(r,{is:n.is}):(e=f.createElement(r),r==="select"&&(f=e,n.multiple?f.multiple=!0:n.size&&(f.size=n.size))):e=f.createElementNS(e,r),e[yd]=t,e[US]=n,NK(e,t,!1,!1),t.stateNode=e;e:{switch(f=kN(r,n),r){case"dialog":so("cancel",e),so("close",e),a=n;break;case"iframe":case"object":case"embed":so("load",e),a=n;break;case"video":case"audio":for(a=0;a<Pw.length;a++)so(Pw[a],e);a=n;break;case"source":so("error",e),a=n;break;case"img":case"image":case"link":so("error",e),so("load",e),a=n;break;case"details":so("toggle",e),a=n;break;case"input":fW(e,n),a=AN(e,n),so("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Mo({},n,{value:void 0}),so("invalid",e);break;case"textarea":mW(e,n),a=PN(e,n),so("invalid",e);break;default:a=n}ON(r,a),i=a;for(l in i)if(i.hasOwnProperty(l)){var _=i[l];l==="style"?mY(e,_):l==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&fY(e,_)):l==="children"?typeof _=="string"?(r!=="textarea"||_!=="")&&RS(e,_):typeof _=="number"&&RS(e,""+_):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(kS.hasOwnProperty(l)?_!=null&&l==="onScroll"&&so("scroll",e):_!=null&&L4(e,l,_,f))}switch(r){case"input":kA(e),pW(e,n,!1);break;case"textarea":kA(e),gW(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Qp(n.value));break;case"select":e.multiple=!!n.multiple,l=n.value,l!=null?r0(e,!!n.multiple,l,!1):n.defaultValue!=null&&r0(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=IP)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ya(t),null;case 6:if(e&&t.stateNode!=null)jK(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ur(166));if(r=Bg(WS.current),Bg(Md.current),$A(t)){if(n=t.stateNode,r=t.memoizedProps,n[yd]=t,(l=n.nodeValue!==r)&&(e=Ul,e!==null))switch(e.tag){case 3:BA(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&BA(n.nodeValue,r,(e.mode&1)!==0)}l&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[yd]=t,t.stateNode=n}return Ya(t),null;case 13:if(uo(So),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(go&&Bl!==null&&t.mode&1&&!(t.flags&128))rK(),L0(),t.flags|=98560,l=!1;else if(l=$A(t),n!==null&&n.dehydrated!==null){if(e===null){if(!l)throw Error(ur(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ur(317));l[yd]=t}else L0(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ya(t),l=!1}else mu!==null&&(hz(mu),mu=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||So.current&1?ga===0&&(ga=3):yB())),t.updateQueue!==null&&(t.flags|=4),Ya(t),null);case 4:return z0(),iz(e,t),e===null&&BS(t.stateNode.containerInfo),Ya(t),null;case 10:return eB(t.type._context),Ya(t),null;case 17:return dl(t.type)&&OP(),Ya(t),null;case 19:if(uo(So),l=t.memoizedState,l===null)return Ya(t),null;if(n=(t.flags&128)!==0,f=l.rendering,f===null)if(n)iw(l,!1);else{if(ga!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=jP(e),f!==null){for(t.flags|=128,iw(l,!1),n=f.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)l=r,e=n,l.flags&=14680066,f=l.alternate,f===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,e=f.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return eo(So,So.current&1|2),t.child}e=e.sibling}l.tail!==null&&Wo()>F0&&(t.flags|=128,n=!0,iw(l,!1),t.lanes=4194304)}else{if(!n)if(e=jP(f),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),iw(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!go)return Ya(t),null}else 2*Wo()-l.renderingStartTime>F0&&r!==1073741824&&(t.flags|=128,n=!0,iw(l,!1),t.lanes=4194304);l.isBackwards?(f.sibling=t.child,t.child=f):(r=l.last,r!==null?r.sibling=f:t.child=f,l.last=f)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Wo(),t.sibling=null,r=So.current,eo(So,n?r&1|2:r&1),t):(Ya(t),null);case 22:case 23:return gB(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Rl&1073741824&&(Ya(t),t.subtreeFlags&6&&(t.flags|=8192)):Ya(t),null;case 24:return null;case 25:return null}throw Error(ur(156,t.tag))}function Jfe(e,t){switch(Y4(t),t.tag){case 1:return dl(t.type)&&OP(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return z0(),uo(ul),uo(os),oB(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return iB(t),null;case 13:if(uo(So),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ur(340));L0()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return uo(So),null;case 4:return z0(),null;case 10:return eB(t.type._context),null;case 22:case 23:return gB(),null;case 24:return null;default:return null}}var WA=!1,ts=!1,Qfe=typeof WeakSet=="function"?WeakSet:Set,jr=null;function Z_(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Lo(e,t,n)}else r.current=null}function oz(e,t,r){try{r()}catch(n){Lo(e,t,n)}}var oG=!1;function epe(e,t){if(UN=MP,e=VY(),Z4(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var f=0,i=-1,_=-1,b=0,E=0,C=e,R=null;t:for(;;){for(var F;C!==r||a!==0&&C.nodeType!==3||(i=f+a),C!==l||n!==0&&C.nodeType!==3||(_=f+n),C.nodeType===3&&(f+=C.nodeValue.length),(F=C.firstChild)!==null;)R=C,C=F;for(;;){if(C===e)break t;if(R===r&&++b===a&&(i=f),R===l&&++E===n&&(_=f),(F=C.nextSibling)!==null)break;C=R,R=C.parentNode}C=F}r=i===-1||_===-1?null:{start:i,end:_}}else r=null}r=r||{start:0,end:0}}else r=null;for(VN={focusedElem:e,selectionRange:r},MP=!1,jr=t;jr!==null;)if(t=jr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,jr=e;else for(;jr!==null;){t=jr;try{var U=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(U!==null){var $=U.memoizedProps,H=U.memoizedState,q=t.stateNode,G=q.getSnapshotBeforeUpdate(t.elementType===t.type?$:lu(t.type,$),H);q.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var J=t.stateNode.containerInfo;J.nodeType===1?J.textContent="":J.nodeType===9&&J.documentElement&&J.removeChild(J.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ur(163))}}catch(te){Lo(t,t.return,te)}if(e=t.sibling,e!==null){e.return=t.return,jr=e;break}jr=t.return}return U=oG,oG=!1,U}function pS(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&oz(t,r,l)}a=a.next}while(a!==n)}}function $O(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function az(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function FK(e){var t=e.alternate;t!==null&&(e.alternate=null,FK(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yd],delete t[US],delete t[qN],delete t[Nfe],delete t[zfe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function BK(e){return e.tag===5||e.tag===3||e.tag===4}function aG(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||BK(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sz(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=IP));else if(n!==4&&(e=e.child,e!==null))for(sz(e,t,r),e=e.sibling;e!==null;)sz(e,t,r),e=e.sibling}function lz(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(lz(e,t,r),e=e.sibling;e!==null;)lz(e,t,r),e=e.sibling}var Na=null,uu=!1;function ep(e,t,r){for(r=r.child;r!==null;)$K(e,t,r),r=r.sibling}function $K(e,t,r){if(Ad&&typeof Ad.onCommitFiberUnmount=="function")try{Ad.onCommitFiberUnmount(RO,r)}catch{}switch(r.tag){case 5:ts||Z_(r,t);case 6:var n=Na,a=uu;Na=null,ep(e,t,r),Na=n,uu=a,Na!==null&&(uu?(e=Na,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Na.removeChild(r.stateNode));break;case 18:Na!==null&&(uu?(e=Na,r=r.stateNode,e.nodeType===8?ZL(e.parentNode,r):e.nodeType===1&&ZL(e,r),zS(e)):ZL(Na,r.stateNode));break;case 4:n=Na,a=uu,Na=r.stateNode.containerInfo,uu=!0,ep(e,t,r),Na=n,uu=a;break;case 0:case 11:case 14:case 15:if(!ts&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var l=a,f=l.destroy;l=l.tag,f!==void 0&&(l&2||l&4)&&oz(r,t,f),a=a.next}while(a!==n)}ep(e,t,r);break;case 1:if(!ts&&(Z_(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(i){Lo(r,t,i)}ep(e,t,r);break;case 21:ep(e,t,r);break;case 22:r.mode&1?(ts=(n=ts)||r.memoizedState!==null,ep(e,t,r),ts=n):ep(e,t,r);break;default:ep(e,t,r)}}function sG(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Qfe),t.forEach(function(n){var a=cpe.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function nu(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var l=e,f=t,i=f;e:for(;i!==null;){switch(i.tag){case 5:Na=i.stateNode,uu=!1;break e;case 3:Na=i.stateNode.containerInfo,uu=!0;break e;case 4:Na=i.stateNode.containerInfo,uu=!0;break e}i=i.return}if(Na===null)throw Error(ur(160));$K(l,f,a),Na=null,uu=!1;var _=a.alternate;_!==null&&(_.return=null),a.return=null}catch(b){Lo(a,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)UK(t,e),t=t.sibling}function UK(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(nu(t,e),nd(e),n&4){try{pS(3,e,e.return),$O(3,e)}catch($){Lo(e,e.return,$)}try{pS(5,e,e.return)}catch($){Lo(e,e.return,$)}}break;case 1:nu(t,e),nd(e),n&512&&r!==null&&Z_(r,r.return);break;case 5:if(nu(t,e),nd(e),n&512&&r!==null&&Z_(r,r.return),e.flags&32){var a=e.stateNode;try{RS(a,"")}catch($){Lo(e,e.return,$)}}if(n&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,f=r!==null?r.memoizedProps:l,i=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&uY(a,l),kN(i,f);var b=kN(i,l);for(f=0;f<_.length;f+=2){var E=_[f],C=_[f+1];E==="style"?mY(a,C):E==="dangerouslySetInnerHTML"?fY(a,C):E==="children"?RS(a,C):L4(a,E,C,b)}switch(i){case"input":MN(a,l);break;case"textarea":dY(a,l);break;case"select":var R=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var F=l.value;F!=null?r0(a,!!l.multiple,F,!1):R!==!!l.multiple&&(l.defaultValue!=null?r0(a,!!l.multiple,l.defaultValue,!0):r0(a,!!l.multiple,l.multiple?[]:"",!1))}a[US]=l}catch($){Lo(e,e.return,$)}}break;case 6:if(nu(t,e),nd(e),n&4){if(e.stateNode===null)throw Error(ur(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch($){Lo(e,e.return,$)}}break;case 3:if(nu(t,e),nd(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{zS(t.containerInfo)}catch($){Lo(e,e.return,$)}break;case 4:nu(t,e),nd(e);break;case 13:nu(t,e),nd(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(pB=Wo())),n&4&&sG(e);break;case 22:if(E=r!==null&&r.memoizedState!==null,e.mode&1?(ts=(b=ts)||E,nu(t,e),ts=b):nu(t,e),nd(e),n&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!E&&e.mode&1)for(jr=e,E=e.child;E!==null;){for(C=jr=E;jr!==null;){switch(R=jr,F=R.child,R.tag){case 0:case 11:case 14:case 15:pS(4,R,R.return);break;case 1:Z_(R,R.return);var U=R.stateNode;if(typeof U.componentWillUnmount=="function"){n=R,r=R.return;try{t=n,U.props=t.memoizedProps,U.state=t.memoizedState,U.componentWillUnmount()}catch($){Lo(n,r,$)}}break;case 5:Z_(R,R.return);break;case 22:if(R.memoizedState!==null){cG(C);continue}}F!==null?(F.return=R,jr=F):cG(C)}E=E.sibling}e:for(E=null,C=e;;){if(C.tag===5){if(E===null){E=C;try{a=C.stateNode,b?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=C.stateNode,_=C.memoizedProps.style,f=_!=null&&_.hasOwnProperty("display")?_.display:null,i.style.display=pY("display",f))}catch($){Lo(e,e.return,$)}}}else if(C.tag===6){if(E===null)try{C.stateNode.nodeValue=b?"":C.memoizedProps}catch($){Lo(e,e.return,$)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===e)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===e)break e;for(;C.sibling===null;){if(C.return===null||C.return===e)break e;E===C&&(E=null),C=C.return}E===C&&(E=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:nu(t,e),nd(e),n&4&&sG(e);break;case 21:break;default:nu(t,e),nd(e)}}function nd(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(BK(r)){var n=r;break e}r=r.return}throw Error(ur(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(RS(a,""),n.flags&=-33);var l=aG(e);lz(e,l,a);break;case 3:case 4:var f=n.stateNode.containerInfo,i=aG(e);sz(e,i,f);break;default:throw Error(ur(161))}}catch(_){Lo(e,e.return,_)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tpe(e,t,r){jr=e,VK(e)}function VK(e,t,r){for(var n=(e.mode&1)!==0;jr!==null;){var a=jr,l=a.child;if(a.tag===22&&n){var f=a.memoizedState!==null||WA;if(!f){var i=a.alternate,_=i!==null&&i.memoizedState!==null||ts;i=WA;var b=ts;if(WA=f,(ts=_)&&!b)for(jr=a;jr!==null;)f=jr,_=f.child,f.tag===22&&f.memoizedState!==null?uG(a):_!==null?(_.return=f,jr=_):uG(a);for(;l!==null;)jr=l,VK(l),l=l.sibling;jr=a,WA=i,ts=b}lG(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,jr=l):lG(e)}}function lG(e){for(;jr!==null;){var t=jr;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ts||$O(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ts)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:lu(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&qW(t,l,n);break;case 3:var f=t.updateQueue;if(f!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}qW(t,f,r)}break;case 5:var i=t.stateNode;if(r===null&&t.flags&4){r=i;var _=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&r.focus();break;case"img":_.src&&(r.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var E=b.memoizedState;if(E!==null){var C=E.dehydrated;C!==null&&zS(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ur(163))}ts||t.flags&512&&az(t)}catch(R){Lo(t,t.return,R)}}if(t===e){jr=null;break}if(r=t.sibling,r!==null){r.return=t.return,jr=r;break}jr=t.return}}function cG(e){for(;jr!==null;){var t=jr;if(t===e){jr=null;break}var r=t.sibling;if(r!==null){r.return=t.return,jr=r;break}jr=t.return}}function uG(e){for(;jr!==null;){var t=jr;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$O(4,t)}catch(_){Lo(t,r,_)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(_){Lo(t,a,_)}}var l=t.return;try{az(t)}catch(_){Lo(t,l,_)}break;case 5:var f=t.return;try{az(t)}catch(_){Lo(t,f,_)}}}catch(_){Lo(t,t.return,_)}if(t===e){jr=null;break}var i=t.sibling;if(i!==null){i.return=t.return,jr=i;break}jr=t.return}}var rpe=Math.ceil,$P=Xh.ReactCurrentDispatcher,hB=Xh.ReactCurrentOwner,Tc=Xh.ReactCurrentBatchConfig,yi=0,Ma=null,ta=null,Ba=0,Rl=0,X_=pm(0),ga=0,ZS=null,gy=0,UO=0,fB=0,mS=null,il=null,pB=0,F0=1/0,yh=null,UP=!1,cz=null,Gp=null,GA=!1,Dp=null,VP=0,gS=0,uz=null,zM=-1,jM=0;function Ps(){return yi&6?Wo():zM!==-1?zM:zM=Wo()}function qp(e){return e.mode&1?yi&2&&Ba!==0?Ba&-Ba:Ffe.transition!==null?(jM===0&&(jM=MY()),jM):(e=Ri,e!==0||(e=window.event,e=e===void 0?16:DY(e.type)),e):1}function Su(e,t,r,n){if(50<gS)throw gS=0,uz=null,Error(ur(185));sE(e,r,n),(!(yi&2)||e!==Ma)&&(e===Ma&&(!(yi&2)&&(UO|=r),ga===4&&xp(e,Ba)),hl(e,n),r===1&&yi===0&&!(t.mode&1)&&(F0=Wo()+500,jO&&mm()))}function hl(e,t){var r=e.callbackNode;Fhe(e,t);var n=AP(e,e===Ma?Ba:0);if(n===0)r!==null&&_W(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_W(r),t===1)e.tag===0?jfe(dG.bind(null,e)):QY(dG.bind(null,e)),Dfe(function(){!(yi&6)&&mm()}),r=null;else{switch(CY(n)){case 1:r=B4;break;case 4:r=EY;break;case 16:r=EP;break;case 536870912:r=AY;break;default:r=EP}r=KK(r,WK.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function WK(e,t){if(zM=-1,jM=0,yi&6)throw Error(ur(327));var r=e.callbackNode;if(s0()&&e.callbackNode!==r)return null;var n=AP(e,e===Ma?Ba:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=WP(e,n);else{t=n;var a=yi;yi|=2;var l=qK();(Ma!==e||Ba!==t)&&(yh=null,F0=Wo()+500,ry(e,t));do try{ope();break}catch(i){GK(e,i)}while(!0);Q4(),$P.current=l,yi=a,ta!==null?t=0:(Ma=null,Ba=0,t=ga)}if(t!==0){if(t===2&&(a=zN(e),a!==0&&(n=a,t=dz(e,a))),t===1)throw r=ZS,ry(e,0),xp(e,n),hl(e,Wo()),r;if(t===6)xp(e,n);else{if(a=e.current.alternate,!(n&30)&&!npe(a)&&(t=WP(e,n),t===2&&(l=zN(e),l!==0&&(n=l,t=dz(e,l))),t===1))throw r=ZS,ry(e,0),xp(e,n),hl(e,Wo()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ur(345));case 2:Eg(e,il,yh);break;case 3:if(xp(e,n),(n&130023424)===n&&(t=pB+500-Wo(),10<t)){if(AP(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Ps(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=GN(Eg.bind(null,e,il,yh),t);break}Eg(e,il,yh);break;case 4:if(xp(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var f=31-wu(n);l=1<<f,f=t[f],f>a&&(a=f),n&=~l}if(n=a,n=Wo()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*rpe(n/1960))-n,10<n){e.timeoutHandle=GN(Eg.bind(null,e,il,yh),n);break}Eg(e,il,yh);break;case 5:Eg(e,il,yh);break;default:throw Error(ur(329))}}}return hl(e,Wo()),e.callbackNode===r?WK.bind(null,e):null}function dz(e,t){var r=mS;return e.current.memoizedState.isDehydrated&&(ry(e,t).flags|=256),e=WP(e,t),e!==2&&(t=il,il=r,t!==null&&hz(t)),e}function hz(e){il===null?il=e:il.push.apply(il,e)}function npe(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],l=a.getSnapshot;a=a.value;try{if(!Cu(l(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xp(e,t){for(t&=~fB,t&=~UO,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-wu(t),n=1<<r;e[r]=-1,t&=~n}}function dG(e){if(yi&6)throw Error(ur(327));s0();var t=AP(e,0);if(!(t&1))return hl(e,Wo()),null;var r=WP(e,t);if(e.tag!==0&&r===2){var n=zN(e);n!==0&&(t=n,r=dz(e,n))}if(r===1)throw r=ZS,ry(e,0),xp(e,t),hl(e,Wo()),r;if(r===6)throw Error(ur(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Eg(e,il,yh),hl(e,Wo()),null}function mB(e,t){var r=yi;yi|=1;try{return e(t)}finally{yi=r,yi===0&&(F0=Wo()+500,jO&&mm())}}function yy(e){Dp!==null&&Dp.tag===0&&!(yi&6)&&s0();var t=yi;yi|=1;var r=Tc.transition,n=Ri;try{if(Tc.transition=null,Ri=1,e)return e()}finally{Ri=n,Tc.transition=r,yi=t,!(yi&6)&&mm()}}function gB(){Rl=X_.current,uo(X_)}function ry(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Rfe(r)),ta!==null)for(r=ta.return;r!==null;){var n=r;switch(Y4(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&OP();break;case 3:z0(),uo(ul),uo(os),oB();break;case 5:iB(n);break;case 4:z0();break;case 13:uo(So);break;case 19:uo(So);break;case 10:eB(n.type._context);break;case 22:case 23:gB()}r=r.return}if(Ma=e,ta=e=Hp(e.current,null),Ba=Rl=t,ga=0,ZS=null,fB=UO=gy=0,il=mS=null,Fg!==null){for(t=0;t<Fg.length;t++)if(r=Fg[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,l=r.pending;if(l!==null){var f=l.next;l.next=a,n.next=f}r.pending=n}Fg=null}return e}function GK(e,t){do{var r=ta;try{if(Q4(),DM.current=BP,FP){for(var n=Eo.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}FP=!1}if(my=0,Ea=ma=Eo=null,fS=!1,GS=0,hB.current=null,r===null||r.return===null){ga=1,ZS=t,ta=null;break}e:{var l=e,f=r.return,i=r,_=t;if(t=Ba,i.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var b=_,E=i,C=E.tag;if(!(E.mode&1)&&(C===0||C===11||C===15)){var R=E.alternate;R?(E.updateQueue=R.updateQueue,E.memoizedState=R.memoizedState,E.lanes=R.lanes):(E.updateQueue=null,E.memoizedState=null)}var F=JW(f);if(F!==null){F.flags&=-257,QW(F,f,i,l,t),F.mode&1&&KW(l,b,t),t=F,_=b;var U=t.updateQueue;if(U===null){var $=new Set;$.add(_),t.updateQueue=$}else U.add(_);break e}else{if(!(t&1)){KW(l,b,t),yB();break e}_=Error(ur(426))}}else if(go&&i.mode&1){var H=JW(f);if(H!==null){!(H.flags&65536)&&(H.flags|=256),QW(H,f,i,l,t),K4(j0(_,i));break e}}l=_=j0(_,i),ga!==4&&(ga=2),mS===null?mS=[l]:mS.push(l),l=f;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var q=CK(l,_,t);GW(l,q);break e;case 1:i=_;var G=l.type,J=l.stateNode;if(!(l.flags&128)&&(typeof G.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Gp===null||!Gp.has(J)))){l.flags|=65536,t&=-t,l.lanes|=t;var te=PK(l,i,t);GW(l,te);break e}}l=l.return}while(l!==null)}ZK(r)}catch(oe){t=oe,ta===r&&r!==null&&(ta=r=r.return);continue}break}while(!0)}function qK(){var e=$P.current;return $P.current=BP,e===null?BP:e}function yB(){(ga===0||ga===3||ga===2)&&(ga=4),Ma===null||!(gy&268435455)&&!(UO&268435455)||xp(Ma,Ba)}function WP(e,t){var r=yi;yi|=2;var n=qK();(Ma!==e||Ba!==t)&&(yh=null,ry(e,t));do try{ipe();break}catch(a){GK(e,a)}while(!0);if(Q4(),yi=r,$P.current=n,ta!==null)throw Error(ur(261));return Ma=null,Ba=0,ga}function ipe(){for(;ta!==null;)HK(ta)}function ope(){for(;ta!==null&&!Ihe();)HK(ta)}function HK(e){var t=YK(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,t===null?ZK(e):ta=t,hB.current=null}function ZK(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Jfe(r,t),r!==null){r.flags&=32767,ta=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ga=6,ta=null;return}}else if(r=Kfe(r,t,Rl),r!==null){ta=r;return}if(t=t.sibling,t!==null){ta=t;return}ta=t=e}while(t!==null);ga===0&&(ga=5)}function Eg(e,t,r){var n=Ri,a=Tc.transition;try{Tc.transition=null,Ri=1,ape(e,t,r,n)}finally{Tc.transition=a,Ri=n}return null}function ape(e,t,r,n){do s0();while(Dp!==null);if(yi&6)throw Error(ur(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ur(177));e.callbackNode=null,e.callbackPriority=0;var l=r.lanes|r.childLanes;if(Bhe(e,l),e===Ma&&(ta=Ma=null,Ba=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||GA||(GA=!0,KK(EP,function(){return s0(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=Tc.transition,Tc.transition=null;var f=Ri;Ri=1;var i=yi;yi|=4,hB.current=null,epe(e,r),UK(r,e),Afe(VN),MP=!!UN,VN=UN=null,e.current=r,tpe(r),Ohe(),yi=i,Ri=f,Tc.transition=l}else e.current=r;if(GA&&(GA=!1,Dp=e,VP=a),l=e.pendingLanes,l===0&&(Gp=null),Dhe(r.stateNode),hl(e,Wo()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(UP)throw UP=!1,e=cz,cz=null,e;return VP&1&&e.tag!==0&&s0(),l=e.pendingLanes,l&1?e===uz?gS++:(gS=0,uz=e):gS=0,mm(),null}function s0(){if(Dp!==null){var e=CY(VP),t=Tc.transition,r=Ri;try{if(Tc.transition=null,Ri=16>e?16:e,Dp===null)var n=!1;else{if(e=Dp,Dp=null,VP=0,yi&6)throw Error(ur(331));var a=yi;for(yi|=4,jr=e.current;jr!==null;){var l=jr,f=l.child;if(jr.flags&16){var i=l.deletions;if(i!==null){for(var _=0;_<i.length;_++){var b=i[_];for(jr=b;jr!==null;){var E=jr;switch(E.tag){case 0:case 11:case 15:pS(8,E,l)}var C=E.child;if(C!==null)C.return=E,jr=C;else for(;jr!==null;){E=jr;var R=E.sibling,F=E.return;if(FK(E),E===b){jr=null;break}if(R!==null){R.return=F,jr=R;break}jr=F}}}var U=l.alternate;if(U!==null){var $=U.child;if($!==null){U.child=null;do{var H=$.sibling;$.sibling=null,$=H}while($!==null)}}jr=l}}if(l.subtreeFlags&2064&&f!==null)f.return=l,jr=f;else e:for(;jr!==null;){if(l=jr,l.flags&2048)switch(l.tag){case 0:case 11:case 15:pS(9,l,l.return)}var q=l.sibling;if(q!==null){q.return=l.return,jr=q;break e}jr=l.return}}var G=e.current;for(jr=G;jr!==null;){f=jr;var J=f.child;if(f.subtreeFlags&2064&&J!==null)J.return=f,jr=J;else e:for(f=G;jr!==null;){if(i=jr,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:$O(9,i)}}catch(oe){Lo(i,i.return,oe)}if(i===f){jr=null;break e}var te=i.sibling;if(te!==null){te.return=i.return,jr=te;break e}jr=i.return}}if(yi=a,mm(),Ad&&typeof Ad.onPostCommitFiberRoot=="function")try{Ad.onPostCommitFiberRoot(RO,e)}catch{}n=!0}return n}finally{Ri=r,Tc.transition=t}}return!1}function hG(e,t,r){t=j0(r,t),t=CK(e,t,1),e=Wp(e,t,1),t=Ps(),e!==null&&(sE(e,1,t),hl(e,t))}function Lo(e,t,r){if(e.tag===3)hG(e,e,r);else for(;t!==null;){if(t.tag===3){hG(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Gp===null||!Gp.has(n))){e=j0(r,e),e=PK(t,e,1),t=Wp(t,e,1),e=Ps(),t!==null&&(sE(t,1,e),hl(t,e));break}}t=t.return}}function spe(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ps(),e.pingedLanes|=e.suspendedLanes&r,Ma===e&&(Ba&r)===r&&(ga===4||ga===3&&(Ba&130023424)===Ba&&500>Wo()-pB?ry(e,0):fB|=r),hl(e,t)}function XK(e,t){t===0&&(e.mode&1?(t=LA,LA<<=1,!(LA&130023424)&&(LA=4194304)):t=1);var r=Ps();e=jh(e,t),e!==null&&(sE(e,t,r),hl(e,r))}function lpe(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),XK(e,r)}function cpe(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ur(314))}n!==null&&n.delete(t),XK(e,r)}var YK;YK=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ul.current)al=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return al=!1,Yfe(e,t,r);al=!!(e.flags&131072)}else al=!1,go&&t.flags&1048576&&eK(t,DP,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;NM(e,t),e=t.pendingProps;var a=D0(t,os.current);a0(t,r),a=sB(null,t,n,e,a,r);var l=lB();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dl(n)?(l=!0,kP(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,rB(t),a.updater=BO,t.stateNode=a,a._reactInternals=t,JN(t,n,e,r),t=tz(null,t,n,!0,l,r)):(t.tag=0,go&&l&&X4(t),Ts(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(NM(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=dpe(n),e=lu(n,e),a){case 0:t=ez(null,t,n,e,r);break e;case 1:t=rG(null,t,n,e,r);break e;case 11:t=eG(null,t,n,e,r);break e;case 14:t=tG(null,t,n,lu(n.type,e),r);break e}throw Error(ur(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:lu(n,a),ez(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:lu(n,a),rG(e,t,n,a,r);case 3:e:{if(RK(t),e===null)throw Error(ur(387));n=t.pendingProps,l=t.memoizedState,a=l.element,aK(e,t),zP(t,n,null,r);var f=t.memoizedState;if(n=f.element,l.isDehydrated)if(l={element:n,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=j0(Error(ur(423)),t),t=nG(e,t,n,r,a);break e}else if(n!==a){a=j0(Error(ur(424)),t),t=nG(e,t,n,r,a);break e}else for(Bl=Vp(t.stateNode.containerInfo.firstChild),Ul=t,go=!0,mu=null,r=iK(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(L0(),n===a){t=Fh(e,t,r);break e}Ts(e,t,n,r)}t=t.child}return t;case 5:return sK(t),e===null&&XN(t),n=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,f=a.children,WN(n,a)?f=null:l!==null&&WN(n,l)&&(t.flags|=32),kK(e,t),Ts(e,t,f,r),t.child;case 6:return e===null&&XN(t),null;case 13:return DK(e,t,r);case 4:return nB(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=N0(t,null,n,r):Ts(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:lu(n,a),eG(e,t,n,a,r);case 7:return Ts(e,t,t.pendingProps,r),t.child;case 8:return Ts(e,t,t.pendingProps.children,r),t.child;case 12:return Ts(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,l=t.memoizedProps,f=a.value,eo(LP,n._currentValue),n._currentValue=f,l!==null)if(Cu(l.value,f)){if(l.children===a.children&&!ul.current){t=Fh(e,t,r);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){f=l.child;for(var _=i.firstContext;_!==null;){if(_.context===n){if(l.tag===1){_=Ch(-1,r&-r),_.tag=2;var b=l.updateQueue;if(b!==null){b=b.shared;var E=b.pending;E===null?_.next=_:(_.next=E.next,E.next=_),b.pending=_}}l.lanes|=r,_=l.alternate,_!==null&&(_.lanes|=r),YN(l.return,r,t),i.lanes|=r;break}_=_.next}}else if(l.tag===10)f=l.type===t.type?null:l.child;else if(l.tag===18){if(f=l.return,f===null)throw Error(ur(341));f.lanes|=r,i=f.alternate,i!==null&&(i.lanes|=r),YN(f,r,t),f=l.sibling}else f=l.child;if(f!==null)f.return=l;else for(f=l;f!==null;){if(f===t){f=null;break}if(l=f.sibling,l!==null){l.return=f.return,f=l;break}f=f.return}l=f}Ts(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,a0(t,r),a=Mc(a),n=n(a),t.flags|=1,Ts(e,t,n,r),t.child;case 14:return n=t.type,a=lu(n,t.pendingProps),a=lu(n.type,a),tG(e,t,n,a,r);case 15:return IK(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:lu(n,a),NM(e,t),t.tag=1,dl(n)?(e=!0,kP(t)):e=!1,a0(t,r),MK(t,n,a),JN(t,n,a,r),tz(null,t,n,!0,e,r);case 19:return LK(e,t,r);case 22:return OK(e,t,r)}throw Error(ur(156,t.tag))};function KK(e,t){return TY(e,t)}function upe(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bc(e,t,r,n){return new upe(e,t,r,n)}function vB(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dpe(e){if(typeof e=="function")return vB(e)?1:0;if(e!=null){if(e=e.$$typeof,e===z4)return 11;if(e===j4)return 14}return 2}function Hp(e,t){var r=e.alternate;return r===null?(r=bc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function FM(e,t,r,n,a,l){var f=2;if(n=e,typeof e=="function")vB(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case F_:return ny(r.children,a,l,t);case N4:f=8,a|=8;break;case wN:return e=bc(12,r,t,a|2),e.elementType=wN,e.lanes=l,e;case SN:return e=bc(13,r,t,a),e.elementType=SN,e.lanes=l,e;case TN:return e=bc(19,r,t,a),e.elementType=TN,e.lanes=l,e;case sY:return VO(r,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case oY:f=10;break e;case aY:f=9;break e;case z4:f=11;break e;case j4:f=14;break e;case mp:f=16,n=null;break e}throw Error(ur(130,e==null?e:typeof e,""))}return t=bc(f,r,t,a),t.elementType=e,t.type=n,t.lanes=l,t}function ny(e,t,r,n){return e=bc(7,e,n,t),e.lanes=r,e}function VO(e,t,r,n){return e=bc(22,e,n,t),e.elementType=sY,e.lanes=r,e.stateNode={isHidden:!1},e}function r3(e,t,r){return e=bc(6,e,null,t),e.lanes=r,e}function n3(e,t,r){return t=bc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function hpe(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zL(0),this.expirationTimes=zL(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zL(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function _B(e,t,r,n,a,l,f,i,_){return e=new hpe(e,t,r,i,_),t===1?(t=1,l===!0&&(t|=8)):t=0,l=bc(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},rB(l),e}function fpe(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j_,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function JK(e){if(!e)return em;e=e._reactInternals;e:{if(Ry(e)!==e||e.tag!==1)throw Error(ur(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ur(171))}if(e.tag===1){var r=e.type;if(dl(r))return JY(e,r,t)}return t}function QK(e,t,r,n,a,l,f,i,_){return e=_B(r,n,!0,e,a,l,f,i,_),e.context=JK(null),r=e.current,n=Ps(),a=qp(r),l=Ch(n,a),l.callback=t??null,Wp(r,l,a),e.current.lanes=a,sE(e,a,n),hl(e,n),e}function WO(e,t,r,n){var a=t.current,l=Ps(),f=qp(a);return r=JK(r),t.context===null?t.context=r:t.pendingContext=r,t=Ch(l,f),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Wp(a,t,f),e!==null&&(Su(e,a,f,l),RM(e,a,f)),f}function GP(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fG(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xB(e,t){fG(e,t),(e=e.alternate)&&fG(e,t)}function ppe(){return null}var eJ=typeof reportError=="function"?reportError:function(e){console.error(e)};function bB(e){this._internalRoot=e}GO.prototype.render=bB.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ur(409));WO(e,t,null,null)};GO.prototype.unmount=bB.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;yy(function(){WO(null,e,null,null)}),t[zh]=null}};function GO(e){this._internalRoot=e}GO.prototype.unstable_scheduleHydration=function(e){if(e){var t=OY();e={blockedOn:null,target:e,priority:t};for(var r=0;r<_p.length&&t!==0&&t<_p[r].priority;r++);_p.splice(r,0,e),r===0&&RY(e)}};function wB(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pG(){}function mpe(e,t,r,n,a){if(a){if(typeof n=="function"){var l=n;n=function(){var b=GP(f);l.call(b)}}var f=QK(t,n,e,0,null,!1,!1,"",pG);return e._reactRootContainer=f,e[zh]=f.current,BS(e.nodeType===8?e.parentNode:e),yy(),f}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var i=n;n=function(){var b=GP(_);i.call(b)}}var _=_B(e,0,!1,null,null,!1,!1,"",pG);return e._reactRootContainer=_,e[zh]=_.current,BS(e.nodeType===8?e.parentNode:e),yy(function(){WO(t,_,r,n)}),_}function HO(e,t,r,n,a){var l=r._reactRootContainer;if(l){var f=l;if(typeof a=="function"){var i=a;a=function(){var _=GP(f);i.call(_)}}WO(t,f,e,a)}else f=mpe(r,t,e,a,n);return GP(f)}PY=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Cw(t.pendingLanes);r!==0&&($4(t,r|1),hl(t,Wo()),!(yi&6)&&(F0=Wo()+500,mm()))}break;case 13:yy(function(){var n=jh(e,1);if(n!==null){var a=Ps();Su(n,e,1,a)}}),xB(e,1)}};U4=function(e){if(e.tag===13){var t=jh(e,134217728);if(t!==null){var r=Ps();Su(t,e,134217728,r)}xB(e,134217728)}};IY=function(e){if(e.tag===13){var t=qp(e),r=jh(e,t);if(r!==null){var n=Ps();Su(r,e,t,n)}xB(e,t)}};OY=function(){return Ri};kY=function(e,t){var r=Ri;try{return Ri=e,t()}finally{Ri=r}};DN=function(e,t,r){switch(t){case"input":if(MN(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=zO(n);if(!a)throw Error(ur(90));cY(n),MN(n,a)}}}break;case"textarea":dY(e,r);break;case"select":t=r.value,t!=null&&r0(e,!!r.multiple,t,!1)}};vY=mB;_Y=yy;var gpe={usingClientEntryPoint:!1,Events:[cE,V_,zO,gY,yY,mB]},ow={findFiberByHostInstance:jg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ype={bundleType:ow.bundleType,version:ow.version,rendererPackageName:ow.rendererPackageName,rendererConfig:ow.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xh.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wY(e),e===null?null:e.stateNode},findFiberByHostInstance:ow.findFiberByHostInstance||ppe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qA.isDisabled&&qA.supportsFiber)try{RO=qA.inject(ype),Ad=qA}catch{}}Yl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gpe;Yl.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wB(t))throw Error(ur(200));return fpe(e,t,null,r)};Yl.createRoot=function(e,t){if(!wB(e))throw Error(ur(299));var r=!1,n="",a=eJ;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=_B(e,1,!1,null,null,r,!1,n,a),e[zh]=t.current,BS(e.nodeType===8?e.parentNode:e),new bB(t)};Yl.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ur(188)):(e=Object.keys(e).join(","),Error(ur(268,e)));return e=wY(t),e=e===null?null:e.stateNode,e};Yl.flushSync=function(e){return yy(e)};Yl.hydrate=function(e,t,r){if(!qO(t))throw Error(ur(200));return HO(null,e,t,!0,r)};Yl.hydrateRoot=function(e,t,r){if(!wB(e))throw Error(ur(405));var n=r!=null&&r.hydratedSources||null,a=!1,l="",f=eJ;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(f=r.onRecoverableError)),t=QK(t,null,e,1,r??null,a,!1,l,f),e[zh]=t.current,BS(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new GO(t)};Yl.render=function(e,t,r){if(!qO(t))throw Error(ur(200));return HO(null,e,t,!1,r)};Yl.unmountComponentAtNode=function(e){if(!qO(e))throw Error(ur(40));return e._reactRootContainer?(yy(function(){HO(null,null,e,!1,function(){e._reactRootContainer=null,e[zh]=null})}),!0):!1};Yl.unstable_batchedUpdates=mB;Yl.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!qO(r))throw Error(ur(200));if(e==null||e._reactInternals===void 0)throw Error(ur(38));return HO(e,t,r,!1,n)};Yl.version="18.3.1-next-f1338f8080-20240426";function tJ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tJ)}catch(e){console.error(e)}}tJ(),tY.exports=Yl;var Dy=tY.exports;const rJ=hi(Dy);var nJ,mG=Dy;nJ=mG.createRoot,mG.hydrateRoot;const vpe=1,_pe=1e6;let i3=0;function xpe(){return i3=(i3+1)%Number.MAX_SAFE_INTEGER,i3.toString()}const o3=new Map,gG=e=>{if(o3.has(e))return;const t=setTimeout(()=>{o3.delete(e),yS({type:"REMOVE_TOAST",toastId:e})},_pe);o3.set(e,t)},bpe=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,vpe)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?gG(r):e.toasts.forEach(n=>{gG(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},BM=[];let $M={toasts:[]};function yS(e){$M=bpe($M,e),BM.forEach(t=>{t($M)})}function qP({...e}){const t=xpe(),r=a=>yS({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>yS({type:"DISMISS_TOAST",toastId:t});return yS({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function Px(){const[e,t]=ne.useState($M);return ne.useEffect(()=>(BM.push(t),()=>{const r=BM.indexOf(t);r>-1&&BM.splice(r,1)}),[e]),{...e,toast:qP,dismiss:r=>yS({type:"DISMISS_TOAST",toastId:r})}}function Kr(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function wpe(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function iJ(...e){return t=>e.forEach(r=>wpe(r,t))}function Ci(...e){return ne.useCallback(iJ(...e),e)}function Spe(e,t=[]){let r=[];function n(l,f){const i=ne.createContext(f),_=r.length;r=[...r,f];function b(C){const{scope:R,children:F,...U}=C,$=(R==null?void 0:R[e][_])||i,H=ne.useMemo(()=>U,Object.values(U));return j.jsx($.Provider,{value:H,children:F})}function E(C,R){const F=(R==null?void 0:R[e][_])||i,U=ne.useContext(F);if(U)return U;if(f!==void 0)return f;throw new Error(`\`${C}\` must be used within \`${l}\``)}return b.displayName=l+"Provider",[b,E]}const a=()=>{const l=r.map(f=>ne.createContext(f));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,Tpe(a,...t)]}function Tpe(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const f=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}var Bh=ne.forwardRef((e,t)=>{const{children:r,...n}=e,a=ne.Children.toArray(r),l=a.find(Epe);if(l){const f=l.props.children,i=a.map(_=>_===l?ne.Children.count(f)>1?ne.Children.only(null):ne.isValidElement(f)?f.props.children:null:_);return j.jsx(fz,{...n,ref:t,children:ne.isValidElement(f)?ne.cloneElement(f,void 0,i):null})}return j.jsx(fz,{...n,ref:t,children:r})});Bh.displayName="Slot";var fz=ne.forwardRef((e,t)=>{const{children:r,...n}=e;if(ne.isValidElement(r)){const a=Mpe(r);return ne.cloneElement(r,{...Ape(n,r.props),ref:t?iJ(t,a):a})}return ne.Children.count(r)>1?ne.Children.only(null):null});fz.displayName="SlotClone";var oJ=({children:e})=>j.jsx(j.Fragment,{children:e});function Epe(e){return ne.isValidElement(e)&&e.type===oJ}function Ape(e,t){const r={...t};for(const n in t){const a=e[n],l=t[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...i)=>{l(...i),a(...i)}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}function Mpe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function SB(e){const t=e+"CollectionProvider",[r,n]=Spe(t),[a,l]=r(t,{collectionRef:{current:null},itemMap:new Map}),f=F=>{const{scope:U,children:$}=F,H=ze.useRef(null),q=ze.useRef(new Map).current;return j.jsx(a,{scope:U,itemMap:q,collectionRef:H,children:$})};f.displayName=t;const i=e+"CollectionSlot",_=ze.forwardRef((F,U)=>{const{scope:$,children:H}=F,q=l(i,$),G=Ci(U,q.collectionRef);return j.jsx(Bh,{ref:G,children:H})});_.displayName=i;const b=e+"CollectionItemSlot",E="data-radix-collection-item",C=ze.forwardRef((F,U)=>{const{scope:$,children:H,...q}=F,G=ze.useRef(null),J=Ci(U,G),te=l(b,$);return ze.useEffect(()=>(te.itemMap.set(G,{ref:G,...q}),()=>void te.itemMap.delete(G))),j.jsx(Bh,{[E]:"",ref:J,children:H})});C.displayName=b;function R(F){const U=l(e+"CollectionConsumer",F);return ze.useCallback(()=>{const H=U.collectionRef.current;if(!H)return[];const q=Array.from(H.querySelectorAll(`[${E}]`));return Array.from(U.itemMap.values()).sort((te,oe)=>q.indexOf(te.ref.current)-q.indexOf(oe.ref.current))},[U.collectionRef,U.itemMap])}return[{Provider:f,Slot:_,ItemSlot:C},R,n]}function Cpe(e,t){const r=ne.createContext(t),n=l=>{const{children:f,...i}=l,_=ne.useMemo(()=>i,Object.values(i));return j.jsx(r.Provider,{value:_,children:f})};n.displayName=e+"Provider";function a(l){const f=ne.useContext(r);if(f)return f;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[n,a]}function gm(e,t=[]){let r=[];function n(l,f){const i=ne.createContext(f),_=r.length;r=[...r,f];const b=C=>{var q;const{scope:R,children:F,...U}=C,$=((q=R==null?void 0:R[e])==null?void 0:q[_])||i,H=ne.useMemo(()=>U,Object.values(U));return j.jsx($.Provider,{value:H,children:F})};b.displayName=l+"Provider";function E(C,R){var $;const F=(($=R==null?void 0:R[e])==null?void 0:$[_])||i,U=ne.useContext(F);if(U)return U;if(f!==void 0)return f;throw new Error(`\`${C}\` must be used within \`${l}\``)}return[b,E]}const a=()=>{const l=r.map(f=>ne.createContext(f));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,Ppe(a,...t)]}function Ppe(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const f=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}var Ipe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],In=Ipe.reduce((e,t)=>{const r=ne.forwardRef((n,a)=>{const{asChild:l,...f}=n,i=l?Bh:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),j.jsx(i,{...f,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function aJ(e,t){e&&Dy.flushSync(()=>e.dispatchEvent(t))}function pl(e){const t=ne.useRef(e);return ne.useEffect(()=>{t.current=e}),ne.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Ope(e,t=globalThis==null?void 0:globalThis.document){const r=pl(e);ne.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var kpe="DismissableLayer",pz="dismissableLayer.update",Rpe="dismissableLayer.pointerDownOutside",Dpe="dismissableLayer.focusOutside",yG,sJ=ne.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ix=ne.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:f,onDismiss:i,..._}=e,b=ne.useContext(sJ),[E,C]=ne.useState(null),R=(E==null?void 0:E.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,F]=ne.useState({}),U=Ci(t,le=>C(le)),$=Array.from(b.layers),[H]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),q=$.indexOf(H),G=E?$.indexOf(E):-1,J=b.layersWithOutsidePointerEventsDisabled.size>0,te=G>=q,oe=Npe(le=>{const ve=le.target,We=[...b.branches].some(Ie=>Ie.contains(ve));!te||We||(a==null||a(le),f==null||f(le),le.defaultPrevented||i==null||i())},R),he=zpe(le=>{const ve=le.target;[...b.branches].some(Ie=>Ie.contains(ve))||(l==null||l(le),f==null||f(le),le.defaultPrevented||i==null||i())},R);return Ope(le=>{G===b.layers.size-1&&(n==null||n(le),!le.defaultPrevented&&i&&(le.preventDefault(),i()))},R),ne.useEffect(()=>{if(E)return r&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(yG=R.body.style.pointerEvents,R.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(E)),b.layers.add(E),vG(),()=>{r&&b.layersWithOutsidePointerEventsDisabled.size===1&&(R.body.style.pointerEvents=yG)}},[E,R,r,b]),ne.useEffect(()=>()=>{E&&(b.layers.delete(E),b.layersWithOutsidePointerEventsDisabled.delete(E),vG())},[E,b]),ne.useEffect(()=>{const le=()=>F({});return document.addEventListener(pz,le),()=>document.removeEventListener(pz,le)},[]),j.jsx(In.div,{..._,ref:U,style:{pointerEvents:J?te?"auto":"none":void 0,...e.style},onFocusCapture:Kr(e.onFocusCapture,he.onFocusCapture),onBlurCapture:Kr(e.onBlurCapture,he.onBlurCapture),onPointerDownCapture:Kr(e.onPointerDownCapture,oe.onPointerDownCapture)})});Ix.displayName=kpe;var Lpe="DismissableLayerBranch",lJ=ne.forwardRef((e,t)=>{const r=ne.useContext(sJ),n=ne.useRef(null),a=Ci(t,n);return ne.useEffect(()=>{const l=n.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),j.jsx(In.div,{...e,ref:a})});lJ.displayName=Lpe;function Npe(e,t=globalThis==null?void 0:globalThis.document){const r=pl(e),n=ne.useRef(!1),a=ne.useRef(()=>{});return ne.useEffect(()=>{const l=i=>{if(i.target&&!n.current){let _=function(){cJ(Rpe,r,b,{discrete:!0})};const b={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=_,t.addEventListener("click",a.current,{once:!0})):_()}else t.removeEventListener("click",a.current);n.current=!1},f=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(f),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function zpe(e,t=globalThis==null?void 0:globalThis.document){const r=pl(e),n=ne.useRef(!1);return ne.useEffect(()=>{const a=l=>{l.target&&!n.current&&cJ(Dpe,r,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function vG(){const e=new CustomEvent(pz);document.dispatchEvent(e)}function cJ(e,t,r,{discrete:n}){const a=r.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?aJ(a,l):a.dispatchEvent(l)}var jpe=Ix,Fpe=lJ,as=globalThis!=null&&globalThis.document?ne.useLayoutEffect:()=>{},Bpe="Portal",dE=ne.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[a,l]=ne.useState(!1);as(()=>l(!0),[]);const f=r||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return f?rJ.createPortal(j.jsx(In.div,{...n,ref:t}),f):null});dE.displayName=Bpe;function $pe(e,t){return ne.useReducer((r,n)=>t[r][n]??r,e)}var Fd=e=>{const{present:t,children:r}=e,n=Upe(t),a=typeof r=="function"?r({present:n.isPresent}):ne.Children.only(r),l=Ci(n.ref,Vpe(a));return typeof r=="function"||n.isPresent?ne.cloneElement(a,{ref:l}):null};Fd.displayName="Presence";function Upe(e){const[t,r]=ne.useState(),n=ne.useRef({}),a=ne.useRef(e),l=ne.useRef("none"),f=e?"mounted":"unmounted",[i,_]=$pe(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return ne.useEffect(()=>{const b=HA(n.current);l.current=i==="mounted"?b:"none"},[i]),as(()=>{const b=n.current,E=a.current;if(E!==e){const R=l.current,F=HA(b);e?_("MOUNT"):F==="none"||(b==null?void 0:b.display)==="none"?_("UNMOUNT"):_(E&&R!==F?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,_]),as(()=>{if(t){let b;const E=t.ownerDocument.defaultView??window,C=F=>{const $=HA(n.current).includes(F.animationName);if(F.target===t&&$&&(_("ANIMATION_END"),!a.current)){const H=t.style.animationFillMode;t.style.animationFillMode="forwards",b=E.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=H)})}},R=F=>{F.target===t&&(l.current=HA(n.current))};return t.addEventListener("animationstart",R),t.addEventListener("animationcancel",C),t.addEventListener("animationend",C),()=>{E.clearTimeout(b),t.removeEventListener("animationstart",R),t.removeEventListener("animationcancel",C),t.removeEventListener("animationend",C)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:ne.useCallback(b=>{b&&(n.current=getComputedStyle(b)),r(b)},[])}}function HA(e){return(e==null?void 0:e.animationName)||"none"}function Vpe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function tm({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=Wpe({defaultProp:t,onChange:r}),l=e!==void 0,f=l?e:n,i=pl(r),_=ne.useCallback(b=>{if(l){const C=typeof b=="function"?b(e):b;C!==e&&i(C)}else a(b)},[l,e,a,i]);return[f,_]}function Wpe({defaultProp:e,onChange:t}){const r=ne.useState(e),[n]=r,a=ne.useRef(n),l=pl(t);return ne.useEffect(()=>{a.current!==n&&(l(n),a.current=n)},[n,a,l]),r}var Gpe="VisuallyHidden",hE=ne.forwardRef((e,t)=>j.jsx(In.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));hE.displayName=Gpe;var qpe=hE,TB="ToastProvider",[EB,Hpe,Zpe]=SB("Toast"),[uJ,vKe]=gm("Toast",[Zpe]),[Xpe,ZO]=uJ(TB),dJ=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:f}=e,[i,_]=ne.useState(null),[b,E]=ne.useState(0),C=ne.useRef(!1),R=ne.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${TB}\`. Expected non-empty \`string\`.`),j.jsx(EB.Provider,{scope:t,children:j.jsx(Xpe,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:l,toastCount:b,viewport:i,onViewportChange:_,onToastAdd:ne.useCallback(()=>E(F=>F+1),[]),onToastRemove:ne.useCallback(()=>E(F=>F-1),[]),isFocusedToastEscapeKeyDownRef:C,isClosePausedRef:R,children:f})})};dJ.displayName=TB;var hJ="ToastViewport",Ype=["F8"],mz="toast.viewportPause",gz="toast.viewportResume",fJ=ne.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Ype,label:a="Notifications ({hotkey})",...l}=e,f=ZO(hJ,r),i=Hpe(r),_=ne.useRef(null),b=ne.useRef(null),E=ne.useRef(null),C=ne.useRef(null),R=Ci(t,C,f.onViewportChange),F=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),U=f.toastCount>0;ne.useEffect(()=>{const H=q=>{var J;n.length!==0&&n.every(te=>q[te]||q.code===te)&&((J=C.current)==null||J.focus())};return document.addEventListener("keydown",H),()=>document.removeEventListener("keydown",H)},[n]),ne.useEffect(()=>{const H=_.current,q=C.current;if(U&&H&&q){const G=()=>{if(!f.isClosePausedRef.current){const he=new CustomEvent(mz);q.dispatchEvent(he),f.isClosePausedRef.current=!0}},J=()=>{if(f.isClosePausedRef.current){const he=new CustomEvent(gz);q.dispatchEvent(he),f.isClosePausedRef.current=!1}},te=he=>{!H.contains(he.relatedTarget)&&J()},oe=()=>{H.contains(document.activeElement)||J()};return H.addEventListener("focusin",G),H.addEventListener("focusout",te),H.addEventListener("pointermove",G),H.addEventListener("pointerleave",oe),window.addEventListener("blur",G),window.addEventListener("focus",J),()=>{H.removeEventListener("focusin",G),H.removeEventListener("focusout",te),H.removeEventListener("pointermove",G),H.removeEventListener("pointerleave",oe),window.removeEventListener("blur",G),window.removeEventListener("focus",J)}}},[U,f.isClosePausedRef]);const $=ne.useCallback(({tabbingDirection:H})=>{const G=i().map(J=>{const te=J.ref.current,oe=[te,...cme(te)];return H==="forwards"?oe:oe.reverse()});return(H==="forwards"?G.reverse():G).flat()},[i]);return ne.useEffect(()=>{const H=C.current;if(H){const q=G=>{var oe,he,le;const J=G.altKey||G.ctrlKey||G.metaKey;if(G.key==="Tab"&&!J){const ve=document.activeElement,We=G.shiftKey;if(G.target===H&&We){(oe=b.current)==null||oe.focus();return}const $e=$({tabbingDirection:We?"backwards":"forwards"}),ot=$e.findIndex(Je=>Je===ve);a3($e.slice(ot+1))?G.preventDefault():We?(he=b.current)==null||he.focus():(le=E.current)==null||le.focus()}};return H.addEventListener("keydown",q),()=>H.removeEventListener("keydown",q)}},[i,$]),j.jsxs(Fpe,{ref:_,role:"region","aria-label":a.replace("{hotkey}",F),tabIndex:-1,style:{pointerEvents:U?void 0:"none"},children:[U&&j.jsx(yz,{ref:b,onFocusFromOutsideViewport:()=>{const H=$({tabbingDirection:"forwards"});a3(H)}}),j.jsx(EB.Slot,{scope:r,children:j.jsx(In.ol,{tabIndex:-1,...l,ref:R})}),U&&j.jsx(yz,{ref:E,onFocusFromOutsideViewport:()=>{const H=$({tabbingDirection:"backwards"});a3(H)}})]})});fJ.displayName=hJ;var pJ="ToastFocusProxy",yz=ne.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,l=ZO(pJ,r);return j.jsx(hE,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:f=>{var b;const i=f.relatedTarget;!((b=l.viewport)!=null&&b.contains(i))&&n()}})});yz.displayName=pJ;var XO="Toast",Kpe="toast.swipeStart",Jpe="toast.swipeMove",Qpe="toast.swipeCancel",eme="toast.swipeEnd",mJ=ne.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:l,...f}=e,[i=!0,_]=tm({prop:n,defaultProp:a,onChange:l});return j.jsx(Fd,{present:r||i,children:j.jsx(nme,{open:i,...f,ref:t,onClose:()=>_(!1),onPause:pl(e.onPause),onResume:pl(e.onResume),onSwipeStart:Kr(e.onSwipeStart,b=>{b.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Kr(e.onSwipeMove,b=>{const{x:E,y:C}=b.detail.delta;b.currentTarget.setAttribute("data-swipe","move"),b.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${E}px`),b.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${C}px`)}),onSwipeCancel:Kr(e.onSwipeCancel,b=>{b.currentTarget.setAttribute("data-swipe","cancel"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),b.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Kr(e.onSwipeEnd,b=>{const{x:E,y:C}=b.detail.delta;b.currentTarget.setAttribute("data-swipe","end"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),b.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),b.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${E}px`),b.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${C}px`),_(!1)})})})});mJ.displayName=XO;var[tme,rme]=uJ(XO,{onClose(){}}),nme=ne.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:l,onClose:f,onEscapeKeyDown:i,onPause:_,onResume:b,onSwipeStart:E,onSwipeMove:C,onSwipeCancel:R,onSwipeEnd:F,...U}=e,$=ZO(XO,r),[H,q]=ne.useState(null),G=Ci(t,Je=>q(Je)),J=ne.useRef(null),te=ne.useRef(null),oe=a||$.duration,he=ne.useRef(0),le=ne.useRef(oe),ve=ne.useRef(0),{onToastAdd:We,onToastRemove:Ie}=$,Re=pl(()=>{var rt;(H==null?void 0:H.contains(document.activeElement))&&((rt=$.viewport)==null||rt.focus()),f()}),$e=ne.useCallback(Je=>{!Je||Je===1/0||(window.clearTimeout(ve.current),he.current=new Date().getTime(),ve.current=window.setTimeout(Re,Je))},[Re]);ne.useEffect(()=>{const Je=$.viewport;if(Je){const rt=()=>{$e(le.current),b==null||b()},st=()=>{const at=new Date().getTime()-he.current;le.current=le.current-at,window.clearTimeout(ve.current),_==null||_()};return Je.addEventListener(mz,st),Je.addEventListener(gz,rt),()=>{Je.removeEventListener(mz,st),Je.removeEventListener(gz,rt)}}},[$.viewport,oe,_,b,$e]),ne.useEffect(()=>{l&&!$.isClosePausedRef.current&&$e(oe)},[l,oe,$.isClosePausedRef,$e]),ne.useEffect(()=>(We(),()=>Ie()),[We,Ie]);const ot=ne.useMemo(()=>H?wJ(H):null,[H]);return $.viewport?j.jsxs(j.Fragment,{children:[ot&&j.jsx(ime,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ot}),j.jsx(tme,{scope:r,onClose:Re,children:Dy.createPortal(j.jsx(EB.ItemSlot,{scope:r,children:j.jsx(jpe,{asChild:!0,onEscapeKeyDown:Kr(i,()=>{$.isFocusedToastEscapeKeyDownRef.current||Re(),$.isFocusedToastEscapeKeyDownRef.current=!1}),children:j.jsx(In.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":$.swipeDirection,...U,ref:G,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Kr(e.onKeyDown,Je=>{Je.key==="Escape"&&(i==null||i(Je.nativeEvent),Je.nativeEvent.defaultPrevented||($.isFocusedToastEscapeKeyDownRef.current=!0,Re()))}),onPointerDown:Kr(e.onPointerDown,Je=>{Je.button===0&&(J.current={x:Je.clientX,y:Je.clientY})}),onPointerMove:Kr(e.onPointerMove,Je=>{if(!J.current)return;const rt=Je.clientX-J.current.x,st=Je.clientY-J.current.y,at=!!te.current,Be=["left","right"].includes($.swipeDirection),ct=["left","up"].includes($.swipeDirection)?Math.min:Math.max,jt=Be?ct(0,rt):0,Lt=Be?0:ct(0,st),$t=Je.pointerType==="touch"?10:2,ut={x:jt,y:Lt},tr={originalEvent:Je,delta:ut};at?(te.current=ut,ZA(Jpe,C,tr,{discrete:!1})):_G(ut,$.swipeDirection,$t)?(te.current=ut,ZA(Kpe,E,tr,{discrete:!1}),Je.target.setPointerCapture(Je.pointerId)):(Math.abs(rt)>$t||Math.abs(st)>$t)&&(J.current=null)}),onPointerUp:Kr(e.onPointerUp,Je=>{const rt=te.current,st=Je.target;if(st.hasPointerCapture(Je.pointerId)&&st.releasePointerCapture(Je.pointerId),te.current=null,J.current=null,rt){const at=Je.currentTarget,Be={originalEvent:Je,delta:rt};_G(rt,$.swipeDirection,$.swipeThreshold)?ZA(eme,F,Be,{discrete:!0}):ZA(Qpe,R,Be,{discrete:!0}),at.addEventListener("click",ct=>ct.preventDefault(),{once:!0})}})})})}),$.viewport)})]}):null}),ime=e=>{const{__scopeToast:t,children:r,...n}=e,a=ZO(XO,t),[l,f]=ne.useState(!1),[i,_]=ne.useState(!1);return sme(()=>f(!0)),ne.useEffect(()=>{const b=window.setTimeout(()=>_(!0),1e3);return()=>window.clearTimeout(b)},[]),i?null:j.jsx(dE,{asChild:!0,children:j.jsx(hE,{...n,children:l&&j.jsxs(j.Fragment,{children:[a.label," ",r]})})})},ome="ToastTitle",gJ=ne.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return j.jsx(In.div,{...n,ref:t})});gJ.displayName=ome;var ame="ToastDescription",yJ=ne.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return j.jsx(In.div,{...n,ref:t})});yJ.displayName=ame;var vJ="ToastAction",_J=ne.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?j.jsx(bJ,{altText:r,asChild:!0,children:j.jsx(AB,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${vJ}\`. Expected non-empty \`string\`.`),null)});_J.displayName=vJ;var xJ="ToastClose",AB=ne.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=rme(xJ,r);return j.jsx(bJ,{asChild:!0,children:j.jsx(In.button,{type:"button",...n,ref:t,onClick:Kr(e.onClick,a.onClose)})})});AB.displayName=xJ;var bJ=ne.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return j.jsx(In.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function wJ(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),lme(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",l=n.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const f=n.dataset.radixToastAnnounceAlt;f&&t.push(f)}else t.push(...wJ(n))}}),t}function ZA(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,l=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?aJ(a,l):a.dispatchEvent(l)}var _G=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),l=n>a;return t==="left"||t==="right"?l&&n>r:!l&&a>r};function sme(e=()=>{}){const t=pl(e);as(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function lme(e){return e.nodeType===e.ELEMENT_NODE}function cme(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function a3(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var ume=dJ,SJ=fJ,TJ=mJ,EJ=gJ,AJ=yJ,MJ=_J,CJ=AB;function PJ(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=PJ(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function di(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=PJ(e))&&(n&&(n+=" "),n+=t);return n}const xG=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,bG=di,fE=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return bG(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:l}=t,f=Object.keys(a).map(b=>{const E=r==null?void 0:r[b],C=l==null?void 0:l[b];if(E===null)return null;const R=xG(E)||xG(C);return a[b][R]}),i=r&&Object.entries(r).reduce((b,E)=>{let[C,R]=E;return R===void 0||(b[C]=R),b},{}),_=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((b,E)=>{let{class:C,className:R,...F}=E;return Object.entries(F).every(U=>{let[$,H]=U;return Array.isArray(H)?H.includes({...l,...i}[$]):{...l,...i}[$]===H})?[...b,C,R]:b},[]);return bG(e,f,_,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dme=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),IJ=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hme={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fme=ne.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:f,...i},_)=>ne.createElement("svg",{ref:_,...hme,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:IJ("lucide",a),...i},[...f.map(([b,E])=>ne.createElement(b,E)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=(e,t)=>{const r=ne.forwardRef(({className:n,...a},l)=>ne.createElement(fme,{ref:l,iconNode:t,className:IJ(`lucide-${dme(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=Cn("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=Cn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mme=Cn("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wG=Cn("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gme=Cn("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yme=Cn("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vme=Cn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OJ=Cn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _me=Cn("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xme=Cn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=Cn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=Cn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=Cn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=Cn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kJ=Cn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wme=Cn("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sme=Cn("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SG=Cn("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tme=Cn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=Cn("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=Cn("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=Cn("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TG=Cn("FileBox",[["path",{d:"M14.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"16lz6z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 13.1a2 2 0 0 0-1 1.76v3.24a2 2 0 0 0 .97 1.78L6 21.7a2 2 0 0 0 2.03.01L11 19.9a2 2 0 0 0 1-1.76V14.9a2 2 0 0 0-.97-1.78L8 11.3a2 2 0 0 0-2.03-.01Z",key:"99pj1s"}],["path",{d:"M7 17v5",key:"1yj1jh"}],["path",{d:"M11.7 14.2 7 17l-4.7-2.8",key:"1yk8tc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EG=Cn("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RJ=Cn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DJ=Cn("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ame=Cn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AG=Cn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MG=Cn("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LJ=Cn("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=Cn("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mme=Cn("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=Cn("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cme=Cn("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=Cn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pme=Cn("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=Cn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ime=Cn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ome=Cn("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kme=Cn("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=Cn("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CG=Cn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PG=Cn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=Cn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NJ=Cn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),OB="-",Rme=e=>{const t=Lme(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:f=>{const i=f.split(OB);return i[0]===""&&i.length!==1&&i.shift(),zJ(i,t)||Dme(f)},getConflictingClassGroupIds:(f,i)=>{const _=r[f]||[];return i&&n[f]?[..._,...n[f]]:_}}},zJ=(e,t)=>{var f;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?zJ(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(OB);return(f=t.validators.find(({validator:i})=>i(l)))==null?void 0:f.classGroupId},IG=/^\[(.+)\]$/,Dme=e=>{if(IG.test(e)){const t=IG.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Lme=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return zme(Object.entries(e.classGroups),r).forEach(([l,f])=>{_z(f,n,l,t)}),n},_z=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:OG(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(Nme(a)){_z(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,f])=>{_z(f,OG(t,l),r,n)})})},OG=(e,t)=>{let r=e;return t.split(OB).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Nme=e=>e.isThemeGetter,zme=(e,t)=>t?e.map(([r,n])=>{const a=n.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([f,i])=>[t+f,i])):l);return[r,a]}):e,jme=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(l,f)=>{r.set(l,f),t++,t>e&&(t=0,n=r,r=new Map)};return{get(l){let f=r.get(l);if(f!==void 0)return f;if((f=n.get(l))!==void 0)return a(l,f),f},set(l,f){r.has(l)?r.set(l,f):a(l,f)}}},jJ="!",Fme=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],l=t.length,f=i=>{const _=[];let b=0,E=0,C;for(let H=0;H<i.length;H++){let q=i[H];if(b===0){if(q===a&&(n||i.slice(H,H+l)===t)){_.push(i.slice(E,H)),E=H+l;continue}if(q==="/"){C=H;continue}}q==="["?b++:q==="]"&&b--}const R=_.length===0?i:i.substring(E),F=R.startsWith(jJ),U=F?R.substring(1):R,$=C&&C>E?C-E:void 0;return{modifiers:_,hasImportantModifier:F,baseClassName:U,maybePostfixModifierPosition:$}};return r?i=>r({className:i,parseClassName:f}):f},Bme=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},$me=e=>({cache:jme(e.cacheSize),parseClassName:Fme(e),...Rme(e)}),Ume=/\s+/,Vme=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,l=[],f=e.trim().split(Ume);let i="";for(let _=f.length-1;_>=0;_-=1){const b=f[_],{modifiers:E,hasImportantModifier:C,baseClassName:R,maybePostfixModifierPosition:F}=r(b);let U=!!F,$=n(U?R.substring(0,F):R);if(!$){if(!U){i=b+(i.length>0?" "+i:i);continue}if($=n(R),!$){i=b+(i.length>0?" "+i:i);continue}U=!1}const H=Bme(E).join(":"),q=C?H+jJ:H,G=q+$;if(l.includes(G))continue;l.push(G);const J=a($,U);for(let te=0;te<J.length;++te){const oe=J[te];l.push(q+oe)}i=b+(i.length>0?" "+i:i)}return i};function Wme(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=FJ(t))&&(n&&(n+=" "),n+=r);return n}const FJ=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=FJ(e[n]))&&(r&&(r+=" "),r+=t);return r};function Gme(e,...t){let r,n,a,l=f;function f(_){const b=t.reduce((E,C)=>C(E),e());return r=$me(b),n=r.cache.get,a=r.cache.set,l=i,i(_)}function i(_){const b=n(_);if(b)return b;const E=Vme(_,r);return a(_,E),E}return function(){return l(Wme.apply(null,arguments))}}const ao=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},BJ=/^\[(?:([a-z-]+):)?(.+)\]$/i,qme=/^\d+\/\d+$/,Hme=new Set(["px","full","screen"]),Zme=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Xme=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Yme=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Kme=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Jme=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ah=e=>c0(e)||Hme.has(e)||qme.test(e),tp=e=>Ox(e,"length",age),c0=e=>!!e&&!Number.isNaN(Number(e)),s3=e=>Ox(e,"number",c0),aw=e=>!!e&&Number.isInteger(Number(e)),Qme=e=>e.endsWith("%")&&c0(e.slice(0,-1)),kn=e=>BJ.test(e),rp=e=>Zme.test(e),ege=new Set(["length","size","percentage"]),tge=e=>Ox(e,ege,$J),rge=e=>Ox(e,"position",$J),nge=new Set(["image","url"]),ige=e=>Ox(e,nge,lge),oge=e=>Ox(e,"",sge),sw=()=>!0,Ox=(e,t,r)=>{const n=BJ.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},age=e=>Xme.test(e)&&!Yme.test(e),$J=()=>!1,sge=e=>Kme.test(e),lge=e=>Jme.test(e),cge=()=>{const e=ao("colors"),t=ao("spacing"),r=ao("blur"),n=ao("brightness"),a=ao("borderColor"),l=ao("borderRadius"),f=ao("borderSpacing"),i=ao("borderWidth"),_=ao("contrast"),b=ao("grayscale"),E=ao("hueRotate"),C=ao("invert"),R=ao("gap"),F=ao("gradientColorStops"),U=ao("gradientColorStopPositions"),$=ao("inset"),H=ao("margin"),q=ao("opacity"),G=ao("padding"),J=ao("saturate"),te=ao("scale"),oe=ao("sepia"),he=ao("skew"),le=ao("space"),ve=ao("translate"),We=()=>["auto","contain","none"],Ie=()=>["auto","hidden","clip","visible","scroll"],Re=()=>["auto",kn,t],$e=()=>[kn,t],ot=()=>["",ah,tp],Je=()=>["auto",c0,kn],rt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],st=()=>["solid","dashed","dotted","double","none"],at=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Be=()=>["start","end","center","between","around","evenly","stretch"],ct=()=>["","0",kn],jt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Lt=()=>[c0,kn];return{cacheSize:500,separator:":",theme:{colors:[sw],spacing:[ah,tp],blur:["none","",rp,kn],brightness:Lt(),borderColor:[e],borderRadius:["none","","full",rp,kn],borderSpacing:$e(),borderWidth:ot(),contrast:Lt(),grayscale:ct(),hueRotate:Lt(),invert:ct(),gap:$e(),gradientColorStops:[e],gradientColorStopPositions:[Qme,tp],inset:Re(),margin:Re(),opacity:Lt(),padding:$e(),saturate:Lt(),scale:Lt(),sepia:ct(),skew:Lt(),space:$e(),translate:$e()},classGroups:{aspect:[{aspect:["auto","square","video",kn]}],container:["container"],columns:[{columns:[rp]}],"break-after":[{"break-after":jt()}],"break-before":[{"break-before":jt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...rt(),kn]}],overflow:[{overflow:Ie()}],"overflow-x":[{"overflow-x":Ie()}],"overflow-y":[{"overflow-y":Ie()}],overscroll:[{overscroll:We()}],"overscroll-x":[{"overscroll-x":We()}],"overscroll-y":[{"overscroll-y":We()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[$]}],"inset-x":[{"inset-x":[$]}],"inset-y":[{"inset-y":[$]}],start:[{start:[$]}],end:[{end:[$]}],top:[{top:[$]}],right:[{right:[$]}],bottom:[{bottom:[$]}],left:[{left:[$]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",aw,kn]}],basis:[{basis:Re()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",kn]}],grow:[{grow:ct()}],shrink:[{shrink:ct()}],order:[{order:["first","last","none",aw,kn]}],"grid-cols":[{"grid-cols":[sw]}],"col-start-end":[{col:["auto",{span:["full",aw,kn]},kn]}],"col-start":[{"col-start":Je()}],"col-end":[{"col-end":Je()}],"grid-rows":[{"grid-rows":[sw]}],"row-start-end":[{row:["auto",{span:[aw,kn]},kn]}],"row-start":[{"row-start":Je()}],"row-end":[{"row-end":Je()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",kn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",kn]}],gap:[{gap:[R]}],"gap-x":[{"gap-x":[R]}],"gap-y":[{"gap-y":[R]}],"justify-content":[{justify:["normal",...Be()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Be(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Be(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[G]}],px:[{px:[G]}],py:[{py:[G]}],ps:[{ps:[G]}],pe:[{pe:[G]}],pt:[{pt:[G]}],pr:[{pr:[G]}],pb:[{pb:[G]}],pl:[{pl:[G]}],m:[{m:[H]}],mx:[{mx:[H]}],my:[{my:[H]}],ms:[{ms:[H]}],me:[{me:[H]}],mt:[{mt:[H]}],mr:[{mr:[H]}],mb:[{mb:[H]}],ml:[{ml:[H]}],"space-x":[{"space-x":[le]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[le]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",kn,t]}],"min-w":[{"min-w":[kn,t,"min","max","fit"]}],"max-w":[{"max-w":[kn,t,"none","full","min","max","fit","prose",{screen:[rp]},rp]}],h:[{h:[kn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[kn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[kn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[kn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",rp,tp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",s3]}],"font-family":[{font:[sw]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",kn]}],"line-clamp":[{"line-clamp":["none",c0,s3]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ah,kn]}],"list-image":[{"list-image":["none",kn]}],"list-style-type":[{list:["none","disc","decimal",kn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[q]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[q]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...st(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ah,tp]}],"underline-offset":[{"underline-offset":["auto",ah,kn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$e()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",kn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",kn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[q]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...rt(),rge]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",tge]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ige]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[U]}],"gradient-via-pos":[{via:[U]}],"gradient-to-pos":[{to:[U]}],"gradient-from":[{from:[F]}],"gradient-via":[{via:[F]}],"gradient-to":[{to:[F]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[q]}],"border-style":[{border:[...st(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[q]}],"divide-style":[{divide:st()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...st()]}],"outline-offset":[{"outline-offset":[ah,kn]}],"outline-w":[{outline:[ah,tp]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ot()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[q]}],"ring-offset-w":[{"ring-offset":[ah,tp]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",rp,oge]}],"shadow-color":[{shadow:[sw]}],opacity:[{opacity:[q]}],"mix-blend":[{"mix-blend":[...at(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":at()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[_]}],"drop-shadow":[{"drop-shadow":["","none",rp,kn]}],grayscale:[{grayscale:[b]}],"hue-rotate":[{"hue-rotate":[E]}],invert:[{invert:[C]}],saturate:[{saturate:[J]}],sepia:[{sepia:[oe]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[_]}],"backdrop-grayscale":[{"backdrop-grayscale":[b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[E]}],"backdrop-invert":[{"backdrop-invert":[C]}],"backdrop-opacity":[{"backdrop-opacity":[q]}],"backdrop-saturate":[{"backdrop-saturate":[J]}],"backdrop-sepia":[{"backdrop-sepia":[oe]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[f]}],"border-spacing-x":[{"border-spacing-x":[f]}],"border-spacing-y":[{"border-spacing-y":[f]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",kn]}],duration:[{duration:Lt()}],ease:[{ease:["linear","in","out","in-out",kn]}],delay:[{delay:Lt()}],animate:[{animate:["none","spin","ping","pulse","bounce",kn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[te]}],"scale-x":[{"scale-x":[te]}],"scale-y":[{"scale-y":[te]}],rotate:[{rotate:[aw,kn]}],"translate-x":[{"translate-x":[ve]}],"translate-y":[{"translate-y":[ve]}],"skew-x":[{"skew-x":[he]}],"skew-y":[{"skew-y":[he]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",kn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",kn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$e()}],"scroll-mx":[{"scroll-mx":$e()}],"scroll-my":[{"scroll-my":$e()}],"scroll-ms":[{"scroll-ms":$e()}],"scroll-me":[{"scroll-me":$e()}],"scroll-mt":[{"scroll-mt":$e()}],"scroll-mr":[{"scroll-mr":$e()}],"scroll-mb":[{"scroll-mb":$e()}],"scroll-ml":[{"scroll-ml":$e()}],"scroll-p":[{"scroll-p":$e()}],"scroll-px":[{"scroll-px":$e()}],"scroll-py":[{"scroll-py":$e()}],"scroll-ps":[{"scroll-ps":$e()}],"scroll-pe":[{"scroll-pe":$e()}],"scroll-pt":[{"scroll-pt":$e()}],"scroll-pr":[{"scroll-pr":$e()}],"scroll-pb":[{"scroll-pb":$e()}],"scroll-pl":[{"scroll-pl":$e()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",kn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ah,tp,s3]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},uge=Gme(cge);function Nr(...e){return uge(di(e))}const dge=ume,UJ=ne.forwardRef(({className:e,...t},r)=>j.jsx(SJ,{ref:r,className:Nr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));UJ.displayName=SJ.displayName;const hge=fE("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),VJ=ne.forwardRef(({className:e,variant:t,...r},n)=>j.jsx(TJ,{ref:n,className:Nr(hge({variant:t}),e),...r}));VJ.displayName=TJ.displayName;const fge=ne.forwardRef(({className:e,...t},r)=>j.jsx(MJ,{ref:r,className:Nr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));fge.displayName=MJ.displayName;const WJ=ne.forwardRef(({className:e,...t},r)=>j.jsx(CJ,{ref:r,className:Nr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:j.jsx(NJ,{className:"h-4 w-4"})}));WJ.displayName=CJ.displayName;const GJ=ne.forwardRef(({className:e,...t},r)=>j.jsx(EJ,{ref:r,className:Nr("text-sm font-semibold",e),...t}));GJ.displayName=EJ.displayName;const qJ=ne.forwardRef(({className:e,...t},r)=>j.jsx(AJ,{ref:r,className:Nr("text-sm opacity-90",e),...t}));qJ.displayName=AJ.displayName;function pge(){const{toasts:e}=Px();return j.jsxs(dge,{children:[e.map(function({id:t,title:r,description:n,action:a,...l}){return j.jsxs(VJ,{...l,children:[j.jsxs("div",{className:"grid gap-1",children:[r&&j.jsx(GJ,{children:r}),n&&j.jsx(qJ,{children:n})]}),a,j.jsx(WJ,{})]},t)}),j.jsx(UJ,{})]})}var kG=["light","dark"],mge="(prefers-color-scheme: dark)",gge=ne.createContext(void 0),yge={setTheme:e=>{},themes:[]},vge=()=>{var e;return(e=ne.useContext(gge))!=null?e:yge};ne.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:l,value:f,attrs:i,nonce:_})=>{let b=l==="system",E=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${i.map(U=>`'${U}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,C=a?kG.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",R=(U,$=!1,H=!0)=>{let q=f?f[U]:U,G=$?U+"|| ''":`'${q}'`,J="";return a&&H&&!$&&kG.includes(U)&&(J+=`d.style.colorScheme = '${U}';`),r==="class"?$||q?J+=`c.add(${G})`:J+="null":q&&(J+=`d[s](n,${G})`),J},F=e?`!function(){${E}${R(e)}}()`:n?`!function(){try{${E}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${b})){var t='${mge}',m=window.matchMedia(t);if(m.media!==t||m.matches){${R("dark")}}else{${R("light")}}}else if(e){${f?`var x=${JSON.stringify(f)};`:""}${R(f?"x[e]":"e",!0)}}${b?"":"else{"+R(l,!1,!1)+"}"}${C}}catch(e){}}()`:`!function(){try{${E}var e=localStorage.getItem('${t}');if(e){${f?`var x=${JSON.stringify(f)};`:""}${R(f?"x[e]":"e",!0)}}else{${R(l,!1,!1)};}${C}}catch(t){}}();`;return ne.createElement("script",{nonce:_,dangerouslySetInnerHTML:{__html:F}})});var _ge=e=>{switch(e){case"success":return wge;case"info":return Tge;case"warning":return Sge;case"error":return Ege;default:return null}},xge=Array(12).fill(0),bge=({visible:e})=>ze.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},ze.createElement("div",{className:"sonner-spinner"},xge.map((t,r)=>ze.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),wge=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Sge=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Tge=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ege=ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ze.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Age=()=>{let[e,t]=ze.useState(document.hidden);return ze.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},xz=1,Mge=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:xz++,l=this.toasts.find(i=>i.id===a),f=e.dismissible===void 0?!0:e.dismissible;return l?this.toasts=this.toasts.map(i=>i.id===a?(this.publish({...i,...e,id:a,title:r}),{...i,...e,id:a,dismissible:f,title:r}):i):this.addToast({title:r,...n,dismissible:f,id:a}),a},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),a=r!==void 0;return n.then(async l=>{if(Pge(l)&&!l.ok){a=!1;let f=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,i=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:f,description:i})}else if(t.success!==void 0){a=!1;let f=typeof t.success=="function"?await t.success(l):t.success,i=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:f,description:i})}}).catch(async l=>{if(t.error!==void 0){a=!1;let f=typeof t.error=="function"?await t.error(l):t.error,i=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:f,description:i})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),r},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||xz++;return this.create({jsx:e(r),id:r,...t}),r},this.subscribers=[],this.toasts=[]}},kl=new Mge,Cge=(e,t)=>{let r=(t==null?void 0:t.id)||xz++;return kl.addToast({title:e,...t,id:r}),r},Pge=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Ige=Cge,Oge=()=>kl.toasts,Lp=Object.assign(Ige,{success:kl.success,info:kl.info,warning:kl.warning,error:kl.error,custom:kl.custom,message:kl.message,promise:kl.promise,dismiss:kl.dismiss,loading:kl.loading},{getHistory:Oge});function kge(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}kge(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function XA(e){return e.label!==void 0}var Rge=3,Dge="32px",Lge=4e3,Nge=356,zge=14,jge=20,Fge=200;function Bge(...e){return e.filter(Boolean).join(" ")}var $ge=e=>{var t,r,n,a,l,f,i,_,b,E;let{invert:C,toast:R,unstyled:F,interacting:U,setHeights:$,visibleToasts:H,heights:q,index:G,toasts:J,expanded:te,removeToast:oe,defaultRichColors:he,closeButton:le,style:ve,cancelButtonStyle:We,actionButtonStyle:Ie,className:Re="",descriptionClassName:$e="",duration:ot,position:Je,gap:rt,loadingIcon:st,expandByDefault:at,classNames:Be,icons:ct,closeButtonAriaLabel:jt="Close toast",pauseWhenPageIsHidden:Lt,cn:$t}=e,[ut,tr]=ze.useState(!1),[mr,rr]=ze.useState(!1),[Ut,gr]=ze.useState(!1),[Gt,ge]=ze.useState(!1),[cr,Ot]=ze.useState(0),[Pr,_t]=ze.useState(0),hn=ze.useRef(null),qr=ze.useRef(null),Ln=G===0,Ge=G+1<=H,vt=R.type,kt=R.dismissible!==!1,dr=R.className||"",lr=R.descriptionClassName||"",sr=ze.useMemo(()=>q.findIndex(wr=>wr.toastId===R.id)||0,[q,R.id]),Kt=ze.useMemo(()=>{var wr;return(wr=R.closeButton)!=null?wr:le},[R.closeButton,le]),Zr=ze.useMemo(()=>R.duration||ot||Lge,[R.duration,ot]),fi=ze.useRef(0),Qn=ze.useRef(0),Pi=ze.useRef(0),qo=ze.useRef(null),[na,yl]=Je.split("-"),Ql=ze.useMemo(()=>q.reduce((wr,mi,ei)=>ei>=sr?wr:wr+mi.height,0),[q,sr]),ls=Age(),vl=R.invert||C,Co=vt==="loading";Qn.current=ze.useMemo(()=>sr*rt+Ql,[sr,Ql]),ze.useEffect(()=>{tr(!0)},[]),ze.useLayoutEffect(()=>{if(!ut)return;let wr=qr.current,mi=wr.style.height;wr.style.height="auto";let ei=wr.getBoundingClientRect().height;wr.style.height=mi,_t(ei),$(Li=>Li.find(Ho=>Ho.toastId===R.id)?Li.map(Ho=>Ho.toastId===R.id?{...Ho,height:ei}:Ho):[{toastId:R.id,height:ei,position:R.position},...Li])},[ut,R.title,R.description,$,R.id]);let Ia=ze.useCallback(()=>{rr(!0),Ot(Qn.current),$(wr=>wr.filter(mi=>mi.toastId!==R.id)),setTimeout(()=>{oe(R)},Fge)},[R,oe,$,Qn]);ze.useEffect(()=>{if(R.promise&&vt==="loading"||R.duration===1/0||R.type==="loading")return;let wr,mi=Zr;return te||U||Lt&&ls?(()=>{if(Pi.current<fi.current){let ei=new Date().getTime()-fi.current;mi=mi-ei}Pi.current=new Date().getTime()})():mi!==1/0&&(fi.current=new Date().getTime(),wr=setTimeout(()=>{var ei;(ei=R.onAutoClose)==null||ei.call(R,R),Ia()},mi)),()=>clearTimeout(wr)},[te,U,at,R,Zr,Ia,R.promise,vt,Lt,ls]),ze.useEffect(()=>{let wr=qr.current;if(wr){let mi=wr.getBoundingClientRect().height;return _t(mi),$(ei=>[{toastId:R.id,height:mi,position:R.position},...ei]),()=>$(ei=>ei.filter(Li=>Li.toastId!==R.id))}},[$,R.id]),ze.useEffect(()=>{R.delete&&Ia()},[Ia,R.delete]);function pi(){return ct!=null&&ct.loading?ze.createElement("div",{className:"sonner-loader","data-visible":vt==="loading"},ct.loading):st?ze.createElement("div",{className:"sonner-loader","data-visible":vt==="loading"},st):ze.createElement(bge,{visible:vt==="loading"})}return ze.createElement("li",{"aria-live":R.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:qr,className:$t(Re,dr,Be==null?void 0:Be.toast,(t=R==null?void 0:R.classNames)==null?void 0:t.toast,Be==null?void 0:Be.default,Be==null?void 0:Be[vt],(r=R==null?void 0:R.classNames)==null?void 0:r[vt]),"data-sonner-toast":"","data-rich-colors":(n=R.richColors)!=null?n:he,"data-styled":!(R.jsx||R.unstyled||F),"data-mounted":ut,"data-promise":!!R.promise,"data-removed":mr,"data-visible":Ge,"data-y-position":na,"data-x-position":yl,"data-index":G,"data-front":Ln,"data-swiping":Ut,"data-dismissible":kt,"data-type":vt,"data-invert":vl,"data-swipe-out":Gt,"data-expanded":!!(te||at&&ut),style:{"--index":G,"--toasts-before":G,"--z-index":J.length-G,"--offset":`${mr?cr:Qn.current}px`,"--initial-height":at?"auto":`${Pr}px`,...ve,...R.style},onPointerDown:wr=>{Co||!kt||(hn.current=new Date,Ot(Qn.current),wr.target.setPointerCapture(wr.pointerId),wr.target.tagName!=="BUTTON"&&(gr(!0),qo.current={x:wr.clientX,y:wr.clientY}))},onPointerUp:()=>{var wr,mi,ei,Li;if(Gt||!kt)return;qo.current=null;let Ho=Number(((wr=qr.current)==null?void 0:wr.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ec=new Date().getTime()-((mi=hn.current)==null?void 0:mi.getTime()),Fu=Math.abs(Ho)/ec;if(Math.abs(Ho)>=jge||Fu>.11){Ot(Qn.current),(ei=R.onDismiss)==null||ei.call(R,R),Ia(),ge(!0);return}(Li=qr.current)==null||Li.style.setProperty("--swipe-amount","0px"),gr(!1)},onPointerMove:wr=>{var mi;if(!qo.current||!kt)return;let ei=wr.clientY-qo.current.y,Li=wr.clientX-qo.current.x,Ho=(na==="top"?Math.min:Math.max)(0,ei),ec=wr.pointerType==="touch"?10:2;Math.abs(Ho)>ec?(mi=qr.current)==null||mi.style.setProperty("--swipe-amount",`${ei}px`):Math.abs(Li)>ec&&(qo.current=null)}},Kt&&!R.jsx?ze.createElement("button",{"aria-label":jt,"data-disabled":Co,"data-close-button":!0,onClick:Co||!kt?()=>{}:()=>{var wr;Ia(),(wr=R.onDismiss)==null||wr.call(R,R)},className:$t(Be==null?void 0:Be.closeButton,(a=R==null?void 0:R.classNames)==null?void 0:a.closeButton)},ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ze.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ze.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,R.jsx||ze.isValidElement(R.title)?R.jsx||R.title:ze.createElement(ze.Fragment,null,vt||R.icon||R.promise?ze.createElement("div",{"data-icon":"",className:$t(Be==null?void 0:Be.icon,(l=R==null?void 0:R.classNames)==null?void 0:l.icon)},R.promise||R.type==="loading"&&!R.icon?R.icon||pi():null,R.type!=="loading"?R.icon||(ct==null?void 0:ct[vt])||_ge(vt):null):null,ze.createElement("div",{"data-content":"",className:$t(Be==null?void 0:Be.content,(f=R==null?void 0:R.classNames)==null?void 0:f.content)},ze.createElement("div",{"data-title":"",className:$t(Be==null?void 0:Be.title,(i=R==null?void 0:R.classNames)==null?void 0:i.title)},R.title),R.description?ze.createElement("div",{"data-description":"",className:$t($e,lr,Be==null?void 0:Be.description,(_=R==null?void 0:R.classNames)==null?void 0:_.description)},R.description):null),ze.isValidElement(R.cancel)?R.cancel:R.cancel&&XA(R.cancel)?ze.createElement("button",{"data-button":!0,"data-cancel":!0,style:R.cancelButtonStyle||We,onClick:wr=>{var mi,ei;XA(R.cancel)&&kt&&((ei=(mi=R.cancel).onClick)==null||ei.call(mi,wr),Ia())},className:$t(Be==null?void 0:Be.cancelButton,(b=R==null?void 0:R.classNames)==null?void 0:b.cancelButton)},R.cancel.label):null,ze.isValidElement(R.action)?R.action:R.action&&XA(R.action)?ze.createElement("button",{"data-button":!0,"data-action":!0,style:R.actionButtonStyle||Ie,onClick:wr=>{var mi,ei;XA(R.action)&&(wr.defaultPrevented||((ei=(mi=R.action).onClick)==null||ei.call(mi,wr),Ia()))},className:$t(Be==null?void 0:Be.actionButton,(E=R==null?void 0:R.classNames)==null?void 0:E.actionButton)},R.action.label):null))};function RG(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var Uge=e=>{let{invert:t,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:a,closeButton:l,className:f,offset:i,theme:_="light",richColors:b,duration:E,style:C,visibleToasts:R=Rge,toastOptions:F,dir:U=RG(),gap:$=zge,loadingIcon:H,icons:q,containerAriaLabel:G="Notifications",pauseWhenPageIsHidden:J,cn:te=Bge}=e,[oe,he]=ze.useState([]),le=ze.useMemo(()=>Array.from(new Set([r].concat(oe.filter(Lt=>Lt.position).map(Lt=>Lt.position)))),[oe,r]),[ve,We]=ze.useState([]),[Ie,Re]=ze.useState(!1),[$e,ot]=ze.useState(!1),[Je,rt]=ze.useState(_!=="system"?_:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),st=ze.useRef(null),at=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),Be=ze.useRef(null),ct=ze.useRef(!1),jt=ze.useCallback(Lt=>{var $t;($t=oe.find(ut=>ut.id===Lt.id))!=null&&$t.delete||kl.dismiss(Lt.id),he(ut=>ut.filter(({id:tr})=>tr!==Lt.id))},[oe]);return ze.useEffect(()=>kl.subscribe(Lt=>{if(Lt.dismiss){he($t=>$t.map(ut=>ut.id===Lt.id?{...ut,delete:!0}:ut));return}setTimeout(()=>{rJ.flushSync(()=>{he($t=>{let ut=$t.findIndex(tr=>tr.id===Lt.id);return ut!==-1?[...$t.slice(0,ut),{...$t[ut],...Lt},...$t.slice(ut+1)]:[Lt,...$t]})})})}),[]),ze.useEffect(()=>{if(_!=="system"){rt(_);return}_==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?rt("dark"):rt("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:Lt})=>{rt(Lt?"dark":"light")})},[_]),ze.useEffect(()=>{oe.length<=1&&Re(!1)},[oe]),ze.useEffect(()=>{let Lt=$t=>{var ut,tr;n.every(mr=>$t[mr]||$t.code===mr)&&(Re(!0),(ut=st.current)==null||ut.focus()),$t.code==="Escape"&&(document.activeElement===st.current||(tr=st.current)!=null&&tr.contains(document.activeElement))&&Re(!1)};return document.addEventListener("keydown",Lt),()=>document.removeEventListener("keydown",Lt)},[n]),ze.useEffect(()=>{if(st.current)return()=>{Be.current&&(Be.current.focus({preventScroll:!0}),Be.current=null,ct.current=!1)}},[st.current]),oe.length?ze.createElement("section",{"aria-label":`${G} ${at}`,tabIndex:-1},le.map((Lt,$t)=>{var ut;let[tr,mr]=Lt.split("-");return ze.createElement("ol",{key:Lt,dir:U==="auto"?RG():U,tabIndex:-1,ref:st,className:f,"data-sonner-toaster":!0,"data-theme":Je,"data-y-position":tr,"data-x-position":mr,style:{"--front-toast-height":`${((ut=ve[0])==null?void 0:ut.height)||0}px`,"--offset":typeof i=="number"?`${i}px`:i||Dge,"--width":`${Nge}px`,"--gap":`${$}px`,...C},onBlur:rr=>{ct.current&&!rr.currentTarget.contains(rr.relatedTarget)&&(ct.current=!1,Be.current&&(Be.current.focus({preventScroll:!0}),Be.current=null))},onFocus:rr=>{rr.target instanceof HTMLElement&&rr.target.dataset.dismissible==="false"||ct.current||(ct.current=!0,Be.current=rr.relatedTarget)},onMouseEnter:()=>Re(!0),onMouseMove:()=>Re(!0),onMouseLeave:()=>{$e||Re(!1)},onPointerDown:rr=>{rr.target instanceof HTMLElement&&rr.target.dataset.dismissible==="false"||ot(!0)},onPointerUp:()=>ot(!1)},oe.filter(rr=>!rr.position&&$t===0||rr.position===Lt).map((rr,Ut)=>{var gr,Gt;return ze.createElement($ge,{key:rr.id,icons:q,index:Ut,toast:rr,defaultRichColors:b,duration:(gr=F==null?void 0:F.duration)!=null?gr:E,className:F==null?void 0:F.className,descriptionClassName:F==null?void 0:F.descriptionClassName,invert:t,visibleToasts:R,closeButton:(Gt=F==null?void 0:F.closeButton)!=null?Gt:l,interacting:$e,position:Lt,style:F==null?void 0:F.style,unstyled:F==null?void 0:F.unstyled,classNames:F==null?void 0:F.classNames,cancelButtonStyle:F==null?void 0:F.cancelButtonStyle,actionButtonStyle:F==null?void 0:F.actionButtonStyle,removeToast:jt,toasts:oe.filter(ge=>ge.position==rr.position),heights:ve.filter(ge=>ge.position==rr.position),setHeights:We,expandByDefault:a,gap:$,loadingIcon:H,expanded:Ie,pauseWhenPageIsHidden:J,cn:te})}))})):null};const Vge=({...e})=>{const{theme:t="system"}=vge();return j.jsx(Uge,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Wge=kO.useId||(()=>{}),Gge=0;function Ph(e){const[t,r]=ne.useState(Wge());return as(()=>{r(n=>n??String(Gge++))},[e]),t?`radix-${t}`:""}const qge=["top","right","bottom","left"],rm=Math.min,Nl=Math.max,XP=Math.round,YA=Math.floor,nm=e=>({x:e,y:e}),Hge={left:"right",right:"left",bottom:"top",top:"bottom"},Zge={start:"end",end:"start"};function bz(e,t,r){return Nl(e,rm(t,r))}function $h(e,t){return typeof e=="function"?e(t):e}function Uh(e){return e.split("-")[0]}function kx(e){return e.split("-")[1]}function kB(e){return e==="x"?"y":"x"}function RB(e){return e==="y"?"height":"width"}function im(e){return["top","bottom"].includes(Uh(e))?"y":"x"}function DB(e){return kB(im(e))}function Xge(e,t,r){r===void 0&&(r=!1);const n=kx(e),a=DB(e),l=RB(a);let f=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(f=YP(f)),[f,YP(f)]}function Yge(e){const t=YP(e);return[wz(e),t,wz(t)]}function wz(e){return e.replace(/start|end/g,t=>Zge[t])}function Kge(e,t,r){const n=["left","right"],a=["right","left"],l=["top","bottom"],f=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?l:f;default:return[]}}function Jge(e,t,r,n){const a=kx(e);let l=Kge(Uh(e),r==="start",n);return a&&(l=l.map(f=>f+"-"+a),t&&(l=l.concat(l.map(wz)))),l}function YP(e){return e.replace(/left|right|bottom|top/g,t=>Hge[t])}function Qge(e){return{top:0,right:0,bottom:0,left:0,...e}}function HJ(e){return typeof e!="number"?Qge(e):{top:e,right:e,bottom:e,left:e}}function KP(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function DG(e,t,r){let{reference:n,floating:a}=e;const l=im(t),f=DB(t),i=RB(f),_=Uh(t),b=l==="y",E=n.x+n.width/2-a.width/2,C=n.y+n.height/2-a.height/2,R=n[i]/2-a[i]/2;let F;switch(_){case"top":F={x:E,y:n.y-a.height};break;case"bottom":F={x:E,y:n.y+n.height};break;case"right":F={x:n.x+n.width,y:C};break;case"left":F={x:n.x-a.width,y:C};break;default:F={x:n.x,y:n.y}}switch(kx(t)){case"start":F[f]-=R*(r&&b?-1:1);break;case"end":F[f]+=R*(r&&b?-1:1);break}return F}const eye=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:f}=r,i=l.filter(Boolean),_=await(f.isRTL==null?void 0:f.isRTL(t));let b=await f.getElementRects({reference:e,floating:t,strategy:a}),{x:E,y:C}=DG(b,n,_),R=n,F={},U=0;for(let $=0;$<i.length;$++){const{name:H,fn:q}=i[$],{x:G,y:J,data:te,reset:oe}=await q({x:E,y:C,initialPlacement:n,placement:R,strategy:a,middlewareData:F,rects:b,platform:f,elements:{reference:e,floating:t}});E=G??E,C=J??C,F={...F,[H]:{...F[H],...te}},oe&&U<=50&&(U++,typeof oe=="object"&&(oe.placement&&(R=oe.placement),oe.rects&&(b=oe.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:a}):oe.rects),{x:E,y:C}=DG(b,R,_)),$=-1)}return{x:E,y:C,placement:R,strategy:a,middlewareData:F}};async function YS(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:f,elements:i,strategy:_}=e,{boundary:b="clippingAncestors",rootBoundary:E="viewport",elementContext:C="floating",altBoundary:R=!1,padding:F=0}=$h(t,e),U=HJ(F),H=i[R?C==="floating"?"reference":"floating":C],q=KP(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(H)))==null||r?H:H.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:b,rootBoundary:E,strategy:_})),G=C==="floating"?{x:n,y:a,width:f.floating.width,height:f.floating.height}:f.reference,J=await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),te=await(l.isElement==null?void 0:l.isElement(J))?await(l.getScale==null?void 0:l.getScale(J))||{x:1,y:1}:{x:1,y:1},oe=KP(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:G,offsetParent:J,strategy:_}):G);return{top:(q.top-oe.top+U.top)/te.y,bottom:(oe.bottom-q.bottom+U.bottom)/te.y,left:(q.left-oe.left+U.left)/te.x,right:(oe.right-q.right+U.right)/te.x}}const tye=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:l,platform:f,elements:i,middlewareData:_}=t,{element:b,padding:E=0}=$h(e,t)||{};if(b==null)return{};const C=HJ(E),R={x:r,y:n},F=DB(a),U=RB(F),$=await f.getDimensions(b),H=F==="y",q=H?"top":"left",G=H?"bottom":"right",J=H?"clientHeight":"clientWidth",te=l.reference[U]+l.reference[F]-R[F]-l.floating[U],oe=R[F]-l.reference[F],he=await(f.getOffsetParent==null?void 0:f.getOffsetParent(b));let le=he?he[J]:0;(!le||!await(f.isElement==null?void 0:f.isElement(he)))&&(le=i.floating[J]||l.floating[U]);const ve=te/2-oe/2,We=le/2-$[U]/2-1,Ie=rm(C[q],We),Re=rm(C[G],We),$e=Ie,ot=le-$[U]-Re,Je=le/2-$[U]/2+ve,rt=bz($e,Je,ot),st=!_.arrow&&kx(a)!=null&&Je!==rt&&l.reference[U]/2-(Je<$e?Ie:Re)-$[U]/2<0,at=st?Je<$e?Je-$e:Je-ot:0;return{[F]:R[F]+at,data:{[F]:rt,centerOffset:Je-rt-at,...st&&{alignmentOffset:at}},reset:st}}}),rye=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:l,rects:f,initialPlacement:i,platform:_,elements:b}=t,{mainAxis:E=!0,crossAxis:C=!0,fallbackPlacements:R,fallbackStrategy:F="bestFit",fallbackAxisSideDirection:U="none",flipAlignment:$=!0,...H}=$h(e,t);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const q=Uh(a),G=im(i),J=Uh(i)===i,te=await(_.isRTL==null?void 0:_.isRTL(b.floating)),oe=R||(J||!$?[YP(i)]:Yge(i)),he=U!=="none";!R&&he&&oe.push(...Jge(i,$,U,te));const le=[i,...oe],ve=await YS(t,H),We=[];let Ie=((n=l.flip)==null?void 0:n.overflows)||[];if(E&&We.push(ve[q]),C){const Je=Xge(a,f,te);We.push(ve[Je[0]],ve[Je[1]])}if(Ie=[...Ie,{placement:a,overflows:We}],!We.every(Je=>Je<=0)){var Re,$e;const Je=(((Re=l.flip)==null?void 0:Re.index)||0)+1,rt=le[Je];if(rt)return{data:{index:Je,overflows:Ie},reset:{placement:rt}};let st=($e=Ie.filter(at=>at.overflows[0]<=0).sort((at,Be)=>at.overflows[1]-Be.overflows[1])[0])==null?void 0:$e.placement;if(!st)switch(F){case"bestFit":{var ot;const at=(ot=Ie.filter(Be=>{if(he){const ct=im(Be.placement);return ct===G||ct==="y"}return!0}).map(Be=>[Be.placement,Be.overflows.filter(ct=>ct>0).reduce((ct,jt)=>ct+jt,0)]).sort((Be,ct)=>Be[1]-ct[1])[0])==null?void 0:ot[0];at&&(st=at);break}case"initialPlacement":st=i;break}if(a!==st)return{reset:{placement:st}}}return{}}}};function LG(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function NG(e){return qge.some(t=>e[t]>=0)}const nye=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=$h(e,t);switch(n){case"referenceHidden":{const l=await YS(t,{...a,elementContext:"reference"}),f=LG(l,r.reference);return{data:{referenceHiddenOffsets:f,referenceHidden:NG(f)}}}case"escaped":{const l=await YS(t,{...a,altBoundary:!0}),f=LG(l,r.floating);return{data:{escapedOffsets:f,escaped:NG(f)}}}default:return{}}}}};async function iye(e,t){const{placement:r,platform:n,elements:a}=e,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),f=Uh(r),i=kx(r),_=im(r)==="y",b=["left","top"].includes(f)?-1:1,E=l&&_?-1:1,C=$h(t,e);let{mainAxis:R,crossAxis:F,alignmentAxis:U}=typeof C=="number"?{mainAxis:C,crossAxis:0,alignmentAxis:null}:{mainAxis:C.mainAxis||0,crossAxis:C.crossAxis||0,alignmentAxis:C.alignmentAxis};return i&&typeof U=="number"&&(F=i==="end"?U*-1:U),_?{x:F*E,y:R*b}:{x:R*b,y:F*E}}const oye=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:l,placement:f,middlewareData:i}=t,_=await iye(t,e);return f===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+_.x,y:l+_.y,data:{..._,placement:f}}}}},aye=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:l=!0,crossAxis:f=!1,limiter:i={fn:H=>{let{x:q,y:G}=H;return{x:q,y:G}}},..._}=$h(e,t),b={x:r,y:n},E=await YS(t,_),C=im(Uh(a)),R=kB(C);let F=b[R],U=b[C];if(l){const H=R==="y"?"top":"left",q=R==="y"?"bottom":"right",G=F+E[H],J=F-E[q];F=bz(G,F,J)}if(f){const H=C==="y"?"top":"left",q=C==="y"?"bottom":"right",G=U+E[H],J=U-E[q];U=bz(G,U,J)}const $=i.fn({...t,[R]:F,[C]:U});return{...$,data:{x:$.x-r,y:$.y-n,enabled:{[R]:l,[C]:f}}}}}},sye=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:l,middlewareData:f}=t,{offset:i=0,mainAxis:_=!0,crossAxis:b=!0}=$h(e,t),E={x:r,y:n},C=im(a),R=kB(C);let F=E[R],U=E[C];const $=$h(i,t),H=typeof $=="number"?{mainAxis:$,crossAxis:0}:{mainAxis:0,crossAxis:0,...$};if(_){const J=R==="y"?"height":"width",te=l.reference[R]-l.floating[J]+H.mainAxis,oe=l.reference[R]+l.reference[J]-H.mainAxis;F<te?F=te:F>oe&&(F=oe)}if(b){var q,G;const J=R==="y"?"width":"height",te=["top","left"].includes(Uh(a)),oe=l.reference[C]-l.floating[J]+(te&&((q=f.offset)==null?void 0:q[C])||0)+(te?0:H.crossAxis),he=l.reference[C]+l.reference[J]+(te?0:((G=f.offset)==null?void 0:G[C])||0)-(te?H.crossAxis:0);U<oe?U=oe:U>he&&(U=he)}return{[R]:F,[C]:U}}}},lye=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:l,platform:f,elements:i}=t,{apply:_=()=>{},...b}=$h(e,t),E=await YS(t,b),C=Uh(a),R=kx(a),F=im(a)==="y",{width:U,height:$}=l.floating;let H,q;C==="top"||C==="bottom"?(H=C,q=R===(await(f.isRTL==null?void 0:f.isRTL(i.floating))?"start":"end")?"left":"right"):(q=C,H=R==="end"?"top":"bottom");const G=$-E.top-E.bottom,J=U-E.left-E.right,te=rm($-E[H],G),oe=rm(U-E[q],J),he=!t.middlewareData.shift;let le=te,ve=oe;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ve=J),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(le=G),he&&!R){const Ie=Nl(E.left,0),Re=Nl(E.right,0),$e=Nl(E.top,0),ot=Nl(E.bottom,0);F?ve=U-2*(Ie!==0||Re!==0?Ie+Re:Nl(E.left,E.right)):le=$-2*($e!==0||ot!==0?$e+ot:Nl(E.top,E.bottom))}await _({...t,availableWidth:ve,availableHeight:le});const We=await f.getDimensions(i.floating);return U!==We.width||$!==We.height?{reset:{rects:!0}}:{}}}};function KO(){return typeof window<"u"}function Rx(e){return ZJ(e)?(e.nodeName||"").toLowerCase():"#document"}function Vl(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Bd(e){var t;return(t=(ZJ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function ZJ(e){return KO()?e instanceof Node||e instanceof Vl(e).Node:!1}function Pu(e){return KO()?e instanceof Element||e instanceof Vl(e).Element:!1}function Od(e){return KO()?e instanceof HTMLElement||e instanceof Vl(e).HTMLElement:!1}function zG(e){return!KO()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Vl(e).ShadowRoot}function pE(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Iu(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function cye(e){return["table","td","th"].includes(Rx(e))}function JO(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function LB(e){const t=NB(),r=Pu(e)?Iu(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function uye(e){let t=om(e);for(;Od(t)&&!B0(t);){if(LB(t))return t;if(JO(t))return null;t=om(t)}return null}function NB(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function B0(e){return["html","body","#document"].includes(Rx(e))}function Iu(e){return Vl(e).getComputedStyle(e)}function QO(e){return Pu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function om(e){if(Rx(e)==="html")return e;const t=e.assignedSlot||e.parentNode||zG(e)&&e.host||Bd(e);return zG(t)?t.host:t}function XJ(e){const t=om(e);return B0(t)?e.ownerDocument?e.ownerDocument.body:e.body:Od(t)&&pE(t)?t:XJ(t)}function KS(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=XJ(e),l=a===((n=e.ownerDocument)==null?void 0:n.body),f=Vl(a);if(l){const i=Sz(f);return t.concat(f,f.visualViewport||[],pE(a)?a:[],i&&r?KS(i):[])}return t.concat(a,KS(a,[],r))}function Sz(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function YJ(e){const t=Iu(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Od(e),l=a?e.offsetWidth:r,f=a?e.offsetHeight:n,i=XP(r)!==l||XP(n)!==f;return i&&(r=l,n=f),{width:r,height:n,$:i}}function zB(e){return Pu(e)?e:e.contextElement}function u0(e){const t=zB(e);if(!Od(t))return nm(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:l}=YJ(t);let f=(l?XP(r.width):r.width)/n,i=(l?XP(r.height):r.height)/a;return(!f||!Number.isFinite(f))&&(f=1),(!i||!Number.isFinite(i))&&(i=1),{x:f,y:i}}const dye=nm(0);function KJ(e){const t=Vl(e);return!NB()||!t.visualViewport?dye:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function hye(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Vl(e)?!1:t}function vy(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),l=zB(e);let f=nm(1);t&&(n?Pu(n)&&(f=u0(n)):f=u0(e));const i=hye(l,r,n)?KJ(l):nm(0);let _=(a.left+i.x)/f.x,b=(a.top+i.y)/f.y,E=a.width/f.x,C=a.height/f.y;if(l){const R=Vl(l),F=n&&Pu(n)?Vl(n):n;let U=R,$=Sz(U);for(;$&&n&&F!==U;){const H=u0($),q=$.getBoundingClientRect(),G=Iu($),J=q.left+($.clientLeft+parseFloat(G.paddingLeft))*H.x,te=q.top+($.clientTop+parseFloat(G.paddingTop))*H.y;_*=H.x,b*=H.y,E*=H.x,C*=H.y,_+=J,b+=te,U=Vl($),$=Sz(U)}}return KP({width:E,height:C,x:_,y:b})}function fye(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const l=a==="fixed",f=Bd(n),i=t?JO(t.floating):!1;if(n===f||i&&l)return r;let _={scrollLeft:0,scrollTop:0},b=nm(1);const E=nm(0),C=Od(n);if((C||!C&&!l)&&((Rx(n)!=="body"||pE(f))&&(_=QO(n)),Od(n))){const R=vy(n);b=u0(n),E.x=R.x+n.clientLeft,E.y=R.y+n.clientTop}return{width:r.width*b.x,height:r.height*b.y,x:r.x*b.x-_.scrollLeft*b.x+E.x,y:r.y*b.y-_.scrollTop*b.y+E.y}}function pye(e){return Array.from(e.getClientRects())}function Tz(e,t){const r=QO(e).scrollLeft;return t?t.left+r:vy(Bd(e)).left+r}function mye(e){const t=Bd(e),r=QO(e),n=e.ownerDocument.body,a=Nl(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),l=Nl(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let f=-r.scrollLeft+Tz(e);const i=-r.scrollTop;return Iu(n).direction==="rtl"&&(f+=Nl(t.clientWidth,n.clientWidth)-a),{width:a,height:l,x:f,y:i}}function gye(e,t){const r=Vl(e),n=Bd(e),a=r.visualViewport;let l=n.clientWidth,f=n.clientHeight,i=0,_=0;if(a){l=a.width,f=a.height;const b=NB();(!b||b&&t==="fixed")&&(i=a.offsetLeft,_=a.offsetTop)}return{width:l,height:f,x:i,y:_}}function yye(e,t){const r=vy(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,l=Od(e)?u0(e):nm(1),f=e.clientWidth*l.x,i=e.clientHeight*l.y,_=a*l.x,b=n*l.y;return{width:f,height:i,x:_,y:b}}function jG(e,t,r){let n;if(t==="viewport")n=gye(e,r);else if(t==="document")n=mye(Bd(e));else if(Pu(t))n=yye(t,r);else{const a=KJ(e);n={...t,x:t.x-a.x,y:t.y-a.y}}return KP(n)}function JJ(e,t){const r=om(e);return r===t||!Pu(r)||B0(r)?!1:Iu(r).position==="fixed"||JJ(r,t)}function vye(e,t){const r=t.get(e);if(r)return r;let n=KS(e,[],!1).filter(i=>Pu(i)&&Rx(i)!=="body"),a=null;const l=Iu(e).position==="fixed";let f=l?om(e):e;for(;Pu(f)&&!B0(f);){const i=Iu(f),_=LB(f);!_&&i.position==="fixed"&&(a=null),(l?!_&&!a:!_&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||pE(f)&&!_&&JJ(e,f))?n=n.filter(E=>E!==f):a=i,f=om(f)}return t.set(e,n),n}function _ye(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const f=[...r==="clippingAncestors"?JO(t)?[]:vye(t,this._c):[].concat(r),n],i=f[0],_=f.reduce((b,E)=>{const C=jG(t,E,a);return b.top=Nl(C.top,b.top),b.right=rm(C.right,b.right),b.bottom=rm(C.bottom,b.bottom),b.left=Nl(C.left,b.left),b},jG(t,i,a));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function xye(e){const{width:t,height:r}=YJ(e);return{width:t,height:r}}function bye(e,t,r){const n=Od(t),a=Bd(t),l=r==="fixed",f=vy(e,!0,l,t);let i={scrollLeft:0,scrollTop:0};const _=nm(0);if(n||!n&&!l)if((Rx(t)!=="body"||pE(a))&&(i=QO(t)),n){const F=vy(t,!0,l,t);_.x=F.x+t.clientLeft,_.y=F.y+t.clientTop}else a&&(_.x=Tz(a));let b=0,E=0;if(a&&!n&&!l){const F=a.getBoundingClientRect();E=F.top+i.scrollTop,b=F.left+i.scrollLeft-Tz(a,F)}const C=f.left+i.scrollLeft-_.x-b,R=f.top+i.scrollTop-_.y-E;return{x:C,y:R,width:f.width,height:f.height}}function l3(e){return Iu(e).position==="static"}function FG(e,t){if(!Od(e)||Iu(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Bd(e)===r&&(r=r.ownerDocument.body),r}function QJ(e,t){const r=Vl(e);if(JO(e))return r;if(!Od(e)){let a=om(e);for(;a&&!B0(a);){if(Pu(a)&&!l3(a))return a;a=om(a)}return r}let n=FG(e,t);for(;n&&cye(n)&&l3(n);)n=FG(n,t);return n&&B0(n)&&l3(n)&&!LB(n)?r:n||uye(e)||r}const wye=async function(e){const t=this.getOffsetParent||QJ,r=this.getDimensions,n=await r(e.floating);return{reference:bye(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Sye(e){return Iu(e).direction==="rtl"}const Tye={convertOffsetParentRelativeRectToViewportRelativeRect:fye,getDocumentElement:Bd,getClippingRect:_ye,getOffsetParent:QJ,getElementRects:wye,getClientRects:pye,getDimensions:xye,getScale:u0,isElement:Pu,isRTL:Sye};function Eye(e,t){let r=null,n;const a=Bd(e);function l(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function f(i,_){i===void 0&&(i=!1),_===void 0&&(_=1),l();const{left:b,top:E,width:C,height:R}=e.getBoundingClientRect();if(i||t(),!C||!R)return;const F=YA(E),U=YA(a.clientWidth-(b+C)),$=YA(a.clientHeight-(E+R)),H=YA(b),G={rootMargin:-F+"px "+-U+"px "+-$+"px "+-H+"px",threshold:Nl(0,rm(1,_))||1};let J=!0;function te(oe){const he=oe[0].intersectionRatio;if(he!==_){if(!J)return f();he?f(!1,he):n=setTimeout(()=>{f(!1,1e-7)},1e3)}J=!1}try{r=new IntersectionObserver(te,{...G,root:a.ownerDocument})}catch{r=new IntersectionObserver(te,G)}r.observe(e)}return f(!0),l}function Aye(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:_=!1}=n,b=zB(e),E=a||l?[...b?KS(b):[],...KS(t)]:[];E.forEach(q=>{a&&q.addEventListener("scroll",r,{passive:!0}),l&&q.addEventListener("resize",r)});const C=b&&i?Eye(b,r):null;let R=-1,F=null;f&&(F=new ResizeObserver(q=>{let[G]=q;G&&G.target===b&&F&&(F.unobserve(t),cancelAnimationFrame(R),R=requestAnimationFrame(()=>{var J;(J=F)==null||J.observe(t)})),r()}),b&&!_&&F.observe(b),F.observe(t));let U,$=_?vy(e):null;_&&H();function H(){const q=vy(e);$&&(q.x!==$.x||q.y!==$.y||q.width!==$.width||q.height!==$.height)&&r(),$=q,U=requestAnimationFrame(H)}return r(),()=>{var q;E.forEach(G=>{a&&G.removeEventListener("scroll",r),l&&G.removeEventListener("resize",r)}),C==null||C(),(q=F)==null||q.disconnect(),F=null,_&&cancelAnimationFrame(U)}}const Mye=oye,Cye=aye,Pye=rye,Iye=lye,Oye=nye,BG=tye,kye=sye,Rye=(e,t,r)=>{const n=new Map,a={platform:Tye,...r},l={...a.platform,_c:n};return eye(e,t,{...a,platform:l})};var VM=typeof document<"u"?ne.useLayoutEffect:ne.useEffect;function JP(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!JP(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const l=a[n];if(!(l==="_owner"&&e.$$typeof)&&!JP(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function eQ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function $G(e,t){const r=eQ(e);return Math.round(t*r)/r}function c3(e){const t=ne.useRef(e);return VM(()=>{t.current=e}),t}function Dye(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:f}={},transform:i=!0,whileElementsMounted:_,open:b}=e,[E,C]=ne.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[R,F]=ne.useState(n);JP(R,n)||F(n);const[U,$]=ne.useState(null),[H,q]=ne.useState(null),G=ne.useCallback(Be=>{Be!==he.current&&(he.current=Be,$(Be))},[]),J=ne.useCallback(Be=>{Be!==le.current&&(le.current=Be,q(Be))},[]),te=l||U,oe=f||H,he=ne.useRef(null),le=ne.useRef(null),ve=ne.useRef(E),We=_!=null,Ie=c3(_),Re=c3(a),$e=c3(b),ot=ne.useCallback(()=>{if(!he.current||!le.current)return;const Be={placement:t,strategy:r,middleware:R};Re.current&&(Be.platform=Re.current),Rye(he.current,le.current,Be).then(ct=>{const jt={...ct,isPositioned:$e.current!==!1};Je.current&&!JP(ve.current,jt)&&(ve.current=jt,Dy.flushSync(()=>{C(jt)}))})},[R,t,r,Re,$e]);VM(()=>{b===!1&&ve.current.isPositioned&&(ve.current.isPositioned=!1,C(Be=>({...Be,isPositioned:!1})))},[b]);const Je=ne.useRef(!1);VM(()=>(Je.current=!0,()=>{Je.current=!1}),[]),VM(()=>{if(te&&(he.current=te),oe&&(le.current=oe),te&&oe){if(Ie.current)return Ie.current(te,oe,ot);ot()}},[te,oe,ot,Ie,We]);const rt=ne.useMemo(()=>({reference:he,floating:le,setReference:G,setFloating:J}),[G,J]),st=ne.useMemo(()=>({reference:te,floating:oe}),[te,oe]),at=ne.useMemo(()=>{const Be={position:r,left:0,top:0};if(!st.floating)return Be;const ct=$G(st.floating,E.x),jt=$G(st.floating,E.y);return i?{...Be,transform:"translate("+ct+"px, "+jt+"px)",...eQ(st.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ct,top:jt}},[r,i,st.floating,E.x,E.y]);return ne.useMemo(()=>({...E,update:ot,refs:rt,elements:st,floatingStyles:at}),[E,ot,rt,st,at])}const Lye=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?BG({element:n.current,padding:a}).fn(r):{}:n?BG({element:n,padding:a}).fn(r):{}}}},Nye=(e,t)=>({...Mye(e),options:[e,t]}),zye=(e,t)=>({...Cye(e),options:[e,t]}),jye=(e,t)=>({...kye(e),options:[e,t]}),Fye=(e,t)=>({...Pye(e),options:[e,t]}),Bye=(e,t)=>({...Iye(e),options:[e,t]}),$ye=(e,t)=>({...Oye(e),options:[e,t]}),Uye=(e,t)=>({...Lye(e),options:[e,t]});var Vye="Arrow",tQ=ne.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...l}=e;return j.jsx(In.svg,{...l,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:j.jsx("polygon",{points:"0,0 30,0 15,10"})})});tQ.displayName=Vye;var Wye=tQ;function Gye(e,t=[]){let r=[];function n(l,f){const i=ne.createContext(f),_=r.length;r=[...r,f];function b(C){const{scope:R,children:F,...U}=C,$=(R==null?void 0:R[e][_])||i,H=ne.useMemo(()=>U,Object.values(U));return j.jsx($.Provider,{value:H,children:F})}function E(C,R){const F=(R==null?void 0:R[e][_])||i,U=ne.useContext(F);if(U)return U;if(f!==void 0)return f;throw new Error(`\`${C}\` must be used within \`${l}\``)}return b.displayName=l+"Provider",[b,E]}const a=()=>{const l=r.map(f=>ne.createContext(f));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,qye(a,...t)]}function qye(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const f=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}function rQ(e){const[t,r]=ne.useState(void 0);return as(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let f,i;if("borderBoxSize"in l){const _=l.borderBoxSize,b=Array.isArray(_)?_[0]:_;f=b.inlineSize,i=b.blockSize}else f=e.offsetWidth,i=e.offsetHeight;r({width:f,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var jB="Popper",[nQ,Dx]=Gye(jB),[Hye,iQ]=nQ(jB),oQ=e=>{const{__scopePopper:t,children:r}=e,[n,a]=ne.useState(null);return j.jsx(Hye,{scope:t,anchor:n,onAnchorChange:a,children:r})};oQ.displayName=jB;var aQ="PopperAnchor",sQ=ne.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,l=iQ(aQ,r),f=ne.useRef(null),i=Ci(t,f);return ne.useEffect(()=>{l.onAnchorChange((n==null?void 0:n.current)||f.current)}),n?null:j.jsx(In.div,{...a,ref:i})});sQ.displayName=aQ;var FB="PopperContent",[Zye,Xye]=nQ(FB),lQ=ne.forwardRef((e,t)=>{var Ut,gr,Gt,ge,cr,Ot;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:f=0,arrowPadding:i=0,avoidCollisions:_=!0,collisionBoundary:b=[],collisionPadding:E=0,sticky:C="partial",hideWhenDetached:R=!1,updatePositionStrategy:F="optimized",onPlaced:U,...$}=e,H=iQ(FB,r),[q,G]=ne.useState(null),J=Ci(t,Pr=>G(Pr)),[te,oe]=ne.useState(null),he=rQ(te),le=(he==null?void 0:he.width)??0,ve=(he==null?void 0:he.height)??0,We=n+(l!=="center"?"-"+l:""),Ie=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},Re=Array.isArray(b)?b:[b],$e=Re.length>0,ot={padding:Ie,boundary:Re.filter(Kye),altBoundary:$e},{refs:Je,floatingStyles:rt,placement:st,isPositioned:at,middlewareData:Be}=Dye({strategy:"fixed",placement:We,whileElementsMounted:(...Pr)=>Aye(...Pr,{animationFrame:F==="always"}),elements:{reference:H.anchor},middleware:[Nye({mainAxis:a+ve,alignmentAxis:f}),_&&zye({mainAxis:!0,crossAxis:!1,limiter:C==="partial"?jye():void 0,...ot}),_&&Fye({...ot}),Bye({...ot,apply:({elements:Pr,rects:_t,availableWidth:hn,availableHeight:qr})=>{const{width:Ln,height:Ge}=_t.reference,vt=Pr.floating.style;vt.setProperty("--radix-popper-available-width",`${hn}px`),vt.setProperty("--radix-popper-available-height",`${qr}px`),vt.setProperty("--radix-popper-anchor-width",`${Ln}px`),vt.setProperty("--radix-popper-anchor-height",`${Ge}px`)}}),te&&Uye({element:te,padding:i}),Jye({arrowWidth:le,arrowHeight:ve}),R&&$ye({strategy:"referenceHidden",...ot})]}),[ct,jt]=dQ(st),Lt=pl(U);as(()=>{at&&(Lt==null||Lt())},[at,Lt]);const $t=(Ut=Be.arrow)==null?void 0:Ut.x,ut=(gr=Be.arrow)==null?void 0:gr.y,tr=((Gt=Be.arrow)==null?void 0:Gt.centerOffset)!==0,[mr,rr]=ne.useState();return as(()=>{q&&rr(window.getComputedStyle(q).zIndex)},[q]),j.jsx("div",{ref:Je.setFloating,"data-radix-popper-content-wrapper":"",style:{...rt,transform:at?rt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:mr,"--radix-popper-transform-origin":[(ge=Be.transformOrigin)==null?void 0:ge.x,(cr=Be.transformOrigin)==null?void 0:cr.y].join(" "),...((Ot=Be.hide)==null?void 0:Ot.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:j.jsx(Zye,{scope:r,placedSide:ct,onArrowChange:oe,arrowX:$t,arrowY:ut,shouldHideArrow:tr,children:j.jsx(In.div,{"data-side":ct,"data-align":jt,...$,ref:J,style:{...$.style,animation:at?void 0:"none"}})})})});lQ.displayName=FB;var cQ="PopperArrow",Yye={top:"bottom",right:"left",bottom:"top",left:"right"},uQ=ne.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,l=Xye(cQ,n),f=Yye[l.placedSide];return j.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:j.jsx(Wye,{...a,ref:r,style:{...a.style,display:"block"}})})});uQ.displayName=cQ;function Kye(e){return e!==null}var Jye=e=>({name:"transformOrigin",options:e,fn(t){var H,q,G;const{placement:r,rects:n,middlewareData:a}=t,f=((H=a.arrow)==null?void 0:H.centerOffset)!==0,i=f?0:e.arrowWidth,_=f?0:e.arrowHeight,[b,E]=dQ(r),C={start:"0%",center:"50%",end:"100%"}[E],R=(((q=a.arrow)==null?void 0:q.x)??0)+i/2,F=(((G=a.arrow)==null?void 0:G.y)??0)+_/2;let U="",$="";return b==="bottom"?(U=f?C:`${R}px`,$=`${-_}px`):b==="top"?(U=f?C:`${R}px`,$=`${n.floating.height+_}px`):b==="right"?(U=`${-_}px`,$=f?C:`${F}px`):b==="left"&&(U=`${n.floating.width+_}px`,$=f?C:`${F}px`),{data:{x:U,y:$}}}});function dQ(e){const[t,r="center"]=e.split("-");return[t,r]}var hQ=oQ,ek=sQ,BB=lQ,$B=uQ,[tk,_Ke]=gm("Tooltip",[Dx]),UB=Dx(),fQ="TooltipProvider",Qye=700,UG="tooltip.open",[eve,pQ]=tk(fQ),mQ=e=>{const{__scopeTooltip:t,delayDuration:r=Qye,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:l}=e,[f,i]=ne.useState(!0),_=ne.useRef(!1),b=ne.useRef(0);return ne.useEffect(()=>{const E=b.current;return()=>window.clearTimeout(E)},[]),j.jsx(eve,{scope:t,isOpenDelayed:f,delayDuration:r,onOpen:ne.useCallback(()=>{window.clearTimeout(b.current),i(!1)},[]),onClose:ne.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>i(!0),n)},[n]),isPointerInTransitRef:_,onPointerInTransitChange:ne.useCallback(E=>{_.current=E},[]),disableHoverableContent:a,children:l})};mQ.displayName=fQ;var gQ="Tooltip",[xKe,rk]=tk(gQ),Ez="TooltipTrigger",tve=ne.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=rk(Ez,r),l=pQ(Ez,r),f=UB(r),i=ne.useRef(null),_=Ci(t,i,a.onTriggerChange),b=ne.useRef(!1),E=ne.useRef(!1),C=ne.useCallback(()=>b.current=!1,[]);return ne.useEffect(()=>()=>document.removeEventListener("pointerup",C),[C]),j.jsx(ek,{asChild:!0,...f,children:j.jsx(In.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:_,onPointerMove:Kr(e.onPointerMove,R=>{R.pointerType!=="touch"&&!E.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),E.current=!0)}),onPointerLeave:Kr(e.onPointerLeave,()=>{a.onTriggerLeave(),E.current=!1}),onPointerDown:Kr(e.onPointerDown,()=>{b.current=!0,document.addEventListener("pointerup",C,{once:!0})}),onFocus:Kr(e.onFocus,()=>{b.current||a.onOpen()}),onBlur:Kr(e.onBlur,a.onClose),onClick:Kr(e.onClick,a.onClose)})})});tve.displayName=Ez;var rve="TooltipPortal",[bKe,nve]=tk(rve,{forceMount:void 0}),$0="TooltipContent",yQ=ne.forwardRef((e,t)=>{const r=nve($0,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...l}=e,f=rk($0,e.__scopeTooltip);return j.jsx(Fd,{present:n||f.open,children:f.disableHoverableContent?j.jsx(vQ,{side:a,...l,ref:t}):j.jsx(ive,{side:a,...l,ref:t})})}),ive=ne.forwardRef((e,t)=>{const r=rk($0,e.__scopeTooltip),n=pQ($0,e.__scopeTooltip),a=ne.useRef(null),l=Ci(t,a),[f,i]=ne.useState(null),{trigger:_,onClose:b}=r,E=a.current,{onPointerInTransitChange:C}=n,R=ne.useCallback(()=>{i(null),C(!1)},[C]),F=ne.useCallback((U,$)=>{const H=U.currentTarget,q={x:U.clientX,y:U.clientY},G=lve(q,H.getBoundingClientRect()),J=cve(q,G),te=uve($.getBoundingClientRect()),oe=hve([...J,...te]);i(oe),C(!0)},[C]);return ne.useEffect(()=>()=>R(),[R]),ne.useEffect(()=>{if(_&&E){const U=H=>F(H,E),$=H=>F(H,_);return _.addEventListener("pointerleave",U),E.addEventListener("pointerleave",$),()=>{_.removeEventListener("pointerleave",U),E.removeEventListener("pointerleave",$)}}},[_,E,F,R]),ne.useEffect(()=>{if(f){const U=$=>{const H=$.target,q={x:$.clientX,y:$.clientY},G=(_==null?void 0:_.contains(H))||(E==null?void 0:E.contains(H)),J=!dve(q,f);G?R():J&&(R(),b())};return document.addEventListener("pointermove",U),()=>document.removeEventListener("pointermove",U)}},[_,E,f,b,R]),j.jsx(vQ,{...e,ref:l})}),[ove,ave]=tk(gQ,{isInside:!1}),vQ=ne.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:f,...i}=e,_=rk($0,r),b=UB(r),{onClose:E}=_;return ne.useEffect(()=>(document.addEventListener(UG,E),()=>document.removeEventListener(UG,E)),[E]),ne.useEffect(()=>{if(_.trigger){const C=R=>{const F=R.target;F!=null&&F.contains(_.trigger)&&E()};return window.addEventListener("scroll",C,{capture:!0}),()=>window.removeEventListener("scroll",C,{capture:!0})}},[_.trigger,E]),j.jsx(Ix,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:f,onFocusOutside:C=>C.preventDefault(),onDismiss:E,children:j.jsxs(BB,{"data-state":_.stateAttribute,...b,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[j.jsx(oJ,{children:n}),j.jsx(ove,{scope:r,isInside:!0,children:j.jsx(qpe,{id:_.contentId,role:"tooltip",children:a||n})})]})})});yQ.displayName=$0;var _Q="TooltipArrow",sve=ne.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=UB(r);return ave(_Q,r).isInside?null:j.jsx($B,{...a,...n,ref:t})});sve.displayName=_Q;function lve(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(r,n,a,l)){case l:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function cve(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function uve(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function dve(e,t){const{x:r,y:n}=e;let a=!1;for(let l=0,f=t.length-1;l<t.length;f=l++){const i=t[l].x,_=t[l].y,b=t[f].x,E=t[f].y;_>n!=E>n&&r<(b-i)*(n-_)/(E-_)+i&&(a=!a)}return a}function hve(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),fve(t)}function fve(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const l=t[t.length-1],f=t[t.length-2];if((l.x-f.x)*(a.y-f.y)>=(l.y-f.y)*(a.x-f.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const l=r[r.length-1],f=r[r.length-2];if((l.x-f.x)*(a.y-f.y)>=(l.y-f.y)*(a.x-f.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var pve=mQ,xQ=yQ;const mve=pve,gve=ne.forwardRef(({className:e,sideOffset:t=4,...r},n)=>j.jsx(xQ,{ref:n,sideOffset:t,className:Nr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));gve.displayName=xQ.displayName;var mE=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},_y=typeof window>"u"||"Deno"in globalThis;function mc(){}function yve(e,t){return typeof e=="function"?e(t):e}function Az(e){return typeof e=="number"&&e>=0&&e!==1/0}function bQ(e,t){return Math.max(e+(t||0)-Date.now(),0)}function d0(e,t){return typeof e=="function"?e(t):e}function gu(e,t){return typeof e=="function"?e(t):e}function VG(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:l,queryKey:f,stale:i}=e;if(f){if(n){if(t.queryHash!==VB(f,t.options))return!1}else if(!QS(t.queryKey,f))return!1}if(r!=="all"){const _=t.isActive();if(r==="active"&&!_||r==="inactive"&&_)return!1}return!(typeof i=="boolean"&&t.isStale()!==i||a&&a!==t.state.fetchStatus||l&&!l(t))}function WG(e,t){const{exact:r,status:n,predicate:a,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(JS(t.options.mutationKey)!==JS(l))return!1}else if(!QS(t.options.mutationKey,l))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function VB(e,t){return((t==null?void 0:t.queryKeyHashFn)||JS)(e)}function JS(e){return JSON.stringify(e,(t,r)=>Cz(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function QS(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!QS(e[r],t[r])):!1}function wQ(e,t){if(e===t)return e;const r=GG(e)&&GG(t);if(r||Cz(e)&&Cz(t)){const n=r?e:Object.keys(e),a=n.length,l=r?t:Object.keys(t),f=l.length,i=r?[]:{};let _=0;for(let b=0;b<f;b++){const E=r?b:l[b];(!r&&n.includes(E)||r)&&e[E]===void 0&&t[E]===void 0?(i[E]=void 0,_++):(i[E]=wQ(e[E],t[E]),i[E]===e[E]&&e[E]!==void 0&&_++)}return a===f&&_===a?e:i}return t}function Mz(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function GG(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Cz(e){if(!qG(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!qG(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qG(e){return Object.prototype.toString.call(e)==="[object Object]"}function vve(e){return new Promise(t=>{setTimeout(t,e)})}function Pz(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?wQ(e,t):t}function _ve(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function xve(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var WB=Symbol();function SQ(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===WB?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Xg,Ap,x0,LX,bve=(LX=class extends mE{constructor(){super();Sn(this,Xg);Sn(this,Ap);Sn(this,x0);Wr(this,x0,t=>{if(!_y&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){St(this,Ap)||this.setEventListener(St(this,x0))}onUnsubscribe(){var t;this.hasListeners()||((t=St(this,Ap))==null||t.call(this),Wr(this,Ap,void 0))}setEventListener(t){var r;Wr(this,x0,t),(r=St(this,Ap))==null||r.call(this),Wr(this,Ap,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){St(this,Xg)!==t&&(Wr(this,Xg,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof St(this,Xg)=="boolean"?St(this,Xg):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Xg=new WeakMap,Ap=new WeakMap,x0=new WeakMap,LX),GB=new bve,b0,Mp,w0,NX,wve=(NX=class extends mE{constructor(){super();Sn(this,b0,!0);Sn(this,Mp);Sn(this,w0);Wr(this,w0,t=>{if(!_y&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){St(this,Mp)||this.setEventListener(St(this,w0))}onUnsubscribe(){var t;this.hasListeners()||((t=St(this,Mp))==null||t.call(this),Wr(this,Mp,void 0))}setEventListener(t){var r;Wr(this,w0,t),(r=St(this,Mp))==null||r.call(this),Wr(this,Mp,t(this.setOnline.bind(this)))}setOnline(t){St(this,b0)!==t&&(Wr(this,b0,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return St(this,b0)}},b0=new WeakMap,Mp=new WeakMap,w0=new WeakMap,NX),QP=new wve;function Iz(){let e,t;const r=new Promise((a,l)=>{e=a,t=l});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function Sve(e){return Math.min(1e3*2**e,3e4)}function TQ(e){return(e??"online")==="online"?QP.isOnline():!0}var EQ=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function u3(e){return e instanceof EQ}function AQ(e){let t=!1,r=0,n=!1,a;const l=Iz(),f=$=>{var H;n||(R(new EQ($)),(H=e.abort)==null||H.call(e))},i=()=>{t=!0},_=()=>{t=!1},b=()=>GB.isFocused()&&(e.networkMode==="always"||QP.isOnline())&&e.canRun(),E=()=>TQ(e.networkMode)&&e.canRun(),C=$=>{var H;n||(n=!0,(H=e.onSuccess)==null||H.call(e,$),a==null||a(),l.resolve($))},R=$=>{var H;n||(n=!0,(H=e.onError)==null||H.call(e,$),a==null||a(),l.reject($))},F=()=>new Promise($=>{var H;a=q=>{(n||b())&&$(q)},(H=e.onPause)==null||H.call(e)}).then(()=>{var $;a=void 0,n||($=e.onContinue)==null||$.call(e)}),U=()=>{if(n)return;let $;const H=r===0?e.initialPromise:void 0;try{$=H??e.fn()}catch(q){$=Promise.reject(q)}Promise.resolve($).then(C).catch(q=>{var he;if(n)return;const G=e.retry??(_y?0:3),J=e.retryDelay??Sve,te=typeof J=="function"?J(r,q):J,oe=G===!0||typeof G=="number"&&r<G||typeof G=="function"&&G(r,q);if(t||!oe){R(q);return}r++,(he=e.onFail)==null||he.call(e,r,q),vve(te).then(()=>b()?void 0:F()).then(()=>{t?R(q):U()})})};return{promise:l,cancel:f,continue:()=>(a==null||a(),l),cancelRetry:i,continueRetry:_,canStart:E,start:()=>(E()?U():F().then(U),l)}}function Tve(){let e=[],t=0,r=i=>{i()},n=i=>{i()},a=i=>setTimeout(i,0);const l=i=>{t?e.push(i):a(()=>{r(i)})},f=()=>{const i=e;e=[],i.length&&a(()=>{n(()=>{i.forEach(_=>{r(_)})})})};return{batch:i=>{let _;t++;try{_=i()}finally{t--,t||f()}return _},batchCalls:i=>(..._)=>{l(()=>{i(..._)})},schedule:l,setNotifyFunction:i=>{r=i},setBatchNotifyFunction:i=>{n=i},setScheduler:i=>{a=i}}}var ja=Tve(),Yg,zX,MQ=(zX=class{constructor(){Sn(this,Yg)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Az(this.gcTime)&&Wr(this,Yg,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(_y?1/0:5*60*1e3))}clearGcTimeout(){St(this,Yg)&&(clearTimeout(St(this,Yg)),Wr(this,Yg,void 0))}},Yg=new WeakMap,zX),S0,T0,pc,Ja,rE,Kg,cu,uh,jX,Eve=(jX=class extends MQ{constructor(t){super();Sn(this,cu);Sn(this,S0);Sn(this,T0);Sn(this,pc);Sn(this,Ja);Sn(this,rE);Sn(this,Kg);Wr(this,Kg,!1),Wr(this,rE,t.defaultOptions),this.setOptions(t.options),this.observers=[],Wr(this,pc,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Wr(this,S0,Ave(this.options)),this.state=t.state??St(this,S0),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=St(this,Ja))==null?void 0:t.promise}setOptions(t){this.options={...St(this,rE),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&St(this,pc).remove(this)}setData(t,r){const n=Pz(this.state.data,t,this.options);return ni(this,cu,uh).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ni(this,cu,uh).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=St(this,Ja))==null?void 0:n.promise;return(a=St(this,Ja))==null||a.cancel(t),r?r.then(mc).catch(mc):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(St(this,S0))}isActive(){return this.observers.some(t=>gu(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===WB||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!bQ(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=St(this,Ja))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=St(this,Ja))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),St(this,pc).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(St(this,Ja)&&(St(this,Kg)?St(this,Ja).cancel({revert:!0}):St(this,Ja).cancelRetry()),this.scheduleGc()),St(this,pc).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ni(this,cu,uh).call(this,{type:"invalidate"})}fetch(t,r){var _,b,E;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(St(this,Ja))return St(this,Ja).continueRetry(),St(this,Ja).promise}if(t&&this.setOptions(t),!this.options.queryFn){const C=this.observers.find(R=>R.options.queryFn);C&&this.setOptions(C.options)}const n=new AbortController,a=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(Wr(this,Kg,!0),n.signal)})},l=()=>{const C=SQ(this.options,r),R={queryKey:this.queryKey,meta:this.meta};return a(R),Wr(this,Kg,!1),this.options.persister?this.options.persister(C,R,this):C(R)},f={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:l};a(f),(_=this.options.behavior)==null||_.onFetch(f,this),Wr(this,T0,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((b=f.fetchOptions)==null?void 0:b.meta))&&ni(this,cu,uh).call(this,{type:"fetch",meta:(E=f.fetchOptions)==null?void 0:E.meta});const i=C=>{var R,F,U,$;u3(C)&&C.silent||ni(this,cu,uh).call(this,{type:"error",error:C}),u3(C)||((F=(R=St(this,pc).config).onError)==null||F.call(R,C,this),($=(U=St(this,pc).config).onSettled)==null||$.call(U,this.state.data,C,this)),this.scheduleGc()};return Wr(this,Ja,AQ({initialPromise:r==null?void 0:r.initialPromise,fn:f.fetchFn,abort:n.abort.bind(n),onSuccess:C=>{var R,F,U,$;if(C===void 0){i(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(C)}catch(H){i(H);return}(F=(R=St(this,pc).config).onSuccess)==null||F.call(R,C,this),($=(U=St(this,pc).config).onSettled)==null||$.call(U,C,this.state.error,this),this.scheduleGc()},onError:i,onFail:(C,R)=>{ni(this,cu,uh).call(this,{type:"failed",failureCount:C,error:R})},onPause:()=>{ni(this,cu,uh).call(this,{type:"pause"})},onContinue:()=>{ni(this,cu,uh).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0})),St(this,Ja).start()}},S0=new WeakMap,T0=new WeakMap,pc=new WeakMap,Ja=new WeakMap,rE=new WeakMap,Kg=new WeakMap,cu=new WeakSet,uh=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...CQ(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return u3(a)&&a.revert&&St(this,T0)?{...St(this,T0),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),ja.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),St(this,pc).notify({query:this,type:"updated",action:t})})},jX);function CQ(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:TQ(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Ave(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var fd,FX,Mve=(FX=class extends mE{constructor(t={}){super();Sn(this,fd);this.config=t,Wr(this,fd,new Map)}build(t,r,n){const a=r.queryKey,l=r.queryHash??VB(a,r);let f=this.get(l);return f||(f=new Eve({cache:this,queryKey:a,queryHash:l,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(f)),f}add(t){St(this,fd).has(t.queryHash)||(St(this,fd).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=St(this,fd).get(t.queryHash);r&&(t.destroy(),r===t&&St(this,fd).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ja.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return St(this,fd).get(t)}getAll(){return[...St(this,fd).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>VG(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>VG(t,n)):r}notify(t){ja.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){ja.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ja.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},fd=new WeakMap,FX),pd,bs,Jg,md,ip,BX,Cve=(BX=class extends MQ{constructor(t){super();Sn(this,md);Sn(this,pd);Sn(this,bs);Sn(this,Jg);this.mutationId=t.mutationId,Wr(this,bs,t.mutationCache),Wr(this,pd,[]),this.state=t.state||Pve(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){St(this,pd).includes(t)||(St(this,pd).push(t),this.clearGcTimeout(),St(this,bs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Wr(this,pd,St(this,pd).filter(r=>r!==t)),this.scheduleGc(),St(this,bs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){St(this,pd).length||(this.state.status==="pending"?this.scheduleGc():St(this,bs).remove(this))}continue(){var t;return((t=St(this,Jg))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var a,l,f,i,_,b,E,C,R,F,U,$,H,q,G,J,te,oe,he,le;Wr(this,Jg,AQ({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(ve,We)=>{ni(this,md,ip).call(this,{type:"failed",failureCount:ve,error:We})},onPause:()=>{ni(this,md,ip).call(this,{type:"pause"})},onContinue:()=>{ni(this,md,ip).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>St(this,bs).canRun(this)}));const r=this.state.status==="pending",n=!St(this,Jg).canStart();try{if(!r){ni(this,md,ip).call(this,{type:"pending",variables:t,isPaused:n}),await((l=(a=St(this,bs).config).onMutate)==null?void 0:l.call(a,t,this));const We=await((i=(f=this.options).onMutate)==null?void 0:i.call(f,t));We!==this.state.context&&ni(this,md,ip).call(this,{type:"pending",context:We,variables:t,isPaused:n})}const ve=await St(this,Jg).start();return await((b=(_=St(this,bs).config).onSuccess)==null?void 0:b.call(_,ve,t,this.state.context,this)),await((C=(E=this.options).onSuccess)==null?void 0:C.call(E,ve,t,this.state.context)),await((F=(R=St(this,bs).config).onSettled)==null?void 0:F.call(R,ve,null,this.state.variables,this.state.context,this)),await(($=(U=this.options).onSettled)==null?void 0:$.call(U,ve,null,t,this.state.context)),ni(this,md,ip).call(this,{type:"success",data:ve}),ve}catch(ve){try{throw await((q=(H=St(this,bs).config).onError)==null?void 0:q.call(H,ve,t,this.state.context,this)),await((J=(G=this.options).onError)==null?void 0:J.call(G,ve,t,this.state.context)),await((oe=(te=St(this,bs).config).onSettled)==null?void 0:oe.call(te,void 0,ve,this.state.variables,this.state.context,this)),await((le=(he=this.options).onSettled)==null?void 0:le.call(he,void 0,ve,t,this.state.context)),ve}finally{ni(this,md,ip).call(this,{type:"error",error:ve})}}finally{St(this,bs).runNext(this)}}},pd=new WeakMap,bs=new WeakMap,Jg=new WeakMap,md=new WeakSet,ip=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),ja.batch(()=>{St(this,pd).forEach(n=>{n.onMutationUpdate(t)}),St(this,bs).notify({mutation:this,type:"updated",action:t})})},BX);function Pve(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ol,nE,$X,Ive=($X=class extends mE{constructor(t={}){super();Sn(this,Ol);Sn(this,nE);this.config=t,Wr(this,Ol,new Map),Wr(this,nE,Date.now())}build(t,r,n){const a=new Cve({mutationCache:this,mutationId:++PA(this,nE)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){const r=KA(t),n=St(this,Ol).get(r)??[];n.push(t),St(this,Ol).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=KA(t);if(St(this,Ol).has(r)){const a=(n=St(this,Ol).get(r))==null?void 0:n.filter(l=>l!==t);a&&(a.length===0?St(this,Ol).delete(r):St(this,Ol).set(r,a))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=St(this,Ol).get(KA(t)))==null?void 0:n.find(a=>a.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=St(this,Ol).get(KA(t)))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){ja.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...St(this,Ol).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>WG(r,n))}findAll(t={}){return this.getAll().filter(r=>WG(t,r))}notify(t){ja.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return ja.batch(()=>Promise.all(t.map(r=>r.continue().catch(mc))))}},Ol=new WeakMap,nE=new WeakMap,$X);function KA(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function HG(e){return{onFetch:(t,r)=>{var E,C,R,F,U;const n=t.options,a=(R=(C=(E=t.fetchOptions)==null?void 0:E.meta)==null?void 0:C.fetchMore)==null?void 0:R.direction,l=((F=t.state.data)==null?void 0:F.pages)||[],f=((U=t.state.data)==null?void 0:U.pageParams)||[];let i={pages:[],pageParams:[]},_=0;const b=async()=>{let $=!1;const H=J=>{Object.defineProperty(J,"signal",{enumerable:!0,get:()=>(t.signal.aborted?$=!0:t.signal.addEventListener("abort",()=>{$=!0}),t.signal)})},q=SQ(t.options,t.fetchOptions),G=async(J,te,oe)=>{if($)return Promise.reject();if(te==null&&J.pages.length)return Promise.resolve(J);const he={queryKey:t.queryKey,pageParam:te,direction:oe?"backward":"forward",meta:t.options.meta};H(he);const le=await q(he),{maxPages:ve}=t.options,We=oe?xve:_ve;return{pages:We(J.pages,le,ve),pageParams:We(J.pageParams,te,ve)}};if(a&&l.length){const J=a==="backward",te=J?Ove:ZG,oe={pages:l,pageParams:f},he=te(n,oe);i=await G(oe,he,J)}else{const J=e??l.length;do{const te=_===0?f[0]??n.initialPageParam:ZG(n,i);if(_>0&&te==null)break;i=await G(i,te),_++}while(_<J)}return i};t.options.persister?t.fetchFn=()=>{var $,H;return(H=($=t.options).persister)==null?void 0:H.call($,b,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=b}}}function ZG(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Ove(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Ro,Cp,Pp,E0,A0,Ip,M0,C0,UX,kve=(UX=class{constructor(e={}){Sn(this,Ro);Sn(this,Cp);Sn(this,Pp);Sn(this,E0);Sn(this,A0);Sn(this,Ip);Sn(this,M0);Sn(this,C0);Wr(this,Ro,e.queryCache||new Mve),Wr(this,Cp,e.mutationCache||new Ive),Wr(this,Pp,e.defaultOptions||{}),Wr(this,E0,new Map),Wr(this,A0,new Map),Wr(this,Ip,0)}mount(){PA(this,Ip)._++,St(this,Ip)===1&&(Wr(this,M0,GB.subscribe(async e=>{e&&(await this.resumePausedMutations(),St(this,Ro).onFocus())})),Wr(this,C0,QP.subscribe(async e=>{e&&(await this.resumePausedMutations(),St(this,Ro).onOnline())})))}unmount(){var e,t;PA(this,Ip)._--,St(this,Ip)===0&&((e=St(this,M0))==null||e.call(this),Wr(this,M0,void 0),(t=St(this,C0))==null||t.call(this),Wr(this,C0,void 0))}isFetching(e){return St(this,Ro).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return St(this,Cp).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=St(this,Ro).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=St(this,Ro).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(d0(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return St(this,Ro).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=St(this,Ro).get(n.queryHash),l=a==null?void 0:a.state.data,f=yve(t,l);if(f!==void 0)return St(this,Ro).build(this,n).setData(f,{...r,manual:!0})}setQueriesData(e,t,r){return ja.batch(()=>St(this,Ro).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=St(this,Ro).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=St(this,Ro);ja.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=St(this,Ro),n={type:"active",...e};return ja.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=ja.batch(()=>St(this,Ro).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(mc).catch(mc)}invalidateQueries(e={},t={}){return ja.batch(()=>{if(St(this,Ro).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=ja.batch(()=>St(this,Ro).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let l=a.fetch(void 0,r);return r.throwOnError||(l=l.catch(mc)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(n).then(mc)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=St(this,Ro).build(this,t);return r.isStaleByTime(d0(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(mc).catch(mc)}fetchInfiniteQuery(e){return e.behavior=HG(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(mc).catch(mc)}ensureInfiniteQueryData(e){return e.behavior=HG(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return QP.isOnline()?St(this,Cp).resumePausedMutations():Promise.resolve()}getQueryCache(){return St(this,Ro)}getMutationCache(){return St(this,Cp)}getDefaultOptions(){return St(this,Pp)}setDefaultOptions(e){Wr(this,Pp,e)}setQueryDefaults(e,t){St(this,E0).set(JS(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...St(this,E0).values()];let r={};return t.forEach(n=>{QS(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){St(this,A0).set(JS(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...St(this,A0).values()];let r={};return t.forEach(n=>{QS(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...St(this,Pp).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=VB(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===WB&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...St(this,Pp).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){St(this,Ro).clear(),St(this,Cp).clear()}},Ro=new WeakMap,Cp=new WeakMap,Pp=new WeakMap,E0=new WeakMap,A0=new WeakMap,Ip=new WeakMap,M0=new WeakMap,C0=new WeakMap,UX),el,ii,iE,ws,Qg,P0,Op,gd,oE,I0,O0,ey,ty,kp,k0,Mi,Iw,Oz,kz,Rz,Dz,Lz,Nz,zz,PQ,VX,Rve=(VX=class extends mE{constructor(t,r){super();Sn(this,Mi);Sn(this,el);Sn(this,ii);Sn(this,iE);Sn(this,ws);Sn(this,Qg);Sn(this,P0);Sn(this,Op);Sn(this,gd);Sn(this,oE);Sn(this,I0);Sn(this,O0);Sn(this,ey);Sn(this,ty);Sn(this,kp);Sn(this,k0,new Set);this.options=r,Wr(this,el,t),Wr(this,gd,null),Wr(this,Op,Iz()),this.options.experimental_prefetchInRender||St(this,Op).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(St(this,ii).addObserver(this),XG(St(this,ii),this.options)?ni(this,Mi,Iw).call(this):this.updateResult(),ni(this,Mi,Dz).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return jz(St(this,ii),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return jz(St(this,ii),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ni(this,Mi,Lz).call(this),ni(this,Mi,Nz).call(this),St(this,ii).removeObserver(this)}setOptions(t,r){const n=this.options,a=St(this,ii);if(this.options=St(this,el).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof gu(this.options.enabled,St(this,ii))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ni(this,Mi,zz).call(this),St(this,ii).setOptions(this.options),n._defaulted&&!Mz(this.options,n)&&St(this,el).getQueryCache().notify({type:"observerOptionsUpdated",query:St(this,ii),observer:this});const l=this.hasListeners();l&&YG(St(this,ii),a,this.options,n)&&ni(this,Mi,Iw).call(this),this.updateResult(r),l&&(St(this,ii)!==a||gu(this.options.enabled,St(this,ii))!==gu(n.enabled,St(this,ii))||d0(this.options.staleTime,St(this,ii))!==d0(n.staleTime,St(this,ii)))&&ni(this,Mi,Oz).call(this);const f=ni(this,Mi,kz).call(this);l&&(St(this,ii)!==a||gu(this.options.enabled,St(this,ii))!==gu(n.enabled,St(this,ii))||f!==St(this,kp))&&ni(this,Mi,Rz).call(this,f)}getOptimisticResult(t){const r=St(this,el).getQueryCache().build(St(this,el),t),n=this.createResult(r,t);return Lve(this,n)&&(Wr(this,ws,n),Wr(this,P0,this.options),Wr(this,Qg,St(this,ii).state)),n}getCurrentResult(){return St(this,ws)}trackResult(t,r){const n={};return Object.keys(t).forEach(a=>{Object.defineProperty(n,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),r==null||r(a),t[a])})}),n}trackProp(t){St(this,k0).add(t)}getCurrentQuery(){return St(this,ii)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=St(this,el).defaultQueryOptions(t),n=St(this,el).getQueryCache().build(St(this,el),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return ni(this,Mi,Iw).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),St(this,ws)))}createResult(t,r){var ve;const n=St(this,ii),a=this.options,l=St(this,ws),f=St(this,Qg),i=St(this,P0),b=t!==n?t.state:St(this,iE),{state:E}=t;let C={...E},R=!1,F;if(r._optimisticResults){const We=this.hasListeners(),Ie=!We&&XG(t,r),Re=We&&YG(t,n,r,a);(Ie||Re)&&(C={...C,...CQ(E.data,t.options)}),r._optimisticResults==="isRestoring"&&(C.fetchStatus="idle")}let{error:U,errorUpdatedAt:$,status:H}=C;if(r.select&&C.data!==void 0)if(l&&C.data===(f==null?void 0:f.data)&&r.select===St(this,oE))F=St(this,I0);else try{Wr(this,oE,r.select),F=r.select(C.data),F=Pz(l==null?void 0:l.data,F,r),Wr(this,I0,F),Wr(this,gd,null)}catch(We){Wr(this,gd,We)}else F=C.data;if(r.placeholderData!==void 0&&F===void 0&&H==="pending"){let We;if(l!=null&&l.isPlaceholderData&&r.placeholderData===(i==null?void 0:i.placeholderData))We=l.data;else if(We=typeof r.placeholderData=="function"?r.placeholderData((ve=St(this,O0))==null?void 0:ve.state.data,St(this,O0)):r.placeholderData,r.select&&We!==void 0)try{We=r.select(We),Wr(this,gd,null)}catch(Ie){Wr(this,gd,Ie)}We!==void 0&&(H="success",F=Pz(l==null?void 0:l.data,We,r),R=!0)}St(this,gd)&&(U=St(this,gd),F=St(this,I0),$=Date.now(),H="error");const q=C.fetchStatus==="fetching",G=H==="pending",J=H==="error",te=G&&q,oe=F!==void 0,le={status:H,fetchStatus:C.fetchStatus,isPending:G,isSuccess:H==="success",isError:J,isInitialLoading:te,isLoading:te,data:F,dataUpdatedAt:C.dataUpdatedAt,error:U,errorUpdatedAt:$,failureCount:C.fetchFailureCount,failureReason:C.fetchFailureReason,errorUpdateCount:C.errorUpdateCount,isFetched:C.dataUpdateCount>0||C.errorUpdateCount>0,isFetchedAfterMount:C.dataUpdateCount>b.dataUpdateCount||C.errorUpdateCount>b.errorUpdateCount,isFetching:q,isRefetching:q&&!G,isLoadingError:J&&!oe,isPaused:C.fetchStatus==="paused",isPlaceholderData:R,isRefetchError:J&&oe,isStale:qB(t,r),refetch:this.refetch,promise:St(this,Op)};if(this.options.experimental_prefetchInRender){const We=$e=>{le.status==="error"?$e.reject(le.error):le.data!==void 0&&$e.resolve(le.data)},Ie=()=>{const $e=Wr(this,Op,le.promise=Iz());We($e)},Re=St(this,Op);switch(Re.status){case"pending":t.queryHash===n.queryHash&&We(Re);break;case"fulfilled":(le.status==="error"||le.data!==Re.value)&&Ie();break;case"rejected":(le.status!=="error"||le.error!==Re.reason)&&Ie();break}}return le}updateResult(t){const r=St(this,ws),n=this.createResult(St(this,ii),this.options);if(Wr(this,Qg,St(this,ii).state),Wr(this,P0,this.options),St(this,Qg).data!==void 0&&Wr(this,O0,St(this,ii)),Mz(n,r))return;Wr(this,ws,n);const a={},l=()=>{if(!r)return!0;const{notifyOnChangeProps:f}=this.options,i=typeof f=="function"?f():f;if(i==="all"||!i&&!St(this,k0).size)return!0;const _=new Set(i??St(this,k0));return this.options.throwOnError&&_.add("error"),Object.keys(St(this,ws)).some(b=>{const E=b;return St(this,ws)[E]!==r[E]&&_.has(E)})};(t==null?void 0:t.listeners)!==!1&&l()&&(a.listeners=!0),ni(this,Mi,PQ).call(this,{...a,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ni(this,Mi,Dz).call(this)}},el=new WeakMap,ii=new WeakMap,iE=new WeakMap,ws=new WeakMap,Qg=new WeakMap,P0=new WeakMap,Op=new WeakMap,gd=new WeakMap,oE=new WeakMap,I0=new WeakMap,O0=new WeakMap,ey=new WeakMap,ty=new WeakMap,kp=new WeakMap,k0=new WeakMap,Mi=new WeakSet,Iw=function(t){ni(this,Mi,zz).call(this);let r=St(this,ii).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(mc)),r},Oz=function(){ni(this,Mi,Lz).call(this);const t=d0(this.options.staleTime,St(this,ii));if(_y||St(this,ws).isStale||!Az(t))return;const n=bQ(St(this,ws).dataUpdatedAt,t)+1;Wr(this,ey,setTimeout(()=>{St(this,ws).isStale||this.updateResult()},n))},kz=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(St(this,ii)):this.options.refetchInterval)??!1},Rz=function(t){ni(this,Mi,Nz).call(this),Wr(this,kp,t),!(_y||gu(this.options.enabled,St(this,ii))===!1||!Az(St(this,kp))||St(this,kp)===0)&&Wr(this,ty,setInterval(()=>{(this.options.refetchIntervalInBackground||GB.isFocused())&&ni(this,Mi,Iw).call(this)},St(this,kp)))},Dz=function(){ni(this,Mi,Oz).call(this),ni(this,Mi,Rz).call(this,ni(this,Mi,kz).call(this))},Lz=function(){St(this,ey)&&(clearTimeout(St(this,ey)),Wr(this,ey,void 0))},Nz=function(){St(this,ty)&&(clearInterval(St(this,ty)),Wr(this,ty,void 0))},zz=function(){const t=St(this,el).getQueryCache().build(St(this,el),this.options);if(t===St(this,ii))return;const r=St(this,ii);Wr(this,ii,t),Wr(this,iE,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},PQ=function(t){ja.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(St(this,ws))}),St(this,el).getQueryCache().notify({query:St(this,ii),type:"observerResultsUpdated"})})},VX);function Dve(e,t){return gu(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function XG(e,t){return Dve(e,t)||e.state.data!==void 0&&jz(e,t,t.refetchOnMount)}function jz(e,t,r){if(gu(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&qB(e,t)}return!1}function YG(e,t,r,n){return(e!==t||gu(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&qB(e,r)}function qB(e,t){return gu(t.enabled,e)!==!1&&e.isStaleByTime(d0(t.staleTime,e))}function Lve(e,t){return!Mz(e.getCurrentResult(),t)}var IQ=ne.createContext(void 0),Nve=e=>{const t=ne.useContext(IQ);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},zve=({client:e,children:t})=>(ne.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),j.jsx(IQ.Provider,{value:e,children:t})),OQ=ne.createContext(!1),jve=()=>ne.useContext(OQ);OQ.Provider;function Fve(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Bve=ne.createContext(Fve()),$ve=()=>ne.useContext(Bve);function Uve(e,t){return typeof e=="function"?e(...t):!!e}function Vve(){}var Wve=(e,t)=>{(e.suspense||e.throwOnError)&&(t.isReset()||(e.retryOnMount=!1))},Gve=e=>{ne.useEffect(()=>{e.clearReset()},[e])},qve=({result:e,errorResetBoundary:t,throwOnError:r,query:n})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&Uve(r,[e.error,n]),Hve=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},Zve=(e,t)=>e.isLoading&&e.isFetching&&!t,Xve=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,KG=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Yve(e,t,r){var E,C,R,F,U;const n=Nve(),a=jve(),l=$ve(),f=n.defaultQueryOptions(e);(C=(E=n.getDefaultOptions().queries)==null?void 0:E._experimental_beforeQuery)==null||C.call(E,f),f._optimisticResults=a?"isRestoring":"optimistic",Hve(f),Wve(f,l),Gve(l);const i=!n.getQueryCache().get(f.queryHash),[_]=ne.useState(()=>new t(n,f)),b=_.getOptimisticResult(f);if(ne.useSyncExternalStore(ne.useCallback($=>{const H=a?()=>{}:_.subscribe(ja.batchCalls($));return _.updateResult(),H},[_,a]),()=>_.getCurrentResult(),()=>_.getCurrentResult()),ne.useEffect(()=>{_.setOptions(f,{listeners:!1})},[f,_]),Xve(f,b))throw KG(f,_,l);if(qve({result:b,errorResetBoundary:l,throwOnError:f.throwOnError,query:n.getQueryCache().get(f.queryHash)}))throw b.error;if((F=(R=n.getDefaultOptions().queries)==null?void 0:R._experimental_afterQuery)==null||F.call(R,f,b),f.experimental_prefetchInRender&&!_y&&Zve(b,a)){const $=i?KG(f,_,l):(U=n.getQueryCache().get(f.queryHash))==null?void 0:U.promise;$==null||$.catch(Vve).finally(()=>{_.updateResult()})}return f.notifyOnChangeProps?b:_.trackResult(b)}function nk(e,t){return Yve(e,Rve)}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eT(){return eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eT.apply(this,arguments)}var Np;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Np||(Np={}));const JG="popstate";function Kve(e){e===void 0&&(e={});function t(n,a){let{pathname:l,search:f,hash:i}=n.location;return Fz("",{pathname:l,search:f,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:eI(a)}return Qve(t,r,null,e)}function Ao(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function kQ(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Jve(){return Math.random().toString(36).substr(2,8)}function QG(e,t){return{usr:e.state,key:e.key,idx:t}}function Fz(e,t,r,n){return r===void 0&&(r=null),eT({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Lx(t):t,{state:r,key:t&&t.key||n||Jve()})}function eI(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Lx(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Qve(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:l=!1}=n,f=a.history,i=Np.Pop,_=null,b=E();b==null&&(b=0,f.replaceState(eT({},f.state,{idx:b}),""));function E(){return(f.state||{idx:null}).idx}function C(){i=Np.Pop;let H=E(),q=H==null?null:H-b;b=H,_&&_({action:i,location:$.location,delta:q})}function R(H,q){i=Np.Push;let G=Fz($.location,H,q);b=E()+1;let J=QG(G,b),te=$.createHref(G);try{f.pushState(J,"",te)}catch(oe){if(oe instanceof DOMException&&oe.name==="DataCloneError")throw oe;a.location.assign(te)}l&&_&&_({action:i,location:$.location,delta:1})}function F(H,q){i=Np.Replace;let G=Fz($.location,H,q);b=E();let J=QG(G,b),te=$.createHref(G);f.replaceState(J,"",te),l&&_&&_({action:i,location:$.location,delta:0})}function U(H){let q=a.location.origin!=="null"?a.location.origin:a.location.href,G=typeof H=="string"?H:eI(H);return G=G.replace(/ $/,"%20"),Ao(q,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,q)}let $={get action(){return i},get location(){return e(a,f)},listen(H){if(_)throw new Error("A history only accepts one active listener");return a.addEventListener(JG,C),_=H,()=>{a.removeEventListener(JG,C),_=null}},createHref(H){return t(a,H)},createURL:U,encodeLocation(H){let q=U(H);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:R,replace:F,go(H){return f.go(H)}};return $}var eq;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(eq||(eq={}));function e_e(e,t,r){return r===void 0&&(r="/"),t_e(e,t,r,!1)}function t_e(e,t,r,n){let a=typeof t=="string"?Lx(t):t,l=U0(a.pathname||"/",r);if(l==null)return null;let f=RQ(e);r_e(f);let i=null;for(let _=0;i==null&&_<f.length;++_){let b=f_e(l);i=d_e(f[_],b,n)}return i}function RQ(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(l,f,i)=>{let _={relativePath:i===void 0?l.path||"":i,caseSensitive:l.caseSensitive===!0,childrenIndex:f,route:l};_.relativePath.startsWith("/")&&(Ao(_.relativePath.startsWith(n),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(n.length));let b=Zp([n,_.relativePath]),E=r.concat(_);l.children&&l.children.length>0&&(Ao(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),RQ(l.children,t,E,b)),!(l.path==null&&!l.index)&&t.push({path:b,score:c_e(b,l.index),routesMeta:E})};return e.forEach((l,f)=>{var i;if(l.path===""||!((i=l.path)!=null&&i.includes("?")))a(l,f);else for(let _ of DQ(l.path))a(l,f,_)}),t}function DQ(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let f=DQ(n.join("/")),i=[];return i.push(...f.map(_=>_===""?l:[l,_].join("/"))),a&&i.push(...f),i.map(_=>e.startsWith("/")&&_===""?"/":_)}function r_e(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:u_e(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const n_e=/^:[\w-]+$/,i_e=3,o_e=2,a_e=1,s_e=10,l_e=-2,tq=e=>e==="*";function c_e(e,t){let r=e.split("/"),n=r.length;return r.some(tq)&&(n+=l_e),t&&(n+=o_e),r.filter(a=>!tq(a)).reduce((a,l)=>a+(n_e.test(l)?i_e:l===""?a_e:s_e),n)}function u_e(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function d_e(e,t,r){let{routesMeta:n}=e,a={},l="/",f=[];for(let i=0;i<n.length;++i){let _=n[i],b=i===n.length-1,E=l==="/"?t:t.slice(l.length)||"/",C=tI({path:_.relativePath,caseSensitive:_.caseSensitive,end:b},E),R=_.route;if(!C&&b&&r&&!n[n.length-1].route.index&&(C=tI({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},E)),!C)return null;Object.assign(a,C.params),f.push({params:a,pathname:Zp([l,C.pathname]),pathnameBase:y_e(Zp([l,C.pathnameBase])),route:R}),C.pathnameBase!=="/"&&(l=Zp([l,C.pathnameBase]))}return f}function tI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=h_e(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let l=a[0],f=l.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((b,E,C)=>{let{paramName:R,isOptional:F}=E;if(R==="*"){let $=i[C]||"";f=l.slice(0,l.length-$.length).replace(/(.)\/+$/,"$1")}const U=i[C];return F&&!U?b[R]=void 0:b[R]=(U||"").replace(/%2F/g,"/"),b},{}),pathname:l,pathnameBase:f,pattern:e}}function h_e(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),kQ(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,i,_)=>(n.push({paramName:i,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function f_e(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return kQ(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function U0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function p_e(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Lx(e):e;return{pathname:r?r.startsWith("/")?r:m_e(r,t):t,search:v_e(n),hash:__e(a)}}function m_e(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function d3(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function g_e(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function HB(e,t){let r=g_e(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ZB(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Lx(e):(a=eT({},e),Ao(!a.pathname||!a.pathname.includes("?"),d3("?","pathname","search",a)),Ao(!a.pathname||!a.pathname.includes("#"),d3("#","pathname","hash",a)),Ao(!a.search||!a.search.includes("#"),d3("#","search","hash",a)));let l=e===""||a.pathname==="",f=l?"/":a.pathname,i;if(f==null)i=r;else{let C=t.length-1;if(!n&&f.startsWith("..")){let R=f.split("/");for(;R[0]==="..";)R.shift(),C-=1;a.pathname=R.join("/")}i=C>=0?t[C]:"/"}let _=p_e(a,i),b=f&&f!=="/"&&f.endsWith("/"),E=(l||f===".")&&r.endsWith("/");return!_.pathname.endsWith("/")&&(b||E)&&(_.pathname+="/"),_}const Zp=e=>e.join("/").replace(/\/\/+/g,"/"),y_e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),v_e=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,__e=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function x_e(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const LQ=["post","put","patch","delete"];new Set(LQ);const b_e=["get",...LQ];new Set(b_e);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tT(){return tT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tT.apply(this,arguments)}const ik=ne.createContext(null),NQ=ne.createContext(null),Yh=ne.createContext(null),ok=ne.createContext(null),$d=ne.createContext({outlet:null,matches:[],isDataRoute:!1}),zQ=ne.createContext(null);function w_e(e,t){let{relative:r}=t===void 0?{}:t;Nx()||Ao(!1);let{basename:n,navigator:a}=ne.useContext(Yh),{hash:l,pathname:f,search:i}=ak(e,{relative:r}),_=f;return n!=="/"&&(_=f==="/"?n:Zp([n,f])),a.createHref({pathname:_,search:i,hash:l})}function Nx(){return ne.useContext(ok)!=null}function Ly(){return Nx()||Ao(!1),ne.useContext(ok).location}function jQ(e){ne.useContext(Yh).static||ne.useLayoutEffect(e)}function Ny(){let{isDataRoute:e}=ne.useContext($d);return e?j_e():S_e()}function S_e(){Nx()||Ao(!1);let e=ne.useContext(ik),{basename:t,future:r,navigator:n}=ne.useContext(Yh),{matches:a}=ne.useContext($d),{pathname:l}=Ly(),f=JSON.stringify(HB(a,r.v7_relativeSplatPath)),i=ne.useRef(!1);return jQ(()=>{i.current=!0}),ne.useCallback(function(b,E){if(E===void 0&&(E={}),!i.current)return;if(typeof b=="number"){n.go(b);return}let C=ZB(b,JSON.parse(f),l,E.relative==="path");e==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:Zp([t,C.pathname])),(E.replace?n.replace:n.push)(C,E.state,E)},[t,n,f,l,e])}const T_e=ne.createContext(null);function E_e(e){let t=ne.useContext($d).outlet;return t&&ne.createElement(T_e.Provider,{value:e},t)}function A_e(){let{matches:e}=ne.useContext($d),t=e[e.length-1];return t?t.params:{}}function ak(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=ne.useContext(Yh),{matches:a}=ne.useContext($d),{pathname:l}=Ly(),f=JSON.stringify(HB(a,n.v7_relativeSplatPath));return ne.useMemo(()=>ZB(e,JSON.parse(f),l,r==="path"),[e,f,l,r])}function M_e(e,t){return C_e(e,t)}function C_e(e,t,r,n){Nx()||Ao(!1);let{navigator:a}=ne.useContext(Yh),{matches:l}=ne.useContext($d),f=l[l.length-1],i=f?f.params:{};f&&f.pathname;let _=f?f.pathnameBase:"/";f&&f.route;let b=Ly(),E;if(t){var C;let H=typeof t=="string"?Lx(t):t;_==="/"||(C=H.pathname)!=null&&C.startsWith(_)||Ao(!1),E=H}else E=b;let R=E.pathname||"/",F=R;if(_!=="/"){let H=_.replace(/^\//,"").split("/");F="/"+R.replace(/^\//,"").split("/").slice(H.length).join("/")}let U=e_e(e,{pathname:F}),$=R_e(U&&U.map(H=>Object.assign({},H,{params:Object.assign({},i,H.params),pathname:Zp([_,a.encodeLocation?a.encodeLocation(H.pathname).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?_:Zp([_,a.encodeLocation?a.encodeLocation(H.pathnameBase).pathname:H.pathnameBase])})),l,r,n);return t&&$?ne.createElement(ok.Provider,{value:{location:tT({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:Np.Pop}},$):$}function P_e(){let e=z_e(),t=x_e(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},t),r?ne.createElement("pre",{style:a},r):null,null)}const I_e=ne.createElement(P_e,null);class O_e extends ne.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ne.createElement($d.Provider,{value:this.props.routeContext},ne.createElement(zQ.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function k_e(e){let{routeContext:t,match:r,children:n}=e,a=ne.useContext(ik);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),ne.createElement($d.Provider,{value:t},n)}function R_e(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var l;if(!r)return null;if(r.errors)e=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let f=e,i=(a=r)==null?void 0:a.errors;if(i!=null){let E=f.findIndex(C=>C.route.id&&(i==null?void 0:i[C.route.id])!==void 0);E>=0||Ao(!1),f=f.slice(0,Math.min(f.length,E+1))}let _=!1,b=-1;if(r&&n&&n.v7_partialHydration)for(let E=0;E<f.length;E++){let C=f[E];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(b=E),C.route.id){let{loaderData:R,errors:F}=r,U=C.route.loader&&R[C.route.id]===void 0&&(!F||F[C.route.id]===void 0);if(C.route.lazy||U){_=!0,b>=0?f=f.slice(0,b+1):f=[f[0]];break}}}return f.reduceRight((E,C,R)=>{let F,U=!1,$=null,H=null;r&&(F=i&&C.route.id?i[C.route.id]:void 0,$=C.route.errorElement||I_e,_&&(b<0&&R===0?(U=!0,H=null):b===R&&(U=!0,H=C.route.hydrateFallbackElement||null)));let q=t.concat(f.slice(0,R+1)),G=()=>{let J;return F?J=$:U?J=H:C.route.Component?J=ne.createElement(C.route.Component,null):C.route.element?J=C.route.element:J=E,ne.createElement(k_e,{match:C,routeContext:{outlet:E,matches:q,isDataRoute:r!=null},children:J})};return r&&(C.route.ErrorBoundary||C.route.errorElement||R===0)?ne.createElement(O_e,{location:r.location,revalidation:r.revalidation,component:$,error:F,children:G(),routeContext:{outlet:null,matches:q,isDataRoute:!0}}):G()},null)}var FQ=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(FQ||{}),rI=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(rI||{});function D_e(e){let t=ne.useContext(ik);return t||Ao(!1),t}function L_e(e){let t=ne.useContext(NQ);return t||Ao(!1),t}function N_e(e){let t=ne.useContext($d);return t||Ao(!1),t}function BQ(e){let t=N_e(),r=t.matches[t.matches.length-1];return r.route.id||Ao(!1),r.route.id}function z_e(){var e;let t=ne.useContext(zQ),r=L_e(rI.UseRouteError),n=BQ(rI.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function j_e(){let{router:e}=D_e(FQ.UseNavigateStable),t=BQ(rI.UseNavigateStable),r=ne.useRef(!1);return jQ(()=>{r.current=!0}),ne.useCallback(function(a,l){l===void 0&&(l={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,tT({fromRouteId:t},l)))},[e,t])}function F_e(e){let{to:t,replace:r,state:n,relative:a}=e;Nx()||Ao(!1);let{future:l,static:f}=ne.useContext(Yh),{matches:i}=ne.useContext($d),{pathname:_}=Ly(),b=Ny(),E=ZB(t,HB(i,l.v7_relativeSplatPath),_,a==="path"),C=JSON.stringify(E);return ne.useEffect(()=>b(JSON.parse(C),{replace:r,state:n,relative:a}),[b,C,a,r,n]),null}function B_e(e){return E_e(e.context)}function Qo(e){Ao(!1)}function $_e(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Np.Pop,navigator:l,static:f=!1,future:i}=e;Nx()&&Ao(!1);let _=t.replace(/^\/*/,"/"),b=ne.useMemo(()=>({basename:_,navigator:l,static:f,future:tT({v7_relativeSplatPath:!1},i)}),[_,i,l,f]);typeof n=="string"&&(n=Lx(n));let{pathname:E="/",search:C="",hash:R="",state:F=null,key:U="default"}=n,$=ne.useMemo(()=>{let H=U0(E,_);return H==null?null:{location:{pathname:H,search:C,hash:R,state:F,key:U},navigationType:a}},[_,E,C,R,F,U,a]);return $==null?null:ne.createElement(Yh.Provider,{value:b},ne.createElement(ok.Provider,{children:r,value:$}))}function U_e(e){let{children:t,location:r}=e;return M_e(Bz(t),r)}new Promise(()=>{});function Bz(e,t){t===void 0&&(t=[]);let r=[];return ne.Children.forEach(e,(n,a)=>{if(!ne.isValidElement(n))return;let l=[...t,a];if(n.type===ne.Fragment){r.push.apply(r,Bz(n.props.children,l));return}n.type!==Qo&&Ao(!1),!n.props.index||!n.props.children||Ao(!1);let f={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(f.children=Bz(n.props.children,l)),r.push(f)}),r}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nI(){return nI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nI.apply(this,arguments)}function $Q(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function V_e(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function W_e(e,t){return e.button===0&&(!t||t==="_self")&&!V_e(e)}const G_e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],q_e=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],H_e="6";try{window.__reactRouterVersion=H_e}catch{}const Z_e=ne.createContext({isTransitioning:!1}),X_e="startTransition",rq=kO[X_e];function Y_e(e){let{basename:t,children:r,future:n,window:a}=e,l=ne.useRef();l.current==null&&(l.current=Kve({window:a,v5Compat:!0}));let f=l.current,[i,_]=ne.useState({action:f.action,location:f.location}),{v7_startTransition:b}=n||{},E=ne.useCallback(C=>{b&&rq?rq(()=>_(C)):_(C)},[_,b]);return ne.useLayoutEffect(()=>f.listen(E),[f,E]),ne.createElement($_e,{basename:t,children:r,location:i.location,navigationType:i.action,navigator:f,future:n})}const K_e=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",J_e=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,iy=ne.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:l,replace:f,state:i,target:_,to:b,preventScrollReset:E,viewTransition:C}=t,R=$Q(t,G_e),{basename:F}=ne.useContext(Yh),U,$=!1;if(typeof b=="string"&&J_e.test(b)&&(U=b,K_e))try{let J=new URL(window.location.href),te=b.startsWith("//")?new URL(J.protocol+b):new URL(b),oe=U0(te.pathname,F);te.origin===J.origin&&oe!=null?b=oe+te.search+te.hash:$=!0}catch{}let H=w_e(b,{relative:a}),q=t0e(b,{replace:f,state:i,target:_,preventScrollReset:E,relative:a,viewTransition:C});function G(J){n&&n(J),J.defaultPrevented||q(J)}return ne.createElement("a",nI({},R,{href:U||H,onClick:$||l?n:G,ref:r,target:_}))}),Q_e=ne.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:l="",end:f=!1,style:i,to:_,viewTransition:b,children:E}=t,C=$Q(t,q_e),R=ak(_,{relative:C.relative}),F=Ly(),U=ne.useContext(NQ),{navigator:$,basename:H}=ne.useContext(Yh),q=U!=null&&r0e(R)&&b===!0,G=$.encodeLocation?$.encodeLocation(R).pathname:R.pathname,J=F.pathname,te=U&&U.navigation&&U.navigation.location?U.navigation.location.pathname:null;a||(J=J.toLowerCase(),te=te?te.toLowerCase():null,G=G.toLowerCase()),te&&H&&(te=U0(te,H)||te);const oe=G!=="/"&&G.endsWith("/")?G.length-1:G.length;let he=J===G||!f&&J.startsWith(G)&&J.charAt(oe)==="/",le=te!=null&&(te===G||!f&&te.startsWith(G)&&te.charAt(G.length)==="/"),ve={isActive:he,isPending:le,isTransitioning:q},We=he?n:void 0,Ie;typeof l=="function"?Ie=l(ve):Ie=[l,he?"active":null,le?"pending":null,q?"transitioning":null].filter(Boolean).join(" ");let Re=typeof i=="function"?i(ve):i;return ne.createElement(iy,nI({},C,{"aria-current":We,className:Ie,ref:r,style:Re,to:_,viewTransition:b}),typeof E=="function"?E(ve):E)});var $z;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})($z||($z={}));var nq;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nq||(nq={}));function e0e(e){let t=ne.useContext(ik);return t||Ao(!1),t}function t0e(e,t){let{target:r,replace:n,state:a,preventScrollReset:l,relative:f,viewTransition:i}=t===void 0?{}:t,_=Ny(),b=Ly(),E=ak(e,{relative:f});return ne.useCallback(C=>{if(W_e(C,r)){C.preventDefault();let R=n!==void 0?n:eI(b)===eI(E);_(e,{replace:R,state:a,preventScrollReset:l,relative:f,viewTransition:i})}},[b,_,E,n,a,r,e,l,f,i])}function r0e(e,t){t===void 0&&(t={});let r=ne.useContext(Z_e);r==null&&Ao(!1);let{basename:n}=e0e($z.useViewTransitionState),a=ak(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=U0(r.currentLocation.pathname,n)||r.currentLocation.pathname,f=U0(r.nextLocation.pathname,n)||r.nextLocation.pathname;return tI(a.pathname,f)!=null||tI(a.pathname,l)!=null}const n0e="modulepreload",i0e=function(e){return"/"+e},iq={},V0=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),i=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=Promise.allSettled(r.map(_=>{if(_=i0e(_),_ in iq)return;iq[_]=!0;const b=_.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${E}`))return;const C=document.createElement("link");if(C.rel=b?"stylesheet":n0e,b||(C.as="script"),C.crossOrigin="",C.href=_,i&&C.setAttribute("nonce",i),document.head.appendChild(C),b)return new Promise((R,F)=>{C.addEventListener("load",R),C.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(f){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=f,window.dispatchEvent(i),!i.defaultPrevented)throw f}return a.then(f=>{for(const i of f||[])i.status==="rejected"&&l(i.reason);return t().catch(l)})},o0e=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>V0(async()=>{const{default:n}=await Promise.resolve().then(()=>zx);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class XB extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class a0e extends XB{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class s0e extends XB{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class l0e extends XB{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Uz;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Uz||(Uz={}));var c0e=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};class u0e{constructor(t,{headers:r={},customFetch:n,region:a=Uz.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=o0e(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return c0e(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:f}=r;let i={},{region:_}=r;_||(_=this.region),_&&_!=="any"&&(i["x-region"]=_);let b;f&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",b=f):typeof f=="string"?(i["Content-Type"]="text/plain",b=f):typeof FormData<"u"&&f instanceof FormData?b=f:(i["Content-Type"]="application/json",b=JSON.stringify(f)));const E=yield this.fetch(`${this.url}/${t}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),a),body:b}).catch(U=>{throw new a0e(U)}),C=E.headers.get("x-relay-error");if(C&&C==="true")throw new s0e(E);if(!E.ok)throw new l0e(E);let R=((n=E.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),F;return R==="application/json"?F=yield E.json():R==="application/octet-stream"?F=yield E.blob():R==="text/event-stream"?F=E:R==="multipart/form-data"?F=yield E.formData():F=yield E.text(),{data:F,error:null}}catch(a){return{data:null,error:a}}})}}var ol={},YB={},sk={},gE={},lk={},ck={},d0e=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},W0=d0e();const h0e=W0.fetch,UQ=W0.fetch.bind(W0),VQ=W0.Headers,f0e=W0.Request,p0e=W0.Response,zx=Object.freeze(Object.defineProperty({__proto__:null,Headers:VQ,Request:f0e,Response:p0e,default:UQ,fetch:h0e},Symbol.toStringTag,{value:"Module"})),m0e=qde(zx);var uk={};Object.defineProperty(uk,"__esModule",{value:!0});let g0e=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};uk.default=g0e;var WQ=Aa&&Aa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ck,"__esModule",{value:!0});const y0e=WQ(m0e),v0e=WQ(uk);let _0e=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=y0e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var f,i,_;let b=null,E=null,C=null,R=l.status,F=l.statusText;if(l.ok){if(this.method!=="HEAD"){const q=await l.text();q===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=q:E=JSON.parse(q))}const $=(f=this.headers.Prefer)===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),H=(i=l.headers.get("content-range"))===null||i===void 0?void 0:i.split("/");$&&H&&H.length>1&&(C=parseInt(H[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(b={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,C=null,R=406,F="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const $=await l.text();try{b=JSON.parse($),Array.isArray(b)&&l.status===404&&(E=[],b=null,R=200,F="OK")}catch{l.status===404&&$===""?(R=204,F="No Content"):b={message:$}}if(b&&this.isMaybeSingle&&(!((_=b==null?void 0:b.details)===null||_===void 0)&&_.includes("0 rows"))&&(b=null,R=200,F="OK"),b&&this.shouldThrowOnError)throw new v0e.default(b)}return{error:b,data:E,count:C,status:R,statusText:F}});return this.shouldThrowOnError||(a=a.catch(l=>{var f,i,_;return{error:{message:`${(f=l==null?void 0:l.name)!==null&&f!==void 0?f:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(i=l==null?void 0:l.stack)!==null&&i!==void 0?i:""}`,hint:"",code:`${(_=l==null?void 0:l.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};ck.default=_0e;var x0e=Aa&&Aa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lk,"__esModule",{value:!0});const b0e=x0e(ck);let w0e=class extends b0e.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:l=a}={}){const f=l?`${l}.order`:"order",i=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${i?`${i},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const l=typeof a>"u"?"offset":`${a}.offset`,f=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${t}`),this.url.searchParams.set(f,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:l=!1,format:f="text"}={}){var i;const _=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),b=(i=this.headers.Accept)!==null&&i!==void 0?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${b}"; options=${_};`,f==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};lk.default=w0e;var S0e=Aa&&Aa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gE,"__esModule",{value:!0});const T0e=S0e(lk);let E0e=class extends T0e.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const f=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${l}fts${f}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};gE.default=E0e;var A0e=Aa&&Aa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sk,"__esModule",{value:!0});const lw=A0e(gE);let M0e=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let l=!1;const f=(t??"*").split("").map(i=>/\s/.test(i)&&!l?"":(i==='"'&&(l=!l),i)).join("");return this.url.searchParams.set("select",f),n&&(this.headers.Prefer=`count=${n}`),new lw.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),n||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const f=t.reduce((i,_)=>i.concat(Object.keys(_)),[]);if(f.length>0){const i=[...new Set(f)].map(_=>`"${_}"`);this.url.searchParams.set("columns",i.join(","))}}return new lw.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:l=!0}={}){const f="POST",i=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&i.push(this.headers.Prefer),a&&i.push(`count=${a}`),l||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const _=t.reduce((b,E)=>b.concat(Object.keys(E)),[]);if(_.length>0){const b=[...new Set(_)].map(E=>`"${E}"`);this.url.searchParams.set("columns",b.join(","))}}return new lw.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new lw.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new lw.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};sk.default=M0e;var dk={},hk={};Object.defineProperty(hk,"__esModule",{value:!0});hk.version=void 0;hk.version="0.0.0-automated";Object.defineProperty(dk,"__esModule",{value:!0});dk.DEFAULT_HEADERS=void 0;const C0e=hk;dk.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${C0e.version}`};var GQ=Aa&&Aa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(YB,"__esModule",{value:!0});const P0e=GQ(sk),I0e=GQ(gE),O0e=dk;let k0e=class qQ{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},O0e.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new P0e.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new qQ(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:l}={}){let f;const i=new URL(`${this.url}/rpc/${t}`);let _;n||a?(f=n?"HEAD":"GET",Object.entries(r).filter(([E,C])=>C!==void 0).map(([E,C])=>[E,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([E,C])=>{i.searchParams.append(E,C)})):(f="POST",_=r);const b=Object.assign({},this.headers);return l&&(b.Prefer=`count=${l}`),new I0e.default({method:f,url:i,headers:b,schema:this.schemaName,body:_,fetch:this.fetch,allowEmpty:!1})}};YB.default=k0e;var jx=Aa&&Aa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ol,"__esModule",{value:!0});ol.PostgrestError=ol.PostgrestBuilder=ol.PostgrestTransformBuilder=ol.PostgrestFilterBuilder=ol.PostgrestQueryBuilder=ol.PostgrestClient=void 0;const HQ=jx(YB);ol.PostgrestClient=HQ.default;const ZQ=jx(sk);ol.PostgrestQueryBuilder=ZQ.default;const XQ=jx(gE);ol.PostgrestFilterBuilder=XQ.default;const YQ=jx(lk);ol.PostgrestTransformBuilder=YQ.default;const KQ=jx(ck);ol.PostgrestBuilder=KQ.default;const JQ=jx(uk);ol.PostgrestError=JQ.default;var R0e=ol.default={PostgrestClient:HQ.default,PostgrestQueryBuilder:ZQ.default,PostgrestFilterBuilder:XQ.default,PostgrestTransformBuilder:YQ.default,PostgrestBuilder:KQ.default,PostgrestError:JQ.default};const{PostgrestClient:D0e,PostgrestQueryBuilder:MKe,PostgrestFilterBuilder:CKe,PostgrestTransformBuilder:PKe,PostgrestBuilder:IKe,PostgrestError:OKe}=R0e,L0e="2.11.2",N0e={"X-Client-Info":`realtime-js/${L0e}`},z0e="1.0.0",QQ=1e4,j0e=1e3;var h0;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(h0||(h0={}));var Pl;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Pl||(Pl={}));var du;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(du||(du={}));var Vz;(function(e){e.websocket="websocket"})(Vz||(Vz={}));var zg;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(zg||(zg={}));class F0e{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),l=r.getUint8(2);let f=this.HEADER_LENGTH+2;const i=n.decode(t.slice(f,f+a));f=f+a;const _=n.decode(t.slice(f,f+l));f=f+l;const b=JSON.parse(n.decode(t.slice(f,t.byteLength)));return{ref:null,topic:i,event:_,payload:b}}}class eee{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ji;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ji||(Ji={}));const oq=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((l,f)=>(l[f]=B0e(f,e,t,a),l),{})},B0e=(e,t,r,n)=>{const a=t.find(i=>i.name===e),l=a==null?void 0:a.type,f=r[e];return l&&!n.includes(l)?tee(l,f):Wz(f)},tee=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return W0e(t,r)}switch(e){case Ji.bool:return $0e(t);case Ji.float4:case Ji.float8:case Ji.int2:case Ji.int4:case Ji.int8:case Ji.numeric:case Ji.oid:return U0e(t);case Ji.json:case Ji.jsonb:return V0e(t);case Ji.timestamp:return G0e(t);case Ji.abstime:case Ji.date:case Ji.daterange:case Ji.int4range:case Ji.int8range:case Ji.money:case Ji.reltime:case Ji.text:case Ji.time:case Ji.timestamptz:case Ji.timetz:case Ji.tsrange:case Ji.tstzrange:return Wz(t);default:return Wz(t)}},Wz=e=>e,$0e=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},U0e=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},V0e=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},W0e=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const f=e.slice(1,r);try{l=JSON.parse("["+f+"]")}catch{l=f?f.split(","):[]}return l.map(i=>tee(t,i))}return e},G0e=e=>typeof e=="string"?e.replace(" ","T"):e,ree=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class h3{constructor(t,r,n={},a=QQ){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var aq;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(aq||(aq={}));class vS{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:f,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vS.syncState(this.state,a,l,f),this.pendingDiffs.forEach(_=>{this.state=vS.syncDiff(this.state,_,l,f)}),this.pendingDiffs=[],i()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:f,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=vS.syncDiff(this.state,a,l,f),i())}),this.onJoin((a,l,f)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:f})}),this.onLeave((a,l,f)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const l=this.cloneDeep(t),f=this.transformState(r),i={},_={};return this.map(l,(b,E)=>{f[b]||(_[b]=E)}),this.map(f,(b,E)=>{const C=l[b];if(C){const R=E.map(H=>H.presence_ref),F=C.map(H=>H.presence_ref),U=E.filter(H=>F.indexOf(H.presence_ref)<0),$=C.filter(H=>R.indexOf(H.presence_ref)<0);U.length>0&&(i[b]=U),$.length>0&&(_[b]=$)}else i[b]=E}),this.syncDiff(l,{joins:i,leaves:_},n,a)}static syncDiff(t,r,n,a){const{joins:l,leaves:f}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(i,_)=>{var b;const E=(b=t[i])!==null&&b!==void 0?b:[];if(t[i]=this.cloneDeep(_),E.length>0){const C=t[i].map(F=>F.presence_ref),R=E.filter(F=>C.indexOf(F.presence_ref)<0);t[i].unshift(...R)}n(i,E,_)}),this.map(f,(i,_)=>{let b=t[i];if(!b)return;const E=_.map(C=>C.presence_ref);b=b.filter(C=>E.indexOf(C.presence_ref)<0),t[i]=b,a(i,b,_),b.length===0&&delete t[i]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sq;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(sq||(sq={}));var lq;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(lq||(lq={}));var vh;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vh||(vh={}));class KB{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Pl.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new h3(this,du.join,this.params,this.timeout),this.rejoinTimer=new eee(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Pl.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Pl.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Pl.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Pl.errored,this.rejoinTimer.scheduleTimeout())}),this._on(du.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new vS(this),this.broadcastEndpointURL=ree(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:f,private:i}}=this.params;this._onError(E=>t==null?void 0:t(vh.CHANNEL_ERROR,E)),this._onClose(()=>t==null?void 0:t(vh.CLOSED));const _={},b={broadcast:l,presence:f,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(E=>E.filter))!==null&&a!==void 0?a:[],private:i};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:b},_)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:E})=>{var C;if(this.socket.setAuth(),E===void 0){t==null||t(vh.SUBSCRIBED);return}else{const R=this.bindings.postgres_changes,F=(C=R==null?void 0:R.length)!==null&&C!==void 0?C:0,U=[];for(let $=0;$<F;$++){const H=R[$],{filter:{event:q,schema:G,table:J,filter:te}}=H,oe=E&&E[$];if(oe&&oe.event===q&&oe.schema===G&&oe.table===J&&oe.filter===te)U.push(Object.assign(Object.assign({},H),{id:oe.id}));else{this.unsubscribe(),t==null||t(vh.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=U,t&&t(vh.SUBSCRIBED);return}}).receive("error",E=>{t==null||t(vh.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vh.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:f}=t,_={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:f,private:this.private}]})};try{const b=await this._fetchWithTimeout(this.broadcastEndpointURL,_,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=b.body)===null||a===void 0?void 0:a.cancel()),b.ok?"ok":"error"}catch(b){return b.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var f,i,_;const b=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((_=(i=(f=this.params)===null||f===void 0?void 0:f.config)===null||i===void 0?void 0:i.broadcast)===null||_===void 0)&&_.ack)&&l("ok"),b.receive("ok",()=>l("ok")),b.receive("error",()=>l("error")),b.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Pl.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(du.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new h3(this,du.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),f=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(l),f}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new h3(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,l;const f=t.toLocaleLowerCase(),{close:i,error:_,leave:b,join:E}=du;if(n&&[i,_,b,E].indexOf(f)>=0&&n!==this._joinRef())return;let R=this._onMessage(f,r,n);if(r&&!R)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(F=>{var U,$,H;return((U=F.filter)===null||U===void 0?void 0:U.event)==="*"||((H=($=F.filter)===null||$===void 0?void 0:$.event)===null||H===void 0?void 0:H.toLocaleLowerCase())===f}).map(F=>F.callback(R,n)):(l=this.bindings[f])===null||l===void 0||l.filter(F=>{var U,$,H,q,G,J;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in F){const te=F.id,oe=(U=F.filter)===null||U===void 0?void 0:U.event;return te&&(($=r.ids)===null||$===void 0?void 0:$.includes(te))&&(oe==="*"||(oe==null?void 0:oe.toLocaleLowerCase())===((H=r.data)===null||H===void 0?void 0:H.type.toLocaleLowerCase()))}else{const te=(G=(q=F==null?void 0:F.filter)===null||q===void 0?void 0:q.event)===null||G===void 0?void 0:G.toLocaleLowerCase();return te==="*"||te===((J=r==null?void 0:r.event)===null||J===void 0?void 0:J.toLocaleLowerCase())}else return F.type.toLocaleLowerCase()===f}).map(F=>{if(typeof R=="object"&&"ids"in R){const U=R.data,{schema:$,table:H,commit_timestamp:q,type:G,errors:J}=U;R=Object.assign(Object.assign({},{schema:$,table:H,commit_timestamp:q,eventType:G,new:{},old:{},errors:J}),this._getPayloadRecords(U))}F.callback(R,n)})}_isClosed(){return this.state===Pl.closed}_isJoined(){return this.state===Pl.joined}_isJoining(){return this.state===Pl.joining}_isLeaving(){return this.state===Pl.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),l={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&KB.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(du.close,{},t)}_onError(t){this._on(du.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Pl.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=oq(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=oq(t.columns,t.old_record)),r}}const q0e=()=>{},H0e=typeof WebSocket<"u",Z0e=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class X0e{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=N0e,this.params={},this.timeout=QQ,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=q0e,this.conn=null,this.sendBuffer=[],this.serializer=new F0e,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let f;return l?f=l:typeof fetch>"u"?f=(...i)=>V0(async()=>{const{default:_}=await Promise.resolve().then(()=>zx);return{default:_}},void 0).then(({default:_})=>_(...i)):f=fetch,(...i)=>f(...i)},this.endPoint=`${t}/${Vz.websocket}`,this.httpEndpoint=ree(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(l,f)=>f(JSON.stringify(l)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new eee(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(H0e){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Y0e(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),V0(async()=>{const{default:t}=await import("./browser-BlCXAsXT.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:z0e}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case h0.connecting:return zg.Connecting;case h0.open:return zg.Open;case h0.closing:return zg.Closing;default:return zg.Closed}}isConnected(){return this.connectionState()===zg.Open}channel(t,r={config:{}}){const n=new KB(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:l}=t,f=()=>{this.encode(t,i=>{var _;(_=this.conn)===null||_===void 0||_.send(i)})};this.log("push",`${r} ${n} (${l})`,a),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(du.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(j0e,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:l,ref:f}=r;f&&f===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${n} ${a} ${f&&"("+f+")"||""}`,l),this.channels.filter(i=>i._isMember(n)).forEach(i=>i._trigger(a,l,f)),this.stateChangeCallbacks.message.forEach(i=>i(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(du.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Z0e],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Y0e{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=h0.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class JB extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Sa(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class K0e extends JB{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Gz extends JB{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var J0e=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const nee=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>V0(async()=>{const{default:n}=await Promise.resolve().then(()=>zx);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Q0e=()=>J0e(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield V0(()=>Promise.resolve().then(()=>zx),void 0)).Response:Response}),qz=e=>{if(Array.isArray(e))return e.map(r=>qz(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[a]=qz(n)}),t};var zy=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const f3=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),exe=(e,t,r)=>zy(void 0,void 0,void 0,function*(){const n=yield Q0e();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new K0e(f3(a),e.status||500))}).catch(a=>{t(new Gz(f3(a),a))}):t(new Gz(f3(e),e))}),txe=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function yE(e,t,r,n,a,l){return zy(this,void 0,void 0,function*(){return new Promise((f,i)=>{e(r,txe(t,n,a,l)).then(_=>{if(!_.ok)throw _;return n!=null&&n.noResolveJson?_:_.json()}).then(_=>f(_)).catch(_=>exe(_,i,n))})})}function iI(e,t,r,n){return zy(this,void 0,void 0,function*(){return yE(e,"GET",t,r,n)})}function yp(e,t,r,n,a){return zy(this,void 0,void 0,function*(){return yE(e,"POST",t,n,a,r)})}function rxe(e,t,r,n,a){return zy(this,void 0,void 0,function*(){return yE(e,"PUT",t,n,a,r)})}function nxe(e,t,r,n){return zy(this,void 0,void 0,function*(){return yE(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function iee(e,t,r,n,a){return zy(this,void 0,void 0,function*(){return yE(e,"DELETE",t,n,a,r)})}var qs=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const ixe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cq={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oxe{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=nee(a)}uploadOrUpdate(t,r,n,a){return qs(this,void 0,void 0,function*(){try{let l;const f=Object.assign(Object.assign({},cq),a);let i=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(f.upsert)});const _=f.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",f.cacheControl),_&&l.append("metadata",this.encodeMetadata(_)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",f.cacheControl),_&&l.append("metadata",this.encodeMetadata(_))):(l=n,i["cache-control"]=`max-age=${f.cacheControl}`,i["content-type"]=f.contentType,_&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(_)))),a!=null&&a.headers&&(i=Object.assign(Object.assign({},i),a.headers));const b=this._removeEmptyFolders(r),E=this._getFinalPath(b),C=yield this.fetch(`${this.url}/object/${E}`,Object.assign({method:t,body:l,headers:i},f!=null&&f.duplex?{duplex:f.duplex}:{})),R=yield C.json();return C.ok?{data:{path:b,id:R.Id,fullPath:R.Key},error:null}:{data:null,error:R}}catch(l){if(Sa(l))return{data:null,error:l};throw l}})}upload(t,r,n){return qs(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return qs(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),f=this._getFinalPath(l),i=new URL(this.url+`/object/upload/sign/${f}`);i.searchParams.set("token",r);try{let _;const b=Object.assign({upsert:cq.upsert},a),E=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});typeof Blob<"u"&&n instanceof Blob?(_=new FormData,_.append("cacheControl",b.cacheControl),_.append("",n)):typeof FormData<"u"&&n instanceof FormData?(_=n,_.append("cacheControl",b.cacheControl)):(_=n,E["cache-control"]=`max-age=${b.cacheControl}`,E["content-type"]=b.contentType);const C=yield this.fetch(i.toString(),{method:"PUT",body:_,headers:E}),R=yield C.json();return C.ok?{data:{path:l,fullPath:R.Key},error:null}:{data:null,error:R}}catch(_){if(Sa(_))return{data:null,error:_};throw _}})}createSignedUploadUrl(t,r){return qs(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const l=yield yp(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),f=new URL(this.url+l.url),i=f.searchParams.get("token");if(!i)throw new JB("No token returned by API");return{data:{signedUrl:f.toString(),path:t,token:i},error:null}}catch(n){if(Sa(n))return{data:null,error:n};throw n}})}update(t,r,n){return qs(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return qs(this,void 0,void 0,function*(){try{return{data:yield yp(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Sa(a))return{data:null,error:a};throw a}})}copy(t,r,n){return qs(this,void 0,void 0,function*(){try{return{data:{path:(yield yp(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Sa(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return qs(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),l=yield yp(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const f=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${f}`)},{data:l,error:null}}catch(a){if(Sa(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return qs(this,void 0,void 0,function*(){try{const a=yield yp(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${l}`):null})),error:null}}catch(a){if(Sa(a))return{data:null,error:a};throw a}})}download(t,r){return qs(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),f=l?`?${l}`:"";try{const i=this._getFinalPath(t);return{data:yield(yield iI(this.fetch,`${this.url}/${a}/${i}${f}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(Sa(i))return{data:null,error:i};throw i}})}info(t){return qs(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield iI(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:qz(n),error:null}}catch(n){if(Sa(n))return{data:null,error:n};throw n}})}exists(t){return qs(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield nxe(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Sa(n)&&n instanceof Gz){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&a.push(l);const i=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",_=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});_!==""&&a.push(_);let b=a.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${b}`)}}}remove(t){return qs(this,void 0,void 0,function*(){try{return{data:yield iee(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Sa(r))return{data:null,error:r};throw r}})}list(t,r,n){return qs(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},ixe),r),{prefix:t||""});return{data:yield yp(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Sa(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const axe="2.7.1",sxe={"X-Client-Info":`storage-js/${axe}`};var i_=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};class lxe{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},sxe),r),this.fetch=nee(n)}listBuckets(){return i_(this,void 0,void 0,function*(){try{return{data:yield iI(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Sa(t))return{data:null,error:t};throw t}})}getBucket(t){return i_(this,void 0,void 0,function*(){try{return{data:yield iI(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Sa(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return i_(this,void 0,void 0,function*(){try{return{data:yield yp(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Sa(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return i_(this,void 0,void 0,function*(){try{return{data:yield rxe(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Sa(n))return{data:null,error:n};throw n}})}emptyBucket(t){return i_(this,void 0,void 0,function*(){try{return{data:yield yp(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Sa(r))return{data:null,error:r};throw r}})}deleteBucket(t){return i_(this,void 0,void 0,function*(){try{return{data:yield iee(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Sa(r))return{data:null,error:r};throw r}})}}class cxe extends lxe{constructor(t,r={},n){super(t,r,n)}from(t){return new oxe(this.url,this.headers,t,this.fetch)}}const uxe="2.49.4";let Ow="";typeof Deno<"u"?Ow="deno":typeof document<"u"?Ow="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ow="react-native":Ow="node";const dxe={"X-Client-Info":`supabase-js-${Ow}/${uxe}`},hxe={headers:dxe},fxe={schema:"public"},pxe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mxe={};var gxe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};const yxe=e=>{let t;return e?t=e:typeof fetch>"u"?t=UQ:t=fetch,(...r)=>t(...r)},vxe=()=>typeof Headers>"u"?VQ:Headers,_xe=(e,t,r)=>{const n=yxe(r),a=vxe();return(l,f)=>gxe(void 0,void 0,void 0,function*(){var i;const _=(i=yield t())!==null&&i!==void 0?i:e;let b=new a(f==null?void 0:f.headers);return b.has("apikey")||b.set("apikey",e),b.has("Authorization")||b.set("Authorization",`Bearer ${_}`),n(l,Object.assign(Object.assign({},f),{headers:b}))})};var xxe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};function bxe(e){return e.replace(/\/$/,"")}function wxe(e,t){const{db:r,auth:n,realtime:a,global:l}=e,{db:f,auth:i,realtime:_,global:b}=t,E={db:Object.assign(Object.assign({},f),r),auth:Object.assign(Object.assign({},i),n),realtime:Object.assign(Object.assign({},_),a),global:Object.assign(Object.assign({},b),l),accessToken:()=>xxe(this,void 0,void 0,function*(){return""})};return e.accessToken?E.accessToken=e.accessToken:delete E.accessToken,E}const oee="2.69.1",v_=30*1e3,Hz=3,p3=Hz*v_,Sxe="http://localhost:9999",Txe="supabase.auth.token",Exe={"X-Client-Info":`gotrue-js/${oee}`},Zz="X-Supabase-Api-Version",aee={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Axe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Mxe=6e5;class QB extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Dn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Cxe extends QB{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Pxe(e){return Dn(e)&&e.name==="AuthApiError"}class see extends QB{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ym extends QB{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class op extends ym{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ixe(e){return Dn(e)&&e.name==="AuthSessionMissingError"}class m3 extends ym{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class JA extends ym{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class QA extends ym{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Oxe(e){return Dn(e)&&e.name==="AuthImplicitGrantRedirectError"}class uq extends ym{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xz extends ym{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function g3(e){return Dn(e)&&e.name==="AuthRetryableFetchError"}class dq extends ym{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class _S extends ym{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const hq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fq=` 	
\r=`.split(""),kxe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<fq.length;t+=1)e[fq[t].charCodeAt(0)]=-2;for(let t=0;t<hq.length;t+=1)e[hq[t].charCodeAt(0)]=t;return e})();function lee(e,t,r){const n=kxe[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function pq(e){const t=[],r=f=>{t.push(String.fromCodePoint(f))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=f=>{Lxe(f,n,r)};for(let f=0;f<e.length;f+=1)lee(e.charCodeAt(f),a,l);return t.join("")}function Rxe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Dxe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}Rxe(n,t)}}function Lxe(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Nxe(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)lee(e.charCodeAt(a),r,n);return new Uint8Array(t)}function zxe(e){const t=[];return Dxe(e,r=>t.push(r)),new Uint8Array(t)}function jxe(e){return Math.round(Date.now()/1e3)+e}function Fxe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const od=()=>typeof window<"u"&&typeof document<"u",bg={tested:!1,writable:!1},xS=()=>{if(!od())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(bg.tested)return bg.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),bg.tested=!0,bg.writable=!0}catch{bg.tested=!0,bg.writable=!1}return bg.writable};function Bxe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,l)=>{t[l]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const cee=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>V0(async()=>{const{default:n}=await Promise.resolve().then(()=>zx);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},$xe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",uee=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},eM=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},tM=async(e,t)=>{await e.removeItem(t)};class fk{constructor(){this.promise=new fk.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}fk.promiseConstructor=Promise;function y3(e){const t=e.split(".");if(t.length!==3)throw new _S("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Axe.test(t[n]))throw new _S("JWT not in base64url format");return{header:JSON.parse(pq(t[0])),payload:JSON.parse(pq(t[1])),signature:Nxe(t[2]),raw:{header:t[0],payload:t[1]}}}async function Uxe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Vxe(e,t){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const f=await e(l);if(!t(l,null,f)){n(f);return}}catch(f){if(!t(l,f)){a(f);return}}})()})}function Wxe(e){return("0"+e.toString(16)).substr(-2)}function Gxe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let l=0;l<56;l++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Wxe).join("")}async function qxe(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function Hxe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await qxe(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function o_(e,t,r=!1){const n=Gxe();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await uee(e,`${t}-code-verifier`,a);const l=await Hxe(n);return[l,n===l?"plain":"s256"]}const Zxe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Xxe(e){const t=e.headers.get(Zz);if(!t||!t.match(Zxe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Yxe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Kxe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Jxe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Ag=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qxe=[502,503,504];async function mq(e){var t;if(!$xe(e))throw new Xz(Ag(e),0);if(Qxe.includes(e.status))throw new Xz(Ag(e),e.status);let r;try{r=await e.json()}catch(l){throw new see(Ag(l),l)}let n;const a=Xxe(e);if(a&&a.getTime()>=aee["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new dq(Ag(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new op}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,f)=>l&&typeof f=="string",!0))throw new dq(Ag(r),e.status,r.weak_password.reasons);throw new Cxe(Ag(r),e.status||500,n)}const ebe=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Kn(e,t,r,n){var a;const l=Object.assign({},n==null?void 0:n.headers);l[Zz]||(l[Zz]=aee["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const f=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(f.redirect_to=n.redirectTo);const i=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",_=await tbe(e,t,r+i,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(_):{data:Object.assign({},_),error:null}}async function tbe(e,t,r,n,a,l){const f=ebe(t,n,a,l);let i;try{i=await e(r,Object.assign({},f))}catch(_){throw console.error(_),new Xz(Ag(_),0)}if(i.ok||await mq(i),n!=null&&n.noResolveJson)return i;try{return await i.json()}catch(_){await mq(_)}}function ap(e){var t;let r=null;obe(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=jxe(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function gq(e){const t=ap(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function bp(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function rbe(e){return{data:e,error:null}}function nbe(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l}=e,f=Jxe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l},_=Object.assign({},f);return{data:{properties:i,user:_},error:null}}function ibe(e){return e}function obe(e){return e.access_token&&e.refresh_token&&e.expires_in}var abe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class sbe{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=cee(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Kn(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Dn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Kn(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:bp})}catch(n){if(Dn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=abe(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Kn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:nbe,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Dn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Kn(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:bp})}catch(r){if(Dn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,l,f,i,_;try{const b={nextPage:null,lastPage:0,total:0},E=await Kn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:ibe});if(E.error)throw E.error;const C=await E.json(),R=(f=E.headers.get("x-total-count"))!==null&&f!==void 0?f:0,F=(_=(i=E.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&_!==void 0?_:[];return F.length>0&&(F.forEach(U=>{const $=parseInt(U.split(";")[0].split("=")[1].substring(0,1)),H=JSON.parse(U.split(";")[1].split("=")[1]);b[`${H}Page`]=$}),b.total=parseInt(R)),{data:Object.assign(Object.assign({},C),b),error:null}}catch(b){if(Dn(b))return{data:{users:[]},error:b};throw b}}async getUserById(t){try{return await Kn(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:bp})}catch(r){if(Dn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Kn(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:bp})}catch(n){if(Dn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Kn(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:bp})}catch(n){if(Dn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Kn(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Dn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Kn(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Dn(r))return{data:null,error:r};throw r}}}const lbe={getItem:e=>xS()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{xS()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{xS()&&globalThis.localStorage.removeItem(e)}};function yq(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function cbe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const a_={debug:!!(globalThis&&xS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dee extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ube extends dee{}async function dbe(e,t,r){a_.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),a_.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){a_.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{a_.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw a_.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ube(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(a_.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}cbe();const hbe={url:Sxe,storageKey:Txe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Exe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function vq(e,t,r){return await r()}class rT{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=rT.nextInstanceID,rT.nextInstanceID+=1,this.instanceID>0&&od()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},hbe),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new sbe({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=cee(a.fetch),this.lock=a.lock||vq,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:od()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=dbe:this.lock=vq,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:xS()?this.storage=lbe:(this.memoryStorage={},this.storage=yq(this.memoryStorage)):(this.memoryStorage={},this.storage=yq(this.memoryStorage)),od()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${oee}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Bxe(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),od()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Oxe(l)){const _=(t=l.details)===null||t===void 0?void 0:t.code;if(_==="identity_already_exists"||_==="identity_not_found"||_==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:f,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",f,"redirect type",i),await this._saveSession(f),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Dn(r)?{error:r}:{error:new see("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const l=await Kn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ap}),{data:f,error:i}=l;if(i||!f)return{data:{user:null,session:null},error:i};const _=f.session,b=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(l){if(Dn(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var r,n,a;try{let l;if("email"in t){const{email:E,password:C,options:R}=t;let F=null,U=null;this.flowType==="pkce"&&([F,U]=await o_(this.storage,this.storageKey)),l=await Kn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:R==null?void 0:R.emailRedirectTo,body:{email:E,password:C,data:(r=R==null?void 0:R.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:R==null?void 0:R.captchaToken},code_challenge:F,code_challenge_method:U},xform:ap})}else if("phone"in t){const{phone:E,password:C,options:R}=t;l=await Kn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:E,password:C,data:(n=R==null?void 0:R.data)!==null&&n!==void 0?n:{},channel:(a=R==null?void 0:R.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:R==null?void 0:R.captchaToken}},xform:ap})}else throw new JA("You must provide either an email or phone number and a password");const{data:f,error:i}=l;if(i||!f)return{data:{user:null,session:null},error:i};const _=f.session,b=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(l){if(Dn(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:f,options:i}=t;r=await Kn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:f,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:gq})}else if("phone"in t){const{phone:l,password:f,options:i}=t;r=await Kn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:f,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:gq})}else throw new JA("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new m3}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Dn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await eM(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:l,error:f}=await Kn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ap});if(await tM(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new m3}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:f})}catch(l){if(Dn(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:l,nonce:f}=t,i=await Kn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:f,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ap}),{data:_,error:b}=i;return b?{data:{user:null,session:null},error:b}:!_||!_.session||!_.user?{data:{user:null,session:null},error:new m3}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:_,error:b})}catch(r){if(Dn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,l,f;try{if("email"in t){const{email:i,options:_}=t;let b=null,E=null;this.flowType==="pkce"&&([b,E]=await o_(this.storage,this.storageKey));const{error:C}=await Kn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},create_user:(n=_==null?void 0:_.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:b,code_challenge_method:E},redirectTo:_==null?void 0:_.emailRedirectTo});return{data:{user:null,session:null},error:C}}if("phone"in t){const{phone:i,options:_}=t,{data:b,error:E}=await Kn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(a=_==null?void 0:_.data)!==null&&a!==void 0?a:{},create_user:(l=_==null?void 0:_.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},channel:(f=_==null?void 0:_.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:b==null?void 0:b.message_id},error:E}}throw new JA("You must provide either an email or phone number.")}catch(i){if(Dn(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(t){var r,n;try{let a,l;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:f,error:i}=await Kn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:ap});if(i)throw i;if(!f)throw new Error("An error occurred on token verification.");const _=f.session,b=f.user;return _!=null&&_.access_token&&(await this._saveSession(_),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",_)),{data:{user:b,session:_},error:null}}catch(a){if(Dn(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let l=null,f=null;return this.flowType==="pkce"&&([l,f]=await o_(this.storage,this.storageKey)),await Kn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:f}),headers:this.headers,xform:rbe})}catch(l){if(Dn(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new op;const{error:a}=await Kn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Dn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:l}=t,{error:f}=await Kn(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in t){const{phone:n,type:a,options:l}=t,{data:f,error:i}=await Kn(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:i}}throw new JA("You must provide either an email or phone number and a type")}catch(r){if(Dn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await eM(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<p3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let f=this.suppressGetSessionWarning;t=new Proxy(t,{get:(_,b,E)=>(!f&&b==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(_,b,E))})}return{data:{session:t},error:null}}const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Kn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:bp}):await this._useSession(async r=>{var n,a,l;const{data:f,error:i}=r;if(i)throw i;return!(!((n=f.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new op}:await Kn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=f.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:bp})})}catch(r){if(Dn(r))return Ixe(r)&&(await this._removeSession(),await tM(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new op;const f=a.session;let i=null,_=null;this.flowType==="pkce"&&t.email!=null&&([i,_]=await o_(this.storage,this.storageKey));const{data:b,error:E}=await Kn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:i,code_challenge_method:_}),jwt:f.access_token,xform:bp});if(E)throw E;return f.user=b.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(n){if(Dn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new op;const r=Date.now()/1e3;let n=r,a=!0,l=null;const{payload:f}=y3(t.access_token);if(f.exp&&(n=f.exp,a=n<=r),a){const{session:i,error:_}=await this._callRefreshToken(t.refresh_token);if(_)return{data:{user:null,session:null},error:_};if(!i)return{data:{user:null,session:null},error:null};l=i}else{const{data:i,error:_}=await this._getUser(t.access_token);if(_)throw _;l={access_token:t.access_token,refresh_token:t.refresh_token,user:i.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(Dn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:f,error:i}=r;if(i)throw i;t=(n=f.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new op;const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Dn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!od())throw new QA("No browser detected.");if(t.error||t.error_description||t.error_code)throw new QA(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new uq("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new QA("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new uq("No code detected.");const{data:G,error:J}=await this._exchangeCodeForSession(t.code);if(J)throw J;const te=new URL(window.location.href);return te.searchParams.delete("code"),window.history.replaceState(window.history.state,"",te.toString()),{data:{session:G.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:f,expires_in:i,expires_at:_,token_type:b}=t;if(!l||!i||!f||!b)throw new QA("No session defined in URL");const E=Math.round(Date.now()/1e3),C=parseInt(i);let R=E+C;_&&(R=parseInt(_));const F=R-E;F*1e3<=v_&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${F}s, should have been closer to ${C}s`);const U=R-C;E-U>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",U,R,E):E-U<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",U,R,E);const{data:$,error:H}=await this._getUser(l);if(H)throw H;const q={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:C,expires_at:R,refresh_token:f,token_type:b,user:$.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:q,redirectType:t.type},error:null}}catch(n){if(Dn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await eM(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return{error:l};const f=(n=a.session)===null||n===void 0?void 0:n.access_token;if(f){const{error:i}=await this.admin.signOut(f,t);if(i&&!(Pxe(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return t!=="others"&&(await this._removeSession(),await tM(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Fxe(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:l},error:f}=r;if(f)throw f;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await o_(this.storage,this.storageKey,!0));try{return await Kn(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(Dn(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Dn(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async l=>{var f,i,_,b,E;const{data:C,error:R}=l;if(R)throw R;const F=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(f=t.options)===null||f===void 0?void 0:f.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(_=t.options)===null||_===void 0?void 0:_.queryParams,skipBrowserRedirect:!0});return await Kn(this.fetch,"GET",F,{headers:this.headers,jwt:(E=(b=C.session)===null||b===void 0?void 0:b.access_token)!==null&&E!==void 0?E:void 0})});if(a)throw a;return od()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Dn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:f}=r;if(f)throw f;return await Kn(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Dn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Vxe(async a=>(a>0&&await Uxe(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Kn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ap})),(a,l)=>{const f=200*Math.pow(2,a);return l&&g3(l)&&Date.now()+f-n<v_})}catch(n){if(this._debug(r,"error",n),Dn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),od()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await eM(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<p3;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${p3}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),g3(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new op;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new fk;const{data:l,error:f}=await this._refreshAccessToken(t);if(f)throw f;if(!l.session)throw new op;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const i={session:l.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(l){if(this._debug(a,"error",l),Dn(l)){const f={session:null,error:l};return g3(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(f),f}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],f=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(t,r)}catch(_){l.push(_)}});if(await Promise.all(f),l.length>0){for(let i=0;i<l.length;i+=1)console.error(l[i]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await uee(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await tM(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&od()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),v_);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/v_);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${v_}ms, refresh threshold is ${Hz} ticks`),a<=Hz&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof dee)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!od()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,f]=await o_(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(f)}`});a.push(i.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?{data:null,error:l}:await Kn(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Dn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:f}=r;if(f)return{data:null,error:f};const i=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:_,error:b}=await Kn(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return b?{data:null,error:b}:(t.factorType==="totp"&&(!((a=_==null?void 0:_.totp)===null||a===void 0)&&a.qr_code)&&(_.totp.qr_code=`data:image/svg+xml;utf-8,${_.totp.qr_code}`),{data:_,error:null})})}catch(r){if(Dn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return{data:null,error:l};const{data:f,error:i}=await Kn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),{data:f,error:i})})}catch(r){if(Dn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?{data:null,error:l}:await Kn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Dn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(f=>f.factor_type==="totp"&&f.status==="verified"),l=n.filter(f=>f.factor_type==="phone"&&f.status==="verified");return{data:{all:n,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:l}=t;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=y3(a.access_token);let i=null;f.aal&&(i=f.aal);let _=i;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(C=>C.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(_="aal2");const E=f.amr||[];return{data:{currentLevel:i,nextLevel:_,currentAuthenticationMethods:E},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(f=>f.kid===t);if(n||(n=this.jwks.keys.find(f=>f.kid===t),n&&this.jwks_cached_at+Mxe>Date.now()))return n;const{data:a,error:l}=await Kn(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;if(!a.keys||a.keys.length===0)throw new _S("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(f=>f.kid===t),!n)throw new _S("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:F,error:U}=await this.getSession();if(U||!F.session)return{data:null,error:U};n=F.session.access_token}const{header:a,payload:l,signature:f,raw:{header:i,payload:_}}=y3(n);if(Yxe(l.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:F}=await this.getUser(n);if(F)throw F;return{data:{claims:l,header:a,signature:f},error:null}}const b=Kxe(a.alg),E=await this.fetchJwk(a.kid,r),C=await crypto.subtle.importKey("jwk",E,b,!0,["verify"]);if(!await crypto.subtle.verify(b,C,f,zxe(`${i}.${_}`)))throw new _S("Invalid JWT signature");return{data:{claims:l,header:a,signature:f},error:null}}catch(n){if(Dn(n))return{data:null,error:n};throw n}}}rT.nextInstanceID=0;const fbe=rT;class pbe extends fbe{constructor(t){super(t)}}var mbe=function(e,t,r,n){function a(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function i(E){try{b(n.next(E))}catch(C){f(C)}}function _(E){try{b(n.throw(E))}catch(C){f(C)}}function b(E){E.done?l(E.value):a(E.value).then(i,_)}b((n=n.apply(e,t||[])).next())})};class gbe{constructor(t,r,n){var a,l,f;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const i=bxe(t);this.realtimeUrl=`${i}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.functionsUrl=`${i}/functions/v1`;const _=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,b={db:fxe,realtime:mxe,auth:Object.assign(Object.assign({},pxe),{storageKey:_}),global:hxe},E=wxe(n??{},b);this.storageKey=(a=E.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=E.global.headers)!==null&&l!==void 0?l:{},E.accessToken?(this.accessToken=E.accessToken,this.auth=new Proxy({},{get:(C,R)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(R)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=E.auth)!==null&&f!==void 0?f:{},this.headers,E.global.fetch),this.fetch=_xe(r,this._getAccessToken.bind(this),E.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},E.realtime)),this.rest=new D0e(`${i}/rest/v1`,{headers:this.headers,schema:E.db.schema,fetch:this.fetch}),E.accessToken||this._listenForAuthEvents()}get functions(){return new u0e(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new cxe(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return mbe(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:l,flowType:f,lock:i,debug:_},b,E){const C={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new pbe({url:this.authUrl,headers:Object.assign(Object.assign({},C),b),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:f,lock:i,debug:_,fetch:E,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new X0e(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ybe=(e,t,r)=>new gbe(e,t,r),vbe="https://vjhouhxasitabbqooqqh.supabase.co",_be="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZqaG91aHhhc2l0YWJicW9vcXFoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3ODIxNzcsImV4cCI6MjA2MDM1ODE3N30.GJ7CV3J7IdyY7_A4a0CsxWxBQ7nHpLnGD8bVlbKxJs4",mo=ybe(vbe,_be),po=({to:e,icon:t,label:r,exactMatch:n=!1})=>j.jsxs(Q_e,{to:e,className:({isActive:a})=>Nr("flex items-center text-sidebar-foreground gap-2 py-2 px-3 my-1 rounded-md transition-colors","hover:bg-sidebar-accent/80 hover:text-sidebar-accent-foreground",a&&"active-nav-link"),end:n,children:[j.jsx(t,{className:"h-5 w-5"}),j.jsx("span",{children:r})]}),v3=({title:e,children:t,defaultOpen:r=!1})=>{const[n,a]=ze.useState(r);return j.jsxs("div",{className:"mb-3",children:[j.jsxs("button",{onClick:()=>a(!n),className:"flex items-center justify-between w-full text-sidebar-foreground px-3 py-2 text-sm",children:[j.jsx("span",{className:"font-medium uppercase tracking-wider text-xs",children:e}),j.jsx(MB,{className:Nr("h-4 w-4 transition-transform",n&&"transform rotate-180")})]}),j.jsx("div",{className:Nr("space-y-1 overflow-hidden transition-all",n?"max-h-96":"max-h-0"),children:t})]})},xbe=()=>{const[e,t]=ze.useState(!1);return j.jsxs("div",{className:Nr("bg-sidebar h-screen transition-all duration-300 flex flex-col border-r border-sidebar-border",e?"w-16":"w-64"),children:[j.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-sidebar-border",children:[!e&&j.jsxs("h1",{className:"text-xl font-bold text-white tracking-tight",children:[j.jsx("span",{className:"text-logistics-400",children:"4r"}),"logística"]}),e&&j.jsx("div",{className:"mx-auto",children:j.jsx("span",{className:"text-xl font-bold text-logistics-400",children:"4r"})}),j.jsx("button",{onClick:()=>t(!e),className:"text-sidebar-foreground hover:text-white p-1 rounded-md hover:bg-sidebar-accent/50 transition-colors",children:j.jsx(CB,{className:Nr("h-5 w-5 transition-transform",e&&"transform rotate-180")})})]}),j.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:e?j.jsxs("div",{className:"flex flex-col items-center space-y-4 mt-4",children:[j.jsx(po,{to:"/admin",icon:MG,label:"",exactMatch:!0}),j.jsx(po,{to:"/admin/orders",icon:SG,label:""}),j.jsx(po,{to:"/admin/manual-order",icon:EG,label:""}),j.jsx(po,{to:"/admin/routes",icon:Y_,label:""}),j.jsx(po,{to:"/admin/packages",icon:l0,label:""}),j.jsx(po,{to:"/admin/inventory",icon:TG,label:""}),j.jsx(po,{to:"/admin/fleet",icon:XS,label:""}),j.jsx(po,{to:"/admin/operators",icon:UM,label:""}),j.jsx(po,{to:"/admin/tms",icon:AG,label:""}),j.jsx(po,{to:"/admin/tracking",icon:Y_,label:""}),j.jsx(po,{to:"/admin/documents",icon:wG,label:""}),j.jsx(po,{to:"/admin/settings",icon:vz,label:""})]}):j.jsxs(j.Fragment,{children:[j.jsx(po,{to:"/admin",icon:MG,label:"Dashboard",exactMatch:!0}),j.jsxs(v3,{title:"Gestión",defaultOpen:!0,children:[j.jsx(po,{to:"/admin/orders",icon:SG,label:"Órdenes"}),j.jsx(po,{to:"/admin/manual-order",icon:EG,label:"Orden Manual"}),j.jsx(po,{to:"/admin/routes",icon:Y_,label:"Rutas"}),j.jsx(po,{to:"/admin/packages",icon:l0,label:"Paquetes"})]}),j.jsxs(v3,{title:"Inventario y Flota",children:[j.jsx(po,{to:"/admin/inventory",icon:TG,label:"Inventario"}),j.jsx(po,{to:"/admin/fleet",icon:XS,label:"Flota"}),j.jsx(po,{to:"/admin/operators",icon:UM,label:"Operadores"})]}),j.jsxs(v3,{title:"Operaciones",children:[j.jsx(po,{to:"/admin/tms",icon:AG,label:"TMS"}),j.jsx(po,{to:"/admin/tracking",icon:Y_,label:"Tracking"}),j.jsx(po,{to:"/admin/documents",icon:wG,label:"Documentación"})]}),j.jsx("div",{className:"mt-auto pt-4",children:j.jsx(po,{to:"/admin/settings",icon:vz,label:"Configuración"})})]})}),!e&&j.jsx("div",{className:"border-t border-sidebar-border p-4",children:j.jsxs("div",{className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 rounded-full bg-logistics-600 flex items-center justify-center text-white",children:j.jsx(UM,{className:"h-4 w-4"})}),j.jsxs("div",{children:[j.jsx("p",{className:"text-sm font-medium text-sidebar-foreground",children:"Admin User"}),j.jsx("p",{className:"text-xs text-sidebar-foreground/70",children:"administrator@swiftship.com"})]})]})})]})},bbe=()=>{const e=Ny();return ne.useEffect(()=>{(async()=>{const{data:{session:n}}=await mo.auth.getSession();n||e("/login",{replace:!0})})();const{data:{subscription:r}}=mo.auth.onAuthStateChange((n,a)=>{a||e("/login",{replace:!0})});return()=>r.unsubscribe()},[e]),j.jsxs("div",{className:"flex h-screen bg-background",children:[j.jsx(xbe,{}),j.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[j.jsxs("header",{className:"bg-white border-b h-16 flex items-center justify-between px-6",children:[j.jsx("div",{className:"flex items-center",children:j.jsxs("div",{className:"relative w-64",children:[j.jsx(YO,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),j.jsx("input",{type:"text",placeholder:"Buscar...",className:"border rounded-md pl-8 pr-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"})]})}),j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsxs("button",{className:"relative p-2 text-muted-foreground hover:text-foreground rounded-md hover:bg-gray-100 transition-colors",children:[j.jsx(mme,{className:"h-5 w-5"}),j.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),j.jsx("button",{className:"relative p-2 text-muted-foreground hover:text-foreground rounded-md hover:bg-gray-100 transition-colors",children:j.jsx(Mme,{className:"h-5 w-5"})}),j.jsx("div",{className:"h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white",children:j.jsx("span",{className:"font-medium text-sm",children:"AD"})})]})]}),j.jsx("main",{className:"flex-1 overflow-y-auto bg-background p-6",children:j.jsx(B_e,{})})]})]})},Yz=fE("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Zn=ne.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},l)=>{const f=n?Bh:"button";return j.jsx(f,{className:Nr(Yz({variant:t,size:r,className:e})),ref:l,...a})});Zn.displayName="Button";const Si=ne.forwardRef(({className:e,type:t,...r},n)=>j.jsx("input",{type:t,className:Nr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Si.displayName="Input";function wbe(){const e=Ny(),[t,r]=ne.useState(!1),[n,a]=ne.useState(""),[l,f]=ne.useState("");ne.useEffect(()=>{(async()=>{const{data:{session:b}}=await mo.auth.getSession();b&&e("/admin",{replace:!0})})()},[e]);const i=async _=>{_.preventDefault(),r(!0);try{const{error:b}=await mo.auth.signInWithPassword({email:n,password:l});if(b)throw b;e("/admin")}catch(b){qP({variant:"destructive",title:"Error al iniciar sesión",description:b.message})}finally{r(!1)}};return j.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:j.jsxs("div",{className:"max-w-md w-full space-y-8",children:[j.jsx("div",{children:j.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Iniciar Sesión"})}),j.jsxs("form",{className:"mt-8 space-y-6",onSubmit:i,children:[j.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[j.jsx("div",{children:j.jsx(Si,{type:"email",required:!0,value:n,onChange:_=>a(_.target.value),placeholder:"Correo electrónico"})}),j.jsx("div",{children:j.jsx(Si,{type:"password",required:!0,value:l,onChange:_=>f(_.target.value),placeholder:"Contraseña"})})]}),j.jsx("div",{children:j.jsx(Zn,{type:"submit",className:"w-full",disabled:t,children:t?"Iniciando sesión...":"Iniciar sesión"})})]})]})})}function Sbe(){const[e,t]=ne.useState(!1),[r,n]=ne.useState(""),[a,l]=ne.useState(""),[f,i]=ne.useState(""),[_,b]=ne.useState(""),E=async C=>{C.preventDefault(),t(!0);try{const{data:{user:R},error:F}=await mo.auth.admin.createUser({email:r,password:a,email_confirm:!0,user_metadata:{first_name:f,last_name:_}});if(F)throw F;qP({title:"Usuario creado",description:`Se ha creado el usuario ${r} exitosamente.`}),n(""),l(""),i(""),b("")}catch(R){qP({variant:"destructive",title:"Error al crear usuario",description:R.message})}finally{t(!1)}};return j.jsxs("div",{className:"container mx-auto px-4 py-8",children:[j.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),j.jsx("div",{className:"max-w-md",children:j.jsxs("form",{onSubmit:E,className:"space-y-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nombre"}),j.jsx(Si,{type:"text",value:f,onChange:C=>i(C.target.value),required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Apellido"}),j.jsx(Si,{type:"text",value:_,onChange:C=>b(C.target.value),required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Correo electrónico"}),j.jsx(Si,{type:"email",value:r,onChange:C=>n(C.target.value),required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contraseña"}),j.jsx(Si,{type:"password",value:a,onChange:C=>l(C.target.value),required:!0,minLength:6})]}),j.jsx(Zn,{type:"submit",className:"w-full",disabled:e,children:e?"Creando usuario...":"Crear usuario"})]})})]})}var Tbe=Array.isArray,gl=Tbe,Ebe=typeof Aa=="object"&&Aa&&Aa.Object===Object&&Aa,hee=Ebe,Abe=hee,Mbe=typeof self=="object"&&self&&self.Object===Object&&self,Cbe=Abe||Mbe||Function("return this")(),Ud=Cbe,Pbe=Ud,Ibe=Pbe.Symbol,vE=Ibe,_q=vE,fee=Object.prototype,Obe=fee.hasOwnProperty,kbe=fee.toString,cw=_q?_q.toStringTag:void 0;function Rbe(e){var t=Obe.call(e,cw),r=e[cw];try{e[cw]=void 0;var n=!0}catch{}var a=kbe.call(e);return n&&(t?e[cw]=r:delete e[cw]),a}var Dbe=Rbe,Lbe=Object.prototype,Nbe=Lbe.toString;function zbe(e){return Nbe.call(e)}var jbe=zbe,xq=vE,Fbe=Dbe,Bbe=jbe,$be="[object Null]",Ube="[object Undefined]",bq=xq?xq.toStringTag:void 0;function Vbe(e){return e==null?e===void 0?Ube:$be:bq&&bq in Object(e)?Fbe(e):Bbe(e)}var Kh=Vbe;function Wbe(e){return e!=null&&typeof e=="object"}var Jh=Wbe,Gbe=Kh,qbe=Jh,Hbe="[object Symbol]";function Zbe(e){return typeof e=="symbol"||qbe(e)&&Gbe(e)==Hbe}var Fx=Zbe,Xbe=gl,Ybe=Fx,Kbe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Jbe=/^\w*$/;function Qbe(e,t){if(Xbe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Ybe(e)?!0:Jbe.test(e)||!Kbe.test(e)||t!=null&&e in Object(t)}var e5=Qbe;function e1e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var vm=e1e;const Bx=hi(vm);var t1e=Kh,r1e=vm,n1e="[object AsyncFunction]",i1e="[object Function]",o1e="[object GeneratorFunction]",a1e="[object Proxy]";function s1e(e){if(!r1e(e))return!1;var t=t1e(e);return t==i1e||t==o1e||t==n1e||t==a1e}var t5=s1e;const Vn=hi(t5);var l1e=Ud,c1e=l1e["__core-js_shared__"],u1e=c1e,_3=u1e,wq=function(){var e=/[^.]+$/.exec(_3&&_3.keys&&_3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function d1e(e){return!!wq&&wq in e}var h1e=d1e,f1e=Function.prototype,p1e=f1e.toString;function m1e(e){if(e!=null){try{return p1e.call(e)}catch{}try{return e+""}catch{}}return""}var pee=m1e,g1e=t5,y1e=h1e,v1e=vm,_1e=pee,x1e=/[\\^$.*+?()[\]{}|]/g,b1e=/^\[object .+?Constructor\]$/,w1e=Function.prototype,S1e=Object.prototype,T1e=w1e.toString,E1e=S1e.hasOwnProperty,A1e=RegExp("^"+T1e.call(E1e).replace(x1e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function M1e(e){if(!v1e(e)||y1e(e))return!1;var t=g1e(e)?A1e:b1e;return t.test(_1e(e))}var C1e=M1e;function P1e(e,t){return e==null?void 0:e[t]}var I1e=P1e,O1e=C1e,k1e=I1e;function R1e(e,t){var r=k1e(e,t);return O1e(r)?r:void 0}var jy=R1e,D1e=jy,L1e=D1e(Object,"create"),pk=L1e,Sq=pk;function N1e(){this.__data__=Sq?Sq(null):{},this.size=0}var z1e=N1e;function j1e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var F1e=j1e,B1e=pk,$1e="__lodash_hash_undefined__",U1e=Object.prototype,V1e=U1e.hasOwnProperty;function W1e(e){var t=this.__data__;if(B1e){var r=t[e];return r===$1e?void 0:r}return V1e.call(t,e)?t[e]:void 0}var G1e=W1e,q1e=pk,H1e=Object.prototype,Z1e=H1e.hasOwnProperty;function X1e(e){var t=this.__data__;return q1e?t[e]!==void 0:Z1e.call(t,e)}var Y1e=X1e,K1e=pk,J1e="__lodash_hash_undefined__";function Q1e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=K1e&&t===void 0?J1e:t,this}var ewe=Q1e,twe=z1e,rwe=F1e,nwe=G1e,iwe=Y1e,owe=ewe;function $x(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}$x.prototype.clear=twe;$x.prototype.delete=rwe;$x.prototype.get=nwe;$x.prototype.has=iwe;$x.prototype.set=owe;var awe=$x;function swe(){this.__data__=[],this.size=0}var lwe=swe;function cwe(e,t){return e===t||e!==e&&t!==t}var r5=cwe,uwe=r5;function dwe(e,t){for(var r=e.length;r--;)if(uwe(e[r][0],t))return r;return-1}var mk=dwe,hwe=mk,fwe=Array.prototype,pwe=fwe.splice;function mwe(e){var t=this.__data__,r=hwe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():pwe.call(t,r,1),--this.size,!0}var gwe=mwe,ywe=mk;function vwe(e){var t=this.__data__,r=ywe(t,e);return r<0?void 0:t[r][1]}var _we=vwe,xwe=mk;function bwe(e){return xwe(this.__data__,e)>-1}var wwe=bwe,Swe=mk;function Twe(e,t){var r=this.__data__,n=Swe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Ewe=Twe,Awe=lwe,Mwe=gwe,Cwe=_we,Pwe=wwe,Iwe=Ewe;function Ux(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ux.prototype.clear=Awe;Ux.prototype.delete=Mwe;Ux.prototype.get=Cwe;Ux.prototype.has=Pwe;Ux.prototype.set=Iwe;var gk=Ux,Owe=jy,kwe=Ud,Rwe=Owe(kwe,"Map"),n5=Rwe,Tq=awe,Dwe=gk,Lwe=n5;function Nwe(){this.size=0,this.__data__={hash:new Tq,map:new(Lwe||Dwe),string:new Tq}}var zwe=Nwe;function jwe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Fwe=jwe,Bwe=Fwe;function $we(e,t){var r=e.__data__;return Bwe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var yk=$we,Uwe=yk;function Vwe(e){var t=Uwe(this,e).delete(e);return this.size-=t?1:0,t}var Wwe=Vwe,Gwe=yk;function qwe(e){return Gwe(this,e).get(e)}var Hwe=qwe,Zwe=yk;function Xwe(e){return Zwe(this,e).has(e)}var Ywe=Xwe,Kwe=yk;function Jwe(e,t){var r=Kwe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Qwe=Jwe,eSe=zwe,tSe=Wwe,rSe=Hwe,nSe=Ywe,iSe=Qwe;function Vx(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Vx.prototype.clear=eSe;Vx.prototype.delete=tSe;Vx.prototype.get=rSe;Vx.prototype.has=nSe;Vx.prototype.set=iSe;var i5=Vx,mee=i5,oSe="Expected a function";function o5(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(oSe);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],l=r.cache;if(l.has(a))return l.get(a);var f=e.apply(this,n);return r.cache=l.set(a,f)||l,f};return r.cache=new(o5.Cache||mee),r}o5.Cache=mee;var gee=o5;const aSe=hi(gee);var sSe=gee,lSe=500;function cSe(e){var t=sSe(e,function(n){return r.size===lSe&&r.clear(),n}),r=t.cache;return t}var uSe=cSe,dSe=uSe,hSe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fSe=/\\(\\)?/g,pSe=dSe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(hSe,function(r,n,a,l){t.push(a?l.replace(fSe,"$1"):n||r)}),t}),mSe=pSe;function gSe(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var a5=gSe,Eq=vE,ySe=a5,vSe=gl,_Se=Fx,xSe=1/0,Aq=Eq?Eq.prototype:void 0,Mq=Aq?Aq.toString:void 0;function yee(e){if(typeof e=="string")return e;if(vSe(e))return ySe(e,yee)+"";if(_Se(e))return Mq?Mq.call(e):"";var t=e+"";return t=="0"&&1/e==-xSe?"-0":t}var bSe=yee,wSe=bSe;function SSe(e){return e==null?"":wSe(e)}var vee=SSe,TSe=gl,ESe=e5,ASe=mSe,MSe=vee;function CSe(e,t){return TSe(e)?e:ESe(e,t)?[e]:ASe(MSe(e))}var _ee=CSe,PSe=Fx,ISe=1/0;function OSe(e){if(typeof e=="string"||PSe(e))return e;var t=e+"";return t=="0"&&1/e==-ISe?"-0":t}var vk=OSe,kSe=_ee,RSe=vk;function DSe(e,t){t=kSe(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[RSe(t[r++])];return r&&r==n?e:void 0}var s5=DSe,LSe=s5;function NSe(e,t,r){var n=e==null?void 0:LSe(e,t);return n===void 0?r:n}var xee=NSe;const Ec=hi(xee);function zSe(e){return e==null}var jSe=zSe;const oi=hi(jSe);var FSe=Kh,BSe=gl,$Se=Jh,USe="[object String]";function VSe(e){return typeof e=="string"||!BSe(e)&&$Se(e)&&FSe(e)==USe}var WSe=VSe;const _E=hi(WSe);var bee={exports:{}},Di={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l5=Symbol.for("react.element"),c5=Symbol.for("react.portal"),_k=Symbol.for("react.fragment"),xk=Symbol.for("react.strict_mode"),bk=Symbol.for("react.profiler"),wk=Symbol.for("react.provider"),Sk=Symbol.for("react.context"),GSe=Symbol.for("react.server_context"),Tk=Symbol.for("react.forward_ref"),Ek=Symbol.for("react.suspense"),Ak=Symbol.for("react.suspense_list"),Mk=Symbol.for("react.memo"),Ck=Symbol.for("react.lazy"),qSe=Symbol.for("react.offscreen"),wee;wee=Symbol.for("react.module.reference");function Oc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case l5:switch(e=e.type,e){case _k:case bk:case xk:case Ek:case Ak:return e;default:switch(e=e&&e.$$typeof,e){case GSe:case Sk:case Tk:case Ck:case Mk:case wk:return e;default:return t}}case c5:return t}}}Di.ContextConsumer=Sk;Di.ContextProvider=wk;Di.Element=l5;Di.ForwardRef=Tk;Di.Fragment=_k;Di.Lazy=Ck;Di.Memo=Mk;Di.Portal=c5;Di.Profiler=bk;Di.StrictMode=xk;Di.Suspense=Ek;Di.SuspenseList=Ak;Di.isAsyncMode=function(){return!1};Di.isConcurrentMode=function(){return!1};Di.isContextConsumer=function(e){return Oc(e)===Sk};Di.isContextProvider=function(e){return Oc(e)===wk};Di.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===l5};Di.isForwardRef=function(e){return Oc(e)===Tk};Di.isFragment=function(e){return Oc(e)===_k};Di.isLazy=function(e){return Oc(e)===Ck};Di.isMemo=function(e){return Oc(e)===Mk};Di.isPortal=function(e){return Oc(e)===c5};Di.isProfiler=function(e){return Oc(e)===bk};Di.isStrictMode=function(e){return Oc(e)===xk};Di.isSuspense=function(e){return Oc(e)===Ek};Di.isSuspenseList=function(e){return Oc(e)===Ak};Di.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===_k||e===bk||e===xk||e===Ek||e===Ak||e===qSe||typeof e=="object"&&e!==null&&(e.$$typeof===Ck||e.$$typeof===Mk||e.$$typeof===wk||e.$$typeof===Sk||e.$$typeof===Tk||e.$$typeof===wee||e.getModuleId!==void 0)};Di.typeOf=Oc;bee.exports=Di;var See=bee.exports,HSe=Kh,ZSe=Jh,XSe="[object Number]";function YSe(e){return typeof e=="number"||ZSe(e)&&HSe(e)==XSe}var Tee=YSe;const KSe=hi(Tee);var JSe=Tee;function QSe(e){return JSe(e)&&e!=+e}var eTe=QSe;const Wx=hi(eTe);var _u=function(t){return t===0?0:t>0?1:-1},$g=function(t){return _E(t)&&t.indexOf("%")===t.length-1},br=function(t){return KSe(t)&&!Wx(t)},ya=function(t){return br(t)||_E(t)},tTe=0,xE=function(t){var r=++tTe;return"".concat(t||"").concat(r)},xy=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!br(t)&&!_E(t))return n;var l;if($g(t)){var f=t.indexOf("%");l=r*parseFloat(t.slice(0,f))/100}else l=+t;return Wx(l)&&(l=n),a&&l>r&&(l=r),l},wp=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},rTe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},_c=function(t,r){return br(t)&&br(r)?function(n){return t+n*(r-t)}:function(){return r}};function oI(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Ec(n,t))===r})}function f0(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function Kz(e){"@babel/helpers - typeof";return Kz=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kz(e)}var nTe=["viewBox","children"],iTe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Cq=["points","pathLength"],x3={svg:nTe,polygon:Cq,polyline:Cq},u5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],aI=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(ne.isValidElement(t)&&(n=t.props),!Bx(n))return null;var a={};return Object.keys(n).forEach(function(l){u5.includes(l)&&(a[l]=r||function(f){return n[l](n,f)})}),a},oTe=function(t,r,n){return function(a){return t(r,n,a),null}},sI=function(t,r,n){if(!Bx(t)||Kz(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(l){var f=t[l];u5.includes(l)&&typeof f=="function"&&(a||(a={}),a[l]=oTe(f,r,n))}),a},aTe=["children"],sTe=["children"];function Pq(e,t){if(e==null)return{};var r=lTe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Jz(e){"@babel/helpers - typeof";return Jz=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jz(e)}var Iq={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Ih=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Oq=null,b3=null,d5=function e(t){if(t===Oq&&Array.isArray(b3))return b3;var r=[];return ne.Children.forEach(t,function(n){oi(n)||(See.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),b3=r,Oq=t,r};function Tu(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return Ih(a)}):n=[Ih(t)],d5(e).forEach(function(a){var l=Ec(a,"type.displayName")||Ec(a,"type.name");n.indexOf(l)!==-1&&r.push(a)}),r}function Dl(e,t){var r=Tu(e,t);return r&&r[0]}var kq=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!br(n)||n<=0||!br(a)||a<=0)},cTe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],uTe=function(t){return t&&t.type&&_E(t.type)&&cTe.indexOf(t.type)>=0},dTe=function(t){return t&&Jz(t)==="object"&&"clipDot"in t},hTe=function(t,r,n,a){var l,f=(l=x3==null?void 0:x3[a])!==null&&l!==void 0?l:[];return!Vn(t)&&(a&&f.includes(r)||iTe.includes(r))||n&&u5.includes(r)},Xn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(ne.isValidElement(t)&&(a=t.props),!Bx(a))return null;var l={};return Object.keys(a).forEach(function(f){var i;hTe((i=a)===null||i===void 0?void 0:i[f],f,r,n)&&(l[f]=a[f])}),l},Qz=function e(t,r){if(t===r)return!0;var n=ne.Children.count(t);if(n!==ne.Children.count(r))return!1;if(n===0)return!0;if(n===1)return Rq(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var l=t[a],f=r[a];if(Array.isArray(l)||Array.isArray(f)){if(!e(l,f))return!1}else if(!Rq(l,f))return!1}return!0},Rq=function(t,r){if(oi(t)&&oi(r))return!0;if(!oi(t)&&!oi(r)){var n=t.props||{},a=n.children,l=Pq(n,aTe),f=r.props||{},i=f.children,_=Pq(f,sTe);return a&&i?f0(l,_)&&Qz(a,i):!a&&!i?f0(l,_):!1}return!1},Dq=function(t,r){var n=[],a={};return d5(t).forEach(function(l,f){if(uTe(l))n.push(l);else if(l){var i=Ih(l.type),_=r[i]||{},b=_.handler,E=_.once;if(b&&(!E||!a[i])){var C=b(l,i,f);n.push(C),a[i]=!0}}}),n},fTe=function(t){var r=t&&t.type;return r&&Iq[r]?Iq[r]:null},pTe=function(t,r){return d5(r).indexOf(t)},mTe=["children","width","height","viewBox","className","style","title","desc"];function ej(){return ej=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ej.apply(this,arguments)}function gTe(e,t){if(e==null)return{};var r=yTe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function tj(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,l=e.className,f=e.style,i=e.title,_=e.desc,b=gTe(e,mTe),E=a||{width:r,height:n,x:0,y:0},C=di("recharts-surface",l);return ze.createElement("svg",ej({},Xn(b,!0,"svg"),{className:C,width:r,height:n,style:f,viewBox:"".concat(E.x," ").concat(E.y," ").concat(E.width," ").concat(E.height)}),ze.createElement("title",null,i),ze.createElement("desc",null,_),t)}var vTe=["children","className"];function rj(){return rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rj.apply(this,arguments)}function _Te(e,t){if(e==null)return{};var r=xTe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var To=ze.forwardRef(function(e,t){var r=e.children,n=e.className,a=_Te(e,vTe),l=di("recharts-layer",n);return ze.createElement("g",rj({className:l},Xn(a,!0),{ref:t}),r)}),Oh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l]};function bTe(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var l=Array(a);++n<a;)l[n]=e[n+t];return l}var wTe=bTe,STe=wTe;function TTe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:STe(e,t,r)}var ETe=TTe,ATe="\\ud800-\\udfff",MTe="\\u0300-\\u036f",CTe="\\ufe20-\\ufe2f",PTe="\\u20d0-\\u20ff",ITe=MTe+CTe+PTe,OTe="\\ufe0e\\ufe0f",kTe="\\u200d",RTe=RegExp("["+kTe+ATe+ITe+OTe+"]");function DTe(e){return RTe.test(e)}var Eee=DTe;function LTe(e){return e.split("")}var NTe=LTe,Aee="\\ud800-\\udfff",zTe="\\u0300-\\u036f",jTe="\\ufe20-\\ufe2f",FTe="\\u20d0-\\u20ff",BTe=zTe+jTe+FTe,$Te="\\ufe0e\\ufe0f",UTe="["+Aee+"]",nj="["+BTe+"]",ij="\\ud83c[\\udffb-\\udfff]",VTe="(?:"+nj+"|"+ij+")",Mee="[^"+Aee+"]",Cee="(?:\\ud83c[\\udde6-\\uddff]){2}",Pee="[\\ud800-\\udbff][\\udc00-\\udfff]",WTe="\\u200d",Iee=VTe+"?",Oee="["+$Te+"]?",GTe="(?:"+WTe+"(?:"+[Mee,Cee,Pee].join("|")+")"+Oee+Iee+")*",qTe=Oee+Iee+GTe,HTe="(?:"+[Mee+nj+"?",nj,Cee,Pee,UTe].join("|")+")",ZTe=RegExp(ij+"(?="+ij+")|"+HTe+qTe,"g");function XTe(e){return e.match(ZTe)||[]}var YTe=XTe,KTe=NTe,JTe=Eee,QTe=YTe;function eEe(e){return JTe(e)?QTe(e):KTe(e)}var tEe=eEe,rEe=ETe,nEe=Eee,iEe=tEe,oEe=vee;function aEe(e){return function(t){t=oEe(t);var r=nEe(t)?iEe(t):void 0,n=r?r[0]:t.charAt(0),a=r?rEe(r,1).join(""):t.slice(1);return n[e]()+a}}var sEe=aEe,lEe=sEe,cEe=lEe("toUpperCase"),uEe=cEe;const Pk=hi(uEe);function Qi(e){return function(){return e}}const kee=Math.cos,lI=Math.sin,zu=Math.sqrt,cI=Math.PI,Ik=2*cI,oj=Math.PI,aj=2*oj,Mg=1e-6,dEe=aj-Mg;function Ree(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function hEe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Ree;const r=10**t;return function(n){this._+=n[0];for(let a=1,l=n.length;a<l;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class fEe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Ree:hEe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,l,f){this._append`C${+t},${+r},${+n},${+a},${this._x1=+l},${this._y1=+f}`}arcTo(t,r,n,a,l){if(t=+t,r=+r,n=+n,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let f=this._x1,i=this._y1,_=n-t,b=a-r,E=f-t,C=i-r,R=E*E+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(R>Mg)if(!(Math.abs(C*_-b*E)>Mg)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let F=n-f,U=a-i,$=_*_+b*b,H=F*F+U*U,q=Math.sqrt($),G=Math.sqrt(R),J=l*Math.tan((oj-Math.acos(($+R-H)/(2*q*G)))/2),te=J/G,oe=J/q;Math.abs(te-1)>Mg&&this._append`L${t+te*E},${r+te*C}`,this._append`A${l},${l},0,0,${+(C*F>E*U)},${this._x1=t+oe*_},${this._y1=r+oe*b}`}}arc(t,r,n,a,l,f){if(t=+t,r=+r,n=+n,f=!!f,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),_=n*Math.sin(a),b=t+i,E=r+_,C=1^f,R=f?a-l:l-a;this._x1===null?this._append`M${b},${E}`:(Math.abs(this._x1-b)>Mg||Math.abs(this._y1-E)>Mg)&&this._append`L${b},${E}`,n&&(R<0&&(R=R%aj+aj),R>dEe?this._append`A${n},${n},0,1,${C},${t-i},${r-_}A${n},${n},0,1,${C},${this._x1=b},${this._y1=E}`:R>Mg&&this._append`A${n},${n},0,${+(R>=oj)},${C},${this._x1=t+n*Math.cos(l)},${this._y1=r+n*Math.sin(l)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function h5(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new fEe(t)}function f5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Dee(e){this._context=e}Dee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ok(e){return new Dee(e)}function Lee(e){return e[0]}function Nee(e){return e[1]}function zee(e,t){var r=Qi(!0),n=null,a=Ok,l=null,f=h5(i);e=typeof e=="function"?e:e===void 0?Lee:Qi(e),t=typeof t=="function"?t:t===void 0?Nee:Qi(t);function i(_){var b,E=(_=f5(_)).length,C,R=!1,F;for(n==null&&(l=a(F=f())),b=0;b<=E;++b)!(b<E&&r(C=_[b],b,_))===R&&((R=!R)?l.lineStart():l.lineEnd()),R&&l.point(+e(C,b,_),+t(C,b,_));if(F)return l=null,F+""||null}return i.x=function(_){return arguments.length?(e=typeof _=="function"?_:Qi(+_),i):e},i.y=function(_){return arguments.length?(t=typeof _=="function"?_:Qi(+_),i):t},i.defined=function(_){return arguments.length?(r=typeof _=="function"?_:Qi(!!_),i):r},i.curve=function(_){return arguments.length?(a=_,n!=null&&(l=a(n)),i):a},i.context=function(_){return arguments.length?(_==null?n=l=null:l=a(n=_),i):n},i}function rM(e,t,r){var n=null,a=Qi(!0),l=null,f=Ok,i=null,_=h5(b);e=typeof e=="function"?e:e===void 0?Lee:Qi(+e),t=typeof t=="function"?t:Qi(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Nee:Qi(+r);function b(C){var R,F,U,$=(C=f5(C)).length,H,q=!1,G,J=new Array($),te=new Array($);for(l==null&&(i=f(G=_())),R=0;R<=$;++R){if(!(R<$&&a(H=C[R],R,C))===q)if(q=!q)F=R,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),U=R-1;U>=F;--U)i.point(J[U],te[U]);i.lineEnd(),i.areaEnd()}q&&(J[R]=+e(H,R,C),te[R]=+t(H,R,C),i.point(n?+n(H,R,C):J[R],r?+r(H,R,C):te[R]))}if(G)return i=null,G+""||null}function E(){return zee().defined(a).curve(f).context(l)}return b.x=function(C){return arguments.length?(e=typeof C=="function"?C:Qi(+C),n=null,b):e},b.x0=function(C){return arguments.length?(e=typeof C=="function"?C:Qi(+C),b):e},b.x1=function(C){return arguments.length?(n=C==null?null:typeof C=="function"?C:Qi(+C),b):n},b.y=function(C){return arguments.length?(t=typeof C=="function"?C:Qi(+C),r=null,b):t},b.y0=function(C){return arguments.length?(t=typeof C=="function"?C:Qi(+C),b):t},b.y1=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:Qi(+C),b):r},b.lineX0=b.lineY0=function(){return E().x(e).y(t)},b.lineY1=function(){return E().x(e).y(r)},b.lineX1=function(){return E().x(n).y(t)},b.defined=function(C){return arguments.length?(a=typeof C=="function"?C:Qi(!!C),b):a},b.curve=function(C){return arguments.length?(f=C,l!=null&&(i=f(l)),b):f},b.context=function(C){return arguments.length?(C==null?l=i=null:i=f(l=C),b):l},b}class jee{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function pEe(e){return new jee(e,!0)}function mEe(e){return new jee(e,!1)}const p5={draw(e,t){const r=zu(t/cI);e.moveTo(r,0),e.arc(0,0,r,0,Ik)}},gEe={draw(e,t){const r=zu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Fee=zu(1/3),yEe=Fee*2,vEe={draw(e,t){const r=zu(t/yEe),n=r*Fee;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},_Ee={draw(e,t){const r=zu(t),n=-r/2;e.rect(n,n,r,r)}},xEe=.8908130915292852,Bee=lI(cI/10)/lI(7*cI/10),bEe=lI(Ik/10)*Bee,wEe=-kee(Ik/10)*Bee,SEe={draw(e,t){const r=zu(t*xEe),n=bEe*r,a=wEe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let l=1;l<5;++l){const f=Ik*l/5,i=kee(f),_=lI(f);e.lineTo(_*r,-i*r),e.lineTo(i*n-_*a,_*n+i*a)}e.closePath()}},w3=zu(3),TEe={draw(e,t){const r=-zu(t/(w3*3));e.moveTo(0,r*2),e.lineTo(-w3*r,-r),e.lineTo(w3*r,-r),e.closePath()}},uc=-.5,dc=zu(3)/2,sj=1/zu(12),EEe=(sj/2+1)*3,AEe={draw(e,t){const r=zu(t/EEe),n=r/2,a=r*sj,l=n,f=r*sj+r,i=-l,_=f;e.moveTo(n,a),e.lineTo(l,f),e.lineTo(i,_),e.lineTo(uc*n-dc*a,dc*n+uc*a),e.lineTo(uc*l-dc*f,dc*l+uc*f),e.lineTo(uc*i-dc*_,dc*i+uc*_),e.lineTo(uc*n+dc*a,uc*a-dc*n),e.lineTo(uc*l+dc*f,uc*f-dc*l),e.lineTo(uc*i+dc*_,uc*_-dc*i),e.closePath()}};function MEe(e,t){let r=null,n=h5(a);e=typeof e=="function"?e:Qi(e||p5),t=typeof t=="function"?t:Qi(t===void 0?64:+t);function a(){let l;if(r||(r=l=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:Qi(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:Qi(+l),a):t},a.context=function(l){return arguments.length?(r=l??null,a):r},a}function uI(){}function dI(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function $ee(e){this._context=e}$ee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:dI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:dI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CEe(e){return new $ee(e)}function Uee(e){this._context=e}Uee.prototype={areaStart:uI,areaEnd:uI,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:dI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PEe(e){return new Uee(e)}function Vee(e){this._context=e}Vee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:dI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function IEe(e){return new Vee(e)}function Wee(e){this._context=e}Wee.prototype={areaStart:uI,areaEnd:uI,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function OEe(e){return new Wee(e)}function Lq(e){return e<0?-1:1}function Nq(e,t,r){var n=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(n||a<0&&-0),f=(r-e._y1)/(a||n<0&&-0),i=(l*a+f*n)/(n+a);return(Lq(l)+Lq(f))*Math.min(Math.abs(l),Math.abs(f),.5*Math.abs(i))||0}function zq(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function S3(e,t,r){var n=e._x0,a=e._y0,l=e._x1,f=e._y1,i=(l-n)/3;e._context.bezierCurveTo(n+i,a+i*t,l-i,f-i*r,l,f)}function hI(e){this._context=e}hI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:S3(this,this._t0,zq(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,S3(this,zq(this,r=Nq(this,e,t)),r);break;default:S3(this,this._t0,r=Nq(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Gee(e){this._context=new qee(e)}(Gee.prototype=Object.create(hI.prototype)).point=function(e,t){hI.prototype.point.call(this,t,e)};function qee(e){this._context=e}qee.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,l){this._context.bezierCurveTo(t,e,n,r,l,a)}};function kEe(e){return new hI(e)}function REe(e){return new Gee(e)}function Hee(e){this._context=e}Hee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=jq(e),a=jq(t),l=0,f=1;f<r;++l,++f)this._context.bezierCurveTo(n[0][l],a[0][l],n[1][l],a[1][l],e[f],t[f]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function jq(e){var t,r=e.length-1,n,a=new Array(r),l=new Array(r),f=new Array(r);for(a[0]=0,l[0]=2,f[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,l[t]=4,f[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,l[r-1]=7,f[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/l[t-1],l[t]-=n,f[t]-=n*f[t-1];for(a[r-1]=f[r-1]/l[r-1],t=r-2;t>=0;--t)a[t]=(f[t]-a[t+1])/l[t];for(l[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function DEe(e){return new Hee(e)}function kk(e,t){this._context=e,this._t=t}kk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function LEe(e){return new kk(e,.5)}function NEe(e){return new kk(e,0)}function zEe(e){return new kk(e,1)}function G0(e,t){if((f=e.length)>1)for(var r=1,n,a,l=e[t[0]],f,i=l.length;r<f;++r)for(a=l,l=e[t[r]],n=0;n<i;++n)l[n][1]+=l[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function lj(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function jEe(e,t){return e[t]}function FEe(e){const t=[];return t.key=e,t}function BEe(){var e=Qi([]),t=lj,r=G0,n=jEe;function a(l){var f=Array.from(e.apply(this,arguments),FEe),i,_=f.length,b=-1,E;for(const C of l)for(i=0,++b;i<_;++i)(f[i][b]=[0,+n(C,f[i].key,b,l)]).data=C;for(i=0,E=f5(t(f));i<_;++i)f[E[i]].index=i;return r(f,E),f}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:Qi(Array.from(l)),a):e},a.value=function(l){return arguments.length?(n=typeof l=="function"?l:Qi(+l),a):n},a.order=function(l){return arguments.length?(t=l==null?lj:typeof l=="function"?l:Qi(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(r=l??G0,a):r},a}function $Ee(e,t){if((n=e.length)>0){for(var r,n,a=0,l=e[0].length,f;a<l;++a){for(f=r=0;r<n;++r)f+=e[r][a][1]||0;if(f)for(r=0;r<n;++r)e[r][a][1]/=f}G0(e,t)}}function UEe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,l=n.length;r<l;++r){for(var f=0,i=0;f<a;++f)i+=e[f][r][1]||0;n[r][1]+=n[r][0]=-i/2}G0(e,t)}}function VEe(e,t){if(!(!((f=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,l,f;n<l;++n){for(var i=0,_=0,b=0;i<f;++i){for(var E=e[t[i]],C=E[n][1]||0,R=E[n-1][1]||0,F=(C-R)/2,U=0;U<i;++U){var $=e[t[U]],H=$[n][1]||0,q=$[n-1][1]||0;F+=H-q}_+=C,b+=F*C}a[n-1][1]+=a[n-1][0]=r,_&&(r-=b/_)}a[n-1][1]+=a[n-1][0]=r,G0(e,t)}}function nT(e){"@babel/helpers - typeof";return nT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nT(e)}var WEe=["type","size","sizeType"];function cj(){return cj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cj.apply(this,arguments)}function Fq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fq(Object(r),!0).forEach(function(n){GEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GEe(e,t,r){return t=qEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qEe(e){var t=HEe(e,"string");return nT(t)=="symbol"?t:t+""}function HEe(e,t){if(nT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZEe(e,t){if(e==null)return{};var r=XEe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Zee={symbolCircle:p5,symbolCross:gEe,symbolDiamond:vEe,symbolSquare:_Ee,symbolStar:SEe,symbolTriangle:TEe,symbolWye:AEe},YEe=Math.PI/180,KEe=function(t){var r="symbol".concat(Pk(t));return Zee[r]||p5},JEe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*YEe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},QEe=function(t,r){Zee["symbol".concat(Pk(t))]=r},m5=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,l=a===void 0?64:a,f=t.sizeType,i=f===void 0?"area":f,_=ZEe(t,WEe),b=Bq(Bq({},_),{},{type:n,size:l,sizeType:i}),E=function(){var H=KEe(n),q=MEe().type(H).size(JEe(l,i,n));return q()},C=b.className,R=b.cx,F=b.cy,U=Xn(b,!0);return R===+R&&F===+F&&l===+l?ze.createElement("path",cj({},U,{className:di("recharts-symbols",C),transform:"translate(".concat(R,", ").concat(F,")"),d:E()})):null};m5.registerSymbol=QEe;function q0(e){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}function uj(){return uj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uj.apply(this,arguments)}function $q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$q(Object(r),!0).forEach(function(n){iT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function t2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yee(n.key),n)}}function n2e(e,t,r){return t&&r2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function i2e(e,t,r){return t=fI(t),o2e(e,Xee()?Reflect.construct(t,r||[],fI(e).constructor):t.apply(e,r))}function o2e(e,t){if(t&&(q0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a2e(e)}function a2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xee=function(){return!!e})()}function fI(e){return fI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fI(e)}function s2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dj(e,t)}function dj(e,t){return dj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},dj(e,t)}function iT(e,t,r){return t=Yee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yee(e){var t=l2e(e,"string");return q0(t)=="symbol"?t:t+""}function l2e(e,t){if(q0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hc=32,g5=function(e){function t(){return t2e(this,t),i2e(this,t,arguments)}return s2e(t,e),n2e(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,l=hc/2,f=hc/6,i=hc/3,_=n.inactive?a:n.color;if(n.type==="plainline")return ze.createElement("line",{strokeWidth:4,fill:"none",stroke:_,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:l,x2:hc,y2:l,className:"recharts-legend-icon"});if(n.type==="line")return ze.createElement("path",{strokeWidth:4,fill:"none",stroke:_,d:"M0,".concat(l,"h").concat(i,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(2*i,",").concat(l,`
            H`).concat(hc,"M").concat(2*i,",").concat(l,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(i,",").concat(l),className:"recharts-legend-icon"});if(n.type==="rect")return ze.createElement("path",{stroke:"none",fill:_,d:"M0,".concat(hc/8,"h").concat(hc,"v").concat(hc*3/4,"h").concat(-hc,"z"),className:"recharts-legend-icon"});if(ze.isValidElement(n.legendIcon)){var b=e2e({},n);return delete b.legendIcon,ze.cloneElement(n.legendIcon,b)}return ze.createElement(m5,{fill:_,cx:l,cy:l,size:hc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,l=a.payload,f=a.iconSize,i=a.layout,_=a.formatter,b=a.inactiveColor,E={x:0,y:0,width:hc,height:hc},C={display:i==="horizontal"?"inline-block":"block",marginRight:10},R={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(F,U){var $=F.formatter||_,H=di(iT(iT({"recharts-legend-item":!0},"legend-item-".concat(U),!0),"inactive",F.inactive));if(F.type==="none")return null;var q=Vn(F.value)?null:F.value;Oh(!Vn(F.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var G=F.inactive?b:F.color;return ze.createElement("li",uj({className:H,style:C,key:"legend-item-".concat(U)},sI(n.props,F,U)),ze.createElement(tj,{width:f,height:f,viewBox:E,style:R},n.renderIcon(F)),ze.createElement("span",{className:"recharts-legend-item-text",style:{color:G}},$?$(q,F,U):q))})}},{key:"render",value:function(){var n=this.props,a=n.payload,l=n.layout,f=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:l==="horizontal"?f:"left"};return ze.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(ne.PureComponent);iT(g5,"displayName","Legend");iT(g5,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var c2e=gk;function u2e(){this.__data__=new c2e,this.size=0}var d2e=u2e;function h2e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var f2e=h2e;function p2e(e){return this.__data__.get(e)}var m2e=p2e;function g2e(e){return this.__data__.has(e)}var y2e=g2e,v2e=gk,_2e=n5,x2e=i5,b2e=200;function w2e(e,t){var r=this.__data__;if(r instanceof v2e){var n=r.__data__;if(!_2e||n.length<b2e-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new x2e(n)}return r.set(e,t),this.size=r.size,this}var S2e=w2e,T2e=gk,E2e=d2e,A2e=f2e,M2e=m2e,C2e=y2e,P2e=S2e;function Gx(e){var t=this.__data__=new T2e(e);this.size=t.size}Gx.prototype.clear=E2e;Gx.prototype.delete=A2e;Gx.prototype.get=M2e;Gx.prototype.has=C2e;Gx.prototype.set=P2e;var Kee=Gx,I2e="__lodash_hash_undefined__";function O2e(e){return this.__data__.set(e,I2e),this}var k2e=O2e;function R2e(e){return this.__data__.has(e)}var D2e=R2e,L2e=i5,N2e=k2e,z2e=D2e;function pI(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new L2e;++t<r;)this.add(e[t])}pI.prototype.add=pI.prototype.push=N2e;pI.prototype.has=z2e;var Jee=pI;function j2e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Qee=j2e;function F2e(e,t){return e.has(t)}var ete=F2e,B2e=Jee,$2e=Qee,U2e=ete,V2e=1,W2e=2;function G2e(e,t,r,n,a,l){var f=r&V2e,i=e.length,_=t.length;if(i!=_&&!(f&&_>i))return!1;var b=l.get(e),E=l.get(t);if(b&&E)return b==t&&E==e;var C=-1,R=!0,F=r&W2e?new B2e:void 0;for(l.set(e,t),l.set(t,e);++C<i;){var U=e[C],$=t[C];if(n)var H=f?n($,U,C,t,e,l):n(U,$,C,e,t,l);if(H!==void 0){if(H)continue;R=!1;break}if(F){if(!$2e(t,function(q,G){if(!U2e(F,G)&&(U===q||a(U,q,r,n,l)))return F.push(G)})){R=!1;break}}else if(!(U===$||a(U,$,r,n,l))){R=!1;break}}return l.delete(e),l.delete(t),R}var tte=G2e,q2e=Ud,H2e=q2e.Uint8Array,Z2e=H2e;function X2e(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var Y2e=X2e;function K2e(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var y5=K2e,Uq=vE,Vq=Z2e,J2e=r5,Q2e=tte,eAe=Y2e,tAe=y5,rAe=1,nAe=2,iAe="[object Boolean]",oAe="[object Date]",aAe="[object Error]",sAe="[object Map]",lAe="[object Number]",cAe="[object RegExp]",uAe="[object Set]",dAe="[object String]",hAe="[object Symbol]",fAe="[object ArrayBuffer]",pAe="[object DataView]",Wq=Uq?Uq.prototype:void 0,T3=Wq?Wq.valueOf:void 0;function mAe(e,t,r,n,a,l,f){switch(r){case pAe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case fAe:return!(e.byteLength!=t.byteLength||!l(new Vq(e),new Vq(t)));case iAe:case oAe:case lAe:return J2e(+e,+t);case aAe:return e.name==t.name&&e.message==t.message;case cAe:case dAe:return e==t+"";case sAe:var i=eAe;case uAe:var _=n&rAe;if(i||(i=tAe),e.size!=t.size&&!_)return!1;var b=f.get(e);if(b)return b==t;n|=nAe,f.set(e,t);var E=Q2e(i(e),i(t),n,a,l,f);return f.delete(e),E;case hAe:if(T3)return T3.call(e)==T3.call(t)}return!1}var gAe=mAe;function yAe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var rte=yAe,vAe=rte,_Ae=gl;function xAe(e,t,r){var n=t(e);return _Ae(e)?n:vAe(n,r(e))}var bAe=xAe;function wAe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,l=[];++r<n;){var f=e[r];t(f,r,e)&&(l[a++]=f)}return l}var SAe=wAe;function TAe(){return[]}var EAe=TAe,AAe=SAe,MAe=EAe,CAe=Object.prototype,PAe=CAe.propertyIsEnumerable,Gq=Object.getOwnPropertySymbols,IAe=Gq?function(e){return e==null?[]:(e=Object(e),AAe(Gq(e),function(t){return PAe.call(e,t)}))}:MAe,OAe=IAe;function kAe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var RAe=kAe,DAe=Kh,LAe=Jh,NAe="[object Arguments]";function zAe(e){return LAe(e)&&DAe(e)==NAe}var jAe=zAe,qq=jAe,FAe=Jh,nte=Object.prototype,BAe=nte.hasOwnProperty,$Ae=nte.propertyIsEnumerable,UAe=qq(function(){return arguments}())?qq:function(e){return FAe(e)&&BAe.call(e,"callee")&&!$Ae.call(e,"callee")},v5=UAe,mI={exports:{}};function VAe(){return!1}var WAe=VAe;mI.exports;(function(e,t){var r=Ud,n=WAe,a=t&&!t.nodeType&&t,l=a&&!0&&e&&!e.nodeType&&e,f=l&&l.exports===a,i=f?r.Buffer:void 0,_=i?i.isBuffer:void 0,b=_||n;e.exports=b})(mI,mI.exports);var ite=mI.exports,GAe=9007199254740991,qAe=/^(?:0|[1-9]\d*)$/;function HAe(e,t){var r=typeof e;return t=t??GAe,!!t&&(r=="number"||r!="symbol"&&qAe.test(e))&&e>-1&&e%1==0&&e<t}var _5=HAe,ZAe=9007199254740991;function XAe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ZAe}var x5=XAe,YAe=Kh,KAe=x5,JAe=Jh,QAe="[object Arguments]",eMe="[object Array]",tMe="[object Boolean]",rMe="[object Date]",nMe="[object Error]",iMe="[object Function]",oMe="[object Map]",aMe="[object Number]",sMe="[object Object]",lMe="[object RegExp]",cMe="[object Set]",uMe="[object String]",dMe="[object WeakMap]",hMe="[object ArrayBuffer]",fMe="[object DataView]",pMe="[object Float32Array]",mMe="[object Float64Array]",gMe="[object Int8Array]",yMe="[object Int16Array]",vMe="[object Int32Array]",_Me="[object Uint8Array]",xMe="[object Uint8ClampedArray]",bMe="[object Uint16Array]",wMe="[object Uint32Array]",lo={};lo[pMe]=lo[mMe]=lo[gMe]=lo[yMe]=lo[vMe]=lo[_Me]=lo[xMe]=lo[bMe]=lo[wMe]=!0;lo[QAe]=lo[eMe]=lo[hMe]=lo[tMe]=lo[fMe]=lo[rMe]=lo[nMe]=lo[iMe]=lo[oMe]=lo[aMe]=lo[sMe]=lo[lMe]=lo[cMe]=lo[uMe]=lo[dMe]=!1;function SMe(e){return JAe(e)&&KAe(e.length)&&!!lo[YAe(e)]}var TMe=SMe;function EMe(e){return function(t){return e(t)}}var ote=EMe,gI={exports:{}};gI.exports;(function(e,t){var r=hee,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,l=a&&a.exports===n,f=l&&r.process,i=function(){try{var _=a&&a.require&&a.require("util").types;return _||f&&f.binding&&f.binding("util")}catch{}}();e.exports=i})(gI,gI.exports);var AMe=gI.exports,MMe=TMe,CMe=ote,Hq=AMe,Zq=Hq&&Hq.isTypedArray,PMe=Zq?CMe(Zq):MMe,ate=PMe,IMe=RAe,OMe=v5,kMe=gl,RMe=ite,DMe=_5,LMe=ate,NMe=Object.prototype,zMe=NMe.hasOwnProperty;function jMe(e,t){var r=kMe(e),n=!r&&OMe(e),a=!r&&!n&&RMe(e),l=!r&&!n&&!a&&LMe(e),f=r||n||a||l,i=f?IMe(e.length,String):[],_=i.length;for(var b in e)(t||zMe.call(e,b))&&!(f&&(b=="length"||a&&(b=="offset"||b=="parent")||l&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||DMe(b,_)))&&i.push(b);return i}var FMe=jMe,BMe=Object.prototype;function $Me(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||BMe;return e===r}var UMe=$Me;function VMe(e,t){return function(r){return e(t(r))}}var ste=VMe,WMe=ste,GMe=WMe(Object.keys,Object),qMe=GMe,HMe=UMe,ZMe=qMe,XMe=Object.prototype,YMe=XMe.hasOwnProperty;function KMe(e){if(!HMe(e))return ZMe(e);var t=[];for(var r in Object(e))YMe.call(e,r)&&r!="constructor"&&t.push(r);return t}var JMe=KMe,QMe=t5,eCe=x5;function tCe(e){return e!=null&&eCe(e.length)&&!QMe(e)}var bE=tCe,rCe=FMe,nCe=JMe,iCe=bE;function oCe(e){return iCe(e)?rCe(e):nCe(e)}var Rk=oCe,aCe=bAe,sCe=OAe,lCe=Rk;function cCe(e){return aCe(e,lCe,sCe)}var uCe=cCe,Xq=uCe,dCe=1,hCe=Object.prototype,fCe=hCe.hasOwnProperty;function pCe(e,t,r,n,a,l){var f=r&dCe,i=Xq(e),_=i.length,b=Xq(t),E=b.length;if(_!=E&&!f)return!1;for(var C=_;C--;){var R=i[C];if(!(f?R in t:fCe.call(t,R)))return!1}var F=l.get(e),U=l.get(t);if(F&&U)return F==t&&U==e;var $=!0;l.set(e,t),l.set(t,e);for(var H=f;++C<_;){R=i[C];var q=e[R],G=t[R];if(n)var J=f?n(G,q,R,t,e,l):n(q,G,R,e,t,l);if(!(J===void 0?q===G||a(q,G,r,n,l):J)){$=!1;break}H||(H=R=="constructor")}if($&&!H){var te=e.constructor,oe=t.constructor;te!=oe&&"constructor"in e&&"constructor"in t&&!(typeof te=="function"&&te instanceof te&&typeof oe=="function"&&oe instanceof oe)&&($=!1)}return l.delete(e),l.delete(t),$}var mCe=pCe,gCe=jy,yCe=Ud,vCe=gCe(yCe,"DataView"),_Ce=vCe,xCe=jy,bCe=Ud,wCe=xCe(bCe,"Promise"),SCe=wCe,TCe=jy,ECe=Ud,ACe=TCe(ECe,"Set"),lte=ACe,MCe=jy,CCe=Ud,PCe=MCe(CCe,"WeakMap"),ICe=PCe,hj=_Ce,fj=n5,pj=SCe,mj=lte,gj=ICe,cte=Kh,qx=pee,Yq="[object Map]",OCe="[object Object]",Kq="[object Promise]",Jq="[object Set]",Qq="[object WeakMap]",eH="[object DataView]",kCe=qx(hj),RCe=qx(fj),DCe=qx(pj),LCe=qx(mj),NCe=qx(gj),Cg=cte;(hj&&Cg(new hj(new ArrayBuffer(1)))!=eH||fj&&Cg(new fj)!=Yq||pj&&Cg(pj.resolve())!=Kq||mj&&Cg(new mj)!=Jq||gj&&Cg(new gj)!=Qq)&&(Cg=function(e){var t=cte(e),r=t==OCe?e.constructor:void 0,n=r?qx(r):"";if(n)switch(n){case kCe:return eH;case RCe:return Yq;case DCe:return Kq;case LCe:return Jq;case NCe:return Qq}return t});var zCe=Cg,E3=Kee,jCe=tte,FCe=gAe,BCe=mCe,tH=zCe,rH=gl,nH=ite,$Ce=ate,UCe=1,iH="[object Arguments]",oH="[object Array]",nM="[object Object]",VCe=Object.prototype,aH=VCe.hasOwnProperty;function WCe(e,t,r,n,a,l){var f=rH(e),i=rH(t),_=f?oH:tH(e),b=i?oH:tH(t);_=_==iH?nM:_,b=b==iH?nM:b;var E=_==nM,C=b==nM,R=_==b;if(R&&nH(e)){if(!nH(t))return!1;f=!0,E=!1}if(R&&!E)return l||(l=new E3),f||$Ce(e)?jCe(e,t,r,n,a,l):FCe(e,t,_,r,n,a,l);if(!(r&UCe)){var F=E&&aH.call(e,"__wrapped__"),U=C&&aH.call(t,"__wrapped__");if(F||U){var $=F?e.value():e,H=U?t.value():t;return l||(l=new E3),a($,H,r,n,l)}}return R?(l||(l=new E3),BCe(e,t,r,n,a,l)):!1}var GCe=WCe,qCe=GCe,sH=Jh;function ute(e,t,r,n,a){return e===t?!0:e==null||t==null||!sH(e)&&!sH(t)?e!==e&&t!==t:qCe(e,t,r,n,ute,a)}var b5=ute,HCe=Kee,ZCe=b5,XCe=1,YCe=2;function KCe(e,t,r,n){var a=r.length,l=a,f=!n;if(e==null)return!l;for(e=Object(e);a--;){var i=r[a];if(f&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++a<l;){i=r[a];var _=i[0],b=e[_],E=i[1];if(f&&i[2]){if(b===void 0&&!(_ in e))return!1}else{var C=new HCe;if(n)var R=n(b,E,_,e,t,C);if(!(R===void 0?ZCe(E,b,XCe|YCe,n,C):R))return!1}}return!0}var JCe=KCe,QCe=vm;function ePe(e){return e===e&&!QCe(e)}var dte=ePe,tPe=dte,rPe=Rk;function nPe(e){for(var t=rPe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,tPe(a)]}return t}var iPe=nPe;function oPe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var hte=oPe,aPe=JCe,sPe=iPe,lPe=hte;function cPe(e){var t=sPe(e);return t.length==1&&t[0][2]?lPe(t[0][0],t[0][1]):function(r){return r===e||aPe(r,e,t)}}var uPe=cPe;function dPe(e,t){return e!=null&&t in Object(e)}var hPe=dPe,fPe=_ee,pPe=v5,mPe=gl,gPe=_5,yPe=x5,vPe=vk;function _Pe(e,t,r){t=fPe(t,e);for(var n=-1,a=t.length,l=!1;++n<a;){var f=vPe(t[n]);if(!(l=e!=null&&r(e,f)))break;e=e[f]}return l||++n!=a?l:(a=e==null?0:e.length,!!a&&yPe(a)&&gPe(f,a)&&(mPe(e)||pPe(e)))}var xPe=_Pe,bPe=hPe,wPe=xPe;function SPe(e,t){return e!=null&&wPe(e,t,bPe)}var TPe=SPe,EPe=b5,APe=xee,MPe=TPe,CPe=e5,PPe=dte,IPe=hte,OPe=vk,kPe=1,RPe=2;function DPe(e,t){return CPe(e)&&PPe(t)?IPe(OPe(e),t):function(r){var n=APe(r,e);return n===void 0&&n===t?MPe(r,e):EPe(t,n,kPe|RPe)}}var LPe=DPe;function NPe(e){return e}var Hx=NPe;function zPe(e){return function(t){return t==null?void 0:t[e]}}var jPe=zPe,FPe=s5;function BPe(e){return function(t){return FPe(t,e)}}var $Pe=BPe,UPe=jPe,VPe=$Pe,WPe=e5,GPe=vk;function qPe(e){return WPe(e)?UPe(GPe(e)):VPe(e)}var HPe=qPe,ZPe=uPe,XPe=LPe,YPe=Hx,KPe=gl,JPe=HPe;function QPe(e){return typeof e=="function"?e:e==null?YPe:typeof e=="object"?KPe(e)?XPe(e[0],e[1]):ZPe(e):JPe(e)}var _m=QPe;function eIe(e,t,r,n){for(var a=e.length,l=r+(n?1:-1);n?l--:++l<a;)if(t(e[l],l,e))return l;return-1}var fte=eIe;function tIe(e){return e!==e}var rIe=tIe;function nIe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var iIe=nIe,oIe=fte,aIe=rIe,sIe=iIe;function lIe(e,t,r){return t===t?sIe(e,t,r):oIe(e,aIe,r)}var cIe=lIe,uIe=cIe;function dIe(e,t){var r=e==null?0:e.length;return!!r&&uIe(e,t,0)>-1}var hIe=dIe;function fIe(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var pIe=fIe;function mIe(){}var gIe=mIe,A3=lte,yIe=gIe,vIe=y5,_Ie=1/0,xIe=A3&&1/vIe(new A3([,-0]))[1]==_Ie?function(e){return new A3(e)}:yIe,bIe=xIe,wIe=Jee,SIe=hIe,TIe=pIe,EIe=ete,AIe=bIe,MIe=y5,CIe=200;function PIe(e,t,r){var n=-1,a=SIe,l=e.length,f=!0,i=[],_=i;if(r)f=!1,a=TIe;else if(l>=CIe){var b=t?null:AIe(e);if(b)return MIe(b);f=!1,a=EIe,_=new wIe}else _=t?[]:i;e:for(;++n<l;){var E=e[n],C=t?t(E):E;if(E=r||E!==0?E:0,f&&C===C){for(var R=_.length;R--;)if(_[R]===C)continue e;t&&_.push(C),i.push(E)}else a(_,C,r)||(_!==i&&_.push(C),i.push(E))}return i}var IIe=PIe,OIe=_m,kIe=IIe;function RIe(e,t){return e&&e.length?kIe(e,OIe(t)):[]}var DIe=RIe;const lH=hi(DIe);function pte(e,t,r){return t===!0?lH(e,r):Vn(t)?lH(e,t):e}function H0(e){"@babel/helpers - typeof";return H0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H0(e)}var LIe=["ref"];function cH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cH(Object(r),!0).forEach(function(n){Dk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gte(n.key),n)}}function zIe(e,t,r){return t&&uH(e.prototype,t),r&&uH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jIe(e,t,r){return t=yI(t),FIe(e,mte()?Reflect.construct(t,r||[],yI(e).constructor):t.apply(e,r))}function FIe(e,t){if(t&&(H0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BIe(e)}function BIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mte=function(){return!!e})()}function yI(e){return yI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yI(e)}function $Ie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yj(e,t)}function yj(e,t){return yj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},yj(e,t)}function Dk(e,t,r){return t=gte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gte(e){var t=UIe(e,"string");return H0(t)=="symbol"?t:t+""}function UIe(e,t){if(H0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VIe(e,t){if(e==null)return{};var r=WIe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function GIe(e){return e.value}function qIe(e,t){if(ze.isValidElement(e))return ze.cloneElement(e,t);if(typeof e=="function")return ze.createElement(e,t);t.ref;var r=VIe(t,LIe);return ze.createElement(g5,r)}var dH=1,oy=function(e){function t(){var r;NIe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=jIe(this,t,[].concat(a)),Dk(r,"lastBoundingBox",{width:-1,height:-1}),r}return $Ie(t,e),zIe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>dH||Math.abs(a.height-this.lastBoundingBox.height)>dH)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?sh({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,l=a.layout,f=a.align,i=a.verticalAlign,_=a.margin,b=a.chartWidth,E=a.chartHeight,C,R;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(f==="center"&&l==="vertical"){var F=this.getBBoxSnapshot();C={left:((b||0)-F.width)/2}}else C=f==="right"?{right:_&&_.right||0}:{left:_&&_.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var U=this.getBBoxSnapshot();R={top:((E||0)-U.height)/2}}else R=i==="bottom"?{bottom:_&&_.bottom||0}:{top:_&&_.top||0};return sh(sh({},C),R)}},{key:"render",value:function(){var n=this,a=this.props,l=a.content,f=a.width,i=a.height,_=a.wrapperStyle,b=a.payloadUniqBy,E=a.payload,C=sh(sh({position:"absolute",width:f||"auto",height:i||"auto"},this.getDefaultPosition(_)),_);return ze.createElement("div",{className:"recharts-legend-wrapper",style:C,ref:function(F){n.wrapperNode=F}},qIe(l,sh(sh({},this.props),{},{payload:pte(E,b,GIe)})))}}],[{key:"getWithHeight",value:function(n,a){var l=sh(sh({},this.defaultProps),n.props),f=l.layout;return f==="vertical"&&br(n.props.height)?{height:n.props.height}:f==="horizontal"?{width:n.props.width||a}:null}}])}(ne.PureComponent);Dk(oy,"displayName","Legend");Dk(oy,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var hH=vE,HIe=v5,ZIe=gl,fH=hH?hH.isConcatSpreadable:void 0;function XIe(e){return ZIe(e)||HIe(e)||!!(fH&&e&&e[fH])}var YIe=XIe,KIe=rte,JIe=YIe;function yte(e,t,r,n,a){var l=-1,f=e.length;for(r||(r=JIe),a||(a=[]);++l<f;){var i=e[l];t>0&&r(i)?t>1?yte(i,t-1,r,n,a):KIe(a,i):n||(a[a.length]=i)}return a}var vte=yte;function QIe(e){return function(t,r,n){for(var a=-1,l=Object(t),f=n(t),i=f.length;i--;){var _=f[e?i:++a];if(r(l[_],_,l)===!1)break}return t}}var eOe=QIe,tOe=eOe,rOe=tOe(),nOe=rOe,iOe=nOe,oOe=Rk;function aOe(e,t){return e&&iOe(e,t,oOe)}var _te=aOe,sOe=bE;function lOe(e,t){return function(r,n){if(r==null)return r;if(!sOe(r))return e(r,n);for(var a=r.length,l=t?a:-1,f=Object(r);(t?l--:++l<a)&&n(f[l],l,f)!==!1;);return r}}var cOe=lOe,uOe=_te,dOe=cOe,hOe=dOe(uOe),w5=hOe,fOe=w5,pOe=bE;function mOe(e,t){var r=-1,n=pOe(e)?Array(e.length):[];return fOe(e,function(a,l,f){n[++r]=t(a,l,f)}),n}var xte=mOe;function gOe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var yOe=gOe,pH=Fx;function vOe(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,l=pH(e),f=t!==void 0,i=t===null,_=t===t,b=pH(t);if(!i&&!b&&!l&&e>t||l&&f&&_&&!i&&!b||n&&f&&_||!r&&_||!a)return 1;if(!n&&!l&&!b&&e<t||b&&r&&a&&!n&&!l||i&&r&&a||!f&&a||!_)return-1}return 0}var _Oe=vOe,xOe=_Oe;function bOe(e,t,r){for(var n=-1,a=e.criteria,l=t.criteria,f=a.length,i=r.length;++n<f;){var _=xOe(a[n],l[n]);if(_){if(n>=i)return _;var b=r[n];return _*(b=="desc"?-1:1)}}return e.index-t.index}var wOe=bOe,M3=a5,SOe=s5,TOe=_m,EOe=xte,AOe=yOe,MOe=ote,COe=wOe,POe=Hx,IOe=gl;function OOe(e,t,r){t.length?t=M3(t,function(l){return IOe(l)?function(f){return SOe(f,l.length===1?l[0]:l)}:l}):t=[POe];var n=-1;t=M3(t,MOe(TOe));var a=EOe(e,function(l,f,i){var _=M3(t,function(b){return b(l)});return{criteria:_,index:++n,value:l}});return AOe(a,function(l,f){return COe(l,f,r)})}var kOe=OOe;function ROe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var DOe=ROe,LOe=DOe,mH=Math.max;function NOe(e,t,r){return t=mH(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,l=mH(n.length-t,0),f=Array(l);++a<l;)f[a]=n[t+a];a=-1;for(var i=Array(t+1);++a<t;)i[a]=n[a];return i[t]=r(f),LOe(e,this,i)}}var zOe=NOe;function jOe(e){return function(){return e}}var FOe=jOe,BOe=jy,$Oe=function(){try{var e=BOe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),bte=$Oe,UOe=FOe,gH=bte,VOe=Hx,WOe=gH?function(e,t){return gH(e,"toString",{configurable:!0,enumerable:!1,value:UOe(t),writable:!0})}:VOe,GOe=WOe,qOe=800,HOe=16,ZOe=Date.now;function XOe(e){var t=0,r=0;return function(){var n=ZOe(),a=HOe-(n-r);if(r=n,a>0){if(++t>=qOe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var YOe=XOe,KOe=GOe,JOe=YOe,QOe=JOe(KOe),eke=QOe,tke=Hx,rke=zOe,nke=eke;function ike(e,t){return nke(rke(e,t,tke),e+"")}var oke=ike,ake=r5,ske=bE,lke=_5,cke=vm;function uke(e,t,r){if(!cke(r))return!1;var n=typeof t;return(n=="number"?ske(r)&&lke(t,r.length):n=="string"&&t in r)?ake(r[t],e):!1}var Lk=uke,dke=vte,hke=kOe,fke=oke,yH=Lk,pke=fke(function(e,t){if(e==null)return[];var r=t.length;return r>1&&yH(e,t[0],t[1])?t=[]:r>2&&yH(t[0],t[1],t[2])&&(t=[t[0]]),hke(e,dke(t,1),[])}),mke=pke;const S5=hi(mke);function oT(e){"@babel/helpers - typeof";return oT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oT(e)}function vj(){return vj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vj.apply(this,arguments)}function gke(e,t){return xke(e)||_ke(e,t)||vke(e,t)||yke()}function yke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vke(e,t){if(e){if(typeof e=="string")return vH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vH(e,t)}}function vH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _ke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function xke(e){if(Array.isArray(e))return e}function _H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(r),!0).forEach(function(n){bke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_H(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bke(e,t,r){return t=wke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wke(e){var t=Ske(e,"string");return oT(t)=="symbol"?t:t+""}function Ske(e,t){if(oT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tke(e){return Array.isArray(e)&&ya(e[0])&&ya(e[1])?e.join(" ~ "):e}var Eke=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,l=a===void 0?{}:a,f=t.itemStyle,i=f===void 0?{}:f,_=t.labelStyle,b=_===void 0?{}:_,E=t.payload,C=t.formatter,R=t.itemSorter,F=t.wrapperClassName,U=t.labelClassName,$=t.label,H=t.labelFormatter,q=t.accessibilityLayer,G=q===void 0?!1:q,J=function(){if(E&&E.length){var $e={padding:0,margin:0},ot=(R?S5(E,R):E).map(function(Je,rt){if(Je.type==="none")return null;var st=C3({display:"block",paddingTop:4,paddingBottom:4,color:Je.color||"#000"},i),at=Je.formatter||C||Tke,Be=Je.value,ct=Je.name,jt=Be,Lt=ct;if(at&&jt!=null&&Lt!=null){var $t=at(Be,ct,Je,rt,E);if(Array.isArray($t)){var ut=gke($t,2);jt=ut[0],Lt=ut[1]}else jt=$t}return ze.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(rt),style:st},ya(Lt)?ze.createElement("span",{className:"recharts-tooltip-item-name"},Lt):null,ya(Lt)?ze.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,ze.createElement("span",{className:"recharts-tooltip-item-value"},jt),ze.createElement("span",{className:"recharts-tooltip-item-unit"},Je.unit||""))});return ze.createElement("ul",{className:"recharts-tooltip-item-list",style:$e},ot)}return null},te=C3({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),oe=C3({margin:0},b),he=!oi($),le=he?$:"",ve=di("recharts-default-tooltip",F),We=di("recharts-tooltip-label",U);he&&H&&E!==void 0&&E!==null&&(le=H($,E));var Ie=G?{role:"status","aria-live":"assertive"}:{};return ze.createElement("div",vj({className:ve,style:te},Ie),ze.createElement("p",{className:We,style:oe},ze.isValidElement(le)?le:"".concat(le)),J())};function aT(e){"@babel/helpers - typeof";return aT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aT(e)}function iM(e,t,r){return t=Ake(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ake(e){var t=Mke(e,"string");return aT(t)=="symbol"?t:t+""}function Mke(e,t){if(aT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(aT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uw="recharts-tooltip-wrapper",Cke={visibility:"hidden"};function Pke(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return di(uw,iM(iM(iM(iM({},"".concat(uw,"-right"),br(r)&&t&&br(t.x)&&r>=t.x),"".concat(uw,"-left"),br(r)&&t&&br(t.x)&&r<t.x),"".concat(uw,"-bottom"),br(n)&&t&&br(t.y)&&n>=t.y),"".concat(uw,"-top"),br(n)&&t&&br(t.y)&&n<t.y))}function xH(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,l=e.position,f=e.reverseDirection,i=e.tooltipDimension,_=e.viewBox,b=e.viewBoxDimension;if(l&&br(l[n]))return l[n];var E=r[n]-i-a,C=r[n]+a;if(t[n])return f[n]?E:C;if(f[n]){var R=E,F=_[n];return R<F?Math.max(C,_[n]):Math.max(E,_[n])}var U=C+i,$=_[n]+b;return U>$?Math.max(E,_[n]):Math.max(C,_[n])}function Ike(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Oke(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,l=e.reverseDirection,f=e.tooltipBox,i=e.useTranslate3d,_=e.viewBox,b,E,C;return f.height>0&&f.width>0&&r?(E=xH({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:f.width,viewBox:_,viewBoxDimension:_.width}),C=xH({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:f.height,viewBox:_,viewBoxDimension:_.height}),b=Ike({translateX:E,translateY:C,useTranslate3d:i})):b=Cke,{cssProperties:b,cssClasses:Pke({translateX:E,translateY:C,coordinate:r})}}function Z0(e){"@babel/helpers - typeof";return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}function bH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bH(Object(r),!0).forEach(function(n){xj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ste(n.key),n)}}function Dke(e,t,r){return t&&Rke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lke(e,t,r){return t=vI(t),Nke(e,wte()?Reflect.construct(t,r||[],vI(e).constructor):t.apply(e,r))}function Nke(e,t){if(t&&(Z0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zke(e)}function zke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wte=function(){return!!e})()}function vI(e){return vI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vI(e)}function jke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_j(e,t)}function _j(e,t){return _j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_j(e,t)}function xj(e,t,r){return t=Ste(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ste(e){var t=Fke(e,"string");return Z0(t)=="symbol"?t:t+""}function Fke(e,t){if(Z0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SH=1,Bke=function(e){function t(){var r;kke(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=Lke(this,t,[].concat(a)),xj(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),xj(r,"handleKeyDown",function(f){if(f.key==="Escape"){var i,_,b,E;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(_=r.props.coordinate)===null||_===void 0?void 0:_.x)!==null&&i!==void 0?i:0,y:(b=(E=r.props.coordinate)===null||E===void 0?void 0:E.y)!==null&&b!==void 0?b:0}})}}),r}return jke(t,e),Dke(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>SH||Math.abs(n.height-this.state.lastBoundingBox.height)>SH)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,l=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,b=a.children,E=a.coordinate,C=a.hasPayload,R=a.isAnimationActive,F=a.offset,U=a.position,$=a.reverseDirection,H=a.useTranslate3d,q=a.viewBox,G=a.wrapperStyle,J=Oke({allowEscapeViewBox:f,coordinate:E,offsetTopLeft:F,position:U,reverseDirection:$,tooltipBox:this.state.lastBoundingBox,useTranslate3d:H,viewBox:q}),te=J.cssClasses,oe=J.cssProperties,he=wH(wH({transition:R&&l?"transform ".concat(i,"ms ").concat(_):void 0},oe),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&C?"visible":"hidden",position:"absolute",top:0,left:0},G);return ze.createElement("div",{tabIndex:-1,className:te,style:he,ref:function(ve){n.wrapperNode=ve}},b)}}])}(ne.PureComponent),$ke=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},kh={isSsr:$ke(),get:function(t){return kh[t]},set:function(t,r){if(typeof t=="string")kh[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){kh[a]=t[a]})}}};function X0(e){"@babel/helpers - typeof";return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(e)}function TH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TH(Object(r),!0).forEach(function(n){T5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ete(n.key),n)}}function Wke(e,t,r){return t&&Vke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gke(e,t,r){return t=_I(t),qke(e,Tte()?Reflect.construct(t,r||[],_I(e).constructor):t.apply(e,r))}function qke(e,t){if(t&&(X0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hke(e)}function Hke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tte=function(){return!!e})()}function _I(e){return _I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_I(e)}function Zke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bj(e,t)}function bj(e,t){return bj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},bj(e,t)}function T5(e,t,r){return t=Ete(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ete(e){var t=Xke(e,"string");return X0(t)=="symbol"?t:t+""}function Xke(e,t){if(X0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yke(e){return e.dataKey}function Kke(e,t){return ze.isValidElement(e)?ze.cloneElement(e,t):typeof e=="function"?ze.createElement(e,t):ze.createElement(Eke,t)}var hu=function(e){function t(){return Uke(this,t),Gke(this,t,arguments)}return Zke(t,e),Wke(t,[{key:"render",value:function(){var n=this,a=this.props,l=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,b=a.content,E=a.coordinate,C=a.filterNull,R=a.isAnimationActive,F=a.offset,U=a.payload,$=a.payloadUniqBy,H=a.position,q=a.reverseDirection,G=a.useTranslate3d,J=a.viewBox,te=a.wrapperStyle,oe=U??[];C&&oe.length&&(oe=pte(U.filter(function(le){return le.value!=null&&(le.hide!==!0||n.props.includeHidden)}),$,Yke));var he=oe.length>0;return ze.createElement(Bke,{allowEscapeViewBox:f,animationDuration:i,animationEasing:_,isAnimationActive:R,active:l,coordinate:E,hasPayload:he,offset:F,position:H,reverseDirection:q,useTranslate3d:G,viewBox:J,wrapperStyle:te},Kke(b,EH(EH({},this.props),{},{payload:oe})))}}])}(ne.PureComponent);T5(hu,"displayName","Tooltip");T5(hu,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!kh.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Jke=Ud,Qke=function(){return Jke.Date.now()},eRe=Qke,tRe=/\s/;function rRe(e){for(var t=e.length;t--&&tRe.test(e.charAt(t)););return t}var nRe=rRe,iRe=nRe,oRe=/^\s+/;function aRe(e){return e&&e.slice(0,iRe(e)+1).replace(oRe,"")}var sRe=aRe,lRe=sRe,AH=vm,cRe=Fx,MH=NaN,uRe=/^[-+]0x[0-9a-f]+$/i,dRe=/^0b[01]+$/i,hRe=/^0o[0-7]+$/i,fRe=parseInt;function pRe(e){if(typeof e=="number")return e;if(cRe(e))return MH;if(AH(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=AH(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=lRe(e);var r=dRe.test(e);return r||hRe.test(e)?fRe(e.slice(2),r?2:8):uRe.test(e)?MH:+e}var Ate=pRe,mRe=vm,P3=eRe,CH=Ate,gRe="Expected a function",yRe=Math.max,vRe=Math.min;function _Re(e,t,r){var n,a,l,f,i,_,b=0,E=!1,C=!1,R=!0;if(typeof e!="function")throw new TypeError(gRe);t=CH(t)||0,mRe(r)&&(E=!!r.leading,C="maxWait"in r,l=C?yRe(CH(r.maxWait)||0,t):l,R="trailing"in r?!!r.trailing:R);function F(he){var le=n,ve=a;return n=a=void 0,b=he,f=e.apply(ve,le),f}function U(he){return b=he,i=setTimeout(q,t),E?F(he):f}function $(he){var le=he-_,ve=he-b,We=t-le;return C?vRe(We,l-ve):We}function H(he){var le=he-_,ve=he-b;return _===void 0||le>=t||le<0||C&&ve>=l}function q(){var he=P3();if(H(he))return G(he);i=setTimeout(q,$(he))}function G(he){return i=void 0,R&&n?F(he):(n=a=void 0,f)}function J(){i!==void 0&&clearTimeout(i),b=0,n=_=a=i=void 0}function te(){return i===void 0?f:G(P3())}function oe(){var he=P3(),le=H(he);if(n=arguments,a=this,_=he,le){if(i===void 0)return U(_);if(C)return clearTimeout(i),i=setTimeout(q,t),F(_)}return i===void 0&&(i=setTimeout(q,t)),f}return oe.cancel=J,oe.flush=te,oe}var xRe=_Re,bRe=xRe,wRe=vm,SRe="Expected a function";function TRe(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(SRe);return wRe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),bRe(e,t,{leading:n,maxWait:t,trailing:a})}var ERe=TRe;const Mte=hi(ERe);function sT(e){"@babel/helpers - typeof";return sT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sT(e)}function PH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PH(Object(r),!0).forEach(function(n){ARe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ARe(e,t,r){return t=MRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MRe(e){var t=CRe(e,"string");return sT(t)=="symbol"?t:t+""}function CRe(e,t){if(sT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PRe(e,t){return RRe(e)||kRe(e,t)||ORe(e,t)||IRe()}function IRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ORe(e,t){if(e){if(typeof e=="string")return IH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IH(e,t)}}function IH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function RRe(e){if(Array.isArray(e))return e}var OH=ne.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,l=e.width,f=l===void 0?"100%":l,i=e.height,_=i===void 0?"100%":i,b=e.minWidth,E=b===void 0?0:b,C=e.minHeight,R=e.maxHeight,F=e.children,U=e.debounce,$=U===void 0?0:U,H=e.id,q=e.className,G=e.onResize,J=e.style,te=J===void 0?{}:J,oe=ne.useRef(null),he=ne.useRef();he.current=G,ne.useImperativeHandle(t,function(){return Object.defineProperty(oe.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),oe.current},configurable:!0})});var le=ne.useState({containerWidth:a.width,containerHeight:a.height}),ve=PRe(le,2),We=ve[0],Ie=ve[1],Re=ne.useCallback(function(ot,Je){Ie(function(rt){var st=Math.round(ot),at=Math.round(Je);return rt.containerWidth===st&&rt.containerHeight===at?rt:{containerWidth:st,containerHeight:at}})},[]);ne.useEffect(function(){var ot=function(ct){var jt,Lt=ct[0].contentRect,$t=Lt.width,ut=Lt.height;Re($t,ut),(jt=he.current)===null||jt===void 0||jt.call(he,$t,ut)};$>0&&(ot=Mte(ot,$,{trailing:!0,leading:!1}));var Je=new ResizeObserver(ot),rt=oe.current.getBoundingClientRect(),st=rt.width,at=rt.height;return Re(st,at),Je.observe(oe.current),function(){Je.disconnect()}},[Re,$]);var $e=ne.useMemo(function(){var ot=We.containerWidth,Je=We.containerHeight;if(ot<0||Je<0)return null;Oh($g(f)||$g(_),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,f,_),Oh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var rt=$g(f)?ot:f,st=$g(_)?Je:_;r&&r>0&&(rt?st=rt/r:st&&(rt=st*r),R&&st>R&&(st=R)),Oh(rt>0||st>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,rt,st,f,_,E,C,r);var at=!Array.isArray(F)&&Ih(F.type).endsWith("Chart");return ze.Children.map(F,function(Be){return See.isElement(Be)?ne.cloneElement(Be,oM({width:rt,height:st},at?{style:oM({height:"100%",width:"100%",maxHeight:st,maxWidth:rt},Be.props.style)}:{})):Be})},[r,F,_,R,C,E,We,f]);return ze.createElement("div",{id:H?"".concat(H):void 0,className:di("recharts-responsive-container",q),style:oM(oM({},te),{},{width:f,height:_,minWidth:E,minHeight:C,maxHeight:R}),ref:oe},$e)}),Cte=function(t){return null};Cte.displayName="Cell";function lT(e){"@babel/helpers - typeof";return lT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lT(e)}function kH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kH(Object(r),!0).forEach(function(n){DRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DRe(e,t,r){return t=LRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LRe(e){var t=NRe(e,"string");return lT(t)=="symbol"?t:t+""}function NRe(e,t){if(lT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s_={widthCache:{},cacheCount:0},zRe=2e3,jRe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},RH="recharts_measurement_span";function FRe(e){var t=wj({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var bS=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||kh.isSsr)return{width:0,height:0};var n=FRe(r),a=JSON.stringify({text:t,copyStyle:n});if(s_.widthCache[a])return s_.widthCache[a];try{var l=document.getElementById(RH);l||(l=document.createElement("span"),l.setAttribute("id",RH),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var f=wj(wj({},jRe),n);Object.assign(l.style,f),l.textContent="".concat(t);var i=l.getBoundingClientRect(),_={width:i.width,height:i.height};return s_.widthCache[a]=_,++s_.cacheCount>zRe&&(s_.cacheCount=0,s_.widthCache={}),_}catch{return{width:0,height:0}}},BRe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function cT(e){"@babel/helpers - typeof";return cT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cT(e)}function xI(e,t){return WRe(e)||VRe(e,t)||URe(e,t)||$Re()}function $Re(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function URe(e,t){if(e){if(typeof e=="string")return DH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DH(e,t)}}function DH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function WRe(e){if(Array.isArray(e))return e}function GRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HRe(n.key),n)}}function qRe(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HRe(e){var t=ZRe(e,"string");return cT(t)=="symbol"?t:t+""}function ZRe(e,t){if(cT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var NH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,zH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XRe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,YRe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Pte={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},KRe=Object.keys(Pte),K_="NaN";function JRe(e,t){return e*Pte[t]}var aM=function(){function e(t,r){GRe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!XRe.test(r)&&(this.num=NaN,this.unit=""),KRe.includes(r)&&(this.num=JRe(t,r),this.unit="px")}return qRe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=YRe.exec(r))!==null&&n!==void 0?n:[],l=xI(a,3),f=l[1],i=l[2];return new e(parseFloat(f),i??"")}}])}();function Ite(e){if(e.includes(K_))return K_;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=NH.exec(t))!==null&&r!==void 0?r:[],a=xI(n,4),l=a[1],f=a[2],i=a[3],_=aM.parse(l??""),b=aM.parse(i??""),E=f==="*"?_.multiply(b):_.divide(b);if(E.isNaN())return K_;t=t.replace(NH,E.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var C,R=(C=zH.exec(t))!==null&&C!==void 0?C:[],F=xI(R,4),U=F[1],$=F[2],H=F[3],q=aM.parse(U??""),G=aM.parse(H??""),J=$==="+"?q.add(G):q.subtract(G);if(J.isNaN())return K_;t=t.replace(zH,J.toString())}return t}var jH=/\(([^()]*)\)/;function QRe(e){for(var t=e;t.includes("(");){var r=jH.exec(t),n=xI(r,2),a=n[1];t=t.replace(jH,Ite(a))}return t}function eDe(e){var t=e.replace(/\s+/g,"");return t=QRe(t),t=Ite(t),t}function tDe(e){try{return eDe(e)}catch{return K_}}function I3(e){var t=tDe(e.slice(5,-1));return t===K_?"":t}var rDe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],nDe=["dx","dy","angle","className","breakAll"];function Sj(){return Sj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sj.apply(this,arguments)}function FH(e,t){if(e==null)return{};var r=iDe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function BH(e,t){return lDe(e)||sDe(e,t)||aDe(e,t)||oDe()}function oDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aDe(e,t){if(e){if(typeof e=="string")return $H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $H(e,t)}}function $H(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function lDe(e){if(Array.isArray(e))return e}var Ote=/[ \f\n\r\t\v\u2028\u2029]+/,kte=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var l=[];oi(r)||(n?l=r.toString().split(""):l=r.toString().split(Ote));var f=l.map(function(_){return{word:_,width:bS(_,a).width}}),i=n?0:bS(" ",a).width;return{wordsWithComputedWidth:f,spaceWidth:i}}catch{return null}},cDe=function(t,r,n,a,l){var f=t.maxLines,i=t.children,_=t.style,b=t.breakAll,E=br(f),C=i,R=function(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return rt.reduce(function(st,at){var Be=at.word,ct=at.width,jt=st[st.length-1];if(jt&&(a==null||l||jt.width+ct+n<Number(a)))jt.words.push(Be),jt.width+=ct+n;else{var Lt={words:[Be],width:ct};st.push(Lt)}return st},[])},F=R(r),U=function(rt){return rt.reduce(function(st,at){return st.width>at.width?st:at})};if(!E)return F;for(var $="…",H=function(rt){var st=C.slice(0,rt),at=kte({breakAll:b,style:_,children:st+$}).wordsWithComputedWidth,Be=R(at),ct=Be.length>f||U(Be).width>Number(a);return[ct,Be]},q=0,G=C.length-1,J=0,te;q<=G&&J<=C.length-1;){var oe=Math.floor((q+G)/2),he=oe-1,le=H(he),ve=BH(le,2),We=ve[0],Ie=ve[1],Re=H(oe),$e=BH(Re,1),ot=$e[0];if(!We&&!ot&&(q=oe+1),We&&ot&&(G=oe-1),!We&&ot){te=Ie;break}J++}return te||F},UH=function(t){var r=oi(t)?[]:t.toString().split(Ote);return[{words:r}]},uDe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,l=t.style,f=t.breakAll,i=t.maxLines;if((r||n)&&!kh.isSsr){var _,b,E=kte({breakAll:f,children:a,style:l});if(E){var C=E.wordsWithComputedWidth,R=E.spaceWidth;_=C,b=R}else return UH(a);return cDe({breakAll:f,children:a,maxLines:i,style:l},_,b,r,n)}return UH(a)},VH="#808080",bI=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,f=t.lineHeight,i=f===void 0?"1em":f,_=t.capHeight,b=_===void 0?"0.71em":_,E=t.scaleToFit,C=E===void 0?!1:E,R=t.textAnchor,F=R===void 0?"start":R,U=t.verticalAnchor,$=U===void 0?"end":U,H=t.fill,q=H===void 0?VH:H,G=FH(t,rDe),J=ne.useMemo(function(){return uDe({breakAll:G.breakAll,children:G.children,maxLines:G.maxLines,scaleToFit:C,style:G.style,width:G.width})},[G.breakAll,G.children,G.maxLines,C,G.style,G.width]),te=G.dx,oe=G.dy,he=G.angle,le=G.className,ve=G.breakAll,We=FH(G,nDe);if(!ya(n)||!ya(l))return null;var Ie=n+(br(te)?te:0),Re=l+(br(oe)?oe:0),$e;switch($){case"start":$e=I3("calc(".concat(b,")"));break;case"middle":$e=I3("calc(".concat((J.length-1)/2," * -").concat(i," + (").concat(b," / 2))"));break;default:$e=I3("calc(".concat(J.length-1," * -").concat(i,")"));break}var ot=[];if(C){var Je=J[0].width,rt=G.width;ot.push("scale(".concat((br(rt)?rt/Je:1)/Je,")"))}return he&&ot.push("rotate(".concat(he,", ").concat(Ie,", ").concat(Re,")")),ot.length&&(We.transform=ot.join(" ")),ze.createElement("text",Sj({},Xn(We,!0),{x:Ie,y:Re,className:di("recharts-text",le),textAnchor:F,fill:q.includes("url")?VH:q}),J.map(function(st,at){var Be=st.words.join(ve?"":" ");return ze.createElement("tspan",{x:Ie,dy:at===0?$e:i,key:"".concat(Be,"-").concat(at)},Be)}))};function Xp(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function dDe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function E5(e){let t,r,n;e.length!==2?(t=Xp,r=(i,_)=>Xp(e(i),_),n=(i,_)=>e(i)-_):(t=e===Xp||e===dDe?e:hDe,r=e,n=e);function a(i,_,b=0,E=i.length){if(b<E){if(t(_,_)!==0)return E;do{const C=b+E>>>1;r(i[C],_)<0?b=C+1:E=C}while(b<E)}return b}function l(i,_,b=0,E=i.length){if(b<E){if(t(_,_)!==0)return E;do{const C=b+E>>>1;r(i[C],_)<=0?b=C+1:E=C}while(b<E)}return b}function f(i,_,b=0,E=i.length){const C=a(i,_,b,E-1);return C>b&&n(i[C-1],_)>-n(i[C],_)?C-1:C}return{left:a,center:f,right:l}}function hDe(){return 0}function Rte(e){return e===null?NaN:+e}function*fDe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const pDe=E5(Xp),wE=pDe.right;E5(Rte).center;class WH extends Map{constructor(t,r=yDe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(GH(this,t))}has(t){return super.has(GH(this,t))}set(t,r){return super.set(mDe(this,t),r)}delete(t){return super.delete(gDe(this,t))}}function GH({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function mDe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function gDe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function yDe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function vDe(e=Xp){if(e===Xp)return Dte;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function Dte(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const _De=Math.sqrt(50),xDe=Math.sqrt(10),bDe=Math.sqrt(2);function wI(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),l=n/Math.pow(10,a),f=l>=_De?10:l>=xDe?5:l>=bDe?2:1;let i,_,b;return a<0?(b=Math.pow(10,-a)/f,i=Math.round(e*b),_=Math.round(t*b),i/b<e&&++i,_/b>t&&--_,b=-b):(b=Math.pow(10,a)*f,i=Math.round(e/b),_=Math.round(t/b),i*b<e&&++i,_*b>t&&--_),_<i&&.5<=r&&r<2?wI(e,t,r*2):[i,_,b]}function Tj(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,l,f]=n?wI(t,e,r):wI(e,t,r);if(!(l>=a))return[];const i=l-a+1,_=new Array(i);if(n)if(f<0)for(let b=0;b<i;++b)_[b]=(l-b)/-f;else for(let b=0;b<i;++b)_[b]=(l-b)*f;else if(f<0)for(let b=0;b<i;++b)_[b]=(a+b)/-f;else for(let b=0;b<i;++b)_[b]=(a+b)*f;return _}function Ej(e,t,r){return t=+t,e=+e,r=+r,wI(e,t,r)[2]}function Aj(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Ej(t,e,r):Ej(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function qH(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function HH(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Lte(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?Dte:vDe(a);n>r;){if(n-r>600){const _=n-r+1,b=t-r+1,E=Math.log(_),C=.5*Math.exp(2*E/3),R=.5*Math.sqrt(E*C*(_-C)/_)*(b-_/2<0?-1:1),F=Math.max(r,Math.floor(t-b*C/_+R)),U=Math.min(n,Math.floor(t+(_-b)*C/_+R));Lte(e,t,F,U,a)}const l=e[t];let f=r,i=n;for(dw(e,r,t),a(e[n],l)>0&&dw(e,r,n);f<i;){for(dw(e,f,i),++f,--i;a(e[f],l)<0;)++f;for(;a(e[i],l)>0;)--i}a(e[r],l)===0?dw(e,r,i):(++i,dw(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function dw(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function wDe(e,t,r){if(e=Float64Array.from(fDe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return HH(e);if(t>=1)return qH(e);var n,a=(n-1)*t,l=Math.floor(a),f=qH(Lte(e,l).subarray(0,l+1)),i=HH(e.subarray(l+1));return f+(i-f)*(a-l)}}function SDe(e,t,r=Rte){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,l=Math.floor(a),f=+r(e[l],l,e),i=+r(e[l+1],l+1,e);return f+(i-f)*(a-l)}}function TDe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(a);++n<a;)l[n]=e+n*r;return l}function kc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Qh(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Mj=Symbol("implicit");function A5(){var e=new WH,t=[],r=[],n=Mj;function a(l){let f=e.get(l);if(f===void 0){if(n!==Mj)return n;e.set(l,f=t.push(l)-1)}return r[f%r.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new WH;for(const f of l)e.has(f)||e.set(f,t.push(f)-1);return a},a.range=function(l){return arguments.length?(r=Array.from(l),a):r.slice()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return A5(t,r).unknown(n)},kc.apply(a,arguments),a}function uT(){var e=A5().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,l,f,i=!1,_=0,b=0,E=.5;delete e.unknown;function C(){var R=t().length,F=a<n,U=F?a:n,$=F?n:a;l=($-U)/Math.max(1,R-_+b*2),i&&(l=Math.floor(l)),U+=($-U-l*(R-_))*E,f=l*(1-_),i&&(U=Math.round(U),f=Math.round(f));var H=TDe(R).map(function(q){return U+l*q});return r(F?H.reverse():H)}return e.domain=function(R){return arguments.length?(t(R),C()):t()},e.range=function(R){return arguments.length?([n,a]=R,n=+n,a=+a,C()):[n,a]},e.rangeRound=function(R){return[n,a]=R,n=+n,a=+a,i=!0,C()},e.bandwidth=function(){return f},e.step=function(){return l},e.round=function(R){return arguments.length?(i=!!R,C()):i},e.padding=function(R){return arguments.length?(_=Math.min(1,b=+R),C()):_},e.paddingInner=function(R){return arguments.length?(_=Math.min(1,R),C()):_},e.paddingOuter=function(R){return arguments.length?(b=+R,C()):b},e.align=function(R){return arguments.length?(E=Math.max(0,Math.min(1,R)),C()):E},e.copy=function(){return uT(t(),[n,a]).round(i).paddingInner(_).paddingOuter(b).align(E)},kc.apply(C(),arguments)}function Nte(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Nte(t())},e}function wS(){return Nte(uT.apply(null,arguments).paddingInner(1))}function M5(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function zte(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function SE(){}var dT=.7,SI=1/dT,p0="\\s*([+-]?\\d+)\\s*",hT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",EDe=/^#([0-9a-f]{3,8})$/,ADe=new RegExp(`^rgb\\(${p0},${p0},${p0}\\)$`),MDe=new RegExp(`^rgb\\(${Cd},${Cd},${Cd}\\)$`),CDe=new RegExp(`^rgba\\(${p0},${p0},${p0},${hT}\\)$`),PDe=new RegExp(`^rgba\\(${Cd},${Cd},${Cd},${hT}\\)$`),IDe=new RegExp(`^hsl\\(${hT},${Cd},${Cd}\\)$`),ODe=new RegExp(`^hsla\\(${hT},${Cd},${Cd},${hT}\\)$`),ZH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};M5(SE,fT,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:XH,formatHex:XH,formatHex8:kDe,formatHsl:RDe,formatRgb:YH,toString:YH});function XH(){return this.rgb().formatHex()}function kDe(){return this.rgb().formatHex8()}function RDe(){return jte(this).formatHsl()}function YH(){return this.rgb().formatRgb()}function fT(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=EDe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?KH(t):r===3?new sl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?sM(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?sM(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ADe.exec(e))?new sl(t[1],t[2],t[3],1):(t=MDe.exec(e))?new sl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=CDe.exec(e))?sM(t[1],t[2],t[3],t[4]):(t=PDe.exec(e))?sM(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=IDe.exec(e))?e7(t[1],t[2]/100,t[3]/100,1):(t=ODe.exec(e))?e7(t[1],t[2]/100,t[3]/100,t[4]):ZH.hasOwnProperty(e)?KH(ZH[e]):e==="transparent"?new sl(NaN,NaN,NaN,0):null}function KH(e){return new sl(e>>16&255,e>>8&255,e&255,1)}function sM(e,t,r,n){return n<=0&&(e=t=r=NaN),new sl(e,t,r,n)}function DDe(e){return e instanceof SE||(e=fT(e)),e?(e=e.rgb(),new sl(e.r,e.g,e.b,e.opacity)):new sl}function Cj(e,t,r,n){return arguments.length===1?DDe(e):new sl(e,t,r,n??1)}function sl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}M5(sl,Cj,zte(SE,{brighter(e){return e=e==null?SI:Math.pow(SI,e),new sl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?dT:Math.pow(dT,e),new sl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new sl(ay(this.r),ay(this.g),ay(this.b),TI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:JH,formatHex:JH,formatHex8:LDe,formatRgb:QH,toString:QH}));function JH(){return`#${Ug(this.r)}${Ug(this.g)}${Ug(this.b)}`}function LDe(){return`#${Ug(this.r)}${Ug(this.g)}${Ug(this.b)}${Ug((isNaN(this.opacity)?1:this.opacity)*255)}`}function QH(){const e=TI(this.opacity);return`${e===1?"rgb(":"rgba("}${ay(this.r)}, ${ay(this.g)}, ${ay(this.b)}${e===1?")":`, ${e})`}`}function TI(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ay(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ug(e){return e=ay(e),(e<16?"0":"")+e.toString(16)}function e7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new yu(e,t,r,n)}function jte(e){if(e instanceof yu)return new yu(e.h,e.s,e.l,e.opacity);if(e instanceof SE||(e=fT(e)),!e)return new yu;if(e instanceof yu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),l=Math.max(t,r,n),f=NaN,i=l-a,_=(l+a)/2;return i?(t===l?f=(r-n)/i+(r<n)*6:r===l?f=(n-t)/i+2:f=(t-r)/i+4,i/=_<.5?l+a:2-l-a,f*=60):i=_>0&&_<1?0:f,new yu(f,i,_,e.opacity)}function NDe(e,t,r,n){return arguments.length===1?jte(e):new yu(e,t,r,n??1)}function yu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}M5(yu,NDe,zte(SE,{brighter(e){return e=e==null?SI:Math.pow(SI,e),new yu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?dT:Math.pow(dT,e),new yu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new sl(O3(e>=240?e-240:e+120,a,n),O3(e,a,n),O3(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new yu(t7(this.h),lM(this.s),lM(this.l),TI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=TI(this.opacity);return`${e===1?"hsl(":"hsla("}${t7(this.h)}, ${lM(this.s)*100}%, ${lM(this.l)*100}%${e===1?")":`, ${e})`}`}}));function t7(e){return e=(e||0)%360,e<0?e+360:e}function lM(e){return Math.max(0,Math.min(1,e||0))}function O3(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const C5=e=>()=>e;function zDe(e,t){return function(r){return e+r*t}}function jDe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function FDe(e){return(e=+e)==1?Fte:function(t,r){return r-t?jDe(t,r,e):C5(isNaN(t)?r:t)}}function Fte(e,t){var r=t-e;return r?zDe(e,r):C5(isNaN(e)?t:e)}const r7=function e(t){var r=FDe(t);function n(a,l){var f=r((a=Cj(a)).r,(l=Cj(l)).r),i=r(a.g,l.g),_=r(a.b,l.b),b=Fte(a.opacity,l.opacity);return function(E){return a.r=f(E),a.g=i(E),a.b=_(E),a.opacity=b(E),a+""}}return n.gamma=e,n}(1);function BDe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(l){for(a=0;a<r;++a)n[a]=e[a]*(1-l)+t[a]*l;return n}}function $De(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function UDe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),l=new Array(r),f;for(f=0;f<n;++f)a[f]=Zx(e[f],t[f]);for(;f<r;++f)l[f]=t[f];return function(i){for(f=0;f<n;++f)l[f]=a[f](i);return l}}function VDe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function EI(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function WDe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Zx(e[a],t[a]):n[a]=t[a];return function(l){for(a in r)n[a]=r[a](l);return n}}var Pj=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,k3=new RegExp(Pj.source,"g");function GDe(e){return function(){return e}}function qDe(e){return function(t){return e(t)+""}}function HDe(e,t){var r=Pj.lastIndex=k3.lastIndex=0,n,a,l,f=-1,i=[],_=[];for(e=e+"",t=t+"";(n=Pj.exec(e))&&(a=k3.exec(t));)(l=a.index)>r&&(l=t.slice(r,l),i[f]?i[f]+=l:i[++f]=l),(n=n[0])===(a=a[0])?i[f]?i[f]+=a:i[++f]=a:(i[++f]=null,_.push({i:f,x:EI(n,a)})),r=k3.lastIndex;return r<t.length&&(l=t.slice(r),i[f]?i[f]+=l:i[++f]=l),i.length<2?_[0]?qDe(_[0].x):GDe(t):(t=_.length,function(b){for(var E=0,C;E<t;++E)i[(C=_[E]).i]=C.x(b);return i.join("")})}function Zx(e,t){var r=typeof t,n;return t==null||r==="boolean"?C5(t):(r==="number"?EI:r==="string"?(n=fT(t))?(t=n,r7):HDe:t instanceof fT?r7:t instanceof Date?VDe:$De(t)?BDe:Array.isArray(t)?UDe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?WDe:EI)(e,t)}function P5(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function ZDe(e,t){t===void 0&&(t=e,e=Zx);for(var r=0,n=t.length-1,a=t[0],l=new Array(n<0?0:n);r<n;)l[r]=e(a,a=t[++r]);return function(f){var i=Math.max(0,Math.min(n-1,Math.floor(f*=n)));return l[i](f-i)}}function XDe(e){return function(){return e}}function AI(e){return+e}var n7=[0,1];function Cs(e){return e}function Ij(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:XDe(isNaN(t)?NaN:.5)}function YDe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function KDe(e,t,r){var n=e[0],a=e[1],l=t[0],f=t[1];return a<n?(n=Ij(a,n),l=r(f,l)):(n=Ij(n,a),l=r(l,f)),function(i){return l(n(i))}}function JDe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),l=new Array(n),f=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++f<n;)a[f]=Ij(e[f],e[f+1]),l[f]=r(t[f],t[f+1]);return function(i){var _=wE(e,i,1,n)-1;return l[_](a[_](i))}}function TE(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Nk(){var e=n7,t=n7,r=Zx,n,a,l,f=Cs,i,_,b;function E(){var R=Math.min(e.length,t.length);return f!==Cs&&(f=YDe(e[0],e[R-1])),i=R>2?JDe:KDe,_=b=null,C}function C(R){return R==null||isNaN(R=+R)?l:(_||(_=i(e.map(n),t,r)))(n(f(R)))}return C.invert=function(R){return f(a((b||(b=i(t,e.map(n),EI)))(R)))},C.domain=function(R){return arguments.length?(e=Array.from(R,AI),E()):e.slice()},C.range=function(R){return arguments.length?(t=Array.from(R),E()):t.slice()},C.rangeRound=function(R){return t=Array.from(R),r=P5,E()},C.clamp=function(R){return arguments.length?(f=R?!0:Cs,E()):f!==Cs},C.interpolate=function(R){return arguments.length?(r=R,E()):r},C.unknown=function(R){return arguments.length?(l=R,C):l},function(R,F){return n=R,a=F,E()}}function I5(){return Nk()(Cs,Cs)}function QDe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function MI(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Y0(e){return e=MI(Math.abs(e)),e?e[1]:NaN}function eLe(e,t){return function(r,n){for(var a=r.length,l=[],f=0,i=e[0],_=0;a>0&&i>0&&(_+i+1>n&&(i=Math.max(1,n-_)),l.push(r.substring(a-=i,a+i)),!((_+=i+1)>n));)i=e[f=(f+1)%e.length];return l.reverse().join(t)}}function tLe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var rLe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pT(e){if(!(t=rLe.exec(e)))throw new Error("invalid format: "+e);var t;return new O5({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}pT.prototype=O5.prototype;function O5(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}O5.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nLe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Bte;function iLe(e,t){var r=MI(e,t);if(!r)return e+"";var n=r[0],a=r[1],l=a-(Bte=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,f=n.length;return l===f?n:l>f?n+new Array(l-f+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+MI(e,Math.max(0,t+l-1))[0]}function i7(e,t){var r=MI(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const o7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:QDe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>i7(e*100,t),r:i7,s:iLe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function a7(e){return e}var s7=Array.prototype.map,l7=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function oLe(e){var t=e.grouping===void 0||e.thousands===void 0?a7:eLe(s7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?a7:tLe(s7.call(e.numerals,String)),f=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"−":e.minus+"",_=e.nan===void 0?"NaN":e.nan+"";function b(C){C=pT(C);var R=C.fill,F=C.align,U=C.sign,$=C.symbol,H=C.zero,q=C.width,G=C.comma,J=C.precision,te=C.trim,oe=C.type;oe==="n"?(G=!0,oe="g"):o7[oe]||(J===void 0&&(J=12),te=!0,oe="g"),(H||R==="0"&&F==="=")&&(H=!0,R="0",F="=");var he=$==="$"?r:$==="#"&&/[boxX]/.test(oe)?"0"+oe.toLowerCase():"",le=$==="$"?n:/[%p]/.test(oe)?f:"",ve=o7[oe],We=/[defgprs%]/.test(oe);J=J===void 0?6:/[gprs]/.test(oe)?Math.max(1,Math.min(21,J)):Math.max(0,Math.min(20,J));function Ie(Re){var $e=he,ot=le,Je,rt,st;if(oe==="c")ot=ve(Re)+ot,Re="";else{Re=+Re;var at=Re<0||1/Re<0;if(Re=isNaN(Re)?_:ve(Math.abs(Re),J),te&&(Re=nLe(Re)),at&&+Re==0&&U!=="+"&&(at=!1),$e=(at?U==="("?U:i:U==="-"||U==="("?"":U)+$e,ot=(oe==="s"?l7[8+Bte/3]:"")+ot+(at&&U==="("?")":""),We){for(Je=-1,rt=Re.length;++Je<rt;)if(st=Re.charCodeAt(Je),48>st||st>57){ot=(st===46?a+Re.slice(Je+1):Re.slice(Je))+ot,Re=Re.slice(0,Je);break}}}G&&!H&&(Re=t(Re,1/0));var Be=$e.length+Re.length+ot.length,ct=Be<q?new Array(q-Be+1).join(R):"";switch(G&&H&&(Re=t(ct+Re,ct.length?q-ot.length:1/0),ct=""),F){case"<":Re=$e+Re+ot+ct;break;case"=":Re=$e+ct+Re+ot;break;case"^":Re=ct.slice(0,Be=ct.length>>1)+$e+Re+ot+ct.slice(Be);break;default:Re=ct+$e+Re+ot;break}return l(Re)}return Ie.toString=function(){return C+""},Ie}function E(C,R){var F=b((C=pT(C),C.type="f",C)),U=Math.max(-8,Math.min(8,Math.floor(Y0(R)/3)))*3,$=Math.pow(10,-U),H=l7[8+U/3];return function(q){return F($*q)+H}}return{format:b,formatPrefix:E}}var cM,k5,$te;aLe({thousands:",",grouping:[3],currency:["$",""]});function aLe(e){return cM=oLe(e),k5=cM.format,$te=cM.formatPrefix,cM}function sLe(e){return Math.max(0,-Y0(Math.abs(e)))}function lLe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Y0(t)/3)))*3-Y0(Math.abs(e)))}function cLe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Y0(t)-Y0(e))+1}function Ute(e,t,r,n){var a=Aj(e,t,r),l;switch(n=pT(n??",f"),n.type){case"s":{var f=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(l=lLe(a,f))&&(n.precision=l),$te(n,f)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=cLe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=sLe(a))&&(n.precision=l-(n.type==="%")*2);break}}return k5(n)}function xm(e){var t=e.domain;return e.ticks=function(r){var n=t();return Tj(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return Ute(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,l=n.length-1,f=n[a],i=n[l],_,b,E=10;for(i<f&&(b=f,f=i,i=b,b=a,a=l,l=b);E-- >0;){if(b=Ej(f,i,r),b===_)return n[a]=f,n[l]=i,t(n);if(b>0)f=Math.floor(f/b)*b,i=Math.ceil(i/b)*b;else if(b<0)f=Math.ceil(f*b)/b,i=Math.floor(i*b)/b;else break;_=b}return e},e}function CI(){var e=I5();return e.copy=function(){return TE(e,CI())},kc.apply(e,arguments),xm(e)}function Vte(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,AI),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return Vte(e).unknown(t)},e=arguments.length?Array.from(e,AI):[0,1],xm(r)}function Wte(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],l=e[n],f;return l<a&&(f=r,r=n,n=f,f=a,a=l,l=f),e[r]=t.floor(a),e[n]=t.ceil(l),e}function c7(e){return Math.log(e)}function u7(e){return Math.exp(e)}function uLe(e){return-Math.log(-e)}function dLe(e){return-Math.exp(-e)}function hLe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function fLe(e){return e===10?hLe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function pLe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function d7(e){return(t,r)=>-e(-t,r)}function R5(e){const t=e(c7,u7),r=t.domain;let n=10,a,l;function f(){return a=pLe(n),l=fLe(n),r()[0]<0?(a=d7(a),l=d7(l),e(uLe,dLe)):e(c7,u7),t}return t.base=function(i){return arguments.length?(n=+i,f()):n},t.domain=function(i){return arguments.length?(r(i),f()):r()},t.ticks=i=>{const _=r();let b=_[0],E=_[_.length-1];const C=E<b;C&&([b,E]=[E,b]);let R=a(b),F=a(E),U,$;const H=i==null?10:+i;let q=[];if(!(n%1)&&F-R<H){if(R=Math.floor(R),F=Math.ceil(F),b>0){for(;R<=F;++R)for(U=1;U<n;++U)if($=R<0?U/l(-R):U*l(R),!($<b)){if($>E)break;q.push($)}}else for(;R<=F;++R)for(U=n-1;U>=1;--U)if($=R>0?U/l(-R):U*l(R),!($<b)){if($>E)break;q.push($)}q.length*2<H&&(q=Tj(b,E,H))}else q=Tj(R,F,Math.min(F-R,H)).map(l);return C?q.reverse():q},t.tickFormat=(i,_)=>{if(i==null&&(i=10),_==null&&(_=n===10?"s":","),typeof _!="function"&&(!(n%1)&&(_=pT(_)).precision==null&&(_.trim=!0),_=k5(_)),i===1/0)return _;const b=Math.max(1,n*i/t.ticks().length);return E=>{let C=E/l(Math.round(a(E)));return C*n<n-.5&&(C*=n),C<=b?_(E):""}},t.nice=()=>r(Wte(r(),{floor:i=>l(Math.floor(a(i))),ceil:i=>l(Math.ceil(a(i)))})),t}function Gte(){const e=R5(Nk()).domain([1,10]);return e.copy=()=>TE(e,Gte()).base(e.base()),kc.apply(e,arguments),e}function h7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function f7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function D5(e){var t=1,r=e(h7(t),f7(t));return r.constant=function(n){return arguments.length?e(h7(t=+n),f7(t)):t},xm(r)}function qte(){var e=D5(Nk());return e.copy=function(){return TE(e,qte()).constant(e.constant())},kc.apply(e,arguments)}function p7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function mLe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function gLe(e){return e<0?-e*e:e*e}function L5(e){var t=e(Cs,Cs),r=1;function n(){return r===1?e(Cs,Cs):r===.5?e(mLe,gLe):e(p7(r),p7(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},xm(t)}function N5(){var e=L5(Nk());return e.copy=function(){return TE(e,N5()).exponent(e.exponent())},kc.apply(e,arguments),e}function yLe(){return N5.apply(null,arguments).exponent(.5)}function m7(e){return Math.sign(e)*e*e}function vLe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Hte(){var e=I5(),t=[0,1],r=!1,n;function a(l){var f=vLe(e(l));return isNaN(f)?n:r?Math.round(f):f}return a.invert=function(l){return e.invert(m7(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,AI)).map(m7)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(r=!!l,a):r},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return Hte(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},kc.apply(a,arguments),xm(a)}function Zte(){var e=[],t=[],r=[],n;function a(){var f=0,i=Math.max(1,t.length);for(r=new Array(i-1);++f<i;)r[f-1]=SDe(e,f/i);return l}function l(f){return f==null||isNaN(f=+f)?n:t[wE(r,f)]}return l.invertExtent=function(f){var i=t.indexOf(f);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},l.domain=function(f){if(!arguments.length)return e.slice();e=[];for(let i of f)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Xp),a()},l.range=function(f){return arguments.length?(t=Array.from(f),a()):t.slice()},l.unknown=function(f){return arguments.length?(n=f,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return Zte().domain(e).range(t).unknown(n)},kc.apply(l,arguments)}function Xte(){var e=0,t=1,r=1,n=[.5],a=[0,1],l;function f(_){return _!=null&&_<=_?a[wE(n,_,0,r)]:l}function i(){var _=-1;for(n=new Array(r);++_<r;)n[_]=((_+1)*t-(_-r)*e)/(r+1);return f}return f.domain=function(_){return arguments.length?([e,t]=_,e=+e,t=+t,i()):[e,t]},f.range=function(_){return arguments.length?(r=(a=Array.from(_)).length-1,i()):a.slice()},f.invertExtent=function(_){var b=a.indexOf(_);return b<0?[NaN,NaN]:b<1?[e,n[0]]:b>=r?[n[r-1],t]:[n[b-1],n[b]]},f.unknown=function(_){return arguments.length&&(l=_),f},f.thresholds=function(){return n.slice()},f.copy=function(){return Xte().domain([e,t]).range(a).unknown(l)},kc.apply(xm(f),arguments)}function Yte(){var e=[.5],t=[0,1],r,n=1;function a(l){return l!=null&&l<=l?t[wE(e,l,0,n)]:r}return a.domain=function(l){return arguments.length?(e=Array.from(l),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var f=t.indexOf(l);return[e[f-1],e[f]]},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return Yte().domain(e).range(t).unknown(r)},kc.apply(a,arguments)}const R3=new Date,D3=new Date;function va(e,t,r,n){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const f=a(l),i=a.ceil(l);return l-f<i-l?f:i},a.offset=(l,f)=>(t(l=new Date(+l),f==null?1:Math.floor(f)),l),a.range=(l,f,i)=>{const _=[];if(l=a.ceil(l),i=i==null?1:Math.floor(i),!(l<f)||!(i>0))return _;let b;do _.push(b=new Date(+l)),t(l,i),e(l);while(b<l&&l<f);return _},a.filter=l=>va(f=>{if(f>=f)for(;e(f),!l(f);)f.setTime(f-1)},(f,i)=>{if(f>=f)if(i<0)for(;++i<=0;)for(;t(f,-1),!l(f););else for(;--i>=0;)for(;t(f,1),!l(f););}),r&&(a.count=(l,f)=>(R3.setTime(+l),D3.setTime(+f),e(R3),e(D3),Math.floor(r(R3,D3))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(n?f=>n(f)%l===0:f=>a.count(0,f)%l===0):a)),a}const PI=va(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);PI.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?va(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):PI);PI.range;const Sh=1e3,wc=Sh*60,Th=wc*60,Vh=Th*24,z5=Vh*7,g7=Vh*30,L3=Vh*365,Vg=va(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Sh)},(e,t)=>(t-e)/Sh,e=>e.getUTCSeconds());Vg.range;const j5=va(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Sh)},(e,t)=>{e.setTime(+e+t*wc)},(e,t)=>(t-e)/wc,e=>e.getMinutes());j5.range;const F5=va(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*wc)},(e,t)=>(t-e)/wc,e=>e.getUTCMinutes());F5.range;const B5=va(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Sh-e.getMinutes()*wc)},(e,t)=>{e.setTime(+e+t*Th)},(e,t)=>(t-e)/Th,e=>e.getHours());B5.range;const $5=va(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Th)},(e,t)=>(t-e)/Th,e=>e.getUTCHours());$5.range;const EE=va(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*wc)/Vh,e=>e.getDate()-1);EE.range;const zk=va(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vh,e=>e.getUTCDate()-1);zk.range;const Kte=va(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vh,e=>Math.floor(e/Vh));Kte.range;function Fy(e){return va(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*wc)/z5)}const jk=Fy(0),II=Fy(1),_Le=Fy(2),xLe=Fy(3),K0=Fy(4),bLe=Fy(5),wLe=Fy(6);jk.range;II.range;_Le.range;xLe.range;K0.range;bLe.range;wLe.range;function By(e){return va(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/z5)}const Fk=By(0),OI=By(1),SLe=By(2),TLe=By(3),J0=By(4),ELe=By(5),ALe=By(6);Fk.range;OI.range;SLe.range;TLe.range;J0.range;ELe.range;ALe.range;const U5=va(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());U5.range;const V5=va(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());V5.range;const Wh=va(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Wh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:va(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Wh.range;const Gh=va(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Gh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:va(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Gh.range;function Jte(e,t,r,n,a,l){const f=[[Vg,1,Sh],[Vg,5,5*Sh],[Vg,15,15*Sh],[Vg,30,30*Sh],[l,1,wc],[l,5,5*wc],[l,15,15*wc],[l,30,30*wc],[a,1,Th],[a,3,3*Th],[a,6,6*Th],[a,12,12*Th],[n,1,Vh],[n,2,2*Vh],[r,1,z5],[t,1,g7],[t,3,3*g7],[e,1,L3]];function i(b,E,C){const R=E<b;R&&([b,E]=[E,b]);const F=C&&typeof C.range=="function"?C:_(b,E,C),U=F?F.range(b,+E+1):[];return R?U.reverse():U}function _(b,E,C){const R=Math.abs(E-b)/C,F=E5(([,,H])=>H).right(f,R);if(F===f.length)return e.every(Aj(b/L3,E/L3,C));if(F===0)return PI.every(Math.max(Aj(b,E,C),1));const[U,$]=f[R/f[F-1][2]<f[F][2]/R?F-1:F];return U.every($)}return[i,_]}const[MLe,CLe]=Jte(Gh,V5,Fk,Kte,$5,F5),[PLe,ILe]=Jte(Wh,U5,jk,EE,B5,j5);function N3(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function z3(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hw(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function OLe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,l=e.days,f=e.shortDays,i=e.months,_=e.shortMonths,b=fw(a),E=pw(a),C=fw(l),R=pw(l),F=fw(f),U=pw(f),$=fw(i),H=pw(i),q=fw(_),G=pw(_),J={a:at,A:Be,b:ct,B:jt,c:null,d:w7,e:w7,f:e3e,g:u3e,G:h3e,H:KLe,I:JLe,j:QLe,L:Qte,m:t3e,M:r3e,p:Lt,q:$t,Q:E7,s:A7,S:n3e,u:i3e,U:o3e,V:a3e,w:s3e,W:l3e,x:null,X:null,y:c3e,Y:d3e,Z:f3e,"%":T7},te={a:ut,A:tr,b:mr,B:rr,c:null,d:S7,e:S7,f:y3e,g:M3e,G:P3e,H:p3e,I:m3e,j:g3e,L:tre,m:v3e,M:_3e,p:Ut,q:gr,Q:E7,s:A7,S:x3e,u:b3e,U:w3e,V:S3e,w:T3e,W:E3e,x:null,X:null,y:A3e,Y:C3e,Z:I3e,"%":T7},oe={a:Ie,A:Re,b:$e,B:ot,c:Je,d:x7,e:x7,f:HLe,g:_7,G:v7,H:b7,I:b7,j:VLe,L:qLe,m:ULe,M:WLe,p:We,q:$Le,Q:XLe,s:YLe,S:GLe,u:NLe,U:zLe,V:jLe,w:LLe,W:FLe,x:rt,X:st,y:_7,Y:v7,Z:BLe,"%":ZLe};J.x=he(r,J),J.X=he(n,J),J.c=he(t,J),te.x=he(r,te),te.X=he(n,te),te.c=he(t,te);function he(Gt,ge){return function(cr){var Ot=[],Pr=-1,_t=0,hn=Gt.length,qr,Ln,Ge;for(cr instanceof Date||(cr=new Date(+cr));++Pr<hn;)Gt.charCodeAt(Pr)===37&&(Ot.push(Gt.slice(_t,Pr)),(Ln=y7[qr=Gt.charAt(++Pr)])!=null?qr=Gt.charAt(++Pr):Ln=qr==="e"?" ":"0",(Ge=ge[qr])&&(qr=Ge(cr,Ln)),Ot.push(qr),_t=Pr+1);return Ot.push(Gt.slice(_t,Pr)),Ot.join("")}}function le(Gt,ge){return function(cr){var Ot=hw(1900,void 0,1),Pr=ve(Ot,Gt,cr+="",0),_t,hn;if(Pr!=cr.length)return null;if("Q"in Ot)return new Date(Ot.Q);if("s"in Ot)return new Date(Ot.s*1e3+("L"in Ot?Ot.L:0));if(ge&&!("Z"in Ot)&&(Ot.Z=0),"p"in Ot&&(Ot.H=Ot.H%12+Ot.p*12),Ot.m===void 0&&(Ot.m="q"in Ot?Ot.q:0),"V"in Ot){if(Ot.V<1||Ot.V>53)return null;"w"in Ot||(Ot.w=1),"Z"in Ot?(_t=z3(hw(Ot.y,0,1)),hn=_t.getUTCDay(),_t=hn>4||hn===0?OI.ceil(_t):OI(_t),_t=zk.offset(_t,(Ot.V-1)*7),Ot.y=_t.getUTCFullYear(),Ot.m=_t.getUTCMonth(),Ot.d=_t.getUTCDate()+(Ot.w+6)%7):(_t=N3(hw(Ot.y,0,1)),hn=_t.getDay(),_t=hn>4||hn===0?II.ceil(_t):II(_t),_t=EE.offset(_t,(Ot.V-1)*7),Ot.y=_t.getFullYear(),Ot.m=_t.getMonth(),Ot.d=_t.getDate()+(Ot.w+6)%7)}else("W"in Ot||"U"in Ot)&&("w"in Ot||(Ot.w="u"in Ot?Ot.u%7:"W"in Ot?1:0),hn="Z"in Ot?z3(hw(Ot.y,0,1)).getUTCDay():N3(hw(Ot.y,0,1)).getDay(),Ot.m=0,Ot.d="W"in Ot?(Ot.w+6)%7+Ot.W*7-(hn+5)%7:Ot.w+Ot.U*7-(hn+6)%7);return"Z"in Ot?(Ot.H+=Ot.Z/100|0,Ot.M+=Ot.Z%100,z3(Ot)):N3(Ot)}}function ve(Gt,ge,cr,Ot){for(var Pr=0,_t=ge.length,hn=cr.length,qr,Ln;Pr<_t;){if(Ot>=hn)return-1;if(qr=ge.charCodeAt(Pr++),qr===37){if(qr=ge.charAt(Pr++),Ln=oe[qr in y7?ge.charAt(Pr++):qr],!Ln||(Ot=Ln(Gt,cr,Ot))<0)return-1}else if(qr!=cr.charCodeAt(Ot++))return-1}return Ot}function We(Gt,ge,cr){var Ot=b.exec(ge.slice(cr));return Ot?(Gt.p=E.get(Ot[0].toLowerCase()),cr+Ot[0].length):-1}function Ie(Gt,ge,cr){var Ot=F.exec(ge.slice(cr));return Ot?(Gt.w=U.get(Ot[0].toLowerCase()),cr+Ot[0].length):-1}function Re(Gt,ge,cr){var Ot=C.exec(ge.slice(cr));return Ot?(Gt.w=R.get(Ot[0].toLowerCase()),cr+Ot[0].length):-1}function $e(Gt,ge,cr){var Ot=q.exec(ge.slice(cr));return Ot?(Gt.m=G.get(Ot[0].toLowerCase()),cr+Ot[0].length):-1}function ot(Gt,ge,cr){var Ot=$.exec(ge.slice(cr));return Ot?(Gt.m=H.get(Ot[0].toLowerCase()),cr+Ot[0].length):-1}function Je(Gt,ge,cr){return ve(Gt,t,ge,cr)}function rt(Gt,ge,cr){return ve(Gt,r,ge,cr)}function st(Gt,ge,cr){return ve(Gt,n,ge,cr)}function at(Gt){return f[Gt.getDay()]}function Be(Gt){return l[Gt.getDay()]}function ct(Gt){return _[Gt.getMonth()]}function jt(Gt){return i[Gt.getMonth()]}function Lt(Gt){return a[+(Gt.getHours()>=12)]}function $t(Gt){return 1+~~(Gt.getMonth()/3)}function ut(Gt){return f[Gt.getUTCDay()]}function tr(Gt){return l[Gt.getUTCDay()]}function mr(Gt){return _[Gt.getUTCMonth()]}function rr(Gt){return i[Gt.getUTCMonth()]}function Ut(Gt){return a[+(Gt.getUTCHours()>=12)]}function gr(Gt){return 1+~~(Gt.getUTCMonth()/3)}return{format:function(Gt){var ge=he(Gt+="",J);return ge.toString=function(){return Gt},ge},parse:function(Gt){var ge=le(Gt+="",!1);return ge.toString=function(){return Gt},ge},utcFormat:function(Gt){var ge=he(Gt+="",te);return ge.toString=function(){return Gt},ge},utcParse:function(Gt){var ge=le(Gt+="",!0);return ge.toString=function(){return Gt},ge}}}var y7={"-":"",_:" ",0:"0"},Pa=/^\s*\d+/,kLe=/^%/,RLe=/[\\^$*+?|[\]().{}]/g;function xi(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",l=a.length;return n+(l<r?new Array(r-l+1).join(t)+a:a)}function DLe(e){return e.replace(RLe,"\\$&")}function fw(e){return new RegExp("^(?:"+e.map(DLe).join("|")+")","i")}function pw(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function LLe(e,t,r){var n=Pa.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function NLe(e,t,r){var n=Pa.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function zLe(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function jLe(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function FLe(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function v7(e,t,r){var n=Pa.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function _7(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function BLe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function $Le(e,t,r){var n=Pa.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function ULe(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function x7(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function VLe(e,t,r){var n=Pa.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function b7(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function WLe(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function GLe(e,t,r){var n=Pa.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function qLe(e,t,r){var n=Pa.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function HLe(e,t,r){var n=Pa.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZLe(e,t,r){var n=kLe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function XLe(e,t,r){var n=Pa.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function YLe(e,t,r){var n=Pa.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function w7(e,t){return xi(e.getDate(),t,2)}function KLe(e,t){return xi(e.getHours(),t,2)}function JLe(e,t){return xi(e.getHours()%12||12,t,2)}function QLe(e,t){return xi(1+EE.count(Wh(e),e),t,3)}function Qte(e,t){return xi(e.getMilliseconds(),t,3)}function e3e(e,t){return Qte(e,t)+"000"}function t3e(e,t){return xi(e.getMonth()+1,t,2)}function r3e(e,t){return xi(e.getMinutes(),t,2)}function n3e(e,t){return xi(e.getSeconds(),t,2)}function i3e(e){var t=e.getDay();return t===0?7:t}function o3e(e,t){return xi(jk.count(Wh(e)-1,e),t,2)}function ere(e){var t=e.getDay();return t>=4||t===0?K0(e):K0.ceil(e)}function a3e(e,t){return e=ere(e),xi(K0.count(Wh(e),e)+(Wh(e).getDay()===4),t,2)}function s3e(e){return e.getDay()}function l3e(e,t){return xi(II.count(Wh(e)-1,e),t,2)}function c3e(e,t){return xi(e.getFullYear()%100,t,2)}function u3e(e,t){return e=ere(e),xi(e.getFullYear()%100,t,2)}function d3e(e,t){return xi(e.getFullYear()%1e4,t,4)}function h3e(e,t){var r=e.getDay();return e=r>=4||r===0?K0(e):K0.ceil(e),xi(e.getFullYear()%1e4,t,4)}function f3e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+xi(t/60|0,"0",2)+xi(t%60,"0",2)}function S7(e,t){return xi(e.getUTCDate(),t,2)}function p3e(e,t){return xi(e.getUTCHours(),t,2)}function m3e(e,t){return xi(e.getUTCHours()%12||12,t,2)}function g3e(e,t){return xi(1+zk.count(Gh(e),e),t,3)}function tre(e,t){return xi(e.getUTCMilliseconds(),t,3)}function y3e(e,t){return tre(e,t)+"000"}function v3e(e,t){return xi(e.getUTCMonth()+1,t,2)}function _3e(e,t){return xi(e.getUTCMinutes(),t,2)}function x3e(e,t){return xi(e.getUTCSeconds(),t,2)}function b3e(e){var t=e.getUTCDay();return t===0?7:t}function w3e(e,t){return xi(Fk.count(Gh(e)-1,e),t,2)}function rre(e){var t=e.getUTCDay();return t>=4||t===0?J0(e):J0.ceil(e)}function S3e(e,t){return e=rre(e),xi(J0.count(Gh(e),e)+(Gh(e).getUTCDay()===4),t,2)}function T3e(e){return e.getUTCDay()}function E3e(e,t){return xi(OI.count(Gh(e)-1,e),t,2)}function A3e(e,t){return xi(e.getUTCFullYear()%100,t,2)}function M3e(e,t){return e=rre(e),xi(e.getUTCFullYear()%100,t,2)}function C3e(e,t){return xi(e.getUTCFullYear()%1e4,t,4)}function P3e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?J0(e):J0.ceil(e),xi(e.getUTCFullYear()%1e4,t,4)}function I3e(){return"+0000"}function T7(){return"%"}function E7(e){return+e}function A7(e){return Math.floor(+e/1e3)}var l_,nre,ire;O3e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function O3e(e){return l_=OLe(e),nre=l_.format,l_.parse,ire=l_.utcFormat,l_.utcParse,l_}function k3e(e){return new Date(e)}function R3e(e){return e instanceof Date?+e:+new Date(+e)}function W5(e,t,r,n,a,l,f,i,_,b){var E=I5(),C=E.invert,R=E.domain,F=b(".%L"),U=b(":%S"),$=b("%I:%M"),H=b("%I %p"),q=b("%a %d"),G=b("%b %d"),J=b("%B"),te=b("%Y");function oe(he){return(_(he)<he?F:i(he)<he?U:f(he)<he?$:l(he)<he?H:n(he)<he?a(he)<he?q:G:r(he)<he?J:te)(he)}return E.invert=function(he){return new Date(C(he))},E.domain=function(he){return arguments.length?R(Array.from(he,R3e)):R().map(k3e)},E.ticks=function(he){var le=R();return e(le[0],le[le.length-1],he??10)},E.tickFormat=function(he,le){return le==null?oe:b(le)},E.nice=function(he){var le=R();return(!he||typeof he.range!="function")&&(he=t(le[0],le[le.length-1],he??10)),he?R(Wte(le,he)):E},E.copy=function(){return TE(E,W5(e,t,r,n,a,l,f,i,_,b))},E}function D3e(){return kc.apply(W5(PLe,ILe,Wh,U5,jk,EE,B5,j5,Vg,nre).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function L3e(){return kc.apply(W5(MLe,CLe,Gh,V5,Fk,zk,$5,F5,Vg,ire).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Bk(){var e=0,t=1,r,n,a,l,f=Cs,i=!1,_;function b(C){return C==null||isNaN(C=+C)?_:f(a===0?.5:(C=(l(C)-r)*a,i?Math.max(0,Math.min(1,C)):C))}b.domain=function(C){return arguments.length?([e,t]=C,r=l(e=+e),n=l(t=+t),a=r===n?0:1/(n-r),b):[e,t]},b.clamp=function(C){return arguments.length?(i=!!C,b):i},b.interpolator=function(C){return arguments.length?(f=C,b):f};function E(C){return function(R){var F,U;return arguments.length?([F,U]=R,f=C(F,U),b):[f(0),f(1)]}}return b.range=E(Zx),b.rangeRound=E(P5),b.unknown=function(C){return arguments.length?(_=C,b):_},function(C){return l=C,r=C(e),n=C(t),a=r===n?0:1/(n-r),b}}function bm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ore(){var e=xm(Bk()(Cs));return e.copy=function(){return bm(e,ore())},Qh.apply(e,arguments)}function are(){var e=R5(Bk()).domain([1,10]);return e.copy=function(){return bm(e,are()).base(e.base())},Qh.apply(e,arguments)}function sre(){var e=D5(Bk());return e.copy=function(){return bm(e,sre()).constant(e.constant())},Qh.apply(e,arguments)}function G5(){var e=L5(Bk());return e.copy=function(){return bm(e,G5()).exponent(e.exponent())},Qh.apply(e,arguments)}function N3e(){return G5.apply(null,arguments).exponent(.5)}function lre(){var e=[],t=Cs;function r(n){if(n!=null&&!isNaN(n=+n))return t((wE(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Xp),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,l)=>wDe(e,l/n))},r.copy=function(){return lre(t).domain(e)},Qh.apply(r,arguments)}function $k(){var e=0,t=.5,r=1,n=1,a,l,f,i,_,b=Cs,E,C=!1,R;function F($){return isNaN($=+$)?R:($=.5+(($=+E($))-l)*(n*$<n*l?i:_),b(C?Math.max(0,Math.min(1,$)):$))}F.domain=function($){return arguments.length?([e,t,r]=$,a=E(e=+e),l=E(t=+t),f=E(r=+r),i=a===l?0:.5/(l-a),_=l===f?0:.5/(f-l),n=l<a?-1:1,F):[e,t,r]},F.clamp=function($){return arguments.length?(C=!!$,F):C},F.interpolator=function($){return arguments.length?(b=$,F):b};function U($){return function(H){var q,G,J;return arguments.length?([q,G,J]=H,b=ZDe($,[q,G,J]),F):[b(0),b(.5),b(1)]}}return F.range=U(Zx),F.rangeRound=U(P5),F.unknown=function($){return arguments.length?(R=$,F):R},function($){return E=$,a=$(e),l=$(t),f=$(r),i=a===l?0:.5/(l-a),_=l===f?0:.5/(f-l),n=l<a?-1:1,F}}function cre(){var e=xm($k()(Cs));return e.copy=function(){return bm(e,cre())},Qh.apply(e,arguments)}function ure(){var e=R5($k()).domain([.1,1,10]);return e.copy=function(){return bm(e,ure()).base(e.base())},Qh.apply(e,arguments)}function dre(){var e=D5($k());return e.copy=function(){return bm(e,dre()).constant(e.constant())},Qh.apply(e,arguments)}function q5(){var e=L5($k());return e.copy=function(){return bm(e,q5()).exponent(e.exponent())},Qh.apply(e,arguments)}function z3e(){return q5.apply(null,arguments).exponent(.5)}const M7=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:uT,scaleDiverging:cre,scaleDivergingLog:ure,scaleDivergingPow:q5,scaleDivergingSqrt:z3e,scaleDivergingSymlog:dre,scaleIdentity:Vte,scaleImplicit:Mj,scaleLinear:CI,scaleLog:Gte,scaleOrdinal:A5,scalePoint:wS,scalePow:N5,scaleQuantile:Zte,scaleQuantize:Xte,scaleRadial:Hte,scaleSequential:ore,scaleSequentialLog:are,scaleSequentialPow:G5,scaleSequentialQuantile:lre,scaleSequentialSqrt:N3e,scaleSequentialSymlog:sre,scaleSqrt:yLe,scaleSymlog:qte,scaleThreshold:Yte,scaleTime:D3e,scaleUtc:L3e,tickFormat:Ute},Symbol.toStringTag,{value:"Module"}));var j3e=Fx;function F3e(e,t,r){for(var n=-1,a=e.length;++n<a;){var l=e[n],f=t(l);if(f!=null&&(i===void 0?f===f&&!j3e(f):r(f,i)))var i=f,_=l}return _}var hre=F3e;function B3e(e,t){return e>t}var $3e=B3e,U3e=hre,V3e=$3e,W3e=Hx;function G3e(e){return e&&e.length?U3e(e,W3e,V3e):void 0}var q3e=G3e;const zp=hi(q3e);function H3e(e,t){return e<t}var Z3e=H3e,X3e=hre,Y3e=Z3e,K3e=Hx;function J3e(e){return e&&e.length?X3e(e,K3e,Y3e):void 0}var Q3e=J3e;const Uk=hi(Q3e);var eNe=a5,tNe=_m,rNe=xte,nNe=gl;function iNe(e,t){var r=nNe(e)?eNe:rNe;return r(e,tNe(t))}var oNe=iNe,aNe=vte,sNe=oNe;function lNe(e,t){return aNe(sNe(e,t),1)}var cNe=lNe;const uNe=hi(cNe);var dNe=b5;function hNe(e,t){return dNe(e,t)}var fNe=hNe;const mT=hi(fNe);var Xx=1e9,pNe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Z5,yo=!0,Pc="[DecimalError] ",sy=Pc+"Invalid argument: ",H5=Pc+"Exponent out of range: ",Yx=Math.floor,Pg=Math.pow,mNe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Fl,Ta=1e7,co=7,fre=9007199254740991,kI=Yx(fre/co),Fr={};Fr.absoluteValue=Fr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Fr.comparedTo=Fr.cmp=function(e){var t,r,n,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(n=l.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return n===a?0:n>a^l.s<0?1:-1};Fr.decimalPlaces=Fr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*co;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Fr.dividedBy=Fr.div=function(e){return Rh(this,new this.constructor(e))};Fr.dividedToIntegerBy=Fr.idiv=function(e){var t=this,r=t.constructor;return Wi(Rh(t,new r(e),0,1),r.precision)};Fr.equals=Fr.eq=function(e){return!this.cmp(e)};Fr.exponent=function(){return ra(this)};Fr.greaterThan=Fr.gt=function(e){return this.cmp(e)>0};Fr.greaterThanOrEqualTo=Fr.gte=function(e){return this.cmp(e)>=0};Fr.isInteger=Fr.isint=function(){return this.e>this.d.length-2};Fr.isNegative=Fr.isneg=function(){return this.s<0};Fr.isPositive=Fr.ispos=function(){return this.s>0};Fr.isZero=function(){return this.s===0};Fr.lessThan=Fr.lt=function(e){return this.cmp(e)<0};Fr.lessThanOrEqualTo=Fr.lte=function(e){return this.cmp(e)<1};Fr.logarithm=Fr.log=function(e){var t,r=this,n=r.constructor,a=n.precision,l=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Fl))throw Error(Pc+"NaN");if(r.s<1)throw Error(Pc+(r.s?"NaN":"-Infinity"));return r.eq(Fl)?new n(0):(yo=!1,t=Rh(gT(r,l),gT(e,l),l),yo=!0,Wi(t,a))};Fr.minus=Fr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?gre(t,e):pre(t,(e.s=-e.s,e))};Fr.modulo=Fr.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Pc+"NaN");return r.s?(yo=!1,t=Rh(r,e,0,1).times(e),yo=!0,r.minus(t)):Wi(new n(r),a)};Fr.naturalExponential=Fr.exp=function(){return mre(this)};Fr.naturalLogarithm=Fr.ln=function(){return gT(this)};Fr.negated=Fr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Fr.plus=Fr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?pre(t,e):gre(t,(e.s=-e.s,e))};Fr.precision=Fr.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(sy+e);if(t=ra(a)+1,n=a.d.length-1,r=n*co+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Fr.squareRoot=Fr.sqrt=function(){var e,t,r,n,a,l,f,i=this,_=i.constructor;if(i.s<1){if(!i.s)return new _(0);throw Error(Pc+"NaN")}for(e=ra(i),yo=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=xd(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Yx((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new _(t)):n=new _(a.toString()),r=_.precision,a=f=r+3;;)if(l=n,n=l.plus(Rh(i,l,f+2)).times(.5),xd(l.d).slice(0,f)===(t=xd(n.d)).slice(0,f)){if(t=t.slice(f-3,f+1),a==f&&t=="4999"){if(Wi(l,r+1,0),l.times(l).eq(i)){n=l;break}}else if(t!="9999")break;f+=4}return yo=!0,Wi(n,r)};Fr.times=Fr.mul=function(e){var t,r,n,a,l,f,i,_,b,E=this,C=E.constructor,R=E.d,F=(e=new C(e)).d;if(!E.s||!e.s)return new C(0);for(e.s*=E.s,r=E.e+e.e,_=R.length,b=F.length,_<b&&(l=R,R=F,F=l,f=_,_=b,b=f),l=[],f=_+b,n=f;n--;)l.push(0);for(n=b;--n>=0;){for(t=0,a=_+n;a>n;)i=l[a]+F[n]*R[a-n-1]+t,l[a--]=i%Ta|0,t=i/Ta|0;l[a]=(l[a]+t)%Ta|0}for(;!l[--f];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,yo?Wi(e,C.precision):e};Fr.toDecimalPlaces=Fr.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(kd(e,0,Xx),t===void 0?t=n.rounding:kd(t,0,8),Wi(r,e+ra(r)+1,t))};Fr.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=by(n,!0):(kd(e,0,Xx),t===void 0?t=a.rounding:kd(t,0,8),n=Wi(new a(n),e+1,t),r=by(n,!0,e+1)),r};Fr.toFixed=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?by(a):(kd(e,0,Xx),t===void 0?t=l.rounding:kd(t,0,8),n=Wi(new l(a),e+ra(a)+1,t),r=by(n.abs(),!1,e+ra(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Fr.toInteger=Fr.toint=function(){var e=this,t=e.constructor;return Wi(new t(e),ra(e)+1,t.rounding)};Fr.toNumber=function(){return+this};Fr.toPower=Fr.pow=function(e){var t,r,n,a,l,f,i=this,_=i.constructor,b=12,E=+(e=new _(e));if(!e.s)return new _(Fl);if(i=new _(i),!i.s){if(e.s<1)throw Error(Pc+"Infinity");return i}if(i.eq(Fl))return i;if(n=_.precision,e.eq(Fl))return Wi(i,n);if(t=e.e,r=e.d.length-1,f=t>=r,l=i.s,f){if((r=E<0?-E:E)<=fre){for(a=new _(Fl),t=Math.ceil(n/co+4),yo=!1;r%2&&(a=a.times(i),P7(a.d,t)),r=Yx(r/2),r!==0;)i=i.times(i),P7(i.d,t);return yo=!0,e.s<0?new _(Fl).div(a):Wi(a,n)}}else if(l<0)throw Error(Pc+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,yo=!1,a=e.times(gT(i,n+b)),yo=!0,a=mre(a),a.s=l,a};Fr.toPrecision=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?(r=ra(a),n=by(a,r<=l.toExpNeg||r>=l.toExpPos)):(kd(e,1,Xx),t===void 0?t=l.rounding:kd(t,0,8),a=Wi(new l(a),e,t),r=ra(a),n=by(a,e<=r||r<=l.toExpNeg,e)),n};Fr.toSignificantDigits=Fr.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(kd(e,1,Xx),t===void 0?t=n.rounding:kd(t,0,8)),Wi(new n(r),e,t)};Fr.toString=Fr.valueOf=Fr.val=Fr.toJSON=Fr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ra(e),r=e.constructor;return by(e,t<=r.toExpNeg||t>=r.toExpPos)};function pre(e,t){var r,n,a,l,f,i,_,b,E=e.constructor,C=E.precision;if(!e.s||!t.s)return t.s||(t=new E(e)),yo?Wi(t,C):t;if(_=e.d,b=t.d,f=e.e,a=t.e,_=_.slice(),l=f-a,l){for(l<0?(n=_,l=-l,i=b.length):(n=b,a=f,i=_.length),f=Math.ceil(C/co),i=f>i?f+1:i+1,l>i&&(l=i,n.length=1),n.reverse();l--;)n.push(0);n.reverse()}for(i=_.length,l=b.length,i-l<0&&(l=i,n=b,b=_,_=n),r=0;l;)r=(_[--l]=_[l]+b[l]+r)/Ta|0,_[l]%=Ta;for(r&&(_.unshift(r),++a),i=_.length;_[--i]==0;)_.pop();return t.d=_,t.e=a,yo?Wi(t,C):t}function kd(e,t,r){if(e!==~~e||e<t||e>r)throw Error(sy+e)}function xd(e){var t,r,n,a=e.length-1,l="",f=e[0];if(a>0){for(l+=f,t=1;t<a;t++)n=e[t]+"",r=co-n.length,r&&(l+=vp(r)),l+=n;f=e[t],n=f+"",r=co-n.length,r&&(l+=vp(r))}else if(f===0)return"0";for(;f%10===0;)f/=10;return l+f}var Rh=function(){function e(n,a){var l,f=0,i=n.length;for(n=n.slice();i--;)l=n[i]*a+f,n[i]=l%Ta|0,f=l/Ta|0;return f&&n.unshift(f),n}function t(n,a,l,f){var i,_;if(l!=f)_=l>f?1:-1;else for(i=_=0;i<l;i++)if(n[i]!=a[i]){_=n[i]>a[i]?1:-1;break}return _}function r(n,a,l){for(var f=0;l--;)n[l]-=f,f=n[l]<a[l]?1:0,n[l]=f*Ta+n[l]-a[l];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,l,f){var i,_,b,E,C,R,F,U,$,H,q,G,J,te,oe,he,le,ve,We=n.constructor,Ie=n.s==a.s?1:-1,Re=n.d,$e=a.d;if(!n.s)return new We(n);if(!a.s)throw Error(Pc+"Division by zero");for(_=n.e-a.e,le=$e.length,oe=Re.length,F=new We(Ie),U=F.d=[],b=0;$e[b]==(Re[b]||0);)++b;if($e[b]>(Re[b]||0)&&--_,l==null?G=l=We.precision:f?G=l+(ra(n)-ra(a))+1:G=l,G<0)return new We(0);if(G=G/co+2|0,b=0,le==1)for(E=0,$e=$e[0],G++;(b<oe||E)&&G--;b++)J=E*Ta+(Re[b]||0),U[b]=J/$e|0,E=J%$e|0;else{for(E=Ta/($e[0]+1)|0,E>1&&($e=e($e,E),Re=e(Re,E),le=$e.length,oe=Re.length),te=le,$=Re.slice(0,le),H=$.length;H<le;)$[H++]=0;ve=$e.slice(),ve.unshift(0),he=$e[0],$e[1]>=Ta/2&&++he;do E=0,i=t($e,$,le,H),i<0?(q=$[0],le!=H&&(q=q*Ta+($[1]||0)),E=q/he|0,E>1?(E>=Ta&&(E=Ta-1),C=e($e,E),R=C.length,H=$.length,i=t(C,$,R,H),i==1&&(E--,r(C,le<R?ve:$e,R))):(E==0&&(i=E=1),C=$e.slice()),R=C.length,R<H&&C.unshift(0),r($,C,H),i==-1&&(H=$.length,i=t($e,$,le,H),i<1&&(E++,r($,le<H?ve:$e,H))),H=$.length):i===0&&(E++,$=[0]),U[b++]=E,i&&$[0]?$[H++]=Re[te]||0:($=[Re[te]],H=1);while((te++<oe||$[0]!==void 0)&&G--)}return U[0]||U.shift(),F.e=_,Wi(F,f?l+ra(F)+1:l)}}();function mre(e,t){var r,n,a,l,f,i,_=0,b=0,E=e.constructor,C=E.precision;if(ra(e)>16)throw Error(H5+ra(e));if(!e.s)return new E(Fl);for(t==null?(yo=!1,i=C):i=t,f=new E(.03125);e.abs().gte(.1);)e=e.times(f),b+=5;for(n=Math.log(Pg(2,b))/Math.LN10*2+5|0,i+=n,r=a=l=new E(Fl),E.precision=i;;){if(a=Wi(a.times(e),i),r=r.times(++_),f=l.plus(Rh(a,r,i)),xd(f.d).slice(0,i)===xd(l.d).slice(0,i)){for(;b--;)l=Wi(l.times(l),i);return E.precision=C,t==null?(yo=!0,Wi(l,C)):l}l=f}}function ra(e){for(var t=e.e*co,r=e.d[0];r>=10;r/=10)t++;return t}function j3(e,t,r){if(t>e.LN10.sd())throw yo=!0,r&&(e.precision=r),Error(Pc+"LN10 precision limit exceeded");return Wi(new e(e.LN10),t)}function vp(e){for(var t="";e--;)t+="0";return t}function gT(e,t){var r,n,a,l,f,i,_,b,E,C=1,R=10,F=e,U=F.d,$=F.constructor,H=$.precision;if(F.s<1)throw Error(Pc+(F.s?"NaN":"-Infinity"));if(F.eq(Fl))return new $(0);if(t==null?(yo=!1,b=H):b=t,F.eq(10))return t==null&&(yo=!0),j3($,b);if(b+=R,$.precision=b,r=xd(U),n=r.charAt(0),l=ra(F),Math.abs(l)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)F=F.times(e),r=xd(F.d),n=r.charAt(0),C++;l=ra(F),n>1?(F=new $("0."+r),l++):F=new $(n+"."+r.slice(1))}else return _=j3($,b+2,H).times(l+""),F=gT(new $(n+"."+r.slice(1)),b-R).plus(_),$.precision=H,t==null?(yo=!0,Wi(F,H)):F;for(i=f=F=Rh(F.minus(Fl),F.plus(Fl),b),E=Wi(F.times(F),b),a=3;;){if(f=Wi(f.times(E),b),_=i.plus(Rh(f,new $(a),b)),xd(_.d).slice(0,b)===xd(i.d).slice(0,b))return i=i.times(2),l!==0&&(i=i.plus(j3($,b+2,H).times(l+""))),i=Rh(i,new $(C),b),$.precision=H,t==null?(yo=!0,Wi(i,H)):i;i=_,a+=2}}function C7(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Yx(r/co),e.d=[],n=(r+1)%co,r<0&&(n+=co),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=co;n<a;)e.d.push(+t.slice(n,n+=co));t=t.slice(n),n=co-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),yo&&(e.e>kI||e.e<-kI))throw Error(H5+r)}else e.s=0,e.e=0,e.d=[0];return e}function Wi(e,t,r){var n,a,l,f,i,_,b,E,C=e.d;for(f=1,l=C[0];l>=10;l/=10)f++;if(n=t-f,n<0)n+=co,a=t,b=C[E=0];else{if(E=Math.ceil((n+1)/co),l=C.length,E>=l)return e;for(b=l=C[E],f=1;l>=10;l/=10)f++;n%=co,a=n-co+f}if(r!==void 0&&(l=Pg(10,f-a-1),i=b/l%10|0,_=t<0||C[E+1]!==void 0||b%l,_=r<4?(i||_)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||_||r==6&&(n>0?a>0?b/Pg(10,f-a):0:C[E-1])%10&1||r==(e.s<0?8:7))),t<1||!C[0])return _?(l=ra(e),C.length=1,t=t-l-1,C[0]=Pg(10,(co-t%co)%co),e.e=Yx(-t/co)||0):(C.length=1,C[0]=e.e=e.s=0),e;if(n==0?(C.length=E,l=1,E--):(C.length=E+1,l=Pg(10,co-n),C[E]=a>0?(b/Pg(10,f-a)%Pg(10,a)|0)*l:0),_)for(;;)if(E==0){(C[0]+=l)==Ta&&(C[0]=1,++e.e);break}else{if(C[E]+=l,C[E]!=Ta)break;C[E--]=0,l=1}for(n=C.length;C[--n]===0;)C.pop();if(yo&&(e.e>kI||e.e<-kI))throw Error(H5+ra(e));return e}function gre(e,t){var r,n,a,l,f,i,_,b,E,C,R=e.constructor,F=R.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new R(e),yo?Wi(t,F):t;if(_=e.d,C=t.d,n=t.e,b=e.e,_=_.slice(),f=b-n,f){for(E=f<0,E?(r=_,f=-f,i=C.length):(r=C,n=b,i=_.length),a=Math.max(Math.ceil(F/co),i)+2,f>a&&(f=a,r.length=1),r.reverse(),a=f;a--;)r.push(0);r.reverse()}else{for(a=_.length,i=C.length,E=a<i,E&&(i=a),a=0;a<i;a++)if(_[a]!=C[a]){E=_[a]<C[a];break}f=0}for(E&&(r=_,_=C,C=r,t.s=-t.s),i=_.length,a=C.length-i;a>0;--a)_[i++]=0;for(a=C.length;a>f;){if(_[--a]<C[a]){for(l=a;l&&_[--l]===0;)_[l]=Ta-1;--_[l],_[a]+=Ta}_[a]-=C[a]}for(;_[--i]===0;)_.pop();for(;_[0]===0;_.shift())--n;return _[0]?(t.d=_,t.e=n,yo?Wi(t,F):t):new R(0)}function by(e,t,r){var n,a=ra(e),l=xd(e.d),f=l.length;return t?(r&&(n=r-f)>0?l=l.charAt(0)+"."+l.slice(1)+vp(n):f>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+vp(-a-1)+l,r&&(n=r-f)>0&&(l+=vp(n))):a>=f?(l+=vp(a+1-f),r&&(n=r-a-1)>0&&(l=l+"."+vp(n))):((n=a+1)<f&&(l=l.slice(0,n)+"."+l.slice(n)),r&&(n=r-f)>0&&(a+1===f&&(l+="."),l+=vp(n))),e.s<0?"-"+l:l}function P7(e,t){if(e.length>t)return e.length=t,!0}function yre(e){var t,r,n;function a(l){var f=this;if(!(f instanceof a))return new a(l);if(f.constructor=a,l instanceof a){f.s=l.s,f.e=l.e,f.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(sy+l);if(l>0)f.s=1;else if(l<0)l=-l,f.s=-1;else{f.s=0,f.e=0,f.d=[0];return}if(l===~~l&&l<1e7){f.e=0,f.d=[l];return}return C7(f,l.toString())}else if(typeof l!="string")throw Error(sy+l);if(l.charCodeAt(0)===45?(l=l.slice(1),f.s=-1):f.s=1,mNe.test(l))C7(f,l);else throw Error(sy+l)}if(a.prototype=Fr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=yre,a.config=a.set=gNe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function gNe(e){if(!e||typeof e!="object")throw Error(Pc+"Object expected");var t,r,n,a=["precision",1,Xx,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Yx(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(sy+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(sy+r+": "+n);return this}var Z5=yre(pNe);Fl=new Z5(1);const Fi=Z5;function yNe(e){return bNe(e)||xNe(e)||_Ne(e)||vNe()}function vNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ne(e,t){if(e){if(typeof e=="string")return Oj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oj(e,t)}}function xNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function bNe(e){if(Array.isArray(e))return Oj(e)}function Oj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wNe=function(t){return t},vre={"@@functional/placeholder":!0},_re=function(t){return t===vre},I7=function(t){return function r(){return arguments.length===0||arguments.length===1&&_re(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},SNe=function e(t,r){return t===1?r:I7(function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var f=a.filter(function(i){return i!==vre}).length;return f>=t?r.apply(void 0,a):e(t-f,I7(function(){for(var i=arguments.length,_=new Array(i),b=0;b<i;b++)_[b]=arguments[b];var E=a.map(function(C){return _re(C)?_.shift():C});return r.apply(void 0,yNe(E).concat(_))}))})},Vk=function(t){return SNe(t.length,t)},kj=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},TNe=Vk(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),ENe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return wNe;var a=r.reverse(),l=a[0],f=a.slice(1);return function(){return f.reduce(function(i,_){return _(i)},l.apply(void 0,arguments))}},Rj=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},xre=function(t){var r=null,n=null;return function(){for(var a=arguments.length,l=new Array(a),f=0;f<a;f++)l[f]=arguments[f];return r&&l.every(function(i,_){return i===r[_]})||(r=l,n=t.apply(void 0,l)),n}};function ANe(e){var t;return e===0?t=1:t=Math.floor(new Fi(e).abs().log(10).toNumber())+1,t}function MNe(e,t,r){for(var n=new Fi(e),a=0,l=[];n.lt(t)&&a<1e5;)l.push(n.toNumber()),n=n.add(r),a++;return l}var CNe=Vk(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),PNe=Vk(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),INe=Vk(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Wk={rangeStep:MNe,getDigitCount:ANe,interpolateNumber:CNe,uninterpolateNumber:PNe,uninterpolateTruncation:INe};function Dj(e){return RNe(e)||kNe(e)||bre(e)||ONe()}function ONe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function RNe(e){if(Array.isArray(e))return Lj(e)}function yT(e,t){return NNe(e)||LNe(e,t)||bre(e,t)||DNe()}function DNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bre(e,t){if(e){if(typeof e=="string")return Lj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lj(e,t)}}function Lj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LNe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,l=void 0;try{for(var f=e[Symbol.iterator](),i;!(n=(i=f.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(_){a=!0,l=_}finally{try{!n&&f.return!=null&&f.return()}finally{if(a)throw l}}return r}}function NNe(e){if(Array.isArray(e))return e}function wre(e){var t=yT(e,2),r=t[0],n=t[1],a=r,l=n;return r>n&&(a=n,l=r),[a,l]}function Sre(e,t,r){if(e.lte(0))return new Fi(0);var n=Wk.getDigitCount(e.toNumber()),a=new Fi(10).pow(n),l=e.div(a),f=n!==1?.05:.1,i=new Fi(Math.ceil(l.div(f).toNumber())).add(r).mul(f),_=i.mul(a);return t?_:new Fi(Math.ceil(_))}function zNe(e,t,r){var n=1,a=new Fi(e);if(!a.isint()&&r){var l=Math.abs(e);l<1?(n=new Fi(10).pow(Wk.getDigitCount(e)-1),a=new Fi(Math.floor(a.div(n).toNumber())).mul(n)):l>1&&(a=new Fi(Math.floor(e)))}else e===0?a=new Fi(Math.floor((t-1)/2)):r||(a=new Fi(Math.floor(e)));var f=Math.floor((t-1)/2),i=ENe(TNe(function(_){return a.add(new Fi(_-f).mul(n)).toNumber()}),kj);return i(0,t)}function Tre(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Fi(0),tickMin:new Fi(0),tickMax:new Fi(0)};var l=Sre(new Fi(t).sub(e).div(r-1),n,a),f;e<=0&&t>=0?f=new Fi(0):(f=new Fi(e).add(t).div(2),f=f.sub(new Fi(f).mod(l)));var i=Math.ceil(f.sub(e).div(l).toNumber()),_=Math.ceil(new Fi(t).sub(f).div(l).toNumber()),b=i+_+1;return b>r?Tre(e,t,r,n,a+1):(b<r&&(_=t>0?_+(r-b):_,i=t>0?i:i+(r-b)),{step:l,tickMin:f.sub(new Fi(i).mul(l)),tickMax:f.add(new Fi(_).mul(l))})}function jNe(e){var t=yT(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=Math.max(a,2),i=wre([r,n]),_=yT(i,2),b=_[0],E=_[1];if(b===-1/0||E===1/0){var C=E===1/0?[b].concat(Dj(kj(0,a-1).map(function(){return 1/0}))):[].concat(Dj(kj(0,a-1).map(function(){return-1/0})),[E]);return r>n?Rj(C):C}if(b===E)return zNe(b,a,l);var R=Tre(b,E,f,l),F=R.step,U=R.tickMin,$=R.tickMax,H=Wk.rangeStep(U,$.add(new Fi(.1).mul(F)),F);return r>n?Rj(H):H}function FNe(e,t){var r=yT(e,2),n=r[0],a=r[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=wre([n,a]),i=yT(f,2),_=i[0],b=i[1];if(_===-1/0||b===1/0)return[n,a];if(_===b)return[_];var E=Math.max(t,2),C=Sre(new Fi(b).sub(_).div(E-1),l,0),R=[].concat(Dj(Wk.rangeStep(new Fi(_),new Fi(b).sub(new Fi(.99).mul(C)),C)),[b]);return n>a?Rj(R):R}var BNe=xre(jNe),$Ne=xre(FNe),UNe="Invariant failed";function wy(e,t){throw new Error(UNe)}var VNe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Q0(e){"@babel/helpers - typeof";return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(e)}function RI(){return RI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RI.apply(this,arguments)}function WNe(e,t){return ZNe(e)||HNe(e,t)||qNe(e,t)||GNe()}function GNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qNe(e,t){if(e){if(typeof e=="string")return O7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O7(e,t)}}function O7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function ZNe(e){if(Array.isArray(e))return e}function XNe(e,t){if(e==null)return{};var r=YNe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function KNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JNe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mre(n.key),n)}}function QNe(e,t,r){return t&&JNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eze(e,t,r){return t=DI(t),tze(e,Ere()?Reflect.construct(t,r||[],DI(e).constructor):t.apply(e,r))}function tze(e,t){if(t&&(Q0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rze(e)}function rze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ere(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ere=function(){return!!e})()}function DI(e){return DI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DI(e)}function nze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nj(e,t)}function Nj(e,t){return Nj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Nj(e,t)}function Are(e,t,r){return t=Mre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mre(e){var t=ize(e,"string");return Q0(t)=="symbol"?t:t+""}function ize(e,t){if(Q0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gk=function(e){function t(){return KNe(this,t),eze(this,t,arguments)}return nze(t,e),QNe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,l=n.layout,f=n.width,i=n.dataKey,_=n.data,b=n.dataPointFormatter,E=n.xAxis,C=n.yAxis,R=XNe(n,VNe),F=Xn(R,!1);this.props.direction==="x"&&E.type!=="number"&&wy();var U=_.map(function($){var H=b($,i),q=H.x,G=H.y,J=H.value,te=H.errorVal;if(!te)return null;var oe=[],he,le;if(Array.isArray(te)){var ve=WNe(te,2);he=ve[0],le=ve[1]}else he=le=te;if(l==="vertical"){var We=E.scale,Ie=G+a,Re=Ie+f,$e=Ie-f,ot=We(J-he),Je=We(J+le);oe.push({x1:Je,y1:Re,x2:Je,y2:$e}),oe.push({x1:ot,y1:Ie,x2:Je,y2:Ie}),oe.push({x1:ot,y1:Re,x2:ot,y2:$e})}else if(l==="horizontal"){var rt=C.scale,st=q+a,at=st-f,Be=st+f,ct=rt(J-he),jt=rt(J+le);oe.push({x1:at,y1:jt,x2:Be,y2:jt}),oe.push({x1:st,y1:ct,x2:st,y2:jt}),oe.push({x1:at,y1:ct,x2:Be,y2:ct})}return ze.createElement(To,RI({className:"recharts-errorBar",key:"bar-".concat(oe.map(function(Lt){return"".concat(Lt.x1,"-").concat(Lt.x2,"-").concat(Lt.y1,"-").concat(Lt.y2)}))},F),oe.map(function(Lt){return ze.createElement("line",RI({},Lt,{key:"line-".concat(Lt.x1,"-").concat(Lt.x2,"-").concat(Lt.y1,"-").concat(Lt.y2)}))}))});return ze.createElement(To,{className:"recharts-errorBars"},U)}}])}(ze.Component);Are(Gk,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Are(Gk,"displayName","ErrorBar");function vT(e){"@babel/helpers - typeof";return vT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vT(e)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){oze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oze(e,t,r){return t=aze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aze(e){var t=sze(e,"string");return vT(t)=="symbol"?t:t+""}function sze(e,t){if(vT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cre=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,l=t.legendContent,f=Dl(r,oy);if(!f)return null;var i=oy.defaultProps,_=i!==void 0?wg(wg({},i),f.props):{},b;return f.props&&f.props.payload?b=f.props&&f.props.payload:l==="children"?b=(n||[]).reduce(function(E,C){var R=C.item,F=C.props,U=F.sectors||F.data||[];return E.concat(U.map(function($){return{type:f.props.iconType||R.props.legendType,value:$.name,color:$.fill,payload:$}}))},[]):b=(n||[]).map(function(E){var C=E.item,R=C.type.defaultProps,F=R!==void 0?wg(wg({},R),C.props):{},U=F.dataKey,$=F.name,H=F.legendType,q=F.hide;return{inactive:q,dataKey:U,type:_.iconType||H||"square",color:X5(C),value:$||U,payload:F}}),wg(wg(wg({},_),oy.getWithHeight(f,a)),{},{payload:b,item:f})};function _T(e){"@babel/helpers - typeof";return _T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_T(e)}function R7(e){return dze(e)||uze(e)||cze(e)||lze()}function lze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cze(e,t){if(e){if(typeof e=="string")return zj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zj(e,t)}}function uze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dze(e){if(Array.isArray(e))return zj(e)}function zj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D7(Object(r),!0).forEach(function(n){m0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m0(e,t,r){return t=hze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hze(e){var t=fze(e,"string");return _T(t)=="symbol"?t:t+""}function fze(e,t){if(_T(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_T(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hl(e,t,r){return oi(e)||oi(t)?r:ya(t)?Ec(e,t,r):Vn(t)?t(e):r}function SS(e,t,r,n){var a=uNe(e,function(i){return Hl(i,t)});if(r==="number"){var l=a.filter(function(i){return br(i)||parseFloat(i)});return l.length?[Uk(l),zp(l)]:[1/0,-1/0]}var f=n?a.filter(function(i){return!oi(i)}):a;return f.map(function(i){return ya(i)||i instanceof Date?i:""})}var pze=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,f=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var _=l.range,b=0;b<i;b++){var E=b>0?a[b-1].coordinate:a[i-1].coordinate,C=a[b].coordinate,R=b>=i-1?a[0].coordinate:a[b+1].coordinate,F=void 0;if(_u(C-E)!==_u(R-C)){var U=[];if(_u(R-C)===_u(_[1]-_[0])){F=R;var $=C+_[1]-_[0];U[0]=Math.min($,($+E)/2),U[1]=Math.max($,($+E)/2)}else{F=E;var H=R+_[1]-_[0];U[0]=Math.min(C,(H+C)/2),U[1]=Math.max(C,(H+C)/2)}var q=[Math.min(C,(F+C)/2),Math.max(C,(F+C)/2)];if(t>q[0]&&t<=q[1]||t>=U[0]&&t<=U[1]){f=a[b].index;break}}else{var G=Math.min(E,R),J=Math.max(E,R);if(t>(G+C)/2&&t<=(J+C)/2){f=a[b].index;break}}}else for(var te=0;te<i;te++)if(te===0&&t<=(n[te].coordinate+n[te+1].coordinate)/2||te>0&&te<i-1&&t>(n[te].coordinate+n[te-1].coordinate)/2&&t<=(n[te].coordinate+n[te+1].coordinate)/2||te===i-1&&t>(n[te].coordinate+n[te-1].coordinate)/2){f=n[te].index;break}return f},X5=function(t){var r,n=t,a=n.type.displayName,l=(r=t.type)!==null&&r!==void 0&&r.defaultProps?zo(zo({},t.type.defaultProps),t.props):t.props,f=l.stroke,i=l.fill,_;switch(a){case"Line":_=f;break;case"Area":case"Radar":_=f&&f!=="none"?f:i;break;default:_=i;break}return _},mze=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,l=a===void 0?{}:a;if(!l)return{};for(var f={},i=Object.keys(l),_=0,b=i.length;_<b;_++)for(var E=l[i[_]].stackGroups,C=Object.keys(E),R=0,F=C.length;R<F;R++){var U=E[C[R]],$=U.items,H=U.cateAxisId,q=$.filter(function(le){return Ih(le.type).indexOf("Bar")>=0});if(q&&q.length){var G=q[0].type.defaultProps,J=G!==void 0?zo(zo({},G),q[0].props):q[0].props,te=J.barSize,oe=J[H];f[oe]||(f[oe]=[]);var he=oi(te)?r:te;f[oe].push({item:q[0],stackList:q.slice(1),barSize:oi(he)?void 0:xy(he,n,0)})}}return f},gze=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,l=t.sizeList,f=l===void 0?[]:l,i=t.maxBarSize,_=f.length;if(_<1)return null;var b=xy(r,a,0,!0),E,C=[];if(f[0].barSize===+f[0].barSize){var R=!1,F=a/_,U=f.reduce(function(te,oe){return te+oe.barSize||0},0);U+=(_-1)*b,U>=a&&(U-=(_-1)*b,b=0),U>=a&&F>0&&(R=!0,F*=.9,U=_*F);var $=(a-U)/2>>0,H={offset:$-b,size:0};E=f.reduce(function(te,oe){var he={item:oe.item,position:{offset:H.offset+H.size+b,size:R?F:oe.barSize}},le=[].concat(R7(te),[he]);return H=le[le.length-1].position,oe.stackList&&oe.stackList.length&&oe.stackList.forEach(function(ve){le.push({item:ve,position:H})}),le},C)}else{var q=xy(n,a,0,!0);a-2*q-(_-1)*b<=0&&(b=0);var G=(a-2*q-(_-1)*b)/_;G>1&&(G>>=0);var J=i===+i?Math.min(G,i):G;E=f.reduce(function(te,oe,he){var le=[].concat(R7(te),[{item:oe.item,position:{offset:q+(G+b)*he+(G-J)/2,size:J}}]);return oe.stackList&&oe.stackList.length&&oe.stackList.forEach(function(ve){le.push({item:ve,position:le[le.length-1].position})}),le},C)}return E},yze=function(t,r,n,a){var l=n.children,f=n.width,i=n.margin,_=f-(i.left||0)-(i.right||0),b=Cre({children:l,legendWidth:_});if(b){var E=a||{},C=E.width,R=E.height,F=b.align,U=b.verticalAlign,$=b.layout;if(($==="vertical"||$==="horizontal"&&U==="middle")&&F!=="center"&&br(t[F]))return zo(zo({},t),{},m0({},F,t[F]+(C||0)));if(($==="horizontal"||$==="vertical"&&F==="center")&&U!=="middle"&&br(t[U]))return zo(zo({},t),{},m0({},U,t[U]+(R||0)))}return t},vze=function(t,r,n){return oi(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},Pre=function(t,r,n,a,l){var f=r.props.children,i=Tu(f,Gk).filter(function(b){return vze(a,l,b.props.direction)});if(i&&i.length){var _=i.map(function(b){return b.props.dataKey});return t.reduce(function(b,E){var C=Hl(E,n);if(oi(C))return b;var R=Array.isArray(C)?[Uk(C),zp(C)]:[C,C],F=_.reduce(function(U,$){var H=Hl(E,$,0),q=R[0]-Math.abs(Array.isArray(H)?H[0]:H),G=R[1]+Math.abs(Array.isArray(H)?H[1]:H);return[Math.min(q,U[0]),Math.max(G,U[1])]},[1/0,-1/0]);return[Math.min(F[0],b[0]),Math.max(F[1],b[1])]},[1/0,-1/0])}return null},_ze=function(t,r,n,a,l){var f=r.map(function(i){return Pre(t,i,n,l,a)}).filter(function(i){return!oi(i)});return f&&f.length?f.reduce(function(i,_){return[Math.min(i[0],_[0]),Math.max(i[1],_[1])]},[1/0,-1/0]):null},Ire=function(t,r,n,a,l){var f=r.map(function(_){var b=_.props.dataKey;return n==="number"&&b&&Pre(t,_,b,a)||SS(t,b,n,l)});if(n==="number")return f.reduce(function(_,b){return[Math.min(_[0],b[0]),Math.max(_[1],b[1])]},[1/0,-1/0]);var i={};return f.reduce(function(_,b){for(var E=0,C=b.length;E<C;E++)i[b[E]]||(i[b[E]]=!0,_.push(b[E]));return _},[])},Ore=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},kre=function(t,r,n,a){if(a)return t.map(function(_){return _.coordinate});var l,f,i=t.map(function(_){return _.coordinate===r&&(l=!0),_.coordinate===n&&(f=!0),_.coordinate});return l||i.push(r),f||i.push(n),i},Eh=function(t,r,n){if(!t)return null;var a=t.scale,l=t.duplicateDomain,f=t.type,i=t.range,_=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,b=(r||n)&&f==="category"&&a.bandwidth?a.bandwidth()/_:0;if(b=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?_u(i[0]-i[1])*2*b:b,r&&(t.ticks||t.niceTicks)){var E=(t.ticks||t.niceTicks).map(function(C){var R=l?l.indexOf(C):C;return{coordinate:a(R)+b,value:C,offset:b}});return E.filter(function(C){return!Wx(C.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(C,R){return{coordinate:a(C)+b,value:C,index:R,offset:b}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(C){return{coordinate:a(C)+b,value:C,offset:b}}):a.domain().map(function(C,R){return{coordinate:a(C)+b,value:l?l[C]:C,index:R,offset:b}})},F3=new WeakMap,uM=function(t,r){if(typeof r!="function")return t;F3.has(t)||F3.set(t,new WeakMap);var n=F3.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},xze=function(t,r,n){var a=t.scale,l=t.type,f=t.layout,i=t.axisType;if(a==="auto")return f==="radial"&&i==="radiusAxis"?{scale:uT(),realScaleType:"band"}:f==="radial"&&i==="angleAxis"?{scale:CI(),realScaleType:"linear"}:l==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:wS(),realScaleType:"point"}:l==="category"?{scale:uT(),realScaleType:"band"}:{scale:CI(),realScaleType:"linear"};if(_E(a)){var _="scale".concat(Pk(a));return{scale:(M7[_]||wS)(),realScaleType:M7[_]?_:"point"}}return Vn(a)?{scale:a}:{scale:wS(),realScaleType:"point"}},L7=1e-4,bze=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),l=Math.min(a[0],a[1])-L7,f=Math.max(a[0],a[1])+L7,i=t(r[0]),_=t(r[n-1]);(i<l||i>f||_<l||_>f)&&t.domain([r[0],r[n-1]])}},wze=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},Sze=function(t,r){if(!r||r.length!==2||!br(r[0])||!br(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[t[0],t[1]];return(!br(t[0])||t[0]<n)&&(l[0]=n),(!br(t[1])||t[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},Tze=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,f=0,i=0;i<r;++i){var _=Wx(t[i][n][1])?t[i][n][0]:t[i][n][1];_>=0?(t[i][n][0]=l,t[i][n][1]=l+_,l=t[i][n][1]):(t[i][n][0]=f,t[i][n][1]=f+_,f=t[i][n][1])}},Eze=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,f=0;f<r;++f){var i=Wx(t[f][n][1])?t[f][n][0]:t[f][n][1];i>=0?(t[f][n][0]=l,t[f][n][1]=l+i,l=t[f][n][1]):(t[f][n][0]=0,t[f][n][1]=0)}},Aze={sign:Tze,expand:$Ee,none:G0,silhouette:UEe,wiggle:VEe,positive:Eze},Mze=function(t,r,n){var a=r.map(function(i){return i.props.dataKey}),l=Aze[n],f=BEe().keys(a).value(function(i,_){return+Hl(i,_,0)}).order(lj).offset(l);return f(t)},Cze=function(t,r,n,a,l,f){if(!t)return null;var i=f?r.reverse():r,_={},b=i.reduce(function(C,R){var F,U=(F=R.type)!==null&&F!==void 0&&F.defaultProps?zo(zo({},R.type.defaultProps),R.props):R.props,$=U.stackId,H=U.hide;if(H)return C;var q=U[n],G=C[q]||{hasStack:!1,stackGroups:{}};if(ya($)){var J=G.stackGroups[$]||{numericAxisId:n,cateAxisId:a,items:[]};J.items.push(R),G.hasStack=!0,G.stackGroups[$]=J}else G.stackGroups[xE("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[R]};return zo(zo({},C),{},m0({},q,G))},_),E={};return Object.keys(b).reduce(function(C,R){var F=b[R];if(F.hasStack){var U={};F.stackGroups=Object.keys(F.stackGroups).reduce(function($,H){var q=F.stackGroups[H];return zo(zo({},$),{},m0({},H,{numericAxisId:n,cateAxisId:a,items:q.items,stackedData:Mze(t,q.items,l)}))},U)}return zo(zo({},C),{},m0({},R,F))},E)},Pze=function(t,r){var n=r.realScaleType,a=r.type,l=r.tickCount,f=r.originalDomain,i=r.allowDecimals,_=n||r.scale;if(_!=="auto"&&_!=="linear")return null;if(l&&a==="number"&&f&&(f[0]==="auto"||f[1]==="auto")){var b=t.domain();if(!b.length)return null;var E=BNe(b,l,i);return t.domain([Uk(E),zp(E)]),{niceTicks:E}}if(l&&a==="number"){var C=t.domain(),R=$Ne(C,l,i);return{niceTicks:R}}return null};function N7(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,l=e.index,f=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!oi(a[t.dataKey])){var i=oI(r,"value",a[t.dataKey]);if(i)return i.coordinate+n/2}return r[l]?r[l].coordinate+n/2:null}var _=Hl(a,oi(f)?t.dataKey:f);return oi(_)?null:t.scale(_)}var z7=function(t){var r=t.axis,n=t.ticks,a=t.offset,l=t.bandSize,f=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+a:null;var _=Hl(f,r.dataKey,r.domain[i]);return oi(_)?null:r.scale(_)-l/2+a},Ize=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},Oze=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?zo(zo({},t.type.defaultProps),t.props):t.props,l=a.stackId;if(ya(l)){var f=r[l];if(f){var i=f.items.indexOf(t);return i>=0?f.stackedData[i]:null}}return null},kze=function(t){return t.reduce(function(r,n){return[Uk(n.concat([r[0]]).filter(br)),zp(n.concat([r[1]]).filter(br))]},[1/0,-1/0])},Rre=function(t,r,n){return Object.keys(t).reduce(function(a,l){var f=t[l],i=f.stackedData,_=i.reduce(function(b,E){var C=kze(E.slice(r,n+1));return[Math.min(b[0],C[0]),Math.max(b[1],C[1])]},[1/0,-1/0]);return[Math.min(_[0],a[0]),Math.max(_[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},j7=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,F7=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jj=function(t,r,n){if(Vn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(br(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(j7.test(t[0])){var l=+j7.exec(t[0])[1];a[0]=r[0]-l}else Vn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(br(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(F7.test(t[1])){var f=+F7.exec(t[1])[1];a[1]=r[1]+f}else Vn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},LI=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var l=S5(r,function(C){return C.coordinate}),f=1/0,i=1,_=l.length;i<_;i++){var b=l[i],E=l[i-1];f=Math.min((b.coordinate||0)-(E.coordinate||0),f)}return f===1/0?0:f}return n?void 0:0},B7=function(t,r,n){return!t||!t.length||mT(t,Ec(n,"type.defaultProps.domain"))?r:t},Dre=function(t,r){var n=t.type.defaultProps?zo(zo({},t.type.defaultProps),t.props):t.props,a=n.dataKey,l=n.name,f=n.unit,i=n.formatter,_=n.tooltipType,b=n.chartType,E=n.hide;return zo(zo({},Xn(t,!1)),{},{dataKey:a,unit:f,formatter:i,name:l||a,color:X5(t),value:Hl(r,a),type:_,payload:r,chartType:b,hide:E})};function xT(e){"@babel/helpers - typeof";return xT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xT(e)}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){Rze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rze(e,t,r){return t=Dze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dze(e){var t=Lze(e,"string");return xT(t)=="symbol"?t:t+""}function Lze(e,t){if(xT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NI=Math.PI/180,Nze=function(t){return t*180/Math.PI},Fa=function(t,r,n,a){return{x:t+Math.cos(-NI*a)*n,y:r+Math.sin(-NI*a)*n}},zze=function(t,r){var n=t.x,a=t.y,l=r.x,f=r.y;return Math.sqrt(Math.pow(n-l,2)+Math.pow(a-f,2))},jze=function(t,r){var n=t.x,a=t.y,l=r.cx,f=r.cy,i=zze({x:n,y:a},{x:l,y:f});if(i<=0)return{radius:i};var _=(n-l)/i,b=Math.acos(_);return a>f&&(b=2*Math.PI-b),{radius:i,angle:Nze(b),angleInRadian:b}},Fze=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),l=Math.floor(n/360),f=Math.min(a,l);return{startAngle:r-f*360,endAngle:n-f*360}},Bze=function(t,r){var n=r.startAngle,a=r.endAngle,l=Math.floor(n/360),f=Math.floor(a/360),i=Math.min(l,f);return t+i*360},V7=function(t,r){var n=t.x,a=t.y,l=jze({x:n,y:a},r),f=l.radius,i=l.angle,_=r.innerRadius,b=r.outerRadius;if(f<_||f>b)return!1;if(f===0)return!0;var E=Fze(r),C=E.startAngle,R=E.endAngle,F=i,U;if(C<=R){for(;F>R;)F-=360;for(;F<C;)F+=360;U=F>=C&&F<=R}else{for(;F>C;)F-=360;for(;F<R;)F+=360;U=F>=R&&F<=C}return U?U7(U7({},r),{},{radius:f,angle:Bze(F,r)}):null};function bT(e){"@babel/helpers - typeof";return bT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bT(e)}var $ze=["offset"];function Uze(e){return qze(e)||Gze(e)||Wze(e)||Vze()}function Vze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wze(e,t){if(e){if(typeof e=="string")return Fj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fj(e,t)}}function Gze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qze(e){if(Array.isArray(e))return Fj(e)}function Fj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hze(e,t){if(e==null)return{};var r=Zze(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function W7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ua(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W7(Object(r),!0).forEach(function(n){Xze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xze(e,t,r){return t=Yze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yze(e){var t=Kze(e,"string");return bT(t)=="symbol"?t:t+""}function Kze(e,t){if(bT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wT(){return wT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wT.apply(this,arguments)}var Jze=function(t){var r=t.value,n=t.formatter,a=oi(t.children)?r:t.children;return Vn(n)?n(a):a},Qze=function(t,r){var n=_u(r-t),a=Math.min(Math.abs(r-t),360);return n*a},eje=function(t,r,n){var a=t.position,l=t.viewBox,f=t.offset,i=t.className,_=l,b=_.cx,E=_.cy,C=_.innerRadius,R=_.outerRadius,F=_.startAngle,U=_.endAngle,$=_.clockWise,H=(C+R)/2,q=Qze(F,U),G=q>=0?1:-1,J,te;a==="insideStart"?(J=F+G*f,te=$):a==="insideEnd"?(J=U-G*f,te=!$):a==="end"&&(J=U+G*f,te=$),te=q<=0?te:!te;var oe=Fa(b,E,H,J),he=Fa(b,E,H,J+(te?1:-1)*359),le="M".concat(oe.x,",").concat(oe.y,`
    A`).concat(H,",").concat(H,",0,1,").concat(te?0:1,`,
    `).concat(he.x,",").concat(he.y),ve=oi(t.id)?xE("recharts-radial-line-"):t.id;return ze.createElement("text",wT({},n,{dominantBaseline:"central",className:di("recharts-radial-bar-label",i)}),ze.createElement("defs",null,ze.createElement("path",{id:ve,d:le})),ze.createElement("textPath",{xlinkHref:"#".concat(ve)},r))},tje=function(t){var r=t.viewBox,n=t.offset,a=t.position,l=r,f=l.cx,i=l.cy,_=l.innerRadius,b=l.outerRadius,E=l.startAngle,C=l.endAngle,R=(E+C)/2;if(a==="outside"){var F=Fa(f,i,b+n,R),U=F.x,$=F.y;return{x:U,y:$,textAnchor:U>=f?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"end"};var H=(_+b)/2,q=Fa(f,i,H,R),G=q.x,J=q.y;return{x:G,y:J,textAnchor:"middle",verticalAnchor:"middle"}},rje=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,l=t.position,f=r,i=f.x,_=f.y,b=f.width,E=f.height,C=E>=0?1:-1,R=C*a,F=C>0?"end":"start",U=C>0?"start":"end",$=b>=0?1:-1,H=$*a,q=$>0?"end":"start",G=$>0?"start":"end";if(l==="top"){var J={x:i+b/2,y:_-C*a,textAnchor:"middle",verticalAnchor:F};return ua(ua({},J),n?{height:Math.max(_-n.y,0),width:b}:{})}if(l==="bottom"){var te={x:i+b/2,y:_+E+R,textAnchor:"middle",verticalAnchor:U};return ua(ua({},te),n?{height:Math.max(n.y+n.height-(_+E),0),width:b}:{})}if(l==="left"){var oe={x:i-H,y:_+E/2,textAnchor:q,verticalAnchor:"middle"};return ua(ua({},oe),n?{width:Math.max(oe.x-n.x,0),height:E}:{})}if(l==="right"){var he={x:i+b+H,y:_+E/2,textAnchor:G,verticalAnchor:"middle"};return ua(ua({},he),n?{width:Math.max(n.x+n.width-he.x,0),height:E}:{})}var le=n?{width:b,height:E}:{};return l==="insideLeft"?ua({x:i+H,y:_+E/2,textAnchor:G,verticalAnchor:"middle"},le):l==="insideRight"?ua({x:i+b-H,y:_+E/2,textAnchor:q,verticalAnchor:"middle"},le):l==="insideTop"?ua({x:i+b/2,y:_+R,textAnchor:"middle",verticalAnchor:U},le):l==="insideBottom"?ua({x:i+b/2,y:_+E-R,textAnchor:"middle",verticalAnchor:F},le):l==="insideTopLeft"?ua({x:i+H,y:_+R,textAnchor:G,verticalAnchor:U},le):l==="insideTopRight"?ua({x:i+b-H,y:_+R,textAnchor:q,verticalAnchor:U},le):l==="insideBottomLeft"?ua({x:i+H,y:_+E-R,textAnchor:G,verticalAnchor:F},le):l==="insideBottomRight"?ua({x:i+b-H,y:_+E-R,textAnchor:q,verticalAnchor:F},le):Bx(l)&&(br(l.x)||$g(l.x))&&(br(l.y)||$g(l.y))?ua({x:i+xy(l.x,b),y:_+xy(l.y,E),textAnchor:"end",verticalAnchor:"end"},le):ua({x:i+b/2,y:_+E/2,textAnchor:"middle",verticalAnchor:"middle"},le)},nje=function(t){return"cx"in t&&br(t.cx)};function rs(e){var t=e.offset,r=t===void 0?5:t,n=Hze(e,$ze),a=ua({offset:r},n),l=a.viewBox,f=a.position,i=a.value,_=a.children,b=a.content,E=a.className,C=E===void 0?"":E,R=a.textBreakAll;if(!l||oi(i)&&oi(_)&&!ne.isValidElement(b)&&!Vn(b))return null;if(ne.isValidElement(b))return ne.cloneElement(b,a);var F;if(Vn(b)){if(F=ne.createElement(b,a),ne.isValidElement(F))return F}else F=Jze(a);var U=nje(l),$=Xn(a,!0);if(U&&(f==="insideStart"||f==="insideEnd"||f==="end"))return eje(a,F,$);var H=U?tje(a):rje(a);return ze.createElement(bI,wT({className:di("recharts-label",C)},$,H,{breakAll:R}),F)}rs.displayName="Label";var Lre=function(t){var r=t.cx,n=t.cy,a=t.angle,l=t.startAngle,f=t.endAngle,i=t.r,_=t.radius,b=t.innerRadius,E=t.outerRadius,C=t.x,R=t.y,F=t.top,U=t.left,$=t.width,H=t.height,q=t.clockWise,G=t.labelViewBox;if(G)return G;if(br($)&&br(H)){if(br(C)&&br(R))return{x:C,y:R,width:$,height:H};if(br(F)&&br(U))return{x:F,y:U,width:$,height:H}}return br(C)&&br(R)?{x:C,y:R,width:0,height:0}:br(r)&&br(n)?{cx:r,cy:n,startAngle:l||a||0,endAngle:f||a||0,innerRadius:b||0,outerRadius:E||_||i||0,clockWise:q}:t.viewBox?t.viewBox:{}},ije=function(t,r){return t?t===!0?ze.createElement(rs,{key:"label-implicit",viewBox:r}):ya(t)?ze.createElement(rs,{key:"label-implicit",viewBox:r,value:t}):ne.isValidElement(t)?t.type===rs?ne.cloneElement(t,{key:"label-implicit",viewBox:r}):ze.createElement(rs,{key:"label-implicit",content:t,viewBox:r}):Vn(t)?ze.createElement(rs,{key:"label-implicit",content:t,viewBox:r}):Bx(t)?ze.createElement(rs,wT({viewBox:r},t,{key:"label-implicit"})):null:null},oje=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,l=Lre(t),f=Tu(a,rs).map(function(_,b){return ne.cloneElement(_,{viewBox:r||l,key:"label-".concat(b)})});if(!n)return f;var i=ije(t.label,r||l);return[i].concat(Uze(f))};rs.parseViewBox=Lre;rs.renderCallByParent=oje;function aje(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var sje=aje;const lje=hi(sje);function ST(e){"@babel/helpers - typeof";return ST=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ST(e)}var cje=["valueAccessor"],uje=["data","dataKey","clockWise","id","textBreakAll"];function dje(e){return mje(e)||pje(e)||fje(e)||hje()}function hje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fje(e,t){if(e){if(typeof e=="string")return Bj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bj(e,t)}}function pje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mje(e){if(Array.isArray(e))return Bj(e)}function Bj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zI(){return zI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zI.apply(this,arguments)}function G7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G7(Object(r),!0).forEach(function(n){gje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gje(e,t,r){return t=yje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yje(e){var t=vje(e,"string");return ST(t)=="symbol"?t:t+""}function vje(e,t){if(ST(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ST(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H7(e,t){if(e==null)return{};var r=_je(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _je(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var xje=function(t){return Array.isArray(t.value)?lje(t.value):t.value};function Yp(e){var t=e.valueAccessor,r=t===void 0?xje:t,n=H7(e,cje),a=n.data,l=n.dataKey,f=n.clockWise,i=n.id,_=n.textBreakAll,b=H7(n,uje);return!a||!a.length?null:ze.createElement(To,{className:"recharts-label-list"},a.map(function(E,C){var R=oi(l)?r(E,C):Hl(E&&E.payload,l),F=oi(i)?{}:{id:"".concat(i,"-").concat(C)};return ze.createElement(rs,zI({},Xn(E,!0),b,F,{parentViewBox:E.parentViewBox,value:R,textBreakAll:_,viewBox:rs.parseViewBox(oi(f)?E:q7(q7({},E),{},{clockWise:f})),key:"label-".concat(C),index:C}))}))}Yp.displayName="LabelList";function bje(e,t){return e?e===!0?ze.createElement(Yp,{key:"labelList-implicit",data:t}):ze.isValidElement(e)||Vn(e)?ze.createElement(Yp,{key:"labelList-implicit",data:t,content:e}):Bx(e)?ze.createElement(Yp,zI({data:t},e,{key:"labelList-implicit"})):null:null}function wje(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Tu(n,Yp).map(function(f,i){return ne.cloneElement(f,{data:t,key:"labelList-".concat(i)})});if(!r)return a;var l=bje(e.label,t);return[l].concat(dje(a))}Yp.renderCallByParent=wje;function TT(e){"@babel/helpers - typeof";return TT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TT(e)}function $j(){return $j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$j.apply(this,arguments)}function Z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function X7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(r),!0).forEach(function(n){Sje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sje(e,t,r){return t=Tje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tje(e){var t=Eje(e,"string");return TT(t)=="symbol"?t:t+""}function Eje(e,t){if(TT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(TT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aje=function(t,r){var n=_u(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},dM=function(t){var r=t.cx,n=t.cy,a=t.radius,l=t.angle,f=t.sign,i=t.isExternal,_=t.cornerRadius,b=t.cornerIsExternal,E=_*(i?1:-1)+a,C=Math.asin(_/E)/NI,R=b?l:l+f*C,F=Fa(r,n,E,R),U=Fa(r,n,a,R),$=b?l-f*C:l,H=Fa(r,n,E*Math.cos(C*NI),$);return{center:F,circleTangency:U,lineTangency:H,theta:C}},Nre=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,f=t.startAngle,i=t.endAngle,_=Aje(f,i),b=f+_,E=Fa(r,n,l,f),C=Fa(r,n,l,b),R="M ".concat(E.x,",").concat(E.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(_)>180),",").concat(+(f>b),`,
    `).concat(C.x,",").concat(C.y,`
  `);if(a>0){var F=Fa(r,n,a,f),U=Fa(r,n,a,b);R+="L ".concat(U.x,",").concat(U.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(_)>180),",").concat(+(f<=b),`,
            `).concat(F.x,",").concat(F.y," Z")}else R+="L ".concat(r,",").concat(n," Z");return R},Mje=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,f=t.cornerRadius,i=t.forceCornerRadius,_=t.cornerIsExternal,b=t.startAngle,E=t.endAngle,C=_u(E-b),R=dM({cx:r,cy:n,radius:l,angle:b,sign:C,cornerRadius:f,cornerIsExternal:_}),F=R.circleTangency,U=R.lineTangency,$=R.theta,H=dM({cx:r,cy:n,radius:l,angle:E,sign:-C,cornerRadius:f,cornerIsExternal:_}),q=H.circleTangency,G=H.lineTangency,J=H.theta,te=_?Math.abs(b-E):Math.abs(b-E)-$-J;if(te<0)return i?"M ".concat(U.x,",").concat(U.y,`
        a`).concat(f,",").concat(f,",0,0,1,").concat(f*2,`,0
        a`).concat(f,",").concat(f,",0,0,1,").concat(-f*2,`,0
      `):Nre({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:b,endAngle:E});var oe="M ".concat(U.x,",").concat(U.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(C<0),",").concat(F.x,",").concat(F.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(te>180),",").concat(+(C<0),",").concat(q.x,",").concat(q.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(C<0),",").concat(G.x,",").concat(G.y,`
  `);if(a>0){var he=dM({cx:r,cy:n,radius:a,angle:b,sign:C,isExternal:!0,cornerRadius:f,cornerIsExternal:_}),le=he.circleTangency,ve=he.lineTangency,We=he.theta,Ie=dM({cx:r,cy:n,radius:a,angle:E,sign:-C,isExternal:!0,cornerRadius:f,cornerIsExternal:_}),Re=Ie.circleTangency,$e=Ie.lineTangency,ot=Ie.theta,Je=_?Math.abs(b-E):Math.abs(b-E)-We-ot;if(Je<0&&f===0)return"".concat(oe,"L").concat(r,",").concat(n,"Z");oe+="L".concat($e.x,",").concat($e.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(C<0),",").concat(Re.x,",").concat(Re.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Je>180),",").concat(+(C>0),",").concat(le.x,",").concat(le.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(C<0),",").concat(ve.x,",").concat(ve.y,"Z")}else oe+="L".concat(r,",").concat(n,"Z");return oe},Cje={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},zre=function(t){var r=X7(X7({},Cje),t),n=r.cx,a=r.cy,l=r.innerRadius,f=r.outerRadius,i=r.cornerRadius,_=r.forceCornerRadius,b=r.cornerIsExternal,E=r.startAngle,C=r.endAngle,R=r.className;if(f<l||E===C)return null;var F=di("recharts-sector",R),U=f-l,$=xy(i,U,0,!0),H;return $>0&&Math.abs(E-C)<360?H=Mje({cx:n,cy:a,innerRadius:l,outerRadius:f,cornerRadius:Math.min($,U/2),forceCornerRadius:_,cornerIsExternal:b,startAngle:E,endAngle:C}):H=Nre({cx:n,cy:a,innerRadius:l,outerRadius:f,startAngle:E,endAngle:C}),ze.createElement("path",$j({},Xn(r,!0),{className:F,d:H,role:"img"}))};function ET(e){"@babel/helpers - typeof";return ET=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ET(e)}function Uj(){return Uj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uj.apply(this,arguments)}function Y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function K7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y7(Object(r),!0).forEach(function(n){Pje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pje(e,t,r){return t=Ije(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ije(e){var t=Oje(e,"string");return ET(t)=="symbol"?t:t+""}function Oje(e,t){if(ET(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ET(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J7={curveBasisClosed:PEe,curveBasisOpen:IEe,curveBasis:CEe,curveBumpX:pEe,curveBumpY:mEe,curveLinearClosed:OEe,curveLinear:Ok,curveMonotoneX:kEe,curveMonotoneY:REe,curveNatural:DEe,curveStep:LEe,curveStepAfter:zEe,curveStepBefore:NEe},hM=function(t){return t.x===+t.x&&t.y===+t.y},mw=function(t){return t.x},gw=function(t){return t.y},kje=function(t,r){if(Vn(t))return t;var n="curve".concat(Pk(t));return(n==="curveMonotone"||n==="curveBump")&&r?J7["".concat(n).concat(r==="vertical"?"Y":"X")]:J7[n]||Ok},Rje=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,l=a===void 0?[]:a,f=t.baseLine,i=t.layout,_=t.connectNulls,b=_===void 0?!1:_,E=kje(n,i),C=b?l.filter(function($){return hM($)}):l,R;if(Array.isArray(f)){var F=b?f.filter(function($){return hM($)}):f,U=C.map(function($,H){return K7(K7({},$),{},{base:F[H]})});return i==="vertical"?R=rM().y(gw).x1(mw).x0(function($){return $.base.x}):R=rM().x(mw).y1(gw).y0(function($){return $.base.y}),R.defined(hM).curve(E),R(U)}return i==="vertical"&&br(f)?R=rM().y(gw).x1(mw).x0(f):br(f)?R=rM().x(mw).y1(gw).y0(f):R=zee().x(mw).y(gw),R.defined(hM).curve(E),R(C)},TS=function(t){var r=t.className,n=t.points,a=t.path,l=t.pathRef;if((!n||!n.length)&&!a)return null;var f=n&&n.length?Rje(t):a;return ze.createElement("path",Uj({},Xn(t,!1),aI(t),{className:di("recharts-curve",r),d:f,ref:l}))},jre={exports:{}},Dje="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Lje=Dje,Nje=Lje;function Fre(){}function Bre(){}Bre.resetWarningCache=Fre;var zje=function(){function e(n,a,l,f,i,_){if(_!==Nje){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Bre,resetWarningCache:Fre};return r.PropTypes=r,r};jre.exports=zje();var jje=jre.exports;const Rn=hi(jje);var Fje=Object.getOwnPropertyNames,Bje=Object.getOwnPropertySymbols,$je=Object.prototype.hasOwnProperty;function Q7(e,t){return function(n,a,l){return e(n,a,l)&&t(n,a,l)}}function fM(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var l=a.cache,f=l.get(r),i=l.get(n);if(f&&i)return f===n&&i===r;l.set(r,n),l.set(n,r);var _=e(r,n,a);return l.delete(r),l.delete(n),_}}function e9(e){return Fje(e).concat(Bje(e))}var $re=Object.hasOwn||function(e,t){return $je.call(e,t)};function Kx(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Ure="_owner",t9=Object.getOwnPropertyDescriptor,r9=Object.keys;function Uje(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Vje(e,t){return Kx(e.getTime(),t.getTime())}function n9(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.entries(),l=0,f,i;(f=a.next())&&!f.done;){for(var _=t.entries(),b=!1,E=0;(i=_.next())&&!i.done;){var C=f.value,R=C[0],F=C[1],U=i.value,$=U[0],H=U[1];!b&&!n[E]&&(b=r.equals(R,$,l,E,e,t,r)&&r.equals(F,H,R,$,e,t,r))&&(n[E]=!0),E++}if(!b)return!1;l++}return!0}function Wje(e,t,r){var n=r9(e),a=n.length;if(r9(t).length!==a)return!1;for(var l;a-- >0;)if(l=n[a],l===Ure&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!$re(t,l)||!r.equals(e[l],t[l],l,l,e,t,r))return!1;return!0}function yw(e,t,r){var n=e9(e),a=n.length;if(e9(t).length!==a)return!1;for(var l,f,i;a-- >0;)if(l=n[a],l===Ure&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!$re(t,l)||!r.equals(e[l],t[l],l,l,e,t,r)||(f=t9(e,l),i=t9(t,l),(f||i)&&(!f||!i||f.configurable!==i.configurable||f.enumerable!==i.enumerable||f.writable!==i.writable)))return!1;return!0}function Gje(e,t){return Kx(e.valueOf(),t.valueOf())}function qje(e,t){return e.source===t.source&&e.flags===t.flags}function i9(e,t,r){if(e.size!==t.size)return!1;for(var n={},a=e.values(),l,f;(l=a.next())&&!l.done;){for(var i=t.values(),_=!1,b=0;(f=i.next())&&!f.done;)!_&&!n[b]&&(_=r.equals(l.value,f.value,l.value,f.value,e,t,r))&&(n[b]=!0),b++;if(!_)return!1}return!0}function Hje(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var Zje="[object Arguments]",Xje="[object Boolean]",Yje="[object Date]",Kje="[object Map]",Jje="[object Number]",Qje="[object Object]",eFe="[object RegExp]",tFe="[object Set]",rFe="[object String]",nFe=Array.isArray,o9=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,a9=Object.assign,iFe=Object.prototype.toString.call.bind(Object.prototype.toString);function oFe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,a=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,f=e.areRegExpsEqual,i=e.areSetsEqual,_=e.areTypedArraysEqual;return function(E,C,R){if(E===C)return!0;if(E==null||C==null||typeof E!="object"||typeof C!="object")return E!==E&&C!==C;var F=E.constructor;if(F!==C.constructor)return!1;if(F===Object)return a(E,C,R);if(nFe(E))return t(E,C,R);if(o9!=null&&o9(E))return _(E,C,R);if(F===Date)return r(E,C,R);if(F===RegExp)return f(E,C,R);if(F===Map)return n(E,C,R);if(F===Set)return i(E,C,R);var U=iFe(E);return U===Yje?r(E,C,R):U===eFe?f(E,C,R):U===Kje?n(E,C,R):U===tFe?i(E,C,R):U===Qje?typeof E.then!="function"&&typeof C.then!="function"&&a(E,C,R):U===Zje?a(E,C,R):U===Xje||U===Jje||U===rFe?l(E,C,R):!1}}function aFe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?yw:Uje,areDatesEqual:Vje,areMapsEqual:n?Q7(n9,yw):n9,areObjectsEqual:n?yw:Wje,arePrimitiveWrappersEqual:Gje,areRegExpsEqual:qje,areSetsEqual:n?Q7(i9,yw):i9,areTypedArraysEqual:n?yw:Hje};if(r&&(a=a9({},a,r(a))),t){var l=fM(a.areArraysEqual),f=fM(a.areMapsEqual),i=fM(a.areObjectsEqual),_=fM(a.areSetsEqual);a=a9({},a,{areArraysEqual:l,areMapsEqual:f,areObjectsEqual:i,areSetsEqual:_})}return a}function sFe(e){return function(t,r,n,a,l,f,i){return e(t,r,i)}}function lFe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,l=e.strict;if(n)return function(_,b){var E=n(),C=E.cache,R=C===void 0?t?new WeakMap:void 0:C,F=E.meta;return r(_,b,{cache:R,equals:a,meta:F,strict:l})};if(t)return function(_,b){return r(_,b,{cache:new WeakMap,equals:a,meta:void 0,strict:l})};var f={cache:void 0,equals:a,meta:void 0,strict:l};return function(_,b){return r(_,b,f)}}var cFe=wm();wm({strict:!0});wm({circular:!0});wm({circular:!0,strict:!0});wm({createInternalComparator:function(){return Kx}});wm({strict:!0,createInternalComparator:function(){return Kx}});wm({circular:!0,createInternalComparator:function(){return Kx}});wm({circular:!0,createInternalComparator:function(){return Kx},strict:!0});function wm(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,l=e.strict,f=l===void 0?!1:l,i=aFe(e),_=oFe(i),b=n?n(_):sFe(_);return lFe({circular:r,comparator:_,createState:a,equals:b,strict:f})}function uFe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function s9(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(l){r<0&&(r=l),l-r>t?(e(l),r=-1):uFe(a)};requestAnimationFrame(n)}function Vj(e){"@babel/helpers - typeof";return Vj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vj(e)}function dFe(e){return mFe(e)||pFe(e)||fFe(e)||hFe()}function hFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fFe(e,t){if(e){if(typeof e=="string")return l9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l9(e,t)}}function l9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mFe(e){if(Array.isArray(e))return e}function gFe(){var e={},t=function(){return null},r=!1,n=function a(l){if(!r){if(Array.isArray(l)){if(!l.length)return;var f=l,i=dFe(f),_=i[0],b=i.slice(1);if(typeof _=="number"){s9(a.bind(null,b),_);return}a(_),s9(a.bind(null,b));return}Vj(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){r=!0},start:function(l){r=!1,n(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function AT(e){"@babel/helpers - typeof";return AT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AT(e)}function c9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c9(Object(r),!0).forEach(function(n){Vre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vre(e,t,r){return t=yFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yFe(e){var t=vFe(e,"string");return AT(t)==="symbol"?t:String(t)}function vFe(e,t){if(AT(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(AT(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _Fe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(l){return a.includes(l)})})},xFe=function(t){return t},bFe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},ES=function(t,r){return Object.keys(r).reduce(function(n,a){return u9(u9({},n),{},Vre({},a,t(a,r[a])))},{})},d9=function(t,r,n){return t.map(function(a){return"".concat(bFe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function wFe(e,t){return EFe(e)||TFe(e,t)||Wre(e,t)||SFe()}function SFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function EFe(e){if(Array.isArray(e))return e}function AFe(e){return PFe(e)||CFe(e)||Wre(e)||MFe()}function MFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wre(e,t){if(e){if(typeof e=="string")return Wj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wj(e,t)}}function CFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PFe(e){if(Array.isArray(e))return Wj(e)}function Wj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var jI=1e-4,Gre=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},qre=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},h9=function(t,r){return function(n){var a=Gre(t,r);return qre(a,n)}},IFe=function(t,r){return function(n){var a=Gre(t,r),l=[].concat(AFe(a.map(function(f,i){return f*i}).slice(1)),[0]);return qre(l,n)}},f9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],l=r[1],f=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,l=0,f=1,i=1;break;case"ease":a=.25,l=.1,f=.25,i=1;break;case"ease-in":a=.42,l=0,f=1,i=1;break;case"ease-out":a=.42,l=0,f=.58,i=1;break;case"ease-in-out":a=0,l=0,f=.58,i=1;break;default:{var _=r[0].split("(");if(_[0]==="cubic-bezier"&&_[1].split(")")[0].split(",").length===4){var b=_[1].split(")")[0].split(",").map(function(H){return parseFloat(H)}),E=wFe(b,4);a=E[0],l=E[1],f=E[2],i=E[3]}}}var C=h9(a,f),R=h9(l,i),F=IFe(a,f),U=function(q){return q>1?1:q<0?0:q},$=function(q){for(var G=q>1?1:q,J=G,te=0;te<8;++te){var oe=C(J)-G,he=F(J);if(Math.abs(oe-G)<jI||he<jI)return R(J);J=U(J-oe/he)}return R(J)};return $.isStepper=!1,$},OFe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,l=a===void 0?8:a,f=t.dt,i=f===void 0?17:f,_=function(E,C,R){var F=-(E-C)*n,U=R*l,$=R+(F-U)*i/1e3,H=R*i/1e3+E;return Math.abs(H-C)<jI&&Math.abs($)<jI?[C,0]:[H,$]};return _.isStepper=!0,_.dt=i,_},kFe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return f9(a);case"spring":return OFe();default:if(a.split("(")[0]==="cubic-bezier")return f9(a)}return typeof a=="function"?a:null};function MT(e){"@babel/helpers - typeof";return MT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MT(e)}function p9(e){return LFe(e)||DFe(e)||Hre(e)||RFe()}function RFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LFe(e){if(Array.isArray(e))return qj(e)}function m9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function La(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m9(Object(r),!0).forEach(function(n){Gj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gj(e,t,r){return t=NFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NFe(e){var t=zFe(e,"string");return MT(t)==="symbol"?t:String(t)}function zFe(e,t){if(MT(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(MT(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jFe(e,t){return $Fe(e)||BFe(e,t)||Hre(e,t)||FFe()}function FFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hre(e,t){if(e){if(typeof e=="string")return qj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qj(e,t)}}function qj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function $Fe(e){if(Array.isArray(e))return e}var FI=function(t,r,n){return t+(r-t)*n},Hj=function(t){var r=t.from,n=t.to;return r!==n},UFe=function e(t,r,n){var a=ES(function(l,f){if(Hj(f)){var i=t(f.from,f.to,f.velocity),_=jFe(i,2),b=_[0],E=_[1];return La(La({},f),{},{from:b,velocity:E})}return f},r);return n<1?ES(function(l,f){return Hj(f)?La(La({},f),{},{velocity:FI(f.velocity,a[l].velocity,n),from:FI(f.from,a[l].from,n)}):f},r):e(t,a,n-1)};const VFe=function(e,t,r,n,a){var l=_Fe(e,t),f=l.reduce(function(H,q){return La(La({},H),{},Gj({},q,[e[q],t[q]]))},{}),i=l.reduce(function(H,q){return La(La({},H),{},Gj({},q,{from:e[q],velocity:0,to:t[q]}))},{}),_=-1,b,E,C=function(){return null},R=function(){return ES(function(q,G){return G.from},i)},F=function(){return!Object.values(i).filter(Hj).length},U=function(q){b||(b=q);var G=q-b,J=G/r.dt;i=UFe(r,i,J),a(La(La(La({},e),t),R())),b=q,F()||(_=requestAnimationFrame(C))},$=function(q){E||(E=q);var G=(q-E)/n,J=ES(function(oe,he){return FI.apply(void 0,p9(he).concat([r(G)]))},f);if(a(La(La(La({},e),t),J)),G<1)_=requestAnimationFrame(C);else{var te=ES(function(oe,he){return FI.apply(void 0,p9(he).concat([r(1)]))},f);a(La(La(La({},e),t),te))}};return C=r.isStepper?U:$,function(){return requestAnimationFrame(C),function(){cancelAnimationFrame(_)}}};function ex(e){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(e)}var WFe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function GFe(e,t){if(e==null)return{};var r=qFe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qFe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function B3(e){return YFe(e)||XFe(e)||ZFe(e)||HFe()}function HFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZFe(e,t){if(e){if(typeof e=="string")return Zj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zj(e,t)}}function XFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YFe(e){if(Array.isArray(e))return Zj(e)}function Zj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g9(Object(r),!0).forEach(function(n){kw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kw(e,t,r){return t=Zre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JFe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zre(n.key),n)}}function QFe(e,t,r){return t&&JFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zre(e){var t=e4e(e,"string");return ex(t)==="symbol"?t:String(t)}function e4e(e,t){if(ex(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ex(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function t4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xj(e,t)}function Xj(e,t){return Xj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Xj(e,t)}function r4e(e){var t=n4e();return function(){var n=BI(e),a;if(t){var l=BI(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return Yj(this,a)}}function Yj(e,t){if(t&&(ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kj(e)}function Kj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function BI(e){return BI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BI(e)}var qh=function(e){t4e(r,e);var t=r4e(r);function r(n,a){var l;KFe(this,r),l=t.call(this,n,a);var f=l.props,i=f.isActive,_=f.attributeName,b=f.from,E=f.to,C=f.steps,R=f.children,F=f.duration;if(l.handleStyleChange=l.handleStyleChange.bind(Kj(l)),l.changeStyle=l.changeStyle.bind(Kj(l)),!i||F<=0)return l.state={style:{}},typeof R=="function"&&(l.state={style:E}),Yj(l);if(C&&C.length)l.state={style:C[0].style};else if(b){if(typeof R=="function")return l.state={style:b},Yj(l);l.state={style:_?kw({},_,b):b}}else l.state={style:{}};return l}return QFe(r,[{key:"componentDidMount",value:function(){var a=this.props,l=a.isActive,f=a.canBegin;this.mounted=!0,!(!l||!f)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var l=this.props,f=l.isActive,i=l.canBegin,_=l.attributeName,b=l.shouldReAnimate,E=l.to,C=l.from,R=this.state.style;if(i){if(!f){var F={style:_?kw({},_,E):E};this.state&&R&&(_&&R[_]!==E||!_&&R!==E)&&this.setState(F);return}if(!(cFe(a.to,E)&&a.canBegin&&a.isActive)){var U=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var $=U||b?C:a.to;if(this.state&&R){var H={style:_?kw({},_,$):$};(_&&R[_]!==$||!_&&R!==$)&&this.setState(H)}this.runAnimation(iu(iu({},this.props),{},{from:$,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var l=this,f=a.from,i=a.to,_=a.duration,b=a.easing,E=a.begin,C=a.onAnimationEnd,R=a.onAnimationStart,F=VFe(f,i,kFe(b),_,this.changeStyle),U=function(){l.stopJSAnimation=F()};this.manager.start([R,E,U,_,C])}},{key:"runStepAnimation",value:function(a){var l=this,f=a.steps,i=a.begin,_=a.onAnimationStart,b=f[0],E=b.style,C=b.duration,R=C===void 0?0:C,F=function($,H,q){if(q===0)return $;var G=H.duration,J=H.easing,te=J===void 0?"ease":J,oe=H.style,he=H.properties,le=H.onAnimationEnd,ve=q>0?f[q-1]:H,We=he||Object.keys(oe);if(typeof te=="function"||te==="spring")return[].concat(B3($),[l.runJSAnimation.bind(l,{from:ve.style,to:oe,duration:G,easing:te}),G]);var Ie=d9(We,G,te),Re=iu(iu(iu({},ve.style),oe),{},{transition:Ie});return[].concat(B3($),[Re,G,le]).filter(xFe)};return this.manager.start([_].concat(B3(f.reduce(F,[E,Math.max(R,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=gFe());var l=a.begin,f=a.duration,i=a.attributeName,_=a.to,b=a.easing,E=a.onAnimationStart,C=a.onAnimationEnd,R=a.steps,F=a.children,U=this.manager;if(this.unSubscribe=U.subscribe(this.handleStyleChange),typeof b=="function"||typeof F=="function"||b==="spring"){this.runJSAnimation(a);return}if(R.length>1){this.runStepAnimation(a);return}var $=i?kw({},i,_):_,H=d9(Object.keys($),f,b);U.start([E,l,iu(iu({},$),{},{transition:H}),f,C])}},{key:"render",value:function(){var a=this.props,l=a.children;a.begin;var f=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var _=GFe(a,WFe),b=ne.Children.count(l),E=this.state.style;if(typeof l=="function")return l(E);if(!i||b===0||f<=0)return l;var C=function(F){var U=F.props,$=U.style,H=$===void 0?{}:$,q=U.className,G=ne.cloneElement(F,iu(iu({},_),{},{style:iu(iu({},H),E),className:q}));return G};return b===1?C(ne.Children.only(l)):ze.createElement("div",null,ne.Children.map(l,function(R){return C(R)}))}}]),r}(ne.PureComponent);qh.displayName="Animate";qh.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};qh.propTypes={from:Rn.oneOfType([Rn.object,Rn.string]),to:Rn.oneOfType([Rn.object,Rn.string]),attributeName:Rn.string,duration:Rn.number,begin:Rn.number,easing:Rn.oneOfType([Rn.string,Rn.func]),steps:Rn.arrayOf(Rn.shape({duration:Rn.number.isRequired,style:Rn.object.isRequired,easing:Rn.oneOfType([Rn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Rn.func]),properties:Rn.arrayOf("string"),onAnimationEnd:Rn.func})),children:Rn.oneOfType([Rn.node,Rn.func]),isActive:Rn.bool,canBegin:Rn.bool,onAnimationEnd:Rn.func,shouldReAnimate:Rn.bool,onAnimationStart:Rn.func,onAnimationReStart:Rn.func};Rn.object,Rn.object,Rn.object,Rn.element;Rn.object,Rn.object,Rn.object,Rn.oneOfType([Rn.array,Rn.element]),Rn.any;function CT(e){"@babel/helpers - typeof";return CT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CT(e)}function $I(){return $I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$I.apply(this,arguments)}function i4e(e,t){return l4e(e)||s4e(e,t)||a4e(e,t)||o4e()}function o4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a4e(e,t){if(e){if(typeof e=="string")return y9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y9(e,t)}}function y9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function l4e(e){if(Array.isArray(e))return e}function v9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v9(Object(r),!0).forEach(function(n){c4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c4e(e,t,r){return t=u4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u4e(e){var t=d4e(e,"string");return CT(t)=="symbol"?t:t+""}function d4e(e,t){if(CT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(CT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x9=function(t,r,n,a,l){var f=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,_=n>=0?1:-1,b=a>=0&&n>=0||a<0&&n<0?1:0,E;if(f>0&&l instanceof Array){for(var C=[0,0,0,0],R=0,F=4;R<F;R++)C[R]=l[R]>f?f:l[R];E="M".concat(t,",").concat(r+i*C[0]),C[0]>0&&(E+="A ".concat(C[0],",").concat(C[0],",0,0,").concat(b,",").concat(t+_*C[0],",").concat(r)),E+="L ".concat(t+n-_*C[1],",").concat(r),C[1]>0&&(E+="A ".concat(C[1],",").concat(C[1],",0,0,").concat(b,`,
        `).concat(t+n,",").concat(r+i*C[1])),E+="L ".concat(t+n,",").concat(r+a-i*C[2]),C[2]>0&&(E+="A ".concat(C[2],",").concat(C[2],",0,0,").concat(b,`,
        `).concat(t+n-_*C[2],",").concat(r+a)),E+="L ".concat(t+_*C[3],",").concat(r+a),C[3]>0&&(E+="A ".concat(C[3],",").concat(C[3],",0,0,").concat(b,`,
        `).concat(t,",").concat(r+a-i*C[3])),E+="Z"}else if(f>0&&l===+l&&l>0){var U=Math.min(f,l);E="M ".concat(t,",").concat(r+i*U,`
            A `).concat(U,",").concat(U,",0,0,").concat(b,",").concat(t+_*U,",").concat(r,`
            L `).concat(t+n-_*U,",").concat(r,`
            A `).concat(U,",").concat(U,",0,0,").concat(b,",").concat(t+n,",").concat(r+i*U,`
            L `).concat(t+n,",").concat(r+a-i*U,`
            A `).concat(U,",").concat(U,",0,0,").concat(b,",").concat(t+n-_*U,",").concat(r+a,`
            L `).concat(t+_*U,",").concat(r+a,`
            A `).concat(U,",").concat(U,",0,0,").concat(b,",").concat(t,",").concat(r+a-i*U," Z")}else E="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return E},h4e=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,l=r.x,f=r.y,i=r.width,_=r.height;if(Math.abs(i)>0&&Math.abs(_)>0){var b=Math.min(l,l+i),E=Math.max(l,l+i),C=Math.min(f,f+_),R=Math.max(f,f+_);return n>=b&&n<=E&&a>=C&&a<=R}return!1},f4e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Y5=function(t){var r=_9(_9({},f4e),t),n=ne.useRef(),a=ne.useState(-1),l=i4e(a,2),f=l[0],i=l[1];ne.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var te=n.current.getTotalLength();te&&i(te)}catch{}},[]);var _=r.x,b=r.y,E=r.width,C=r.height,R=r.radius,F=r.className,U=r.animationEasing,$=r.animationDuration,H=r.animationBegin,q=r.isAnimationActive,G=r.isUpdateAnimationActive;if(_!==+_||b!==+b||E!==+E||C!==+C||E===0||C===0)return null;var J=di("recharts-rectangle",F);return G?ze.createElement(qh,{canBegin:f>0,from:{width:E,height:C,x:_,y:b},to:{width:E,height:C,x:_,y:b},duration:$,animationEasing:U,isActive:G},function(te){var oe=te.width,he=te.height,le=te.x,ve=te.y;return ze.createElement(qh,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:H,duration:$,isActive:q,easing:U},ze.createElement("path",$I({},Xn(r,!0),{className:J,d:x9(le,ve,oe,he,R),ref:n})))}):ze.createElement("path",$I({},Xn(r,!0),{className:J,d:x9(_,b,E,C,R)}))};function Jj(){return Jj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jj.apply(this,arguments)}var K5=function(t){var r=t.cx,n=t.cy,a=t.r,l=t.className,f=di("recharts-dot",l);return r===+r&&n===+n&&a===+a?ze.createElement("circle",Jj({},Xn(t,!1),aI(t),{className:f,cx:r,cy:n,r:a})):null};function PT(e){"@babel/helpers - typeof";return PT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PT(e)}var p4e=["x","y","top","left","width","height","className"];function Qj(){return Qj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qj.apply(this,arguments)}function b9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function m4e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b9(Object(r),!0).forEach(function(n){g4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g4e(e,t,r){return t=y4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y4e(e){var t=v4e(e,"string");return PT(t)=="symbol"?t:t+""}function v4e(e,t){if(PT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(PT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _4e(e,t){if(e==null)return{};var r=x4e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function x4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var b4e=function(t,r,n,a,l,f){return"M".concat(t,",").concat(l,"v").concat(a,"M").concat(f,",").concat(r,"h").concat(n)},w4e=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,f=t.top,i=f===void 0?0:f,_=t.left,b=_===void 0?0:_,E=t.width,C=E===void 0?0:E,R=t.height,F=R===void 0?0:R,U=t.className,$=_4e(t,p4e),H=m4e({x:n,y:l,top:i,left:b,width:C,height:F},$);return!br(n)||!br(l)||!br(C)||!br(F)||!br(i)||!br(b)?null:ze.createElement("path",Qj({},Xn(H,!0),{className:di("recharts-cross",U),d:b4e(n,l,C,F,i,b)}))},S4e=ste,T4e=S4e(Object.getPrototypeOf,Object),E4e=T4e,A4e=Kh,M4e=E4e,C4e=Jh,P4e="[object Object]",I4e=Function.prototype,O4e=Object.prototype,Xre=I4e.toString,k4e=O4e.hasOwnProperty,R4e=Xre.call(Object);function D4e(e){if(!C4e(e)||A4e(e)!=P4e)return!1;var t=M4e(e);if(t===null)return!0;var r=k4e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Xre.call(r)==R4e}var L4e=D4e;const N4e=hi(L4e);var z4e=Kh,j4e=Jh,F4e="[object Boolean]";function B4e(e){return e===!0||e===!1||j4e(e)&&z4e(e)==F4e}var $4e=B4e;const U4e=hi($4e);function IT(e){"@babel/helpers - typeof";return IT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},IT(e)}function UI(){return UI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UI.apply(this,arguments)}function V4e(e,t){return H4e(e)||q4e(e,t)||G4e(e,t)||W4e()}function W4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G4e(e,t){if(e){if(typeof e=="string")return w9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w9(e,t)}}function w9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function H4e(e){if(Array.isArray(e))return e}function S9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S9(Object(r),!0).forEach(function(n){Z4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z4e(e,t,r){return t=X4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X4e(e){var t=Y4e(e,"string");return IT(t)=="symbol"?t:t+""}function Y4e(e,t){if(IT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(IT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E9=function(t,r,n,a,l){var f=n-a,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-f/2,",").concat(r+l),i+="L ".concat(t+n-f/2-a,",").concat(r+l),i+="L ".concat(t,",").concat(r," Z"),i},K4e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},J4e=function(t){var r=T9(T9({},K4e),t),n=ne.useRef(),a=ne.useState(-1),l=V4e(a,2),f=l[0],i=l[1];ne.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var J=n.current.getTotalLength();J&&i(J)}catch{}},[]);var _=r.x,b=r.y,E=r.upperWidth,C=r.lowerWidth,R=r.height,F=r.className,U=r.animationEasing,$=r.animationDuration,H=r.animationBegin,q=r.isUpdateAnimationActive;if(_!==+_||b!==+b||E!==+E||C!==+C||R!==+R||E===0&&C===0||R===0)return null;var G=di("recharts-trapezoid",F);return q?ze.createElement(qh,{canBegin:f>0,from:{upperWidth:0,lowerWidth:0,height:R,x:_,y:b},to:{upperWidth:E,lowerWidth:C,height:R,x:_,y:b},duration:$,animationEasing:U,isActive:q},function(J){var te=J.upperWidth,oe=J.lowerWidth,he=J.height,le=J.x,ve=J.y;return ze.createElement(qh,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:H,duration:$,easing:U},ze.createElement("path",UI({},Xn(r,!0),{className:G,d:E9(le,ve,te,oe,he),ref:n})))}):ze.createElement("g",null,ze.createElement("path",UI({},Xn(r,!0),{className:G,d:E9(_,b,E,C,R)})))},Q4e=["option","shapeType","propTransformer","activeClassName","isActive"];function OT(e){"@babel/helpers - typeof";return OT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OT(e)}function eBe(e,t){if(e==null)return{};var r=tBe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function A9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function VI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A9(Object(r),!0).forEach(function(n){rBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rBe(e,t,r){return t=nBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nBe(e){var t=iBe(e,"string");return OT(t)=="symbol"?t:t+""}function iBe(e,t){if(OT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(OT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oBe(e,t){return VI(VI({},t),e)}function aBe(e,t){return e==="symbols"}function M9(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ze.createElement(Y5,r);case"trapezoid":return ze.createElement(J4e,r);case"sector":return ze.createElement(zre,r);case"symbols":if(aBe(t))return ze.createElement(m5,r);break;default:return null}}function sBe(e){return ne.isValidElement(e)?e.props:e}function lBe(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?oBe:n,l=e.activeClassName,f=l===void 0?"recharts-active-shape":l,i=e.isActive,_=eBe(e,Q4e),b;if(ne.isValidElement(t))b=ne.cloneElement(t,VI(VI({},_),sBe(t)));else if(Vn(t))b=t(_);else if(N4e(t)&&!U4e(t)){var E=a(t,_);b=ze.createElement(M9,{shapeType:r,elementProps:E})}else{var C=_;b=ze.createElement(M9,{shapeType:r,elementProps:C})}return i?ze.createElement(To,{className:f},b):b}function qk(e,t){return t!=null&&"trapezoids"in e.props}function Hk(e,t){return t!=null&&"sectors"in e.props}function kT(e,t){return t!=null&&"points"in e.props}function cBe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,l=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&l}function uBe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function dBe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function hBe(e,t){var r;return qk(e,t)?r=cBe:Hk(e,t)?r=uBe:kT(e,t)&&(r=dBe),r}function fBe(e,t){var r;return qk(e,t)?r="trapezoids":Hk(e,t)?r="sectors":kT(e,t)&&(r="points"),r}function pBe(e,t){if(qk(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Hk(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return kT(e,t)?t.payload:{}}function mBe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=fBe(r,t),l=pBe(r,t),f=n.filter(function(_,b){var E=mT(l,_),C=r.props[a].filter(function(U){var $=hBe(r,t);return $(U,t)}),R=r.props[a].indexOf(C[C.length-1]),F=b===R;return E&&F}),i=n.indexOf(f[f.length-1]);return i}var gBe=Math.ceil,yBe=Math.max;function vBe(e,t,r,n){for(var a=-1,l=yBe(gBe((t-e)/(r||1)),0),f=Array(l);l--;)f[n?l:++a]=e,e+=r;return f}var _Be=vBe,xBe=Ate,C9=1/0,bBe=17976931348623157e292;function wBe(e){if(!e)return e===0?e:0;if(e=xBe(e),e===C9||e===-C9){var t=e<0?-1:1;return t*bBe}return e===e?e:0}var Yre=wBe,SBe=_Be,TBe=Lk,$3=Yre;function EBe(e){return function(t,r,n){return n&&typeof n!="number"&&TBe(t,r,n)&&(r=n=void 0),t=$3(t),r===void 0?(r=t,t=0):r=$3(r),n=n===void 0?t<r?1:-1:$3(n),SBe(t,r,n,e)}}var ABe=EBe,MBe=ABe,CBe=MBe(),PBe=CBe;const WI=hi(PBe);function RT(e){"@babel/helpers - typeof";return RT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RT(e)}function P9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function I9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P9(Object(r),!0).forEach(function(n){Kre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kre(e,t,r){return t=IBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IBe(e){var t=OBe(e,"string");return RT(t)=="symbol"?t:t+""}function OBe(e,t){if(RT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(RT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kBe=["Webkit","Moz","O","ms"],RBe=function(t,r){var n=t.replace(/(\w)/,function(l){return l.toUpperCase()}),a=kBe.reduce(function(l,f){return I9(I9({},l),{},Kre({},f+n,r))},{});return a[t]=r,a};function tx(e){"@babel/helpers - typeof";return tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tx(e)}function GI(){return GI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GI.apply(this,arguments)}function O9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O9(Object(r),!0).forEach(function(n){Il(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qre(n.key),n)}}function LBe(e,t,r){return t&&k9(e.prototype,t),r&&k9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NBe(e,t,r){return t=qI(t),zBe(e,Jre()?Reflect.construct(t,r||[],qI(e).constructor):t.apply(e,r))}function zBe(e,t){if(t&&(tx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jBe(e)}function jBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jre(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jre=function(){return!!e})()}function qI(e){return qI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qI(e)}function FBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eF(e,t)}function eF(e,t){return eF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},eF(e,t)}function Il(e,t,r){return t=Qre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qre(e){var t=BBe(e,"string");return tx(t)=="symbol"?t:t+""}function BBe(e,t){if(tx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Be=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,l=t.x,f=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var _=r.length,b=wS().domain(WI(0,_)).range([l,l+f-i]),E=b.domain().map(function(C){return b(C)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:b(n),endX:b(a),scale:b,scaleValues:E}},R9=function(t){return t.changedTouches&&!!t.changedTouches.length},rx=function(e){function t(r){var n;return DBe(this,t),n=NBe(this,t,[r]),Il(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Il(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Il(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,l=a.endIndex,f=a.onDragEnd,i=a.startIndex;f==null||f({endIndex:l,startIndex:i})}),n.detachDragEndListener()}),Il(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Il(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Il(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Il(n,"handleSlideDragStart",function(a){var l=R9(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return FBe(t,e),LBe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,l=n.endX,f=this.state.scaleValues,i=this.props,_=i.gap,b=i.data,E=b.length-1,C=Math.min(a,l),R=Math.max(a,l),F=t.getIndexInRange(f,C),U=t.getIndexInRange(f,R);return{startIndex:F-F%_,endIndex:U===E?E:U-U%_}}},{key:"getTextOfTick",value:function(n){var a=this.props,l=a.data,f=a.tickFormatter,i=a.dataKey,_=Hl(l[n],i,n);return Vn(f)?f(_,n):_}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,l=a.slideMoveStartX,f=a.startX,i=a.endX,_=this.props,b=_.x,E=_.width,C=_.travellerWidth,R=_.startIndex,F=_.endIndex,U=_.onChange,$=n.pageX-l;$>0?$=Math.min($,b+E-C-i,b+E-C-f):$<0&&($=Math.max($,b-f,b-i));var H=this.getIndex({startX:f+$,endX:i+$});(H.startIndex!==R||H.endIndex!==F)&&U&&U(H),this.setState({startX:f+$,endX:i+$,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var l=R9(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,l=a.brushMoveStartX,f=a.movingTravellerId,i=a.endX,_=a.startX,b=this.state[f],E=this.props,C=E.x,R=E.width,F=E.travellerWidth,U=E.onChange,$=E.gap,H=E.data,q={startX:this.state.startX,endX:this.state.endX},G=n.pageX-l;G>0?G=Math.min(G,C+R-F-b):G<0&&(G=Math.max(G,C-b)),q[f]=b+G;var J=this.getIndex(q),te=J.startIndex,oe=J.endIndex,he=function(){var ve=H.length-1;return f==="startX"&&(i>_?te%$===0:oe%$===0)||i<_&&oe===ve||f==="endX"&&(i>_?oe%$===0:te%$===0)||i>_&&oe===ve};this.setState(Il(Il({},f,b+G),"brushMoveStartX",n.pageX),function(){U&&he()&&U(J)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var l=this,f=this.state,i=f.scaleValues,_=f.startX,b=f.endX,E=this.state[a],C=i.indexOf(E);if(C!==-1){var R=C+n;if(!(R===-1||R>=i.length)){var F=i[R];a==="startX"&&F>=b||a==="endX"&&F<=_||this.setState(Il({},a,F),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,l=n.y,f=n.width,i=n.height,_=n.fill,b=n.stroke;return ze.createElement("rect",{stroke:b,fill:_,x:a,y:l,width:f,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,l=n.y,f=n.width,i=n.height,_=n.data,b=n.children,E=n.padding,C=ne.Children.only(b);return C?ze.cloneElement(C,{x:a,y:l,width:f,height:i,margin:E,compact:!0,data:_}):null}},{key:"renderTravellerLayer",value:function(n,a){var l,f,i=this,_=this.props,b=_.y,E=_.travellerWidth,C=_.height,R=_.traveller,F=_.ariaLabel,U=_.data,$=_.startIndex,H=_.endIndex,q=Math.max(n,this.props.x),G=U3(U3({},Xn(this.props,!1)),{},{x:q,y:b,width:E,height:C}),J=F||"Min value: ".concat((l=U[$])===null||l===void 0?void 0:l.name,", Max value: ").concat((f=U[H])===null||f===void 0?void 0:f.name);return ze.createElement(To,{tabIndex:0,role:"slider","aria-label":J,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(oe){["ArrowLeft","ArrowRight"].includes(oe.key)&&(oe.preventDefault(),oe.stopPropagation(),i.handleTravellerMoveKeyboard(oe.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(R,G))}},{key:"renderSlide",value:function(n,a){var l=this.props,f=l.y,i=l.height,_=l.stroke,b=l.travellerWidth,E=Math.min(n,a)+b,C=Math.max(Math.abs(a-n)-b,0);return ze.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:_,fillOpacity:.2,x:E,y:f,width:C,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,l=n.endIndex,f=n.y,i=n.height,_=n.travellerWidth,b=n.stroke,E=this.state,C=E.startX,R=E.endX,F=5,U={pointerEvents:"none",fill:b};return ze.createElement(To,{className:"recharts-brush-texts"},ze.createElement(bI,GI({textAnchor:"end",verticalAnchor:"middle",x:Math.min(C,R)-F,y:f+i/2},U),this.getTextOfTick(a)),ze.createElement(bI,GI({textAnchor:"start",verticalAnchor:"middle",x:Math.max(C,R)+_+F,y:f+i/2},U),this.getTextOfTick(l)))}},{key:"render",value:function(){var n=this.props,a=n.data,l=n.className,f=n.children,i=n.x,_=n.y,b=n.width,E=n.height,C=n.alwaysShowText,R=this.state,F=R.startX,U=R.endX,$=R.isTextActive,H=R.isSlideMoving,q=R.isTravellerMoving,G=R.isTravellerFocused;if(!a||!a.length||!br(i)||!br(_)||!br(b)||!br(E)||b<=0||E<=0)return null;var J=di("recharts-brush",l),te=ze.Children.count(f)===1,oe=RBe("userSelect","none");return ze.createElement(To,{className:J,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:oe},this.renderBackground(),te&&this.renderPanorama(),this.renderSlide(F,U),this.renderTravellerLayer(F,"startX"),this.renderTravellerLayer(U,"endX"),($||H||q||G||C)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,l=n.y,f=n.width,i=n.height,_=n.stroke,b=Math.floor(l+i/2)-1;return ze.createElement(ze.Fragment,null,ze.createElement("rect",{x:a,y:l,width:f,height:i,fill:_,stroke:"none"}),ze.createElement("line",{x1:a+1,y1:b,x2:a+f-1,y2:b,fill:"none",stroke:"#fff"}),ze.createElement("line",{x1:a+1,y1:b+2,x2:a+f-1,y2:b+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var l;return ze.isValidElement(n)?l=ze.cloneElement(n,a):Vn(n)?l=n(a):l=t.renderDefaultTraveller(a),l}},{key:"getDerivedStateFromProps",value:function(n,a){var l=n.data,f=n.width,i=n.x,_=n.travellerWidth,b=n.updateId,E=n.startIndex,C=n.endIndex;if(l!==a.prevData||b!==a.prevUpdateId)return U3({prevData:l,prevTravellerWidth:_,prevUpdateId:b,prevX:i,prevWidth:f},l&&l.length?$Be({data:l,width:f,x:i,travellerWidth:_,startIndex:E,endIndex:C}):{scale:null,scaleValues:null});if(a.scale&&(f!==a.prevWidth||i!==a.prevX||_!==a.prevTravellerWidth)){a.scale.range([i,i+f-_]);var R=a.scale.domain().map(function(F){return a.scale(F)});return{prevData:l,prevTravellerWidth:_,prevUpdateId:b,prevX:i,prevWidth:f,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:R}}return null}},{key:"getIndexInRange",value:function(n,a){for(var l=n.length,f=0,i=l-1;i-f>1;){var _=Math.floor((f+i)/2);n[_]>a?i=_:f=_}return a>=n[i]?i:f}}])}(ne.PureComponent);Il(rx,"displayName","Brush");Il(rx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var UBe=w5;function VBe(e,t){var r;return UBe(e,function(n,a,l){return r=t(n,a,l),!r}),!!r}var WBe=VBe,GBe=Qee,qBe=_m,HBe=WBe,ZBe=gl,XBe=Lk;function YBe(e,t,r){var n=ZBe(e)?GBe:HBe;return r&&XBe(e,t,r)&&(t=void 0),n(e,qBe(t))}var KBe=YBe;const JBe=hi(KBe);var Pd=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},D9=bte;function QBe(e,t,r){t=="__proto__"&&D9?D9(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var e5e=QBe,t5e=e5e,r5e=_te,n5e=_m;function i5e(e,t){var r={};return t=n5e(t),r5e(e,function(n,a,l){t5e(r,a,t(n,a,l))}),r}var o5e=i5e;const a5e=hi(o5e);function s5e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var l5e=s5e,c5e=w5;function u5e(e,t){var r=!0;return c5e(e,function(n,a,l){return r=!!t(n,a,l),r}),r}var d5e=u5e,h5e=l5e,f5e=d5e,p5e=_m,m5e=gl,g5e=Lk;function y5e(e,t,r){var n=m5e(e)?h5e:f5e;return r&&g5e(e,t,r)&&(t=void 0),n(e,p5e(t))}var v5e=y5e;const ene=hi(v5e);var _5e=["x","y"];function DT(e){"@babel/helpers - typeof";return DT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DT(e)}function tF(){return tF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tF.apply(this,arguments)}function L9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L9(Object(r),!0).forEach(function(n){x5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x5e(e,t,r){return t=b5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b5e(e){var t=w5e(e,"string");return DT(t)=="symbol"?t:t+""}function w5e(e,t){if(DT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(DT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S5e(e,t){if(e==null)return{};var r=T5e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function E5e(e,t){var r=e.x,n=e.y,a=S5e(e,_5e),l="".concat(r),f=parseInt(l,10),i="".concat(n),_=parseInt(i,10),b="".concat(t.height||a.height),E=parseInt(b,10),C="".concat(t.width||a.width),R=parseInt(C,10);return vw(vw(vw(vw(vw({},t),a),f?{x:f}:{}),_?{y:_}:{}),{},{height:E,width:R,name:t.name,radius:t.radius})}function N9(e){return ze.createElement(lBe,tF({shapeType:"rectangle",propTransformer:E5e,activeClassName:"recharts-active-bar"},e))}var A5e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var l=typeof n=="number";return l?t(n,a):(l||wy(),r)}},M5e=["value","background"],tne;function nx(e){"@babel/helpers - typeof";return nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nx(e)}function C5e(e,t){if(e==null)return{};var r=P5e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function P5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HI(){return HI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HI.apply(this,arguments)}function z9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ea(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z9(Object(r),!0).forEach(function(n){jp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nne(n.key),n)}}function O5e(e,t,r){return t&&j9(e.prototype,t),r&&j9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k5e(e,t,r){return t=ZI(t),R5e(e,rne()?Reflect.construct(t,r||[],ZI(e).constructor):t.apply(e,r))}function R5e(e,t){if(t&&(nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D5e(e)}function D5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rne=function(){return!!e})()}function ZI(e){return ZI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ZI(e)}function L5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rF(e,t)}function rF(e,t){return rF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rF(e,t)}function jp(e,t,r){return t=nne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nne(e){var t=N5e(e,"string");return nx(t)=="symbol"?t:t+""}function N5e(e,t){if(nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var am=function(e){function t(){var r;I5e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=k5e(this,t,[].concat(a)),jp(r,"state",{isAnimationFinished:!1}),jp(r,"id",xE("recharts-bar-")),jp(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),f&&f()}),jp(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),f&&f()}),r}return L5e(t,e),O5e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,l=this.props,f=l.shape,i=l.dataKey,_=l.activeIndex,b=l.activeBar,E=Xn(this.props,!1);return n&&n.map(function(C,R){var F=R===_,U=F?b:f,$=ea(ea(ea({},E),C),{},{isActive:F,option:U,index:R,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return ze.createElement(To,HI({className:"recharts-bar-rectangle"},sI(a.props,C,R),{key:"rectangle-".concat(C==null?void 0:C.x,"-").concat(C==null?void 0:C.y,"-").concat(C==null?void 0:C.value)}),ze.createElement(N9,$))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,l=a.data,f=a.layout,i=a.isAnimationActive,_=a.animationBegin,b=a.animationDuration,E=a.animationEasing,C=a.animationId,R=this.state.prevData;return ze.createElement(qh,{begin:_,duration:b,isActive:i,easing:E,from:{t:0},to:{t:1},key:"bar-".concat(C),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(F){var U=F.t,$=l.map(function(H,q){var G=R&&R[q];if(G){var J=_c(G.x,H.x),te=_c(G.y,H.y),oe=_c(G.width,H.width),he=_c(G.height,H.height);return ea(ea({},H),{},{x:J(U),y:te(U),width:oe(U),height:he(U)})}if(f==="horizontal"){var le=_c(0,H.height),ve=le(U);return ea(ea({},H),{},{y:H.y+H.height-ve,height:ve})}var We=_c(0,H.width),Ie=We(U);return ea(ea({},H),{},{width:Ie})});return ze.createElement(To,null,n.renderRectanglesStatically($))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,l=n.isAnimationActive,f=this.state.prevData;return l&&a&&a.length&&(!f||!mT(f,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,l=a.data,f=a.dataKey,i=a.activeIndex,_=Xn(this.props.background,!1);return l.map(function(b,E){b.value;var C=b.background,R=C5e(b,M5e);if(!C)return null;var F=ea(ea(ea(ea(ea({},R),{},{fill:"#eee"},C),_),sI(n.props,b,E)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:f,index:E,className:"recharts-bar-background-rectangle"});return ze.createElement(N9,HI({key:"background-bar-".concat(E),option:n.props.background,isActive:E===i},F))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,f=l.data,i=l.xAxis,_=l.yAxis,b=l.layout,E=l.children,C=Tu(E,Gk);if(!C)return null;var R=b==="vertical"?f[0].height/2:f[0].width/2,F=function(H,q){var G=Array.isArray(H.value)?H.value[1]:H.value;return{x:H.x,y:H.y,value:G,errorVal:Hl(H,q)}},U={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ze.createElement(To,U,C.map(function($){return ze.cloneElement($,{key:"error-bar-".concat(a,"-").concat($.props.dataKey),data:f,xAxis:i,yAxis:_,layout:b,offset:R,dataPointFormatter:F})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.data,f=n.className,i=n.xAxis,_=n.yAxis,b=n.left,E=n.top,C=n.width,R=n.height,F=n.isAnimationActive,U=n.background,$=n.id;if(a||!l||!l.length)return null;var H=this.state.isAnimationFinished,q=di("recharts-bar",f),G=i&&i.allowDataOverflow,J=_&&_.allowDataOverflow,te=G||J,oe=oi($)?this.id:$;return ze.createElement(To,{className:q},G||J?ze.createElement("defs",null,ze.createElement("clipPath",{id:"clipPath-".concat(oe)},ze.createElement("rect",{x:G?b:b-C/2,y:J?E:E-R/2,width:G?C:C*2,height:J?R:R*2}))):null,ze.createElement(To,{className:"recharts-bar-rectangles",clipPath:te?"url(#clipPath-".concat(oe,")"):null},U?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(te,oe),(!F||H)&&Yp.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(ne.PureComponent);tne=am;jp(am,"displayName","Bar");jp(am,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!kh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});jp(am,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,l=e.xAxis,f=e.yAxis,i=e.xAxisTicks,_=e.yAxisTicks,b=e.stackedData,E=e.dataStartIndex,C=e.displayedData,R=e.offset,F=wze(n,r);if(!F)return null;var U=t.layout,$=r.type.defaultProps,H=$!==void 0?ea(ea({},$),r.props):r.props,q=H.dataKey,G=H.children,J=H.minPointSize,te=U==="horizontal"?f:l,oe=b?te.scale.domain():null,he=Ize({numericAxis:te}),le=Tu(G,Cte),ve=C.map(function(We,Ie){var Re,$e,ot,Je,rt,st;b?Re=Sze(b[E+Ie],oe):(Re=Hl(We,q),Array.isArray(Re)||(Re=[he,Re]));var at=A5e(J,tne.defaultProps.minPointSize)(Re[1],Ie);if(U==="horizontal"){var Be,ct=[f.scale(Re[0]),f.scale(Re[1])],jt=ct[0],Lt=ct[1];$e=z7({axis:l,ticks:i,bandSize:a,offset:F.offset,entry:We,index:Ie}),ot=(Be=Lt??jt)!==null&&Be!==void 0?Be:void 0,Je=F.size;var $t=jt-Lt;if(rt=Number.isNaN($t)?0:$t,st={x:$e,y:f.y,width:Je,height:f.height},Math.abs(at)>0&&Math.abs(rt)<Math.abs(at)){var ut=_u(rt||at)*(Math.abs(at)-Math.abs(rt));ot-=ut,rt+=ut}}else{var tr=[l.scale(Re[0]),l.scale(Re[1])],mr=tr[0],rr=tr[1];if($e=mr,ot=z7({axis:f,ticks:_,bandSize:a,offset:F.offset,entry:We,index:Ie}),Je=rr-mr,rt=F.size,st={x:l.x,y:ot,width:l.width,height:rt},Math.abs(at)>0&&Math.abs(Je)<Math.abs(at)){var Ut=_u(Je||at)*(Math.abs(at)-Math.abs(Je));Je+=Ut}}return ea(ea(ea({},We),{},{x:$e,y:ot,width:Je,height:rt,value:b?Re:Re[1],payload:We,background:st},le&&le[Ie]&&le[Ie].props),{},{tooltipPayload:[Dre(r,We)],tooltipPosition:{x:$e+Je/2,y:ot+rt/2}})});return ea({data:ve,layout:U},R)});function LT(e){"@babel/helpers - typeof";return LT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LT(e)}function z5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ine(n.key),n)}}function j5e(e,t,r){return t&&F9(e.prototype,t),r&&F9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B9(Object(r),!0).forEach(function(n){Zk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zk(e,t,r){return t=ine(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ine(e){var t=F5e(e,"string");return LT(t)=="symbol"?t:t+""}function F5e(e,t){if(LT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(LT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var one=function(t,r,n,a,l){var f=t.width,i=t.height,_=t.layout,b=t.children,E=Object.keys(r),C={left:n.left,leftMirror:n.left,right:f-n.right,rightMirror:f-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},R=!!Dl(b,am);return E.reduce(function(F,U){var $=r[U],H=$.orientation,q=$.domain,G=$.padding,J=G===void 0?{}:G,te=$.mirror,oe=$.reversed,he="".concat(H).concat(te?"Mirror":""),le,ve,We,Ie,Re;if($.type==="number"&&($.padding==="gap"||$.padding==="no-gap")){var $e=q[1]-q[0],ot=1/0,Je=$.categoricalDomain.sort();if(Je.forEach(function(tr,mr){mr>0&&(ot=Math.min((tr||0)-(Je[mr-1]||0),ot))}),Number.isFinite(ot)){var rt=ot/$e,st=$.layout==="vertical"?n.height:n.width;if($.padding==="gap"&&(le=rt*st/2),$.padding==="no-gap"){var at=xy(t.barCategoryGap,rt*st),Be=rt*st/2;le=Be-at-(Be-at)/st*at}}}a==="xAxis"?ve=[n.left+(J.left||0)+(le||0),n.left+n.width-(J.right||0)-(le||0)]:a==="yAxis"?ve=_==="horizontal"?[n.top+n.height-(J.bottom||0),n.top+(J.top||0)]:[n.top+(J.top||0)+(le||0),n.top+n.height-(J.bottom||0)-(le||0)]:ve=$.range,oe&&(ve=[ve[1],ve[0]]);var ct=xze($,l,R),jt=ct.scale,Lt=ct.realScaleType;jt.domain(q).range(ve),bze(jt);var $t=Pze(jt,fu(fu({},$),{},{realScaleType:Lt}));a==="xAxis"?(Re=H==="top"&&!te||H==="bottom"&&te,We=n.left,Ie=C[he]-Re*$.height):a==="yAxis"&&(Re=H==="left"&&!te||H==="right"&&te,We=C[he]-Re*$.width,Ie=n.top);var ut=fu(fu(fu({},$),$t),{},{realScaleType:Lt,x:We,y:Ie,scale:jt,width:a==="xAxis"?n.width:$.width,height:a==="yAxis"?n.height:$.height});return ut.bandSize=LI(ut,$t),!$.hide&&a==="xAxis"?C[he]+=(Re?-1:1)*ut.height:$.hide||(C[he]+=(Re?-1:1)*ut.width),fu(fu({},F),{},Zk({},U,ut))},{})},ane=function(t,r){var n=t.x,a=t.y,l=r.x,f=r.y;return{x:Math.min(n,l),y:Math.min(a,f),width:Math.abs(l-n),height:Math.abs(f-a)}},B5e=function(t){var r=t.x1,n=t.y1,a=t.x2,l=t.y2;return ane({x:r,y:n},{x:a,y:l})},sne=function(){function e(t){z5e(this,e),this.scale=t}return j5e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,l=n.position;if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+f}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(a){var _=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+_}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],l=n[n.length-1];return a<=l?r>=a&&r<=l:r>=l&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();Zk(sne,"EPS",1e-4);var J5=function(t){var r=Object.keys(t).reduce(function(n,a){return fu(fu({},n),{},Zk({},a,sne.create(t[a])))},{});return fu(fu({},r),{},{apply:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=l.bandAware,i=l.position;return a5e(a,function(_,b){return r[b].apply(_,{bandAware:f,position:i})})},isInRange:function(a){return ene(a,function(l,f){return r[f].isInRange(l)})}})};function $5e(e){return(e%180+180)%180}var U5e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=$5e(a),f=l*Math.PI/180,i=Math.atan(n/r),_=f>i&&f<Math.PI-i?n/Math.sin(f):r/Math.cos(f);return Math.abs(_)},V5e=_m,W5e=bE,G5e=Rk;function q5e(e){return function(t,r,n){var a=Object(t);if(!W5e(t)){var l=V5e(r);t=G5e(t),r=function(i){return l(a[i],i,a)}}var f=e(t,r,n);return f>-1?a[l?t[f]:f]:void 0}}var H5e=q5e,Z5e=Yre;function X5e(e){var t=Z5e(e),r=t%1;return t===t?r?t-r:t:0}var Y5e=X5e,K5e=fte,J5e=_m,Q5e=Y5e,e$e=Math.max;function t$e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:Q5e(r);return a<0&&(a=e$e(n+a,0)),K5e(e,J5e(t),a)}var r$e=t$e,n$e=H5e,i$e=r$e,o$e=n$e(i$e),a$e=o$e;const s$e=hi(a$e);var l$e=aSe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Q5=ne.createContext(void 0),e$=ne.createContext(void 0),lne=ne.createContext(void 0),cne=ne.createContext({}),une=ne.createContext(void 0),dne=ne.createContext(0),hne=ne.createContext(0),$9=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,l=r.offset,f=t.clipPathId,i=t.children,_=t.width,b=t.height,E=l$e(l);return ze.createElement(Q5.Provider,{value:n},ze.createElement(e$.Provider,{value:a},ze.createElement(cne.Provider,{value:l},ze.createElement(lne.Provider,{value:E},ze.createElement(une.Provider,{value:f},ze.createElement(dne.Provider,{value:b},ze.createElement(hne.Provider,{value:_},i)))))))},c$e=function(){return ne.useContext(une)},fne=function(t){var r=ne.useContext(Q5);r==null&&wy();var n=r[t];return n==null&&wy(),n},u$e=function(){var t=ne.useContext(Q5);return wp(t)},d$e=function(){var t=ne.useContext(e$),r=s$e(t,function(n){return ene(n.domain,Number.isFinite)});return r||wp(t)},pne=function(t){var r=ne.useContext(e$);r==null&&wy();var n=r[t];return n==null&&wy(),n},h$e=function(){var t=ne.useContext(lne);return t},f$e=function(){return ne.useContext(cne)},t$=function(){return ne.useContext(hne)},r$=function(){return ne.useContext(dne)};function ix(e){"@babel/helpers - typeof";return ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ix(e)}function p$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gne(n.key),n)}}function g$e(e,t,r){return t&&m$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function y$e(e,t,r){return t=XI(t),v$e(e,mne()?Reflect.construct(t,r||[],XI(e).constructor):t.apply(e,r))}function v$e(e,t){if(t&&(ix(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _$e(e)}function _$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mne=function(){return!!e})()}function XI(e){return XI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XI(e)}function x$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nF(e,t)}function nF(e,t){return nF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},nF(e,t)}function U9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U9(Object(r),!0).forEach(function(n){n$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n$(e,t,r){return t=gne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gne(e){var t=b$e(e,"string");return ix(t)=="symbol"?t:t+""}function b$e(e,t){if(ix(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ix(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w$e(e,t){return A$e(e)||E$e(e,t)||T$e(e,t)||S$e()}function S$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T$e(e,t){if(e){if(typeof e=="string")return W9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W9(e,t)}}function W9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function A$e(e){if(Array.isArray(e))return e}function iF(){return iF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iF.apply(this,arguments)}var M$e=function(t,r){var n;return ze.isValidElement(t)?n=ze.cloneElement(t,r):Vn(t)?n=t(r):n=ze.createElement("line",iF({},r,{className:"recharts-reference-line-line"})),n},C$e=function(t,r,n,a,l,f,i,_,b){var E=l.x,C=l.y,R=l.width,F=l.height;if(n){var U=b.y,$=t.y.apply(U,{position:f});if(Pd(b,"discard")&&!t.y.isInRange($))return null;var H=[{x:E+R,y:$},{x:E,y:$}];return _==="left"?H.reverse():H}if(r){var q=b.x,G=t.x.apply(q,{position:f});if(Pd(b,"discard")&&!t.x.isInRange(G))return null;var J=[{x:G,y:C+F},{x:G,y:C}];return i==="top"?J.reverse():J}if(a){var te=b.segment,oe=te.map(function(he){return t.apply(he,{position:f})});return Pd(b,"discard")&&JBe(oe,function(he){return!t.isInRange(he)})?null:oe}return null};function P$e(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,l=e.yAxisId,f=e.shape,i=e.className,_=e.alwaysShow,b=c$e(),E=fne(a),C=pne(l),R=h$e();if(!b||!R)return null;Oh(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var F=J5({x:E.scale,y:C.scale}),U=ya(t),$=ya(r),H=n&&n.length===2,q=C$e(F,U,$,H,R,e.position,E.orientation,C.orientation,e);if(!q)return null;var G=w$e(q,2),J=G[0],te=J.x,oe=J.y,he=G[1],le=he.x,ve=he.y,We=Pd(e,"hidden")?"url(#".concat(b,")"):void 0,Ie=V9(V9({clipPath:We},Xn(e,!0)),{},{x1:te,y1:oe,x2:le,y2:ve});return ze.createElement(To,{className:di("recharts-reference-line",i)},M$e(f,Ie),rs.renderCallByParent(e,B5e({x1:te,y1:oe,x2:le,y2:ve})))}var i$=function(e){function t(){return p$e(this,t),y$e(this,t,arguments)}return x$e(t,e),g$e(t,[{key:"render",value:function(){return ze.createElement(P$e,this.props)}}])}(ze.Component);n$(i$,"displayName","ReferenceLine");n$(i$,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function oF(){return oF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oF.apply(this,arguments)}function ox(e){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(e)}function G9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G9(Object(r),!0).forEach(function(n){Xk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vne(n.key),n)}}function k$e(e,t,r){return t&&O$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function R$e(e,t,r){return t=YI(t),D$e(e,yne()?Reflect.construct(t,r||[],YI(e).constructor):t.apply(e,r))}function D$e(e,t){if(t&&(ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L$e(e)}function L$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yne=function(){return!!e})()}function YI(e){return YI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YI(e)}function N$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aF(e,t)}function aF(e,t){return aF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},aF(e,t)}function Xk(e,t,r){return t=vne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vne(e){var t=z$e(e,"string");return ox(t)=="symbol"?t:t+""}function z$e(e,t){if(ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j$e=function(t){var r=t.x,n=t.y,a=t.xAxis,l=t.yAxis,f=J5({x:a.scale,y:l.scale}),i=f.apply({x:r,y:n},{bandAware:!0});return Pd(t,"discard")&&!f.isInRange(i)?null:i},Yk=function(e){function t(){return I$e(this,t),R$e(this,t,arguments)}return N$e(t,e),k$e(t,[{key:"render",value:function(){var n=this.props,a=n.x,l=n.y,f=n.r,i=n.alwaysShow,_=n.clipPathId,b=ya(a),E=ya(l);if(Oh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!b||!E)return null;var C=j$e(this.props);if(!C)return null;var R=C.x,F=C.y,U=this.props,$=U.shape,H=U.className,q=Pd(this.props,"hidden")?"url(#".concat(_,")"):void 0,G=q9(q9({clipPath:q},Xn(this.props,!0)),{},{cx:R,cy:F});return ze.createElement(To,{className:di("recharts-reference-dot",H)},t.renderDot($,G),rs.renderCallByParent(this.props,{x:R-f,y:F-f,width:2*f,height:2*f}))}}])}(ze.Component);Xk(Yk,"displayName","ReferenceDot");Xk(Yk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Xk(Yk,"renderDot",function(e,t){var r;return ze.isValidElement(e)?r=ze.cloneElement(e,t):Vn(e)?r=e(t):r=ze.createElement(K5,oF({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function sF(){return sF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sF.apply(this,arguments)}function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function H9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Z9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H9(Object(r),!0).forEach(function(n){Kk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xne(n.key),n)}}function $$e(e,t,r){return t&&B$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function U$e(e,t,r){return t=KI(t),V$e(e,_ne()?Reflect.construct(t,r||[],KI(e).constructor):t.apply(e,r))}function V$e(e,t){if(t&&(ax(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W$e(e)}function W$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_ne=function(){return!!e})()}function KI(e){return KI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KI(e)}function G$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lF(e,t)}function lF(e,t){return lF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},lF(e,t)}function Kk(e,t,r){return t=xne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xne(e){var t=q$e(e,"string");return ax(t)=="symbol"?t:t+""}function q$e(e,t){if(ax(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ax(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H$e=function(t,r,n,a,l){var f=l.x1,i=l.x2,_=l.y1,b=l.y2,E=l.xAxis,C=l.yAxis;if(!E||!C)return null;var R=J5({x:E.scale,y:C.scale}),F={x:t?R.x.apply(f,{position:"start"}):R.x.rangeMin,y:n?R.y.apply(_,{position:"start"}):R.y.rangeMin},U={x:r?R.x.apply(i,{position:"end"}):R.x.rangeMax,y:a?R.y.apply(b,{position:"end"}):R.y.rangeMax};return Pd(l,"discard")&&(!R.isInRange(F)||!R.isInRange(U))?null:ane(F,U)},Jk=function(e){function t(){return F$e(this,t),U$e(this,t,arguments)}return G$e(t,e),$$e(t,[{key:"render",value:function(){var n=this.props,a=n.x1,l=n.x2,f=n.y1,i=n.y2,_=n.className,b=n.alwaysShow,E=n.clipPathId;Oh(b===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=ya(a),R=ya(l),F=ya(f),U=ya(i),$=this.props.shape;if(!C&&!R&&!F&&!U&&!$)return null;var H=H$e(C,R,F,U,this.props);if(!H&&!$)return null;var q=Pd(this.props,"hidden")?"url(#".concat(E,")"):void 0;return ze.createElement(To,{className:di("recharts-reference-area",_)},t.renderRect($,Z9(Z9({clipPath:q},Xn(this.props,!0)),H)),rs.renderCallByParent(this.props,H))}}])}(ze.Component);Kk(Jk,"displayName","ReferenceArea");Kk(Jk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Kk(Jk,"renderRect",function(e,t){var r;return ze.isValidElement(e)?r=ze.cloneElement(e,t):Vn(e)?r=e(t):r=ze.createElement(Y5,sF({},t,{className:"recharts-reference-area-rect"})),r});function bne(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function Z$e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return U5e(n,r)}function X$e(e,t,r){var n=r==="width",a=e.x,l=e.y,f=e.width,i=e.height;return t===1?{start:n?a:l,end:n?a+f:l+i}:{start:n?a+f:l+i,end:n?a:l}}function JI(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var l=r();return e*(t-e*l/2-n)>=0&&e*(t+e*l/2-a)<=0}function Y$e(e,t){return bne(e,t+1)}function K$e(e,t,r,n,a){for(var l=(n||[]).slice(),f=t.start,i=t.end,_=0,b=1,E=f,C=function(){var U=n==null?void 0:n[_];if(U===void 0)return{v:bne(n,b)};var $=_,H,q=function(){return H===void 0&&(H=r(U,$)),H},G=U.coordinate,J=_===0||JI(e,G,q,E,i);J||(_=0,E=f,b+=1),J&&(E=G+e*(q()/2+a),_+=b)},R;b<=l.length;)if(R=C(),R)return R.v;return[]}function NT(e){"@babel/helpers - typeof";return NT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NT(e)}function X9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X9(Object(r),!0).forEach(function(n){J$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J$e(e,t,r){return t=Q$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q$e(e){var t=eUe(e,"string");return NT(t)=="symbol"?t:t+""}function eUe(e,t){if(NT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(NT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tUe(e,t,r,n,a){for(var l=(n||[]).slice(),f=l.length,i=t.start,_=t.end,b=function(R){var F=l[R],U,$=function(){return U===void 0&&(U=r(F,R)),U};if(R===f-1){var H=e*(F.coordinate+e*$()/2-_);l[R]=F=Qa(Qa({},F),{},{tickCoord:H>0?F.coordinate-H*e:F.coordinate})}else l[R]=F=Qa(Qa({},F),{},{tickCoord:F.coordinate});var q=JI(e,F.tickCoord,$,i,_);q&&(_=F.tickCoord-e*($()/2+a),l[R]=Qa(Qa({},F),{},{isShow:!0}))},E=f-1;E>=0;E--)b(E);return l}function rUe(e,t,r,n,a,l){var f=(n||[]).slice(),i=f.length,_=t.start,b=t.end;if(l){var E=n[i-1],C=r(E,i-1),R=e*(E.coordinate+e*C/2-b);f[i-1]=E=Qa(Qa({},E),{},{tickCoord:R>0?E.coordinate-R*e:E.coordinate});var F=JI(e,E.tickCoord,function(){return C},_,b);F&&(b=E.tickCoord-e*(C/2+a),f[i-1]=Qa(Qa({},E),{},{isShow:!0}))}for(var U=l?i-1:i,$=function(G){var J=f[G],te,oe=function(){return te===void 0&&(te=r(J,G)),te};if(G===0){var he=e*(J.coordinate-e*oe()/2-_);f[G]=J=Qa(Qa({},J),{},{tickCoord:he<0?J.coordinate-he*e:J.coordinate})}else f[G]=J=Qa(Qa({},J),{},{tickCoord:J.coordinate});var le=JI(e,J.tickCoord,oe,_,b);le&&(_=J.tickCoord+e*(oe()/2+a),f[G]=Qa(Qa({},J),{},{isShow:!0}))},H=0;H<U;H++)$(H);return f}function o$(e,t,r){var n=e.tick,a=e.ticks,l=e.viewBox,f=e.minTickGap,i=e.orientation,_=e.interval,b=e.tickFormatter,E=e.unit,C=e.angle;if(!a||!a.length||!n)return[];if(br(_)||kh.isSsr)return Y$e(a,typeof _=="number"&&br(_)?_:0);var R=[],F=i==="top"||i==="bottom"?"width":"height",U=E&&F==="width"?bS(E,{fontSize:t,letterSpacing:r}):{width:0,height:0},$=function(J,te){var oe=Vn(b)?b(J.value,te):J.value;return F==="width"?Z$e(bS(oe,{fontSize:t,letterSpacing:r}),U,C):bS(oe,{fontSize:t,letterSpacing:r})[F]},H=a.length>=2?_u(a[1].coordinate-a[0].coordinate):1,q=X$e(l,H,F);return _==="equidistantPreserveStart"?K$e(H,q,$,a,f):(_==="preserveStart"||_==="preserveStartEnd"?R=rUe(H,q,$,a,f,_==="preserveStartEnd"):R=tUe(H,q,$,a,f),R.filter(function(G){return G.isShow}))}var nUe=["viewBox"],iUe=["viewBox"],oUe=["ticks"];function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}function J_(){return J_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J_.apply(this,arguments)}function Y9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y9(Object(r),!0).forEach(function(n){a$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V3(e,t){if(e==null)return{};var r=aUe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aUe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sne(n.key),n)}}function lUe(e,t,r){return t&&K9(e.prototype,t),r&&K9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cUe(e,t,r){return t=QI(t),uUe(e,wne()?Reflect.construct(t,r||[],QI(e).constructor):t.apply(e,r))}function uUe(e,t){if(t&&(sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dUe(e)}function dUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wne=function(){return!!e})()}function QI(e){return QI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QI(e)}function hUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cF(e,t)}function cF(e,t){return cF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},cF(e,t)}function a$(e,t,r){return t=Sne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sne(e){var t=fUe(e,"string");return sx(t)=="symbol"?t:t+""}function fUe(e,t){if(sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jx=function(e){function t(r){var n;return sUe(this,t),n=cUe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return hUe(t,e),lUe(t,[{key:"shouldComponentUpdate",value:function(n,a){var l=n.viewBox,f=V3(n,nUe),i=this.props,_=i.viewBox,b=V3(i,iUe);return!f0(l,_)||!f0(f,b)||!f0(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,l=a.x,f=a.y,i=a.width,_=a.height,b=a.orientation,E=a.tickSize,C=a.mirror,R=a.tickMargin,F,U,$,H,q,G,J=C?-1:1,te=n.tickSize||E,oe=br(n.tickCoord)?n.tickCoord:n.coordinate;switch(b){case"top":F=U=n.coordinate,H=f+ +!C*_,$=H-J*te,G=$-J*R,q=oe;break;case"left":$=H=n.coordinate,U=l+ +!C*i,F=U-J*te,q=F-J*R,G=oe;break;case"right":$=H=n.coordinate,U=l+ +C*i,F=U+J*te,q=F+J*R,G=oe;break;default:F=U=n.coordinate,H=f+ +C*_,$=H+J*te,G=$+J*R,q=oe;break}return{line:{x1:F,y1:$,x2:U,y2:H},tick:{x:q,y:G}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,f;switch(a){case"left":f=l?"start":"end";break;case"right":f=l?"end":"start";break;default:f="middle";break}return f}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,f="end";switch(a){case"left":case"right":f="middle";break;case"top":f=l?"start":"end";break;default:f=l?"end":"start";break}return f}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,l=n.y,f=n.width,i=n.height,_=n.orientation,b=n.mirror,E=n.axisLine,C=_s(_s(_s({},Xn(this.props,!1)),Xn(E,!1)),{},{fill:"none"});if(_==="top"||_==="bottom"){var R=+(_==="top"&&!b||_==="bottom"&&b);C=_s(_s({},C),{},{x1:a,y1:l+R*i,x2:a+f,y2:l+R*i})}else{var F=+(_==="left"&&!b||_==="right"&&b);C=_s(_s({},C),{},{x1:a+F*f,y1:l,x2:a+F*f,y2:l+i})}return ze.createElement("line",J_({},C,{className:di("recharts-cartesian-axis-line",Ec(E,"className"))}))}},{key:"renderTicks",value:function(n,a,l){var f=this,i=this.props,_=i.tickLine,b=i.stroke,E=i.tick,C=i.tickFormatter,R=i.unit,F=o$(_s(_s({},this.props),{},{ticks:n}),a,l),U=this.getTickTextAnchor(),$=this.getTickVerticalAnchor(),H=Xn(this.props,!1),q=Xn(E,!1),G=_s(_s({},H),{},{fill:"none"},Xn(_,!1)),J=F.map(function(te,oe){var he=f.getTickLineCoord(te),le=he.line,ve=he.tick,We=_s(_s(_s(_s({textAnchor:U,verticalAnchor:$},H),{},{stroke:"none",fill:b},q),ve),{},{index:oe,payload:te,visibleTicksCount:F.length,tickFormatter:C});return ze.createElement(To,J_({className:"recharts-cartesian-axis-tick",key:"tick-".concat(te.value,"-").concat(te.coordinate,"-").concat(te.tickCoord)},sI(f.props,te,oe)),_&&ze.createElement("line",J_({},G,le,{className:di("recharts-cartesian-axis-tick-line",Ec(_,"className"))})),E&&t.renderTickItem(E,We,"".concat(Vn(C)?C(te.value,oe):te.value).concat(R||"")))});return ze.createElement("g",{className:"recharts-cartesian-axis-ticks"},J)}},{key:"render",value:function(){var n=this,a=this.props,l=a.axisLine,f=a.width,i=a.height,_=a.ticksGenerator,b=a.className,E=a.hide;if(E)return null;var C=this.props,R=C.ticks,F=V3(C,oUe),U=R;return Vn(_)&&(U=R&&R.length>0?_(this.props):_(F)),f<=0||i<=0||!U||!U.length?null:ze.createElement(To,{className:di("recharts-cartesian-axis",b),ref:function(H){n.layerReference=H}},l&&this.renderAxisLine(),this.renderTicks(U,this.state.fontSize,this.state.letterSpacing),rs.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,l){var f;return ze.isValidElement(n)?f=ze.cloneElement(n,a):Vn(n)?f=n(a):f=ze.createElement(bI,J_({},a,{className:"recharts-cartesian-axis-tick-value"}),l),f}}])}(ne.Component);a$(Jx,"displayName","CartesianAxis");a$(Jx,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var pUe=["x1","y1","x2","y2","key"],mUe=["offset"];function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function J9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J9(Object(r),!0).forEach(function(n){gUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gUe(e,t,r){return t=yUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yUe(e){var t=vUe(e,"string");return Sy(t)=="symbol"?t:t+""}function vUe(e,t){if(Sy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wg(){return Wg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wg.apply(this,arguments)}function Q9(e,t){if(e==null)return{};var r=_Ue(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Ue(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var xUe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,l=t.y,f=t.width,i=t.height,_=t.ry;return ze.createElement("rect",{x:a,y:l,ry:_,width:f,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Tne(e,t){var r;if(ze.isValidElement(e))r=ze.cloneElement(e,t);else if(Vn(e))r=e(t);else{var n=t.x1,a=t.y1,l=t.x2,f=t.y2,i=t.key,_=Q9(t,pUe),b=Xn(_,!1);b.offset;var E=Q9(b,mUe);r=ze.createElement("line",Wg({},E,{x1:n,y1:a,x2:l,y2:f,fill:"none",key:i}))}return r}function bUe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,l=e.horizontalPoints;if(!a||!l||!l.length)return null;var f=l.map(function(i,_){var b=ns(ns({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(_),index:_});return Tne(a,b)});return ze.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function wUe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,l=e.verticalPoints;if(!a||!l||!l.length)return null;var f=l.map(function(i,_){var b=ns(ns({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(_),index:_});return Tne(a,b)});return ze.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function SUe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,l=e.width,f=e.height,i=e.horizontalPoints,_=e.horizontal,b=_===void 0?!0:_;if(!b||!t||!t.length)return null;var E=i.map(function(R){return Math.round(R+a-a)}).sort(function(R,F){return R-F});a!==E[0]&&E.unshift(0);var C=E.map(function(R,F){var U=!E[F+1],$=U?a+f-R:E[F+1]-R;if($<=0)return null;var H=F%t.length;return ze.createElement("rect",{key:"react-".concat(F),y:R,x:n,height:$,width:l,stroke:"none",fill:t[H],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ze.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},C)}function TUe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,l=e.x,f=e.y,i=e.width,_=e.height,b=e.verticalPoints;if(!r||!n||!n.length)return null;var E=b.map(function(R){return Math.round(R+l-l)}).sort(function(R,F){return R-F});l!==E[0]&&E.unshift(0);var C=E.map(function(R,F){var U=!E[F+1],$=U?l+i-R:E[F+1]-R;if($<=0)return null;var H=F%n.length;return ze.createElement("rect",{key:"react-".concat(F),x:R,y:f,width:$,height:_,stroke:"none",fill:n[H],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return ze.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},C)}var EUe=function(t,r){var n=t.xAxis,a=t.width,l=t.height,f=t.offset;return kre(o$(ns(ns(ns({},Jx.defaultProps),n),{},{ticks:Eh(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),f.left,f.left+f.width,r)},AUe=function(t,r){var n=t.yAxis,a=t.width,l=t.height,f=t.offset;return kre(o$(ns(ns(ns({},Jx.defaultProps),n),{},{ticks:Eh(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),f.top,f.top+f.height,r)},c_={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function uF(e){var t,r,n,a,l,f,i=t$(),_=r$(),b=f$e(),E=ns(ns({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:c_.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:c_.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:c_.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:c_.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:c_.vertical,verticalFill:(f=e.verticalFill)!==null&&f!==void 0?f:c_.verticalFill,x:br(e.x)?e.x:b.left,y:br(e.y)?e.y:b.top,width:br(e.width)?e.width:b.width,height:br(e.height)?e.height:b.height}),C=E.x,R=E.y,F=E.width,U=E.height,$=E.syncWithTicks,H=E.horizontalValues,q=E.verticalValues,G=u$e(),J=d$e();if(!br(F)||F<=0||!br(U)||U<=0||!br(C)||C!==+C||!br(R)||R!==+R)return null;var te=E.verticalCoordinatesGenerator||EUe,oe=E.horizontalCoordinatesGenerator||AUe,he=E.horizontalPoints,le=E.verticalPoints;if((!he||!he.length)&&Vn(oe)){var ve=H&&H.length,We=oe({yAxis:J?ns(ns({},J),{},{ticks:ve?H:J.ticks}):void 0,width:i,height:_,offset:b},ve?!0:$);Oh(Array.isArray(We),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Sy(We),"]")),Array.isArray(We)&&(he=We)}if((!le||!le.length)&&Vn(te)){var Ie=q&&q.length,Re=te({xAxis:G?ns(ns({},G),{},{ticks:Ie?q:G.ticks}):void 0,width:i,height:_,offset:b},Ie?!0:$);Oh(Array.isArray(Re),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Sy(Re),"]")),Array.isArray(Re)&&(le=Re)}return ze.createElement("g",{className:"recharts-cartesian-grid"},ze.createElement(xUe,{fill:E.fill,fillOpacity:E.fillOpacity,x:E.x,y:E.y,width:E.width,height:E.height,ry:E.ry}),ze.createElement(bUe,Wg({},E,{offset:b,horizontalPoints:he,xAxis:G,yAxis:J})),ze.createElement(wUe,Wg({},E,{offset:b,verticalPoints:le,xAxis:G,yAxis:J})),ze.createElement(SUe,Wg({},E,{horizontalPoints:he})),ze.createElement(TUe,Wg({},E,{verticalPoints:le})))}uF.displayName="CartesianGrid";var MUe=["layout","type","stroke","connectNulls","isRange","ref"],CUe=["key"],Ene;function lx(e){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(e)}function Ane(e,t){if(e==null)return{};var r=PUe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function PUe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Gg(){return Gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gg.apply(this,arguments)}function eZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eZ(Object(r),!0).forEach(function(n){bd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cne(n.key),n)}}function OUe(e,t,r){return t&&tZ(e.prototype,t),r&&tZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kUe(e,t,r){return t=eO(t),RUe(e,Mne()?Reflect.construct(t,r||[],eO(e).constructor):t.apply(e,r))}function RUe(e,t){if(t&&(lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DUe(e)}function DUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mne=function(){return!!e})()}function eO(e){return eO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eO(e)}function LUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dF(e,t)}function dF(e,t){return dF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},dF(e,t)}function bd(e,t,r){return t=Cne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cne(e){var t=NUe(e,"string");return lx(t)=="symbol"?t:t+""}function NUe(e,t){if(lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hh=function(e){function t(){var r;IUe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=kUe(this,t,[].concat(a)),bd(r,"state",{isAnimationFinished:!0}),bd(r,"id",xE("recharts-area-")),bd(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Vn(f)&&f()}),bd(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Vn(f)&&f()}),r}return LUe(t,e),OUe(t,[{key:"renderDots",value:function(n,a,l){var f=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(f&&!i)return null;var _=this.props,b=_.dot,E=_.points,C=_.dataKey,R=Xn(this.props,!1),F=Xn(b,!0),U=E.map(function(H,q){var G=sp(sp(sp({key:"dot-".concat(q),r:3},R),F),{},{index:q,cx:H.x,cy:H.y,dataKey:C,value:H.value,payload:H.payload,points:E});return t.renderDotItem(b,G)}),$={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return ze.createElement(To,Gg({className:"recharts-area-dots"},$),U)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,l=a.baseLine,f=a.points,i=a.strokeWidth,_=f[0].x,b=f[f.length-1].x,E=n*Math.abs(_-b),C=zp(f.map(function(R){return R.y||0}));return br(l)&&typeof l=="number"?C=Math.max(l,C):l&&Array.isArray(l)&&l.length&&(C=Math.max(zp(l.map(function(R){return R.y||0})),C)),br(C)?ze.createElement("rect",{x:_<b?_:_-E,y:0,width:E,height:Math.floor(C+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,l=a.baseLine,f=a.points,i=a.strokeWidth,_=f[0].y,b=f[f.length-1].y,E=n*Math.abs(_-b),C=zp(f.map(function(R){return R.x||0}));return br(l)&&typeof l=="number"?C=Math.max(l,C):l&&Array.isArray(l)&&l.length&&(C=Math.max(zp(l.map(function(R){return R.x||0})),C)),br(C)?ze.createElement("rect",{x:0,y:_<b?_:_-E,width:C+(i?parseInt("".concat(i),10):1),height:Math.floor(E)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,l,f){var i=this.props,_=i.layout,b=i.type,E=i.stroke,C=i.connectNulls,R=i.isRange;i.ref;var F=Ane(i,MUe);return ze.createElement(To,{clipPath:l?"url(#clipPath-".concat(f,")"):null},ze.createElement(TS,Gg({},Xn(F,!0),{points:n,connectNulls:C,type:b,baseLine:a,layout:_,stroke:"none",className:"recharts-area-area"})),E!=="none"&&ze.createElement(TS,Gg({},Xn(this.props,!1),{className:"recharts-area-curve",layout:_,type:b,connectNulls:C,fill:"none",points:n})),E!=="none"&&R&&ze.createElement(TS,Gg({},Xn(this.props,!1),{className:"recharts-area-curve",layout:_,type:b,connectNulls:C,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var l=this,f=this.props,i=f.points,_=f.baseLine,b=f.isAnimationActive,E=f.animationBegin,C=f.animationDuration,R=f.animationEasing,F=f.animationId,U=this.state,$=U.prevPoints,H=U.prevBaseLine;return ze.createElement(qh,{begin:E,duration:C,isActive:b,easing:R,from:{t:0},to:{t:1},key:"area-".concat(F),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(q){var G=q.t;if($){var J=$.length/i.length,te=i.map(function(ve,We){var Ie=Math.floor(We*J);if($[Ie]){var Re=$[Ie],$e=_c(Re.x,ve.x),ot=_c(Re.y,ve.y);return sp(sp({},ve),{},{x:$e(G),y:ot(G)})}return ve}),oe;if(br(_)&&typeof _=="number"){var he=_c(H,_);oe=he(G)}else if(oi(_)||Wx(_)){var le=_c(H,0);oe=le(G)}else oe=_.map(function(ve,We){var Ie=Math.floor(We*J);if(H[Ie]){var Re=H[Ie],$e=_c(Re.x,ve.x),ot=_c(Re.y,ve.y);return sp(sp({},ve),{},{x:$e(G),y:ot(G)})}return ve});return l.renderAreaStatically(te,oe,n,a)}return ze.createElement(To,null,ze.createElement("defs",null,ze.createElement("clipPath",{id:"animationClipPath-".concat(a)},l.renderClipRect(G))),ze.createElement(To,{clipPath:"url(#animationClipPath-".concat(a,")")},l.renderAreaStatically(i,_,n,a)))})}},{key:"renderArea",value:function(n,a){var l=this.props,f=l.points,i=l.baseLine,_=l.isAnimationActive,b=this.state,E=b.prevPoints,C=b.prevBaseLine,R=b.totalLength;return _&&f&&f.length&&(!E&&R>0||!mT(E,f)||!mT(C,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(f,i,n,a)}},{key:"render",value:function(){var n,a=this.props,l=a.hide,f=a.dot,i=a.points,_=a.className,b=a.top,E=a.left,C=a.xAxis,R=a.yAxis,F=a.width,U=a.height,$=a.isAnimationActive,H=a.id;if(l||!i||!i.length)return null;var q=this.state.isAnimationFinished,G=i.length===1,J=di("recharts-area",_),te=C&&C.allowDataOverflow,oe=R&&R.allowDataOverflow,he=te||oe,le=oi(H)?this.id:H,ve=(n=Xn(f,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},We=ve.r,Ie=We===void 0?3:We,Re=ve.strokeWidth,$e=Re===void 0?2:Re,ot=dTe(f)?f:{},Je=ot.clipDot,rt=Je===void 0?!0:Je,st=Ie*2+$e;return ze.createElement(To,{className:J},te||oe?ze.createElement("defs",null,ze.createElement("clipPath",{id:"clipPath-".concat(le)},ze.createElement("rect",{x:te?E:E-F/2,y:oe?b:b-U/2,width:te?F:F*2,height:oe?U:U*2})),!rt&&ze.createElement("clipPath",{id:"clipPath-dots-".concat(le)},ze.createElement("rect",{x:E-st/2,y:b-st/2,width:F+st,height:U+st}))):null,G?null:this.renderArea(he,le),(f||G)&&this.renderDots(he,rt,le),(!$||q)&&Yp.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(ne.PureComponent);Ene=Hh;bd(Hh,"displayName","Area");bd(Hh,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!kh.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});bd(Hh,"getBaseValue",function(e,t,r,n){var a=e.layout,l=e.baseValue,f=t.props.baseValue,i=f??l;if(br(i)&&typeof i=="number")return i;var _=a==="horizontal"?n:r,b=_.scale.domain();if(_.type==="number"){var E=Math.max(b[0],b[1]),C=Math.min(b[0],b[1]);return i==="dataMin"?C:i==="dataMax"||E<0?E:Math.max(Math.min(b[0],b[1]),0)}return i==="dataMin"?b[0]:i==="dataMax"?b[1]:b[0]});bd(Hh,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,l=e.xAxisTicks,f=e.yAxisTicks,i=e.bandSize,_=e.dataKey,b=e.stackedData,E=e.dataStartIndex,C=e.displayedData,R=e.offset,F=t.layout,U=b&&b.length,$=Ene.getBaseValue(t,r,n,a),H=F==="horizontal",q=!1,G=C.map(function(te,oe){var he;U?he=b[E+oe]:(he=Hl(te,_),Array.isArray(he)?q=!0:he=[$,he]);var le=he[1]==null||U&&Hl(te,_)==null;return H?{x:N7({axis:n,ticks:l,bandSize:i,entry:te,index:oe}),y:le?null:a.scale(he[1]),value:he,payload:te}:{x:le?null:n.scale(he[1]),y:N7({axis:a,ticks:f,bandSize:i,entry:te,index:oe}),value:he,payload:te}}),J;return U||q?J=G.map(function(te){var oe=Array.isArray(te.value)?te.value[0]:null;return H?{x:te.x,y:oe!=null&&te.y!=null?a.scale(oe):null}:{x:oe!=null?n.scale(oe):null,y:te.y}}):J=H?a.scale($):n.scale($),sp({points:G,baseLine:J,layout:F,isRange:q},R)});bd(Hh,"renderDotItem",function(e,t){var r;if(ze.isValidElement(e))r=ze.cloneElement(e,t);else if(Vn(e))r=e(t);else{var n=di("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,l=Ane(t,CUe);r=ze.createElement(K5,Gg({},l,{key:a,className:n}))}return r});function cx(e){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(e)}function zUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jUe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,One(n.key),n)}}function FUe(e,t,r){return t&&jUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function BUe(e,t,r){return t=tO(t),$Ue(e,Pne()?Reflect.construct(t,r||[],tO(e).constructor):t.apply(e,r))}function $Ue(e,t){if(t&&(cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UUe(e)}function UUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pne=function(){return!!e})()}function tO(e){return tO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tO(e)}function VUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hF(e,t)}function hF(e,t){return hF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},hF(e,t)}function Ine(e,t,r){return t=One(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function One(e){var t=WUe(e,"string");return cx(t)=="symbol"?t:t+""}function WUe(e,t){if(cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fF(){return fF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fF.apply(this,arguments)}function GUe(e){var t=e.xAxisId,r=t$(),n=r$(),a=fne(t);return a==null?null:ze.createElement(Jx,fF({},a,{className:di("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(f){return Eh(f,!0)}}))}var ux=function(e){function t(){return zUe(this,t),BUe(this,t,arguments)}return VUe(t,e),FUe(t,[{key:"render",value:function(){return ze.createElement(GUe,this.props)}}])}(ze.Component);Ine(ux,"displayName","XAxis");Ine(ux,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function dx(e){"@babel/helpers - typeof";return dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(e)}function qUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HUe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dne(n.key),n)}}function ZUe(e,t,r){return t&&HUe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function XUe(e,t,r){return t=rO(t),YUe(e,kne()?Reflect.construct(t,r||[],rO(e).constructor):t.apply(e,r))}function YUe(e,t){if(t&&(dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KUe(e)}function KUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kne=function(){return!!e})()}function rO(e){return rO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rO(e)}function JUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pF(e,t)}function pF(e,t){return pF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},pF(e,t)}function Rne(e,t,r){return t=Dne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dne(e){var t=QUe(e,"string");return dx(t)=="symbol"?t:t+""}function QUe(e,t){if(dx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mF(){return mF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mF.apply(this,arguments)}var e6e=function(t){var r=t.yAxisId,n=t$(),a=r$(),l=pne(r);return l==null?null:ze.createElement(Jx,mF({},l,{className:di("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return Eh(i,!0)}}))},hx=function(e){function t(){return qUe(this,t),XUe(this,t,arguments)}return JUe(t,e),ZUe(t,[{key:"render",value:function(){return ze.createElement(e6e,this.props)}}])}(ze.Component);Rne(hx,"displayName","YAxis");Rne(hx,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function rZ(e){return i6e(e)||n6e(e)||r6e(e)||t6e()}function t6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r6e(e,t){if(e){if(typeof e=="string")return gF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gF(e,t)}}function n6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function i6e(e){if(Array.isArray(e))return gF(e)}function gF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yF=function(t,r,n,a,l){var f=Tu(t,i$),i=Tu(t,Yk),_=[].concat(rZ(f),rZ(i)),b=Tu(t,Jk),E="".concat(a,"Id"),C=a[0],R=r;if(_.length&&(R=_.reduce(function($,H){if(H.props[E]===n&&Pd(H.props,"extendDomain")&&br(H.props[C])){var q=H.props[C];return[Math.min($[0],q),Math.max($[1],q)]}return $},R)),b.length){var F="".concat(C,"1"),U="".concat(C,"2");R=b.reduce(function($,H){if(H.props[E]===n&&Pd(H.props,"extendDomain")&&br(H.props[F])&&br(H.props[U])){var q=H.props[F],G=H.props[U];return[Math.min($[0],q,G),Math.max($[1],q,G)]}return $},R)}return l&&l.length&&(R=l.reduce(function($,H){return br(H)?[Math.min($[0],H),Math.max($[1],H)]:$},R)),R},Lne={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(_,b,E){this.fn=_,this.context=b,this.once=E||!1}function l(_,b,E,C,R){if(typeof E!="function")throw new TypeError("The listener must be a function");var F=new a(E,C||_,R),U=r?r+b:b;return _._events[U]?_._events[U].fn?_._events[U]=[_._events[U],F]:_._events[U].push(F):(_._events[U]=F,_._eventsCount++),_}function f(_,b){--_._eventsCount===0?_._events=new n:delete _._events[b]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var b=[],E,C;if(this._eventsCount===0)return b;for(C in E=this._events)t.call(E,C)&&b.push(r?C.slice(1):C);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(E)):b},i.prototype.listeners=function(b){var E=r?r+b:b,C=this._events[E];if(!C)return[];if(C.fn)return[C.fn];for(var R=0,F=C.length,U=new Array(F);R<F;R++)U[R]=C[R].fn;return U},i.prototype.listenerCount=function(b){var E=r?r+b:b,C=this._events[E];return C?C.fn?1:C.length:0},i.prototype.emit=function(b,E,C,R,F,U){var $=r?r+b:b;if(!this._events[$])return!1;var H=this._events[$],q=arguments.length,G,J;if(H.fn){switch(H.once&&this.removeListener(b,H.fn,void 0,!0),q){case 1:return H.fn.call(H.context),!0;case 2:return H.fn.call(H.context,E),!0;case 3:return H.fn.call(H.context,E,C),!0;case 4:return H.fn.call(H.context,E,C,R),!0;case 5:return H.fn.call(H.context,E,C,R,F),!0;case 6:return H.fn.call(H.context,E,C,R,F,U),!0}for(J=1,G=new Array(q-1);J<q;J++)G[J-1]=arguments[J];H.fn.apply(H.context,G)}else{var te=H.length,oe;for(J=0;J<te;J++)switch(H[J].once&&this.removeListener(b,H[J].fn,void 0,!0),q){case 1:H[J].fn.call(H[J].context);break;case 2:H[J].fn.call(H[J].context,E);break;case 3:H[J].fn.call(H[J].context,E,C);break;case 4:H[J].fn.call(H[J].context,E,C,R);break;default:if(!G)for(oe=1,G=new Array(q-1);oe<q;oe++)G[oe-1]=arguments[oe];H[J].fn.apply(H[J].context,G)}}return!0},i.prototype.on=function(b,E,C){return l(this,b,E,C,!1)},i.prototype.once=function(b,E,C){return l(this,b,E,C,!0)},i.prototype.removeListener=function(b,E,C,R){var F=r?r+b:b;if(!this._events[F])return this;if(!E)return f(this,F),this;var U=this._events[F];if(U.fn)U.fn===E&&(!R||U.once)&&(!C||U.context===C)&&f(this,F);else{for(var $=0,H=[],q=U.length;$<q;$++)(U[$].fn!==E||R&&!U[$].once||C&&U[$].context!==C)&&H.push(U[$]);H.length?this._events[F]=H.length===1?H[0]:H:f(this,F)}return this},i.prototype.removeAllListeners=function(b){var E;return b?(E=r?r+b:b,this._events[E]&&f(this,E)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i})(Lne);var o6e=Lne.exports;const a6e=hi(o6e);var W3=new a6e,G3="recharts.syncMouseEvents";function zT(e){"@babel/helpers - typeof";return zT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zT(e)}function s6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l6e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nne(n.key),n)}}function c6e(e,t,r){return t&&l6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function q3(e,t,r){return t=Nne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nne(e){var t=u6e(e,"string");return zT(t)=="symbol"?t:t+""}function u6e(e,t){if(zT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var d6e=function(){function e(){s6e(this,e),q3(this,"activeIndex",0),q3(this,"coordinateList",[]),q3(this,"layout","horizontal")}return c6e(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,l=a===void 0?null:a,f=r.container,i=f===void 0?null:f,_=r.layout,b=_===void 0?null:_,E=r.offset,C=E===void 0?null:E,R=r.mouseHandlerCallback,F=R===void 0?null:R;this.coordinateList=(n=l??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=b??this.layout,this.offset=C??this.offset,this.mouseHandlerCallback=F??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),l=a.x,f=a.y,i=a.height,_=this.coordinateList[this.activeIndex].coordinate,b=((r=window)===null||r===void 0?void 0:r.scrollX)||0,E=((n=window)===null||n===void 0?void 0:n.scrollY)||0,C=l+_+b,R=f+this.offset.top+i/2+E;this.mouseHandlerCallback({pageX:C,pageY:R})}}}])}();function h6e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&br(n)&&br(a))return!0}return!1}function f6e(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function zne(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,l=e.endAngle,f=Fa(t,r,n,a),i=Fa(t,r,n,l);return{points:[f,i],cx:t,cy:r,radius:n,startAngle:a,endAngle:l}}function p6e(e,t,r){var n,a,l,f;if(e==="horizontal")n=t.x,l=n,a=r.top,f=r.top+r.height;else if(e==="vertical")a=t.y,f=a,n=r.left,l=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,_=t.cy,b=t.innerRadius,E=t.outerRadius,C=t.angle,R=Fa(i,_,b,C),F=Fa(i,_,E,C);n=R.x,a=R.y,l=F.x,f=F.y}else return zne(t);return[{x:n,y:a},{x:l,y:f}]}function jT(e){"@babel/helpers - typeof";return jT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jT(e)}function nZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(r),!0).forEach(function(n){m6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m6e(e,t,r){return t=g6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g6e(e){var t=y6e(e,"string");return jT(t)=="symbol"?t:t+""}function y6e(e,t){if(jT(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jT(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v6e(e){var t,r,n=e.element,a=e.tooltipEventType,l=e.isActive,f=e.activeCoordinate,i=e.activePayload,_=e.offset,b=e.activeTooltipIndex,E=e.tooltipAxisBandSize,C=e.layout,R=e.chartName,F=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!F||!l||!f||R!=="ScatterChart"&&a!=="axis")return null;var U,$=TS;if(R==="ScatterChart")U=f,$=w4e;else if(R==="BarChart")U=f6e(C,f,_,E),$=Y5;else if(C==="radial"){var H=zne(f),q=H.cx,G=H.cy,J=H.radius,te=H.startAngle,oe=H.endAngle;U={cx:q,cy:G,startAngle:te,endAngle:oe,innerRadius:J,outerRadius:J},$=zre}else U={points:p6e(C,f,_)},$=TS;var he=pM(pM(pM(pM({stroke:"#ccc",pointerEvents:"none"},_),U),Xn(F,!1)),{},{payload:i,payloadIndex:b,className:di("recharts-tooltip-cursor",F.className)});return ne.isValidElement(F)?ne.cloneElement(F,he):ne.createElement($,he)}var _6e=["item"],x6e=["children","className","width","height","style","compact","title","desc"];function fx(e){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(e)}function AS(){return AS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AS.apply(this,arguments)}function iZ(e,t){return S6e(e)||w6e(e,t)||Fne(e,t)||b6e()}function b6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,b=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(E){b=!0,a=E}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(b)throw a}}return i}}function S6e(e){if(Array.isArray(e))return e}function oZ(e,t){if(e==null)return{};var r=T6e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function E6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A6e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bne(n.key),n)}}function M6e(e,t,r){return t&&A6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C6e(e,t,r){return t=nO(t),P6e(e,jne()?Reflect.construct(t,r||[],nO(e).constructor):t.apply(e,r))}function P6e(e,t){if(t&&(fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I6e(e)}function I6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jne=function(){return!!e})()}function nO(e){return nO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nO(e)}function O6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vF(e,t)}function vF(e,t){return vF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},vF(e,t)}function px(e){return D6e(e)||R6e(e)||Fne(e)||k6e()}function k6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fne(e,t){if(e){if(typeof e=="string")return _F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _F(e,t)}}function R6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D6e(e){if(Array.isArray(e))return _F(e)}function _F(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aZ(Object(r),!0).forEach(function(n){_n(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _n(e,t,r){return t=Bne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bne(e){var t=L6e(e,"string");return fx(t)=="symbol"?t:t+""}function L6e(e,t){if(fx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N6e={xAxis:["bottom","top"],yAxis:["left","right"]},z6e={width:"100%",height:"100%"},$ne={x:0,y:0};function mM(e){return e}var j6e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},F6e=function(t,r,n,a){var l=r.find(function(E){return E&&E.index===n});if(l){if(t==="horizontal")return{x:l.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:l.coordinate};if(t==="centric"){var f=l.coordinate,i=a.radius;return qt(qt(qt({},a),Fa(a.cx,a.cy,i,f)),{},{angle:f,radius:i})}var _=l.coordinate,b=a.angle;return qt(qt(qt({},a),Fa(a.cx,a.cy,_,b)),{},{angle:b,radius:_})}return $ne},Qk=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,l=r.dataEndIndex,f=(n??[]).reduce(function(i,_){var b=_.props.data;return b&&b.length?[].concat(px(i),px(b)):i},[]);return f.length>0?f:t&&t.length&&br(a)&&br(l)?t.slice(a,l+1):[]};function Une(e){return e==="number"?[0,"auto"]:void 0}var xF=function(t,r,n,a){var l=t.graphicalItems,f=t.tooltipAxis,i=Qk(r,t);return n<0||!l||!l.length||n>=i.length?null:l.reduce(function(_,b){var E,C=(E=b.props.data)!==null&&E!==void 0?E:r;C&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(C=C.slice(t.dataStartIndex,t.dataEndIndex+1));var R;if(f.dataKey&&!f.allowDuplicatedCategory){var F=C===void 0?i:C;R=oI(F,f.dataKey,a)}else R=C&&C[n]||i[n];return R?[].concat(px(_),[Dre(b,R)]):_},[])},sZ=function(t,r,n,a){var l=a||{x:t.chartX,y:t.chartY},f=j6e(l,n),i=t.orderedTooltipTicks,_=t.tooltipAxis,b=t.tooltipTicks,E=pze(f,i,b,_);if(E>=0&&b){var C=b[E]&&b[E].value,R=xF(t,r,E,C),F=F6e(n,i,E,l);return{activeTooltipIndex:E,activeLabel:C,activePayload:R,activeCoordinate:F}}return null},B6e=function(t,r){var n=r.axes,a=r.graphicalItems,l=r.axisType,f=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,b=r.dataEndIndex,E=t.layout,C=t.children,R=t.stackOffset,F=Ore(E,l);return n.reduce(function(U,$){var H,q=$.type.defaultProps!==void 0?qt(qt({},$.type.defaultProps),$.props):$.props,G=q.type,J=q.dataKey,te=q.allowDataOverflow,oe=q.allowDuplicatedCategory,he=q.scale,le=q.ticks,ve=q.includeHidden,We=q[f];if(U[We])return U;var Ie=Qk(t.data,{graphicalItems:a.filter(function($t){var ut,tr=f in $t.props?$t.props[f]:(ut=$t.type.defaultProps)===null||ut===void 0?void 0:ut[f];return tr===We}),dataStartIndex:_,dataEndIndex:b}),Re=Ie.length,$e,ot,Je;h6e(q.domain,te,G)&&($e=jj(q.domain,null,te),F&&(G==="number"||he!=="auto")&&(Je=SS(Ie,J,"category")));var rt=Une(G);if(!$e||$e.length===0){var st,at=(st=q.domain)!==null&&st!==void 0?st:rt;if(J){if($e=SS(Ie,J,G),G==="category"&&F){var Be=rTe($e);oe&&Be?(ot=$e,$e=WI(0,Re)):oe||($e=B7(at,$e,$).reduce(function($t,ut){return $t.indexOf(ut)>=0?$t:[].concat(px($t),[ut])},[]))}else if(G==="category")oe?$e=$e.filter(function($t){return $t!==""&&!oi($t)}):$e=B7(at,$e,$).reduce(function($t,ut){return $t.indexOf(ut)>=0||ut===""||oi(ut)?$t:[].concat(px($t),[ut])},[]);else if(G==="number"){var ct=_ze(Ie,a.filter(function($t){var ut,tr,mr=f in $t.props?$t.props[f]:(ut=$t.type.defaultProps)===null||ut===void 0?void 0:ut[f],rr="hide"in $t.props?$t.props.hide:(tr=$t.type.defaultProps)===null||tr===void 0?void 0:tr.hide;return mr===We&&(ve||!rr)}),J,l,E);ct&&($e=ct)}F&&(G==="number"||he!=="auto")&&(Je=SS(Ie,J,"category"))}else F?$e=WI(0,Re):i&&i[We]&&i[We].hasStack&&G==="number"?$e=R==="expand"?[0,1]:Rre(i[We].stackGroups,_,b):$e=Ire(Ie,a.filter(function($t){var ut=f in $t.props?$t.props[f]:$t.type.defaultProps[f],tr="hide"in $t.props?$t.props.hide:$t.type.defaultProps.hide;return ut===We&&(ve||!tr)}),G,E,!0);if(G==="number")$e=yF(C,$e,We,l,le),at&&($e=jj(at,$e,te));else if(G==="category"&&at){var jt=at,Lt=$e.every(function($t){return jt.indexOf($t)>=0});Lt&&($e=jt)}}return qt(qt({},U),{},_n({},We,qt(qt({},q),{},{axisType:l,domain:$e,categoricalDomain:Je,duplicateDomain:ot,originalDomain:(H=q.domain)!==null&&H!==void 0?H:rt,isCategorical:F,layout:E})))},{})},$6e=function(t,r){var n=r.graphicalItems,a=r.Axis,l=r.axisType,f=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,b=r.dataEndIndex,E=t.layout,C=t.children,R=Qk(t.data,{graphicalItems:n,dataStartIndex:_,dataEndIndex:b}),F=R.length,U=Ore(E,l),$=-1;return n.reduce(function(H,q){var G=q.type.defaultProps!==void 0?qt(qt({},q.type.defaultProps),q.props):q.props,J=G[f],te=Une("number");if(!H[J]){$++;var oe;return U?oe=WI(0,F):i&&i[J]&&i[J].hasStack?(oe=Rre(i[J].stackGroups,_,b),oe=yF(C,oe,J,l)):(oe=jj(te,Ire(R,n.filter(function(he){var le,ve,We=f in he.props?he.props[f]:(le=he.type.defaultProps)===null||le===void 0?void 0:le[f],Ie="hide"in he.props?he.props.hide:(ve=he.type.defaultProps)===null||ve===void 0?void 0:ve.hide;return We===J&&!Ie}),"number",E),a.defaultProps.allowDataOverflow),oe=yF(C,oe,J,l)),qt(qt({},H),{},_n({},J,qt(qt({axisType:l},a.defaultProps),{},{hide:!0,orientation:Ec(N6e,"".concat(l,".").concat($%2),null),domain:oe,originalDomain:te,isCategorical:U,layout:E})))}return H},{})},U6e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,l=r.AxisComp,f=r.graphicalItems,i=r.stackGroups,_=r.dataStartIndex,b=r.dataEndIndex,E=t.children,C="".concat(a,"Id"),R=Tu(E,l),F={};return R&&R.length?F=B6e(t,{axes:R,graphicalItems:f,axisType:a,axisIdKey:C,stackGroups:i,dataStartIndex:_,dataEndIndex:b}):f&&f.length&&(F=$6e(t,{Axis:l,graphicalItems:f,axisType:a,axisIdKey:C,stackGroups:i,dataStartIndex:_,dataEndIndex:b})),F},V6e=function(t){var r=wp(t),n=Eh(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:S5(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:LI(r,n)}},lZ=function(t){var r=t.children,n=t.defaultShowTooltip,a=Dl(r,rx),l=0,f=0;return t.data&&t.data.length!==0&&(f=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(l=a.props.startIndex),a.props.endIndex>=0&&(f=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:f,activeTooltipIndex:-1,isTooltipActive:!!n}},W6e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Ih(r&&r.type);return n&&n.indexOf("Bar")>=0})},cZ=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},G6e=function(t,r){var n=t.props,a=t.graphicalItems,l=t.xAxisMap,f=l===void 0?{}:l,i=t.yAxisMap,_=i===void 0?{}:i,b=n.width,E=n.height,C=n.children,R=n.margin||{},F=Dl(C,rx),U=Dl(C,oy),$=Object.keys(_).reduce(function(oe,he){var le=_[he],ve=le.orientation;return!le.mirror&&!le.hide?qt(qt({},oe),{},_n({},ve,oe[ve]+le.width)):oe},{left:R.left||0,right:R.right||0}),H=Object.keys(f).reduce(function(oe,he){var le=f[he],ve=le.orientation;return!le.mirror&&!le.hide?qt(qt({},oe),{},_n({},ve,Ec(oe,"".concat(ve))+le.height)):oe},{top:R.top||0,bottom:R.bottom||0}),q=qt(qt({},H),$),G=q.bottom;F&&(q.bottom+=F.props.height||rx.defaultProps.height),U&&r&&(q=yze(q,a,n,r));var J=b-q.left-q.right,te=E-q.top-q.bottom;return qt(qt({brushBottom:G},q),{},{width:Math.max(J,0),height:Math.max(te,0)})},q6e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Vne=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,l=a===void 0?"axis":a,f=t.validateTooltipEventTypes,i=f===void 0?["axis"]:f,_=t.axisComponents,b=t.legendContent,E=t.formatAxisMap,C=t.defaultProps,R=function(H,q){var G=q.graphicalItems,J=q.stackGroups,te=q.offset,oe=q.updateId,he=q.dataStartIndex,le=q.dataEndIndex,ve=H.barSize,We=H.layout,Ie=H.barGap,Re=H.barCategoryGap,$e=H.maxBarSize,ot=cZ(We),Je=ot.numericAxisName,rt=ot.cateAxisName,st=W6e(G),at=[];return G.forEach(function(Be,ct){var jt=Qk(H.data,{graphicalItems:[Be],dataStartIndex:he,dataEndIndex:le}),Lt=Be.type.defaultProps!==void 0?qt(qt({},Be.type.defaultProps),Be.props):Be.props,$t=Lt.dataKey,ut=Lt.maxBarSize,tr=Lt["".concat(Je,"Id")],mr=Lt["".concat(rt,"Id")],rr={},Ut=_.reduce(function(kt,dr){var lr=q["".concat(dr.axisType,"Map")],sr=Lt["".concat(dr.axisType,"Id")];lr&&lr[sr]||dr.axisType==="zAxis"||wy();var Kt=lr[sr];return qt(qt({},kt),{},_n(_n({},dr.axisType,Kt),"".concat(dr.axisType,"Ticks"),Eh(Kt)))},rr),gr=Ut[rt],Gt=Ut["".concat(rt,"Ticks")],ge=J&&J[tr]&&J[tr].hasStack&&Oze(Be,J[tr].stackGroups),cr=Ih(Be.type).indexOf("Bar")>=0,Ot=LI(gr,Gt),Pr=[],_t=st&&mze({barSize:ve,stackGroups:J,totalSize:q6e(Ut,rt)});if(cr){var hn,qr,Ln=oi(ut)?$e:ut,Ge=(hn=(qr=LI(gr,Gt,!0))!==null&&qr!==void 0?qr:Ln)!==null&&hn!==void 0?hn:0;Pr=gze({barGap:Ie,barCategoryGap:Re,bandSize:Ge!==Ot?Ge:Ot,sizeList:_t[mr],maxBarSize:Ln}),Ge!==Ot&&(Pr=Pr.map(function(kt){return qt(qt({},kt),{},{position:qt(qt({},kt.position),{},{offset:kt.position.offset-Ge/2})})}))}var vt=Be&&Be.type&&Be.type.getComposedData;vt&&at.push({props:qt(qt({},vt(qt(qt({},Ut),{},{displayedData:jt,props:H,dataKey:$t,item:Be,bandSize:Ot,barPosition:Pr,offset:te,stackedData:ge,layout:We,dataStartIndex:he,dataEndIndex:le}))),{},_n(_n(_n({key:Be.key||"item-".concat(ct)},Je,Ut[Je]),rt,Ut[rt]),"animationId",oe)),childIndex:pTe(Be,H.children),item:Be})}),at},F=function(H,q){var G=H.props,J=H.dataStartIndex,te=H.dataEndIndex,oe=H.updateId;if(!kq({props:G}))return null;var he=G.children,le=G.layout,ve=G.stackOffset,We=G.data,Ie=G.reverseStackOrder,Re=cZ(le),$e=Re.numericAxisName,ot=Re.cateAxisName,Je=Tu(he,n),rt=Cze(We,Je,"".concat($e,"Id"),"".concat(ot,"Id"),ve,Ie),st=_.reduce(function(Lt,$t){var ut="".concat($t.axisType,"Map");return qt(qt({},Lt),{},_n({},ut,U6e(G,qt(qt({},$t),{},{graphicalItems:Je,stackGroups:$t.axisType===$e&&rt,dataStartIndex:J,dataEndIndex:te}))))},{}),at=G6e(qt(qt({},st),{},{props:G,graphicalItems:Je}),q==null?void 0:q.legendBBox);Object.keys(st).forEach(function(Lt){st[Lt]=E(G,st[Lt],at,Lt.replace("Map",""),r)});var Be=st["".concat(ot,"Map")],ct=V6e(Be),jt=R(G,qt(qt({},st),{},{dataStartIndex:J,dataEndIndex:te,updateId:oe,graphicalItems:Je,stackGroups:rt,offset:at}));return qt(qt({formattedGraphicalItems:jt,graphicalItems:Je,offset:at,stackGroups:rt},ct),st)},U=function($){function H(q){var G,J,te;return E6e(this,H),te=C6e(this,H,[q]),_n(te,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),_n(te,"accessibilityManager",new d6e),_n(te,"handleLegendBBoxUpdate",function(oe){if(oe){var he=te.state,le=he.dataStartIndex,ve=he.dataEndIndex,We=he.updateId;te.setState(qt({legendBBox:oe},F({props:te.props,dataStartIndex:le,dataEndIndex:ve,updateId:We},qt(qt({},te.state),{},{legendBBox:oe}))))}}),_n(te,"handleReceiveSyncEvent",function(oe,he,le){if(te.props.syncId===oe){if(le===te.eventEmitterSymbol&&typeof te.props.syncMethod!="function")return;te.applySyncEvent(he)}}),_n(te,"handleBrushChange",function(oe){var he=oe.startIndex,le=oe.endIndex;if(he!==te.state.dataStartIndex||le!==te.state.dataEndIndex){var ve=te.state.updateId;te.setState(function(){return qt({dataStartIndex:he,dataEndIndex:le},F({props:te.props,dataStartIndex:he,dataEndIndex:le,updateId:ve},te.state))}),te.triggerSyncEvent({dataStartIndex:he,dataEndIndex:le})}}),_n(te,"handleMouseEnter",function(oe){var he=te.getMouseInfo(oe);if(he){var le=qt(qt({},he),{},{isTooltipActive:!0});te.setState(le),te.triggerSyncEvent(le);var ve=te.props.onMouseEnter;Vn(ve)&&ve(le,oe)}}),_n(te,"triggeredAfterMouseMove",function(oe){var he=te.getMouseInfo(oe),le=he?qt(qt({},he),{},{isTooltipActive:!0}):{isTooltipActive:!1};te.setState(le),te.triggerSyncEvent(le);var ve=te.props.onMouseMove;Vn(ve)&&ve(le,oe)}),_n(te,"handleItemMouseEnter",function(oe){te.setState(function(){return{isTooltipActive:!0,activeItem:oe,activePayload:oe.tooltipPayload,activeCoordinate:oe.tooltipPosition||{x:oe.cx,y:oe.cy}}})}),_n(te,"handleItemMouseLeave",function(){te.setState(function(){return{isTooltipActive:!1}})}),_n(te,"handleMouseMove",function(oe){oe.persist(),te.throttleTriggeredAfterMouseMove(oe)}),_n(te,"handleMouseLeave",function(oe){te.throttleTriggeredAfterMouseMove.cancel();var he={isTooltipActive:!1};te.setState(he),te.triggerSyncEvent(he);var le=te.props.onMouseLeave;Vn(le)&&le(he,oe)}),_n(te,"handleOuterEvent",function(oe){var he=fTe(oe),le=Ec(te.props,"".concat(he));if(he&&Vn(le)){var ve,We;/.*touch.*/i.test(he)?We=te.getMouseInfo(oe.changedTouches[0]):We=te.getMouseInfo(oe),le((ve=We)!==null&&ve!==void 0?ve:{},oe)}}),_n(te,"handleClick",function(oe){var he=te.getMouseInfo(oe);if(he){var le=qt(qt({},he),{},{isTooltipActive:!0});te.setState(le),te.triggerSyncEvent(le);var ve=te.props.onClick;Vn(ve)&&ve(le,oe)}}),_n(te,"handleMouseDown",function(oe){var he=te.props.onMouseDown;if(Vn(he)){var le=te.getMouseInfo(oe);he(le,oe)}}),_n(te,"handleMouseUp",function(oe){var he=te.props.onMouseUp;if(Vn(he)){var le=te.getMouseInfo(oe);he(le,oe)}}),_n(te,"handleTouchMove",function(oe){oe.changedTouches!=null&&oe.changedTouches.length>0&&te.throttleTriggeredAfterMouseMove(oe.changedTouches[0])}),_n(te,"handleTouchStart",function(oe){oe.changedTouches!=null&&oe.changedTouches.length>0&&te.handleMouseDown(oe.changedTouches[0])}),_n(te,"handleTouchEnd",function(oe){oe.changedTouches!=null&&oe.changedTouches.length>0&&te.handleMouseUp(oe.changedTouches[0])}),_n(te,"triggerSyncEvent",function(oe){te.props.syncId!==void 0&&W3.emit(G3,te.props.syncId,oe,te.eventEmitterSymbol)}),_n(te,"applySyncEvent",function(oe){var he=te.props,le=he.layout,ve=he.syncMethod,We=te.state.updateId,Ie=oe.dataStartIndex,Re=oe.dataEndIndex;if(oe.dataStartIndex!==void 0||oe.dataEndIndex!==void 0)te.setState(qt({dataStartIndex:Ie,dataEndIndex:Re},F({props:te.props,dataStartIndex:Ie,dataEndIndex:Re,updateId:We},te.state)));else if(oe.activeTooltipIndex!==void 0){var $e=oe.chartX,ot=oe.chartY,Je=oe.activeTooltipIndex,rt=te.state,st=rt.offset,at=rt.tooltipTicks;if(!st)return;if(typeof ve=="function")Je=ve(at,oe);else if(ve==="value"){Je=-1;for(var Be=0;Be<at.length;Be++)if(at[Be].value===oe.activeLabel){Je=Be;break}}var ct=qt(qt({},st),{},{x:st.left,y:st.top}),jt=Math.min($e,ct.x+ct.width),Lt=Math.min(ot,ct.y+ct.height),$t=at[Je]&&at[Je].value,ut=xF(te.state,te.props.data,Je),tr=at[Je]?{x:le==="horizontal"?at[Je].coordinate:jt,y:le==="horizontal"?Lt:at[Je].coordinate}:$ne;te.setState(qt(qt({},oe),{},{activeLabel:$t,activeCoordinate:tr,activePayload:ut,activeTooltipIndex:Je}))}else te.setState(oe)}),_n(te,"renderCursor",function(oe){var he,le=te.state,ve=le.isTooltipActive,We=le.activeCoordinate,Ie=le.activePayload,Re=le.offset,$e=le.activeTooltipIndex,ot=le.tooltipAxisBandSize,Je=te.getTooltipEventType(),rt=(he=oe.props.active)!==null&&he!==void 0?he:ve,st=te.props.layout,at=oe.key||"_recharts-cursor";return ze.createElement(v6e,{key:at,activeCoordinate:We,activePayload:Ie,activeTooltipIndex:$e,chartName:r,element:oe,isActive:rt,layout:st,offset:Re,tooltipAxisBandSize:ot,tooltipEventType:Je})}),_n(te,"renderPolarAxis",function(oe,he,le){var ve=Ec(oe,"type.axisType"),We=Ec(te.state,"".concat(ve,"Map")),Ie=oe.type.defaultProps,Re=Ie!==void 0?qt(qt({},Ie),oe.props):oe.props,$e=We&&We[Re["".concat(ve,"Id")]];return ne.cloneElement(oe,qt(qt({},$e),{},{className:di(ve,$e.className),key:oe.key||"".concat(he,"-").concat(le),ticks:Eh($e,!0)}))}),_n(te,"renderPolarGrid",function(oe){var he=oe.props,le=he.radialLines,ve=he.polarAngles,We=he.polarRadius,Ie=te.state,Re=Ie.radiusAxisMap,$e=Ie.angleAxisMap,ot=wp(Re),Je=wp($e),rt=Je.cx,st=Je.cy,at=Je.innerRadius,Be=Je.outerRadius;return ne.cloneElement(oe,{polarAngles:Array.isArray(ve)?ve:Eh(Je,!0).map(function(ct){return ct.coordinate}),polarRadius:Array.isArray(We)?We:Eh(ot,!0).map(function(ct){return ct.coordinate}),cx:rt,cy:st,innerRadius:at,outerRadius:Be,key:oe.key||"polar-grid",radialLines:le})}),_n(te,"renderLegend",function(){var oe=te.state.formattedGraphicalItems,he=te.props,le=he.children,ve=he.width,We=he.height,Ie=te.props.margin||{},Re=ve-(Ie.left||0)-(Ie.right||0),$e=Cre({children:le,formattedGraphicalItems:oe,legendWidth:Re,legendContent:b});if(!$e)return null;var ot=$e.item,Je=oZ($e,_6e);return ne.cloneElement(ot,qt(qt({},Je),{},{chartWidth:ve,chartHeight:We,margin:Ie,onBBoxUpdate:te.handleLegendBBoxUpdate}))}),_n(te,"renderTooltip",function(){var oe,he=te.props,le=he.children,ve=he.accessibilityLayer,We=Dl(le,hu);if(!We)return null;var Ie=te.state,Re=Ie.isTooltipActive,$e=Ie.activeCoordinate,ot=Ie.activePayload,Je=Ie.activeLabel,rt=Ie.offset,st=(oe=We.props.active)!==null&&oe!==void 0?oe:Re;return ne.cloneElement(We,{viewBox:qt(qt({},rt),{},{x:rt.left,y:rt.top}),active:st,label:Je,payload:st?ot:[],coordinate:$e,accessibilityLayer:ve})}),_n(te,"renderBrush",function(oe){var he=te.props,le=he.margin,ve=he.data,We=te.state,Ie=We.offset,Re=We.dataStartIndex,$e=We.dataEndIndex,ot=We.updateId;return ne.cloneElement(oe,{key:oe.key||"_recharts-brush",onChange:uM(te.handleBrushChange,oe.props.onChange),data:ve,x:br(oe.props.x)?oe.props.x:Ie.left,y:br(oe.props.y)?oe.props.y:Ie.top+Ie.height+Ie.brushBottom-(le.bottom||0),width:br(oe.props.width)?oe.props.width:Ie.width,startIndex:Re,endIndex:$e,updateId:"brush-".concat(ot)})}),_n(te,"renderReferenceElement",function(oe,he,le){if(!oe)return null;var ve=te,We=ve.clipPathId,Ie=te.state,Re=Ie.xAxisMap,$e=Ie.yAxisMap,ot=Ie.offset,Je=oe.type.defaultProps||{},rt=oe.props,st=rt.xAxisId,at=st===void 0?Je.xAxisId:st,Be=rt.yAxisId,ct=Be===void 0?Je.yAxisId:Be;return ne.cloneElement(oe,{key:oe.key||"".concat(he,"-").concat(le),xAxis:Re[at],yAxis:$e[ct],viewBox:{x:ot.left,y:ot.top,width:ot.width,height:ot.height},clipPathId:We})}),_n(te,"renderActivePoints",function(oe){var he=oe.item,le=oe.activePoint,ve=oe.basePoint,We=oe.childIndex,Ie=oe.isRange,Re=[],$e=he.props.key,ot=he.item.type.defaultProps!==void 0?qt(qt({},he.item.type.defaultProps),he.item.props):he.item.props,Je=ot.activeDot,rt=ot.dataKey,st=qt(qt({index:We,dataKey:rt,cx:le.x,cy:le.y,r:4,fill:X5(he.item),strokeWidth:2,stroke:"#fff",payload:le.payload,value:le.value},Xn(Je,!1)),aI(Je));return Re.push(H.renderActiveDot(Je,st,"".concat($e,"-activePoint-").concat(We))),ve?Re.push(H.renderActiveDot(Je,qt(qt({},st),{},{cx:ve.x,cy:ve.y}),"".concat($e,"-basePoint-").concat(We))):Ie&&Re.push(null),Re}),_n(te,"renderGraphicChild",function(oe,he,le){var ve=te.filterFormatItem(oe,he,le);if(!ve)return null;var We=te.getTooltipEventType(),Ie=te.state,Re=Ie.isTooltipActive,$e=Ie.tooltipAxis,ot=Ie.activeTooltipIndex,Je=Ie.activeLabel,rt=te.props.children,st=Dl(rt,hu),at=ve.props,Be=at.points,ct=at.isRange,jt=at.baseLine,Lt=ve.item.type.defaultProps!==void 0?qt(qt({},ve.item.type.defaultProps),ve.item.props):ve.item.props,$t=Lt.activeDot,ut=Lt.hide,tr=Lt.activeBar,mr=Lt.activeShape,rr=!!(!ut&&Re&&st&&($t||tr||mr)),Ut={};We!=="axis"&&st&&st.props.trigger==="click"?Ut={onClick:uM(te.handleItemMouseEnter,oe.props.onClick)}:We!=="axis"&&(Ut={onMouseLeave:uM(te.handleItemMouseLeave,oe.props.onMouseLeave),onMouseEnter:uM(te.handleItemMouseEnter,oe.props.onMouseEnter)});var gr=ne.cloneElement(oe,qt(qt({},ve.props),Ut));function Gt(dr){return typeof $e.dataKey=="function"?$e.dataKey(dr.payload):null}if(rr)if(ot>=0){var ge,cr;if($e.dataKey&&!$e.allowDuplicatedCategory){var Ot=typeof $e.dataKey=="function"?Gt:"payload.".concat($e.dataKey.toString());ge=oI(Be,Ot,Je),cr=ct&&jt&&oI(jt,Ot,Je)}else ge=Be==null?void 0:Be[ot],cr=ct&&jt&&jt[ot];if(mr||tr){var Pr=oe.props.activeIndex!==void 0?oe.props.activeIndex:ot;return[ne.cloneElement(oe,qt(qt(qt({},ve.props),Ut),{},{activeIndex:Pr})),null,null]}if(!oi(ge))return[gr].concat(px(te.renderActivePoints({item:ve,activePoint:ge,basePoint:cr,childIndex:ot,isRange:ct})))}else{var _t,hn=(_t=te.getItemByXY(te.state.activeCoordinate))!==null&&_t!==void 0?_t:{graphicalItem:gr},qr=hn.graphicalItem,Ln=qr.item,Ge=Ln===void 0?oe:Ln,vt=qr.childIndex,kt=qt(qt(qt({},ve.props),Ut),{},{activeIndex:vt});return[ne.cloneElement(Ge,kt),null,null]}return ct?[gr,null,null]:[gr,null]}),_n(te,"renderCustomized",function(oe,he,le){return ne.cloneElement(oe,qt(qt({key:"recharts-customized-".concat(le)},te.props),te.state))}),_n(te,"renderMap",{CartesianGrid:{handler:mM,once:!0},ReferenceArea:{handler:te.renderReferenceElement},ReferenceLine:{handler:mM},ReferenceDot:{handler:te.renderReferenceElement},XAxis:{handler:mM},YAxis:{handler:mM},Brush:{handler:te.renderBrush,once:!0},Bar:{handler:te.renderGraphicChild},Line:{handler:te.renderGraphicChild},Area:{handler:te.renderGraphicChild},Radar:{handler:te.renderGraphicChild},RadialBar:{handler:te.renderGraphicChild},Scatter:{handler:te.renderGraphicChild},Pie:{handler:te.renderGraphicChild},Funnel:{handler:te.renderGraphicChild},Tooltip:{handler:te.renderCursor,once:!0},PolarGrid:{handler:te.renderPolarGrid,once:!0},PolarAngleAxis:{handler:te.renderPolarAxis},PolarRadiusAxis:{handler:te.renderPolarAxis},Customized:{handler:te.renderCustomized}}),te.clipPathId="".concat((G=q.id)!==null&&G!==void 0?G:xE("recharts"),"-clip"),te.throttleTriggeredAfterMouseMove=Mte(te.triggeredAfterMouseMove,(J=q.throttleDelay)!==null&&J!==void 0?J:1e3/60),te.state={},te}return O6e(H,$),M6e(H,[{key:"componentDidMount",value:function(){var G,J;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(G=this.props.margin.left)!==null&&G!==void 0?G:0,top:(J=this.props.margin.top)!==null&&J!==void 0?J:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var G=this.props,J=G.children,te=G.data,oe=G.height,he=G.layout,le=Dl(J,hu);if(le){var ve=le.props.defaultIndex;if(!(typeof ve!="number"||ve<0||ve>this.state.tooltipTicks.length-1)){var We=this.state.tooltipTicks[ve]&&this.state.tooltipTicks[ve].value,Ie=xF(this.state,te,ve,We),Re=this.state.tooltipTicks[ve].coordinate,$e=(this.state.offset.top+oe)/2,ot=he==="horizontal",Je=ot?{x:Re,y:$e}:{y:Re,x:$e},rt=this.state.formattedGraphicalItems.find(function(at){var Be=at.item;return Be.type.name==="Scatter"});rt&&(Je=qt(qt({},Je),rt.props.points[ve].tooltipPosition),Ie=rt.props.points[ve].tooltipPayload);var st={activeTooltipIndex:ve,isTooltipActive:!0,activeLabel:We,activePayload:Ie,activeCoordinate:Je};this.setState(st),this.renderCursor(le),this.accessibilityManager.setIndex(ve)}}}},{key:"getSnapshotBeforeUpdate",value:function(G,J){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==J.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==G.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==G.margin){var te,oe;this.accessibilityManager.setDetails({offset:{left:(te=this.props.margin.left)!==null&&te!==void 0?te:0,top:(oe=this.props.margin.top)!==null&&oe!==void 0?oe:0}})}return null}},{key:"componentDidUpdate",value:function(G){Qz([Dl(G.children,hu)],[Dl(this.props.children,hu)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var G=Dl(this.props.children,hu);if(G&&typeof G.props.shared=="boolean"){var J=G.props.shared?"axis":"item";return i.indexOf(J)>=0?J:l}return l}},{key:"getMouseInfo",value:function(G){if(!this.container)return null;var J=this.container,te=J.getBoundingClientRect(),oe=BRe(te),he={chartX:Math.round(G.pageX-oe.left),chartY:Math.round(G.pageY-oe.top)},le=te.width/J.offsetWidth||1,ve=this.inRange(he.chartX,he.chartY,le);if(!ve)return null;var We=this.state,Ie=We.xAxisMap,Re=We.yAxisMap,$e=this.getTooltipEventType();if($e!=="axis"&&Ie&&Re){var ot=wp(Ie).scale,Je=wp(Re).scale,rt=ot&&ot.invert?ot.invert(he.chartX):null,st=Je&&Je.invert?Je.invert(he.chartY):null;return qt(qt({},he),{},{xValue:rt,yValue:st})}var at=sZ(this.state,this.props.data,this.props.layout,ve);return at?qt(qt({},he),at):null}},{key:"inRange",value:function(G,J){var te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,oe=this.props.layout,he=G/te,le=J/te;if(oe==="horizontal"||oe==="vertical"){var ve=this.state.offset,We=he>=ve.left&&he<=ve.left+ve.width&&le>=ve.top&&le<=ve.top+ve.height;return We?{x:he,y:le}:null}var Ie=this.state,Re=Ie.angleAxisMap,$e=Ie.radiusAxisMap;if(Re&&$e){var ot=wp(Re);return V7({x:he,y:le},ot)}return null}},{key:"parseEventsOfWrapper",value:function(){var G=this.props.children,J=this.getTooltipEventType(),te=Dl(G,hu),oe={};te&&J==="axis"&&(te.props.trigger==="click"?oe={onClick:this.handleClick}:oe={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var he=aI(this.props,this.handleOuterEvent);return qt(qt({},he),oe)}},{key:"addListener",value:function(){W3.on(G3,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){W3.removeListener(G3,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(G,J,te){for(var oe=this.state.formattedGraphicalItems,he=0,le=oe.length;he<le;he++){var ve=oe[he];if(ve.item===G||ve.props.key===G.key||J===Ih(ve.item.type)&&te===ve.childIndex)return ve}return null}},{key:"renderClipPath",value:function(){var G=this.clipPathId,J=this.state.offset,te=J.left,oe=J.top,he=J.height,le=J.width;return ze.createElement("defs",null,ze.createElement("clipPath",{id:G},ze.createElement("rect",{x:te,y:oe,height:he,width:le})))}},{key:"getXScales",value:function(){var G=this.state.xAxisMap;return G?Object.entries(G).reduce(function(J,te){var oe=iZ(te,2),he=oe[0],le=oe[1];return qt(qt({},J),{},_n({},he,le.scale))},{}):null}},{key:"getYScales",value:function(){var G=this.state.yAxisMap;return G?Object.entries(G).reduce(function(J,te){var oe=iZ(te,2),he=oe[0],le=oe[1];return qt(qt({},J),{},_n({},he,le.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(G){var J;return(J=this.state.xAxisMap)===null||J===void 0||(J=J[G])===null||J===void 0?void 0:J.scale}},{key:"getYScaleByAxisId",value:function(G){var J;return(J=this.state.yAxisMap)===null||J===void 0||(J=J[G])===null||J===void 0?void 0:J.scale}},{key:"getItemByXY",value:function(G){var J=this.state,te=J.formattedGraphicalItems,oe=J.activeItem;if(te&&te.length)for(var he=0,le=te.length;he<le;he++){var ve=te[he],We=ve.props,Ie=ve.item,Re=Ie.type.defaultProps!==void 0?qt(qt({},Ie.type.defaultProps),Ie.props):Ie.props,$e=Ih(Ie.type);if($e==="Bar"){var ot=(We.data||[]).find(function(at){return h4e(G,at)});if(ot)return{graphicalItem:ve,payload:ot}}else if($e==="RadialBar"){var Je=(We.data||[]).find(function(at){return V7(G,at)});if(Je)return{graphicalItem:ve,payload:Je}}else if(qk(ve,oe)||Hk(ve,oe)||kT(ve,oe)){var rt=mBe({graphicalItem:ve,activeTooltipItem:oe,itemData:Re.data}),st=Re.activeIndex===void 0?rt:Re.activeIndex;return{graphicalItem:qt(qt({},ve),{},{childIndex:st}),payload:kT(ve,oe)?Re.data[rt]:ve.props.data[rt]}}}return null}},{key:"render",value:function(){var G=this;if(!kq(this))return null;var J=this.props,te=J.children,oe=J.className,he=J.width,le=J.height,ve=J.style,We=J.compact,Ie=J.title,Re=J.desc,$e=oZ(J,x6e),ot=Xn($e,!1);if(We)return ze.createElement($9,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ze.createElement(tj,AS({},ot,{width:he,height:le,title:Ie,desc:Re}),this.renderClipPath(),Dq(te,this.renderMap)));if(this.props.accessibilityLayer){var Je,rt;ot.tabIndex=(Je=this.props.tabIndex)!==null&&Je!==void 0?Je:0,ot.role=(rt=this.props.role)!==null&&rt!==void 0?rt:"application",ot.onKeyDown=function(at){G.accessibilityManager.keyboardEvent(at)},ot.onFocus=function(){G.accessibilityManager.focus()}}var st=this.parseEventsOfWrapper();return ze.createElement($9,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ze.createElement("div",AS({className:di("recharts-wrapper",oe),style:qt({position:"relative",cursor:"default",width:he,height:le},ve)},st,{ref:function(Be){G.container=Be}}),ze.createElement(tj,AS({},ot,{width:he,height:le,title:Ie,desc:Re,style:z6e}),this.renderClipPath(),Dq(te,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(ne.Component);return _n(U,"displayName",r),_n(U,"defaultProps",qt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},C)),_n(U,"getDerivedStateFromProps",function($,H){var q=$.dataKey,G=$.data,J=$.children,te=$.width,oe=$.height,he=$.layout,le=$.stackOffset,ve=$.margin,We=H.dataStartIndex,Ie=H.dataEndIndex;if(H.updateId===void 0){var Re=lZ($);return qt(qt(qt({},Re),{},{updateId:0},F(qt(qt({props:$},Re),{},{updateId:0}),H)),{},{prevDataKey:q,prevData:G,prevWidth:te,prevHeight:oe,prevLayout:he,prevStackOffset:le,prevMargin:ve,prevChildren:J})}if(q!==H.prevDataKey||G!==H.prevData||te!==H.prevWidth||oe!==H.prevHeight||he!==H.prevLayout||le!==H.prevStackOffset||!f0(ve,H.prevMargin)){var $e=lZ($),ot={chartX:H.chartX,chartY:H.chartY,isTooltipActive:H.isTooltipActive},Je=qt(qt({},sZ(H,G,he)),{},{updateId:H.updateId+1}),rt=qt(qt(qt({},$e),ot),Je);return qt(qt(qt({},rt),F(qt({props:$},rt),H)),{},{prevDataKey:q,prevData:G,prevWidth:te,prevHeight:oe,prevLayout:he,prevStackOffset:le,prevMargin:ve,prevChildren:J})}if(!Qz(J,H.prevChildren)){var st,at,Be,ct,jt=Dl(J,rx),Lt=jt&&(st=(at=jt.props)===null||at===void 0?void 0:at.startIndex)!==null&&st!==void 0?st:We,$t=jt&&(Be=(ct=jt.props)===null||ct===void 0?void 0:ct.endIndex)!==null&&Be!==void 0?Be:Ie,ut=Lt!==We||$t!==Ie,tr=!oi(G),mr=tr&&!ut?H.updateId:H.updateId+1;return qt(qt({updateId:mr},F(qt(qt({props:$},H),{},{updateId:mr,dataStartIndex:Lt,dataEndIndex:$t}),H)),{},{prevChildren:J,dataStartIndex:Lt,dataEndIndex:$t})}return null}),_n(U,"renderActiveDot",function($,H,q){var G;return ne.isValidElement($)?G=ne.cloneElement($,H):Vn($)?G=$(H):G=ze.createElement(K5,H),ze.createElement(To,{className:"recharts-active-dot",key:q},G)}),function(H){return ze.createElement(U,H)}},H6e=Vne({chartName:"BarChart",GraphicalChild:am,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ux},{axisType:"yAxis",AxisComp:hx}],formatAxisMap:one}),Z6e=Vne({chartName:"AreaChart",GraphicalChild:Hh,axisComponents:[{axisType:"xAxis",AxisComp:ux},{axisType:"yAxis",AxisComp:hx}],formatAxisMap:one});const gM=({title:e,value:t,icon:r,change:n,changeType:a="neutral",variant:l="default",className:f})=>j.jsxs("div",{className:Nr("stats-card flex items-start",l==="outline"&&"border-2",f),children:[j.jsxs("div",{className:"flex-1",children:[j.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:e}),j.jsxs("div",{className:"mt-1 flex items-baseline",children:[j.jsx("p",{className:"text-2xl font-semibold",children:t}),n&&j.jsx("span",{className:Nr("ml-2 text-sm",a==="positive"&&"text-green-600",a==="negative"&&"text-red-600",a==="neutral"&&"text-gray-500"),children:n})]})]}),j.jsx("div",{className:Nr("rounded-md p-2",l==="default"&&"bg-primary/10 text-primary"),children:j.jsx(r,{className:"h-5 w-5"})})]}),yM=({icon:e,title:t,description:r,time:n,status:a="default"})=>j.jsxs("div",{className:"flex items-start space-x-3 py-3",children:[j.jsx("div",{className:Nr("rounded-full p-2 flex-shrink-0",a==="default"&&"bg-primary/10 text-primary",a==="success"&&"bg-green-100 text-green-600",a==="warning"&&"bg-amber-100 text-amber-600",a==="error"&&"bg-red-100 text-red-600"),children:j.jsx(e,{className:"h-4 w-4"})}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsx("p",{className:"text-sm font-medium",children:t}),j.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:r})]}),j.jsx("div",{className:"text-xs text-muted-foreground",children:n})]}),X6e={pending:{icon:Tme,bgColor:"bg-amber-100",textColor:"text-amber-600"},active:{icon:kJ,bgColor:"bg-red-100",textColor:"text-red-600"},resolved:{icon:wme,bgColor:"bg-green-100",textColor:"text-green-600"}},vM=({title:e,message:t,time:r,status:n})=>{const{icon:a,bgColor:l,textColor:f}=X6e[n];return j.jsxs("div",{className:"flex items-start space-x-3 py-3",children:[j.jsx("div",{className:Nr("rounded-full p-2 flex-shrink-0",l,f),children:j.jsx(a,{className:"h-4 w-4"})}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("p",{className:"text-sm font-medium",children:e}),j.jsx("span",{className:Nr("text-xs px-2 py-0.5 rounded",n==="pending"&&"bg-amber-100 text-amber-600",n==="active"&&"bg-red-100 text-red-600",n==="resolved"&&"bg-green-100 text-green-600"),children:n.charAt(0).toUpperCase()+n.slice(1)})]}),j.jsx("p",{className:"text-sm text-muted-foreground",children:t}),j.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r})]})]})},Y6e=[{name:"Lun",orders:40,deliveries:24},{name:"Mar",orders:30,deliveries:28},{name:"Mie",orders:20,deliveries:19},{name:"Jue",orders:27,deliveries:25},{name:"Vie",orders:18,deliveries:15},{name:"Sab",orders:23,deliveries:20},{name:"Dom",orders:34,deliveries:30}],K6e=[{name:"Conductor A",entregas:95,meta:85},{name:"Conductor B",entregas:75,meta:85},{name:"Conductor C",entregas:90,meta:85},{name:"Conductor D",entregas:100,meta:85},{name:"Conductor E",entregas:82,meta:85}],J6e=()=>j.jsxs("div",{className:"space-y-6 animate-fade-in",children:[j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard"}),j.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[j.jsx(yme,{className:"h-4 w-4"}),j.jsx("span",{children:new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[j.jsx(gM,{title:"Órdenes totales",value:"1,349",icon:l0,change:"+12.5%",changeType:"positive"}),j.jsx(gM,{title:"Entregas completadas",value:"892",icon:XS,change:"+8.2%",changeType:"positive"}),j.jsx(gM,{title:"Conductores activos",value:"18",icon:PG,change:"-2",changeType:"negative"}),j.jsx(gM,{title:"Alertas activas",value:"5",icon:kme,change:"+3",changeType:"negative"})]}),j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[j.jsxs("div",{className:"chart-container",children:[j.jsx("h2",{className:"text-lg font-medium mb-3",children:"Órdenes vs Entregas"}),j.jsx("div",{className:"h-64",children:j.jsx(OH,{width:"100%",height:"100%",children:j.jsxs(Z6e,{data:Y6e,margin:{top:10,right:30,left:0,bottom:0},children:[j.jsx(uF,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),j.jsx(ux,{dataKey:"name"}),j.jsx(hx,{}),j.jsx(hu,{}),j.jsx(Hh,{type:"monotone",dataKey:"orders",stackId:"1",stroke:"#3b82f6",fill:"#93c5fd"}),j.jsx(Hh,{type:"monotone",dataKey:"deliveries",stackId:"2",stroke:"#059669",fill:"#6ee7b7"})]})})})]}),j.jsxs("div",{className:"chart-container",children:[j.jsx("h2",{className:"text-lg font-medium mb-3",children:"Desempeño de Conductores"}),j.jsx("div",{className:"h-64",children:j.jsx(OH,{width:"100%",height:"100%",children:j.jsxs(H6e,{data:K6e,margin:{top:10,right:30,left:0,bottom:0},children:[j.jsx(uF,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),j.jsx(ux,{dataKey:"name"}),j.jsx(hx,{}),j.jsx(hu,{}),j.jsx(oy,{}),j.jsx(am,{dataKey:"entregas",fill:"#3b82f6"}),j.jsx(am,{dataKey:"meta",fill:"#e11d48"})]})})})]})]}),j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[j.jsxs("div",{className:"stats-card",children:[j.jsxs("div",{className:"flex items-center justify-between mb-4",children:[j.jsx("h2",{className:"text-lg font-medium",children:"Actividad Reciente"}),j.jsxs("button",{className:"text-primary text-sm hover:underline flex items-center",children:["Ver todo ",j.jsx(PB,{className:"h-4 w-4 ml-1"})]})]}),j.jsxs("div",{className:"divide-y",children:[j.jsx(yM,{icon:l0,title:"Nueva orden creada",description:"Pedido #12458 - Cliente: Comercial XYZ",time:"Hace 10 min",status:"default"}),j.jsx(yM,{icon:XS,title:"Entrega completada",description:"Pedido #12445 - Entregado por Juan Pérez",time:"Hace 25 min",status:"success"}),j.jsx(yM,{icon:PG,title:"Conductor asignado",description:"María López asignada a Ruta #R-124",time:"Hace 40 min",status:"default"}),j.jsx(yM,{icon:l0,title:"Paquete en ruta",description:"Pedido #12452 - En camino a destino",time:"Hace 1 hora",status:"default"})]})]}),j.jsxs("div",{className:"stats-card",children:[j.jsxs("div",{className:"flex items-center justify-between mb-4",children:[j.jsx("h2",{className:"text-lg font-medium",children:"Alertas Activas"}),j.jsx("span",{className:"bg-red-100 text-red-600 text-xs px-2 py-1 rounded-full",children:"5 alertas"})]}),j.jsxs("div",{className:"divide-y",children:[j.jsx(vM,{title:"Retraso en entrega",message:"Pedido #12449 retrasado por más de 1 hora",time:"Hace 35 min",status:"active"}),j.jsx(vM,{title:"Bajo inventario",message:"Producto SKU-45678 por debajo del nivel mínimo",time:"Hace 1 hora",status:"pending"}),j.jsx(vM,{title:"Vehículo detenido",message:"Unidad VH-003 detenida por más de 30 min",time:"Hace 50 min",status:"active"}),j.jsx(vM,{title:"Conductor fuera de ruta",message:"Conductor ID-78 se ha desviado de la ruta asignada",time:"Hace 15 min",status:"active"})]})]})]})]}),s$=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{className:"relative w-full overflow-auto",children:j.jsx("table",{ref:r,className:Nr("w-full caption-bottom text-sm",e),...t})}));s$.displayName="Table";const l$=ne.forwardRef(({className:e,...t},r)=>j.jsx("thead",{ref:r,className:Nr("[&_tr]:border-b",e),...t}));l$.displayName="TableHeader";const c$=ne.forwardRef(({className:e,...t},r)=>j.jsx("tbody",{ref:r,className:Nr("[&_tr:last-child]:border-0",e),...t}));c$.displayName="TableBody";const Q6e=ne.forwardRef(({className:e,...t},r)=>j.jsx("tfoot",{ref:r,className:Nr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Q6e.displayName="TableFooter";const qg=ne.forwardRef(({className:e,...t},r)=>j.jsx("tr",{ref:r,className:Nr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));qg.displayName="TableRow";const zl=ne.forwardRef(({className:e,...t},r)=>j.jsx("th",{ref:r,className:Nr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));zl.displayName="TableHead";const Es=ne.forwardRef(({className:e,...t},r)=>j.jsx("td",{ref:r,className:Nr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Es.displayName="TableCell";const eVe=ne.forwardRef(({className:e,...t},r)=>j.jsx("caption",{ref:r,className:Nr("mt-4 text-sm text-muted-foreground",e),...t}));eVe.displayName="TableCaption";function uZ(e,[t,r]){return Math.min(r,Math.max(t,e))}var tVe=ne.createContext(void 0);function eR(e){const t=ne.useContext(tVe);return e||t||"ltr"}var H3=0;function u$(){ne.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??dZ()),document.body.insertAdjacentElement("beforeend",e[1]??dZ()),H3++,()=>{H3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),H3--}},[])}function dZ(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Z3="focusScope.autoFocusOnMount",X3="focusScope.autoFocusOnUnmount",hZ={bubbles:!1,cancelable:!0},rVe="FocusScope",tR=ne.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...f}=e,[i,_]=ne.useState(null),b=pl(a),E=pl(l),C=ne.useRef(null),R=Ci(t,$=>_($)),F=ne.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;ne.useEffect(()=>{if(n){let $=function(J){if(F.paused||!i)return;const te=J.target;i.contains(te)?C.current=te:lp(C.current,{select:!0})},H=function(J){if(F.paused||!i)return;const te=J.relatedTarget;te!==null&&(i.contains(te)||lp(C.current,{select:!0}))},q=function(J){if(document.activeElement===document.body)for(const oe of J)oe.removedNodes.length>0&&lp(i)};document.addEventListener("focusin",$),document.addEventListener("focusout",H);const G=new MutationObserver(q);return i&&G.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",$),document.removeEventListener("focusout",H),G.disconnect()}}},[n,i,F.paused]),ne.useEffect(()=>{if(i){pZ.add(F);const $=document.activeElement;if(!i.contains($)){const q=new CustomEvent(Z3,hZ);i.addEventListener(Z3,b),i.dispatchEvent(q),q.defaultPrevented||(nVe(lVe(Wne(i)),{select:!0}),document.activeElement===$&&lp(i))}return()=>{i.removeEventListener(Z3,b),setTimeout(()=>{const q=new CustomEvent(X3,hZ);i.addEventListener(X3,E),i.dispatchEvent(q),q.defaultPrevented||lp($??document.body,{select:!0}),i.removeEventListener(X3,E),pZ.remove(F)},0)}}},[i,b,E,F]);const U=ne.useCallback($=>{if(!r&&!n||F.paused)return;const H=$.key==="Tab"&&!$.altKey&&!$.ctrlKey&&!$.metaKey,q=document.activeElement;if(H&&q){const G=$.currentTarget,[J,te]=iVe(G);J&&te?!$.shiftKey&&q===te?($.preventDefault(),r&&lp(J,{select:!0})):$.shiftKey&&q===J&&($.preventDefault(),r&&lp(te,{select:!0})):q===G&&$.preventDefault()}},[r,n,F.paused]);return j.jsx(In.div,{tabIndex:-1,...f,ref:R,onKeyDown:U})});tR.displayName=rVe;function nVe(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(lp(n,{select:t}),document.activeElement!==r)return}function iVe(e){const t=Wne(e),r=fZ(t,e),n=fZ(t.reverse(),e);return[r,n]}function Wne(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function fZ(e,t){for(const r of e)if(!oVe(r,{upTo:t}))return r}function oVe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function aVe(e){return e instanceof HTMLInputElement&&"select"in e}function lp(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&aVe(e)&&t&&e.select()}}var pZ=sVe();function sVe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=mZ(e,t),e.unshift(t)},remove(t){var r;e=mZ(e,t),(r=e[0])==null||r.resume()}}}function mZ(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function lVe(e){return e.filter(t=>t.tagName!=="A")}function Gne(e){const t=ne.useRef({value:e,previous:e});return ne.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var cVe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},u_=new WeakMap,_M=new WeakMap,xM={},Y3=0,qne=function(e){return e&&(e.host||qne(e.parentNode))},uVe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=qne(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},dVe=function(e,t,r,n){var a=uVe(t,Array.isArray(e)?e:[e]);xM[r]||(xM[r]=new WeakMap);var l=xM[r],f=[],i=new Set,_=new Set(a),b=function(C){!C||i.has(C)||(i.add(C),b(C.parentNode))};a.forEach(b);var E=function(C){!C||_.has(C)||Array.prototype.forEach.call(C.children,function(R){if(i.has(R))E(R);else try{var F=R.getAttribute(n),U=F!==null&&F!=="false",$=(u_.get(R)||0)+1,H=(l.get(R)||0)+1;u_.set(R,$),l.set(R,H),f.push(R),$===1&&U&&_M.set(R,!0),H===1&&R.setAttribute(r,"true"),U||R.setAttribute(n,"true")}catch(q){console.error("aria-hidden: cannot operate on ",R,q)}})};return E(t),i.clear(),Y3++,function(){f.forEach(function(C){var R=u_.get(C)-1,F=l.get(C)-1;u_.set(C,R),l.set(C,F),R||(_M.has(C)||C.removeAttribute(n),_M.delete(C)),F||C.removeAttribute(r)}),Y3--,Y3||(u_=new WeakMap,u_=new WeakMap,_M=new WeakMap,xM={})}},d$=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=cVe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),dVe(n,a,r,"aria-hidden")):function(){return null}},vd=function(){return vd=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},vd.apply(this,arguments)};function Hne(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function hVe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var WM="right-scroll-bar-position",GM="width-before-scroll-bar",fVe="with-scroll-bars-hidden",pVe="--removed-body-scroll-bar-size";function K3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function mVe(e,t){var r=ne.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var gVe=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,gZ=new WeakMap;function yVe(e,t){var r=mVe(null,function(n){return e.forEach(function(a){return K3(a,n)})});return gVe(function(){var n=gZ.get(r);if(n){var a=new Set(n),l=new Set(e),f=r.current;a.forEach(function(i){l.has(i)||K3(i,null)}),l.forEach(function(i){a.has(i)||K3(i,f)})}gZ.set(r,e)},[e]),r}function vVe(e){return e}function _Ve(e,t){t===void 0&&(t=vVe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(l){var f=t(l,n);return r.push(f),function(){r=r.filter(function(i){return i!==f})}},assignSyncMedium:function(l){for(n=!0;r.length;){var f=r;r=[],f.forEach(l)}r={push:function(i){return l(i)},filter:function(){return r}}},assignMedium:function(l){n=!0;var f=[];if(r.length){var i=r;r=[],i.forEach(l),f=r}var _=function(){var E=f;f=[],E.forEach(l)},b=function(){return Promise.resolve().then(_)};b(),r={push:function(E){f.push(E),b()},filter:function(E){return f=f.filter(E),r}}}};return a}function xVe(e){e===void 0&&(e={});var t=_Ve(null);return t.options=vd({async:!0,ssr:!1},e),t}var Zne=function(e){var t=e.sideCar,r=Hne(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return ne.createElement(n,vd({},r))};Zne.isSideCarExport=!0;function bVe(e,t){return e.useMedium(t),Zne}var Xne=xVe(),J3=function(){},rR=ne.forwardRef(function(e,t){var r=ne.useRef(null),n=ne.useState({onScrollCapture:J3,onWheelCapture:J3,onTouchMoveCapture:J3}),a=n[0],l=n[1],f=e.forwardProps,i=e.children,_=e.className,b=e.removeScrollBar,E=e.enabled,C=e.shards,R=e.sideCar,F=e.noIsolation,U=e.inert,$=e.allowPinchZoom,H=e.as,q=H===void 0?"div":H,G=e.gapMode,J=Hne(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),te=R,oe=yVe([r,t]),he=vd(vd({},J),a);return ne.createElement(ne.Fragment,null,E&&ne.createElement(te,{sideCar:Xne,removeScrollBar:b,shards:C,noIsolation:F,inert:U,setCallbacks:l,allowPinchZoom:!!$,lockRef:r,gapMode:G}),f?ne.cloneElement(ne.Children.only(i),vd(vd({},he),{ref:oe})):ne.createElement(q,vd({},he,{className:_,ref:oe}),i))});rR.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};rR.classNames={fullWidth:GM,zeroRight:WM};var wVe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function SVe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=wVe();return t&&e.setAttribute("nonce",t),e}function TVe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function EVe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var AVe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=SVe())&&(TVe(t,r),EVe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},MVe=function(){var e=AVe();return function(t,r){ne.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Yne=function(){var e=MVe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},CVe={left:0,top:0,right:0,gap:0},Q3=function(e){return parseInt(e||"",10)||0},PVe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Q3(r),Q3(n),Q3(a)]},IVe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return CVe;var t=PVe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},OVe=Yne(),g0="data-scroll-locked",kVe=function(e,t,r,n){var a=e.left,l=e.top,f=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(fVe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(g0,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(f,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(WM,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(GM,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(WM," .").concat(WM,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(GM," .").concat(GM,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(g0,`] {
    `).concat(pVe,": ").concat(i,`px;
  }
`)},yZ=function(){var e=parseInt(document.body.getAttribute(g0)||"0",10);return isFinite(e)?e:0},RVe=function(){ne.useEffect(function(){return document.body.setAttribute(g0,(yZ()+1).toString()),function(){var e=yZ()-1;e<=0?document.body.removeAttribute(g0):document.body.setAttribute(g0,e.toString())}},[])},DVe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;RVe();var l=ne.useMemo(function(){return IVe(a)},[a]);return ne.createElement(OVe,{styles:kVe(l,!t,a,r?"":"!important")})},bF=!1;if(typeof window<"u")try{var bM=Object.defineProperty({},"passive",{get:function(){return bF=!0,!0}});window.addEventListener("test",bM,bM),window.removeEventListener("test",bM,bM)}catch{bF=!1}var d_=bF?{passive:!1}:!1,LVe=function(e){return e.tagName==="TEXTAREA"},Kne=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!LVe(e)&&r[t]==="visible")},NVe=function(e){return Kne(e,"overflowY")},zVe=function(e){return Kne(e,"overflowX")},vZ=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=Jne(e,n);if(a){var l=Qne(e,n),f=l[1],i=l[2];if(f>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},jVe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},FVe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Jne=function(e,t){return e==="v"?NVe(t):zVe(t)},Qne=function(e,t){return e==="v"?jVe(t):FVe(t)},BVe=function(e,t){return e==="h"&&t==="rtl"?-1:1},$Ve=function(e,t,r,n,a){var l=BVe(e,window.getComputedStyle(t).direction),f=l*n,i=r.target,_=t.contains(i),b=!1,E=f>0,C=0,R=0;do{var F=Qne(e,i),U=F[0],$=F[1],H=F[2],q=$-H-l*U;(U||q)&&Jne(e,i)&&(C+=q,R+=U),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!_&&i!==document.body||_&&(t.contains(i)||t===i));return(E&&(Math.abs(C)<1||!a)||!E&&(Math.abs(R)<1||!a))&&(b=!0),b},wM=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},_Z=function(e){return[e.deltaX,e.deltaY]},xZ=function(e){return e&&"current"in e?e.current:e},UVe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},VVe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},WVe=0,h_=[];function GVe(e){var t=ne.useRef([]),r=ne.useRef([0,0]),n=ne.useRef(),a=ne.useState(WVe++)[0],l=ne.useState(Yne)[0],f=ne.useRef(e);ne.useEffect(function(){f.current=e},[e]),ne.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var $=hVe([e.lockRef.current],(e.shards||[]).map(xZ),!0).filter(Boolean);return $.forEach(function(H){return H.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),$.forEach(function(H){return H.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=ne.useCallback(function($,H){if("touches"in $&&$.touches.length===2||$.type==="wheel"&&$.ctrlKey)return!f.current.allowPinchZoom;var q=wM($),G=r.current,J="deltaX"in $?$.deltaX:G[0]-q[0],te="deltaY"in $?$.deltaY:G[1]-q[1],oe,he=$.target,le=Math.abs(J)>Math.abs(te)?"h":"v";if("touches"in $&&le==="h"&&he.type==="range")return!1;var ve=vZ(le,he);if(!ve)return!0;if(ve?oe=le:(oe=le==="v"?"h":"v",ve=vZ(le,he)),!ve)return!1;if(!n.current&&"changedTouches"in $&&(J||te)&&(n.current=oe),!oe)return!0;var We=n.current||oe;return $Ve(We,H,$,We==="h"?J:te,!0)},[]),_=ne.useCallback(function($){var H=$;if(!(!h_.length||h_[h_.length-1]!==l)){var q="deltaY"in H?_Z(H):wM(H),G=t.current.filter(function(oe){return oe.name===H.type&&(oe.target===H.target||H.target===oe.shadowParent)&&UVe(oe.delta,q)})[0];if(G&&G.should){H.cancelable&&H.preventDefault();return}if(!G){var J=(f.current.shards||[]).map(xZ).filter(Boolean).filter(function(oe){return oe.contains(H.target)}),te=J.length>0?i(H,J[0]):!f.current.noIsolation;te&&H.cancelable&&H.preventDefault()}}},[]),b=ne.useCallback(function($,H,q,G){var J={name:$,delta:H,target:q,should:G,shadowParent:qVe(q)};t.current.push(J),setTimeout(function(){t.current=t.current.filter(function(te){return te!==J})},1)},[]),E=ne.useCallback(function($){r.current=wM($),n.current=void 0},[]),C=ne.useCallback(function($){b($.type,_Z($),$.target,i($,e.lockRef.current))},[]),R=ne.useCallback(function($){b($.type,wM($),$.target,i($,e.lockRef.current))},[]);ne.useEffect(function(){return h_.push(l),e.setCallbacks({onScrollCapture:C,onWheelCapture:C,onTouchMoveCapture:R}),document.addEventListener("wheel",_,d_),document.addEventListener("touchmove",_,d_),document.addEventListener("touchstart",E,d_),function(){h_=h_.filter(function($){return $!==l}),document.removeEventListener("wheel",_,d_),document.removeEventListener("touchmove",_,d_),document.removeEventListener("touchstart",E,d_)}},[]);var F=e.removeScrollBar,U=e.inert;return ne.createElement(ne.Fragment,null,U?ne.createElement(l,{styles:VVe(a)}):null,F?ne.createElement(DVe,{gapMode:e.gapMode}):null)}function qVe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const HVe=bVe(Xne,GVe);var nR=ne.forwardRef(function(e,t){return ne.createElement(rR,vd({},e,{ref:t,sideCar:HVe}))});nR.classNames=rR.classNames;var ZVe=[" ","Enter","ArrowUp","ArrowDown"],XVe=[" ","Enter"],AE="Select",[iR,oR,YVe]=SB(AE),[Qx,kKe]=gm(AE,[YVe,Dx]),aR=Dx(),[KVe,Sm]=Qx(AE),[JVe,QVe]=Qx(AE),eie=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:l,value:f,defaultValue:i,onValueChange:_,dir:b,name:E,autoComplete:C,disabled:R,required:F,form:U}=e,$=aR(t),[H,q]=ne.useState(null),[G,J]=ne.useState(null),[te,oe]=ne.useState(!1),he=eR(b),[le=!1,ve]=tm({prop:n,defaultProp:a,onChange:l}),[We,Ie]=tm({prop:f,defaultProp:i,onChange:_}),Re=ne.useRef(null),$e=H?U||!!H.closest("form"):!0,[ot,Je]=ne.useState(new Set),rt=Array.from(ot).map(st=>st.props.value).join(";");return j.jsx(hQ,{...$,children:j.jsxs(KVe,{required:F,scope:t,trigger:H,onTriggerChange:q,valueNode:G,onValueNodeChange:J,valueNodeHasChildren:te,onValueNodeHasChildrenChange:oe,contentId:Ph(),value:We,onValueChange:Ie,open:le,onOpenChange:ve,dir:he,triggerPointerDownPosRef:Re,disabled:R,children:[j.jsx(iR.Provider,{scope:t,children:j.jsx(JVe,{scope:e.__scopeSelect,onNativeOptionAdd:ne.useCallback(st=>{Je(at=>new Set(at).add(st))},[]),onNativeOptionRemove:ne.useCallback(st=>{Je(at=>{const Be=new Set(at);return Be.delete(st),Be})},[]),children:r})}),$e?j.jsxs(Eie,{"aria-hidden":!0,required:F,tabIndex:-1,name:E,autoComplete:C,value:We,onChange:st=>Ie(st.target.value),disabled:R,form:U,children:[We===void 0?j.jsx("option",{value:""}):null,Array.from(ot)]},rt):null]})})};eie.displayName=AE;var tie="SelectTrigger",rie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,l=aR(r),f=Sm(tie,r),i=f.disabled||n,_=Ci(t,f.onTriggerChange),b=oR(r),E=ne.useRef("touch"),[C,R,F]=Aie($=>{const H=b().filter(J=>!J.disabled),q=H.find(J=>J.value===f.value),G=Mie(H,$,q);G!==void 0&&f.onValueChange(G.value)}),U=$=>{i||(f.onOpenChange(!0),F()),$&&(f.triggerPointerDownPosRef.current={x:Math.round($.pageX),y:Math.round($.pageY)})};return j.jsx(ek,{asChild:!0,...l,children:j.jsx(In.button,{type:"button",role:"combobox","aria-controls":f.contentId,"aria-expanded":f.open,"aria-required":f.required,"aria-autocomplete":"none",dir:f.dir,"data-state":f.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":Tie(f.value)?"":void 0,...a,ref:_,onClick:Kr(a.onClick,$=>{$.currentTarget.focus(),E.current!=="mouse"&&U($)}),onPointerDown:Kr(a.onPointerDown,$=>{E.current=$.pointerType;const H=$.target;H.hasPointerCapture($.pointerId)&&H.releasePointerCapture($.pointerId),$.button===0&&$.ctrlKey===!1&&$.pointerType==="mouse"&&(U($),$.preventDefault())}),onKeyDown:Kr(a.onKeyDown,$=>{const H=C.current!=="";!($.ctrlKey||$.altKey||$.metaKey)&&$.key.length===1&&R($.key),!(H&&$.key===" ")&&ZVe.includes($.key)&&(U(),$.preventDefault())})})})});rie.displayName=tie;var nie="SelectValue",iie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:l,placeholder:f="",...i}=e,_=Sm(nie,r),{onValueNodeHasChildrenChange:b}=_,E=l!==void 0,C=Ci(t,_.onValueNodeChange);return as(()=>{b(E)},[b,E]),j.jsx(In.span,{...i,ref:C,style:{pointerEvents:"none"},children:Tie(_.value)?j.jsx(j.Fragment,{children:f}):l})});iie.displayName=nie;var e8e="SelectIcon",oie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return j.jsx(In.span,{"aria-hidden":!0,...a,ref:t,children:n||"▼"})});oie.displayName=e8e;var t8e="SelectPortal",aie=e=>j.jsx(dE,{asChild:!0,...e});aie.displayName=t8e;var Ty="SelectContent",sie=ne.forwardRef((e,t)=>{const r=Sm(Ty,e.__scopeSelect),[n,a]=ne.useState();if(as(()=>{a(new DocumentFragment)},[]),!r.open){const l=n;return l?Dy.createPortal(j.jsx(lie,{scope:e.__scopeSelect,children:j.jsx(iR.Slot,{scope:e.__scopeSelect,children:j.jsx("div",{children:e.children})})}),l):null}return j.jsx(cie,{...e,ref:t})});sie.displayName=Ty;var su=10,[lie,Tm]=Qx(Ty),r8e="SelectContentImpl",cie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:f,side:i,sideOffset:_,align:b,alignOffset:E,arrowPadding:C,collisionBoundary:R,collisionPadding:F,sticky:U,hideWhenDetached:$,avoidCollisions:H,...q}=e,G=Sm(Ty,r),[J,te]=ne.useState(null),[oe,he]=ne.useState(null),le=Ci(t,Ut=>te(Ut)),[ve,We]=ne.useState(null),[Ie,Re]=ne.useState(null),$e=oR(r),[ot,Je]=ne.useState(!1),rt=ne.useRef(!1);ne.useEffect(()=>{if(J)return d$(J)},[J]),u$();const st=ne.useCallback(Ut=>{const[gr,...Gt]=$e().map(Ot=>Ot.ref.current),[ge]=Gt.slice(-1),cr=document.activeElement;for(const Ot of Ut)if(Ot===cr||(Ot==null||Ot.scrollIntoView({block:"nearest"}),Ot===gr&&oe&&(oe.scrollTop=0),Ot===ge&&oe&&(oe.scrollTop=oe.scrollHeight),Ot==null||Ot.focus(),document.activeElement!==cr))return},[$e,oe]),at=ne.useCallback(()=>st([ve,J]),[st,ve,J]);ne.useEffect(()=>{ot&&at()},[ot,at]);const{onOpenChange:Be,triggerPointerDownPosRef:ct}=G;ne.useEffect(()=>{if(J){let Ut={x:0,y:0};const gr=ge=>{var cr,Ot;Ut={x:Math.abs(Math.round(ge.pageX)-(((cr=ct.current)==null?void 0:cr.x)??0)),y:Math.abs(Math.round(ge.pageY)-(((Ot=ct.current)==null?void 0:Ot.y)??0))}},Gt=ge=>{Ut.x<=10&&Ut.y<=10?ge.preventDefault():J.contains(ge.target)||Be(!1),document.removeEventListener("pointermove",gr),ct.current=null};return ct.current!==null&&(document.addEventListener("pointermove",gr),document.addEventListener("pointerup",Gt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",gr),document.removeEventListener("pointerup",Gt,{capture:!0})}}},[J,Be,ct]),ne.useEffect(()=>{const Ut=()=>Be(!1);return window.addEventListener("blur",Ut),window.addEventListener("resize",Ut),()=>{window.removeEventListener("blur",Ut),window.removeEventListener("resize",Ut)}},[Be]);const[jt,Lt]=Aie(Ut=>{const gr=$e().filter(cr=>!cr.disabled),Gt=gr.find(cr=>cr.ref.current===document.activeElement),ge=Mie(gr,Ut,Gt);ge&&setTimeout(()=>ge.ref.current.focus())}),$t=ne.useCallback((Ut,gr,Gt)=>{const ge=!rt.current&&!Gt;(G.value!==void 0&&G.value===gr||ge)&&(We(Ut),ge&&(rt.current=!0))},[G.value]),ut=ne.useCallback(()=>J==null?void 0:J.focus(),[J]),tr=ne.useCallback((Ut,gr,Gt)=>{const ge=!rt.current&&!Gt;(G.value!==void 0&&G.value===gr||ge)&&Re(Ut)},[G.value]),mr=n==="popper"?wF:uie,rr=mr===wF?{side:i,sideOffset:_,align:b,alignOffset:E,arrowPadding:C,collisionBoundary:R,collisionPadding:F,sticky:U,hideWhenDetached:$,avoidCollisions:H}:{};return j.jsx(lie,{scope:r,content:J,viewport:oe,onViewportChange:he,itemRefCallback:$t,selectedItem:ve,onItemLeave:ut,itemTextRefCallback:tr,focusSelectedItem:at,selectedItemText:Ie,position:n,isPositioned:ot,searchRef:jt,children:j.jsx(nR,{as:Bh,allowPinchZoom:!0,children:j.jsx(tR,{asChild:!0,trapped:G.open,onMountAutoFocus:Ut=>{Ut.preventDefault()},onUnmountAutoFocus:Kr(a,Ut=>{var gr;(gr=G.trigger)==null||gr.focus({preventScroll:!0}),Ut.preventDefault()}),children:j.jsx(Ix,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:f,onFocusOutside:Ut=>Ut.preventDefault(),onDismiss:()=>G.onOpenChange(!1),children:j.jsx(mr,{role:"listbox",id:G.contentId,"data-state":G.open?"open":"closed",dir:G.dir,onContextMenu:Ut=>Ut.preventDefault(),...q,...rr,onPlaced:()=>Je(!0),ref:le,style:{display:"flex",flexDirection:"column",outline:"none",...q.style},onKeyDown:Kr(q.onKeyDown,Ut=>{const gr=Ut.ctrlKey||Ut.altKey||Ut.metaKey;if(Ut.key==="Tab"&&Ut.preventDefault(),!gr&&Ut.key.length===1&&Lt(Ut.key),["ArrowUp","ArrowDown","Home","End"].includes(Ut.key)){let ge=$e().filter(cr=>!cr.disabled).map(cr=>cr.ref.current);if(["ArrowUp","End"].includes(Ut.key)&&(ge=ge.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ut.key)){const cr=Ut.target,Ot=ge.indexOf(cr);ge=ge.slice(Ot+1)}setTimeout(()=>st(ge)),Ut.preventDefault()}})})})})})})});cie.displayName=r8e;var n8e="SelectItemAlignedPosition",uie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,l=Sm(Ty,r),f=Tm(Ty,r),[i,_]=ne.useState(null),[b,E]=ne.useState(null),C=Ci(t,le=>E(le)),R=oR(r),F=ne.useRef(!1),U=ne.useRef(!0),{viewport:$,selectedItem:H,selectedItemText:q,focusSelectedItem:G}=f,J=ne.useCallback(()=>{if(l.trigger&&l.valueNode&&i&&b&&$&&H&&q){const le=l.trigger.getBoundingClientRect(),ve=b.getBoundingClientRect(),We=l.valueNode.getBoundingClientRect(),Ie=q.getBoundingClientRect();if(l.dir!=="rtl"){const cr=Ie.left-ve.left,Ot=We.left-cr,Pr=le.left-Ot,_t=le.width+Pr,hn=Math.max(_t,ve.width),qr=window.innerWidth-su,Ln=uZ(Ot,[su,Math.max(su,qr-hn)]);i.style.minWidth=_t+"px",i.style.left=Ln+"px"}else{const cr=ve.right-Ie.right,Ot=window.innerWidth-We.right-cr,Pr=window.innerWidth-le.right-Ot,_t=le.width+Pr,hn=Math.max(_t,ve.width),qr=window.innerWidth-su,Ln=uZ(Ot,[su,Math.max(su,qr-hn)]);i.style.minWidth=_t+"px",i.style.right=Ln+"px"}const Re=R(),$e=window.innerHeight-su*2,ot=$.scrollHeight,Je=window.getComputedStyle(b),rt=parseInt(Je.borderTopWidth,10),st=parseInt(Je.paddingTop,10),at=parseInt(Je.borderBottomWidth,10),Be=parseInt(Je.paddingBottom,10),ct=rt+st+ot+Be+at,jt=Math.min(H.offsetHeight*5,ct),Lt=window.getComputedStyle($),$t=parseInt(Lt.paddingTop,10),ut=parseInt(Lt.paddingBottom,10),tr=le.top+le.height/2-su,mr=$e-tr,rr=H.offsetHeight/2,Ut=H.offsetTop+rr,gr=rt+st+Ut,Gt=ct-gr;if(gr<=tr){const cr=Re.length>0&&H===Re[Re.length-1].ref.current;i.style.bottom="0px";const Ot=b.clientHeight-$.offsetTop-$.offsetHeight,Pr=Math.max(mr,rr+(cr?ut:0)+Ot+at),_t=gr+Pr;i.style.height=_t+"px"}else{const cr=Re.length>0&&H===Re[0].ref.current;i.style.top="0px";const Pr=Math.max(tr,rt+$.offsetTop+(cr?$t:0)+rr)+Gt;i.style.height=Pr+"px",$.scrollTop=gr-tr+$.offsetTop}i.style.margin=`${su}px 0`,i.style.minHeight=jt+"px",i.style.maxHeight=$e+"px",n==null||n(),requestAnimationFrame(()=>F.current=!0)}},[R,l.trigger,l.valueNode,i,b,$,H,q,l.dir,n]);as(()=>J(),[J]);const[te,oe]=ne.useState();as(()=>{b&&oe(window.getComputedStyle(b).zIndex)},[b]);const he=ne.useCallback(le=>{le&&U.current===!0&&(J(),G==null||G(),U.current=!1)},[J,G]);return j.jsx(o8e,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:F,onScrollButtonChange:he,children:j.jsx("div",{ref:_,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:te},children:j.jsx(In.div,{...a,ref:C,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});uie.displayName=n8e;var i8e="SelectPopperPosition",wF=ne.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=su,...l}=e,f=aR(r);return j.jsx(BB,{...f,...l,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});wF.displayName=i8e;var[o8e,h$]=Qx(Ty,{}),SF="SelectViewport",die=ne.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,l=Tm(SF,r),f=h$(SF,r),i=Ci(t,l.onViewportChange),_=ne.useRef(0);return j.jsxs(j.Fragment,{children:[j.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),j.jsx(iR.Slot,{scope:r,children:j.jsx(In.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Kr(a.onScroll,b=>{const E=b.currentTarget,{contentWrapper:C,shouldExpandOnScrollRef:R}=f;if(R!=null&&R.current&&C){const F=Math.abs(_.current-E.scrollTop);if(F>0){const U=window.innerHeight-su*2,$=parseFloat(C.style.minHeight),H=parseFloat(C.style.height),q=Math.max($,H);if(q<U){const G=q+F,J=Math.min(U,G),te=G-J;C.style.height=J+"px",C.style.bottom==="0px"&&(E.scrollTop=te>0?te:0,C.style.justifyContent="flex-end")}}}_.current=E.scrollTop})})})]})});die.displayName=SF;var hie="SelectGroup",[a8e,s8e]=Qx(hie),l8e=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Ph();return j.jsx(a8e,{scope:r,id:a,children:j.jsx(In.div,{role:"group","aria-labelledby":a,...n,ref:t})})});l8e.displayName=hie;var fie="SelectLabel",pie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=s8e(fie,r);return j.jsx(In.div,{id:a.id,...n,ref:t})});pie.displayName=fie;var iO="SelectItem",[c8e,mie]=Qx(iO),gie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:l,...f}=e,i=Sm(iO,r),_=Tm(iO,r),b=i.value===n,[E,C]=ne.useState(l??""),[R,F]=ne.useState(!1),U=Ci(t,G=>{var J;return(J=_.itemRefCallback)==null?void 0:J.call(_,G,n,a)}),$=Ph(),H=ne.useRef("touch"),q=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return j.jsx(c8e,{scope:r,value:n,disabled:a,textId:$,isSelected:b,onItemTextChange:ne.useCallback(G=>{C(J=>J||((G==null?void 0:G.textContent)??"").trim())},[]),children:j.jsx(iR.ItemSlot,{scope:r,value:n,disabled:a,textValue:E,children:j.jsx(In.div,{role:"option","aria-labelledby":$,"data-highlighted":R?"":void 0,"aria-selected":b&&R,"data-state":b?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...f,ref:U,onFocus:Kr(f.onFocus,()=>F(!0)),onBlur:Kr(f.onBlur,()=>F(!1)),onClick:Kr(f.onClick,()=>{H.current!=="mouse"&&q()}),onPointerUp:Kr(f.onPointerUp,()=>{H.current==="mouse"&&q()}),onPointerDown:Kr(f.onPointerDown,G=>{H.current=G.pointerType}),onPointerMove:Kr(f.onPointerMove,G=>{var J;H.current=G.pointerType,a?(J=_.onItemLeave)==null||J.call(_):H.current==="mouse"&&G.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Kr(f.onPointerLeave,G=>{var J;G.currentTarget===document.activeElement&&((J=_.onItemLeave)==null||J.call(_))}),onKeyDown:Kr(f.onKeyDown,G=>{var te;((te=_.searchRef)==null?void 0:te.current)!==""&&G.key===" "||(XVe.includes(G.key)&&q(),G.key===" "&&G.preventDefault())})})})})});gie.displayName=iO;var Rw="SelectItemText",yie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...l}=e,f=Sm(Rw,r),i=Tm(Rw,r),_=mie(Rw,r),b=QVe(Rw,r),[E,C]=ne.useState(null),R=Ci(t,q=>C(q),_.onItemTextChange,q=>{var G;return(G=i.itemTextRefCallback)==null?void 0:G.call(i,q,_.value,_.disabled)}),F=E==null?void 0:E.textContent,U=ne.useMemo(()=>j.jsx("option",{value:_.value,disabled:_.disabled,children:F},_.value),[_.disabled,_.value,F]),{onNativeOptionAdd:$,onNativeOptionRemove:H}=b;return as(()=>($(U),()=>H(U)),[$,H,U]),j.jsxs(j.Fragment,{children:[j.jsx(In.span,{id:_.textId,...l,ref:R}),_.isSelected&&f.valueNode&&!f.valueNodeHasChildren?Dy.createPortal(l.children,f.valueNode):null]})});yie.displayName=Rw;var vie="SelectItemIndicator",_ie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return mie(vie,r).isSelected?j.jsx(In.span,{"aria-hidden":!0,...n,ref:t}):null});_ie.displayName=vie;var TF="SelectScrollUpButton",xie=ne.forwardRef((e,t)=>{const r=Tm(TF,e.__scopeSelect),n=h$(TF,e.__scopeSelect),[a,l]=ne.useState(!1),f=Ci(t,n.onScrollButtonChange);return as(()=>{if(r.viewport&&r.isPositioned){let i=function(){const b=_.scrollTop>0;l(b)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?j.jsx(wie,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop-_.offsetHeight)}}):null});xie.displayName=TF;var EF="SelectScrollDownButton",bie=ne.forwardRef((e,t)=>{const r=Tm(EF,e.__scopeSelect),n=h$(EF,e.__scopeSelect),[a,l]=ne.useState(!1),f=Ci(t,n.onScrollButtonChange);return as(()=>{if(r.viewport&&r.isPositioned){let i=function(){const b=_.scrollHeight-_.clientHeight,E=Math.ceil(_.scrollTop)<b;l(E)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?j.jsx(wie,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop+_.offsetHeight)}}):null});bie.displayName=EF;var wie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,l=Tm("SelectScrollButton",r),f=ne.useRef(null),i=oR(r),_=ne.useCallback(()=>{f.current!==null&&(window.clearInterval(f.current),f.current=null)},[]);return ne.useEffect(()=>()=>_(),[_]),as(()=>{var E;const b=i().find(C=>C.ref.current===document.activeElement);(E=b==null?void 0:b.ref.current)==null||E.scrollIntoView({block:"nearest"})},[i]),j.jsx(In.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Kr(a.onPointerDown,()=>{f.current===null&&(f.current=window.setInterval(n,50))}),onPointerMove:Kr(a.onPointerMove,()=>{var b;(b=l.onItemLeave)==null||b.call(l),f.current===null&&(f.current=window.setInterval(n,50))}),onPointerLeave:Kr(a.onPointerLeave,()=>{_()})})}),u8e="SelectSeparator",Sie=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return j.jsx(In.div,{"aria-hidden":!0,...n,ref:t})});Sie.displayName=u8e;var AF="SelectArrow",d8e=ne.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=aR(r),l=Sm(AF,r),f=Tm(AF,r);return l.open&&f.position==="popper"?j.jsx($B,{...a,...n,ref:t}):null});d8e.displayName=AF;function Tie(e){return e===""||e===void 0}var Eie=ne.forwardRef((e,t)=>{const{value:r,...n}=e,a=ne.useRef(null),l=Ci(t,a),f=Gne(r);return ne.useEffect(()=>{const i=a.current,_=window.HTMLSelectElement.prototype,E=Object.getOwnPropertyDescriptor(_,"value").set;if(f!==r&&E){const C=new Event("change",{bubbles:!0});E.call(i,r),i.dispatchEvent(C)}},[f,r]),j.jsx(hE,{asChild:!0,children:j.jsx("select",{...n,ref:l,defaultValue:r})})});Eie.displayName="BubbleSelect";function Aie(e){const t=pl(e),r=ne.useRef(""),n=ne.useRef(0),a=ne.useCallback(f=>{const i=r.current+f;t(i),function _(b){r.current=b,window.clearTimeout(n.current),b!==""&&(n.current=window.setTimeout(()=>_(""),1e3))}(i)},[t]),l=ne.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return ne.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,l]}function Mie(e,t,r){const a=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let f=h8e(e,Math.max(l,0));a.length===1&&(f=f.filter(b=>b!==r));const _=f.find(b=>b.textValue.toLowerCase().startsWith(a.toLowerCase()));return _!==r?_:void 0}function h8e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var f8e=eie,Cie=rie,p8e=iie,m8e=oie,g8e=aie,Pie=sie,y8e=die,Iie=pie,Oie=gie,v8e=yie,_8e=_ie,kie=xie,Rie=bie,Die=Sie;const Lie=f8e,Nie=p8e,f$=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(Cie,{ref:n,className:Nr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,j.jsx(m8e,{asChild:!0,children:j.jsx(MB,{className:"h-4 w-4 opacity-50"})})]}));f$.displayName=Cie.displayName;const zie=ne.forwardRef(({className:e,...t},r)=>j.jsx(kie,{ref:r,className:Nr("flex cursor-default items-center justify-center py-1",e),...t,children:j.jsx(bme,{className:"h-4 w-4"})}));zie.displayName=kie.displayName;const jie=ne.forwardRef(({className:e,...t},r)=>j.jsx(Rie,{ref:r,className:Nr("flex cursor-default items-center justify-center py-1",e),...t,children:j.jsx(MB,{className:"h-4 w-4"})}));jie.displayName=Rie.displayName;const p$=ne.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>j.jsx(g8e,{children:j.jsxs(Pie,{ref:a,className:Nr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[j.jsx(zie,{}),j.jsx(y8e,{className:Nr("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),j.jsx(jie,{})]})}));p$.displayName=Pie.displayName;const x8e=ne.forwardRef(({className:e,...t},r)=>j.jsx(Iie,{ref:r,className:Nr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));x8e.displayName=Iie.displayName;const _d=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(Oie,{ref:n,className:Nr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[j.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:j.jsx(_8e,{children:j.jsx(xme,{className:"h-4 w-4"})})}),j.jsx(v8e,{children:t})]}));_d.displayName=Oie.displayName;const b8e=ne.forwardRef(({className:e,...t},r)=>j.jsx(Die,{ref:r,className:Nr("-mx-1 my-1 h-px bg-muted",e),...t}));b8e.displayName=Die.displayName;const w8e=fE("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function MF({className:e,variant:t,...r}){return j.jsx("div",{className:Nr(w8e({variant:t}),e),...r})}function S8e(e,t=[]){let r=[];function n(l,f){const i=ne.createContext(f),_=r.length;r=[...r,f];function b(C){const{scope:R,children:F,...U}=C,$=(R==null?void 0:R[e][_])||i,H=ne.useMemo(()=>U,Object.values(U));return j.jsx($.Provider,{value:H,children:F})}function E(C,R){const F=(R==null?void 0:R[e][_])||i,U=ne.useContext(F);if(U)return U;if(f!==void 0)return f;throw new Error(`\`${C}\` must be used within \`${l}\``)}return b.displayName=l+"Provider",[b,E]}const a=()=>{const l=r.map(f=>ne.createContext(f));return function(i){const _=(i==null?void 0:i[e])||l;return ne.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,T8e(a,...t)]}function T8e(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const f=n.reduce((i,{useScope:_,scopeName:b})=>{const C=_(l)[`__scope${b}`];return{...i,...C}},{});return ne.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}var eN="rovingFocusGroup.onEntryFocus",E8e={bubbles:!1,cancelable:!0},sR="RovingFocusGroup",[CF,Fie,A8e]=SB(sR),[M8e,lR]=S8e(sR,[A8e]),[C8e,P8e]=M8e(sR),Bie=ne.forwardRef((e,t)=>j.jsx(CF.Provider,{scope:e.__scopeRovingFocusGroup,children:j.jsx(CF.Slot,{scope:e.__scopeRovingFocusGroup,children:j.jsx(I8e,{...e,ref:t})})}));Bie.displayName=sR;var I8e=ne.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:l,currentTabStopId:f,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:_,onEntryFocus:b,preventScrollOnEntryFocus:E=!1,...C}=e,R=ne.useRef(null),F=Ci(t,R),U=eR(l),[$=null,H]=tm({prop:f,defaultProp:i,onChange:_}),[q,G]=ne.useState(!1),J=pl(b),te=Fie(r),oe=ne.useRef(!1),[he,le]=ne.useState(0);return ne.useEffect(()=>{const ve=R.current;if(ve)return ve.addEventListener(eN,J),()=>ve.removeEventListener(eN,J)},[J]),j.jsx(C8e,{scope:r,orientation:n,dir:U,loop:a,currentTabStopId:$,onItemFocus:ne.useCallback(ve=>H(ve),[H]),onItemShiftTab:ne.useCallback(()=>G(!0),[]),onFocusableItemAdd:ne.useCallback(()=>le(ve=>ve+1),[]),onFocusableItemRemove:ne.useCallback(()=>le(ve=>ve-1),[]),children:j.jsx(In.div,{tabIndex:q||he===0?-1:0,"data-orientation":n,...C,ref:F,style:{outline:"none",...e.style},onMouseDown:Kr(e.onMouseDown,()=>{oe.current=!0}),onFocus:Kr(e.onFocus,ve=>{const We=!oe.current;if(ve.target===ve.currentTarget&&We&&!q){const Ie=new CustomEvent(eN,E8e);if(ve.currentTarget.dispatchEvent(Ie),!Ie.defaultPrevented){const Re=te().filter(st=>st.focusable),$e=Re.find(st=>st.active),ot=Re.find(st=>st.id===$),rt=[$e,ot,...Re].filter(Boolean).map(st=>st.ref.current);Vie(rt,E)}}oe.current=!1}),onBlur:Kr(e.onBlur,()=>G(!1))})})}),$ie="RovingFocusGroupItem",Uie=ne.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:l,...f}=e,i=Ph(),_=l||i,b=P8e($ie,r),E=b.currentTabStopId===_,C=Fie(r),{onFocusableItemAdd:R,onFocusableItemRemove:F}=b;return ne.useEffect(()=>{if(n)return R(),()=>F()},[n,R,F]),j.jsx(CF.ItemSlot,{scope:r,id:_,focusable:n,active:a,children:j.jsx(In.span,{tabIndex:E?0:-1,"data-orientation":b.orientation,...f,ref:t,onMouseDown:Kr(e.onMouseDown,U=>{n?b.onItemFocus(_):U.preventDefault()}),onFocus:Kr(e.onFocus,()=>b.onItemFocus(_)),onKeyDown:Kr(e.onKeyDown,U=>{if(U.key==="Tab"&&U.shiftKey){b.onItemShiftTab();return}if(U.target!==U.currentTarget)return;const $=R8e(U,b.orientation,b.dir);if($!==void 0){if(U.metaKey||U.ctrlKey||U.altKey||U.shiftKey)return;U.preventDefault();let q=C().filter(G=>G.focusable).map(G=>G.ref.current);if($==="last")q.reverse();else if($==="prev"||$==="next"){$==="prev"&&q.reverse();const G=q.indexOf(U.currentTarget);q=b.loop?D8e(q,G+1):q.slice(G+1)}setTimeout(()=>Vie(q))}})})})});Uie.displayName=$ie;var O8e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function k8e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function R8e(e,t,r){const n=k8e(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return O8e[n]}function Vie(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function D8e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Wie=Bie,Gie=Uie,m$="Tabs",[L8e,RKe]=gm(m$,[lR]),qie=lR(),[N8e,g$]=L8e(m$),Hie=ne.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:l,orientation:f="horizontal",dir:i,activationMode:_="automatic",...b}=e,E=eR(i),[C,R]=tm({prop:n,onChange:a,defaultProp:l});return j.jsx(N8e,{scope:r,baseId:Ph(),value:C,onValueChange:R,orientation:f,dir:E,activationMode:_,children:j.jsx(In.div,{dir:E,"data-orientation":f,...b,ref:t})})});Hie.displayName=m$;var Zie="TabsList",Xie=ne.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,l=g$(Zie,r),f=qie(r);return j.jsx(Wie,{asChild:!0,...f,orientation:l.orientation,dir:l.dir,loop:n,children:j.jsx(In.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:t})})});Xie.displayName=Zie;var Yie="TabsTrigger",Kie=ne.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...l}=e,f=g$(Yie,r),i=qie(r),_=eoe(f.baseId,n),b=toe(f.baseId,n),E=n===f.value;return j.jsx(Gie,{asChild:!0,...i,focusable:!a,active:E,children:j.jsx(In.button,{type:"button",role:"tab","aria-selected":E,"aria-controls":b,"data-state":E?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:_,...l,ref:t,onMouseDown:Kr(e.onMouseDown,C=>{!a&&C.button===0&&C.ctrlKey===!1?f.onValueChange(n):C.preventDefault()}),onKeyDown:Kr(e.onKeyDown,C=>{[" ","Enter"].includes(C.key)&&f.onValueChange(n)}),onFocus:Kr(e.onFocus,()=>{const C=f.activationMode!=="manual";!E&&!a&&C&&f.onValueChange(n)})})})});Kie.displayName=Yie;var Jie="TabsContent",Qie=ne.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:l,...f}=e,i=g$(Jie,r),_=eoe(i.baseId,n),b=toe(i.baseId,n),E=n===i.value,C=ne.useRef(E);return ne.useEffect(()=>{const R=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(R)},[]),j.jsx(Fd,{present:a||E,children:({present:R})=>j.jsx(In.div,{"data-state":E?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":_,hidden:!R,id:b,tabIndex:0,...f,ref:t,style:{...e.style,animationDuration:C.current?"0s":void 0},children:R&&l})})});Qie.displayName=Jie;function eoe(e,t){return`${e}-trigger-${t}`}function toe(e,t){return`${e}-content-${t}`}var z8e=Hie,roe=Xie,noe=Kie,ioe=Qie;const y$=z8e,cR=ne.forwardRef(({className:e,...t},r)=>j.jsx(roe,{ref:r,className:Nr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));cR.displayName=roe.displayName;const xu=ne.forwardRef(({className:e,...t},r)=>j.jsx(noe,{ref:r,className:Nr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));xu.displayName=noe.displayName;const ly=ne.forwardRef(({className:e,...t},r)=>j.jsx(ioe,{ref:r,className:Nr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ly.displayName=ioe.displayName;var v$="Dialog",[ooe,DKe]=gm(v$),[j8e,ju]=ooe(v$),aoe=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:f=!0}=e,i=ne.useRef(null),_=ne.useRef(null),[b=!1,E]=tm({prop:n,defaultProp:a,onChange:l});return j.jsx(j8e,{scope:t,triggerRef:i,contentRef:_,contentId:Ph(),titleId:Ph(),descriptionId:Ph(),open:b,onOpenChange:E,onOpenToggle:ne.useCallback(()=>E(C=>!C),[E]),modal:f,children:r})};aoe.displayName=v$;var soe="DialogTrigger",loe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=ju(soe,r),l=Ci(t,a.triggerRef);return j.jsx(In.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":b$(a.open),...n,ref:l,onClick:Kr(e.onClick,a.onOpenToggle)})});loe.displayName=soe;var _$="DialogPortal",[F8e,coe]=ooe(_$,{forceMount:void 0}),uoe=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,l=ju(_$,t);return j.jsx(F8e,{scope:t,forceMount:r,children:ne.Children.map(n,f=>j.jsx(Fd,{present:r||l.open,children:j.jsx(dE,{asChild:!0,container:a,children:f})}))})};uoe.displayName=_$;var oO="DialogOverlay",doe=ne.forwardRef((e,t)=>{const r=coe(oO,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=ju(oO,e.__scopeDialog);return l.modal?j.jsx(Fd,{present:n||l.open,children:j.jsx(B8e,{...a,ref:t})}):null});doe.displayName=oO;var B8e=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=ju(oO,r);return j.jsx(nR,{as:Bh,allowPinchZoom:!0,shards:[a.contentRef],children:j.jsx(In.div,{"data-state":b$(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Ey="DialogContent",hoe=ne.forwardRef((e,t)=>{const r=coe(Ey,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=ju(Ey,e.__scopeDialog);return j.jsx(Fd,{present:n||l.open,children:l.modal?j.jsx($8e,{...a,ref:t}):j.jsx(U8e,{...a,ref:t})})});hoe.displayName=Ey;var $8e=ne.forwardRef((e,t)=>{const r=ju(Ey,e.__scopeDialog),n=ne.useRef(null),a=Ci(t,r.contentRef,n);return ne.useEffect(()=>{const l=n.current;if(l)return d$(l)},[]),j.jsx(foe,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kr(e.onCloseAutoFocus,l=>{var f;l.preventDefault(),(f=r.triggerRef.current)==null||f.focus()}),onPointerDownOutside:Kr(e.onPointerDownOutside,l=>{const f=l.detail.originalEvent,i=f.button===0&&f.ctrlKey===!0;(f.button===2||i)&&l.preventDefault()}),onFocusOutside:Kr(e.onFocusOutside,l=>l.preventDefault())})}),U8e=ne.forwardRef((e,t)=>{const r=ju(Ey,e.__scopeDialog),n=ne.useRef(!1),a=ne.useRef(!1);return j.jsx(foe,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=l.target;((b=r.triggerRef.current)==null?void 0:b.contains(f))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),foe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...f}=e,i=ju(Ey,r),_=ne.useRef(null),b=Ci(t,_);return u$(),j.jsxs(j.Fragment,{children:[j.jsx(tR,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:j.jsx(Ix,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":b$(i.open),...f,ref:b,onDismiss:()=>i.onOpenChange(!1)})}),j.jsxs(j.Fragment,{children:[j.jsx(V8e,{titleId:i.titleId}),j.jsx(G8e,{contentRef:_,descriptionId:i.descriptionId})]})]})}),x$="DialogTitle",poe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=ju(x$,r);return j.jsx(In.h2,{id:a.titleId,...n,ref:t})});poe.displayName=x$;var moe="DialogDescription",goe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=ju(moe,r);return j.jsx(In.p,{id:a.descriptionId,...n,ref:t})});goe.displayName=moe;var yoe="DialogClose",voe=ne.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=ju(yoe,r);return j.jsx(In.button,{type:"button",...n,ref:t,onClick:Kr(e.onClick,()=>a.onOpenChange(!1))})});voe.displayName=yoe;function b$(e){return e?"open":"closed"}var _oe="DialogTitleWarning",[LKe,xoe]=Cpe(_oe,{contentName:Ey,titleName:x$,docsSlug:"dialog"}),V8e=({titleId:e})=>{const t=xoe(_oe),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return ne.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},W8e="DialogDescriptionWarning",G8e=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${xoe(W8e).contentName}}.`;return ne.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},q8e=aoe,H8e=loe,Z8e=uoe,boe=doe,woe=hoe,Soe=poe,Toe=goe,X8e=voe;const Eoe=q8e,Y8e=H8e,K8e=Z8e,Aoe=ne.forwardRef(({className:e,...t},r)=>j.jsx(boe,{ref:r,className:Nr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Aoe.displayName=boe.displayName;const w$=ne.forwardRef(({className:e,children:t,...r},n)=>j.jsxs(K8e,{children:[j.jsx(Aoe,{}),j.jsxs(woe,{ref:n,className:Nr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,j.jsxs(X8e,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[j.jsx(NJ,{className:"h-4 w-4"}),j.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));w$.displayName=woe.displayName;const S$=({className:e,...t})=>j.jsx("div",{className:Nr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});S$.displayName="DialogHeader";const T$=ne.forwardRef(({className:e,...t},r)=>j.jsx(Soe,{ref:r,className:Nr("text-lg font-semibold leading-none tracking-tight",e),...t}));T$.displayName=Soe.displayName;const Moe=ne.forwardRef(({className:e,...t},r)=>j.jsx(Toe,{ref:r,className:Nr("text-sm text-muted-foreground",e),...t}));Moe.displayName=Toe.displayName;const J8e=fE("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Coe=ne.forwardRef(({className:e,variant:t,...r},n)=>j.jsx("div",{ref:n,role:"alert",className:Nr(J8e({variant:t}),e),...r}));Coe.displayName="Alert";const Q8e=ne.forwardRef(({className:e,...t},r)=>j.jsx("h5",{ref:r,className:Nr("mb-1 font-medium leading-none tracking-tight",e),...t}));Q8e.displayName="AlertTitle";const Poe=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Nr("text-sm [&_p]:leading-relaxed",e),...t}));Poe.displayName="AlertDescription";const eWe=()=>{const[e,t]=ne.useState(!1),r=()=>{const l=[["street","number","int_number","neighborhood","postal_code","administrative_area","sub_administrative_area","reference","notes"].join(","),"Av Insurgentes,123,2B,Condesa,06140,CDMX,Ciudad de México,Edificio gris,Entregar en recepción","Calle Durango,45,,Roma Norte,06700,CDMX,Ciudad de México,Casa azul,Tocar timbre"].join(`
`),f=new Blob([l],{type:"text/csv"}),i=window.URL.createObjectURL(f),_=document.createElement("a");_.href=i,_.download="ordenes_template.csv",_.click(),window.URL.revokeObjectURL(i)},n=async a=>{var i;const l=(i=a.target.files)==null?void 0:i[0];if(!l)return;t(!0);const f=new FileReader;f.onload=async _=>{var b;try{const C=((b=_.target)==null?void 0:b.result).split(`
`).filter(q=>q.trim()),R=C[0].split(","),F=C.slice(1,501).map(q=>{const G=q.split(","),J={is_manual:!0,country:"MX"};return R.forEach((te,oe)=>{var he;J[te.trim()]=((he=G[oe])==null?void 0:he.trim())||null}),J});if(F.length>500){Lp.error("El archivo excede el límite de 500 órdenes");return}const{data:U}=await mo.auth.getUser();if(!U.user){Lp.error("Usuario no autenticado");return}let $=0,H=0;for(const q of F){const G={...q,user_id:U.user.id,street:q.street||"",number:q.number||"",neighborhood:q.neighborhood||"",postal_code:q.postal_code||"",administrative_area:q.administrative_area||"",sub_administrative_area:q.sub_administrative_area||""};if(!G.street||!G.number||!G.neighborhood||!G.postal_code||!G.administrative_area||!G.sub_administrative_area){console.error("Missing required fields for order:",G),H++;continue}const{error:J}=await mo.from("orders").insert(G);J?(console.error("Error importing order:",J),H++):$++}Lp.success(`Importación completada: ${$} órdenes creadas, ${H} errores`)}catch(E){console.error("Error processing file:",E),Lp.error("Error al procesar el archivo")}finally{t(!1)}},f.readAsText(l)};return j.jsxs(Eoe,{children:[j.jsx(Y8e,{asChild:!0,children:j.jsxs(Zn,{variant:"outline",size:"sm",children:[j.jsx(CG,{className:"h-4 w-4 mr-2"}),"Importar CSV"]})}),j.jsxs(w$,{children:[j.jsxs(S$,{children:[j.jsx(T$,{children:"Importar órdenes desde CSV"}),j.jsx(Moe,{children:"Sube un archivo CSV con las órdenes que deseas importar. Límite: 500 órdenes por archivo."})]}),j.jsxs(Coe,{children:[j.jsx(kJ,{className:"h-4 w-4"}),j.jsx(Poe,{children:"Descarga la plantilla CSV para asegurar el formato correcto."})]}),j.jsxs("div",{className:"flex flex-col gap-4",children:[j.jsxs(Zn,{variant:"outline",onClick:r,children:[j.jsx(IB,{className:"h-4 w-4 mr-2"}),"Descargar plantilla"]}),j.jsx("input",{type:"file",accept:".csv",onChange:n,className:"hidden",id:"csv-upload"}),j.jsxs(Zn,{onClick:()=>{var a;return(a=document.getElementById("csv-upload"))==null?void 0:a.click()},disabled:e,children:[j.jsx(CG,{className:"h-4 w-4 mr-2"}),e?"Importando...":"Subir CSV"]})]})]})]})},tWe=()=>{const[e,t]=ne.useState(""),{data:r,isLoading:n}=nk({queryKey:["orders"],queryFn:async()=>{const{data:l,error:f}=await mo.from("orders").select("*").order("created_at",{ascending:!1});if(f)throw f;return l}}),a=r==null?void 0:r.filter(l=>l.street.toLowerCase().includes(e.toLowerCase())||l.postal_code.includes(e)||l.neighborhood.toLowerCase().includes(e.toLowerCase()));return j.jsxs("div",{className:"animate-fade-in",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsx("h1",{className:"text-2xl font-bold",children:"Órdenes"}),j.jsxs("div",{className:"flex space-x-2",children:[j.jsx(eWe,{}),j.jsxs(Zn,{variant:"outline",size:"sm",children:[j.jsx(IB,{className:"h-4 w-4 mr-2"}),"Exportar"]}),j.jsxs(Zn,{size:"sm",children:[j.jsx(ZP,{className:"h-4 w-4 mr-2"}),"Nueva orden"]})]})]}),j.jsxs(y$,{defaultValue:"todas",className:"mb-6",children:[j.jsxs(cR,{children:[j.jsx(xu,{value:"todas",children:"Todas"}),j.jsx(xu,{value:"manuales",children:"Manuales"}),j.jsx(xu,{value:"automaticas",children:"Automáticas"})]}),j.jsx(ly,{value:"todas",children:j.jsx(tN,{orders:a,isLoading:n,searchTerm:e,setSearchTerm:t})}),j.jsx(ly,{value:"manuales",children:j.jsx(tN,{orders:a==null?void 0:a.filter(l=>l.is_manual),isLoading:n,searchTerm:e,setSearchTerm:t})}),j.jsx(ly,{value:"automaticas",children:j.jsx(tN,{orders:a==null?void 0:a.filter(l=>!l.is_manual),isLoading:n,searchTerm:e,setSearchTerm:t})})]})]})},tN=({orders:e=[],isLoading:t,searchTerm:r,setSearchTerm:n})=>j.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[j.jsx("div",{className:"p-4 border-b",children:j.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[j.jsxs("div",{className:"relative w-full sm:w-64",children:[j.jsx(YO,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),j.jsx(Si,{placeholder:"Buscar órdenes...",className:"pl-8",value:r,onChange:a=>n(a.target.value)})]}),j.jsxs("div",{className:"flex flex-wrap gap-2",children:[j.jsxs(Zn,{variant:"outline",size:"sm",children:[j.jsx(DJ,{className:"h-4 w-4 mr-2"}),"Filtros"]}),j.jsxs(Lie,{defaultValue:"7d",children:[j.jsx(f$,{className:"w-36 h-9",children:j.jsx(Nie,{placeholder:"Periodo"})}),j.jsxs(p$,{children:[j.jsx(_d,{value:"24h",children:"Últimas 24h"}),j.jsx(_d,{value:"7d",children:"Últimos 7 días"}),j.jsx(_d,{value:"30d",children:"Últimos 30 días"}),j.jsx(_d,{value:"custom",children:"Personalizado"})]})]}),j.jsxs(Zn,{variant:"outline",size:"sm",children:[j.jsx(IB,{className:"h-4 w-4 mr-2"}),"Exportar"]})]})]})}),j.jsx("div",{className:"overflow-x-auto",children:j.jsxs(s$,{children:[j.jsx(l$,{children:j.jsxs(qg,{children:[j.jsx(zl,{children:"ID"}),j.jsx(zl,{children:"Dirección"}),j.jsx(zl,{children:"Tipo"}),j.jsx(zl,{children:"Fecha"}),j.jsx(zl,{children:"Estado"}),j.jsx(zl,{className:"text-right",children:"Acciones"})]})}),j.jsx(c$,{children:t?j.jsx(qg,{children:j.jsx(Es,{colSpan:6,className:"text-center py-8",children:"Cargando órdenes..."})}):e.length===0?j.jsx(qg,{children:j.jsx(Es,{colSpan:6,className:"text-center py-8",children:"No hay órdenes para mostrar"})}):e.map(a=>j.jsxs(qg,{children:[j.jsx(Es,{className:"font-medium",children:a.id.slice(0,8)}),j.jsxs(Es,{children:[a.street," ",a.number,a.int_number&&`, Int. ${a.int_number}`,j.jsx("br",{}),j.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.neighborhood,", ",a.postal_code]})]}),j.jsx(Es,{children:j.jsx(MF,{variant:a.is_manual?"default":"secondary",children:a.is_manual?"Manual":"Automática"})}),j.jsx(Es,{children:new Date(a.created_at).toLocaleDateString("es-MX")}),j.jsx(Es,{children:j.jsx(MF,{children:"Pendiente"})}),j.jsxs(Es,{className:"text-right",children:[j.jsx(Zn,{variant:"ghost",size:"sm",children:"Ver"}),j.jsx(Zn,{variant:"ghost",size:"sm",children:"Editar"})]})]},a.id))})]})}),j.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[j.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",e.length," órdenes"]}),j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx(Zn,{variant:"outline",size:"sm",children:j.jsx(CB,{className:"h-4 w-4"})}),j.jsx(Zn,{variant:"outline",size:"sm",children:j.jsx(PB,{className:"h-4 w-4"})})]})]})]}),Rd=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Nr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Rd.displayName="Card";const eb=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Nr("flex flex-col space-y-1.5 p-6",e),...t}));eb.displayName="CardHeader";const tb=ne.forwardRef(({className:e,...t},r)=>j.jsx("h3",{ref:r,className:Nr("text-2xl font-semibold leading-none tracking-tight",e),...t}));tb.displayName="CardTitle";const ME=ne.forwardRef(({className:e,...t},r)=>j.jsx("p",{ref:r,className:Nr("text-sm text-muted-foreground",e),...t}));ME.displayName="CardDescription";const sm=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Nr("p-6 pt-0",e),...t}));sm.displayName="CardContent";const Ioe=ne.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Nr("flex items-center p-6 pt-0",e),...t}));Ioe.displayName="CardFooter";const rWe=[{id:"RT-001",name:"Zona Norte - Mañana",status:"active",stops:8,driver:"Juan Pérez",vehicle:"VH-003 (Ford Transit)",startTime:"08:00",estimatedEnd:"12:30",progress:65},{id:"RT-002",name:"Zona Sur - Tarde",status:"pending",stops:12,driver:"María López",vehicle:"VH-008 (Toyota Hiace)",startTime:"13:00",estimatedEnd:"18:00",progress:0},{id:"RT-003",name:"Zona Centro - Urgente",status:"completed",stops:5,driver:"Carlos Rodríguez",vehicle:"VH-002 (Renault Kangoo)",startTime:"09:30",estimatedEnd:"11:45",progress:100},{id:"RT-004",name:"Zona Oeste - Vespertina",status:"active",stops:10,driver:"Laura Martínez",vehicle:"VH-010 (Fiat Ducato)",startTime:"14:15",estimatedEnd:"19:00",progress:30}],nWe=()=>{const e=t=>{const n={active:{label:"En Progreso",variant:"default"},pending:{label:"Pendiente",variant:"secondary"},completed:{label:"Completada",variant:"outline"}}[t]||{label:t,variant:"default"};return j.jsx(MF,{variant:n.variant,children:n.label})};return j.jsxs("div",{className:"animate-fade-in",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsx("h1",{className:"text-2xl font-bold",children:"Rutas"}),j.jsxs(Zn,{size:"sm",children:[j.jsx(ZP,{className:"h-4 w-4 mr-2"}),"Nueva ruta"]})]}),j.jsx(y$,{defaultValue:"todas",className:"mb-6",children:j.jsxs(cR,{children:[j.jsx(xu,{value:"todas",children:"Todas"}),j.jsx(xu,{value:"active",children:"En Progreso"}),j.jsx(xu,{value:"pending",children:"Pendientes"}),j.jsx(xu,{value:"completed",children:"Completadas"})]})}),j.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:rWe.map(t=>j.jsxs(Rd,{className:"overflow-hidden",children:[j.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[j.jsxs("div",{children:[j.jsx("h3",{className:"font-medium",children:t.name}),j.jsx("p",{className:"text-sm text-muted-foreground",children:t.id})]}),e(t.status)]}),j.jsxs(sm,{className:"p-4",children:[j.jsxs("div",{className:"mb-4",children:[j.jsx("div",{className:"h-2 w-full bg-gray-100 rounded-full overflow-hidden",children:j.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${t.progress}%`}})}),j.jsxs("div",{className:"flex justify-between mt-1 text-xs text-muted-foreground",children:[j.jsxs("span",{children:[t.progress,"% Completado"]}),j.jsxs("span",{children:[t.stops," paradas"]})]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[j.jsx(UM,{className:"h-4 w-4 text-muted-foreground"}),j.jsx("span",{className:"text-muted-foreground",children:"Conductor:"}),j.jsx("span",{className:"font-medium",children:t.driver})]}),j.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[j.jsx(LJ,{className:"h-4 w-4 text-muted-foreground"}),j.jsx("span",{className:"text-muted-foreground",children:"Vehículo:"}),j.jsx("span",{className:"font-medium",children:t.vehicle})]}),j.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[j.jsx(gme,{className:"h-4 w-4 text-muted-foreground"}),j.jsx("span",{className:"text-muted-foreground",children:"Horario:"}),j.jsxs("span",{className:"font-medium",children:[t.startTime," - ",t.estimatedEnd]})]})]}),j.jsxs("div",{className:"mt-4 pt-4 border-t flex justify-end gap-2",children:[j.jsx(Zn,{variant:"outline",size:"sm",children:"Ver detalle"}),j.jsx(Zn,{size:"sm",children:"Asignar conductor"})]})]})]},t.id))})]})};var Ooe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Aa,function(){var r,n,a;function l(i,_){if(!r)r=_;else if(!n)n=_;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",E={};r(E),a=_(E),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}l(["exports"],function(i){function _(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var b,E={},C={};function R(){if(b)return C;b=1,Object.defineProperty(C,"__esModule",{value:!0}),C.setMatrixArrayType=function(m){C.ARRAY_TYPE=o=m},C.toRadian=function(m){return m*h},C.equals=function(m,p){return Math.abs(m-p)<=d*Math.max(1,Math.abs(m),Math.abs(p))},C.RANDOM=C.ARRAY_TYPE=C.EPSILON=void 0;var d=1e-6;C.EPSILON=d;var o=typeof Float32Array<"u"?Float32Array:Array;C.ARRAY_TYPE=o;var c=Math.random;C.RANDOM=c;var h=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,p=arguments.length;p--;)m+=arguments[p]*arguments[p];return Math.sqrt(m)}),C}var F,U={};function $(){if(F)return U;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},d(p)}F=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var p=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p},U.clone=function(p){var v=new o.ARRAY_TYPE(4);return v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v},U.copy=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[3],p},U.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p},U.fromValues=function(p,v,T,M){var O=new o.ARRAY_TYPE(4);return O[0]=p,O[1]=v,O[2]=T,O[3]=M,O},U.set=function(p,v,T,M,O){return p[0]=v,p[1]=T,p[2]=M,p[3]=O,p},U.transpose=function(p,v){if(p===v){var T=v[1];p[1]=v[2],p[2]=T}else p[0]=v[0],p[1]=v[2],p[2]=v[1],p[3]=v[3];return p},U.invert=function(p,v){var T=v[0],M=v[1],O=v[2],w=v[3],P=T*w-O*M;return P?(p[0]=w*(P=1/P),p[1]=-M*P,p[2]=-O*P,p[3]=T*P,p):null},U.adjoint=function(p,v){var T=v[0];return p[0]=v[3],p[1]=-v[1],p[2]=-v[2],p[3]=T,p},U.determinant=function(p){return p[0]*p[3]-p[2]*p[1]},U.multiply=h,U.rotate=function(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=Math.sin(T),I=Math.cos(T);return p[0]=M*I+w*D,p[1]=O*I+P*D,p[2]=M*-D+w*I,p[3]=O*-D+P*I,p},U.scale=function(p,v,T){var M=v[1],O=v[2],w=v[3],P=T[0],D=T[1];return p[0]=v[0]*P,p[1]=M*P,p[2]=O*D,p[3]=w*D,p},U.fromRotation=function(p,v){var T=Math.sin(v),M=Math.cos(v);return p[0]=M,p[1]=T,p[2]=-T,p[3]=M,p},U.fromScaling=function(p,v){return p[0]=v[0],p[1]=0,p[2]=0,p[3]=v[1],p},U.str=function(p){return"mat2("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+")"},U.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3])},U.LDU=function(p,v,T,M){return p[2]=M[2]/M[0],T[0]=M[0],T[1]=M[1],T[3]=M[3]-p[2]*T[1],[p,v,T]},U.add=function(p,v,T){return p[0]=v[0]+T[0],p[1]=v[1]+T[1],p[2]=v[2]+T[2],p[3]=v[3]+T[3],p},U.subtract=m,U.exactEquals=function(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]&&p[3]===v[3]},U.equals=function(p,v){var T=p[0],M=p[1],O=p[2],w=p[3],P=v[0],D=v[1],I=v[2],k=v[3];return Math.abs(T-P)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(P))&&Math.abs(M-D)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(O-I)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(I))&&Math.abs(w-k)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(k))},U.multiplyScalar=function(p,v,T){return p[0]=v[0]*T,p[1]=v[1]*T,p[2]=v[2]*T,p[3]=v[3]*T,p},U.multiplyScalarAndAdd=function(p,v,T,M){return p[0]=v[0]+T[0]*M,p[1]=v[1]+T[1]*M,p[2]=v[2]+T[2]*M,p[3]=v[3]+T[3]*M,p},U.sub=U.mul=void 0;var o=function(p,v){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var T=c(void 0);if(T&&T.has(p))return T.get(p);var M={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if(w!=="default"&&Object.prototype.hasOwnProperty.call(p,w)){var P=O?Object.getOwnPropertyDescriptor(p,w):null;P&&(P.get||P.set)?Object.defineProperty(M,w,P):M[w]=p[w]}return M.default=p,T&&T.set(p,M),M}(R());function c(p){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(c=function(M){return M?T:v})(p)}function h(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=T[0],I=T[1],k=T[2],N=T[3];return p[0]=M*D+w*I,p[1]=O*D+P*I,p[2]=M*k+w*N,p[3]=O*k+P*N,p}function m(p,v,T){return p[0]=v[0]-T[0],p[1]=v[1]-T[1],p[2]=v[2]-T[2],p[3]=v[3]-T[3],p}return U.mul=h,U.sub=m,U}var H,q={};function G(){if(H)return q;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},d(p)}H=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var p=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[4]=0,p[5]=0),p[0]=1,p[3]=1,p},q.clone=function(p){var v=new o.ARRAY_TYPE(6);return v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v[4]=p[4],v[5]=p[5],v},q.copy=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[3],p[4]=v[4],p[5]=v[5],p},q.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=0,p[5]=0,p},q.fromValues=function(p,v,T,M,O,w){var P=new o.ARRAY_TYPE(6);return P[0]=p,P[1]=v,P[2]=T,P[3]=M,P[4]=O,P[5]=w,P},q.set=function(p,v,T,M,O,w,P){return p[0]=v,p[1]=T,p[2]=M,p[3]=O,p[4]=w,p[5]=P,p},q.invert=function(p,v){var T=v[0],M=v[1],O=v[2],w=v[3],P=v[4],D=v[5],I=T*w-M*O;return I?(p[0]=w*(I=1/I),p[1]=-M*I,p[2]=-O*I,p[3]=T*I,p[4]=(O*D-w*P)*I,p[5]=(M*P-T*D)*I,p):null},q.determinant=function(p){return p[0]*p[3]-p[1]*p[2]},q.multiply=h,q.rotate=function(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=v[4],I=v[5],k=Math.sin(T),N=Math.cos(T);return p[0]=M*N+w*k,p[1]=O*N+P*k,p[2]=M*-k+w*N,p[3]=O*-k+P*N,p[4]=D,p[5]=I,p},q.scale=function(p,v,T){var M=v[1],O=v[2],w=v[3],P=v[4],D=v[5],I=T[0],k=T[1];return p[0]=v[0]*I,p[1]=M*I,p[2]=O*k,p[3]=w*k,p[4]=P,p[5]=D,p},q.translate=function(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=v[4],I=v[5],k=T[0],N=T[1];return p[0]=M,p[1]=O,p[2]=w,p[3]=P,p[4]=M*k+w*N+D,p[5]=O*k+P*N+I,p},q.fromRotation=function(p,v){var T=Math.sin(v),M=Math.cos(v);return p[0]=M,p[1]=T,p[2]=-T,p[3]=M,p[4]=0,p[5]=0,p},q.fromScaling=function(p,v){return p[0]=v[0],p[1]=0,p[2]=0,p[3]=v[1],p[4]=0,p[5]=0,p},q.fromTranslation=function(p,v){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=v[0],p[5]=v[1],p},q.str=function(p){return"mat2d("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+")"},q.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],1)},q.add=function(p,v,T){return p[0]=v[0]+T[0],p[1]=v[1]+T[1],p[2]=v[2]+T[2],p[3]=v[3]+T[3],p[4]=v[4]+T[4],p[5]=v[5]+T[5],p},q.subtract=m,q.multiplyScalar=function(p,v,T){return p[0]=v[0]*T,p[1]=v[1]*T,p[2]=v[2]*T,p[3]=v[3]*T,p[4]=v[4]*T,p[5]=v[5]*T,p},q.multiplyScalarAndAdd=function(p,v,T,M){return p[0]=v[0]+T[0]*M,p[1]=v[1]+T[1]*M,p[2]=v[2]+T[2]*M,p[3]=v[3]+T[3]*M,p[4]=v[4]+T[4]*M,p[5]=v[5]+T[5]*M,p},q.exactEquals=function(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]&&p[3]===v[3]&&p[4]===v[4]&&p[5]===v[5]},q.equals=function(p,v){var T=p[0],M=p[1],O=p[2],w=p[3],P=p[4],D=p[5],I=v[0],k=v[1],N=v[2],W=v[3],Z=v[4],ee=v[5];return Math.abs(T-I)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(I))&&Math.abs(M-k)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(k))&&Math.abs(O-N)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(N))&&Math.abs(w-W)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(W))&&Math.abs(P-Z)<=o.EPSILON*Math.max(1,Math.abs(P),Math.abs(Z))&&Math.abs(D-ee)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(ee))},q.sub=q.mul=void 0;var o=function(p,v){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var T=c(void 0);if(T&&T.has(p))return T.get(p);var M={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if(w!=="default"&&Object.prototype.hasOwnProperty.call(p,w)){var P=O?Object.getOwnPropertyDescriptor(p,w):null;P&&(P.get||P.set)?Object.defineProperty(M,w,P):M[w]=p[w]}return M.default=p,T&&T.set(p,M),M}(R());function c(p){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(c=function(M){return M?T:v})(p)}function h(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=v[4],I=v[5],k=T[0],N=T[1],W=T[2],Z=T[3],ee=T[4],Q=T[5];return p[0]=M*k+w*N,p[1]=O*k+P*N,p[2]=M*W+w*Z,p[3]=O*W+P*Z,p[4]=M*ee+w*Q+D,p[5]=O*ee+P*Q+I,p}function m(p,v,T){return p[0]=v[0]-T[0],p[1]=v[1]-T[1],p[2]=v[2]-T[2],p[3]=v[3]-T[3],p[4]=v[4]-T[4],p[5]=v[5]-T[5],p}return q.mul=h,q.sub=m,q}var J,te={};function oe(){if(J)return te;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},d(p)}J=1,Object.defineProperty(te,"__esModule",{value:!0}),te.create=function(){var p=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p},te.fromMat4=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[4],p[4]=v[5],p[5]=v[6],p[6]=v[8],p[7]=v[9],p[8]=v[10],p},te.clone=function(p){var v=new o.ARRAY_TYPE(9);return v[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v[4]=p[4],v[5]=p[5],v[6]=p[6],v[7]=p[7],v[8]=p[8],v},te.copy=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=v[2],p[3]=v[3],p[4]=v[4],p[5]=v[5],p[6]=v[6],p[7]=v[7],p[8]=v[8],p},te.fromValues=function(p,v,T,M,O,w,P,D,I){var k=new o.ARRAY_TYPE(9);return k[0]=p,k[1]=v,k[2]=T,k[3]=M,k[4]=O,k[5]=w,k[6]=P,k[7]=D,k[8]=I,k},te.set=function(p,v,T,M,O,w,P,D,I,k){return p[0]=v,p[1]=T,p[2]=M,p[3]=O,p[4]=w,p[5]=P,p[6]=D,p[7]=I,p[8]=k,p},te.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},te.transpose=function(p,v){if(p===v){var T=v[1],M=v[2],O=v[5];p[1]=v[3],p[2]=v[6],p[3]=T,p[5]=v[7],p[6]=M,p[7]=O}else p[0]=v[0],p[1]=v[3],p[2]=v[6],p[3]=v[1],p[4]=v[4],p[5]=v[7],p[6]=v[2],p[7]=v[5],p[8]=v[8];return p},te.invert=function(p,v){var T=v[0],M=v[1],O=v[2],w=v[3],P=v[4],D=v[5],I=v[6],k=v[7],N=v[8],W=N*P-D*k,Z=-N*w+D*I,ee=k*w-P*I,Q=T*W+M*Z+O*ee;return Q?(p[0]=W*(Q=1/Q),p[1]=(-N*M+O*k)*Q,p[2]=(D*M-O*P)*Q,p[3]=Z*Q,p[4]=(N*T-O*I)*Q,p[5]=(-D*T+O*w)*Q,p[6]=ee*Q,p[7]=(-k*T+M*I)*Q,p[8]=(P*T-M*w)*Q,p):null},te.adjoint=function(p,v){var T=v[0],M=v[1],O=v[2],w=v[3],P=v[4],D=v[5],I=v[6],k=v[7],N=v[8];return p[0]=P*N-D*k,p[1]=O*k-M*N,p[2]=M*D-O*P,p[3]=D*I-w*N,p[4]=T*N-O*I,p[5]=O*w-T*D,p[6]=w*k-P*I,p[7]=M*I-T*k,p[8]=T*P-M*w,p},te.determinant=function(p){var v=p[3],T=p[4],M=p[5],O=p[6],w=p[7],P=p[8];return p[0]*(P*T-M*w)+p[1]*(-P*v+M*O)+p[2]*(w*v-T*O)},te.multiply=h,te.translate=function(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=v[4],I=v[5],k=v[6],N=v[7],W=v[8],Z=T[0],ee=T[1];return p[0]=M,p[1]=O,p[2]=w,p[3]=P,p[4]=D,p[5]=I,p[6]=Z*M+ee*P+k,p[7]=Z*O+ee*D+N,p[8]=Z*w+ee*I+W,p},te.rotate=function(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=v[4],I=v[5],k=v[6],N=v[7],W=v[8],Z=Math.sin(T),ee=Math.cos(T);return p[0]=ee*M+Z*P,p[1]=ee*O+Z*D,p[2]=ee*w+Z*I,p[3]=ee*P-Z*M,p[4]=ee*D-Z*O,p[5]=ee*I-Z*w,p[6]=k,p[7]=N,p[8]=W,p},te.scale=function(p,v,T){var M=T[0],O=T[1];return p[0]=M*v[0],p[1]=M*v[1],p[2]=M*v[2],p[3]=O*v[3],p[4]=O*v[4],p[5]=O*v[5],p[6]=v[6],p[7]=v[7],p[8]=v[8],p},te.fromTranslation=function(p,v){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=v[0],p[7]=v[1],p[8]=1,p},te.fromRotation=function(p,v){var T=Math.sin(v),M=Math.cos(v);return p[0]=M,p[1]=T,p[2]=0,p[3]=-T,p[4]=M,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},te.fromScaling=function(p,v){return p[0]=v[0],p[1]=0,p[2]=0,p[3]=0,p[4]=v[1],p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},te.fromMat2d=function(p,v){return p[0]=v[0],p[1]=v[1],p[2]=0,p[3]=v[2],p[4]=v[3],p[5]=0,p[6]=v[4],p[7]=v[5],p[8]=1,p},te.fromQuat=function(p,v){var T=v[0],M=v[1],O=v[2],w=v[3],P=T+T,D=M+M,I=O+O,k=T*P,N=M*P,W=M*D,Z=O*P,ee=O*D,Q=O*I,K=w*P,ie=w*D,se=w*I;return p[0]=1-W-Q,p[3]=N-se,p[6]=Z+ie,p[1]=N+se,p[4]=1-k-Q,p[7]=ee-K,p[2]=Z-ie,p[5]=ee+K,p[8]=1-k-W,p},te.normalFromMat4=function(p,v){var T=v[0],M=v[1],O=v[2],w=v[3],P=v[4],D=v[5],I=v[6],k=v[7],N=v[8],W=v[9],Z=v[10],ee=v[11],Q=v[12],K=v[13],ie=v[14],se=v[15],de=T*D-M*P,we=T*I-O*P,_e=T*k-w*P,xe=M*I-O*D,ke=M*k-w*D,Se=O*k-w*I,De=N*K-W*Q,Ve=N*ie-Z*Q,Fe=N*se-ee*Q,Ze=W*ie-Z*K,He=W*se-ee*K,tt=Z*se-ee*ie,Ke=de*tt-we*He+_e*Ze+xe*Fe-ke*Ve+Se*De;return Ke?(p[0]=(D*tt-I*He+k*Ze)*(Ke=1/Ke),p[1]=(I*Fe-P*tt-k*Ve)*Ke,p[2]=(P*He-D*Fe+k*De)*Ke,p[3]=(O*He-M*tt-w*Ze)*Ke,p[4]=(T*tt-O*Fe+w*Ve)*Ke,p[5]=(M*Fe-T*He-w*De)*Ke,p[6]=(K*Se-ie*ke+se*xe)*Ke,p[7]=(ie*_e-Q*Se-se*we)*Ke,p[8]=(Q*ke-K*_e+se*de)*Ke,p):null},te.projection=function(p,v,T){return p[0]=2/v,p[1]=0,p[2]=0,p[3]=0,p[4]=-2/T,p[5]=0,p[6]=-1,p[7]=1,p[8]=1,p},te.str=function(p){return"mat3("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+")"},te.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},te.add=function(p,v,T){return p[0]=v[0]+T[0],p[1]=v[1]+T[1],p[2]=v[2]+T[2],p[3]=v[3]+T[3],p[4]=v[4]+T[4],p[5]=v[5]+T[5],p[6]=v[6]+T[6],p[7]=v[7]+T[7],p[8]=v[8]+T[8],p},te.subtract=m,te.multiplyScalar=function(p,v,T){return p[0]=v[0]*T,p[1]=v[1]*T,p[2]=v[2]*T,p[3]=v[3]*T,p[4]=v[4]*T,p[5]=v[5]*T,p[6]=v[6]*T,p[7]=v[7]*T,p[8]=v[8]*T,p},te.multiplyScalarAndAdd=function(p,v,T,M){return p[0]=v[0]+T[0]*M,p[1]=v[1]+T[1]*M,p[2]=v[2]+T[2]*M,p[3]=v[3]+T[3]*M,p[4]=v[4]+T[4]*M,p[5]=v[5]+T[5]*M,p[6]=v[6]+T[6]*M,p[7]=v[7]+T[7]*M,p[8]=v[8]+T[8]*M,p},te.exactEquals=function(p,v){return p[0]===v[0]&&p[1]===v[1]&&p[2]===v[2]&&p[3]===v[3]&&p[4]===v[4]&&p[5]===v[5]&&p[6]===v[6]&&p[7]===v[7]&&p[8]===v[8]},te.equals=function(p,v){var T=p[0],M=p[1],O=p[2],w=p[3],P=p[4],D=p[5],I=p[6],k=p[7],N=p[8],W=v[0],Z=v[1],ee=v[2],Q=v[3],K=v[4],ie=v[5],se=v[6],de=v[7],we=v[8];return Math.abs(T-W)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(M-Z)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(Z))&&Math.abs(O-ee)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(ee))&&Math.abs(w-Q)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(Q))&&Math.abs(P-K)<=o.EPSILON*Math.max(1,Math.abs(P),Math.abs(K))&&Math.abs(D-ie)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(ie))&&Math.abs(I-se)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(se))&&Math.abs(k-de)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(de))&&Math.abs(N-we)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(we))},te.sub=te.mul=void 0;var o=function(p,v){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var T=c(void 0);if(T&&T.has(p))return T.get(p);var M={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if(w!=="default"&&Object.prototype.hasOwnProperty.call(p,w)){var P=O?Object.getOwnPropertyDescriptor(p,w):null;P&&(P.get||P.set)?Object.defineProperty(M,w,P):M[w]=p[w]}return M.default=p,T&&T.set(p,M),M}(R());function c(p){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(c=function(M){return M?T:v})(p)}function h(p,v,T){var M=v[0],O=v[1],w=v[2],P=v[3],D=v[4],I=v[5],k=v[6],N=v[7],W=v[8],Z=T[0],ee=T[1],Q=T[2],K=T[3],ie=T[4],se=T[5],de=T[6],we=T[7],_e=T[8];return p[0]=Z*M+ee*P+Q*k,p[1]=Z*O+ee*D+Q*N,p[2]=Z*w+ee*I+Q*W,p[3]=K*M+ie*P+se*k,p[4]=K*O+ie*D+se*N,p[5]=K*w+ie*I+se*W,p[6]=de*M+we*P+_e*k,p[7]=de*O+we*D+_e*N,p[8]=de*w+we*I+_e*W,p}function m(p,v,T){return p[0]=v[0]-T[0],p[1]=v[1]-T[1],p[2]=v[2]-T[2],p[3]=v[3]-T[3],p[4]=v[4]-T[4],p[5]=v[5]-T[5],p[6]=v[6]-T[6],p[7]=v[7]-T[7],p[8]=v[8]-T[8],p}return te.mul=h,te.sub=m,te}var he,le={};function ve(){if(he)return le;function d(w){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},d(w)}he=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var w=new o.ARRAY_TYPE(16);return o.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},le.clone=function(w){var P=new o.ARRAY_TYPE(16);return P[0]=w[0],P[1]=w[1],P[2]=w[2],P[3]=w[3],P[4]=w[4],P[5]=w[5],P[6]=w[6],P[7]=w[7],P[8]=w[8],P[9]=w[9],P[10]=w[10],P[11]=w[11],P[12]=w[12],P[13]=w[13],P[14]=w[14],P[15]=w[15],P},le.copy=function(w,P){return w[0]=P[0],w[1]=P[1],w[2]=P[2],w[3]=P[3],w[4]=P[4],w[5]=P[5],w[6]=P[6],w[7]=P[7],w[8]=P[8],w[9]=P[9],w[10]=P[10],w[11]=P[11],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15],w},le.fromValues=function(w,P,D,I,k,N,W,Z,ee,Q,K,ie,se,de,we,_e){var xe=new o.ARRAY_TYPE(16);return xe[0]=w,xe[1]=P,xe[2]=D,xe[3]=I,xe[4]=k,xe[5]=N,xe[6]=W,xe[7]=Z,xe[8]=ee,xe[9]=Q,xe[10]=K,xe[11]=ie,xe[12]=se,xe[13]=de,xe[14]=we,xe[15]=_e,xe},le.set=function(w,P,D,I,k,N,W,Z,ee,Q,K,ie,se,de,we,_e,xe){return w[0]=P,w[1]=D,w[2]=I,w[3]=k,w[4]=N,w[5]=W,w[6]=Z,w[7]=ee,w[8]=Q,w[9]=K,w[10]=ie,w[11]=se,w[12]=de,w[13]=we,w[14]=_e,w[15]=xe,w},le.identity=h,le.transpose=function(w,P){if(w===P){var D=P[1],I=P[2],k=P[3],N=P[6],W=P[7],Z=P[11];w[1]=P[4],w[2]=P[8],w[3]=P[12],w[4]=D,w[6]=P[9],w[7]=P[13],w[8]=I,w[9]=N,w[11]=P[14],w[12]=k,w[13]=W,w[14]=Z}else w[0]=P[0],w[1]=P[4],w[2]=P[8],w[3]=P[12],w[4]=P[1],w[5]=P[5],w[6]=P[9],w[7]=P[13],w[8]=P[2],w[9]=P[6],w[10]=P[10],w[11]=P[14],w[12]=P[3],w[13]=P[7],w[14]=P[11],w[15]=P[15];return w},le.invert=function(w,P){var D=P[0],I=P[1],k=P[2],N=P[3],W=P[4],Z=P[5],ee=P[6],Q=P[7],K=P[8],ie=P[9],se=P[10],de=P[11],we=P[12],_e=P[13],xe=P[14],ke=P[15],Se=D*Z-I*W,De=D*ee-k*W,Ve=D*Q-N*W,Fe=I*ee-k*Z,Ze=I*Q-N*Z,He=k*Q-N*ee,tt=K*_e-ie*we,Ke=K*xe-se*we,nt=K*ke-de*we,Ct=ie*xe-se*_e,At=ie*ke-de*_e,Qt=se*ke-de*xe,Rt=Se*Qt-De*At+Ve*Ct+Fe*nt-Ze*Ke+He*tt;return Rt?(w[0]=(Z*Qt-ee*At+Q*Ct)*(Rt=1/Rt),w[1]=(k*At-I*Qt-N*Ct)*Rt,w[2]=(_e*He-xe*Ze+ke*Fe)*Rt,w[3]=(se*Ze-ie*He-de*Fe)*Rt,w[4]=(ee*nt-W*Qt-Q*Ke)*Rt,w[5]=(D*Qt-k*nt+N*Ke)*Rt,w[6]=(xe*Ve-we*He-ke*De)*Rt,w[7]=(K*He-se*Ve+de*De)*Rt,w[8]=(W*At-Z*nt+Q*tt)*Rt,w[9]=(I*nt-D*At-N*tt)*Rt,w[10]=(we*Ze-_e*Ve+ke*Se)*Rt,w[11]=(ie*Ve-K*Ze-de*Se)*Rt,w[12]=(Z*Ke-W*Ct-ee*tt)*Rt,w[13]=(D*Ct-I*Ke+k*tt)*Rt,w[14]=(_e*De-we*Fe-xe*Se)*Rt,w[15]=(K*Fe-ie*De+se*Se)*Rt,w):null},le.adjoint=function(w,P){var D=P[0],I=P[1],k=P[2],N=P[3],W=P[4],Z=P[5],ee=P[6],Q=P[7],K=P[8],ie=P[9],se=P[10],de=P[11],we=P[12],_e=P[13],xe=P[14],ke=P[15];return w[0]=Z*(se*ke-de*xe)-ie*(ee*ke-Q*xe)+_e*(ee*de-Q*se),w[1]=-(I*(se*ke-de*xe)-ie*(k*ke-N*xe)+_e*(k*de-N*se)),w[2]=I*(ee*ke-Q*xe)-Z*(k*ke-N*xe)+_e*(k*Q-N*ee),w[3]=-(I*(ee*de-Q*se)-Z*(k*de-N*se)+ie*(k*Q-N*ee)),w[4]=-(W*(se*ke-de*xe)-K*(ee*ke-Q*xe)+we*(ee*de-Q*se)),w[5]=D*(se*ke-de*xe)-K*(k*ke-N*xe)+we*(k*de-N*se),w[6]=-(D*(ee*ke-Q*xe)-W*(k*ke-N*xe)+we*(k*Q-N*ee)),w[7]=D*(ee*de-Q*se)-W*(k*de-N*se)+K*(k*Q-N*ee),w[8]=W*(ie*ke-de*_e)-K*(Z*ke-Q*_e)+we*(Z*de-Q*ie),w[9]=-(D*(ie*ke-de*_e)-K*(I*ke-N*_e)+we*(I*de-N*ie)),w[10]=D*(Z*ke-Q*_e)-W*(I*ke-N*_e)+we*(I*Q-N*Z),w[11]=-(D*(Z*de-Q*ie)-W*(I*de-N*ie)+K*(I*Q-N*Z)),w[12]=-(W*(ie*xe-se*_e)-K*(Z*xe-ee*_e)+we*(Z*se-ee*ie)),w[13]=D*(ie*xe-se*_e)-K*(I*xe-k*_e)+we*(I*se-k*ie),w[14]=-(D*(Z*xe-ee*_e)-W*(I*xe-k*_e)+we*(I*ee-k*Z)),w[15]=D*(Z*se-ee*ie)-W*(I*se-k*ie)+K*(I*ee-k*Z),w},le.determinant=function(w){var P=w[0],D=w[1],I=w[2],k=w[3],N=w[4],W=w[5],Z=w[6],ee=w[7],Q=w[8],K=w[9],ie=w[10],se=w[11],de=w[12],we=w[13],_e=w[14],xe=w[15];return(P*W-D*N)*(ie*xe-se*_e)-(P*Z-I*N)*(K*xe-se*we)+(P*ee-k*N)*(K*_e-ie*we)+(D*Z-I*W)*(Q*xe-se*de)-(D*ee-k*W)*(Q*_e-ie*de)+(I*ee-k*Z)*(Q*we-K*de)},le.multiply=m,le.translate=function(w,P,D){var I,k,N,W,Z,ee,Q,K,ie,se,de,we,_e=D[0],xe=D[1],ke=D[2];return P===w?(w[12]=P[0]*_e+P[4]*xe+P[8]*ke+P[12],w[13]=P[1]*_e+P[5]*xe+P[9]*ke+P[13],w[14]=P[2]*_e+P[6]*xe+P[10]*ke+P[14],w[15]=P[3]*_e+P[7]*xe+P[11]*ke+P[15]):(k=P[1],N=P[2],W=P[3],Z=P[4],ee=P[5],Q=P[6],K=P[7],ie=P[8],se=P[9],de=P[10],we=P[11],w[0]=I=P[0],w[1]=k,w[2]=N,w[3]=W,w[4]=Z,w[5]=ee,w[6]=Q,w[7]=K,w[8]=ie,w[9]=se,w[10]=de,w[11]=we,w[12]=I*_e+Z*xe+ie*ke+P[12],w[13]=k*_e+ee*xe+se*ke+P[13],w[14]=N*_e+Q*xe+de*ke+P[14],w[15]=W*_e+K*xe+we*ke+P[15]),w},le.scale=function(w,P,D){var I=D[0],k=D[1],N=D[2];return w[0]=P[0]*I,w[1]=P[1]*I,w[2]=P[2]*I,w[3]=P[3]*I,w[4]=P[4]*k,w[5]=P[5]*k,w[6]=P[6]*k,w[7]=P[7]*k,w[8]=P[8]*N,w[9]=P[9]*N,w[10]=P[10]*N,w[11]=P[11]*N,w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15],w},le.rotate=function(w,P,D,I){var k,N,W,Z,ee,Q,K,ie,se,de,we,_e,xe,ke,Se,De,Ve,Fe,Ze,He,tt,Ke,nt,Ct,At=I[0],Qt=I[1],Rt=I[2],Ft=Math.hypot(At,Qt,Rt);return Ft<o.EPSILON?null:(At*=Ft=1/Ft,Qt*=Ft,Rt*=Ft,k=Math.sin(D),N=Math.cos(D),ee=P[1],Q=P[2],K=P[3],se=P[5],de=P[6],we=P[7],xe=P[9],ke=P[10],Se=P[11],De=At*At*(W=1-N)+N,Ze=At*Qt*W-Rt*k,He=Qt*Qt*W+N,tt=Rt*Qt*W+At*k,Ke=At*Rt*W+Qt*k,nt=Qt*Rt*W-At*k,Ct=Rt*Rt*W+N,w[0]=(Z=P[0])*De+(ie=P[4])*(Ve=Qt*At*W+Rt*k)+(_e=P[8])*(Fe=Rt*At*W-Qt*k),w[1]=ee*De+se*Ve+xe*Fe,w[2]=Q*De+de*Ve+ke*Fe,w[3]=K*De+we*Ve+Se*Fe,w[4]=Z*Ze+ie*He+_e*tt,w[5]=ee*Ze+se*He+xe*tt,w[6]=Q*Ze+de*He+ke*tt,w[7]=K*Ze+we*He+Se*tt,w[8]=Z*Ke+ie*nt+_e*Ct,w[9]=ee*Ke+se*nt+xe*Ct,w[10]=Q*Ke+de*nt+ke*Ct,w[11]=K*Ke+we*nt+Se*Ct,P!==w&&(w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w)},le.rotateX=function(w,P,D){var I=Math.sin(D),k=Math.cos(D),N=P[4],W=P[5],Z=P[6],ee=P[7],Q=P[8],K=P[9],ie=P[10],se=P[11];return P!==w&&(w[0]=P[0],w[1]=P[1],w[2]=P[2],w[3]=P[3],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w[4]=N*k+Q*I,w[5]=W*k+K*I,w[6]=Z*k+ie*I,w[7]=ee*k+se*I,w[8]=Q*k-N*I,w[9]=K*k-W*I,w[10]=ie*k-Z*I,w[11]=se*k-ee*I,w},le.rotateY=function(w,P,D){var I=Math.sin(D),k=Math.cos(D),N=P[0],W=P[1],Z=P[2],ee=P[3],Q=P[8],K=P[9],ie=P[10],se=P[11];return P!==w&&(w[4]=P[4],w[5]=P[5],w[6]=P[6],w[7]=P[7],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w[0]=N*k-Q*I,w[1]=W*k-K*I,w[2]=Z*k-ie*I,w[3]=ee*k-se*I,w[8]=N*I+Q*k,w[9]=W*I+K*k,w[10]=Z*I+ie*k,w[11]=ee*I+se*k,w},le.rotateZ=function(w,P,D){var I=Math.sin(D),k=Math.cos(D),N=P[0],W=P[1],Z=P[2],ee=P[3],Q=P[4],K=P[5],ie=P[6],se=P[7];return P!==w&&(w[8]=P[8],w[9]=P[9],w[10]=P[10],w[11]=P[11],w[12]=P[12],w[13]=P[13],w[14]=P[14],w[15]=P[15]),w[0]=N*k+Q*I,w[1]=W*k+K*I,w[2]=Z*k+ie*I,w[3]=ee*k+se*I,w[4]=Q*k-N*I,w[5]=K*k-W*I,w[6]=ie*k-Z*I,w[7]=se*k-ee*I,w},le.fromTranslation=function(w,P){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=P[0],w[13]=P[1],w[14]=P[2],w[15]=1,w},le.fromScaling=function(w,P){return w[0]=P[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=P[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=P[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromRotation=function(w,P,D){var I,k,N,W=D[0],Z=D[1],ee=D[2],Q=Math.hypot(W,Z,ee);return Q<o.EPSILON?null:(W*=Q=1/Q,Z*=Q,ee*=Q,I=Math.sin(P),k=Math.cos(P),w[0]=W*W*(N=1-k)+k,w[1]=Z*W*N+ee*I,w[2]=ee*W*N-Z*I,w[3]=0,w[4]=W*Z*N-ee*I,w[5]=Z*Z*N+k,w[6]=ee*Z*N+W*I,w[7]=0,w[8]=W*ee*N+Z*I,w[9]=Z*ee*N-W*I,w[10]=ee*ee*N+k,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},le.fromXRotation=function(w,P){var D=Math.sin(P),I=Math.cos(P);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I,w[6]=D,w[7]=0,w[8]=0,w[9]=-D,w[10]=I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromYRotation=function(w,P){var D=Math.sin(P),I=Math.cos(P);return w[0]=I,w[1]=0,w[2]=-D,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=D,w[9]=0,w[10]=I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromZRotation=function(w,P){var D=Math.sin(P),I=Math.cos(P);return w[0]=I,w[1]=D,w[2]=0,w[3]=0,w[4]=-D,w[5]=I,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.fromRotationTranslation=p,le.fromQuat2=function(w,P){var D=new o.ARRAY_TYPE(3),I=-P[0],k=-P[1],N=-P[2],W=P[3],Z=P[4],ee=P[5],Q=P[6],K=P[7],ie=I*I+k*k+N*N+W*W;return ie>0?(D[0]=2*(Z*W+K*I+ee*N-Q*k)/ie,D[1]=2*(ee*W+K*k+Q*I-Z*N)/ie,D[2]=2*(Q*W+K*N+Z*k-ee*I)/ie):(D[0]=2*(Z*W+K*I+ee*N-Q*k),D[1]=2*(ee*W+K*k+Q*I-Z*N),D[2]=2*(Q*W+K*N+Z*k-ee*I)),p(w,P,D),w},le.getTranslation=function(w,P){return w[0]=P[12],w[1]=P[13],w[2]=P[14],w},le.getScaling=v,le.getRotation=function(w,P){var D=new o.ARRAY_TYPE(3);v(D,P);var I=1/D[0],k=1/D[1],N=1/D[2],W=P[0]*I,Z=P[1]*k,ee=P[2]*N,Q=P[4]*I,K=P[5]*k,ie=P[6]*N,se=P[8]*I,de=P[9]*k,we=P[10]*N,_e=W+K+we,xe=0;return _e>0?(xe=2*Math.sqrt(_e+1),w[3]=.25*xe,w[0]=(ie-de)/xe,w[1]=(se-ee)/xe,w[2]=(Z-Q)/xe):W>K&&W>we?(xe=2*Math.sqrt(1+W-K-we),w[3]=(ie-de)/xe,w[0]=.25*xe,w[1]=(Z+Q)/xe,w[2]=(se+ee)/xe):K>we?(xe=2*Math.sqrt(1+K-W-we),w[3]=(se-ee)/xe,w[0]=(Z+Q)/xe,w[1]=.25*xe,w[2]=(ie+de)/xe):(xe=2*Math.sqrt(1+we-W-K),w[3]=(Z-Q)/xe,w[0]=(se+ee)/xe,w[1]=(ie+de)/xe,w[2]=.25*xe),w},le.fromRotationTranslationScale=function(w,P,D,I){var k=P[0],N=P[1],W=P[2],Z=P[3],ee=k+k,Q=N+N,K=W+W,ie=k*ee,se=k*Q,de=k*K,we=N*Q,_e=N*K,xe=W*K,ke=Z*ee,Se=Z*Q,De=Z*K,Ve=I[0],Fe=I[1],Ze=I[2];return w[0]=(1-(we+xe))*Ve,w[1]=(se+De)*Ve,w[2]=(de-Se)*Ve,w[3]=0,w[4]=(se-De)*Fe,w[5]=(1-(ie+xe))*Fe,w[6]=(_e+ke)*Fe,w[7]=0,w[8]=(de+Se)*Ze,w[9]=(_e-ke)*Ze,w[10]=(1-(ie+we))*Ze,w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w},le.fromRotationTranslationScaleOrigin=function(w,P,D,I,k){var N=P[0],W=P[1],Z=P[2],ee=P[3],Q=N+N,K=W+W,ie=Z+Z,se=N*Q,de=N*K,we=N*ie,_e=W*K,xe=W*ie,ke=Z*ie,Se=ee*Q,De=ee*K,Ve=ee*ie,Fe=I[0],Ze=I[1],He=I[2],tt=k[0],Ke=k[1],nt=k[2],Ct=(1-(_e+ke))*Fe,At=(de+Ve)*Fe,Qt=(we-De)*Fe,Rt=(de-Ve)*Ze,Ft=(1-(se+ke))*Ze,It=(xe+Se)*Ze,yr=(we+De)*He,Zt=(xe-Se)*He,nr=(1-(se+_e))*He;return w[0]=Ct,w[1]=At,w[2]=Qt,w[3]=0,w[4]=Rt,w[5]=Ft,w[6]=It,w[7]=0,w[8]=yr,w[9]=Zt,w[10]=nr,w[11]=0,w[12]=D[0]+tt-(Ct*tt+Rt*Ke+yr*nt),w[13]=D[1]+Ke-(At*tt+Ft*Ke+Zt*nt),w[14]=D[2]+nt-(Qt*tt+It*Ke+nr*nt),w[15]=1,w},le.fromQuat=function(w,P){var D=P[0],I=P[1],k=P[2],N=P[3],W=D+D,Z=I+I,ee=k+k,Q=D*W,K=I*W,ie=I*Z,se=k*W,de=k*Z,we=k*ee,_e=N*W,xe=N*Z,ke=N*ee;return w[0]=1-ie-we,w[1]=K+ke,w[2]=se-xe,w[3]=0,w[4]=K-ke,w[5]=1-Q-we,w[6]=de+_e,w[7]=0,w[8]=se+xe,w[9]=de-_e,w[10]=1-Q-ie,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},le.frustum=function(w,P,D,I,k,N,W){var Z=1/(D-P),ee=1/(k-I),Q=1/(N-W);return w[0]=2*N*Z,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*N*ee,w[6]=0,w[7]=0,w[8]=(D+P)*Z,w[9]=(k+I)*ee,w[10]=(W+N)*Q,w[11]=-1,w[12]=0,w[13]=0,w[14]=W*N*2*Q,w[15]=0,w},le.perspectiveNO=T,le.perspectiveZO=function(w,P,D,I,k){var N,W=1/Math.tan(P/2);return w[0]=W/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,k!=null&&k!==1/0?(w[10]=k*(N=1/(I-k)),w[14]=k*I*N):(w[10]=-1,w[14]=-I),w},le.perspectiveFromFieldOfView=function(w,P,D,I){var k=Math.tan(P.upDegrees*Math.PI/180),N=Math.tan(P.downDegrees*Math.PI/180),W=Math.tan(P.leftDegrees*Math.PI/180),Z=Math.tan(P.rightDegrees*Math.PI/180),ee=2/(W+Z),Q=2/(k+N);return w[0]=ee,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Q,w[6]=0,w[7]=0,w[8]=-(W-Z)*ee*.5,w[9]=(k-N)*Q*.5,w[10]=I/(D-I),w[11]=-1,w[12]=0,w[13]=0,w[14]=I*D/(D-I),w[15]=0,w},le.orthoNO=M,le.orthoZO=function(w,P,D,I,k,N,W){var Z=1/(P-D),ee=1/(I-k),Q=1/(N-W);return w[0]=-2*Z,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ee,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=Q,w[11]=0,w[12]=(P+D)*Z,w[13]=(k+I)*ee,w[14]=N*Q,w[15]=1,w},le.lookAt=function(w,P,D,I){var k,N,W,Z,ee,Q,K,ie,se,de,we=P[0],_e=P[1],xe=P[2],ke=I[0],Se=I[1],De=I[2],Ve=D[0],Fe=D[1],Ze=D[2];return Math.abs(we-Ve)<o.EPSILON&&Math.abs(_e-Fe)<o.EPSILON&&Math.abs(xe-Ze)<o.EPSILON?h(w):(K=we-Ve,ie=_e-Fe,se=xe-Ze,k=Se*(se*=de=1/Math.hypot(K,ie,se))-De*(ie*=de),N=De*(K*=de)-ke*se,W=ke*ie-Se*K,(de=Math.hypot(k,N,W))?(k*=de=1/de,N*=de,W*=de):(k=0,N=0,W=0),Z=ie*W-se*N,ee=se*k-K*W,Q=K*N-ie*k,(de=Math.hypot(Z,ee,Q))?(Z*=de=1/de,ee*=de,Q*=de):(Z=0,ee=0,Q=0),w[0]=k,w[1]=Z,w[2]=K,w[3]=0,w[4]=N,w[5]=ee,w[6]=ie,w[7]=0,w[8]=W,w[9]=Q,w[10]=se,w[11]=0,w[12]=-(k*we+N*_e+W*xe),w[13]=-(Z*we+ee*_e+Q*xe),w[14]=-(K*we+ie*_e+se*xe),w[15]=1,w)},le.targetTo=function(w,P,D,I){var k=P[0],N=P[1],W=P[2],Z=I[0],ee=I[1],Q=I[2],K=k-D[0],ie=N-D[1],se=W-D[2],de=K*K+ie*ie+se*se;de>0&&(K*=de=1/Math.sqrt(de),ie*=de,se*=de);var we=ee*se-Q*ie,_e=Q*K-Z*se,xe=Z*ie-ee*K;return(de=we*we+_e*_e+xe*xe)>0&&(we*=de=1/Math.sqrt(de),_e*=de,xe*=de),w[0]=we,w[1]=_e,w[2]=xe,w[3]=0,w[4]=ie*xe-se*_e,w[5]=se*we-K*xe,w[6]=K*_e-ie*we,w[7]=0,w[8]=K,w[9]=ie,w[10]=se,w[11]=0,w[12]=k,w[13]=N,w[14]=W,w[15]=1,w},le.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},le.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},le.add=function(w,P,D){return w[0]=P[0]+D[0],w[1]=P[1]+D[1],w[2]=P[2]+D[2],w[3]=P[3]+D[3],w[4]=P[4]+D[4],w[5]=P[5]+D[5],w[6]=P[6]+D[6],w[7]=P[7]+D[7],w[8]=P[8]+D[8],w[9]=P[9]+D[9],w[10]=P[10]+D[10],w[11]=P[11]+D[11],w[12]=P[12]+D[12],w[13]=P[13]+D[13],w[14]=P[14]+D[14],w[15]=P[15]+D[15],w},le.subtract=O,le.multiplyScalar=function(w,P,D){return w[0]=P[0]*D,w[1]=P[1]*D,w[2]=P[2]*D,w[3]=P[3]*D,w[4]=P[4]*D,w[5]=P[5]*D,w[6]=P[6]*D,w[7]=P[7]*D,w[8]=P[8]*D,w[9]=P[9]*D,w[10]=P[10]*D,w[11]=P[11]*D,w[12]=P[12]*D,w[13]=P[13]*D,w[14]=P[14]*D,w[15]=P[15]*D,w},le.multiplyScalarAndAdd=function(w,P,D,I){return w[0]=P[0]+D[0]*I,w[1]=P[1]+D[1]*I,w[2]=P[2]+D[2]*I,w[3]=P[3]+D[3]*I,w[4]=P[4]+D[4]*I,w[5]=P[5]+D[5]*I,w[6]=P[6]+D[6]*I,w[7]=P[7]+D[7]*I,w[8]=P[8]+D[8]*I,w[9]=P[9]+D[9]*I,w[10]=P[10]+D[10]*I,w[11]=P[11]+D[11]*I,w[12]=P[12]+D[12]*I,w[13]=P[13]+D[13]*I,w[14]=P[14]+D[14]*I,w[15]=P[15]+D[15]*I,w},le.exactEquals=function(w,P){return w[0]===P[0]&&w[1]===P[1]&&w[2]===P[2]&&w[3]===P[3]&&w[4]===P[4]&&w[5]===P[5]&&w[6]===P[6]&&w[7]===P[7]&&w[8]===P[8]&&w[9]===P[9]&&w[10]===P[10]&&w[11]===P[11]&&w[12]===P[12]&&w[13]===P[13]&&w[14]===P[14]&&w[15]===P[15]},le.equals=function(w,P){var D=w[0],I=w[1],k=w[2],N=w[3],W=w[4],Z=w[5],ee=w[6],Q=w[7],K=w[8],ie=w[9],se=w[10],de=w[11],we=w[12],_e=w[13],xe=w[14],ke=w[15],Se=P[0],De=P[1],Ve=P[2],Fe=P[3],Ze=P[4],He=P[5],tt=P[6],Ke=P[7],nt=P[8],Ct=P[9],At=P[10],Qt=P[11],Rt=P[12],Ft=P[13],It=P[14],yr=P[15];return Math.abs(D-Se)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(Se))&&Math.abs(I-De)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(De))&&Math.abs(k-Ve)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(Ve))&&Math.abs(N-Fe)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(Fe))&&Math.abs(W-Ze)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ze))&&Math.abs(Z-He)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(He))&&Math.abs(ee-tt)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(tt))&&Math.abs(Q-Ke)<=o.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Ke))&&Math.abs(K-nt)<=o.EPSILON*Math.max(1,Math.abs(K),Math.abs(nt))&&Math.abs(ie-Ct)<=o.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ct))&&Math.abs(se-At)<=o.EPSILON*Math.max(1,Math.abs(se),Math.abs(At))&&Math.abs(de-Qt)<=o.EPSILON*Math.max(1,Math.abs(de),Math.abs(Qt))&&Math.abs(we-Rt)<=o.EPSILON*Math.max(1,Math.abs(we),Math.abs(Rt))&&Math.abs(_e-Ft)<=o.EPSILON*Math.max(1,Math.abs(_e),Math.abs(Ft))&&Math.abs(xe-It)<=o.EPSILON*Math.max(1,Math.abs(xe),Math.abs(It))&&Math.abs(ke-yr)<=o.EPSILON*Math.max(1,Math.abs(ke),Math.abs(yr))},le.sub=le.mul=le.ortho=le.perspective=void 0;var o=function(w,P){if(w&&w.__esModule)return w;if(w===null||d(w)!=="object"&&typeof w!="function")return{default:w};var D=c(void 0);if(D&&D.has(w))return D.get(w);var I={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in w)if(N!=="default"&&Object.prototype.hasOwnProperty.call(w,N)){var W=k?Object.getOwnPropertyDescriptor(w,N):null;W&&(W.get||W.set)?Object.defineProperty(I,N,W):I[N]=w[N]}return I.default=w,D&&D.set(w,I),I}(R());function c(w){if(typeof WeakMap!="function")return null;var P=new WeakMap,D=new WeakMap;return(c=function(I){return I?D:P})(w)}function h(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function m(w,P,D){var I=P[0],k=P[1],N=P[2],W=P[3],Z=P[4],ee=P[5],Q=P[6],K=P[7],ie=P[8],se=P[9],de=P[10],we=P[11],_e=P[12],xe=P[13],ke=P[14],Se=P[15],De=D[0],Ve=D[1],Fe=D[2],Ze=D[3];return w[0]=De*I+Ve*Z+Fe*ie+Ze*_e,w[1]=De*k+Ve*ee+Fe*se+Ze*xe,w[2]=De*N+Ve*Q+Fe*de+Ze*ke,w[3]=De*W+Ve*K+Fe*we+Ze*Se,w[4]=(De=D[4])*I+(Ve=D[5])*Z+(Fe=D[6])*ie+(Ze=D[7])*_e,w[5]=De*k+Ve*ee+Fe*se+Ze*xe,w[6]=De*N+Ve*Q+Fe*de+Ze*ke,w[7]=De*W+Ve*K+Fe*we+Ze*Se,w[8]=(De=D[8])*I+(Ve=D[9])*Z+(Fe=D[10])*ie+(Ze=D[11])*_e,w[9]=De*k+Ve*ee+Fe*se+Ze*xe,w[10]=De*N+Ve*Q+Fe*de+Ze*ke,w[11]=De*W+Ve*K+Fe*we+Ze*Se,w[12]=(De=D[12])*I+(Ve=D[13])*Z+(Fe=D[14])*ie+(Ze=D[15])*_e,w[13]=De*k+Ve*ee+Fe*se+Ze*xe,w[14]=De*N+Ve*Q+Fe*de+Ze*ke,w[15]=De*W+Ve*K+Fe*we+Ze*Se,w}function p(w,P,D){var I=P[0],k=P[1],N=P[2],W=P[3],Z=I+I,ee=k+k,Q=N+N,K=I*Z,ie=I*ee,se=I*Q,de=k*ee,we=k*Q,_e=N*Q,xe=W*Z,ke=W*ee,Se=W*Q;return w[0]=1-(de+_e),w[1]=ie+Se,w[2]=se-ke,w[3]=0,w[4]=ie-Se,w[5]=1-(K+_e),w[6]=we+xe,w[7]=0,w[8]=se+ke,w[9]=we-xe,w[10]=1-(K+de),w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w}function v(w,P){var D=P[4],I=P[5],k=P[6],N=P[8],W=P[9],Z=P[10];return w[0]=Math.hypot(P[0],P[1],P[2]),w[1]=Math.hypot(D,I,k),w[2]=Math.hypot(N,W,Z),w}function T(w,P,D,I,k){var N,W=1/Math.tan(P/2);return w[0]=W/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,k!=null&&k!==1/0?(w[10]=(k+I)*(N=1/(I-k)),w[14]=2*k*I*N):(w[10]=-1,w[14]=-2*I),w}function M(w,P,D,I,k,N,W){var Z=1/(P-D),ee=1/(I-k),Q=1/(N-W);return w[0]=-2*Z,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ee,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*Q,w[11]=0,w[12]=(P+D)*Z,w[13]=(k+I)*ee,w[14]=(W+N)*Q,w[15]=1,w}function O(w,P,D){return w[0]=P[0]-D[0],w[1]=P[1]-D[1],w[2]=P[2]-D[2],w[3]=P[3]-D[3],w[4]=P[4]-D[4],w[5]=P[5]-D[5],w[6]=P[6]-D[6],w[7]=P[7]-D[7],w[8]=P[8]-D[8],w[9]=P[9]-D[9],w[10]=P[10]-D[10],w[11]=P[11]-D[11],w[12]=P[12]-D[12],w[13]=P[13]-D[13],w[14]=P[14]-D[14],w[15]=P[15]-D[15],w}return le.perspective=T,le.ortho=M,le.mul=m,le.sub=O,le}var We,Ie={},Re={};function $e(){if(We)return Re;function d(k){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},d(k)}We=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.create=h,Re.clone=function(k){var N=new o.ARRAY_TYPE(3);return N[0]=k[0],N[1]=k[1],N[2]=k[2],N},Re.length=m,Re.fromValues=function(k,N,W){var Z=new o.ARRAY_TYPE(3);return Z[0]=k,Z[1]=N,Z[2]=W,Z},Re.copy=function(k,N){return k[0]=N[0],k[1]=N[1],k[2]=N[2],k},Re.set=function(k,N,W,Z){return k[0]=N,k[1]=W,k[2]=Z,k},Re.add=function(k,N,W){return k[0]=N[0]+W[0],k[1]=N[1]+W[1],k[2]=N[2]+W[2],k},Re.subtract=p,Re.multiply=v,Re.divide=T,Re.ceil=function(k,N){return k[0]=Math.ceil(N[0]),k[1]=Math.ceil(N[1]),k[2]=Math.ceil(N[2]),k},Re.floor=function(k,N){return k[0]=Math.floor(N[0]),k[1]=Math.floor(N[1]),k[2]=Math.floor(N[2]),k},Re.min=function(k,N,W){return k[0]=Math.min(N[0],W[0]),k[1]=Math.min(N[1],W[1]),k[2]=Math.min(N[2],W[2]),k},Re.max=function(k,N,W){return k[0]=Math.max(N[0],W[0]),k[1]=Math.max(N[1],W[1]),k[2]=Math.max(N[2],W[2]),k},Re.round=function(k,N){return k[0]=Math.round(N[0]),k[1]=Math.round(N[1]),k[2]=Math.round(N[2]),k},Re.scale=function(k,N,W){return k[0]=N[0]*W,k[1]=N[1]*W,k[2]=N[2]*W,k},Re.scaleAndAdd=function(k,N,W,Z){return k[0]=N[0]+W[0]*Z,k[1]=N[1]+W[1]*Z,k[2]=N[2]+W[2]*Z,k},Re.distance=M,Re.squaredDistance=O,Re.squaredLength=w,Re.negate=function(k,N){return k[0]=-N[0],k[1]=-N[1],k[2]=-N[2],k},Re.inverse=function(k,N){return k[0]=1/N[0],k[1]=1/N[1],k[2]=1/N[2],k},Re.normalize=function(k,N){var W=N[0],Z=N[1],ee=N[2],Q=W*W+Z*Z+ee*ee;return Q>0&&(Q=1/Math.sqrt(Q)),k[0]=N[0]*Q,k[1]=N[1]*Q,k[2]=N[2]*Q,k},Re.dot=P,Re.cross=function(k,N,W){var Z=N[0],ee=N[1],Q=N[2],K=W[0],ie=W[1],se=W[2];return k[0]=ee*se-Q*ie,k[1]=Q*K-Z*se,k[2]=Z*ie-ee*K,k},Re.lerp=function(k,N,W,Z){var ee=N[0],Q=N[1],K=N[2];return k[0]=ee+Z*(W[0]-ee),k[1]=Q+Z*(W[1]-Q),k[2]=K+Z*(W[2]-K),k},Re.hermite=function(k,N,W,Z,ee,Q){var K=Q*Q,ie=K*(2*Q-3)+1,se=K*(Q-2)+Q,de=K*(Q-1),we=K*(3-2*Q);return k[0]=N[0]*ie+W[0]*se+Z[0]*de+ee[0]*we,k[1]=N[1]*ie+W[1]*se+Z[1]*de+ee[1]*we,k[2]=N[2]*ie+W[2]*se+Z[2]*de+ee[2]*we,k},Re.bezier=function(k,N,W,Z,ee,Q){var K=1-Q,ie=K*K,se=Q*Q,de=ie*K,we=3*Q*ie,_e=3*se*K,xe=se*Q;return k[0]=N[0]*de+W[0]*we+Z[0]*_e+ee[0]*xe,k[1]=N[1]*de+W[1]*we+Z[1]*_e+ee[1]*xe,k[2]=N[2]*de+W[2]*we+Z[2]*_e+ee[2]*xe,k},Re.random=function(k,N){N=N||1;var W=2*o.RANDOM()*Math.PI,Z=2*o.RANDOM()-1,ee=Math.sqrt(1-Z*Z)*N;return k[0]=Math.cos(W)*ee,k[1]=Math.sin(W)*ee,k[2]=Z*N,k},Re.transformMat4=function(k,N,W){var Z=N[0],ee=N[1],Q=N[2],K=W[3]*Z+W[7]*ee+W[11]*Q+W[15];return k[0]=(W[0]*Z+W[4]*ee+W[8]*Q+W[12])/(K=K||1),k[1]=(W[1]*Z+W[5]*ee+W[9]*Q+W[13])/K,k[2]=(W[2]*Z+W[6]*ee+W[10]*Q+W[14])/K,k},Re.transformMat3=function(k,N,W){var Z=N[0],ee=N[1],Q=N[2];return k[0]=Z*W[0]+ee*W[3]+Q*W[6],k[1]=Z*W[1]+ee*W[4]+Q*W[7],k[2]=Z*W[2]+ee*W[5]+Q*W[8],k},Re.transformQuat=function(k,N,W){var Z=W[0],ee=W[1],Q=W[2],K=N[0],ie=N[1],se=N[2],de=ee*se-Q*ie,we=Q*K-Z*se,_e=Z*ie-ee*K,xe=ee*_e-Q*we,ke=Q*de-Z*_e,Se=Z*we-ee*de,De=2*W[3];return we*=De,_e*=De,ke*=2,Se*=2,k[0]=K+(de*=De)+(xe*=2),k[1]=ie+we+ke,k[2]=se+_e+Se,k},Re.rotateX=function(k,N,W,Z){var ee=[],Q=[];return ee[0]=N[0]-W[0],ee[1]=N[1]-W[1],ee[2]=N[2]-W[2],Q[0]=ee[0],Q[1]=ee[1]*Math.cos(Z)-ee[2]*Math.sin(Z),Q[2]=ee[1]*Math.sin(Z)+ee[2]*Math.cos(Z),k[0]=Q[0]+W[0],k[1]=Q[1]+W[1],k[2]=Q[2]+W[2],k},Re.rotateY=function(k,N,W,Z){var ee=[],Q=[];return ee[0]=N[0]-W[0],ee[1]=N[1]-W[1],ee[2]=N[2]-W[2],Q[0]=ee[2]*Math.sin(Z)+ee[0]*Math.cos(Z),Q[1]=ee[1],Q[2]=ee[2]*Math.cos(Z)-ee[0]*Math.sin(Z),k[0]=Q[0]+W[0],k[1]=Q[1]+W[1],k[2]=Q[2]+W[2],k},Re.rotateZ=function(k,N,W,Z){var ee=[],Q=[];return ee[0]=N[0]-W[0],ee[1]=N[1]-W[1],ee[2]=N[2]-W[2],Q[0]=ee[0]*Math.cos(Z)-ee[1]*Math.sin(Z),Q[1]=ee[0]*Math.sin(Z)+ee[1]*Math.cos(Z),Q[2]=ee[2],k[0]=Q[0]+W[0],k[1]=Q[1]+W[1],k[2]=Q[2]+W[2],k},Re.angle=function(k,N){var W=k[0],Z=k[1],ee=k[2],Q=N[0],K=N[1],ie=N[2],se=Math.sqrt(W*W+Z*Z+ee*ee)*Math.sqrt(Q*Q+K*K+ie*ie),de=se&&P(k,N)/se;return Math.acos(Math.min(Math.max(de,-1),1))},Re.zero=function(k){return k[0]=0,k[1]=0,k[2]=0,k},Re.str=function(k){return"vec3("+k[0]+", "+k[1]+", "+k[2]+")"},Re.exactEquals=function(k,N){return k[0]===N[0]&&k[1]===N[1]&&k[2]===N[2]},Re.equals=function(k,N){var W=k[0],Z=k[1],ee=k[2],Q=N[0],K=N[1],ie=N[2];return Math.abs(W-Q)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(Q))&&Math.abs(Z-K)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(K))&&Math.abs(ee-ie)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(ie))},Re.forEach=Re.sqrLen=Re.len=Re.sqrDist=Re.dist=Re.div=Re.mul=Re.sub=void 0;var o=function(k,N){if(k&&k.__esModule)return k;if(k===null||d(k)!=="object"&&typeof k!="function")return{default:k};var W=c(void 0);if(W&&W.has(k))return W.get(k);var Z={},ee=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in k)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(k,Q)){var K=ee?Object.getOwnPropertyDescriptor(k,Q):null;K&&(K.get||K.set)?Object.defineProperty(Z,Q,K):Z[Q]=k[Q]}return Z.default=k,W&&W.set(k,Z),Z}(R());function c(k){if(typeof WeakMap!="function")return null;var N=new WeakMap,W=new WeakMap;return(c=function(Z){return Z?W:N})(k)}function h(){var k=new o.ARRAY_TYPE(3);return o.ARRAY_TYPE!=Float32Array&&(k[0]=0,k[1]=0,k[2]=0),k}function m(k){return Math.hypot(k[0],k[1],k[2])}function p(k,N,W){return k[0]=N[0]-W[0],k[1]=N[1]-W[1],k[2]=N[2]-W[2],k}function v(k,N,W){return k[0]=N[0]*W[0],k[1]=N[1]*W[1],k[2]=N[2]*W[2],k}function T(k,N,W){return k[0]=N[0]/W[0],k[1]=N[1]/W[1],k[2]=N[2]/W[2],k}function M(k,N){return Math.hypot(N[0]-k[0],N[1]-k[1],N[2]-k[2])}function O(k,N){var W=N[0]-k[0],Z=N[1]-k[1],ee=N[2]-k[2];return W*W+Z*Z+ee*ee}function w(k){var N=k[0],W=k[1],Z=k[2];return N*N+W*W+Z*Z}function P(k,N){return k[0]*N[0]+k[1]*N[1]+k[2]*N[2]}Re.sub=p,Re.mul=v,Re.div=T,Re.dist=M,Re.sqrDist=O,Re.len=m,Re.sqrLen=w;var D,I=(D=h(),function(k,N,W,Z,ee,Q){var K,ie;for(N||(N=3),W||(W=0),ie=Z?Math.min(Z*N+W,k.length):k.length,K=W;K<ie;K+=N)D[0]=k[K],D[1]=k[K+1],D[2]=k[K+2],ee(D,D,Q),k[K]=D[0],k[K+1]=D[1],k[K+2]=D[2];return k});return Re.forEach=I,Re}var ot,Je,rt={};function st(){if(ot)return rt;function d(I){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},d(I)}ot=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.create=h,rt.clone=function(I){var k=new o.ARRAY_TYPE(4);return k[0]=I[0],k[1]=I[1],k[2]=I[2],k[3]=I[3],k},rt.fromValues=function(I,k,N,W){var Z=new o.ARRAY_TYPE(4);return Z[0]=I,Z[1]=k,Z[2]=N,Z[3]=W,Z},rt.copy=function(I,k){return I[0]=k[0],I[1]=k[1],I[2]=k[2],I[3]=k[3],I},rt.set=function(I,k,N,W,Z){return I[0]=k,I[1]=N,I[2]=W,I[3]=Z,I},rt.add=function(I,k,N){return I[0]=k[0]+N[0],I[1]=k[1]+N[1],I[2]=k[2]+N[2],I[3]=k[3]+N[3],I},rt.subtract=m,rt.multiply=p,rt.divide=v,rt.ceil=function(I,k){return I[0]=Math.ceil(k[0]),I[1]=Math.ceil(k[1]),I[2]=Math.ceil(k[2]),I[3]=Math.ceil(k[3]),I},rt.floor=function(I,k){return I[0]=Math.floor(k[0]),I[1]=Math.floor(k[1]),I[2]=Math.floor(k[2]),I[3]=Math.floor(k[3]),I},rt.min=function(I,k,N){return I[0]=Math.min(k[0],N[0]),I[1]=Math.min(k[1],N[1]),I[2]=Math.min(k[2],N[2]),I[3]=Math.min(k[3],N[3]),I},rt.max=function(I,k,N){return I[0]=Math.max(k[0],N[0]),I[1]=Math.max(k[1],N[1]),I[2]=Math.max(k[2],N[2]),I[3]=Math.max(k[3],N[3]),I},rt.round=function(I,k){return I[0]=Math.round(k[0]),I[1]=Math.round(k[1]),I[2]=Math.round(k[2]),I[3]=Math.round(k[3]),I},rt.scale=function(I,k,N){return I[0]=k[0]*N,I[1]=k[1]*N,I[2]=k[2]*N,I[3]=k[3]*N,I},rt.scaleAndAdd=function(I,k,N,W){return I[0]=k[0]+N[0]*W,I[1]=k[1]+N[1]*W,I[2]=k[2]+N[2]*W,I[3]=k[3]+N[3]*W,I},rt.distance=T,rt.squaredDistance=M,rt.length=O,rt.squaredLength=w,rt.negate=function(I,k){return I[0]=-k[0],I[1]=-k[1],I[2]=-k[2],I[3]=-k[3],I},rt.inverse=function(I,k){return I[0]=1/k[0],I[1]=1/k[1],I[2]=1/k[2],I[3]=1/k[3],I},rt.normalize=function(I,k){var N=k[0],W=k[1],Z=k[2],ee=k[3],Q=N*N+W*W+Z*Z+ee*ee;return Q>0&&(Q=1/Math.sqrt(Q)),I[0]=N*Q,I[1]=W*Q,I[2]=Z*Q,I[3]=ee*Q,I},rt.dot=function(I,k){return I[0]*k[0]+I[1]*k[1]+I[2]*k[2]+I[3]*k[3]},rt.cross=function(I,k,N,W){var Z=N[0]*W[1]-N[1]*W[0],ee=N[0]*W[2]-N[2]*W[0],Q=N[0]*W[3]-N[3]*W[0],K=N[1]*W[2]-N[2]*W[1],ie=N[1]*W[3]-N[3]*W[1],se=N[2]*W[3]-N[3]*W[2],de=k[0],we=k[1],_e=k[2],xe=k[3];return I[0]=we*se-_e*ie+xe*K,I[1]=-de*se+_e*Q-xe*ee,I[2]=de*ie-we*Q+xe*Z,I[3]=-de*K+we*ee-_e*Z,I},rt.lerp=function(I,k,N,W){var Z=k[0],ee=k[1],Q=k[2],K=k[3];return I[0]=Z+W*(N[0]-Z),I[1]=ee+W*(N[1]-ee),I[2]=Q+W*(N[2]-Q),I[3]=K+W*(N[3]-K),I},rt.random=function(I,k){var N,W,Z,ee,Q,K;k=k||1;do Q=(N=2*o.RANDOM()-1)*N+(W=2*o.RANDOM()-1)*W;while(Q>=1);do K=(Z=2*o.RANDOM()-1)*Z+(ee=2*o.RANDOM()-1)*ee;while(K>=1);var ie=Math.sqrt((1-Q)/K);return I[0]=k*N,I[1]=k*W,I[2]=k*Z*ie,I[3]=k*ee*ie,I},rt.transformMat4=function(I,k,N){var W=k[0],Z=k[1],ee=k[2],Q=k[3];return I[0]=N[0]*W+N[4]*Z+N[8]*ee+N[12]*Q,I[1]=N[1]*W+N[5]*Z+N[9]*ee+N[13]*Q,I[2]=N[2]*W+N[6]*Z+N[10]*ee+N[14]*Q,I[3]=N[3]*W+N[7]*Z+N[11]*ee+N[15]*Q,I},rt.transformQuat=function(I,k,N){var W=k[0],Z=k[1],ee=k[2],Q=N[0],K=N[1],ie=N[2],se=N[3],de=se*W+K*ee-ie*Z,we=se*Z+ie*W-Q*ee,_e=se*ee+Q*Z-K*W,xe=-Q*W-K*Z-ie*ee;return I[0]=de*se+xe*-Q+we*-ie-_e*-K,I[1]=we*se+xe*-K+_e*-Q-de*-ie,I[2]=_e*se+xe*-ie+de*-K-we*-Q,I[3]=k[3],I},rt.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=0,I},rt.str=function(I){return"vec4("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+")"},rt.exactEquals=function(I,k){return I[0]===k[0]&&I[1]===k[1]&&I[2]===k[2]&&I[3]===k[3]},rt.equals=function(I,k){var N=I[0],W=I[1],Z=I[2],ee=I[3],Q=k[0],K=k[1],ie=k[2],se=k[3];return Math.abs(N-Q)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(Q))&&Math.abs(W-K)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(K))&&Math.abs(Z-ie)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(ie))&&Math.abs(ee-se)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(se))},rt.forEach=rt.sqrLen=rt.len=rt.sqrDist=rt.dist=rt.div=rt.mul=rt.sub=void 0;var o=function(I,k){if(I&&I.__esModule)return I;if(I===null||d(I)!=="object"&&typeof I!="function")return{default:I};var N=c(void 0);if(N&&N.has(I))return N.get(I);var W={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in I)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(I,ee)){var Q=Z?Object.getOwnPropertyDescriptor(I,ee):null;Q&&(Q.get||Q.set)?Object.defineProperty(W,ee,Q):W[ee]=I[ee]}return W.default=I,N&&N.set(I,W),W}(R());function c(I){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(c=function(W){return W?N:k})(I)}function h(){var I=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[3]=0),I}function m(I,k,N){return I[0]=k[0]-N[0],I[1]=k[1]-N[1],I[2]=k[2]-N[2],I[3]=k[3]-N[3],I}function p(I,k,N){return I[0]=k[0]*N[0],I[1]=k[1]*N[1],I[2]=k[2]*N[2],I[3]=k[3]*N[3],I}function v(I,k,N){return I[0]=k[0]/N[0],I[1]=k[1]/N[1],I[2]=k[2]/N[2],I[3]=k[3]/N[3],I}function T(I,k){return Math.hypot(k[0]-I[0],k[1]-I[1],k[2]-I[2],k[3]-I[3])}function M(I,k){var N=k[0]-I[0],W=k[1]-I[1],Z=k[2]-I[2],ee=k[3]-I[3];return N*N+W*W+Z*Z+ee*ee}function O(I){return Math.hypot(I[0],I[1],I[2],I[3])}function w(I){var k=I[0],N=I[1],W=I[2],Z=I[3];return k*k+N*N+W*W+Z*Z}rt.sub=m,rt.mul=p,rt.div=v,rt.dist=T,rt.sqrDist=M,rt.len=O,rt.sqrLen=w;var P,D=(P=h(),function(I,k,N,W,Z,ee){var Q,K;for(k||(k=4),N||(N=0),K=W?Math.min(W*k+N,I.length):I.length,Q=N;Q<K;Q+=k)P[0]=I[Q],P[1]=I[Q+1],P[2]=I[Q+2],P[3]=I[Q+3],Z(P,P,ee),I[Q]=P[0],I[Q+1]=P[1],I[Q+2]=P[2],I[Q+3]=P[3];return I});return rt.forEach=D,rt}function at(){if(Je)return Ie;function d(Se){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(De){return typeof De}:function(De){return De&&typeof Symbol=="function"&&De.constructor===Symbol&&De!==Symbol.prototype?"symbol":typeof De},d(Se)}Je=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.create=T,Ie.identity=function(Se){return Se[0]=0,Se[1]=0,Se[2]=0,Se[3]=1,Se},Ie.setAxisAngle=M,Ie.getAxisAngle=function(Se,De){var Ve=2*Math.acos(De[3]),Fe=Math.sin(Ve/2);return Fe>o.EPSILON?(Se[0]=De[0]/Fe,Se[1]=De[1]/Fe,Se[2]=De[2]/Fe):(Se[0]=1,Se[1]=0,Se[2]=0),Ve},Ie.getAngle=function(Se,De){var Ve=N(Se,De);return Math.acos(2*Ve*Ve-1)},Ie.multiply=O,Ie.rotateX=function(Se,De,Ve){Ve*=.5;var Fe=De[0],Ze=De[1],He=De[2],tt=De[3],Ke=Math.sin(Ve),nt=Math.cos(Ve);return Se[0]=Fe*nt+tt*Ke,Se[1]=Ze*nt+He*Ke,Se[2]=He*nt-Ze*Ke,Se[3]=tt*nt-Fe*Ke,Se},Ie.rotateY=function(Se,De,Ve){Ve*=.5;var Fe=De[0],Ze=De[1],He=De[2],tt=De[3],Ke=Math.sin(Ve),nt=Math.cos(Ve);return Se[0]=Fe*nt-He*Ke,Se[1]=Ze*nt+tt*Ke,Se[2]=He*nt+Fe*Ke,Se[3]=tt*nt-Ze*Ke,Se},Ie.rotateZ=function(Se,De,Ve){Ve*=.5;var Fe=De[0],Ze=De[1],He=De[2],tt=De[3],Ke=Math.sin(Ve),nt=Math.cos(Ve);return Se[0]=Fe*nt+Ze*Ke,Se[1]=Ze*nt-Fe*Ke,Se[2]=He*nt+tt*Ke,Se[3]=tt*nt-He*Ke,Se},Ie.calculateW=function(Se,De){var Ve=De[0],Fe=De[1],Ze=De[2];return Se[0]=Ve,Se[1]=Fe,Se[2]=Ze,Se[3]=Math.sqrt(Math.abs(1-Ve*Ve-Fe*Fe-Ze*Ze)),Se},Ie.exp=w,Ie.ln=P,Ie.pow=function(Se,De,Ve){return P(Se,De),k(Se,Se,Ve),w(Se,Se),Se},Ie.slerp=D,Ie.random=function(Se){var De=o.RANDOM(),Ve=o.RANDOM(),Fe=o.RANDOM(),Ze=Math.sqrt(1-De),He=Math.sqrt(De);return Se[0]=Ze*Math.sin(2*Math.PI*Ve),Se[1]=Ze*Math.cos(2*Math.PI*Ve),Se[2]=He*Math.sin(2*Math.PI*Fe),Se[3]=He*Math.cos(2*Math.PI*Fe),Se},Ie.invert=function(Se,De){var Ve=De[0],Fe=De[1],Ze=De[2],He=De[3],tt=Ve*Ve+Fe*Fe+Ze*Ze+He*He,Ke=tt?1/tt:0;return Se[0]=-Ve*Ke,Se[1]=-Fe*Ke,Se[2]=-Ze*Ke,Se[3]=He*Ke,Se},Ie.conjugate=function(Se,De){return Se[0]=-De[0],Se[1]=-De[1],Se[2]=-De[2],Se[3]=De[3],Se},Ie.fromMat3=I,Ie.fromEuler=function(Se,De,Ve,Fe){var Ze=.5*Math.PI/180;De*=Ze,Ve*=Ze,Fe*=Ze;var He=Math.sin(De),tt=Math.cos(De),Ke=Math.sin(Ve),nt=Math.cos(Ve),Ct=Math.sin(Fe),At=Math.cos(Fe);return Se[0]=He*nt*At-tt*Ke*Ct,Se[1]=tt*Ke*At+He*nt*Ct,Se[2]=tt*nt*Ct-He*Ke*At,Se[3]=tt*nt*At+He*Ke*Ct,Se},Ie.str=function(Se){return"quat("+Se[0]+", "+Se[1]+", "+Se[2]+", "+Se[3]+")"},Ie.setAxes=Ie.sqlerp=Ie.rotationTo=Ie.equals=Ie.exactEquals=Ie.normalize=Ie.sqrLen=Ie.squaredLength=Ie.len=Ie.length=Ie.lerp=Ie.dot=Ie.scale=Ie.mul=Ie.add=Ie.set=Ie.copy=Ie.fromValues=Ie.clone=void 0;var o=v(R()),c=v(oe()),h=v($e()),m=v(st());function p(Se){if(typeof WeakMap!="function")return null;var De=new WeakMap,Ve=new WeakMap;return(p=function(Fe){return Fe?Ve:De})(Se)}function v(Se,De){if(Se&&Se.__esModule)return Se;if(Se===null||d(Se)!=="object"&&typeof Se!="function")return{default:Se};var Ve=p(De);if(Ve&&Ve.has(Se))return Ve.get(Se);var Fe={},Ze=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var He in Se)if(He!=="default"&&Object.prototype.hasOwnProperty.call(Se,He)){var tt=Ze?Object.getOwnPropertyDescriptor(Se,He):null;tt&&(tt.get||tt.set)?Object.defineProperty(Fe,He,tt):Fe[He]=Se[He]}return Fe.default=Se,Ve&&Ve.set(Se,Fe),Fe}function T(){var Se=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0),Se[3]=1,Se}function M(Se,De,Ve){Ve*=.5;var Fe=Math.sin(Ve);return Se[0]=Fe*De[0],Se[1]=Fe*De[1],Se[2]=Fe*De[2],Se[3]=Math.cos(Ve),Se}function O(Se,De,Ve){var Fe=De[0],Ze=De[1],He=De[2],tt=De[3],Ke=Ve[0],nt=Ve[1],Ct=Ve[2],At=Ve[3];return Se[0]=Fe*At+tt*Ke+Ze*Ct-He*nt,Se[1]=Ze*At+tt*nt+He*Ke-Fe*Ct,Se[2]=He*At+tt*Ct+Fe*nt-Ze*Ke,Se[3]=tt*At-Fe*Ke-Ze*nt-He*Ct,Se}function w(Se,De){var Ve=De[0],Fe=De[1],Ze=De[2],He=De[3],tt=Math.sqrt(Ve*Ve+Fe*Fe+Ze*Ze),Ke=Math.exp(He),nt=tt>0?Ke*Math.sin(tt)/tt:0;return Se[0]=Ve*nt,Se[1]=Fe*nt,Se[2]=Ze*nt,Se[3]=Ke*Math.cos(tt),Se}function P(Se,De){var Ve=De[0],Fe=De[1],Ze=De[2],He=De[3],tt=Math.sqrt(Ve*Ve+Fe*Fe+Ze*Ze),Ke=tt>0?Math.atan2(tt,He)/tt:0;return Se[0]=Ve*Ke,Se[1]=Fe*Ke,Se[2]=Ze*Ke,Se[3]=.5*Math.log(Ve*Ve+Fe*Fe+Ze*Ze+He*He),Se}function D(Se,De,Ve,Fe){var Ze,He,tt,Ke,nt,Ct=De[0],At=De[1],Qt=De[2],Rt=De[3],Ft=Ve[0],It=Ve[1],yr=Ve[2],Zt=Ve[3];return(He=Ct*Ft+At*It+Qt*yr+Rt*Zt)<0&&(He=-He,Ft=-Ft,It=-It,yr=-yr,Zt=-Zt),1-He>o.EPSILON?(Ze=Math.acos(He),tt=Math.sin(Ze),Ke=Math.sin((1-Fe)*Ze)/tt,nt=Math.sin(Fe*Ze)/tt):(Ke=1-Fe,nt=Fe),Se[0]=Ke*Ct+nt*Ft,Se[1]=Ke*At+nt*It,Se[2]=Ke*Qt+nt*yr,Se[3]=Ke*Rt+nt*Zt,Se}function I(Se,De){var Ve,Fe=De[0]+De[4]+De[8];if(Fe>0)Ve=Math.sqrt(Fe+1),Se[3]=.5*Ve,Se[0]=(De[5]-De[7])*(Ve=.5/Ve),Se[1]=(De[6]-De[2])*Ve,Se[2]=(De[1]-De[3])*Ve;else{var Ze=0;De[4]>De[0]&&(Ze=1),De[8]>De[3*Ze+Ze]&&(Ze=2);var He=(Ze+1)%3,tt=(Ze+2)%3;Ve=Math.sqrt(De[3*Ze+Ze]-De[3*He+He]-De[3*tt+tt]+1),Se[Ze]=.5*Ve,Se[3]=(De[3*He+tt]-De[3*tt+He])*(Ve=.5/Ve),Se[He]=(De[3*He+Ze]+De[3*Ze+He])*Ve,Se[tt]=(De[3*tt+Ze]+De[3*Ze+tt])*Ve}return Se}Ie.clone=m.clone,Ie.fromValues=m.fromValues,Ie.copy=m.copy,Ie.set=m.set,Ie.add=m.add,Ie.mul=O;var k=m.scale;Ie.scale=k;var N=m.dot;Ie.dot=N,Ie.lerp=m.lerp;var W=m.length;Ie.length=W,Ie.len=W;var Z=m.squaredLength;Ie.squaredLength=Z,Ie.sqrLen=Z;var ee=m.normalize;Ie.normalize=ee,Ie.exactEquals=m.exactEquals,Ie.equals=m.equals;var Q,K,ie,se=(Q=h.create(),K=h.fromValues(1,0,0),ie=h.fromValues(0,1,0),function(Se,De,Ve){var Fe=h.dot(De,Ve);return Fe<-.999999?(h.cross(Q,K,De),h.len(Q)<1e-6&&h.cross(Q,ie,De),h.normalize(Q,Q),M(Se,Q,Math.PI),Se):Fe>.999999?(Se[0]=0,Se[1]=0,Se[2]=0,Se[3]=1,Se):(h.cross(Q,De,Ve),Se[0]=Q[0],Se[1]=Q[1],Se[2]=Q[2],Se[3]=1+Fe,ee(Se,Se))});Ie.rotationTo=se;var de,we,_e=(de=T(),we=T(),function(Se,De,Ve,Fe,Ze,He){return D(de,De,Ze,He),D(we,Ve,Fe,He),D(Se,de,we,2*He*(1-He)),Se});Ie.sqlerp=_e;var xe,ke=(xe=c.create(),function(Se,De,Ve,Fe){return xe[0]=Ve[0],xe[3]=Ve[1],xe[6]=Ve[2],xe[1]=Fe[0],xe[4]=Fe[1],xe[7]=Fe[2],xe[2]=-De[0],xe[5]=-De[1],xe[8]=-De[2],ee(Se,I(Se,xe))});return Ie.setAxes=ke,Ie}var Be,ct={};function jt(){if(Be)return ct;function d(D){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},d(D)}Be=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.create=function(){var D=new o.ARRAY_TYPE(8);return o.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D},ct.clone=function(D){var I=new o.ARRAY_TYPE(8);return I[0]=D[0],I[1]=D[1],I[2]=D[2],I[3]=D[3],I[4]=D[4],I[5]=D[5],I[6]=D[6],I[7]=D[7],I},ct.fromValues=function(D,I,k,N,W,Z,ee,Q){var K=new o.ARRAY_TYPE(8);return K[0]=D,K[1]=I,K[2]=k,K[3]=N,K[4]=W,K[5]=Z,K[6]=ee,K[7]=Q,K},ct.fromRotationTranslationValues=function(D,I,k,N,W,Z,ee){var Q=new o.ARRAY_TYPE(8);Q[0]=D,Q[1]=I,Q[2]=k,Q[3]=N;var K=.5*W,ie=.5*Z,se=.5*ee;return Q[4]=K*N+ie*k-se*I,Q[5]=ie*N+se*D-K*k,Q[6]=se*N+K*I-ie*D,Q[7]=-K*D-ie*I-se*k,Q},ct.fromRotationTranslation=v,ct.fromTranslation=function(D,I){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=.5*I[0],D[5]=.5*I[1],D[6]=.5*I[2],D[7]=0,D},ct.fromRotation=function(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},ct.fromMat4=function(D,I){var k=c.create();h.getRotation(k,I);var N=new o.ARRAY_TYPE(3);return h.getTranslation(N,I),v(D,k,N),D},ct.copy=T,ct.identity=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},ct.set=function(D,I,k,N,W,Z,ee,Q,K){return D[0]=I,D[1]=k,D[2]=N,D[3]=W,D[4]=Z,D[5]=ee,D[6]=Q,D[7]=K,D},ct.getDual=function(D,I){return D[0]=I[4],D[1]=I[5],D[2]=I[6],D[3]=I[7],D},ct.setDual=function(D,I){return D[4]=I[0],D[5]=I[1],D[6]=I[2],D[7]=I[3],D},ct.getTranslation=function(D,I){var k=I[4],N=I[5],W=I[6],Z=I[7],ee=-I[0],Q=-I[1],K=-I[2],ie=I[3];return D[0]=2*(k*ie+Z*ee+N*K-W*Q),D[1]=2*(N*ie+Z*Q+W*ee-k*K),D[2]=2*(W*ie+Z*K+k*Q-N*ee),D},ct.translate=function(D,I,k){var N=I[0],W=I[1],Z=I[2],ee=I[3],Q=.5*k[0],K=.5*k[1],ie=.5*k[2],se=I[4],de=I[5],we=I[6],_e=I[7];return D[0]=N,D[1]=W,D[2]=Z,D[3]=ee,D[4]=ee*Q+W*ie-Z*K+se,D[5]=ee*K+Z*Q-N*ie+de,D[6]=ee*ie+N*K-W*Q+we,D[7]=-N*Q-W*K-Z*ie+_e,D},ct.rotateX=function(D,I,k){var N=-I[0],W=-I[1],Z=-I[2],ee=I[3],Q=I[4],K=I[5],ie=I[6],se=I[7],de=Q*ee+se*N+K*Z-ie*W,we=K*ee+se*W+ie*N-Q*Z,_e=ie*ee+se*Z+Q*W-K*N,xe=se*ee-Q*N-K*W-ie*Z;return c.rotateX(D,I,k),D[4]=de*(ee=D[3])+xe*(N=D[0])+we*(Z=D[2])-_e*(W=D[1]),D[5]=we*ee+xe*W+_e*N-de*Z,D[6]=_e*ee+xe*Z+de*W-we*N,D[7]=xe*ee-de*N-we*W-_e*Z,D},ct.rotateY=function(D,I,k){var N=-I[0],W=-I[1],Z=-I[2],ee=I[3],Q=I[4],K=I[5],ie=I[6],se=I[7],de=Q*ee+se*N+K*Z-ie*W,we=K*ee+se*W+ie*N-Q*Z,_e=ie*ee+se*Z+Q*W-K*N,xe=se*ee-Q*N-K*W-ie*Z;return c.rotateY(D,I,k),D[4]=de*(ee=D[3])+xe*(N=D[0])+we*(Z=D[2])-_e*(W=D[1]),D[5]=we*ee+xe*W+_e*N-de*Z,D[6]=_e*ee+xe*Z+de*W-we*N,D[7]=xe*ee-de*N-we*W-_e*Z,D},ct.rotateZ=function(D,I,k){var N=-I[0],W=-I[1],Z=-I[2],ee=I[3],Q=I[4],K=I[5],ie=I[6],se=I[7],de=Q*ee+se*N+K*Z-ie*W,we=K*ee+se*W+ie*N-Q*Z,_e=ie*ee+se*Z+Q*W-K*N,xe=se*ee-Q*N-K*W-ie*Z;return c.rotateZ(D,I,k),D[4]=de*(ee=D[3])+xe*(N=D[0])+we*(Z=D[2])-_e*(W=D[1]),D[5]=we*ee+xe*W+_e*N-de*Z,D[6]=_e*ee+xe*Z+de*W-we*N,D[7]=xe*ee-de*N-we*W-_e*Z,D},ct.rotateByQuatAppend=function(D,I,k){var N=k[0],W=k[1],Z=k[2],ee=k[3],Q=I[0],K=I[1],ie=I[2],se=I[3];return D[0]=Q*ee+se*N+K*Z-ie*W,D[1]=K*ee+se*W+ie*N-Q*Z,D[2]=ie*ee+se*Z+Q*W-K*N,D[3]=se*ee-Q*N-K*W-ie*Z,D[4]=(Q=I[4])*ee+(se=I[7])*N+(K=I[5])*Z-(ie=I[6])*W,D[5]=K*ee+se*W+ie*N-Q*Z,D[6]=ie*ee+se*Z+Q*W-K*N,D[7]=se*ee-Q*N-K*W-ie*Z,D},ct.rotateByQuatPrepend=function(D,I,k){var N=I[0],W=I[1],Z=I[2],ee=I[3],Q=k[0],K=k[1],ie=k[2],se=k[3];return D[0]=N*se+ee*Q+W*ie-Z*K,D[1]=W*se+ee*K+Z*Q-N*ie,D[2]=Z*se+ee*ie+N*K-W*Q,D[3]=ee*se-N*Q-W*K-Z*ie,D[4]=N*(se=k[7])+ee*(Q=k[4])+W*(ie=k[6])-Z*(K=k[5]),D[5]=W*se+ee*K+Z*Q-N*ie,D[6]=Z*se+ee*ie+N*K-W*Q,D[7]=ee*se-N*Q-W*K-Z*ie,D},ct.rotateAroundAxis=function(D,I,k,N){if(Math.abs(N)<o.EPSILON)return T(D,I);var W=Math.hypot(k[0],k[1],k[2]);N*=.5;var Z=Math.sin(N),ee=Z*k[0]/W,Q=Z*k[1]/W,K=Z*k[2]/W,ie=Math.cos(N),se=I[0],de=I[1],we=I[2],_e=I[3];D[0]=se*ie+_e*ee+de*K-we*Q,D[1]=de*ie+_e*Q+we*ee-se*K,D[2]=we*ie+_e*K+se*Q-de*ee,D[3]=_e*ie-se*ee-de*Q-we*K;var xe=I[4],ke=I[5],Se=I[6],De=I[7];return D[4]=xe*ie+De*ee+ke*K-Se*Q,D[5]=ke*ie+De*Q+Se*ee-xe*K,D[6]=Se*ie+De*K+xe*Q-ke*ee,D[7]=De*ie-xe*ee-ke*Q-Se*K,D},ct.add=function(D,I,k){return D[0]=I[0]+k[0],D[1]=I[1]+k[1],D[2]=I[2]+k[2],D[3]=I[3]+k[3],D[4]=I[4]+k[4],D[5]=I[5]+k[5],D[6]=I[6]+k[6],D[7]=I[7]+k[7],D},ct.multiply=M,ct.scale=function(D,I,k){return D[0]=I[0]*k,D[1]=I[1]*k,D[2]=I[2]*k,D[3]=I[3]*k,D[4]=I[4]*k,D[5]=I[5]*k,D[6]=I[6]*k,D[7]=I[7]*k,D},ct.lerp=function(D,I,k,N){var W=1-N;return O(I,k)<0&&(N=-N),D[0]=I[0]*W+k[0]*N,D[1]=I[1]*W+k[1]*N,D[2]=I[2]*W+k[2]*N,D[3]=I[3]*W+k[3]*N,D[4]=I[4]*W+k[4]*N,D[5]=I[5]*W+k[5]*N,D[6]=I[6]*W+k[6]*N,D[7]=I[7]*W+k[7]*N,D},ct.invert=function(D,I){var k=P(I);return D[0]=-I[0]/k,D[1]=-I[1]/k,D[2]=-I[2]/k,D[3]=I[3]/k,D[4]=-I[4]/k,D[5]=-I[5]/k,D[6]=-I[6]/k,D[7]=I[7]/k,D},ct.conjugate=function(D,I){return D[0]=-I[0],D[1]=-I[1],D[2]=-I[2],D[3]=I[3],D[4]=-I[4],D[5]=-I[5],D[6]=-I[6],D[7]=I[7],D},ct.normalize=function(D,I){var k=P(I);if(k>0){k=Math.sqrt(k);var N=I[0]/k,W=I[1]/k,Z=I[2]/k,ee=I[3]/k,Q=I[4],K=I[5],ie=I[6],se=I[7],de=N*Q+W*K+Z*ie+ee*se;D[0]=N,D[1]=W,D[2]=Z,D[3]=ee,D[4]=(Q-N*de)/k,D[5]=(K-W*de)/k,D[6]=(ie-Z*de)/k,D[7]=(se-ee*de)/k}return D},ct.str=function(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"},ct.exactEquals=function(D,I){return D[0]===I[0]&&D[1]===I[1]&&D[2]===I[2]&&D[3]===I[3]&&D[4]===I[4]&&D[5]===I[5]&&D[6]===I[6]&&D[7]===I[7]},ct.equals=function(D,I){var k=D[0],N=D[1],W=D[2],Z=D[3],ee=D[4],Q=D[5],K=D[6],ie=D[7],se=I[0],de=I[1],we=I[2],_e=I[3],xe=I[4],ke=I[5],Se=I[6],De=I[7];return Math.abs(k-se)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(se))&&Math.abs(N-de)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(de))&&Math.abs(W-we)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(we))&&Math.abs(Z-_e)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(_e))&&Math.abs(ee-xe)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(xe))&&Math.abs(Q-ke)<=o.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ke))&&Math.abs(K-Se)<=o.EPSILON*Math.max(1,Math.abs(K),Math.abs(Se))&&Math.abs(ie-De)<=o.EPSILON*Math.max(1,Math.abs(ie),Math.abs(De))},ct.sqrLen=ct.squaredLength=ct.len=ct.length=ct.dot=ct.mul=ct.setReal=ct.getReal=void 0;var o=p(R()),c=p(at()),h=p(ve());function m(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,k=new WeakMap;return(m=function(N){return N?k:I})(D)}function p(D,I){if(D&&D.__esModule)return D;if(D===null||d(D)!=="object"&&typeof D!="function")return{default:D};var k=m(I);if(k&&k.has(D))return k.get(D);var N={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in D)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(D,Z)){var ee=W?Object.getOwnPropertyDescriptor(D,Z):null;ee&&(ee.get||ee.set)?Object.defineProperty(N,Z,ee):N[Z]=D[Z]}return N.default=D,k&&k.set(D,N),N}function v(D,I,k){var N=.5*k[0],W=.5*k[1],Z=.5*k[2],ee=I[0],Q=I[1],K=I[2],ie=I[3];return D[0]=ee,D[1]=Q,D[2]=K,D[3]=ie,D[4]=N*ie+W*K-Z*Q,D[5]=W*ie+Z*ee-N*K,D[6]=Z*ie+N*Q-W*ee,D[7]=-N*ee-W*Q-Z*K,D}function T(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D[4]=I[4],D[5]=I[5],D[6]=I[6],D[7]=I[7],D}function M(D,I,k){var N=I[0],W=I[1],Z=I[2],ee=I[3],Q=k[4],K=k[5],ie=k[6],se=k[7],de=I[4],we=I[5],_e=I[6],xe=I[7],ke=k[0],Se=k[1],De=k[2],Ve=k[3];return D[0]=N*Ve+ee*ke+W*De-Z*Se,D[1]=W*Ve+ee*Se+Z*ke-N*De,D[2]=Z*Ve+ee*De+N*Se-W*ke,D[3]=ee*Ve-N*ke-W*Se-Z*De,D[4]=N*se+ee*Q+W*ie-Z*K+de*Ve+xe*ke+we*De-_e*Se,D[5]=W*se+ee*K+Z*Q-N*ie+we*Ve+xe*Se+_e*ke-de*De,D[6]=Z*se+ee*ie+N*K-W*Q+_e*Ve+xe*De+de*Se-we*ke,D[7]=ee*se-N*Q-W*K-Z*ie+xe*Ve-de*ke-we*Se-_e*De,D}ct.getReal=c.copy,ct.setReal=c.copy,ct.mul=M;var O=c.dot;ct.dot=O;var w=c.length;ct.length=w,ct.len=w;var P=c.squaredLength;return ct.squaredLength=P,ct.sqrLen=P,ct}var Lt,$t,ut={};function tr(){if(Lt)return ut;function d(I){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},d(I)}Lt=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.create=h,ut.clone=function(I){var k=new o.ARRAY_TYPE(2);return k[0]=I[0],k[1]=I[1],k},ut.fromValues=function(I,k){var N=new o.ARRAY_TYPE(2);return N[0]=I,N[1]=k,N},ut.copy=function(I,k){return I[0]=k[0],I[1]=k[1],I},ut.set=function(I,k,N){return I[0]=k,I[1]=N,I},ut.add=function(I,k,N){return I[0]=k[0]+N[0],I[1]=k[1]+N[1],I},ut.subtract=m,ut.multiply=p,ut.divide=v,ut.ceil=function(I,k){return I[0]=Math.ceil(k[0]),I[1]=Math.ceil(k[1]),I},ut.floor=function(I,k){return I[0]=Math.floor(k[0]),I[1]=Math.floor(k[1]),I},ut.min=function(I,k,N){return I[0]=Math.min(k[0],N[0]),I[1]=Math.min(k[1],N[1]),I},ut.max=function(I,k,N){return I[0]=Math.max(k[0],N[0]),I[1]=Math.max(k[1],N[1]),I},ut.round=function(I,k){return I[0]=Math.round(k[0]),I[1]=Math.round(k[1]),I},ut.scale=function(I,k,N){return I[0]=k[0]*N,I[1]=k[1]*N,I},ut.scaleAndAdd=function(I,k,N,W){return I[0]=k[0]+N[0]*W,I[1]=k[1]+N[1]*W,I},ut.distance=T,ut.squaredDistance=M,ut.length=O,ut.squaredLength=w,ut.negate=function(I,k){return I[0]=-k[0],I[1]=-k[1],I},ut.inverse=function(I,k){return I[0]=1/k[0],I[1]=1/k[1],I},ut.normalize=function(I,k){var N=k[0],W=k[1],Z=N*N+W*W;return Z>0&&(Z=1/Math.sqrt(Z)),I[0]=k[0]*Z,I[1]=k[1]*Z,I},ut.dot=function(I,k){return I[0]*k[0]+I[1]*k[1]},ut.cross=function(I,k,N){var W=k[0]*N[1]-k[1]*N[0];return I[0]=I[1]=0,I[2]=W,I},ut.lerp=function(I,k,N,W){var Z=k[0],ee=k[1];return I[0]=Z+W*(N[0]-Z),I[1]=ee+W*(N[1]-ee),I},ut.random=function(I,k){k=k||1;var N=2*o.RANDOM()*Math.PI;return I[0]=Math.cos(N)*k,I[1]=Math.sin(N)*k,I},ut.transformMat2=function(I,k,N){var W=k[0],Z=k[1];return I[0]=N[0]*W+N[2]*Z,I[1]=N[1]*W+N[3]*Z,I},ut.transformMat2d=function(I,k,N){var W=k[0],Z=k[1];return I[0]=N[0]*W+N[2]*Z+N[4],I[1]=N[1]*W+N[3]*Z+N[5],I},ut.transformMat3=function(I,k,N){var W=k[0],Z=k[1];return I[0]=N[0]*W+N[3]*Z+N[6],I[1]=N[1]*W+N[4]*Z+N[7],I},ut.transformMat4=function(I,k,N){var W=k[0],Z=k[1];return I[0]=N[0]*W+N[4]*Z+N[12],I[1]=N[1]*W+N[5]*Z+N[13],I},ut.rotate=function(I,k,N,W){var Z=k[0]-N[0],ee=k[1]-N[1],Q=Math.sin(W),K=Math.cos(W);return I[0]=Z*K-ee*Q+N[0],I[1]=Z*Q+ee*K+N[1],I},ut.angle=function(I,k){var N=I[0],W=I[1],Z=k[0],ee=k[1],Q=Math.sqrt(N*N+W*W)*Math.sqrt(Z*Z+ee*ee);return Math.acos(Math.min(Math.max(Q&&(N*Z+W*ee)/Q,-1),1))},ut.zero=function(I){return I[0]=0,I[1]=0,I},ut.str=function(I){return"vec2("+I[0]+", "+I[1]+")"},ut.exactEquals=function(I,k){return I[0]===k[0]&&I[1]===k[1]},ut.equals=function(I,k){var N=I[0],W=I[1],Z=k[0],ee=k[1];return Math.abs(N-Z)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(Z))&&Math.abs(W-ee)<=o.EPSILON*Math.max(1,Math.abs(W),Math.abs(ee))},ut.forEach=ut.sqrLen=ut.sqrDist=ut.dist=ut.div=ut.mul=ut.sub=ut.len=void 0;var o=function(I,k){if(I&&I.__esModule)return I;if(I===null||d(I)!=="object"&&typeof I!="function")return{default:I};var N=c(void 0);if(N&&N.has(I))return N.get(I);var W={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in I)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(I,ee)){var Q=Z?Object.getOwnPropertyDescriptor(I,ee):null;Q&&(Q.get||Q.set)?Object.defineProperty(W,ee,Q):W[ee]=I[ee]}return W.default=I,N&&N.set(I,W),W}(R());function c(I){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(c=function(W){return W?N:k})(I)}function h(){var I=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0),I}function m(I,k,N){return I[0]=k[0]-N[0],I[1]=k[1]-N[1],I}function p(I,k,N){return I[0]=k[0]*N[0],I[1]=k[1]*N[1],I}function v(I,k,N){return I[0]=k[0]/N[0],I[1]=k[1]/N[1],I}function T(I,k){return Math.hypot(k[0]-I[0],k[1]-I[1])}function M(I,k){var N=k[0]-I[0],W=k[1]-I[1];return N*N+W*W}function O(I){return Math.hypot(I[0],I[1])}function w(I){var k=I[0],N=I[1];return k*k+N*N}ut.len=O,ut.sub=m,ut.mul=p,ut.div=v,ut.dist=T,ut.sqrDist=M,ut.sqrLen=w;var P,D=(P=h(),function(I,k,N,W,Z,ee){var Q,K;for(k||(k=2),N||(N=0),K=W?Math.min(W*k+N,I.length):I.length,Q=N;Q<K;Q+=k)P[0]=I[Q],P[1]=I[Q+1],Z(P,P,ee),I[Q]=P[0],I[Q+1]=P[1];return I});return ut.forEach=D,ut}function mr(){if($t)return E;function d(I){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},d(I)}$t=1,Object.defineProperty(E,"__esModule",{value:!0}),E.vec4=E.vec3=E.vec2=E.quat2=E.quat=E.mat4=E.mat3=E.mat2d=E.mat2=E.glMatrix=void 0;var o=D(R());E.glMatrix=o;var c=D($());E.mat2=c;var h=D(G());E.mat2d=h;var m=D(oe());E.mat3=m;var p=D(ve());E.mat4=p;var v=D(at());E.quat=v;var T=D(jt());E.quat2=T;var M=D(tr());E.vec2=M;var O=D($e());E.vec3=O;var w=D(st());function P(I){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(P=function(W){return W?N:k})(I)}function D(I,k){if(I&&I.__esModule)return I;if(I===null||d(I)!=="object"&&typeof I!="function")return{default:I};var N=P(k);if(N&&N.has(I))return N.get(I);var W={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in I)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(I,ee)){var Q=Z?Object.getOwnPropertyDescriptor(I,ee):null;Q&&(Q.get||Q.set)?Object.defineProperty(W,ee,Q):W[ee]=I[ee]}return W.default=I,N&&N.set(I,W),W}return E.vec4=w,E}var rr,Ut,gr,Gt,ge=mr(),cr=function(){if(Ut)return rr;function d(o,c,h,m){this.cx=3*o,this.bx=3*(h-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(m-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=c,this.p2x=h,this.p2y=m}return Ut=1,rr=d,d.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,c){if(c===void 0&&(c=1e-6),o<0)return 0;if(o>1)return 1;for(var h=o,m=0;m<8;m++){var p=this.sampleCurveX(h)-o;if(Math.abs(p)<c)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=p/v}var T=0,M=1;for(h=o,m=0;m<20&&(p=this.sampleCurveX(h),!(Math.abs(p-o)<c));m++)o>p?T=h:M=h,h=.5*(M-T)+T;return h},solve:function(o,c){return this.sampleCurveY(this.solveCurveX(o,c))}},rr}(),Ot=_(cr);function Pr(){if(Gt)return gr;function d(o,c){this.x=o,this.y=c}return Gt=1,gr=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,c){return this.clone()._rotateAround(o,c)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var c=o.x-this.x,h=o.y-this.y;return c*c+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,c){return Math.atan2(this.x*c-this.y*o,this.x*o+this.y*c)},_matMult:function(o){var c=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=c,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var c=Math.cos(o),h=Math.sin(o),m=h*this.x+c*this.y;return this.x=c*this.x-h*this.y,this.y=m,this},_rotateAround:function(o,c){var h=Math.cos(o),m=Math.sin(o),p=c.y+m*(this.x-c.x)+h*(this.y-c.y);return this.x=c.x+h*(this.x-c.x)-m*(this.y-c.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(o){return o instanceof d?o:Array.isArray(o)?new d(o[0],o[1]):o},gr}var _t=_(Pr());function hn(d,o){if(Array.isArray(d)){if(!Array.isArray(o)||d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(!hn(d[c],o[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&o!==null){if(typeof o!="object"||Object.keys(d).length!==Object.keys(o).length)return!1;for(const c in d)if(!hn(d[c],o[c]))return!1;return!0}return d===o}const qr=Math.PI/180,Ln=180/Math.PI;function Ge(d){return d*qr}function vt(d){return d*Ln}const kt=[[0,0],[1,0],[1,1],[0,1]];function dr(d){if(d<=0)return 0;if(d>=1)return 1;const o=d*d,c=o*d;return 4*(d<.5?c:3*(d-o)+c-.75)}function lr(d,o,c,h){const m=new Ot(d,o,c,h);return function(p){return m.solve(p)}}const sr=lr(.25,.1,.25,1);function Kt(d,o,c){return Math.min(c,Math.max(o,d))}function Zr(d,o,c){return(c=Kt((c-d)/(o-d),0,1))*c*(3-2*c)}function fi(d,o,c){const h=c-o,m=((d-o)%h+h)%h+o;return m===o?c:m}function Qn(d,o,c){if(!d.length)return c(null,[]);let h=d.length;const m=new Array(d.length);let p=null;d.forEach((v,T)=>{o(v,(M,O)=>{M&&(p=M),m[T]=O,--h==0&&c(p,m)})})}function Pi(d,...o){for(const c of o)for(const h in c)d[h]=c[h];return d}let qo=1;function na(){return qo++}function yl(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function Ql(d,o){d.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function ls(d,o,c){const h={};for(const m in d)h[m]=o.call(this,d[m],m,d);return h}function vl(d,o,c){const h={};for(const m in d)o.call(this,d[m],m,d)&&(h[m]=d[m]);return h}function Co(d){return Array.isArray(d)?d.map(Co):typeof d=="object"&&d?ls(d,Co):d}const Ia={};function pi(d){Ia[d]||(typeof console<"u"&&console.warn(d),Ia[d]=!0)}function wr(d,o,c){return(c.y-d.y)*(o.x-d.x)>(o.y-d.y)*(c.x-d.x)}function mi(d){let o=0;for(let c,h,m=0,p=d.length,v=p-1;m<p;v=m++)c=d[m],h=d[v],o+=(h.x-c.x)*(c.y+h.y);return o}function ei([d,o,c]){const h=Ge(o+90),m=Ge(c);return{x:d*Math.cos(h)*Math.sin(m),y:d*Math.sin(h)*Math.sin(m),z:d*Math.cos(m),azimuthal:o,polar:c}}function Li(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ho(d){const o={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,h,m,p)=>{const v=m||p;return o[h]=!v||v.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o}let ec=null;function Fu(d,o){return[d[4*o],d[4*o+1],d[4*o+2],d[4*o+3]]}function Wy(d,o,c,h){for(;o<c;){const m=o+c>>1;d[m]<h?o=m+1:c=m}return o}function Gy(d,o,c,h){for(;o<c;){const m=o+c>>1;d[m]<=h?o=m+1:c=m}return o}function Cm(d){return d>0?1/(1.001-d):1+d}function mt(d){return d>0?1-1/(1.001-d):-d}const pe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!pe.API_URL)return null;try{const d=new URL(pe.API_URL);return d.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":d.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ye(d){return pe.API_URL_REGEX.test(d)}function Ae(d){return pe.API_SPRITE_REGEX.test(d)}let je,Le,qe,lt,Xe,ft;function yt(){return je==null&&(je=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),je}const pt={now:()=>lt!==void 0?lt:performance.now(),setNow(d){lt=d},restoreNow(){lt=void 0},frame(d){const o=requestAnimationFrame(d);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(d,o=0){const{width:c,height:h}=d;Xe||(Xe=document.createElement("canvas"));const m=Xe.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>Xe.width||h>Xe.height)&&(Xe.width=c,Xe.height=h),m.clearRect(-o,-o,c+2*o,h+2*o),m.drawImage(d,0,0,c,h),m.getImageData(-o,-o,c+2*o,h+2*o)},resolveURL:d=>(Le||(Le=document.createElement("a")),Le.href=d,Le.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(qe==null&&(qe=window.matchMedia("(prefers-reduced-motion: reduce)")),qe.matches)},hasCanvasFingerprintNoise(){if(ft!==void 0)return ft;if(!yt())return ft=!1,!1;const d=new OffscreenCanvas(85,1),o=d.getContext("2d",{willReadFrequently:!0});let c=0;for(let m=0;m<d.width;++m)o.fillStyle=`rgba(${c++},${c++},${c++}, 255)`,o.fillRect(m,0,1,1);const h=o.getImageData(0,0,d.width,d.height);c=0;for(let m=0;m<h.data.length;++m)if(m%4!=3&&c++!==h.data[m])return ft=!0,!0;return ft=!1,!1}};function Nt(d,o){const c=d.indexOf("?");if(c<0)return`${d}?${new URLSearchParams(o).toString()}`;const h=new URLSearchParams(d.slice(c));for(const m in o)h.set(m,o[m]);return`${d.slice(0,c)}?${h.toString()}`}function Xt(d,o={persistentParams:[]}){const c=d.indexOf("?");if(c<0)return d;const h=new URLSearchParams,m=new URLSearchParams(d.slice(c));for(const v of o.persistentParams){const T=m.get(v);T&&h.set(v,T)}const p=h.toString();return`${d.slice(0,c)}${p.length>0?`?${p}`:""}`}const er="mapbox-tiles";let Rr=500,Br=50;const $r=["language","worldview","jobid"];let Gr,Gn;function _i(){try{return caches}catch{}}function Jr(){const d=_i();d&&Gr==null&&(Gr=d.open(er))}let Tn=1/0;const En={supported:!1,testSupport:function(d){!Po&&Ni&&(ia?_a(d):Pn=d)}};let Pn,Ni,Po=!1,ia=!1;const Ns=typeof self<"u"?self:{};function _a(d){const o=d.createTexture();d.bindTexture(d.TEXTURE_2D,o);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,Ni),d.isContextLost())return;En.supported=!0}catch{}d.deleteTexture(o),Po=!0}Ns.document&&(Ni=Ns.document.createElement("img"),Ni.onload=function(){Pn&&_a(Pn),Pn=null,ia=!0},Ni.onerror=function(){Po=!0,Pn=null},Ni.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Io={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Io);class Fo extends Error{constructor(o,c,h){c===401&&ye(h)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=c,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const rf=Li()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,zs=function(d,o){if(!(/^file:/.test(c=d.url)||/^file:/.test(rf())&&!/^\w+:/.test(c))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,m){const p=new AbortController,v=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:rf(),referrerPolicy:h.referrerPolicy,signal:p.signal});let T=!1,M=!1;const O=(w=v.url).indexOf("sku=")>0&&ye(w);var w;h.type==="json"&&v.headers.set("Accept","application/json");const P=(I,k,N)=>{if(M)return;if(I&&I.message!=="SecurityError"&&pi(I.toString()),k&&N)return D(k);const W=Date.now();fetch(v).then(Z=>{if(Z.ok){const ee=O?Z.clone():null;return D(Z,ee,W)}return m(new Fo(Z.statusText,Z.status,h.url))}).catch(Z=>{Z.name!=="AbortError"&&m(new Error(`${Z.message} ${h.url}`))})},D=(I,k,N)=>{(h.type==="arrayBuffer"?I.arrayBuffer():h.type==="json"?I.json():I.text()).then(W=>{M||(k&&N&&function(Z,ee,Q){if(Jr(),Gr==null)return;const K=Ho(ee.headers.get("Cache-Control")||"");if(K["no-store"])return;const ie={status:ee.status,statusText:ee.statusText,headers:new Headers};ee.headers.forEach((we,_e)=>ie.headers.set(_e,we)),K["max-age"]&&ie.headers.set("Expires",new Date(Q+1e3*K["max-age"]).toUTCString());const se=ie.headers.get("Expires");if(!se||new Date(se).getTime()-Q<42e4)return;let de=Xt(Z.url,{persistentParams:$r});if(ee.status===206){const we=Z.headers.get("Range");if(!we)return;ie.status=200,de=Nt(de,{range:we})}(function(we,_e){if(Gn===void 0)try{new Response(new ReadableStream),Gn=!0}catch{Gn=!1}Gn?_e(we.body):we.blob().then(_e)})(ee,we=>{const _e=new Response((xe=ee.status)!==200&&xe!==404&&[101,103,204,205,304].includes(xe)?null:we,ie);var xe;Jr(),Gr!=null&&Gr.then(ke=>ke.put(de,_e)).catch(ke=>pi(ke.message))})}(v,k,N),T=!0,m(null,W,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(W=>{M||m(new Error(W.message))})};return O?function(I,k){if(Jr(),Gr==null)return k(null);Gr.then(N=>{let W=Xt(I.url,{persistentParams:$r});const Z=I.headers.get("Range");Z&&(W=Nt(W,{range:Z})),N.match(W).then(ee=>{const Q=function(K){if(!K)return!1;const ie=new Date(K.headers.get("Expires")||0),se=Ho(K.headers.get("Cache-Control")||"");return ie>Date.now()&&!se["no-cache"]}(ee);N.delete(W),Q&&N.put(W,ee.clone()),k(null,ee,Q)}).catch(k)}).catch(k)}(v,P):P(null,null),{cancel:()=>{M=!0,T||p.abort()}}}(d,o);if(Li()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",d,o,void 0,!0)}var c;return function(h,m){const p=new XMLHttpRequest;p.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const v in h.headers)p.setRequestHeader(v,h.headers[v]);return h.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=h.credentials==="include",p.onerror=()=>{m(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let v=p.response;if(h.type==="json")try{v=JSON.parse(p.response)}catch(T){return m(T)}m(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else m(new Fo(p.statusText,p.status,h.url))},p.send(h.body),{cancel:()=>p.abort()}}(d,o)},Rc=function(d,o){return zs(Pi(d,{type:"arrayBuffer"}),o)};function rb(d){const o=document.createElement("a");return o.href=d,o.protocol===location.protocol&&o.host===location.host}const qy="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Pm,nf;Pm=[],nf=0;const nb=function(d,o){if(En.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),nf>=pe.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:d,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Pm.push(p),p}nf++;let c=!1;const h=()=>{if(!c)for(c=!0,nf--;Pm.length&&nf<pe.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Pm.shift(),{requestParameters:v,callback:T,cancelled:M}=p;M||(p.cancel=nb(v,T).cancel)}},m=Rc(d,(p,v,T,M)=>{h(),p?o(p):v&&(self.createImageBitmap?function(O,w){const P=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(P).then(D=>{w(null,D)}).catch(D=>{w(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(O,w)=>o(O,w,T,M)):function(O,w){const P=new Image;P.onload=()=>{w(null,P),URL.revokeObjectURL(P.src),P.onload=null,requestAnimationFrame(()=>{P.src=qy})},P.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(O)],{type:"image/png"});P.src=O.byteLength?URL.createObjectURL(D):qy}(v,(O,w)=>o(O,w,T,M)))});return{cancel:()=>{m.cancel(),h()}}};var UE,VE,ib,of={exports:{}},cs={exports:{}},_l={exports:{}},Bu=function(){if(ib)return of.exports;ib=1;var d=(UE||(UE=1,cs.exports=function(c,h){var m,p,v,T,M,O,w,P;for(p=c.length-(m=3&c.length),v=h,M=3432918353,O=461845907,P=0;P<p;)w=255&c.charCodeAt(P)|(255&c.charCodeAt(++P))<<8|(255&c.charCodeAt(++P))<<16|(255&c.charCodeAt(++P))<<24,++P,v=27492+(65535&(T=5*(65535&(v=(v^=w=(65535&(w=(w=(65535&w)*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*O+(((w>>>16)*O&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(w=0,m){case 3:w^=(255&c.charCodeAt(P+2))<<16;case 2:w^=(255&c.charCodeAt(P+1))<<8;case 1:v^=w=(65535&(w=(w=(65535&(w^=255&c.charCodeAt(P)))*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*O+(((w>>>16)*O&65535)<<16)&4294967295}return v^=c.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),cs.exports),o=(VE||(VE=1,_l.exports=function(c,h){for(var m,p=c.length,v=h^p,T=0;p>=4;)m=1540483477*(65535&(m=255&c.charCodeAt(T)|(255&c.charCodeAt(++T))<<8|(255&c.charCodeAt(++T))<<16|(255&c.charCodeAt(++T))<<24))+((1540483477*(m>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),p-=4,++T;switch(p){case 3:v^=(255&c.charCodeAt(T+2))<<16;case 2:v^=(255&c.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&c.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),_l.exports);return of.exports=d,of.exports.murmur3=d,of.exports.murmur2=o,of.exports}(),us=_(Bu);class Ua{constructor(o,...c){Pi(this,c[0]||{}),this.type=o}}class af extends Ua{constructor(o,c={}){super("error",Pi({error:o},c))}}function ob(d,o,c){c[d]&&c[d].indexOf(o)!==-1||(c[d]=c[d]||[],c[d].push(o))}function Hy(d,o,c){if(c&&c[d]){const h=c[d].indexOf(o);h!==-1&&c[d].splice(h,1)}}class xl{on(o,c){return this._listeners=this._listeners||{},ob(o,c,this._listeners),this}off(o,c){return Hy(o,c,this._listeners),Hy(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},ob(o,c,this._oneTimeListeners),this):new Promise(h=>{this.once(o,h)})}fire(o,c){const h=typeof o=="string"?new Ua(o,c):o,m=h.type;if(this.listens(m)){h.target=this;const p=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const M of p)M.call(this,h);const v=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const M of v)Hy(m,M,this._oneTimeListeners),M.call(this,h);const T=this._eventedParent;T&&(Pi(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(h))}else h instanceof af&&console.error(h.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}class Oa{constructor(o){typeof o=="string"?this.name=o:(this.name=o.name,this.iconsetId=o.iconsetId)}static from(o){return new Oa(o)}static toString(o){return o.iconsetId?`${o.name}${o.iconsetId}`:o.name}static parse(o){const[c,h]=o.split("");return new Oa({name:c,iconsetId:h})}static isEqual(o,c){return o.name===c.name&&o.iconsetId===c.iconsetId}toString(){return Oa.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var WE,ab={},js=function(){if(WE)return ab;WE=1;var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(p){return(p=Math.round(p))<0?0:p>255?255:p}function c(p){return o(p[p.length-1]==="%"?parseFloat(p)/100*255:parseInt(p))}function h(p){return(v=p[p.length-1]==="%"?parseFloat(p)/100:parseFloat(p))<0?0:v>1?1:v;var v}function m(p,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?p+(v-p)*T*6:2*T<1?v:3*T<2?p+(v-p)*(2/3-T)*6:p}try{ab.parseCSSColor=function(p){var v,T=p.replace(/ /g,"").toLowerCase();if(T in d)return d[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var M=T.indexOf("("),O=T.indexOf(")");if(M!==-1&&O+1===T.length){var w=T.substr(0,M),P=T.substr(M+1,O-(M+1)).split(","),D=1;switch(w){case"rgba":if(P.length!==4)return null;D=h(P.pop());case"rgb":return P.length!==3?null:[c(P[0]),c(P[1]),c(P[2]),D];case"hsla":if(P.length!==4)return null;D=h(P.pop());case"hsl":if(P.length!==3)return null;var I=(parseFloat(P[0])%360+360)%360/360,k=h(P[1]),N=h(P[2]),W=N<=.5?N*(k+1):N+k-N*k,Z=2*N-W;return[o(255*m(Z,W,I+1/3)),o(255*m(Z,W,I)),o(255*m(Z,W,I-1/3)),D];default:return null}}return null}}catch{}return ab}();class An{constructor(o,c,h,m=1){this.r=o,this.g=c,this.b=h,this.a=m}static parse(o){if(!o)return;if(o instanceof An)return o;if(typeof o!="string")return;const c=js.parseCSSColor(o);return c?new An(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toStringPremultipliedAlpha(){const[o,c,h,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(c)},${Math.round(h)},${m})`}toString(){const[o,c,h,m]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*c)},${Math.round(255*h)},${m})`}toRenderColor(o){const{r:c,g:h,b:m,a:p}=this;return new sb(o,c,h,m,p)}clone(){return new An(this.r,this.g,this.b,this.a)}}class sb{constructor(o,c,h,m,p){if(o){const v=o.image.height,T=v*v;c=p===0?0:c/p*(v-1),h=p===0?0:h/p*(v-1),m=p===0?0:m/p*(v-1);const M=Math.floor(c),O=Math.floor(h),w=Math.floor(m),P=Math.ceil(c),D=Math.ceil(h),I=Math.ceil(m),k=c-M,N=h-O,W=m-w,Z=o.image.data,ee=4*(M+O*T+w*v),Q=4*(M+O*T+I*v),K=4*(M+D*T+w*v),ie=4*(M+D*T+I*v),se=4*(P+O*T+w*v),de=4*(P+O*T+I*v),we=4*(P+D*T+w*v),_e=4*(P+D*T+I*v);if(ee<0||_e>=Z.length)throw new Error("out of range");this.r=_r(_r(_r(Z[ee],Z[Q],W),_r(Z[K],Z[ie],W),N),_r(_r(Z[se],Z[de],W),_r(Z[we],Z[_e],W),N),k)/255*p,this.g=_r(_r(_r(Z[ee+1],Z[Q+1],W),_r(Z[K+1],Z[ie+1],W),N),_r(_r(Z[se+1],Z[de+1],W),_r(Z[we+1],Z[_e+1],W),N),k)/255*p,this.b=_r(_r(_r(Z[ee+2],Z[Q+2],W),_r(Z[K+2],Z[ie+2],W),N),_r(_r(Z[se+2],Z[de+2],W),_r(Z[we+2],Z[_e+2],W),N),k)/255*p,this.a=p}else this.r=c,this.g=h,this.b=m,this.a=p}toArray(){const{r:o,g:c,b:h,a:m}=this;return m===0?[0,0,0,0]:[255*o/m,255*c/m,255*h/m,m]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:o,g:c,b:h,a:m}=this,p=Math.min(Math.max(o/m,0),1),v=Math.min(Math.max(c/m,0),1),T=Math.min(Math.max(h/m,0),1),M=Math.min(p,v,T),O=Math.max(p,v,T),w=(M+O)/2;if(M===O)return[0,0,100*w,m];const P=O-M,D=w>.5?P/(2-O-M):P/(O+M);let I=0;return O===p?I=(v-T)/P+(v<T?6:0):O===v?I=(T-p)/P+2:O===T&&(I=(p-v)/P+4),I*=60,[Math.min(Math.max(I,0),360),Math.min(Math.max(100*D,0),100),Math.min(Math.max(100*w,0),100),m]}toArray01(){const{r:o,g:c,b:h,a:m}=this;return m===0?[0,0,0,0]:[o/m,c/m,h/m,m]}toArray01Scaled(o){const{r:c,g:h,b:m,a:p}=this;return p===0?[0,0,0]:[c/p*o,h/p*o,m/p*o]}toArray01PremultipliedAlpha(){const{r:o,g:c,b:h,a:m}=this;return[o,c,h,m]}toArray01Linear(){const{r:o,g:c,b:h,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(o/m,2.2),Math.pow(c/m,2.2),Math.pow(h/m,2.2),m]}}function _r(d,o,c){return d*(1-c)+o*c}function GE(d,o,c){return d.map((h,m)=>_r(h,o[m],c))}function qE(d){return d*d*d*d*d}An.black=new An(0,0,0,1),An.white=new An(1,1,1,1),An.transparent=new An(0,0,0,0),An.red=new An(1,0,0,1),An.blue=new An(0,0,1,1);var Im=Object.freeze({__proto__:null,array:GE,color:function(d,o,c){return new An(_r(d.r,o.r,c),_r(d.g,o.g,c),_r(d.b,o.b,c),_r(d.a,o.a,c))},easeIn:qE,number:_r});function fn(d,...o){for(const c of o)for(const h in c)d[h]=c[h];return d}class Fs extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}class Zy{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[h,m]of c)this.bindings[h]=m}concat(o){return new Zy(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const sf={kind:"null"},ar={kind:"number"},wn={kind:"string"},ln={kind:"boolean"},oa={kind:"color"},lf={kind:"object"},pn={kind:"value"},Dc={kind:"collator"},Om={kind:"formatted"},Lc={kind:"resolvedImage"};function Zo(d,o){return{kind:"array",itemType:d,N:o}}function zi(d){if(d.kind==="array"){const o=zi(d.itemType);return typeof d.N=="number"?`array<${o}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${o}>`}return d.kind}const bl=[sf,ar,wn,ln,oa,Om,lf,Zo(pn),Lc];function cf(d,o){if(o.kind==="error")return null;if(d.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!cf(d.itemType,o.itemType))&&(typeof d.N!="number"||d.N===o.N))return null}else{if(d.kind===o.kind)return null;if(d.kind==="value"){for(const c of bl)if(!cf(c,o))return null}}return`Expected ${zi(d)} but found ${zi(o)} instead.`}function lb(d,o){return o.some(c=>c.kind===d.kind)}function uf(d,o){return o.some(c=>c==="null"?d===null:c==="array"?Array.isArray(d):c==="object"?d&&!Array.isArray(d)&&typeof d=="object":c===typeof d)}class Xy{constructor(o,c,h){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class km{constructor(o,c,h,m,p){this.text=o.normalize?o.normalize():o,this.image=c,this.scale=h,this.fontStack=m,this.textColor=p}}class aa{constructor(o){this.sections=o}static fromString(o){return new aa([new km(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||!!o.image&&o.image.hasPrimary())}static factory(o){return o instanceof aa?o:aa.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const c of this.sections){if(c.image){const m=c.image.getPrimary().id.toString();o.push(["image",m]);continue}o.push(c.text);const h={};c.fontStack&&(h["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(h["font-scale"]=c.scale),c.textColor&&(h["text-color"]=["rgba"].concat(c.textColor.toRenderColor(null).toArray())),o.push(h)}return o}}class tc{constructor(o,c={}){if(this.id=Oa.from(o),this.options=Object.assign({},c),c.transform){const{a:h,b:m,c:p,d:v,e:T,f:M}=c.transform;this.options.transform=new DOMMatrix([h,m,p,v,T,M])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:o,b:c,c:h,d:m,e:p,f:v}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:o,b:c,c:h,d:m,e:p,f:v}})}static parse(o){let c,h,m,p;try{({name:c,iconsetId:h,params:m,transform:p}=JSON.parse(o)||{})}catch{return null}if(!c)return null;const{a:v,b:T,c:M,d:O,e:w,f:P}=p||{};return new tc({name:c,iconsetId:h},{params:m,transform:new DOMMatrix([v,T,M,O,w,P])})}scaleSelf(o){return this.options.transform.scaleSelf(o),this}}class sa{constructor(o,c,h,m,p=!1){this.primaryId=Oa.from(o),this.primaryOptions=c,h&&(this.secondaryId=Oa.from(h)),this.secondaryOptions=m,this.available=p}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new tc(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new tc(this.secondaryId,this.secondaryOptions):null}static from(o){return typeof o=="string"?sa.build({name:o}):o}static build(o,c,h,m){return!o||typeof o=="object"&&!("name"in o)?null:new sa(o,h,c,m)}}function Rm(d,o,c,h){return typeof d=="number"&&d>=0&&d<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof c=="number"&&c>=0&&c<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[d,o,c,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[d,o,c,h]:[d,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function wl(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof An||d instanceof Xy||d instanceof aa||d instanceof sa)return!0;if(Array.isArray(d)){for(const o of d)if(!wl(o))return!1;return!0}if(typeof d=="object"){for(const o in d)if(!wl(d[o]))return!1;return!0}return!1}function no(d){if(d===null)return sf;if(typeof d=="string")return wn;if(typeof d=="boolean")return ln;if(typeof d=="number")return ar;if(d instanceof An)return oa;if(d instanceof Xy)return Dc;if(d instanceof aa)return Om;if(d instanceof sa)return Lc;if(Array.isArray(d)){const o=d.length;let c;for(const h of d){const m=no(h);if(c){if(c===m)continue;c=pn;break}c=m}return Zo(c||pn,o)}return lf}function Oo(d){const o=typeof d;return d===null?"":o==="string"||o==="number"||o==="boolean"?String(d):d instanceof An?d.toStringPremultipliedAlpha():d instanceof aa||d instanceof sa?d.toString():JSON.stringify(d)}class Nc{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(o.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!wl(o[1]))return c.error("invalid value");const h=o[1];let m=no(h);const p=c.expectedType;return m.kind!=="array"||m.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(m=p),new Nc(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof An?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof aa?this.value.serialize():this.value}}class $i{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const cb={string:wn,number:ar,boolean:ln,object:lf};class ds{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let h,m=1;const p=o[0];if(p==="array"){let T,M;if(o.length>2){const O=o[1];if(typeof O!="string"||!(O in cb)||O==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);T=cb[O],m++}else T=pn;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);M=o[2],m++}h=Zo(T,M)}else h=cb[p];const v=[];for(;m<o.length;m++){const T=c.parse(o[m],m,pn);if(!T)return null;v.push(T)}return new ds(h,v)}evaluate(o){for(let c=0;c<this.args.length;c++){const h=this.args[c].evaluate(o);if(!cf(this.type,no(h)))return h;if(c===this.args.length-1)throw new $i(`The expression ${JSON.stringify(this.args[c].serialize())} evaluated to ${zi(no(h))} but was expected to be of type ${zi(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,c=[o.kind];if(o.kind==="array"){const h=o.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){c.push(h.kind);const m=o.N;(typeof m=="number"||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(h=>h.serialize()))}}class df{constructor(o){this.type=Om,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const h=o[1];if(!Array.isArray(h)&&typeof h=="object")return c.error("First argument must be an image or text section.");const m=[];let p=!1;for(let v=1;v<=o.length-1;++v){const T=o[v];if(p&&typeof T=="object"&&!Array.isArray(T)){p=!1;let M=null;if(T["font-scale"]&&(M=c.parseObjectValue(T["font-scale"],v,"font-scale",ar),!M))return null;let O=null;if(T["text-font"]&&(O=c.parseObjectValue(T["text-font"],v,"text-font",Zo(wn)),!O))return null;let w=null;if(T["text-color"]&&(w=c.parseObjectValue(T["text-color"],v,"text-color",oa),!w))return null;const P=m[m.length-1];P.scale=M,P.font=O,P.textColor=w}else{const M=c.parse(o[v],v,pn);if(!M)return null;const O=M.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,m.push({content:M,scale:null,font:null,textColor:null})}}return new df(m)}evaluate(o){return new aa(this.sections.map(c=>{const h=c.content.evaluate(o);return no(h)===Lc?new km("",h,null,null,null):new km(Oo(h),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const c of this.sections){o.push(c.content.serialize());const h={};c.scale&&(h["font-scale"]=c.scale.serialize()),c.font&&(h["text-font"]=c.font.serialize()),c.textColor&&(h["text-color"]=c.textColor.serialize()),o.push(h)}return o}}class $u{constructor(o,c,h,m){this._imageWarnHistory={},this.type=Lc,this.namePrimary=o,this.nameSecondary=c,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),m&&(this.paramsSecondary=m.params,this.iconsetIdSecondary=m.iconset?m.iconset.id:void 0)}static parse(o,c){if(o.length<2)return c.error("Expected two or more arguments.");let h=1;const m=[];function p(){if(h<o.length){const T=c.parse(o[h],h++,wn);return T?(m.push({image:T,options:{}}),!0):(c.error(m.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(h<o.length){const M=o[h];if((T=M)===null||typeof T!="object"||Array.isArray(T))return!0;const O=M.params,w=M.iconset,P=c.concat(h);if(!O&&!w)return h++,!0;if(O){if(typeof O!="object"||O.constructor!==Object)return P.error('Image options "params" should be an object'),!1;const D={},I=P.concat(void 0,"params");for(const k in O){if(!k)return I.error("Image parameter name should be non-empty"),!1;const N=I.concat(void 0,k).parse(O[k],void 0,oa,void 0,{typeAnnotation:"coerce"});if(!N)return!1;D[k]=N}m[m.length-1].options.params=D}if(w){if(typeof w!="object"||w.constructor!==Object)return P.error('Image options "iconset" should be an object'),!1;if(!w.id)return P.error('Image options "iconset" should have an "id" property'),!1;m[m.length-1].options.iconset=w}return h++,!0}var T;return!0}for(let T=0;T<2;T++)if(!p()||!v())return;return new $u(m[0].image,m[1]?m[1].image:void 0,m[0].options,m[1]?m[1].options:void 0)}evaluateParams(o,c){const h={};if(c){for(const m in c)if(c[m])try{h[m]=c[m].evaluate(o)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(o){const c={name:this.namePrimary.evaluate(o),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(o),iconsetId:this.iconsetIdSecondary}:void 0,m=sa.build(c,h,this.paramsPrimary?this.evaluateParams(o,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(o,this.paramsSecondary):void 0);if(m&&o.availableImages){const p=m.getPrimary().id;if(m.available=o.availableImages.some(v=>Oa.isEqual(v,p)),m.available){const v=m.getSecondary()?m.getSecondary().id:null;v&&(m.available=o.availableImages.some(T=>Oa.isEqual(T,v)))}}return m}eachChild(o){if(o(this.namePrimary),this.paramsPrimary)for(const c in this.paramsPrimary)this.paramsPrimary[c]&&o(this.paramsPrimary[c]);if(this.nameSecondary&&(o(this.nameSecondary),this.paramsSecondary))for(const c in this.paramsSecondary)this.paramsSecondary[c]&&o(this.paramsSecondary[c])}outputDefined(){return!1}serializeOptions(o,c){const h={};if(c&&(h.iconset={id:c}),o){h.params={};for(const m in o)o[m]&&(h.params[m]=o[m].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const o=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const c=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);c&&o.push(c)}if(this.nameSecondary&&(o.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const c=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);c&&o.push(c)}return o}}function zc(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}const kR={"to-boolean":ln,"to-color":oa,"to-number":ar,"to-string":wn};class jc{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const h=o[0],m=[];let p=sf;if(h==="to-array"){if(!Array.isArray(o[1]))return null;const v=o[1].length;if(c.expectedType){if(c.expectedType.kind!=="array")return c.error(`Expected ${c.expectedType.kind} but found array.`);p=Zo(c.expectedType.itemType,v)}else{if(!(v>0&&wl(o[1][0])))return null;p=Zo(no(o[1][0]),v)}for(let T=0;T<v;T++){const M=o[1][T];let O;if(zc(M)==="array")O=c.parse(M,void 0,p.itemType);else{const w=zc(M);if(w!==p.itemType.kind)return c.error(`Expected ${p.itemType.kind} but found ${w}.`);O=c.registry.literal.parse(["literal",M===void 0?null:M],c)}if(!O)return null;m.push(O)}}else{if((h==="to-boolean"||h==="to-string")&&o.length!==2)return c.error("Expected one argument.");p=kR[h];for(let v=1;v<o.length;v++){const T=c.parse(o[v],v,pn);if(!T)return null;m.push(T)}}return new jc(p,m)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let c,h;for(const m of this.args){if(c=m.evaluate(o),h=null,c instanceof An)return c;if(typeof c=="string"){const p=o.parseColor(c);if(p)return p}else if(Array.isArray(c)&&(h=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Rm(c[0],c[1],c[2],c[3]),!h))return new An(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new $i(h||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const h of this.args){if(c=h.evaluate(o),c===null)return 0;const m=Number(c);if(!isNaN(m))return m}throw new $i(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?aa.fromString(Oo(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?sa.build(Oo(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(c=>c.evaluate(o)):Oo(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new df([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $u(this.args[0]).serialize();const o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(c=>{o.push(c.serialize())}),o}}const RR=["Unknown","Point","LineString","Polygon"];class Yy{constructor(o,c){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=c}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?RR[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,c=this.featureDistanceData.scale,{x:h,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*c-o[0])+this.featureDistanceData.bearing[1]*(m*c-o[1])}return 0}parseColor(o){let c=this._parseColorCache[o];return c||(c=this._parseColorCache[o]=An.parse(o)),c}getConfig(o){return this.options?this.options.get(o):null}}class xa{constructor(o,c,h,m,p){this.name=o,this.type=c,this._evaluate=h,this.args=m,this._overloadIndex=p}evaluate(o){if(!this._evaluate){const c=xa.definitions[this.name];this._evaluate=Array.isArray(c)?c[2]:c.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,c){const h=o[0],m=xa.definitions[h];if(!m)return c.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(m)?m[0]:m.type,v=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=[];let M=null,O=-1;for(const[w,P]of v){if(Array.isArray(w)&&w.length!==o.length-1)continue;T.push(w),O++,M=new gb(c.registry,c.path,null,c.scope,void 0,c._scope,c.options);const D=[];let I=!1;for(let k=1;k<o.length;k++){const N=o[k],W=Array.isArray(w)?w[k-1]:w.type,Z=M.parse(N,1+D.length,W);if(!Z){I=!0;break}D.push(Z)}if(!I)if(Array.isArray(w)&&w.length!==D.length)M.error(`Expected ${w.length} arguments, but found ${D.length} instead.`);else{for(let k=0;k<D.length;k++){const N=Array.isArray(w)?w[k]:w.type,W=D[k];M.concat(k+1).checkSubtype(N,W.type)}if(M.errors.length===0)return new xa(h,p,P,D,O)}}if(T.length===1)c.errors.push(...M.errors);else{const w=(T.length?T:v.map(([D])=>D)).map(DR).join(" | "),P=[];for(let D=1;D<o.length;D++){const I=c.parse(o[D],1+P.length);if(!I)return null;P.push(zi(I.type))}c.error(`Expected arguments of type ${w}, but found (${P.join(", ")}) instead.`)}return null}static register(o,c){xa.definitions=c;for(const h in c)o[h]=xa}}function DR(d){return Array.isArray(d)?`(${d.map(zi).join(", ")})`:`(${zi(d.type)}...)`}class Wd{constructor(o,c,h){this.type=Dc,this.locale=h,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(o.length!==2)return c.error("Expected one argument.");const h=o[1];if(typeof h!="object"||Array.isArray(h))return c.error("Collator options argument must be an object.");const m=h["case-sensitive"]===void 0?c.parse(!1,1,ln):c.parseObjectValue(h["case-sensitive"],1,"case-sensitive",ln);if(!m)return null;const p=h["diacritic-sensitive"]===void 0?c.parse(!1,1,ln):c.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",ln);if(!p)return null;let v=null;return h.locale&&(v=c.parseObjectValue(h.locale,1,"locale",wn),!v)?null:new Wd(m,p,v)}evaluate(o){return new Xy(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function HE(d,o,c=0,h=d.length-1,m=LR){for(;h>c;){if(h-c>600){const M=h-c+1,O=o-c+1,w=Math.log(M),P=.5*Math.exp(2*w/3),D=.5*Math.sqrt(w*P*(M-P)/M)*(O-M/2<0?-1:1);HE(d,o,Math.max(c,Math.floor(o-O*P/M+D)),Math.min(h,Math.floor(o+(M-O)*P/M+D)),m)}const p=d[o];let v=c,T=h;for(Dm(d,c,o),m(d[h],p)>0&&Dm(d,c,h);v<T;){for(Dm(d,v,T),v++,T--;m(d[v],p)<0;)v++;for(;m(d[T],p)>0;)T--}m(d[c],p)===0?Dm(d,c,T):(T++,Dm(d,T,h)),T<=o&&(c=T+1),o<=T&&(h=T-1)}}function Dm(d,o,c){const h=d[o];d[o]=d[c],d[c]=h}function LR(d,o){return d<o?-1:d>o?1:0}function NR(d){let o=0;for(let c,h,m=0,p=d.length,v=p-1;m<p;v=m++)c=d[m],h=d[v],o+=(h.x-c.x)*(c.y+h.y);return o}function Lm(d,o){d[0]=Math.min(d[0],o[0]),d[1]=Math.min(d[1],o[1]),d[2]=Math.max(d[2],o[0]),d[3]=Math.max(d[3],o[1])}function Nm(d,o){return!(d[0]<=o[0]||d[2]>=o[2]||d[1]<=o[1]||d[3]>=o[3])}function zR(d,o,c){const h=d[0]-o[0],m=d[1]-o[1],p=d[0]-c[0],v=d[1]-c[1];return h*v-p*m==0&&h*p<=0&&m*v<=0}function Gd(d,o,c=!1){let h=!1;for(let T=0,M=o.length;T<M;T++){const O=o[T];for(let w=0,P=O.length,D=P-1;w<P;D=w++){const I=O[D],k=O[w];if(zR(d,I,k))return c;(p=I)[1]>(m=d)[1]!=(v=k)[1]>m[1]&&m[0]<(v[0]-p[0])*(m[1]-p[1])/(v[1]-p[1])+p[0]&&(h=!h)}}var m,p,v;return h}function qd(d,o,c,h){const m=h[0]-c[0],p=h[1]-c[1],v=(d[0]-c[0])*p-m*(d[1]-c[1]),T=(o[0]-c[0])*p-m*(o[1]-c[1]);return v>0&&T<0||v<0&&T>0}function Ky(d,o,c,h){return(m=[h[0]-c[0],h[1]-c[1]])[0]*(p=[o[0]-d[0],o[1]-d[1]])[1]-m[1]*p[0]!=0&&!(!qd(d,o,c,h)||!qd(c,h,d,o));var m,p}const Uu=8192;function ub(d,o){const c=(180+d[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,m=Math.pow(2,o.z);return[Math.round(c*m*Uu),Math.round(h*m*Uu)]}function jR(d,o){for(let c=0;c<o.length;c++)if(Gd(d,o[c]))return!0;return!1}function FR(d,o,c){for(const h of c)for(let m=0,p=h.length,v=p-1;m<p;v=m++)if(Ky(d,o,h[v],h[m]))return!0;return!1}function ZE(d,o){for(let c=0;c<d.length;++c)if(!Gd(d[c],o))return!1;for(let c=0;c<d.length-1;++c)if(FR(d[c],d[c+1],o))return!1;return!0}function BR(d,o){for(let c=0;c<o.length;c++)if(ZE(d,o[c]))return!0;return!1}function Vu(d,o,c){const h=[];for(let m=0;m<d.length;m++){const p=[];for(let v=0;v<d[m].length;v++){const T=ub(d[m][v],c);Lm(o,T),p.push(T)}h.push(p)}return h}function Xr(d,o,c){const h=[];for(let m=0;m<d.length;m++){const p=Vu(d[m],o,c);h.push(p)}return h}function hr(d,o,c,h){if(d[0]<c[0]||d[0]>c[2]){const m=.5*h;let p=d[0]-c[0]>m?-h:c[0]-d[0]>m?h:0;p===0&&(p=d[0]-c[2]>m?-h:c[2]-d[0]>m?h:0),d[0]+=p}Lm(o,d)}function Jy(d,o,c,h){const m=Math.pow(2,h.z)*Uu,p=[h.x*Uu,h.y*Uu],v=[];if(!d)return v;for(const T of d)for(const M of T){const O=[M.x+p[0],M.y+p[1]];hr(O,o,c,m),v.push(O)}return v}function Dr(d,o,c,h){const m=Math.pow(2,h.z)*Uu,p=[h.x*Uu,h.y*Uu],v=[];if(!d)return v;for(const M of d){const O=[];for(const w of M){const P=[w.x+p[0],w.y+p[1]];Lm(o,P),O.push(P)}v.push(O)}if(o[2]-o[0]<=m/2){(T=o)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const M of v)for(const O of M)hr(O,o,c,m)}var T;return v}class Fc{constructor(o,c){this.type=ln,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(wl(o[1])){const h=o[1];if(h.type==="FeatureCollection")for(let m=0;m<h.features.length;++m){const p=h.features[m].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Fc(h,h.features[m].geometry)}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Fc(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Fc(h,h)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(c,h){const m=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=c.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const T=Vu(h.coordinates,p,v),M=Jy(c.geometry(),m,p,v);if(!Nm(m,p))return!1;for(const O of M)if(!Gd(O,T))return!1}if(h.type==="MultiPolygon"){const T=Xr(h.coordinates,p,v),M=Jy(c.geometry(),m,p,v);if(!Nm(m,p))return!1;for(const O of M)if(!jR(O,T))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(c,h){const m=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=c.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const T=Vu(h.coordinates,p,v),M=Dr(c.geometry(),m,p,v);if(!Nm(m,p))return!1;for(const O of M)if(!ZE(O,T))return!1}if(h.type==="MultiPolygon"){const T=Xr(h.coordinates,p,v),M=Dr(c.geometry(),m,p,v);if(!Nm(m,p))return!1;for(const O of M)if(!BR(O,T))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const hf={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Ir=1/298.257223563,db=Ir*(2-Ir),Hd=Math.PI/180;class ff{static fromTile(o,c,h){const m=Math.PI*(1-2*(o+.5)/Math.pow(2,c)),p=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/Hd;return new ff(p,h)}static get units(){return hf}constructor(o,c){if(o===void 0)throw new Error("No latitude given.");if(c&&!hf[c])throw new Error(`Unknown unit ${c}. Use one of: ${Object.keys(hf).join(", ")}`);const h=6378.137*Hd*(c?hf[c]:1),m=Math.cos(o*Hd),p=1/(1-db*(1-m*m)),v=Math.sqrt(p);this.kx=h*v*m,this.ky=h*v*p*(1-db)}distance(o,c){const h=Ii(o[0]-c[0])*this.kx,m=(o[1]-c[1])*this.ky;return Math.sqrt(h*h+m*m)}bearing(o,c){const h=Ii(c[0]-o[0])*this.kx;return Math.atan2(h,(c[1]-o[1])*this.ky)/Hd}destination(o,c,h){const m=h*Hd;return this.offset(o,Math.sin(m)*c,Math.cos(m)*c)}offset(o,c,h){return[o[0]+c/this.kx,o[1]+h/this.ky]}lineDistance(o){let c=0;for(let h=0;h<o.length-1;h++)c+=this.distance(o[h],o[h+1]);return c}area(o){let c=0;for(let h=0;h<o.length;h++){const m=o[h];for(let p=0,v=m.length,T=v-1;p<v;T=p++)c+=Ii(m[p][0]-m[T][0])*(m[p][1]+m[T][1])*(h?-1:1)}return Math.abs(c)/2*this.kx*this.ky}along(o,c){let h=0;if(c<=0)return o[0];for(let m=0;m<o.length-1;m++){const p=o[m],v=o[m+1],T=this.distance(p,v);if(h+=T,h>c)return pf(p,v,(c-(h-T))/T)}return o[o.length-1]}pointToSegmentDistance(o,c,h){let[m,p]=c,v=Ii(h[0]-m)*this.kx,T=(h[1]-p)*this.ky;if(v!==0||T!==0){const M=(Ii(o[0]-m)*this.kx*v+(o[1]-p)*this.ky*T)/(v*v+T*T);M>1?(m=h[0],p=h[1]):M>0&&(m+=v/this.kx*M,p+=T/this.ky*M)}return v=Ii(o[0]-m)*this.kx,T=(o[1]-p)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(o,c){let h=1/0,m=o[0][0],p=o[0][1],v=0,T=0;for(let M=0;M<o.length-1;M++){let O=o[M][0],w=o[M][1],P=Ii(o[M+1][0]-O)*this.kx,D=(o[M+1][1]-w)*this.ky,I=0;P===0&&D===0||(I=(Ii(c[0]-O)*this.kx*P+(c[1]-w)*this.ky*D)/(P*P+D*D),I>1?(O=o[M+1][0],w=o[M+1][1]):I>0&&(O+=P/this.kx*I,w+=D/this.ky*I)),P=Ii(c[0]-O)*this.kx,D=(c[1]-w)*this.ky;const k=P*P+D*D;k<h&&(h=k,m=O,p=w,v=M,T=I)}return{point:[m,p],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(o,c,h){let m=this.pointOnLine(h,o),p=this.pointOnLine(h,c);if(m.index>p.index||m.index===p.index&&m.t>p.t){const O=m;m=p,p=O}const v=[m.point],T=m.index+1,M=p.index;!hb(h[T],v[0])&&T<=M&&v.push(h[T]);for(let O=T+1;O<=M;O++)v.push(h[O]);return hb(h[M],p.point)||v.push(p.point),v}lineSliceAlong(o,c,h){let m=0;const p=[];for(let v=0;v<h.length-1;v++){const T=h[v],M=h[v+1],O=this.distance(T,M);if(m+=O,m>o&&p.length===0&&p.push(pf(T,M,(o-(m-O))/O)),m>=c)return p.push(pf(T,M,(c-(m-O))/O)),p;m>o&&p.push(M)}return p}bufferPoint(o,c){const h=c/this.ky,m=c/this.kx;return[o[0]-m,o[1]-h,o[0]+m,o[1]+h]}bufferBBox(o,c){const h=c/this.ky,m=c/this.kx;return[o[0]-m,o[1]-h,o[2]+m,o[3]+h]}insideBBox(o,c){return Ii(o[0]-c[0])>=0&&Ii(o[0]-c[2])<=0&&o[1]>=c[1]&&o[1]<=c[3]}}function hb(d,o){return d[0]===o[0]&&d[1]===o[1]}function pf(d,o,c){const h=Ii(o[0]-d[0]);return[d[0]+h*c,d[1]+(o[1]-d[1])*c]}function Ii(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}class zm{constructor(o=[],c=(h,m)=>h<m?-1:h>m?1:0){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:h}=this,m=c[o];for(;o>0;){const p=o-1>>1,v=c[p];if(h(m,v)>=0)break;c[o]=v,o=p}c[o]=m}_down(o){const{data:c,compare:h}=this,m=this.length>>1,p=c[o];for(;o<m;){let v=1+(o<<1);const T=v+1;if(T<this.length&&h(c[T],c[v])<0&&(v=T),h(c[v],p)>=0)break;c[o]=c[v],o=v}c[o]=p}}var Bt=8192;function Qy(d,o){return o.dist-d.dist}const Bc=100,Xo=50;function XE(d){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==d.length)return!1;for(let c=0;c<o.length;c++)if(o[c]!==d[c])return!1;return!0}function ev(d){return d[1]-d[0]+1}function $c(d,o){const c=d[1]>=d[0]&&d[1]<o;return c||console.warn("Distance Expression: Index is out of range"),c}function mf(d,o){if(d[0]>d[1])return[null,null];const c=ev(d);if(o){if(c===2)return[d,null];const h=Math.floor(c/2);return[[d[0],d[0]+h],[d[0]+h,d[1]]]}{if(c===1)return[d,null];const h=Math.floor(c/2)-1;return[[d[0],d[0]+h],[d[0]+h+1,d[1]]]}}function Wu(d,o){const c=[1/0,1/0,-1/0,-1/0];if(!$c(o,d.length))return c;for(let h=o[0];h<=o[1];++h)Lm(c,d[h]);return c}function gf(d){const o=[1/0,1/0,-1/0,-1/0];for(let c=0;c<d.length;++c)for(let h=0;h<d[c].length;++h)Lm(o,d[c][h]);return o}function yf(d,o,c){if(XE(d)||XE(o))return NaN;let h=0,m=0;return d[2]<o[0]&&(h=o[0]-d[2]),d[0]>o[2]&&(h=d[0]-o[2]),d[1]>o[3]&&(m=d[1]-o[3]),d[3]<o[1]&&(m=o[1]-d[3]),c.distance([0,0],[h,m])}function $R(d){return 360*d-180}function UR(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function fb(d,o){const c=Math.pow(2,o.z),h=(d.y/Bt+o.y)/c;return[$R((d.x/Bt+o.x)/c),UR(h)]}function YE(d,o){const c=[];for(let h=0;h<d.length;++h)c.push(fb(d[h],o));return c}function KE(d,o,c){const h=c.pointOnLine(o,d).point;return c.distance(d,h)}function JE(d,o,c,h,m){const p=c.slice(h[0],h[1]+1);let v=1/0;for(let T=o[0];T<=o[1];++T)if((v=Math.min(v,KE(d[T],p,m)))===0)return 0;return v}function tv(d,o,c,h,m){const p=Math.min(m.pointToSegmentDistance(d,c,h),m.pointToSegmentDistance(o,c,h)),v=Math.min(m.pointToSegmentDistance(c,d,o),m.pointToSegmentDistance(h,d,o));return Math.min(p,v)}function VR(d,o,c,h,m){if(!$c(o,d.length)||!$c(h,c.length))return NaN;let p=1/0;for(let v=o[0];v<o[1];++v)for(let T=h[0];T<h[1];++T){if(Ky(d[v],d[v+1],c[T],c[T+1]))return 0;p=Math.min(p,tv(d[v],d[v+1],c[T],c[T+1],m))}return p}function Zd(d,o,c,h,m){if(!$c(o,d.length)||!$c(h,c.length))return NaN;let p=1/0;for(let v=o[0];v<=o[1];++v)for(let T=h[0];T<=h[1];++T)if((p=Math.min(p,m.distance(d[v],c[T])))===0)return p;return p}function WR(d,o,c){if(Gd(d,o,!0))return 0;let h=1/0;for(const m of o){const p=m.length;if(p<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[p-1]&&(h=Math.min(h,c.pointToSegmentDistance(d,m[p-1],m[0])))===0||(h=Math.min(h,KE(d,m,c)))===0)return h}return h}function GR(d,o,c,h){if(!$c(o,d.length))return NaN;for(let p=o[0];p<=o[1];++p)if(Gd(d[p],c,!0))return 0;let m=1/0;for(let p=o[0];p<o[1];++p)for(const v of c)for(let T=0,M=v.length,O=M-1;T<M;O=T++){if(Ky(d[p],d[p+1],v[O],v[T]))return 0;m=Math.min(m,tv(d[p],d[p+1],v[O],v[T],h))}return m}function rv(d,o){for(const c of d)for(let h=0;h<=c.length-1;++h)if(Gd(c[h],o,!0))return!0;return!1}function QE(d,o,c,h=1/0){const m=gf(d),p=gf(o);if(h!==1/0&&yf(m,p,c)>=h)return h;if(Nm(m,p)){if(rv(d,o))return 0}else if(rv(o,d))return 0;let v=h;for(const T of d)for(let M=0,O=T.length,w=O-1;M<O;w=M++)for(const P of o)for(let D=0,I=P.length,k=I-1;D<I;k=D++){if(Ky(T[w],T[M],P[k],P[D]))return 0;v=Math.min(v,tv(T[w],T[M],P[k],P[D],c))}return v}function jm(d,o,c,h,m,p,v){if(p===null||v===null)return;const T=yf(Wu(h,p),Wu(m,v),c);T<o&&d.push({dist:T,range1:p,range2:v})}function Sl(d,o,c,h,m=1/0){let p=Math.min(h.distance(d[0],c[0][0]),m);if(p===0)return p;const v=new zm([{dist:0,range1:[0,d.length-1],range2:[0,0]}],Qy),T=o?Xo:Bc,M=gf(c);for(;v.length;){const O=v.pop();if(O.dist>=p)continue;const w=O.range1;if(ev(w)<=T){if(!$c(w,d.length))return NaN;if(o){const P=GR(d,w,c,h);if((p=Math.min(p,P))===0)return p}else for(let P=w[0];P<=w[1];++P){const D=WR(d[P],c,h);if((p=Math.min(p,D))===0)return p}}else{const P=mf(w,o);if(P[0]!==null){const D=yf(Wu(d,P[0]),M,h);D<p&&v.push({dist:D,range1:P[0],range2:[0,0]})}if(P[1]!==null){const D=yf(Wu(d,P[1]),M,h);D<p&&v.push({dist:D,range1:P[1],range2:[0,0]})}}}return p}function pb(d,o,c,h,m,p=1/0){let v=Math.min(p,m.distance(d[0],c[0]));if(v===0)return v;const T=new zm([{dist:0,range1:[0,d.length-1],range2:[0,c.length-1]}],Qy),M=o?Xo:Bc,O=h?Xo:Bc;for(;T.length;){const w=T.pop();if(w.dist>=v)continue;const P=w.range1,D=w.range2;if(ev(P)<=M&&ev(D)<=O){if(!$c(P,d.length)||!$c(D,c.length))return NaN;if(o&&h?v=Math.min(v,VR(d,P,c,D,m)):o||h?o&&!h?v=Math.min(v,JE(c,D,d,P,m)):!o&&h&&(v=Math.min(v,JE(d,P,c,D,m))):v=Math.min(v,Zd(d,P,c,D,m)),v===0)return v}else{const I=mf(P,o),k=mf(D,h);jm(T,v,m,d,c,I[0],k[0]),jm(T,v,m,d,c,I[0],k[1]),jm(T,v,m,d,c,I[1],k[0]),jm(T,v,m,d,c,I[1],k[1])}}return v}function nv(d,o,c,h,m=1/0){let p=m;const v=Wu(d,[0,d.length-1]);for(const T of c)if(!(p!==1/0&&yf(v,Wu(T,[0,T.length-1]),h)>=p)&&(p=Math.min(p,pb(d,o,T,!0,h,p)),p===0))return p;return p}function Fm(d,o,c,h,m=1/0){let p=m;const v=Wu(d,[0,d.length-1]);for(const T of c){if(p!==1/0&&yf(v,gf(T),h)>=p)continue;const M=Sl(d,o,T,h,p);if(isNaN(M))return M;if((p=Math.min(p,M))===0)return p}return p}function iv(d){return d==="Point"||d==="MultiPoint"||d==="LineString"||d==="MultiLineString"||d==="Polygon"||d==="MultiPolygon"}class Gu{constructor(o,c){this.type=ar,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(wl(o[1])){const h=o[1];if(h.type==="FeatureCollection"){for(let m=0;m<h.features.length;++m)if(iv(h.features[m].geometry.type))return new Gu(h,h.features[m].geometry)}else if(h.type==="Feature"){if(iv(h.geometry.type))return new Gu(h,h.geometry)}else if(iv(h.type))return new Gu(h,h)}return c.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const c=o.geometry(),h=o.canonicalID();if(c!=null&&h!=null){if(o.geometryType()==="Point")return function(m,p,v){const T=[];for(const O of m)for(const w of O)T.push(fb(w,p));const M=new ff(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?pb(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",M):v.type==="MultiLineString"?nv(T,!1,v.coordinates,M):v.type==="Polygon"||v.type==="MultiPolygon"?Fm(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,M):null}(c,h,this.geometries);if(o.geometryType()==="LineString")return function(m,p,v){const T=[];for(const O of m){const w=[];for(const P of O)w.push(fb(P,p));T.push(w)}const M=new ff(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return nv(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,M);if(v.type==="MultiLineString"){let O=1/0;for(let w=0;w<v.coordinates.length;w++){const P=nv(v.coordinates[w],!0,T,M,O);if(isNaN(P))return P;if((O=Math.min(O,P))===0)return O}return O}if(v.type==="Polygon"||v.type==="MultiPolygon"){let O=1/0;for(let w=0;w<T.length;w++){const P=Fm(T[w],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,M,O);if(isNaN(P))return P;if((O=Math.min(O,P))===0)return O}return O}return null}(c,h,this.geometries);if(o.geometryType()==="Polygon")return function(m,p,v){const T=[];for(const O of function(w,P){const D=w.length;if(D<=1)return[w];const I=[];let k,N;for(let W=0;W<D;W++){const Z=NR(w[W]);Z!==0&&(w[W].area=Math.abs(Z),N===void 0&&(N=Z<0),N===Z<0?(k&&I.push(k),k=[w[W]]):k.push(w[W]))}return k&&I.push(k),I}(m)){const w=[];for(let P=0;P<O.length;++P)w.push(YE(O[P],p));T.push(w)}const M=new ff(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Fm(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,M);if(v.type==="MultiLineString"){let O=1/0;for(let w=0;w<v.coordinates.length;w++){const P=Fm(v.coordinates[w],!0,T,M,O);if(isNaN(P))return P;if((O=Math.min(O,P))===0)return O}return O}return v.type==="Polygon"||v.type==="MultiPolygon"?function(O,w,P){let D=1/0;for(const I of O)for(const k of w){const N=QE(I,k,P,D);if(isNaN(N))return N;if((D=Math.min(D,N))===0)return D}return D}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,M):null}(c,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function ov(d,o){switch(d){case"string":return Oo(o);case"number":return+o;case"boolean":return!!o;case"color":return An.parse(o);case"formatted":return aa.fromString(Oo(o));case"resolvedImage":return sa.build(Oo(o))}return o}function mb(d,o,c,h){return h!==void 0&&(d=h*Math.round(d/h)),o!==void 0&&d<o&&(d=o),c!==void 0&&d>c&&(d=c),d}class Xd{constructor(o,c,h){this.type=o,this.key=c,this.scope=h}static parse(o,c){let h=c.expectedType;if(h==null&&(h=pn),o.length<2||o.length>3)return c.error("Invalid number of arguments for 'config' expression.");const m=c.parse(o[1],1);if(!(m instanceof Nc))return c.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const p=c.parse(o[2],2);return p instanceof Nc?new Xd(h,Oo(m.value),Oo(p.value)):c.error("Scope of 'config' expression must be a string literal.")}return new Xd(h,Oo(m.value))}evaluate(o){const c=[this.key,this.scope,o.scope].filter(Boolean).join(""),h=o.getConfig(c);if(!h)return null;const{type:m,value:p,values:v,minValue:T,maxValue:M,stepValue:O}=h,w=h.default.evaluate(o);let P=w;if(p){const D=o.scope;o.scope=(D||"").split("").slice(1).join(""),P=p.evaluate(o),o.scope=D}return m&&(P=ov(m,P)),P===void 0||T===void 0&&M===void 0&&O===void 0||(typeof P=="number"?P=mb(P,T,M,O):Array.isArray(P)&&(P=P.map(D=>typeof D=="number"?mb(D,T,M,O):D))),p!==void 0&&P!==void 0&&v&&!v.includes(P)&&(P=w,m&&(P=ov(m,P))),(m&&m!==this.type||P!==void 0&&no(P)!==this.type)&&(P=ov(this.type.kind,P)),P}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function vf(d){if(d instanceof xa&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Fc||d instanceof Gu)return!1;let o=!0;return d.eachChild(c=>{o&&!vf(c)&&(o=!1)}),o}function Bm(d){if(d instanceof xa&&d.name==="feature-state")return!1;let o=!0;return d.eachChild(c=>{o&&!Bm(c)&&(o=!1)}),o}function $m(d){if(d instanceof Xd)return new Set([d.key]);let o=new Set;return d.eachChild(c=>{o=new Set([...o,...$m(c)])}),o}function Uc(d,o){if(d instanceof xa&&o.indexOf(d.name)>=0)return!1;let c=!0;return d.eachChild(h=>{c&&!Uc(h,o)&&(c=!1)}),c}class Yd{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(o.length!==2||typeof o[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const h=o[1];return c.scope.has(h)?new Yd(h,c.scope.get(h)):c.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class _f{constructor(o,c=[],h,m=new Zy,p=[],v,T){this.registry=o,this.path=c,this.key=c.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=m,this.errors=p,this.expectedType=h,this._scope=v,this.options=T}parse(o,c,h,m,p={}){return c||h?this.concat(c,null,h,m)._parse(o,p):this._parse(o,p)}parseObjectValue(o,c,h,m,p,v={}){return this.concat(c,h,m,p)._parse(o,v)}_parse(o,c){function h(m,p,v){return v==="assert"?new ds(p,[m]):v==="coerce"?new jc(p,[m]):m}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(m){let p=m.parse(o,this);if(!p)return null;if(this.expectedType){const v=this.expectedType,T=p.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else p=h(p,v,c.typeAnnotation||"coerce");else p=h(p,v,c.typeAnnotation||"assert")}if(!(p instanceof Nc)&&p.type.kind!=="resolvedImage"&&av(p)){const v=new Yy(this._scope,this.options);try{p=new Nc(p.type,p.evaluate(v))}catch(T){return this.error(T.message),null}}return p}return jc.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,h,m){let p=typeof o=="number"?this.path.concat(o):this.path;p=typeof c=="string"?p.concat(c):p;const v=m?this.scope.concat(m):this.scope;return new _f(this.registry,p,h||null,v,this.errors,this._scope,this.options)}error(o,...c){const h=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Fs(h,o))}checkSubtype(o,c){const h=cf(o,c);return h&&this.error(h),h}}var gb=_f;function av(d){if(d instanceof Yd)return av(d.boundExpression);if(d instanceof xa&&d.name==="error"||d instanceof Wd||d instanceof Fc||d instanceof Gu||d instanceof Xd)return!1;const o=d instanceof jc||d instanceof ds;let c=!0;return d.eachChild(h=>{c=o?c&&av(h):c&&h instanceof Nc}),!!c&&vf(d)&&Uc(d,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Um(d,o){const c=d.length-1;let h,m,p=0,v=c,T=0;for(;p<=v;)if(T=Math.floor((p+v)/2),h=d[T],m=d[T+1],h<=o){if(T===c||o<m)return T;p=T+1}else{if(!(h>o))throw new $i("Input is not a number.");v=T-1}return 0}class rc{constructor(o,c,h){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[m,p]of h)this.labels.push(m),this.outputs.push(p)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const h=c.parse(o[1],1,ar);if(!h)return null;const m=[];let p=null;c.expectedType&&c.expectedType.kind!=="value"&&(p=c.expectedType);for(let v=1;v<o.length;v+=2){const T=v===1?-1/0:o[v],M=o[v+1],O=v,w=v+1;if(typeof T!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(m.length&&m[m.length-1][0]>=T)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const P=c.parse(M,w,p);if(!P)return null;p=p||P.type,m.push([T,P])}return new rc(p,h,m)}evaluate(o){const c=this.labels,h=this.outputs;if(c.length===1)return h[0].evaluate(o);const m=this.input.evaluate(o);if(m<=c[0])return h[0].evaluate(o);const p=c.length;return m>=c[p-1]?h[p-1].evaluate(o):h[Um(c,m)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&o.push(this.labels[c]),o.push(this.outputs[c].serialize());return o}}const nn=.95047,e2=1.08883,t2=4/29,xf=6/29,yb=3*xf*xf,qR=xf*xf*xf,ai=Math.PI/180,HR=180/Math.PI;function vb(d){return d>qR?Math.pow(d,1/3):d/yb+t2}function _b(d){return d>xf?d*d*d:yb*(d-t2)}function xb(d){return 255*(d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055)}function bb(d){return(d/=255)<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function r2(d){const o=bb(d.r),c=bb(d.g),h=bb(d.b),m=vb((.4124564*o+.3575761*c+.1804375*h)/nn),p=vb((.2126729*o+.7151522*c+.072175*h)/1);return{l:116*p-16,a:500*(m-p),b:200*(p-vb((.0193339*o+.119192*c+.9503041*h)/e2)),alpha:d.a}}function n2(d){let o=(d.l+16)/116,c=isNaN(d.a)?o:o+d.a/500,h=isNaN(d.b)?o:o-d.b/200;return o=1*_b(o),c=nn*_b(c),h=e2*_b(h),new An(xb(3.2404542*c-1.5371385*o-.4985314*h),xb(-.969266*c+1.8760108*o+.041556*h),xb(.0556434*c-.2040259*o+1.0572252*h),d.alpha)}function ZR(d,o,c){const h=o-d;return d+c*(h>180||h<-180?h-360*Math.round(h/360):h)}const Vm={forward:r2,reverse:n2,interpolate:function(d,o,c){return{l:_r(d.l,o.l,c),a:_r(d.a,o.a,c),b:_r(d.b,o.b,c),alpha:_r(d.alpha,o.alpha,c)}}},Wm={forward:function(d){const{l:o,a:c,b:h}=r2(d),m=Math.atan2(h,c)*HR;return{h:m<0?m+360:m,c:Math.sqrt(c*c+h*h),l:o,alpha:d.a}},reverse:function(d){const o=d.h*ai,c=d.c;return n2({l:d.l,a:Math.cos(o)*c,b:Math.sin(o)*c,alpha:d.alpha})},interpolate:function(d,o,c){return{h:ZR(d.h,o.h,c),c:_r(d.c,o.c,c),l:_r(d.l,o.l,c),alpha:_r(d.alpha,o.alpha,c)}}};var i2=Object.freeze({__proto__:null,hcl:Wm,lab:Vm});class hs{constructor(o,c,h,m,p){this.type=o,this.operator=c,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[v,T]of p)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(o,c,h,m){let p=0;if(o.name==="exponential")p=wb(c,o.base,h,m);else if(o.name==="linear")p=wb(c,1,h,m);else if(o.name==="cubic-bezier"){const v=o.controlPoints;p=new Ot(v[0],v[1],v[2],v[3]).solve(wb(c,1,h,m))}return p}static parse(o,c){let[h,m,p,...v]=o;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const O=m[1];if(typeof O!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:O}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const O=m.slice(1);if(O.length!==4||O.some(w=>typeof w!="number"||w<0||w>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:O}}}if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(p=c.parse(p,2,ar),!p)return null;const T=[];let M=null;h==="interpolate-hcl"||h==="interpolate-lab"?M=oa:c.expectedType&&c.expectedType.kind!=="value"&&(M=c.expectedType);for(let O=0;O<v.length;O+=2){const w=v[O],P=v[O+1],D=O+3,I=O+4;if(typeof w!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(T.length&&T[T.length-1][0]>=w)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const k=c.parse(P,I,M);if(!k)return null;M=M||k.type,T.push([w,k])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new hs(M,h,m,p,T):c.error(`Type ${zi(M)} is not interpolatable.`)}evaluate(o){const c=this.labels,h=this.outputs;if(c.length===1)return h[0].evaluate(o);const m=this.input.evaluate(o);if(m<=c[0])return h[0].evaluate(o);const p=c.length;if(m>=c[p-1])return h[p-1].evaluate(o);const v=Um(c,m),T=hs.interpolationFactor(this.interpolation,m,c[v],c[v+1]),M=h[v].evaluate(o),O=h[v+1].evaluate(o);return this.operator==="interpolate"?Im[this.type.kind.toLowerCase()](M,O,T):this.operator==="interpolate-hcl"?Wm.reverse(Wm.interpolate(Wm.forward(M),Wm.forward(O),T)):Vm.reverse(Vm.interpolate(Vm.forward(M),Vm.forward(O),T))}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const c=[this.operator,o,this.input.serialize()];for(let h=0;h<this.labels.length;h++)c.push(this.labels[h],this.outputs[h].serialize());return c}}function wb(d,o,c,h){const m=h-c,p=d-c;return m===0?0:o===1?p/m:(Math.pow(o,p)-1)/(Math.pow(o,m)-1)}class sv{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let h=null;const m=c.expectedType;m&&m.kind!=="value"&&(h=m);const p=[];for(const T of o.slice(1)){const M=c.parse(T,1+p.length,h,void 0,{typeAnnotation:"omit"});if(!M)return null;h=h||M.type,p.push(M)}const v=m&&p.some(T=>cf(m,T.type));return new sv(v?pn:h,p)}evaluate(o){let c,h=null,m=0;for(const p of this.args){if(m++,h=p.evaluate(o),h&&h instanceof sa&&!h.available&&(c||(c=h),h=null,m===this.args.length))return c;if(h!==null)break}return h}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(c=>{o.push(c.serialize())}),o}}class lv{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const h=[];for(let p=1;p<o.length-1;p+=2){const v=o[p];if(typeof v!="string")return c.error(`Expected string, but found ${typeof v} instead.`,p);if(/[^a-zA-Z0-9_]/.test(v))return c.error("Variable names must contain only alphanumeric characters or '_'.",p);const T=c.parse(o[p+1],p+1);if(!T)return null;h.push([v,T])}const m=c.parse(o[o.length-1],o.length-1,c.expectedType,h);return m?new lv(h,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[c,h]of this.bindings)o.push(c,h.serialize());return o.push(this.result.serialize()),o}}class Sb{constructor(o,c,h){this.type=o,this.index=c,this.input=h}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,ar),m=c.parse(o[2],2,Zo(c.expectedType||pn));return h&&m?new Sb(m.type.itemType,h,m):null}evaluate(o){const c=this.index.evaluate(o),h=this.input.evaluate(o);if(c<0)throw new $i(`Array index out of bounds: ${c} < 0.`);if(c>=h.length)throw new $i(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c!==Math.floor(c))throw new $i(`Array index must be an integer, but found ${c} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return h[c]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Tb{constructor(o,c,h){this.type=o,this.index=c,this.input=h}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,ar),m=c.parse(o[2],2,Zo(c.expectedType||pn));return h&&m?new Tb(m.type.itemType,h,m):null}evaluate(o){const c=this.index.evaluate(o),h=this.input.evaluate(o);if(c<0)throw new $i(`Array index out of bounds: ${c} < 0.`);if(c>h.length-1)throw new $i(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c===Math.floor(c))return h[c];const m=Math.floor(c),p=Math.ceil(c),v=h[m],T=h[p];if(typeof v!="number"||typeof T!="number")throw new $i(`Cannot interpolate between non-number values at index ${c}.`);const M=c-m;return v*(1-M)+T*M}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Eb{constructor(o,c){this.type=ln,this.needle=o,this.haystack=c}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,pn),m=c.parse(o[2],2,pn);return h&&m?lb(h.type,[ln,wn,ar,sf,pn])?new Eb(h,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(h.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),h=this.haystack.evaluate(o);if(h==null)return!1;if(!uf(c,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${zi(no(c))} instead.`);if(!uf(h,["string","array"]))throw new $i(`Expected second argument to be of type array or string, but found ${zi(no(h))} instead.`);return h.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class cv{constructor(o,c,h){this.type=ar,this.needle=o,this.haystack=c,this.fromIndex=h}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,pn),m=c.parse(o[2],2,pn);if(!h||!m)return null;if(!lb(h.type,[ln,wn,ar,sf,pn]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(h.type)} instead`);if(o.length===4){const p=c.parse(o[3],3,ar);return p?new cv(h,m,p):null}return new cv(h,m)}evaluate(o){const c=this.needle.evaluate(o),h=this.haystack.evaluate(o);if(!uf(c,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${zi(no(c))} instead.`);if(!uf(h,["string","array"]))throw new $i(`Expected second argument to be of type array or string, but found ${zi(no(h))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(o);return h.indexOf(c,m)}return h.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Ab{constructor(o,c,h,m,p,v){this.inputType=o,this.type=c,this.input=h,this.cases=m,this.outputs=p,this.otherwise=v}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let h,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const p={},v=[];for(let O=2;O<o.length-1;O+=2){let w=o[O];const P=o[O+1];Array.isArray(w)||(w=[w]);const D=c.concat(O);if(w.length===0)return D.error("Expected at least one branch label.");for(const k of w){if(typeof k!="number"&&typeof k!="string")return D.error("Branch labels must be numbers or strings.");if(typeof k=="number"&&Math.abs(k)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof k=="number"&&Math.floor(k)!==k)return D.error("Numeric branch labels must be integer values.");if(h){if(D.checkSubtype(h,no(k)))return null}else h=no(k);if(p[String(k)]!==void 0)return D.error("Branch labels must be unique.");p[String(k)]=v.length}const I=c.parse(P,O,m);if(!I)return null;m=m||I.type,v.push(I)}const T=c.parse(o[1],1,pn);if(!T)return null;const M=c.parse(o[o.length-1],o.length-1,m);return M?T.type.kind!=="value"&&c.concat(1).checkSubtype(h,T.type)?null:new Ab(h,m,T,p,v,M):null}evaluate(o){const c=this.input.evaluate(o);return(no(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),h=[],m={};for(const v of c){const T=m[this.cases[v]];T===void 0?(m[this.cases[v]]=h.length,h.push([this.cases[v],[v]])):h[T][1].push(v)}const p=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of h)o.push(T.length===1?p(T[0]):T.map(p)),o.push(this.outputs[v].serialize());return o.push(this.otherwise.serialize()),o}}class Mb{constructor(o,c,h){this.type=o,this.branches=c,this.otherwise=h}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let h;c.expectedType&&c.expectedType.kind!=="value"&&(h=c.expectedType);const m=[];for(let v=1;v<o.length-1;v+=2){const T=c.parse(o[v],v,ln);if(!T)return null;const M=c.parse(o[v+1],v+1,h);if(!M)return null;m.push([T,M]),h=h||M.type}const p=c.parse(o[o.length-1],o.length-1,h);return p?new Mb(h,m,p):null}evaluate(o){for(const[c,h]of this.branches)if(c.evaluate(o))return h.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,h]of this.branches)o(c),o(h);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(c=>{o.push(c.serialize())}),o}}class uv{constructor(o,c,h,m){this.type=o,this.input=c,this.beginIndex=h,this.endIndex=m}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,pn),m=c.parse(o[2],2,ar);if(!h||!m)return null;if(!lb(h.type,[Zo(pn),wn,pn]))return c.error(`Expected first argument to be of type array or string, but found ${zi(h.type)} instead`);if(o.length===4){const p=c.parse(o[3],3,ar);return p?new uv(h.type,h,m,p):null}return new uv(h.type,h,m)}evaluate(o){const c=this.input.evaluate(o),h=this.beginIndex.evaluate(o);if(!uf(c,["string","array"]))throw new $i(`Expected first argument to be of type array or string, but found ${zi(no(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(o);return c.slice(h,m)}return c.slice(h)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function o2(d,o){return d==="=="||d==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function a2(d,o,c,h){return h.compare(o,c)===0}function bf(d,o,c){const h=d!=="=="&&d!=="!=";return class koe{constructor(p,v,T){this.type=ln,this.lhs=p,this.rhs=v,this.collator=T,this.hasUntypedArgument=p.type.kind==="value"||v.type.kind==="value"}static parse(p,v){if(p.length!==3&&p.length!==4)return v.error("Expected two or three arguments.");const T=p[0];let M=v.parse(p[1],1,pn);if(!M)return null;if(!o2(T,M.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${zi(M.type)}'.`);let O=v.parse(p[2],2,pn);if(!O)return null;if(!o2(T,O.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${zi(O.type)}'.`);if(M.type.kind!==O.type.kind&&M.type.kind!=="value"&&O.type.kind!=="value")return v.error(`Cannot compare types '${zi(M.type)}' and '${zi(O.type)}'.`);h&&(M.type.kind==="value"&&O.type.kind!=="value"?M=new ds(O.type,[M]):M.type.kind!=="value"&&O.type.kind==="value"&&(O=new ds(M.type,[O])));let w=null;if(p.length===4){if(M.type.kind!=="string"&&O.type.kind!=="string"&&M.type.kind!=="value"&&O.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(w=v.parse(p[3],3,Dc),!w)return null}return new koe(M,O,w)}evaluate(p){const v=this.lhs.evaluate(p),T=this.rhs.evaluate(p);if(h&&this.hasUntypedArgument){const M=no(v),O=no(T);if(M.kind!==O.kind||M.kind!=="string"&&M.kind!=="number")throw new $i(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${M.kind}, ${O.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const M=no(v),O=no(T);if(M.kind!=="string"||O.kind!=="string")return o(p,v,T)}return this.collator?c(p,v,T,this.collator.evaluate(p)):o(p,v,T)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[d];return this.eachChild(v=>{p.push(v.serialize())}),p}}}const XR=bf("==",function(d,o,c){return o===c},a2),YR=bf("!=",function(d,o,c){return o!==c},function(d,o,c,h){return!a2(0,o,c,h)}),KR=bf("<",function(d,o,c){return o<c},function(d,o,c,h){return h.compare(o,c)<0}),JR=bf(">",function(d,o,c){return o>c},function(d,o,c,h){return h.compare(o,c)>0}),QR=bf("<=",function(d,o,c){return o<=c},function(d,o,c,h){return h.compare(o,c)<=0}),eD=bf(">=",function(d,o,c){return o>=c},function(d,o,c,h){return h.compare(o,c)>=0});class Gm{constructor(o,c,h,m,p,v){this.type=wn,this.number=o,this.locale=c,this.currency=h,this.unit=m,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(o,c){if(o.length!==3)return c.error("Expected two arguments.");const h=c.parse(o[1],1,ar);if(!h)return null;const m=o[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let p=null;if(m.locale&&(p=c.parseObjectValue(m.locale,2,"locale",wn),!p))return null;let v=null;if(m.currency&&(v=c.parseObjectValue(m.currency,2,"currency",wn),!v))return null;let T=null;if(m.unit&&(T=c.parseObjectValue(m.unit,2,"unit",wn),!T))return null;let M=null;if(m["min-fraction-digits"]&&(M=c.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",ar),!M))return null;let O=null;return m["max-fraction-digits"]&&(O=c.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",ar),!O)?null:new Gm(h,p,v,T,M,O)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Cb{constructor(o){this.type=ar,this.input=o}static parse(o,c){if(o.length!==2)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const h=c.parse(o[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${zi(h.type)} instead.`):new Cb(h):null}evaluate(o){const c=this.input.evaluate(o);if(typeof c=="string"||Array.isArray(c))return c.length;throw new $i(`Expected value to be of type string or array, but found ${zi(no(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(c=>{o.push(c.serialize())}),o}}function Pb(d){return function(){d=1831565813+(d|=0)|0;let o=Math.imul(d^d>>>15,1|d);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const wf={"==":XR,"!=":YR,">":JR,"<":KR,">=":eD,"<=":QR,array:ds,at:Sb,"at-interpolated":Tb,boolean:ds,case:Mb,coalesce:sv,collator:Wd,format:df,image:$u,in:Eb,"index-of":cv,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:Cb,let:lv,literal:Nc,match:Ab,number:ds,"number-format":Gm,object:ds,slice:uv,step:rc,string:ds,"to-boolean":jc,"to-color":jc,"to-number":jc,"to-string":jc,var:Yd,within:Fc,distance:Gu,config:Xd};function s2(d,[o,c,h,m]){o=o.evaluate(d),c=c.evaluate(d),h=h.evaluate(d);const p=m?m.evaluate(d):1,v=Rm(o,c,h,p);if(v)throw new $i(v);return new An(o/255*p,c/255*p,h/255*p,p)}function l2(d,[o,c,h,m]){o=o.evaluate(d),c=c.evaluate(d),h=h.evaluate(d);const p=m?m.evaluate(d):1,v=function(O,w,P,D){return typeof O=="number"&&O>=0&&O<=360?typeof w=="number"&&w>=0&&w<=100&&typeof P=="number"&&P>=0&&P<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[O,w,P,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[O,w,P,D]:[O,w,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[O,w,P,D]:[O,w,P]).join(", ")}]: 'h' must be between 0 and 360.`}(o,c,h,p);if(v)throw new $i(v);const T=`hsla(${o}, ${c}%, ${h}%, ${p})`,M=An.parse(T);if(!M)throw new $i(`Failed to parse HSLA color: ${T}`);return M}function Ib(d,o){return d in o}function dv(d,o){const c=o[d];return c===void 0?null:c}function Bs(d){return{type:d}}function Ob(d){return{result:"success",value:d}}function Vc(d){return{result:"error",value:d}}function kb(d,o){return!!d&&!!d.parameters&&d.parameters.indexOf(o)>-1}function Sf(d){return d["property-type"]==="data-driven"}function hv(d){return kb(d.expression,"measure-light")}function c2(d){return kb(d.expression,"zoom")}function Rb(d){return!!d.expression&&d.expression.interpolated}function fv(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}function u2(d){return d}function d2(d,o){const c=o.type==="color",h=d.stops&&typeof d.stops[0][0]=="object",m=h||!(h||d.property!==void 0),p=d.type||(Rb(o)?"exponential":"interval");if(c&&((d=fn({},d)).stops&&(d.stops=d.stops.map(O=>[O[0],An.parse(O[1])])),d.default=An.parse(d.default?d.default:o.default)),d.colorSpace&&d.colorSpace!=="rgb"&&!i2[d.colorSpace])throw new Error(`Unknown color space: ${d.colorSpace}`);let v,T,M;if(p==="exponential")v=Db;else if(p==="interval")v=h2;else if(p==="categorical"){v=tD,T=Object.create(null);for(const O of d.stops)T[O[0]]=O[1];M=typeof d.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);v=pv}if(h){const O={},w=[];for(let I=0;I<d.stops.length;I++){const k=d.stops[I],N=k[0].zoom;O[N]===void 0&&(O[N]={zoom:N,type:d.type,property:d.property,default:d.default,stops:[]},w.push(N)),O[N].stops.push([k[0].value,k[1]])}const P=[];for(const I of w)P.push([O[I].zoom,d2(O[I],o)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:hs.interpolationFactor.bind(void 0,D),zoomStops:P.map(I=>I[0]),evaluate:({zoom:I},k)=>Db({stops:P,base:d.base},o,I).evaluate(I,k)}}if(m){const O=p==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:hs.interpolationFactor.bind(void 0,O),zoomStops:d.stops.map(w=>w[0]),evaluate:({zoom:w})=>v(d,o,w,T,M)}}return{kind:"source",evaluate(O,w){const P=w&&w.properties?w.properties[d.property]:void 0;return P===void 0?qm(d.default,o.default):v(d,o,P,T,M)}}}function qm(d,o,c){return d!==void 0?d:o!==void 0?o:c!==void 0?c:void 0}function tD(d,o,c,h,m){return qm(typeof c===m?h[c]:void 0,d.default,o.default)}function h2(d,o,c){if(zc(c)!=="number")return qm(d.default,o.default);const h=d.stops.length;if(h===1||c<=d.stops[0][0])return d.stops[0][1];if(c>=d.stops[h-1][0])return d.stops[h-1][1];const m=Um(d.stops.map(p=>p[0]),c);return d.stops[m][1]}function Db(d,o,c){const h=d.base!==void 0?d.base:1;if(zc(c)!=="number")return qm(d.default,o.default);const m=d.stops.length;if(m===1||c<=d.stops[0][0])return d.stops[0][1];if(c>=d.stops[m-1][0])return d.stops[m-1][1];const p=Um(d.stops.map(w=>w[0]),c),v=function(w,P,D,I){const k=I-D,N=w-D;return k===0?0:P===1?N/k:(Math.pow(P,N)-1)/(Math.pow(P,k)-1)}(c,h,d.stops[p][0],d.stops[p+1][0]),T=d.stops[p][1],M=d.stops[p+1][1];let O=Im[o.type]||u2;if(d.colorSpace&&d.colorSpace!=="rgb"){const w=i2[d.colorSpace];O=(P,D)=>w.reverse(w.interpolate(w.forward(P),w.forward(D),v))}return typeof T.evaluate=="function"?{evaluate(...w){const P=T.evaluate.apply(void 0,w),D=M.evaluate.apply(void 0,w);if(P!==void 0&&D!==void 0)return O(P,D,v)}}:O(T,M,v)}function pv(d,o,c){return o.type==="color"?c=An.parse(c):o.type==="formatted"?c=aa.fromString(c.toString()):o.type==="resolvedImage"?c=sa.build(c.toString()):zc(c)===o.type||o.type==="enum"&&o.values[c]||(c=void 0),qm(c,d.default,o.default)}xa.register(wf,{error:[{kind:"error"},[wn],(d,[o])=>{throw new $i(o.evaluate(d))}],typeof:[wn,[pn],(d,[o])=>zi(no(o.evaluate(d)))],"to-rgba":[Zo(ar,4),[oa],(d,[o])=>o.evaluate(d).toRenderColor(null).toArray()],"to-hsla":[Zo(ar,4),[oa],(d,[o])=>o.evaluate(d).toRenderColor(null).toHslaArray()],rgb:[oa,[ar,ar,ar],s2],rgba:[oa,[ar,ar,ar,ar],s2],hsl:[oa,[ar,ar,ar],l2],hsla:[oa,[ar,ar,ar,ar],l2],has:{type:ln,overloads:[[[wn],(d,[o])=>Ib(o.evaluate(d),d.properties())],[[wn,lf],(d,[o,c])=>Ib(o.evaluate(d),c.evaluate(d))]]},get:{type:pn,overloads:[[[wn],(d,[o])=>dv(o.evaluate(d),d.properties())],[[wn,lf],(d,[o,c])=>dv(o.evaluate(d),c.evaluate(d))]]},"feature-state":[pn,[wn],(d,[o])=>dv(o.evaluate(d),d.featureState||{})],properties:[lf,[],d=>d.properties()],"geometry-type":[wn,[],d=>d.geometryType()],id:[pn,[],d=>d.id()],zoom:[ar,[],d=>d.globals.zoom],pitch:[ar,[],d=>d.globals.pitch||0],"distance-from-center":[ar,[],d=>d.distanceFromCenter()],"measure-light":[ar,[wn],(d,[o])=>d.measureLight(o.evaluate(d))],"heatmap-density":[ar,[],d=>d.globals.heatmapDensity||0],"line-progress":[ar,[],d=>d.globals.lineProgress||0],"raster-value":[ar,[],d=>d.globals.rasterValue||0],"raster-particle-speed":[ar,[],d=>d.globals.rasterParticleSpeed||0],"sky-radial-progress":[ar,[],d=>d.globals.skyRadialProgress||0],accumulated:[pn,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[ar,Bs(ar),(d,o)=>{let c=0;for(const h of o)c+=h.evaluate(d);return c}],"*":[ar,Bs(ar),(d,o)=>{let c=1;for(const h of o)c*=h.evaluate(d);return c}],"-":{type:ar,overloads:[[[ar,ar],(d,[o,c])=>o.evaluate(d)-c.evaluate(d)],[[ar],(d,[o])=>-o.evaluate(d)]]},"/":[ar,[ar,ar],(d,[o,c])=>o.evaluate(d)/c.evaluate(d)],"%":[ar,[ar,ar],(d,[o,c])=>o.evaluate(d)%c.evaluate(d)],ln2:[ar,[],()=>Math.LN2],pi:[ar,[],()=>Math.PI],e:[ar,[],()=>Math.E],"^":[ar,[ar,ar],(d,[o,c])=>Math.pow(o.evaluate(d),c.evaluate(d))],sqrt:[ar,[ar],(d,[o])=>Math.sqrt(o.evaluate(d))],log10:[ar,[ar],(d,[o])=>Math.log(o.evaluate(d))/Math.LN10],ln:[ar,[ar],(d,[o])=>Math.log(o.evaluate(d))],log2:[ar,[ar],(d,[o])=>Math.log(o.evaluate(d))/Math.LN2],sin:[ar,[ar],(d,[o])=>Math.sin(o.evaluate(d))],cos:[ar,[ar],(d,[o])=>Math.cos(o.evaluate(d))],tan:[ar,[ar],(d,[o])=>Math.tan(o.evaluate(d))],asin:[ar,[ar],(d,[o])=>Math.asin(o.evaluate(d))],acos:[ar,[ar],(d,[o])=>Math.acos(o.evaluate(d))],atan:[ar,[ar],(d,[o])=>Math.atan(o.evaluate(d))],min:[ar,Bs(ar),(d,o)=>Math.min(...o.map(c=>c.evaluate(d)))],max:[ar,Bs(ar),(d,o)=>Math.max(...o.map(c=>c.evaluate(d)))],abs:[ar,[ar],(d,[o])=>Math.abs(o.evaluate(d))],round:[ar,[ar],(d,[o])=>{const c=o.evaluate(d);return c<0?-Math.round(-c):Math.round(c)}],floor:[ar,[ar],(d,[o])=>Math.floor(o.evaluate(d))],ceil:[ar,[ar],(d,[o])=>Math.ceil(o.evaluate(d))],"filter-==":[ln,[wn,pn],(d,[o,c])=>d.properties()[o.value]===c.value],"filter-id-==":[ln,[pn],(d,[o])=>d.id()===o.value],"filter-type-==":[ln,[wn],(d,[o])=>d.geometryType()===o.value],"filter-<":[ln,[wn,pn],(d,[o,c])=>{const h=d.properties()[o.value],m=c.value;return typeof h==typeof m&&h<m}],"filter-id-<":[ln,[pn],(d,[o])=>{const c=d.id(),h=o.value;return typeof c==typeof h&&c<h}],"filter->":[ln,[wn,pn],(d,[o,c])=>{const h=d.properties()[o.value],m=c.value;return typeof h==typeof m&&h>m}],"filter-id->":[ln,[pn],(d,[o])=>{const c=d.id(),h=o.value;return typeof c==typeof h&&c>h}],"filter-<=":[ln,[wn,pn],(d,[o,c])=>{const h=d.properties()[o.value],m=c.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[ln,[pn],(d,[o])=>{const c=d.id(),h=o.value;return typeof c==typeof h&&c<=h}],"filter->=":[ln,[wn,pn],(d,[o,c])=>{const h=d.properties()[o.value],m=c.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[ln,[pn],(d,[o])=>{const c=d.id(),h=o.value;return typeof c==typeof h&&c>=h}],"filter-has":[ln,[pn],(d,[o])=>o.value in d.properties()],"filter-has-id":[ln,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[ln,[Zo(wn)],(d,[o])=>o.value.indexOf(d.geometryType())>=0],"filter-id-in":[ln,[Zo(pn)],(d,[o])=>o.value.indexOf(d.id())>=0],"filter-in-small":[ln,[wn,Zo(pn)],(d,[o,c])=>c.value.indexOf(d.properties()[o.value])>=0],"filter-in-large":[ln,[wn,Zo(pn)],(d,[o,c])=>function(h,m,p,v){for(;p<=v;){const T=p+v>>1;if(m[T]===h)return!0;m[T]>h?v=T-1:p=T+1}return!1}(d.properties()[o.value],c.value,0,c.value.length-1)],all:{type:ln,overloads:[[[ln,ln],(d,[o,c])=>o.evaluate(d)&&c.evaluate(d)],[Bs(ln),(d,o)=>{for(const c of o)if(!c.evaluate(d))return!1;return!0}]]},any:{type:ln,overloads:[[[ln,ln],(d,[o,c])=>o.evaluate(d)||c.evaluate(d)],[Bs(ln),(d,o)=>{for(const c of o)if(c.evaluate(d))return!0;return!1}]]},"!":[ln,[ln],(d,[o])=>!o.evaluate(d)],"is-supported-script":[ln,[wn],(d,[o])=>{const c=d.globals&&d.globals.isSupportedScript;return!c||c(o.evaluate(d))}],upcase:[wn,[wn],(d,[o])=>o.evaluate(d).toUpperCase()],downcase:[wn,[wn],(d,[o])=>o.evaluate(d).toLowerCase()],concat:[wn,Bs(pn),(d,o)=>o.map(c=>Oo(c.evaluate(d))).join("")],"resolved-locale":[wn,[Dc],(d,[o])=>o.evaluate(d).resolvedLocale()],random:[ar,[ar,ar,pn],(d,o)=>{const[c,h,m]=o.map(v=>v.evaluate(d));if(c>h||c===h)return c;let p;if(typeof m=="string")p=function(v){let T=0;if(v.length===0)return T;for(let M=0;M<v.length;M++)T=(T<<5)-T+v.charCodeAt(M),T|=0;return T}(m);else{if(typeof m!="number")throw new $i(`Invalid seed input: ${m}`);p=m}return c+Pb(p)()*(h-c)}]});class Lb{constructor(o,c,h,m){this.expression=o,this._warningHistory={},this._evaluator=new Yy(h,m),this._defaultValue=c?function(p){return p.type==="color"&&(fv(p.default)||Array.isArray(p.default))?new An(0,0,0,0):p.type==="color"?An.parse(p.default)||null:p.default===void 0?null:p.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this.configDependencies=$m(o)}evaluateWithoutErrorHandling(o,c,h,m,p,v,T,M){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=h,this._evaluator.canonical=m||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(o,c,h,m,p,v,T,M){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=M||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new $i(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function mv(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in wf}function Tf(d,o,c,h){const m=new gb(wf,[],o?function(v){const T={color:oa,string:wn,number:ar,enum:wn,boolean:ln,formatted:Om,resolvedImage:Lc};return v.type==="array"?Zo(T[v.value]||pn,v.length):T[v.type]}(o):void 0,void 0,void 0,c,h),p=m.parse(d,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Ob(new Lb(p,o,c,h)):Vc(m.errors)}class Nb{constructor(o,c,h,m){this.kind=o,this._styleExpression=c,this.isLightConstant=h,this.isLineProgressConstant=m,this.isStateDependent=o!=="constant"&&!Bm(c.expression),this.configDependencies=$m(c.expression)}evaluateWithoutErrorHandling(o,c,h,m,p,v){return this._styleExpression.evaluateWithoutErrorHandling(o,c,h,m,p,v)}evaluate(o,c,h,m,p,v){return this._styleExpression.evaluate(o,c,h,m,p,v)}}class Ef{constructor(o,c,h,m,p,v){this.kind=o,this.zoomStops=h,this._styleExpression=c,this.isStateDependent=o!=="camera"&&!Bm(c.expression),this.isLightConstant=p,this.isLineProgressConstant=v,this.configDependencies=$m(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(o,c,h,m,p,v){return this._styleExpression.evaluateWithoutErrorHandling(o,c,h,m,p,v)}evaluate(o,c,h,m,p,v){return this._styleExpression.evaluate(o,c,h,m,p,v)}interpolationFactor(o,c,h){return this.interpolationType?hs.interpolationFactor(this.interpolationType,o,c,h):0}}function zb(d,o,c,h){if((d=Tf(d,o,c,h)).result==="error")return d;const m=d.value.expression,p=vf(m);if(!p&&!Sf(o))return Vc([new Fs("","data expressions not supported")]);const v=Uc(m,["zoom","pitch","distance-from-center"]);if(!v&&!c2(o))return Vc([new Fs("","zoom expressions not supported")]);const T=Uc(m,["measure-light"]);if(!T&&!hv(o))return Vc([new Fs("","measure-light expression not supported")]);const M=Uc(m,["line-progress"]);if(!M&&!function(P){return kb(P.expression,"line-progress")}(o))return Vc([new Fs("","line-progress expression not supported")]);const O=o.expression&&o.expression.relaxZoomRestriction,w=yv(m);return w||v||O?w instanceof Fs?Vc([w]):w instanceof hs&&!Rb(o)?Vc([new Fs("",'"interpolate" expressions cannot be used with this property')]):Ob(w?new Ef(p&&M?"camera":"composite",d.value,w.labels,w instanceof hs?w.interpolation:void 0,T,M):new Nb(p&&M?"constant":"source",d.value,T,M)):Vc([new Fs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class gv{constructor(o,c){this._parameters=o,this._specification=c,fn(this,d2(this._parameters,this._specification))}static deserialize(o){return new gv(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function yv(d){let o=null;if(d instanceof lv)o=yv(d.result);else if(d instanceof sv){for(const c of d.args)if(o=yv(c),o)break}else(d instanceof rc||d instanceof hs)&&d.input instanceof xa&&d.input.name==="zoom"&&(o=d);return o instanceof Fs||d.eachChild(c=>{const h=yv(c);h instanceof Fs?o=h:o&&h&&o!==h&&(o=new Fs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var Hm,f2,p2=function(){if(f2)return Hm;f2=1,Hm=o;var d=3;function o(c,h,m){var p=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var v=new Int32Array(this.arrayBuffer);c=v[0],this.d=(h=v[1])+2*(m=v[2]);for(var T=0;T<this.d*this.d;T++){var M=v[d+T],O=v[d+T+1];p.push(M===O?null:v.subarray(M,O))}var w=v[d+p.length+1];this.keys=v.subarray(v[d+p.length],w),this.bboxes=v.subarray(w),this.insert=this._insertReadonly}else{this.d=h+2*m;for(var P=0;P<this.d*this.d;P++)p.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=c,this.padding=m,this.scale=h/c,this.uid=0;var D=m/h*c;this.min=-D,this.max=c+D}return o.prototype.insert=function(c,h,m,p,v){this._forEachCell(h,m,p,v,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(p),this.bboxes.push(v)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(c,h,m,p,v,T){this.cells[v].push(T)},o.prototype.query=function(c,h,m,p,v){var T=this.min,M=this.max;if(c<=T&&h<=T&&M<=m&&M<=p&&!v)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(c,h,m,p,this._queryCell,O,{},v),O},o.prototype._queryCell=function(c,h,m,p,v,T,M,O){var w=this.cells[v];if(w!==null)for(var P=this.keys,D=this.bboxes,I=0;I<w.length;I++){var k=w[I];if(M[k]===void 0){var N=4*k;(O?O(D[N+0],D[N+1],D[N+2],D[N+3]):c<=D[N+2]&&h<=D[N+3]&&m>=D[N+0]&&p>=D[N+1])?(M[k]=!0,T.push(P[k])):M[k]=!1}}},o.prototype._forEachCell=function(c,h,m,p,v,T,M,O){for(var w=this._convertToCellCoord(c),P=this._convertToCellCoord(h),D=this._convertToCellCoord(m),I=this._convertToCellCoord(p),k=w;k<=D;k++)for(var N=P;N<=I;N++){var W=this.d*N+k;if((!O||O(this._convertFromCellCoord(k),this._convertFromCellCoord(N),this._convertFromCellCoord(k+1),this._convertFromCellCoord(N+1)))&&v.call(this,c,h,m,p,W,T,M,O))return}},o.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},o.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,h=d+this.cells.length+1+1,m=0,p=0;p<this.cells.length;p++)m+=this.cells[p].length;var v=new Int32Array(h+m+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=h,M=0;M<c.length;M++){var O=c[M];v[d+M]=T,v.set(O,T),T+=O.length}return v[d+c.length]=T,v.set(this.keys,T),v[d+c.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},Hm}(),Af=_(p2);const vv={};function Jt(d,o,c={}){Object.defineProperty(d,"_classRegistryKey",{value:o,writable:!1}),vv[o]={klass:d,omit:c.omit||[]}}Jt(Object,"Object"),Af.serialize=function(d,o){const c=d.toArrayBuffer();return o&&o.add(c),{buffer:c}},Af.deserialize=function(d){return new Af(d.buffer)},Object.defineProperty(Af,"name",{value:"Grid"}),Jt(Af,"Grid"),typeof DOMMatrix<"u"&&Jt(DOMMatrix,"DOMMatrix"),Jt(An,"Color"),Jt(Error,"Error"),Jt(aa,"Formatted"),Jt(km,"FormattedSection"),Jt(Fo,"AJAXError"),Jt(sa,"ResolvedImage"),Jt(gv,"StylePropertyFunction"),Jt(Lb,"StyleExpression",{omit:["_evaluator"]}),Jt(Oa,"ImageId"),Jt(tc,"ImageVariant"),Jt(Ef,"ZoomDependentExpression"),Jt(Nb,"ZoomConstantExpression"),Jt(xa,"CompoundExpression",{omit:["_evaluate"]});for(const d in wf)vv[wf[d]._classRegistryKey]||Jt(wf[d],`Expression${d}`);function jb(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function Fb(d){return self.ImageBitmap&&d instanceof ImageBitmap}function qu(d,o){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(jb(d)||Fb(d))return o&&o.add(d),d;if(ArrayBuffer.isView(d))return o&&o.add(d.buffer),d;if(d instanceof ImageData)return o&&o.add(d.data.buffer),d;if(Array.isArray(d)){const c=[];for(const h of d)c.push(qu(h,o));return c}if(d instanceof Map){const c={$name:"Map",entries:[]};for(const[h,m]of d.entries())c.entries.push(qu(h),qu(m));return c}if(d instanceof Set){const c={$name:"Set"};let h=0;for(const m of d.values())c[++h]=qu(m);return c}if(d instanceof DOMMatrix){const c={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const m of h)c[m]=d[m];return c}if(typeof d=="bigint")return{$name:"BigInt",value:d.toString()};if(typeof d=="object"){const c=d.constructor,h=c._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${c.name}".`);const m=c.serialize?c.serialize(d,o):{};if(!c.serialize){for(const p in d)d.hasOwnProperty(p)&&(vv[h].omit.indexOf(p)>=0||(m[p]=qu(d[p],o)));d instanceof Error&&(m.message=d.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(m.$name=h),m}throw new Error("can't serialize object of type "+typeof d)}function fs(d){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||jb(d)||Fb(d)||ArrayBuffer.isView(d)||d instanceof ImageData)return d;if(Array.isArray(d))return d.map(fs);if(typeof d=="object"){const o=d.$name||"Object";if(o==="Map"){const m=d.entries||[],p=new Map;for(let v=0;v<m.length;v+=2)p.set(fs(m[v]),fs(m[v+1]));return p}if(o==="Set"){const m=new Set;for(const p of Object.keys(d))p!=="$name"&&m.add(fs(d[p]));return m}if(o==="DOMMatrix"){let m;return m=d.is2D?[d.a,d.b,d.c,d.d,d.e,d.f]:[d.m11,d.m12,d.m13,d.m14,d.m21,d.m22,d.m23,d.m24,d.m31,d.m32,d.m33,d.m34,d.m41,d.m42,d.m43,d.m44],new DOMMatrix(m)}if(o==="BigInt")return BigInt(d.value);const{klass:c}=vv[o];if(!c)throw new Error(`Can't deserialize unregistered class "${o}".`);if(c.deserialize)return c.deserialize(d);const h=Object.create(c.prototype);for(const m of Object.keys(d))m!=="$name"&&(h[m]=fs(d[m]));return h}throw new Error("can't deserialize object of type "+typeof d)}const pr={"Latin-1 Supplement":d=>d>=128&&d<=255,Arabic:d=>d>=1536&&d<=1791,"Arabic Supplement":d=>d>=1872&&d<=1919,"Arabic Extended-A":d=>d>=2208&&d<=2303,"Hangul Jamo":d=>d>=4352&&d<=4607,"Unified Canadian Aboriginal Syllabics":d=>d>=5120&&d<=5759,Khmer:d=>d>=6016&&d<=6143,"Unified Canadian Aboriginal Syllabics Extended":d=>d>=6320&&d<=6399,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"CJK Radicals Supplement":d=>d>=11904&&d<=12031,"Kangxi Radicals":d=>d>=12032&&d<=12255,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Bopomofo:d=>d>=12544&&d<=12591,"Hangul Compatibility Jamo":d=>d>=12592&&d<=12687,Kanbun:d=>d>=12688&&d<=12703,"Bopomofo Extended":d=>d>=12704&&d<=12735,"CJK Strokes":d=>d>=12736&&d<=12783,"Katakana Phonetic Extensions":d=>d>=12784&&d<=12799,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"CJK Unified Ideographs Extension A":d=>d>=13312&&d<=19903,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Yi Syllables":d=>d>=40960&&d<=42127,"Yi Radicals":d=>d>=42128&&d<=42191,"Hangul Jamo Extended-A":d=>d>=43360&&d<=43391,"Hangul Syllables":d=>d>=44032&&d<=55215,"Hangul Jamo Extended-B":d=>d>=55216&&d<=55295,"Private Use Area":d=>d>=57344&&d<=63743,"CJK Compatibility Ideographs":d=>d>=63744&&d<=64255,"Arabic Presentation Forms-A":d=>d>=64336&&d<=65023,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Arabic Presentation Forms-B":d=>d>=65136&&d<=65279,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519,Osage:d=>d>=66736&&d<=66815,"CJK Unified Ideographs Extension B":d=>d>=131072&&d<=173791};function Bb(d){for(const o of d)if(_v(o.charCodeAt(0)))return!0;return!1}function rD(d){for(const o of d)if(!m2(o.charCodeAt(0)))return!1;return!0}function m2(d){return!(pr.Arabic(d)||pr["Arabic Supplement"](d)||pr["Arabic Extended-A"](d)||pr["Arabic Presentation Forms-A"](d)||pr["Arabic Presentation Forms-B"](d))}function _v(d){return!(d!==746&&d!==747&&(d<4352||!(pr["Bopomofo Extended"](d)||pr.Bopomofo(d)||pr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||pr["CJK Compatibility Ideographs"](d)||pr["CJK Compatibility"](d)||pr["CJK Radicals Supplement"](d)||pr["CJK Strokes"](d)||!(!pr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||pr["CJK Unified Ideographs Extension A"](d)||pr["CJK Unified Ideographs"](d)||pr["Enclosed CJK Letters and Months"](d)||pr["Hangul Compatibility Jamo"](d)||pr["Hangul Jamo Extended-A"](d)||pr["Hangul Jamo Extended-B"](d)||pr["Hangul Jamo"](d)||pr["Hangul Syllables"](d)||pr.Hiragana(d)||pr["Ideographic Description Characters"](d)||pr.Kanbun(d)||pr["Kangxi Radicals"](d)||pr["Katakana Phonetic Extensions"](d)||pr.Katakana(d)&&d!==12540||!(!pr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!pr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||pr["Unified Canadian Aboriginal Syllabics"](d)||pr["Unified Canadian Aboriginal Syllabics Extended"](d)||pr["Vertical Forms"](d)||pr["Yijing Hexagram Symbols"](d)||pr["Yi Syllables"](d)||pr["Yi Radicals"](d))))}function $b(d){return!(_v(d)||function(o){return!!(pr["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||pr["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||pr["Letterlike Symbols"](o)||pr["Number Forms"](o)||pr["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||pr["Control Pictures"](o)&&o!==9251||pr["Optical Character Recognition"](o)||pr["Enclosed Alphanumerics"](o)||pr["Geometric Shapes"](o)||pr["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||pr["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||pr["CJK Symbols and Punctuation"](o)||pr.Katakana(o)||pr["Private Use Area"](o)||pr["CJK Compatibility Forms"](o)||pr["Small Form Variants"](o)||pr["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(d))}function g2(d){return pr.Arabic(d)||pr["Arabic Supplement"](d)||pr["Arabic Extended-A"](d)||pr["Arabic Presentation Forms-A"](d)||pr["Arabic Presentation Forms-B"](d)}function xv(d){return d>=1424&&d<=2303||pr["Arabic Presentation Forms-A"](d)||pr["Arabic Presentation Forms-B"](d)}function Ub(d,o){return!(!o&&xv(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||pr.Khmer(d))}function y2(d){for(const o of d)if(xv(o.charCodeAt(0)))return!0;return!1}const Vb="deferred",nc="loading",Wb="loaded";let Gb=null,ka="unavailable",Hu=null;const Zm=function(d){d&&typeof d=="string"&&d.indexOf("NetworkError")>-1&&(ka="error"),Gb&&Gb(d)};function bv(){Mf.fire(new Ua("pluginStateChange",{pluginStatus:ka,pluginURL:Hu}))}const Mf=new xl,wv=function(){return ka},v2=function(){if(ka!==Vb||!Hu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ka=nc,bv(),Hu&&Rc({url:Hu},d=>{d?Zm(d):(ka=Wb,bv())})},$s={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ka===Wb||$s.applyArabicShaping!=null,isLoading:()=>ka===nc,setState(d){ka=d.pluginStatus,Hu=d.pluginURL},isParsed:()=>$s.applyArabicShaping!=null&&$s.processBidirectionalText!=null&&$s.processStyledBidirectionalText!=null,getPluginURL:()=>Hu};class $n{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch,this.brightness=c.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(c,h){for(const m of c)if(!Ub(m.charCodeAt(0),h))return!1;return!0}(o,$s.isLoaded())}}class Cf{constructor(o,c,h,m){this.property=o,this.value=c,this.expression=function(p,v,T,M){if(fv(p))return new gv(p,v);if(mv(p)||Array.isArray(p)&&p.length>0){const O=zb(p,v,T,M);if(O.result==="error")throw new Error(O.value.map(w=>`${w.key}: ${w.message}`).join(", "));return O.value}{let O=p;return typeof p=="string"&&v.type==="color"&&(O=An.parse(p)),{kind:"constant",configDependencies:new Set,evaluate:()=>O}}}(c===void 0?o.specification.default:c,o.specification,h,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,c,h){return this.property.possiblyEvaluate(this,o,c,h)}}class qb{constructor(o,c,h){this.property=o,this.value=new Cf(o,void 0,c,h)}transitioned(o,c){return new Sv(this.property,this.value,c,Pi({},o.transition,this.transition),o.now)}untransitioned(){return new Sv(this.property,this.value,null,{},0)}}class Hb{constructor(o,c,h){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=c,this._options=h,this.configDependencies=new Set}getValue(o){return Co(this._values[o].value.value)}setValue(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new qb(this._values[o].property,this._scope,this._options)),this._values[o].value=new Cf(this._values[o].property,c===null?void 0:Co(c),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,c){c&&(this._options=c);const h=this._properties.properties;if(o)for(const m in o){const p=o[m];if(m.endsWith("-transition")){const v=m.slice(0,-11);h[v]&&this.setTransition(v,p)}else h.hasOwnProperty(m)&&this.setValue(m,p)}}getTransition(o){return Co(this._values[o].transition)}setTransition(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new qb(this._values[o].property)),this._values[o].transition=Co(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const h=this.getValue(c);h!==void 0&&(o[c]=h);const m=this.getTransition(c);m!==void 0&&(o[`${c}-transition`]=m)}return o}transitioned(o,c){const h=new Xm(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(o,c._values[m]);return h}untransitioned(){const o=new Xm(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class Sv{constructor(o,c,h,m,p){const v=m.delay||0,T=m.duration||0;p=p||0,this.property=o,this.value=c,this.begin=p+v,this.end=this.begin+T,o.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(o,c,h){const m=o.now||0,p=this.value.possiblyEvaluate(o,c,h),v=this.prior;if(v){if(m>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(m<this.begin)return v.possiblyEvaluate(o,c,h);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(o,c,h),p,dr(T))}}return p}}class Xm{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,h){const m=new Of(this._properties);for(const p of Object.keys(this._values))m._values[p]=this._values[p].possiblyEvaluate(o,c,h);return m}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Pf{constructor(o,c,h){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=c,this._options=h,this.configDependencies=new Set}getValue(o){return Co(this._values[o].value)}setValue(o,c){this._values[o]=new Cf(this._values[o].property,c===null?void 0:Co(c),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const c of Object.keys(this._values)){const h=this.getValue(c);h!==void 0&&(o[c]=h)}return o}possiblyEvaluate(o,c,h){const m=new Of(this._properties);for(const p of Object.keys(this._values))m._values[p]=this._values[p].possiblyEvaluate(o,c,h);return m}}class If{constructor(o,c,h){this.property=o,this.value=c,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,c,h,m){return this.property.evaluate(this.value,this.parameters,o,c,h,m)}}class Of{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class zt{constructor(o){this.specification=o}possiblyEvaluate(o,c){return o.expression.evaluate(c)}interpolate(o,c,h){const m=Im[this.specification.type];return m?m(o,c,h):o}}class Yt{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,h,m){return new If(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(c,null,{},h,m)}:o.expression,c)}interpolate(o,c,h){if(o.value.kind!=="constant"||c.value.kind!=="constant")return o;if(o.value.value===void 0||c.value.value===void 0)return new If(this,{kind:"constant",value:void 0},o.parameters);const m=Im[this.specification.type];return m?new If(this,{kind:"constant",value:m(o.value.value,c.value.value,h)},o.parameters):o}evaluate(o,c,h,m,p,v){return o.kind==="constant"?o.value:o.evaluate(c,h,m,p,v)}}class kf{constructor(o){this.specification=o}possiblyEvaluate(o,c,h,m){return!!o.expression.evaluate(c,null,{},h,m)}interpolate(){return!1}}class bi{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new $n(0,{});for(const h in o){const m=o[h];m.specification.overridable&&this.overridableProperties.push(h);const p=this.defaultPropertyValues[h]=new Cf(m,void 0),v=this.defaultTransitionablePropertyValues[h]=new qb(m);this.defaultTransitioningPropertyValues[h]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=p.possiblyEvaluate(c)}}}Jt(Yt,"DataDrivenProperty"),Jt(zt,"DataConstantProperty"),Jt(kf,"ColorRampProperty");var it=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"iconsets":{"experimental":true,"type":"iconsets"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"required":true,"type":"enum","values":{"sprite":1}},"url":{"required":true,"type":"string"}},"iconset_source":{"type":{"required":true,"type":"enum","values":{"source":1}},"source":{"required":true,"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","experimental":true,"private":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","experimental":true,"private":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"experimental":true,"private":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function _2(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Tv(d){if(Array.isArray(d))return d.map(Tv);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const o={};for(const c in d)o[c]=Tv(d[c]);return o}return _2(d)}function Zb(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const o of d.slice(1))if(!Zb(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function Xb(d,o="",c=null,h="fill"){if(d==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zb(d)||(d=Ev(d));const m=d;let p=!0;try{p=function(w){if(!Rf(w))return w;let P=Tv(w);return b2(P),P=x2(P),P}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let v=null,T=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){T=it[`filter_${h}`];const w=Tf(p,T,o,c);if(w.result==="error")throw new Error(w.value.map(P=>`${P.key}: ${P.message}`).join(", "));v=(P,D,I)=>w.value.evaluate(P,D,{},I)}let M=null,O=null;if(p!==m){const w=Tf(m,T,o,c);if(w.result==="error")throw new Error(w.value.map(P=>`${P.key}: ${P.message}`).join(", "));M=(P,D,I,k,N)=>w.value.evaluate(P,D,{},I,void 0,void 0,k,N),O=!vf(w.value.expression)}return{filter:v,dynamicFilter:M||void 0,needGeometry:w2(p),needFeature:!!O}}function x2(d){if(!Array.isArray(d))return d;const o=function(c){if(nD.has(c[0])){for(let h=1;h<c.length;h++)if(Rf(c[h]))return!0}return c}(d);return o===!0?o:o.map(c=>x2(c))}function b2(d){let o=!1;const c=[];if(d[0]==="case"){for(let h=1;h<d.length-1;h+=2)o=o||Rf(d[h]),c.push(d[h+1]);c.push(d[d.length-1])}else if(d[0]==="match"){o=o||Rf(d[1]);for(let h=2;h<d.length-1;h+=2)c.push(d[h+1]);c.push(d[d.length-1])}else if(d[0]==="step"){o=o||Rf(d[1]);for(let h=1;h<d.length-1;h+=2)c.push(d[h+1])}o&&(d.length=0,d.push("any",...c));for(let h=1;h<d.length;h++)b2(d[h])}function Rf(d){if(!Array.isArray(d))return!1;if((o=d[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let c=1;c<d.length;c++)if(Rf(d[c]))return!0;return!1}const nD=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function iD(d,o){return d<o?-1:d>o?1:0}function w2(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let o=1;o<d.length;o++)if(w2(d[o]))return!0;return!1}function Ev(d){if(!d)return!0;const o=d[0];return d.length<=1?o!=="any":o==="=="?Zu(d[1],d[2],"=="):o==="!="?Kd(Zu(d[1],d[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Zu(d[1],d[2],o):o==="any"?(c=d.slice(1),["any"].concat(c.map(Ev))):o==="all"?["all"].concat(d.slice(1).map(Ev)):o==="none"?["all"].concat(d.slice(1).map(Ev).map(Kd)):o==="in"?Yb(d[1],d.slice(2)):o==="!in"?Kd(Yb(d[1],d.slice(2))):o==="has"?Kb(d[1]):o!=="!has"||Kd(Kb(d[1]));var c}function Zu(d,o,c){switch(d){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,d,o]}}function Yb(d,o){if(o.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",d,["literal",o.sort(iD)]]:["filter-in-small",d,["literal",o]]}}function Kb(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Kd(d){return["!",d]}const Av="";function Df(d,o){return o?`${d}${Av}${o}`:d}const Wc="-transition",S2=new Set(["fill","line","background","hillshade","raster"]);class ko extends xl{constructor(o,c,h,m,p){if(super(),this.id=o.id,this.fqid=Df(this.id,h),this.type=o.type,this.scope=h,this.lut=m,this.options=p,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const v=Tf(this.filter,it[`filter_${o.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),c.layout&&(this._unevaluatedLayout=new Pf(c.layout,this.scope,p),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),c.paint){this._transitionablePaint=new Hb(c.paint,this.scope,p);for(const v in o.paint)this.setPaintProperty(v,o.paint[v]);for(const v in o.layout)this.setLayoutProperty(v,o.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Of(c.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D(!0)&&S2.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c){if(this.type==="custom"&&o==="visibility")return void(this.visibility=c);const h=this._unevaluatedLayout;h._properties.properties[o]&&(h.setValue(o,c),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return o.endsWith(Wc)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c){const h=this._transitionablePaint,m=h._properties.properties;if(o.endsWith(Wc)){const P=o.slice(0,-11);return m[P]&&h.setTransition(P,c||void 0),!1}if(!m[o])return!1;const p=h._values[o],v=p.value.isDataDriven(),T=p.value;h.setValue(o,c),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const M=h._values[o].value,O=M.isDataDriven(),w=o.endsWith("pattern")||o==="line-dasharray";return O||v||w||this._handleOverridablePaintPropertyUpdate(o,T,M)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,c,h){return null}_handleOverridablePaintPropertyUpdate(o,c,h){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){return vl({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}is3D(o){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof If&&Sf(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=Xb(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,c,h,m,p,v,T,M,O){}}const oD={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ym{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function mn(d,o=1){let c=0,h=0;return{members:d.map(m=>{const p=oD[m.type].BYTES_PER_ELEMENT,v=c=T2(c,Math.max(o,p)),T=m.components||1;return h=Math.max(h,p),c+=p*T,{name:m.name,type:m.type,components:T,offset:v}}),size:T2(c,Math.max(h,o)),alignment:o}}function T2(d,o){return Math.ceil(d/o)*o}class Gc extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const m=2*o;return this.int16[m+0]=c,this.int16[m+1]=h,o}}Gc.prototype.bytesPerElement=4,Jt(Gc,"StructArrayLayout2i4");class Lf extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,h)}emplace(o,c,h,m){const p=3*o;return this.int16[p+0]=c,this.int16[p+1]=h,this.int16[p+2]=m,o}}Lf.prototype.bytesPerElement=6,Jt(Lf,"StructArrayLayout3i6");class qc extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,h,m)}emplace(o,c,h,m,p){const v=4*o;return this.int16[v+0]=c,this.int16[v+1]=h,this.int16[v+2]=m,this.int16[v+3]=p,o}}qc.prototype.bytesPerElement=8,Jt(qc,"StructArrayLayout4i8");class Jd extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}Jd.prototype.bytesPerElement=4,Jt(Jd,"StructArrayLayout1f4");class Km extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,h)}emplace(o,c,h,m){const p=4*o,v=2*o;return this.int16[p+0]=c,this.int16[p+1]=h,this.float32[v+1]=m,o}}Km.prototype.bytesPerElement=8,Jt(Km,"StructArrayLayout2i1f8");class Jb extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,h)}emplace(o,c,h,m){const p=4*o;return this.int16[p+0]=c,this.int16[p+1]=h,this.int16[p+2]=m,o}}Jb.prototype.bytesPerElement=8,Jt(Jb,"StructArrayLayout3i8");class Us extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,m,p)}emplace(o,c,h,m,p,v){const T=5*o;return this.int16[T+0]=c,this.int16[T+1]=h,this.int16[T+2]=m,this.int16[T+3]=p,this.int16[T+4]=v,o}}Us.prototype.bytesPerElement=10,Jt(Us,"StructArrayLayout5i10");class Qb extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,h,m,p,v,T)}emplace(o,c,h,m,p,v,T,M){const O=6*o,w=12*o,P=3*o;return this.int16[O+0]=c,this.int16[O+1]=h,this.uint8[w+4]=m,this.uint8[w+5]=p,this.uint8[w+6]=v,this.uint8[w+7]=T,this.float32[P+2]=M,o}}Qb.prototype.bytesPerElement=12,Jt(Qb,"StructArrayLayout2i4ub1f12");class Tl extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,h)}emplace(o,c,h,m){const p=3*o;return this.float32[p+0]=c,this.float32[p+1]=h,this.float32[p+2]=m,o}}Tl.prototype.bytesPerElement=12,Jt(Tl,"StructArrayLayout3f12");class Xu extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,m,p)}emplace(o,c,h,m,p,v){const T=6*o,M=3*o;return this.uint16[T+0]=c,this.uint16[T+1]=h,this.uint16[T+2]=m,this.uint16[T+3]=p,this.float32[M+2]=v,o}}Xu.prototype.bytesPerElement=12,Jt(Xu,"StructArrayLayout4ui1f12");class Mv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,h,m)}emplace(o,c,h,m,p){const v=4*o;return this.uint16[v+0]=c,this.uint16[v+1]=h,this.uint16[v+2]=m,this.uint16[v+3]=p,o}}Mv.prototype.bytesPerElement=8,Jt(Mv,"StructArrayLayout4ui8");class Cv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,h,m,p,v)}emplace(o,c,h,m,p,v,T){const M=6*o;return this.int16[M+0]=c,this.int16[M+1]=h,this.int16[M+2]=m,this.int16[M+3]=p,this.int16[M+4]=v,this.int16[M+5]=T,o}}Cv.prototype.bytesPerElement=12,Jt(Cv,"StructArrayLayout6i12");class e1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O,w,P,D){const I=this.length;return this.resize(I+1),this.emplace(I,o,c,h,m,p,v,T,M,O,w,P,D)}emplace(o,c,h,m,p,v,T,M,O,w,P,D,I){const k=12*o;return this.int16[k+0]=c,this.int16[k+1]=h,this.int16[k+2]=m,this.int16[k+3]=p,this.uint16[k+4]=v,this.uint16[k+5]=T,this.uint16[k+6]=M,this.uint16[k+7]=O,this.int16[k+8]=w,this.int16[k+9]=P,this.int16[k+10]=D,this.int16[k+11]=I,o}}e1.prototype.bytesPerElement=24,Jt(e1,"StructArrayLayout4i4ui4i24");class t1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,h,m,p,v)}emplace(o,c,h,m,p,v,T){const M=10*o,O=5*o;return this.int16[M+0]=c,this.int16[M+1]=h,this.int16[M+2]=m,this.float32[O+2]=p,this.float32[O+3]=v,this.float32[O+4]=T,o}}t1.prototype.bytesPerElement=20,Jt(t1,"StructArrayLayout3i3f20");class Qd extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,h,m)}emplace(o,c,h,m,p){const v=4*o;return this.float32[v+0]=c,this.float32[v+1]=h,this.float32[v+2]=m,this.float32[v+3]=p,o}}Qd.prototype.bytesPerElement=16,Jt(Qd,"StructArrayLayout4f16");class r1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}r1.prototype.bytesPerElement=4,Jt(r1,"StructArrayLayout1ul4");class Yu extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const m=2*o;return this.uint16[m+0]=c,this.uint16[m+1]=h,o}}Yu.prototype.bytesPerElement=4,Jt(Yu,"StructArrayLayout2ui4");class n1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O,w,P,D,I){const k=this.length;return this.resize(k+1),this.emplace(k,o,c,h,m,p,v,T,M,O,w,P,D,I)}emplace(o,c,h,m,p,v,T,M,O,w,P,D,I,k){const N=20*o,W=10*o;return this.int16[N+0]=c,this.int16[N+1]=h,this.int16[N+2]=m,this.int16[N+3]=p,this.int16[N+4]=v,this.float32[W+3]=T,this.float32[W+4]=M,this.float32[W+5]=O,this.float32[W+6]=w,this.int16[N+14]=P,this.uint32[W+8]=D,this.uint16[N+18]=I,this.uint16[N+19]=k,o}}n1.prototype.bytesPerElement=40,Jt(n1,"StructArrayLayout5i4f1i1ul2ui40");class Jm extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,h,m,p,v,T)}emplace(o,c,h,m,p,v,T,M){const O=8*o;return this.int16[O+0]=c,this.int16[O+1]=h,this.int16[O+2]=m,this.int16[O+4]=p,this.int16[O+5]=v,this.int16[O+6]=T,this.int16[O+7]=M,o}}Jm.prototype.bytesPerElement=16,Jt(Jm,"StructArrayLayout3i2i2i16");class i1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,m,p)}emplace(o,c,h,m,p,v){const T=4*o,M=8*o;return this.float32[T+0]=c,this.float32[T+1]=h,this.float32[T+2]=m,this.int16[M+6]=p,this.int16[M+7]=v,o}}i1.prototype.bytesPerElement=16,Jt(i1,"StructArrayLayout2f1f2i16");class o1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,h,m,p,v)}emplace(o,c,h,m,p,v,T){const M=20*o,O=5*o;return this.uint8[M+0]=c,this.uint8[M+1]=h,this.float32[O+1]=m,this.float32[O+2]=p,this.float32[O+3]=v,this.float32[O+4]=T,o}}o1.prototype.bytesPerElement=20,Jt(o1,"StructArrayLayout2ub4f20");class Bo extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,h)}emplace(o,c,h,m){const p=3*o;return this.uint16[p+0]=c,this.uint16[p+1]=h,this.uint16[p+2]=m,o}}Bo.prototype.bytesPerElement=6,Jt(Bo,"StructArrayLayout3ui6");class Pv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q,K,ie){const se=this.length;return this.resize(se+1),this.emplace(se,o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q,K,ie)}emplace(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q,K,ie,se){const de=30*o,we=15*o,_e=60*o;return this.int16[de+0]=c,this.int16[de+1]=h,this.int16[de+2]=m,this.float32[we+2]=p,this.float32[we+3]=v,this.uint16[de+8]=T,this.uint16[de+9]=M,this.uint32[we+5]=O,this.uint32[we+6]=w,this.uint32[we+7]=P,this.uint16[de+16]=D,this.uint16[de+17]=I,this.uint16[de+18]=k,this.float32[we+10]=N,this.float32[we+11]=W,this.uint8[_e+48]=Z,this.uint8[_e+49]=ee,this.uint8[_e+50]=Q,this.uint32[we+13]=K,this.int16[de+28]=ie,this.uint8[_e+58]=se,o}}Pv.prototype.bytesPerElement=60,Jt(Pv,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Iv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q,K,ie,se,de,we,_e,xe,ke,Se,De,Ve,Fe,Ze,He){const tt=this.length;return this.resize(tt+1),this.emplace(tt,o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q,K,ie,se,de,we,_e,xe,ke,Se,De,Ve,Fe,Ze,He)}emplace(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q,K,ie,se,de,we,_e,xe,ke,Se,De,Ve,Fe,Ze,He,tt){const Ke=20*o,nt=40*o,Ct=80*o;return this.float32[Ke+0]=c,this.float32[Ke+1]=h,this.int16[nt+4]=m,this.int16[nt+5]=p,this.int16[nt+6]=v,this.int16[nt+7]=T,this.int16[nt+8]=M,this.int16[nt+9]=O,this.int16[nt+10]=w,this.int16[nt+11]=P,this.int16[nt+12]=D,this.uint16[nt+13]=I,this.uint16[nt+14]=k,this.uint16[nt+15]=N,this.uint16[nt+16]=W,this.uint16[nt+17]=Z,this.uint16[nt+18]=ee,this.uint16[nt+19]=Q,this.uint16[nt+20]=K,this.uint16[nt+21]=ie,this.uint16[nt+22]=se,this.uint16[nt+23]=de,this.uint16[nt+24]=we,this.uint16[nt+25]=_e,this.uint16[nt+26]=xe,this.uint16[nt+27]=ke,this.uint32[Ke+14]=Se,this.float32[Ke+15]=De,this.float32[Ke+16]=Ve,this.float32[Ke+17]=Fe,this.float32[Ke+18]=Ze,this.uint8[Ct+76]=He,this.uint16[nt+39]=tt,o}}Iv.prototype.bytesPerElement=80,Jt(Iv,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Va extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,m,p)}emplace(o,c,h,m,p,v){const T=5*o;return this.float32[T+0]=c,this.float32[T+1]=h,this.float32[T+2]=m,this.float32[T+3]=p,this.float32[T+4]=v,o}}Va.prototype.bytesPerElement=20,Jt(Va,"StructArrayLayout5f20");class Ov extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,h,m,p,v,T)}emplace(o,c,h,m,p,v,T,M){const O=7*o;return this.float32[O+0]=c,this.float32[O+1]=h,this.float32[O+2]=m,this.float32[O+3]=p,this.float32[O+4]=v,this.float32[O+5]=T,this.float32[O+6]=M,o}}Ov.prototype.bytesPerElement=28,Jt(Ov,"StructArrayLayout7f28");class a1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O,w,P){const D=this.length;return this.resize(D+1),this.emplace(D,o,c,h,m,p,v,T,M,O,w,P)}emplace(o,c,h,m,p,v,T,M,O,w,P,D){const I=11*o;return this.float32[I+0]=c,this.float32[I+1]=h,this.float32[I+2]=m,this.float32[I+3]=p,this.float32[I+4]=v,this.float32[I+5]=T,this.float32[I+6]=M,this.float32[I+7]=O,this.float32[I+8]=w,this.float32[I+9]=P,this.float32[I+10]=D,o}}a1.prototype.bytesPerElement=44,Jt(a1,"StructArrayLayout11f44");class s1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O){const w=this.length;return this.resize(w+1),this.emplace(w,o,c,h,m,p,v,T,M,O)}emplace(o,c,h,m,p,v,T,M,O,w){const P=9*o;return this.float32[P+0]=c,this.float32[P+1]=h,this.float32[P+2]=m,this.float32[P+3]=p,this.float32[P+4]=v,this.float32[P+5]=T,this.float32[P+6]=M,this.float32[P+7]=O,this.float32[P+8]=w,o}}s1.prototype.bytesPerElement=36,Jt(s1,"StructArrayLayout9f36");class Nf extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const m=2*o;return this.float32[m+0]=c,this.float32[m+1]=h,o}}Nf.prototype.bytesPerElement=8,Jt(Nf,"StructArrayLayout2f8");class Qm extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,m){const p=this.length;return this.resize(p+1),this.emplace(p,o,c,h,m)}emplace(o,c,h,m,p){const v=6*o;return this.uint32[3*o+0]=c,this.uint16[v+2]=h,this.uint16[v+3]=m,this.uint16[v+4]=p,o}}Qm.prototype.bytesPerElement=12,Jt(Qm,"StructArrayLayout1ul3ui12");class kv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}kv.prototype.bytesPerElement=2,Jt(kv,"StructArrayLayout1ui2");class Rv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W){const Z=this.length;return this.resize(Z+1),this.emplace(Z,o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W)}emplace(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z){const ee=16*o;return this.float32[ee+0]=c,this.float32[ee+1]=h,this.float32[ee+2]=m,this.float32[ee+3]=p,this.float32[ee+4]=v,this.float32[ee+5]=T,this.float32[ee+6]=M,this.float32[ee+7]=O,this.float32[ee+8]=w,this.float32[ee+9]=P,this.float32[ee+10]=D,this.float32[ee+11]=I,this.float32[ee+12]=k,this.float32[ee+13]=N,this.float32[ee+14]=W,this.float32[ee+15]=Z,o}}Rv.prototype.bytesPerElement=64,Jt(Rv,"StructArrayLayout16f64");class Dv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,m,p,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,h,m,p,v,T)}emplace(o,c,h,m,p,v,T,M){const O=10*o,w=5*o;return this.uint16[O+0]=c,this.uint16[O+1]=h,this.uint16[O+2]=m,this.uint16[O+3]=p,this.float32[w+2]=v,this.float32[w+3]=T,this.float32[w+4]=M,o}}Dv.prototype.bytesPerElement=20,Jt(Dv,"StructArrayLayout4ui3f20");class Lv extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.int16[1*o+0]=c,o}}Lv.prototype.bytesPerElement=2,Jt(Lv,"StructArrayLayout1i2");class l1 extends qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint8[1*o+0]=c,o}}l1.prototype.bytesPerElement=1,Jt(l1,"StructArrayLayout1ub1");class c1 extends Ym{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}c1.prototype.size=40;class eg extends n1{get(o){return new c1(this,o)}}Jt(eg,"CollisionBoxArray");class E2 extends Ym{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}E2.prototype.size=60;class A2 extends Pv{get(o){return new E2(this,o)}}Jt(A2,"PlacedSymbolArray");class M2 extends Ym{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}M2.prototype.size=80;class C2 extends Iv{get(o){return new M2(this,o)}}Jt(C2,"SymbolInstanceArray");class P2 extends Jd{getoffsetX(o){return this.float32[1*o+0]}}Jt(P2,"GlyphOffsetArray");class tg extends Gc{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Jt(tg,"SymbolLineVertexArray");class rg extends Ym{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}rg.prototype.size=12;class Wa extends Qm{get(o){return new rg(this,o)}}Jt(Wa,"FeatureIndexArray");class ng extends Yu{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Jt(ng,"FillExtrusionCentroidArray");class I2 extends Ym{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}I2.prototype.size=6;class O2 extends Lf{get(o){return new I2(this,o)}}Jt(O2,"FillExtrusionWallArray");const aD=mn([{name:"a_pos",components:2,type:"Int16"}],4),sD=mn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class si{constructor(o=[]){this.segments=o}_prepareSegment(o,c,h,m){let p=this.segments[this.segments.length-1];return o>si.MAX_VERTEX_ARRAY_LENGTH&&pi(`Max vertices per segment is ${si.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!p||p.vertexLength+o>si.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==m)&&(p={vertexOffset:c,primitiveOffset:h,vertexLength:0,primitiveLength:0},m!==void 0&&(p.sortKey=m),this.segments.push(p)),p}prepareSegment(o,c,h,m){return this._prepareSegment(o,c.length,h.length,m)}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,h,m){return new si([{vertexOffset:o,primitiveOffset:c,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}function k2(d,o){return 256*(d=Kt(Math.floor(d),0,255))+Kt(Math.floor(o),0,255)}si.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Jt(si,"SegmentVector");const u1=mn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),lD=mn([{name:"a_dash",components:4,type:"Uint16"}]);class ig{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,c,h,m){this.ids.push(d1(o)),this.positions.push(c,h,m)}eachPosition(o,c){const h=d1(o);let m=0,p=this.ids.length-1;for(;m<p;){const v=m+p>>1;this.ids[v]>=h?p=v:m=v+1}for(;this.ids[m]===h;)c(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(o,c){const h=new Float64Array(o.ids),m=new Uint32Array(o.positions);return og(h,m,0,h.length-1),c&&(c.add(h.buffer),c.add(m.buffer)),{ids:h,positions:m}}static deserialize(o){const c=new ig;let h;c.ids=o.ids,c.positions=o.positions;for(const m of c.ids)m!==h&&c.uniqueIds.push(m),h=m;return c.indexed=!0,c}}function d1(d){const o=+d;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:us(String(d))}function og(d,o,c,h){for(;c<h;){const m=d[c+h>>1];let p=c-1,v=h+1;for(;;){do p++;while(d[p]<m);do v--;while(d[v]>m);if(p>=v)break;Nv(d,p,v),Nv(o,3*p,3*v),Nv(o,3*p+1,3*v+1),Nv(o,3*p+2,3*v+2)}v-c<h-v?(og(d,o,c,v),c=v+1):(og(d,o,v+1,h),h=v)}}function Nv(d,o,c){const h=d[o];d[o]=d[c],d[c]=h}Jt(ig,"FeaturePositionMap");class ic{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,c),this.initialized=!0),!!this.location}set(o,c,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ag extends ic{constructor(o){super(o),this.current=0}set(o,c,h){this.fetchUniformLocation(o,c)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class Ui extends ic{constructor(o){super(o),this.current=0}set(o,c,h){this.fetchUniformLocation(o,c)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Vs extends ic{constructor(o){super(o),this.current=[0,0]}set(o,c,h){this.fetchUniformLocation(o,c)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class zf extends ic{constructor(o){super(o),this.current=[0,0,0]}set(o,c,h){this.fetchUniformLocation(o,c)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class sg extends ic{constructor(o){super(o),this.current=[0,0,0,0]}set(o,c,h){this.fetchUniformLocation(o,c)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class R2 extends ic{constructor(o){super(o),this.current=An.transparent.toRenderColor(null)}set(o,c,h){this.fetchUniformLocation(o,c)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const D2=new Float32Array(16);class lg extends ic{constructor(o){super(o),this.current=D2}set(o,c,h){if(this.fetchUniformLocation(o,c)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let m=1;m<16;m++)if(h[m]!==this.current[m]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const h1=new Float32Array(9),cD=new Float32Array(4);class f1 extends ic{constructor(o){super(o),this.current=cD}set(o,c,h){if(this.fetchUniformLocation(o,c)){for(let m=0;m<4;m++)if(h[m]!==this.current[m]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function p1(d){return[k2(255*d.r,255*d.g),k2(255*d.b,255*d.a)]}class cg{constructor(o,c,h,m){this.value=o,this.uniformNames=c.map(p=>`u_${p}`),this.type=h,this.context=m}setUniform(o,c,h,m,p){const v=m.constantOr(this.value);c.set(o,p,v instanceof An?v.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):v)}getBinding(o,c){return this.type==="color"?new R2(o):new Ui(o)}}class eh{constructor(o,c){this.uniformNames=c.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,c,h,m,p){const v=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;v&&c.set(o,p,v)}getBinding(o,c){return c==="u_pattern"||c==="u_dash"?new sg(o):new Ui(o)}}class Hc{constructor(o,c,h,m){this.expression=o,this.type=h,this.maxValue=0,this.paintVertexAttributes=c.map(p=>({name:`a_${p}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(o,c,h,m,p,v,T){const M=this.paintVertexArray.length,O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new $n(0,{brightness:v}),c,{},p,m,T):this.expression.kind==="constant"&&this.expression.value,w=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:v}),c,{},p,m,T):this.lutExpression.value)==="none";this.paintVertexArray.resize(o),this._setPaintValue(M,o,O,w?null:this.context.lut)}updatePaintArray(o,c,h,m,p,v,T){const M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:T},h,m,void 0,p):this.expression.kind==="constant"&&this.expression.value,O=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:T}),h,m,void 0,p):this.lutExpression.value)==="none";this._setPaintValue(o,c,M,O?null:this.context.lut)}_setPaintValue(o,c,h,m){if(this.type==="color"){const p=p1(h.toRenderColor(m));for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=o;p<c;p++)this.paintVertexArray.emplace(p,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class El{constructor(o,c,h,m,p,v){this.expression=o,this.uniformNames=c.map(T=>`u_${T}_t`),this.type=h,this.useIntegerZoom=m,this.context=p,this.maxValue=0,this.paintVertexAttributes=c.map(T=>({name:`a_${T}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(o,c,h,m,p,v,T){const M=this.expression.evaluate(new $n(this.context.zoom,{brightness:v}),c,{},p,m,T),O=this.expression.evaluate(new $n(this.context.zoom+1,{brightness:v}),c,{},p,m,T),w=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:v}),c,{},p,m,T):this.lutExpression.value)==="none",P=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(P,o,M,O,w?null:this.context.lut)}updatePaintArray(o,c,h,m,p,v,T){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:T},h,m,void 0,p),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},h,m,void 0,p),w=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:T}),h,m,void 0,p):this.lutExpression.value)==="none";this._setPaintValue(o,c,M,O,w?null:this.context.lut)}_setPaintValue(o,c,h,m,p){if(this.type==="color"){const v=p1(h.toRenderColor(p)),T=p1(h.toRenderColor(p));for(let M=o;M<c;M++)this.paintVertexArray.emplace(M,v[0],v[1],T[0],T[1])}else{for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c,h,m,p){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,T=Kt(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);c.set(o,p,T)}getBinding(o,c){return new Ui(o)}}class Ku{constructor(o,c,h,m,p){this.expression=o,this.layerId=p,this.paintVertexAttributes=(h==="array"?lD:u1).members;for(let v=0;v<c.length;++v);this.paintVertexArray=new m}populatePaintArray(o,c,h,m){const p=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(p,o,c.patterns&&c.patterns[this.layerId],h)}updatePaintArray(o,c,h,m,p,v,T){this._setPaintValues(o,c,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(o,c,h,m){if(!m||!h)return;const p=m[h];if(!p)return;const{tl:v,br:T,pixelRatio:M}=p;for(let O=o;O<c;O++)this.paintVertexArray.emplace(O,v[0],v[1],T[0],T[1],M)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class th{constructor(o,c,h=()=>!0){this.binders={},this._buffers=[],this.context=c;const m=[];for(const p in o.paint._values){const v=o.paint.get(p);if(p.endsWith("-use-theme")||!h(p)||!(v instanceof If&&Sf(v.property.specification)))continue;const T=dD(p,o.type),M=v.value,O=v.property.specification.type,w=!!v.property.useIntegerZoom,P=p==="line-dasharray"||p.endsWith("pattern"),D=o.paint.get(`${p}-use-theme`),I=p==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||D&&D.value.kind!=="constant";if(M.kind!=="constant"||I)if(M.kind==="source"||I||P){const k=L2(p,O,"source");this.binders[p]=P?new Ku(M,T,O,k,o.id):new Hc(M,T,O,k),m.push(`/a_${p}`)}else{const k=L2(p,O,"composite");this.binders[p]=new El(M,T,O,w,c,k),m.push(`/z_${p}`)}else this.binders[p]=P?new eh(M.value,T):new cg(M.value,T,O,c),m.push(`/u_${p}`);D&&(this.binders[p].lutExpression=D.value)}this.cacheKey=m.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof Hc||c instanceof El?c.maxValue:0}populatePaintArrays(o,c,h,m,p,v,T){for(const M in this.binders){const O=this.binders[M];O.context=this.context,(O instanceof Hc||O instanceof El||O instanceof Ku)&&O.populatePaintArray(o,c,h,m,p,v,T)}}setConstantPatternPositions(o){for(const c in this.binders){const h=this.binders[c];h instanceof eh&&h.setConstantPatternPositions(o)}}updatePaintArrays(o,c,h,m,p,v,T,M,O){let w=!1;const P=Object.keys(o),D=P.length!==0&&!M,I=D?P:c.uniqueIds;this.context.lut=p.lut;for(const k in this.binders){const N=this.binders[k];if(N.context=this.context,(N instanceof Hc||N instanceof El||N instanceof Ku)&&N.expression&&N.expression.kind&&N.expression.kind!=="constant"&&(N.expression.isStateDependent===!0||N.expression.isLightConstant===!1)){const W=p.paint.get(k);N.expression=W.value;for(const Z of I){const ee=o[Z.toString()];c.eachPosition(Z,(Q,K,ie)=>{const se=m.feature(Q);N.updatePaintArray(K,ie,se,ee,v,T,O)})}if(!D)for(const Z of h.uniqueIds){const ee=o[Z.toString()];h.eachPosition(Z,(Q,K,ie)=>{const se=m.feature(Q);N.updatePaintArray(K,ie,se,ee,v,T,O)})}w=!0}}return w}defines(){const o=[];for(const c in this.binders){const h=this.binders[c];(h instanceof cg||h instanceof eh)&&o.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Hc||h instanceof El||h instanceof Ku)for(let m=0;m<h.paintVertexAttributes.length;m++)o.push(h.paintVertexAttributes[m].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof cg||h instanceof eh||h instanceof El)for(const m of h.uniformNames)o.push(m)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const c=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof cg||m instanceof eh||m instanceof El)for(const p of m.uniformNames)c.push({name:p,property:h,binding:m.getBinding(o,p)})}return c}setUniforms(o,c,h,m,p){for(const{name:v,property:T,binding:M}of h)this.binders[T].setUniform(o,M,p,m.get(T),v)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Hc||c instanceof El||c instanceof Ku)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(o){for(const c in this.binders){const h=this.binders[c];(h instanceof Hc||h instanceof El||h instanceof Ku)&&h.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof Hc||c instanceof El||c instanceof Ku)&&c.destroy()}}}class Ju{constructor(o,c,h=()=>!0){this.programConfigurations={};for(const m of o)this.programConfigurations[m.id]=new th(m,c,h);this.needsUpload=!1,this._featureMap=new ig,this._featureMapWithoutIds=new ig,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,c,h,m,p,v,T,M){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(o,c,m,p,v,T,M);c.id!==void 0?this._featureMap.add(c.id,h,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,h,m,p,v,T){for(const M of h)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,c,M,m,p,v,T||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const uD={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function dD(d,o){return uD[d]||[d.replace(`${o}-`,"").replace(/-/g,"_")]}const hD={"line-pattern":{source:Xu,composite:Xu},"fill-pattern":{source:Xu,composite:Xu},"fill-extrusion-pattern":{source:Xu,composite:Xu},"line-dasharray":{source:Mv,composite:Mv}},zv={color:{source:Nf,composite:Qd},number:{source:Jd,composite:Nf}};function L2(d,o,c){const h=hD[d];return h&&h[c]||zv[o][c]}Jt(cg,"ConstantBinder"),Jt(eh,"PatternConstantBinder"),Jt(Hc,"SourceExpressionBinder"),Jt(Ku,"PatternCompositeBinder"),Jt(El,"CompositeExpressionBinder"),Jt(th,"ProgramConfiguration",{omit:["_buffers"]}),Jt(Ju,"ProgramConfigurationSet");const ba=Bt/Math.PI/2,jf=5,N2=6,z2=16383,Ff=64,jv=[Ff,32,16],ps=-ba,ms=ba;function Bf(d,o,c,h=ba){return c=Ge(c),[d*Math.sin(c)*h,-o*h,d*Math.cos(c)*h]}function rh(d,o,c){return Bf(Math.cos(Ge(d)),Math.sin(Ge(d)),o,c)}const nh=63710088e-1,m1=2*Math.PI*nh;class gn{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new gn(fi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,h=this.lat*c,m=o.lat*c,p=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((o.lng-this.lng)*c);return nh*Math.acos(Math.min(p,1))}toBounds(o=0){const c=360*o/40075017,h=c/Math.cos(Math.PI/180*this.lat);return new Qu({lng:this.lng-h,lat:this.lat-c},{lng:this.lng+h,lat:this.lat+c})}toEcef(o){return rh(this.lat,this.lng,ba+o*ba/nh)}static convert(o){if(o instanceof gn)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new gn(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new gn(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Qu{constructor(o,c){if(o)if(c)this.setSouthWest(o).setNorthEast(c);else if(o.length===4){const h=o;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=o;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(o){return this._ne=o instanceof gn?new gn(o.lng,o.lat):gn.convert(o),this}setSouthWest(o){return this._sw=o instanceof gn?new gn(o.lng,o.lat):gn.convert(o),this}extend(o){const c=this._sw,h=this._ne;let m,p;if(o instanceof gn)m=o,p=o;else{if(!(o instanceof Qu))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Qu.convert(o)):this.extend(gn.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(gn.convert(o)):this;if(m=o._sw,p=o._ne,!m||!p)return this}return c||h?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),h.lng=Math.max(p.lng,h.lng),h.lat=Math.max(p.lat,h.lat)):(this._sw=new gn(m.lng,m.lat),this._ne=new gn(p.lng,p.lat)),this}getCenter(){return new gn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new gn(this.getWest(),this.getNorth())}getSouthEast(){return new gn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:c,lat:h}=gn.convert(o);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&m}static convert(o){if(o)return o instanceof Qu?o:new Qu(o)}}const fD=0,pD=25.5;function Fv(d){return m1*Math.cos(d*Math.PI/180)}function oc(d){return(180+d)/360}function Ga(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function Yo(d,o){return d/Fv(o)}function qa(d){return 360*d-180}function $o(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function g1(d,o){return d*Fv($o(o))}const ji=85.051129;function j2(d){return Math.cos(Ge(Kt(d,-ji,ji)))}function ed(d,o){const c=Kt(o,fD,pD),h=Math.pow(2,c);return j2(d)*m1/(512*h)}function mD(d){return 1/Math.cos(d*Math.PI/180)}function y(d,o=0){const c=Math.exp(Math.PI*(1-(d.y+o/Bt)/(1<<d.z)*2));return 80150034*c/(c*c+1)/Bt/(1<<d.z)}class s{constructor(o,c,h=0){this.x=+o,this.y=+c,this.z=+h}static fromLngLat(o,c=0){const h=gn.convert(o);return new s(oc(h.lng),Ga(h.lat),Yo(c,h.lat))}toLngLat(){return new gn(qa(this.x),$o(this.y))}toAltitude(){return g1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/m1*mD($o(this.y))}}function u(d,o,c,h,m,p,v,T,M){const O=(o+h)/2,w=(c+m)/2,P=new _t(O,w);T(P),function(D,I,k,N,W,Z){const ee=k-W,Q=N-Z;return Math.abs((N-I)*ee-(k-D)*Q)/Math.hypot(ee,Q)}(P.x,P.y,p.x,p.y,v.x,v.y)>=M?(u(d,o,c,O,w,p,P,T,M),u(d,O,w,h,m,P,v,T,M)):d.push(v)}function g(d,o,c){let h=d[0],m=h.x,p=h.y;o(h);const v=[h];for(let T=1;T<d.length;T++){const M=d[T],{x:O,y:w}=M;o(M),u(v,m,p,O,w,h,M,o,c),m=O,p=w,h=M}return v}function x(d,o,c,h){if(h(o,c)){const m=o.add(c)._mult(.5);x(d,o,m,h),x(d,m,c,h)}else d.push(c)}function S(d,o){let c=d[0];const h=[c];for(let m=1;m<d.length;m++){const p=d[m];x(h,c,p,o),c=p}return h}const A=Math.pow(2,14)-1,L=-A-1;function z(d,o){const c=Math.round(d.x*o),h=Math.round(d.y*o);return d.x=Kt(c,L,A),d.y=Kt(h,L,A),(c<d.x||c>d.x+1||h<d.y||h>d.y+1)&&pi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d}function B(d,o,c){const h=d.loadGeometry(),m=d.extent,p=Bt/m;if(o&&c&&c.projection.isReprojectedInTileSpace){const v=1<<o.z,{scale:T,x:M,y:O,projection:w}=c,P=D=>{const I=qa((o.x+D.x/m)/v),k=$o((o.y+D.y/m)/v),N=w.project(I,k);D.x=(N.x*T-M)*m,D.y=(N.y*T-O)*m};for(let D=0;D<h.length;D++)if(d.type!==1)h[D]=g(h[D],P,1);else{const I=[];for(const k of h[D])k.x<0||k.x>=m||k.y<0||k.y>=m||(P(k),I.push(k));h[D]=I}}for(const v of h)for(const T of v)z(T,p);return h}function V(d,o){return{type:d.type,id:d.id,properties:d.properties,geometry:o?B(d):[]}}function X(d,o,c,h,m){d.emplaceBack(2*o+(h+1)/2,2*c+(m+1)/2)}function Y(d,o,c){d.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class re{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Gc,this.indexArray=new Bo,this.segments=new si,this.programConfigurations=new Ju(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}updateFootprints(o,c){}populate(o,c,h,m){const p=this.layers[0],v=[];let T=null;p.type==="circle"&&(T=p.layout.get("circle-sort-key"));for(const{feature:O,id:w,index:P,sourceLayerIndex:D}of o){const I=this.layers[0]._featureFilter.needGeometry,k=V(O,I);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),k,h))continue;const N=T?T.evaluate(k,{},h):void 0,W={id:w,properties:O.properties,type:O.type,sourceLayerIndex:D,index:P,geometry:I?k.geometry:B(O,h,m),patterns:{},sortKey:N};v.push(W)}T&&v.sort((O,w)=>O.sortKey-w.sortKey);let M=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Cv,M=m.projection);for(const O of v){const{geometry:w,index:P,sourceLayerIndex:D}=O,I=o[P].feature;this.addFeature(O,w,P,c.availableImages,h,M,c.brightness),c.featureIndex.insert(I,w,P,D,this.index)}}update(o,c,h,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,h,m,v,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,aD.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,sD.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,c,h,m,p,v,T){for(const M of c)for(const O of M){const w=O.x,P=O.y;if(w<0||w>=Bt||P<0||P>=Bt)continue;if(v){const k=v.projectTilePoint(w,P,p),N=v.upVector(p,w,P),W=this.globeExtVertexArray;Y(W,k,N),Y(W,k,N),Y(W,k,N),Y(W,k,N)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),I=D.vertexLength;X(this.layoutVertexArray,w,P,-1,-1),X(this.layoutVertexArray,w,P,1,-1),X(this.layoutVertexArray,w,P,1,1),X(this.layoutVertexArray,w,P,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,{},m,p,T)}}function ce(d,o){for(let c=0;c<d.length;c++)if(Ce(o,d[c]))return!0;for(let c=0;c<o.length;c++)if(Ce(d,o[c]))return!0;return!!be(d,o)}function ae(d,o,c){return!!Ce(d,o)||!!Te(o,d,c)}function fe(d,o){if(d.length===1)return Me(o,d[0]);for(let c=0;c<o.length;c++){const h=o[c];for(let m=0;m<h.length;m++)if(Ce(d,h[m]))return!0}for(let c=0;c<d.length;c++)if(Me(o,d[c]))return!0;for(let c=0;c<o.length;c++)if(be(d,o[c]))return!0;return!1}function me(d,o,c){if(d.length>1){if(be(d,o))return!0;for(let h=0;h<o.length;h++)if(Te(o[h],d,c))return!0}for(let h=0;h<d.length;h++)if(Te(d[h],o,c))return!0;return!1}function be(d,o){if(d.length===0||o.length===0)return!1;for(let c=0;c<d.length-1;c++){const h=d[c],m=d[c+1];for(let p=0;p<o.length-1;p++)if(Ee(h,m,o[p],o[p+1]))return!0}return!1}function Ee(d,o,c,h){return wr(d,c,h)!==wr(o,c,h)&&wr(d,o,c)!==wr(d,o,h)}function Te(d,o,c){const h=c*c;if(o.length===1)return d.distSqr(o[0])<h;for(let m=1;m<o.length;m++)if(Oe(d,o[m-1],o[m])<h)return!0;return!1}function Oe(d,o,c){const h=o.distSqr(c);if(h===0)return d.distSqr(o);const m=((d.x-o.x)*(c.x-o.x)+(d.y-o.y)*(c.y-o.y))/h;return d.distSqr(m<0?o:m>1?c:c.sub(o)._mult(m)._add(o))}function Me(d,o){let c,h,m,p=!1;for(let v=0;v<d.length;v++){c=d[v];for(let T=0,M=c.length-1;T<c.length;M=T++)h=c[T],m=c[M],h.y>o.y!=m.y>o.y&&o.x<(m.x-h.x)*(o.y-h.y)/(m.y-h.y)+h.x&&(p=!p)}return p}function Ce(d,o){let c=!1;for(let h=0,m=d.length-1;h<d.length;m=h++){const p=d[h],v=d[m];p.y>o.y!=v.y>o.y&&o.x<(v.x-p.x)*(o.y-p.y)/(v.y-p.y)+p.x&&(c=!c)}return c}function Pe(d,o,c,h,m){for(const v of d)if(o<=v.x&&c<=v.y&&h>=v.x&&m>=v.y)return!0;const p=[new _t(o,c),new _t(o,m),new _t(h,m),new _t(h,c)];if(d.length>2){for(const v of p)if(Ce(d,v))return!0}for(let v=0;v<d.length-1;v++)if(Ne(d[v],d[v+1],p))return!0;return!1}function Ne(d,o,c){const h=c[0],m=c[2];if(d.x<h.x&&o.x<h.x||d.x>m.x&&o.x>m.x||d.y<h.y&&o.y<h.y||d.y>m.y&&o.y>m.y)return!1;const p=wr(d,o,c[0]);return p!==wr(d,o,c[1])||p!==wr(d,o,c[2])||p!==wr(d,o,c[3])}function Ue(d,o,c,h,m,p){let v=o.y-d.y,T=d.x-o.x;if(p=p||0){const M=v*v+T*T;if(M===0)return!0;const O=Math.sqrt(M);v/=O,T/=O}return!((c.x-d.x)*v+(c.y-d.y)*T-p<0||(h.x-d.x)*v+(h.y-d.y)*T-p<0||(m.x-d.x)*v+(m.y-d.y)*T-p<0)}function dt(d,o,c,h,m,p,v){return!(Ue(d,o,h,m,p,v)||Ue(o,c,h,m,p,v)||Ue(c,d,h,m,p,v)||Ue(h,m,d,o,c,v)||Ue(m,p,d,o,c,v)||Ue(p,h,d,o,c,v))}function et(d,o,c){const h=o.paint.get(d).value;return h.kind==="constant"?h.value:c.programConfigurations.get(o.id).getMaxValue(d)}function wt(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function Tt(d,o,c,h,m){if(!o[0]&&!o[1])return d;const p=_t.convert(o)._mult(m);c==="viewport"&&p._rotate(-h);const v=[];for(let T=0;T<d.length;T++)v.push(d[T].sub(p));return v}function Dt(d,o,c,h){const m=_t.convert(d)._mult(h);return o==="viewport"&&m._rotate(-c),m}let Qe,bt;Jt(re,"CircleBucket",{omit:["layers"]});var Ye,xt={exports:{}},gt=(Ye||(Ye=1,function(d,o){(function(c){function h(p,v,T){var M=m(256*p,256*(v=Math.pow(2,T)-v-1),T),O=m(256*(p+1),256*(v+1),T);return M[0]+","+M[1]+","+O[0]+","+O[1]}function m(p,v,T){var M=2*Math.PI*6378137/256/Math.pow(2,T);return[p*M-2*Math.PI*6378137/2,v*M-2*Math.PI*6378137/2]}c.getURL=function(p,v,T,M,O,w){return w=w||{},p+"?"+["bbox="+h(T,M,O),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+v].join("&")},c.getTileBBox=h,c.getMercCoords=m,Object.defineProperty(c,"__esModule",{value:!0})})(o)}(0,xt.exports)),xt.exports);class Et{constructor(o,c,h){this.z=o,this.x=c,this.y=h,this.key=Vt(0,o,o,c,h)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c){const h=gt.getTileBBox(this.x,this.y,this.z),m=function(p,v,T){let M,O="";for(let w=p;w>0;w--)M=1<<w-1,O+=(v&M?1:0)+(T&M?2:0);return O}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ht{constructor(o,c){this.wrap=o,this.canonical=c,this.key=Vt(o,c.z,c.z,c.x,c.y)}}class Mt{constructor(o,c,h,m,p){this.overscaledZ=o,this.wrap=c,this.canonical=new Et(h,+m,+p),this.key=c===0&&o===h?this.canonical.key:Vt(c,o,h,m,p)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const c=this.canonical.z-o;return o>this.canonical.z?new Mt(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Mt(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c=!0){if(this.overscaledZ===o&&c)return this.key;if(o>this.canonical.z)return Vt(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-o;return Vt(this.wrap*+c,o,o,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new Mt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new Mt(c,this.wrap,c,h,m),new Mt(c,this.wrap,c,h+1,m),new Mt(c,this.wrap,c,h,m+1),new Mt(c,this.wrap,c,h+1,m+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Mt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Mt(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ht(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Vt(d,o,c,h,m){const p=1<<Math.min(c,22);let v=p*(m%p)+h%p;return d&&c<22&&(v+=p*p*((d<0?-2*d-1:2*d)%(1<<2*(22-c)))),16*(32*v+c)+(o-c)}const Wt=[d=>{let o=d.canonical.x-1,c=d.wrap;return o<0&&(o=(1<<d.canonical.z)-1,c--),new Mt(d.overscaledZ,c,d.canonical.z,o,d.canonical.y)},d=>{let o=d.canonical.x+1,c=d.wrap;return o===1<<d.canonical.z&&(o=0,c++),new Mt(d.overscaledZ,c,d.canonical.z,o,d.canonical.y)},d=>new Mt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,(d.canonical.y===0?1<<d.canonical.z:d.canonical.y)-1),d=>new Mt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y===(1<<d.canonical.z)-1?0:d.canonical.y+1)];Jt(Et,"CanonicalTileID"),Jt(Mt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Ht=mn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ir}=Ht,Or=mn([{name:"a_pos_3",components:3,type:"Int16"}]);var vr=mn([{name:"a_pos",type:"Int16",components:2}]);class Mr{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,h){const m=ge.vec2.dot(c,this.dir);if(Math.abs(m)<1e-6)return!1;const p=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1])/m;return h[0]=this.pos[0]+this.dir[0]*p,h[1]=this.pos[1]+this.dir[1]*p,!0}}class Tr{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,h){const m=ge.vec3.dot(c,this.dir);if(Math.abs(m)<1e-6)return!1;const p=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1]+(o[2]-this.pos[2])*c[2])/m;return h[0]=this.pos[0]+this.dir[0]*p,h[1]=this.pos[1]+this.dir[1]*p,h[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(o,c,h){if(ge.vec3.equals(this.pos,o)||c===0)return h[0]=h[1]=h[2]=0,!1;const[m,p,v]=this.dir,T=this.pos[0]-o[0],M=this.pos[1]-o[1],O=this.pos[2]-o[2],w=m*m+p*p+v*v,P=2*(T*m+M*p+O*v),D=P*P-4*w*(T*T+M*M+O*O-c*c);if(D<0){const I=Math.max(-P/2,0),k=T+m*I,N=M+p*I,W=O+v*I,Z=Math.hypot(k,N,W);return h[0]=k*c/Z,h[1]=N*c/Z,h[2]=W*c/Z,!1}{const I=(-P-Math.sqrt(D))/(2*w);if(I<0){const k=Math.hypot(T,M,O);return h[0]=T*c/k,h[1]=M*c/k,h[2]=O*c/k,!1}return h[0]=T+m*I,h[1]=M+p*I,h[2]=O+v*I,!0}}}class tn{constructor(o,c,h,m,p){this.TL=o,this.TR=c,this.BR=h,this.BL=m,this.horizon=p}static fromInvProjectionMatrix(o,c,h){const m=[-1,1,1],p=[1,1,1],v=[1,-1,1],T=[-1,-1,1],M=ge.vec3.transformMat4(m,m,o),O=ge.vec3.transformMat4(p,p,o),w=ge.vec3.transformMat4(v,v,o),P=ge.vec3.transformMat4(T,T,o);return new tn(M,O,w,P,c/h)}}function yn(d,o,c){let h=1/0,m=-1/0;const p=[];for(const v of d){ge.vec3.sub(p,v,o);const T=ge.vec3.dot(p,c);h=Math.min(h,T),m=Math.max(m,T)}return[h,m]}function Wn(d,o){let c=!0;for(let h=0;h<d.planes.length;h++){const m=d.planes[h];let p=0;for(let v=0;v<o.length;v++)p+=ge.vec3.dot(m,o[v])+m[3]>=0;if(p===0)return 0;p!==o.length&&(c=!1)}return c?2:1}function Hr(d,o){for(const c of d.projections){const h=yn(o,d.points[0],c.axis);if(c.projection[1]<h[0]||c.projection[0]>h[1])return 0}return 1}function li(d,o){let c=0;const h=[0,0,0,0];for(let m=0;m<d.length;m++)h[0]=d[m][0],h[1]=d[m][1],h[2]=d[m][2],h[3]=1,ge.vec4.dot(h,o)>=0&&c++;return c}class Lr{constructor(o,c){this.points=o||new Array(8).fill([0,0,0]),this.planes=c||new Array(6).fill([0,0,0,0]),this.bounds=or.fromPoints(this.points),this.projections=[],this.frustumEdges=[ge.vec3.sub([],this.points[2],this.points[3]),ge.vec3.sub([],this.points[0],this.points[3]),ge.vec3.sub([],this.points[4],this.points[0]),ge.vec3.sub([],this.points[5],this.points[1]),ge.vec3.sub([],this.points[6],this.points[2]),ge.vec3.sub([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const m=[0,-h[2],h[1]],p=[h[2],0,-h[0]];this.projections.push({axis:m,projection:yn(this.points,this.points[0],m)}),this.projections.push({axis:p,projection:yn(this.points,this.points[0],p)})}}static fromInvProjectionMatrix(o,c,h,m){const p=Math.pow(2,h),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const w=ge.vec4.transformMat4([],O,o),P=1/w[3]/c*p;return ge.vec4.mul(w,w,[P,P,m?1/w[3]:P,P])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const w=ge.vec3.sub([],v[O[0]],v[O[1]]),P=ge.vec3.sub([],v[O[2]],v[O[1]]),D=ge.vec3.normalize([],ge.vec3.cross([],w,P)),I=-ge.vec3.dot(D,v[O[1]]);return D.concat(I)}),M=[];for(let O=0;O<v.length;O++)M.push([v[O][0],v[O][1],v[O][2]]);return new Lr(M,T)}intersectsPrecise(o,c,h){for(let m=0;m<c.length;m++)if(!li(o,c[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!li(o,this.planes[m]))return 0;for(const m of h)for(const p of this.frustumEdges){const v=ge.vec3.cross([],m,p),T=ge.vec3.length(v);if(T===0)continue;ge.vec3.scale(v,v,1/T);const M=yn(this.points,this.points[0],v),O=yn(o,this.points[0],v);if(M[0]>O[1]||O[0]>M[1])return 0}return 1}containsPoint(o){for(const c of this.planes){const h=c[3];if(ge.vec3.dot([c[0],c[1],c[2]],o)+h<0)return!1}return!0}}class or{static fromPoints(o){const c=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const m of o)ge.vec3.min(c,c,m),ge.vec3.max(h,h,m);return new or(c,h)}static fromTileIdAndHeight(o,c,h){const m=1<<o.canonical.z,p=o.canonical.x,v=o.canonical.y;return new or([p/m,v/m,c],[(p+1)/m,(v+1)/m,h])}static applyTransform(o,c){const h=o.getCorners();for(let m=0;m<h.length;++m)ge.vec3.transformMat4(h[m],h[m],c);return or.fromPoints(h)}static applyTransformFast(o,c){const h=[c[12],c[13],c[14]],m=[...h];for(let p=0;p<3;p++)for(let v=0;v<3;v++){const T=c[4*v+p],M=T*o.min[v],O=T*o.max[v];h[p]+=Math.min(M,O),m[p]+=Math.max(M,O)}return new or(h,m)}static projectAabbCorners(o,c){const h=o.getCorners();for(let m=0;m<h.length;++m)ge.vec3.transformMat4(h[m],h[m],c);return h}constructor(o,c){this.min=o,this.max=c,this.center=ge.vec3.scale([],ge.vec3.add([],this.min,this.max),.5)}quadrant(o){const c=[o%2==0,o<2],h=ge.vec3.clone(this.min),m=ge.vec3.clone(this.max);for(let p=0;p<c.length;p++)h[p]=c[p]?this.min[p]:this.center[p],m[p]=c[p]?this.center[p]:this.max[p];return m[2]=this.max[2],new or(h,m)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,c=this.max;return[[o[0],o[1],o[2]],[c[0],o[1],o[2]],[c[0],c[1],o[2]],[o[0],c[1],o[2]],[o[0],o[1],c[2]],[c[0],o[1],c[2]],[c[0],c[1],c[2]],[o[0],c[1],c[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?Wn(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?Wn(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,c){return c||this.intersects(o)?Hr(o,this.getCorners()):0}intersectsPreciseFlat(o,c){return c||this.intersectsFlat(o)?Hr(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let c=0;c<3;++c)if(this.min[c]>o.max[c]||o.min[c]>this.max[c])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],o.min[c]),this.max[c]=Math.max(this.max[c],o.max[c])}encapsulatePoint(o){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],o[c]),this.max[c]=Math.max(this.max[c],o[c])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function on(d){return d*ba/nh}Jt(or,"Aabb");const Mn=[new or([ps,ps,ps],[ms,ms,ms]),new or([ps,ps,ps],[0,0,ms]),new or([0,ps,ps],[ms,0,ms]),new or([ps,0,ps],[0,ms,ms]),new or([0,0,ps],[ms,ms,ms])];function cn(d,o,c,h=!0){const m=ge.vec3.scale([],d._camera.position,d.worldSize),p=[o,c,1,1];ge.vec4.transformMat4(p,p,d.pixelMatrixInverse),ge.vec4.scale(p,p,1/p[3]);const v=ge.vec3.sub([],p,m),T=ge.vec3.normalize([],v),M=d.globeMatrix,O=[M[12],M[13],M[14]],w=ge.vec3.sub([],O,m),P=ge.vec3.length(w),D=ge.vec3.normalize([],w),I=d.worldSize/(2*Math.PI),k=ge.vec3.dot(D,T),N=Math.asin(I/P);if(N<Math.acos(k)){if(!h)return null;const ke=[],Se=[];ge.vec3.scale(ke,T,P/k),ge.vec3.normalize(Se,ge.vec3.sub(Se,ke,w)),ge.vec3.normalize(T,ge.vec3.add(T,w,ge.vec3.scale(T,Se,Math.tan(N)*P)))}const W=[];new Tr(m,T).closestPointOnSphere(O,I,W);const Z=ge.vec3.normalize([],Fu(M,0)),ee=ge.vec3.normalize([],Fu(M,1)),Q=ge.vec3.normalize([],Fu(M,2)),K=ge.vec3.dot(Z,W),ie=ge.vec3.dot(ee,W),se=ge.vec3.dot(Q,W),de=vt(Math.asin(-ie/I));let we=vt(Math.atan2(K,se));we=d.center.lng+function(ke,Se){const De=(Se-ke+180)%360-180;return De<-180?De+360:De}(d.center.lng,we);const _e=oc(we),xe=Kt(Ga(de),0,1);return new s(_e,xe)}class Ti{constructor(o,c,h){this.a=ge.vec3.sub([],o,h),this.b=ge.vec3.sub([],c,h),this.center=h;const m=ge.vec3.normalize([],this.a),p=ge.vec3.normalize([],this.b);this.angle=Math.acos(ge.vec3.dot(m,p))}}function Hi(d,o){if(d.angle===0)return null;let c;return c=d.a[o]===0?1/d.angle*.5*Math.PI:1/d.angle*Math.atan(d.b[o]/d.a[o]/Math.sin(d.angle)-1/Math.tan(d.angle)),c<0||c>1?null:function(h,m,p,v){const T=Math.sin(p);return h*(Math.sin((1-v)*p)/T)+m*(Math.sin(v*p)/T)}(d.a[o],d.b[o],d.angle,Kt(c,0,1))+d.center[o]}function ho(d){if(d.z<=1)return Mn[d.z+2*d.y+d.x];const o=ci(sn(d));return or.fromPoints(o)}function _o(d,o,c){return ge.vec3.scale(d,d,1-c),ge.vec3.scaleAndAdd(d,d,o,c)}function gs(d,o,c){for(const h of d)ge.vec3.transformMat4(h,h,o),ge.vec3.scale(h,h,c)}function la(d,o,c,h){const m=o/d.worldSize,p=d.globeMatrix;if(c.z<=1){const _e=ho(c).getCorners();return gs(_e,p,m),or.fromPoints(_e)}const v=sn(c,h),T=ci(v,ba+on(d._tileCoverLift));gs(T,p,m);const M=Number.MAX_VALUE,O=[-M,-M,-M],w=[M,M,M];if(v.contains(d.center)){for(const ke of T)ge.vec3.min(w,w,ke),ge.vec3.max(O,O,ke);O[2]=0;const _e=d.point,xe=[_e.x*m,_e.y*m,0];return ge.vec3.min(w,w,xe),ge.vec3.max(O,O,xe),new or(w,O)}if(d._tileCoverLift>0){for(const _e of T)ge.vec3.min(w,w,_e),ge.vec3.max(O,O,_e);return new or(w,O)}const P=[p[12]*m,p[13]*m,p[14]*m],D=v.getCenter(),I=Kt(d.center.lat,-ji,ji),k=Kt(D.lat,-ji,ji),N=oc(d.center.lng),W=Ga(I);let Z=N-oc(D.lng);const ee=W-Ga(k);Z>.5?Z-=1:Z<-.5&&(Z+=1);let Q=0;if(Math.abs(Z)>Math.abs(ee))Q=Z>=0?1:3;else{Q=ee>=0?0:2;const _e=[p[4]*m,p[5]*m,p[6]*m],xe=-Math.sin(Ge(ee>=0?v.getSouth():v.getNorth()))*ba;ge.vec3.scaleAndAdd(P,P,_e,xe)}const K=T[Q],ie=T[(Q+1)%4],se=new Ti(K,ie,P),de=[Hi(se,0)||K[0],Hi(se,1)||K[1],Hi(se,2)||K[2]],we=Ra(d.zoom);if(we>0){const _e=function({x:ke,y:Se,z:De},Ve,Fe,Ze,He){const tt=1/(1<<De);let Ke=ke*tt,nt=Ke+tt,Ct=Se*tt,At=Ct+tt,Qt=0;const Rt=(Ke+nt)/2-Ze;return Rt>.5?Qt=-1:Rt<-.5&&(Qt=1),Ke=((Ke+Qt)*Ve-(Ze*=Ve))*Fe+Ze,nt=((nt+Qt)*Ve-Ze)*Fe+Ze,Ct=(Ct*Ve-(He*=Ve))*Fe+He,At=(At*Ve-He)*Fe+He,[[Ke,At,0],[nt,At,0],[nt,Ct,0],[Ke,Ct,0]]}(c,o,d._pixelsPerMercatorPixel,N,W);for(let ke=0;ke<T.length;ke++)_o(T[ke],_e[ke],we);const xe=ge.vec3.add([],_e[Q],_e[(Q+1)%4]);ge.vec3.scale(xe,xe,.5),_o(de,xe,we)}for(const _e of T)ge.vec3.min(w,w,_e),ge.vec3.max(O,O,_e);return w[2]=Math.min(K[2],ie[2]),ge.vec3.min(w,w,de),ge.vec3.max(O,O,de),new or(w,O)}function sn({x:d,y:o,z:c},h=!1){const m=1/(1<<c),p=new gn(qa(d*m),o===(1<<c)-1&&h?-90:$o((o+1)*m)),v=new gn(qa((d+1)*m),o===0&&h?90:$o(o*m));return new Qu(p,v)}function ci(d,o=ba){const c=Ge(d.getNorth()),h=Ge(d.getSouth()),m=Math.cos(c),p=Math.cos(h),v=Math.sin(c),T=Math.sin(h),M=d.getWest(),O=d.getEast();return[Bf(p,T,M,o),Bf(p,T,O,o),Bf(m,v,O,o),Bf(m,v,M,o)]}function vn(d,o,c,h){const m=1<<c.z,p=(d/Bt+c.x)/m;return rh($o((o/Bt+c.y)/m),qa(p),h)}function Nn({min:d,max:o}){return z2/Math.max(o[0]-d[0],o[1]-d[1],o[2]-d[2])}const Uo=new Float64Array(16);function ti(d){const o=Nn(d),c=ge.mat4.fromScaling(Uo,[o,o,o]);return ge.mat4.translate(c,c,ge.vec3.negate([],d.min))}function fo(d){const o=ge.mat4.fromTranslation(Uo,d.min),c=1/Nn(d);return ge.mat4.scale(o,o,[c,c,c])}function ac(d){const o=Bt/(2*Math.PI);return d/(2*Math.PI)/o}function Ha(d,o){return Bt/(512*Math.pow(2,d))*Nn(ho(o))}function Ws(d,o,c,h,m){const p=ac(c),v=[d,o,-c/(2*Math.PI)],T=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(T,T,v),ge.mat4.scale(T,T,[p,p,p]),ge.mat4.rotateX(T,T,Ge(-m)),ge.mat4.rotateY(T,T,Ge(-h)),T}function Ra(d){return Zr(jf,N2,d)}function Gs(d,o){const c=rh(o.lat,o.lng),h=function(p){const v=rh(p._center.lat,p._center.lng),T=ge.vec3.fromValues(0,1,0);let M=ge.vec3.cross([],T,v);const O=ge.mat4.fromRotation([],-p.angle,v);M=ge.vec3.transformMat4(M,M,O),ge.mat4.fromRotation(O,-p._pitch,M);const w=ge.vec3.normalize([],v);return ge.vec3.scale(w,w,on(p.cameraToCenterDistance/p.pixelsPerMeter)),ge.vec3.transformMat4(w,w,O),ge.vec3.add([],v,w)}(d),m=ge.vec3.subtract([],h,c);return ge.vec3.angle(m,c)}function Za(d,o){return Gs(d,o)>Math.PI/2*1.01}const Zc=Ge(85),sc=Math.cos(Zc),Xc=Math.sin(Zc),y1=ge.mat4.create(),$f=d=>{const o=[];return d.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function Bv(d,o,c,h,m,p,v,T,M){if(p&&d.queryGeometry.isAboveHorizon)return!1;p&&(M*=d.pixelToTileUnitsFactor);const O=d.tileID.canonical,w=c.projection.upVectorScale(O,c.center.lat,c.worldSize).metersToTile;for(const P of o)for(const D of P){const I=D.add(T),k=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(I.x,I.y,!0):0,N=c.projection.projectTilePoint(I.x,I.y,O);if(k>0){const Q=c.projection.upVector(O,I.x,I.y);N.x+=Q[0]*w*k,N.y+=Q[1]*w*k,N.z+=Q[2]*w*k}const W=p?I:v1(N.x,N.y,N.z,h),Z=p?d.tilespaceRays.map(Q=>qle(Q,k)):d.queryGeometry.screenGeometry,ee=ge.vec4.transformMat4([],[N.x,N.y,N.z,1],h);if(!v&&p?M*=ee[3]/c.cameraToCenterDistance:v&&!p&&(M*=c.cameraToCenterDistance/ee[3]),p){const Q=$o((D.y/Bt+O.y)/(1<<O.z));M/=c.projection.pixelsPerMeter(Q,1)/Yo(1,Q)}if(ae(Z,W,M))return!0}return!1}function v1(d,o,c,h){const m=ge.vec4.transformMat4([],[d,o,c,1],h);return new _t(m[0]/m[3],m[1]/m[3])}const AU=ge.vec3.fromValues(0,0,0),Gle=ge.vec3.fromValues(0,0,1);function qle(d,o){const c=ge.vec3.create();return AU[2]=o,d.intersectsPlane(AU,Gle,c),new _t(c[0],c[1])}class MU extends re{}let CU,PU,IU,OU;function kU(d,{width:o,height:c},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==o*c*h)throw new RangeError("mismatched image size")}else m=new Uint8Array(o*c*h);return d.width=o,d.height=c,d.data=m,d}function RU(d,o,c){const{width:h,height:m}=o;h===d.width&&m===d.height||(gD(d,o,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,h),height:Math.min(d.height,m)},c,null),d.width=h,d.height=m,d.data=o.data)}function gD(d,o,c,h,m,p,v,T){if(m.width===0||m.height===0)return o;if(m.width>d.width||m.height>d.height||c.x>d.width-m.width||c.y>d.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>o.width||m.height>o.height||h.x>o.width-m.width||h.y>o.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const M=d.data,O=o.data,w=p===4&&T;for(let P=0;P<m.height;P++){const D=((c.y+P)*d.width+c.x)*p,I=((h.y+P)*o.width+h.x)*p;if(w)for(let k=0;k<m.width;k++){const N=D+k*p+3,W=I+k*p;O[W+0]=255,O[W+1]=255,O[W+2]=255,O[W+3]=M[N]}else if(v)for(let k=0;k<m.width;k++){const N=D+k*p,W=I+k*p,Z=M[N+3],ee=new An(M[N+0]/255*Z,M[N+1]/255*Z,M[N+2]/255*Z,Z).toRenderColor(v).toArray();O[W+0]=ee[0],O[W+1]=ee[1],O[W+2]=ee[2],O[W+3]=ee[3]}else for(let k=0;k<m.width*p;k++)O[I+k]=M[D+k]}return o}Jt(MU,"HeatmapBucket",{omit:["layers"]});class Uf{constructor(o,c){kU(this,o,1,c)}resize(o){RU(this,new Uf(o),1)}clone(){return new Uf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,h,m,p){gD(o,c,h,m,p,1,null)}}class Ko{constructor(o,c){kU(this,o,4,c)}resize(o){RU(this,new Ko(o),4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ko({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,h,m,p,v,T){gD(o,c,h,m,p,4,v,T)}}class DU{constructor(o,c){this.width=o.width,this.height=o.height,this.data=c instanceof Uint8Array?new Float32Array(c.buffer):c}}function _1(d){const o={},c=d.resolution||256,h=d.clips?d.clips.length:1,m=d.image||new Ko({width:c,height:h}),p=(v,T,M)=>{o[d.evaluationKey]=M;const O=d.expression.evaluate(o);O&&(m.data[v+T+0]=Math.floor(255*O.r/O.a),m.data[v+T+1]=Math.floor(255*O.g/O.a),m.data[v+T+2]=Math.floor(255*O.b/O.a),m.data[v+T+3]=Math.floor(255*O.a))};if(d.clips)for(let v=0,T=0;v<h;++v,T+=4*c)for(let M=0,O=0;M<c;M++,O+=4){const w=M/(c-1),{start:P,end:D}=d.clips[v];p(T,O,P*(1-w)+D*w)}else for(let v=0,T=0;v<c;v++,T+=4)p(0,T,v/(c-1));return m}Jt(Uf,"AlphaImage"),Jt(Ko,"RGBAImage");const Hle=mn([{name:"a_pos",components:2,type:"Int16"}],4),Zle=mn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),Xle=mn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),Yle=mn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function x1(d,o,c=2){const h=o&&o.length,m=h?o[0]*c:d.length;let p=LU(d,0,m,c,!0);const v=[];if(!p||p.next===p.prev)return v;let T,M,O;if(h&&(p=function(w,P,D,I){const k=[];for(let N=0,W=P.length;N<W;N++){const Z=LU(w,P[N]*I,N<W-1?P[N+1]*I:w.length,I,!1);Z===Z.next&&(Z.steiner=!0),k.push(ice(Z))}k.sort(tce);for(let N=0;N<k.length;N++)D=rce(k[N],D);return D}(d,o,p,c)),d.length>80*c){T=1/0,M=1/0;let w=-1/0,P=-1/0;for(let D=c;D<m;D+=c){const I=d[D],k=d[D+1];I<T&&(T=I),k<M&&(M=k),I>w&&(w=I),k>P&&(P=k)}O=Math.max(w-T,P-M),O=O!==0?32767/O:0}return b1(p,v,c,T,M,O,0),v}function LU(d,o,c,h,m){let p;if(m===function(v,T,M,O){let w=0;for(let P=T,D=M-O;P<M;P+=O)w+=(v[D]-v[P])*(v[P+1]+v[D+1]),D=P;return w}(d,o,c,h)>0)for(let v=o;v<c;v+=h)p=jU(v/h|0,d[v],d[v+1],p);else for(let v=c-h;v>=o;v-=h)p=jU(v/h|0,d[v],d[v+1],p);return p&&F2(p,p.next)&&(S1(p),p=p.next),p}function ug(d,o){if(!d)return d;o||(o=d);let c,h=d;do if(c=!1,h.steiner||!F2(h,h.next)&&xo(h.prev,h,h.next)!==0)h=h.next;else{if(S1(h),h=o=h.prev,h===h.next)break;c=!0}while(c||h!==o);return o}function b1(d,o,c,h,m,p,v){if(!d)return;!v&&p&&function(M,O,w,P){let D=M;do D.z===0&&(D.z=yD(D.x,D.y,O,w,P)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==M);D.prevZ.nextZ=null,D.prevZ=null,function(I){let k,N=1;do{let W,Z=I;I=null;let ee=null;for(k=0;Z;){k++;let Q=Z,K=0;for(let se=0;se<N&&(K++,Q=Q.nextZ,Q);se++);let ie=N;for(;K>0||ie>0&&Q;)K!==0&&(ie===0||!Q||Z.z<=Q.z)?(W=Z,Z=Z.nextZ,K--):(W=Q,Q=Q.nextZ,ie--),ee?ee.nextZ=W:I=W,W.prevZ=ee,ee=W;Z=Q}ee.nextZ=null,N*=2}while(k>1)}(D)}(d,h,m,p);let T=d;for(;d.prev!==d.next;){const M=d.prev,O=d.next;if(p?Jle(d,h,m,p):Kle(d))o.push(M.i,d.i,O.i),S1(d),d=O.next,T=O.next;else if((d=O)===T){v?v===1?b1(d=Qle(ug(d),o),o,c,h,m,p,2):v===2&&ece(d,o,c,h,m,p):b1(ug(d),o,c,h,m,p,1);break}}}function Kle(d){const o=d.prev,c=d,h=d.next;if(xo(o,c,h)>=0)return!1;const m=o.x,p=c.x,v=h.x,T=o.y,M=c.y,O=h.y,w=m<p?m<v?m:v:p<v?p:v,P=T<M?T<O?T:O:M<O?M:O,D=m>p?m>v?m:v:p>v?p:v,I=T>M?T>O?T:O:M>O?M:O;let k=h.next;for(;k!==o;){if(k.x>=w&&k.x<=D&&k.y>=P&&k.y<=I&&$v(m,T,p,M,v,O,k.x,k.y)&&xo(k.prev,k,k.next)>=0)return!1;k=k.next}return!0}function Jle(d,o,c,h){const m=d.prev,p=d,v=d.next;if(xo(m,p,v)>=0)return!1;const T=m.x,M=p.x,O=v.x,w=m.y,P=p.y,D=v.y,I=T<M?T<O?T:O:M<O?M:O,k=w<P?w<D?w:D:P<D?P:D,N=T>M?T>O?T:O:M>O?M:O,W=w>P?w>D?w:D:P>D?P:D,Z=yD(I,k,o,c,h),ee=yD(N,W,o,c,h);let Q=d.prevZ,K=d.nextZ;for(;Q&&Q.z>=Z&&K&&K.z<=ee;){if(Q.x>=I&&Q.x<=N&&Q.y>=k&&Q.y<=W&&Q!==m&&Q!==v&&$v(T,w,M,P,O,D,Q.x,Q.y)&&xo(Q.prev,Q,Q.next)>=0||(Q=Q.prevZ,K.x>=I&&K.x<=N&&K.y>=k&&K.y<=W&&K!==m&&K!==v&&$v(T,w,M,P,O,D,K.x,K.y)&&xo(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;Q&&Q.z>=Z;){if(Q.x>=I&&Q.x<=N&&Q.y>=k&&Q.y<=W&&Q!==m&&Q!==v&&$v(T,w,M,P,O,D,Q.x,Q.y)&&xo(Q.prev,Q,Q.next)>=0)return!1;Q=Q.prevZ}for(;K&&K.z<=ee;){if(K.x>=I&&K.x<=N&&K.y>=k&&K.y<=W&&K!==m&&K!==v&&$v(T,w,M,P,O,D,K.x,K.y)&&xo(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function Qle(d,o){let c=d;do{const h=c.prev,m=c.next.next;!F2(h,m)&&NU(h,c,c.next,m)&&w1(h,m)&&w1(m,h)&&(o.push(h.i,c.i,m.i),S1(c),S1(c.next),c=d=m),c=c.next}while(c!==d);return ug(c)}function ece(d,o,c,h,m,p){let v=d;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&oce(v,T)){let M=zU(v,T);return v=ug(v,v.next),M=ug(M,M.next),b1(v,o,c,h,m,p,0),void b1(M,o,c,h,m,p,0)}T=T.next}v=v.next}while(v!==d)}function tce(d,o){return d.x-o.x}function rce(d,o){const c=function(m,p){let v=p;const T=m.x,M=m.y;let O,w=-1/0;do{if(M<=v.y&&M>=v.next.y&&v.next.y!==v.y){const N=v.x+(M-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(N<=T&&N>w&&(w=N,O=v.x<v.next.x?v:v.next,N===T))return O}v=v.next}while(v!==p);if(!O)return null;const P=O,D=O.x,I=O.y;let k=1/0;v=O;do{if(T>=v.x&&v.x>=D&&T!==v.x&&$v(M<I?T:w,M,D,I,M<I?w:T,M,v.x,v.y)){const N=Math.abs(M-v.y)/(T-v.x);w1(v,m)&&(N<k||N===k&&(v.x>O.x||v.x===O.x&&nce(O,v)))&&(O=v,k=N)}v=v.next}while(v!==P);return O}(d,o);if(!c)return o;const h=zU(c,d);return ug(h,h.next),ug(c,c.next)}function nce(d,o){return xo(d.prev,d,o.prev)<0&&xo(o.next,d,d.next)<0}function yD(d,o,c,h,m){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-c)*m|0)|d<<8))|d<<4))|d<<2))|d<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-h)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function ice(d){let o=d,c=d;do(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next;while(o!==d);return c}function $v(d,o,c,h,m,p,v,T){return(m-v)*(o-T)>=(d-v)*(p-T)&&(d-v)*(h-T)>=(c-v)*(o-T)&&(c-v)*(p-T)>=(m-v)*(h-T)}function oce(d,o){return d.next.i!==o.i&&d.prev.i!==o.i&&!function(c,h){let m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==h.i&&m.next.i!==h.i&&NU(m,m.next,c,h))return!0;m=m.next}while(m!==c);return!1}(d,o)&&(w1(d,o)&&w1(o,d)&&function(c,h){let m=c,p=!1;const v=(c.x+h.x)/2,T=(c.y+h.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&v<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(p=!p),m=m.next;while(m!==c);return p}(d,o)&&(xo(d.prev,d,o.prev)||xo(d,o.prev,o))||F2(d,o)&&xo(d.prev,d,d.next)>0&&xo(o.prev,o,o.next)>0)}function xo(d,o,c){return(o.y-d.y)*(c.x-o.x)-(o.x-d.x)*(c.y-o.y)}function F2(d,o){return d.x===o.x&&d.y===o.y}function NU(d,o,c,h){const m=$2(xo(d,o,c)),p=$2(xo(d,o,h)),v=$2(xo(c,h,d)),T=$2(xo(c,h,o));return m!==p&&v!==T||!(m!==0||!B2(d,c,o))||!(p!==0||!B2(d,h,o))||!(v!==0||!B2(c,d,h))||!(T!==0||!B2(c,o,h))}function B2(d,o,c){return o.x<=Math.max(d.x,c.x)&&o.x>=Math.min(d.x,c.x)&&o.y<=Math.max(d.y,c.y)&&o.y>=Math.min(d.y,c.y)}function $2(d){return d>0?1:d<0?-1:0}function w1(d,o){return xo(d.prev,d,d.next)<0?xo(d,o,d.next)>=0&&xo(d,d.prev,o)>=0:xo(d,o,d.prev)<0||xo(d,d.next,o)<0}function zU(d,o){const c=vD(d.i,d.x,d.y),h=vD(o.i,o.x,o.y),m=d.next,p=o.prev;return d.next=o,o.prev=d,c.next=m,m.prev=c,h.next=c,c.prev=h,p.next=h,h.prev=p,h}function jU(d,o,c,h){const m=vD(d,o,c);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function S1(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function vD(d,o,c){return{i:d,x:o,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function U2(d,o){const c=d.length;if(c<=1)return[d];const h=[];let m,p;for(let v=0;v<c;v++){const T=mi(d[v]);T!==0&&(d[v].area=Math.abs(T),p===void 0&&(p=T<0),p===T<0?(m&&h.push(m),m=[d[v]]):m.push(d[v]))}if(m&&h.push(m),o>1)for(let v=0;v<h.length;v++)h[v].length<=o||(HE(h[v],o,1,h[v].length-1,ace),h[v]=h[v].slice(0,o));return h}function ace(d,o){return o.area-d.area}function FU(d,o,c=1){if(!d)return null;const h=typeof d=="string"?sa.from(d).getPrimary():d.getPrimary(),m=h.id.toString();return o.has(m)||o.set(m,[]),h.scaleSelf(c),o.get(m).push(h),h.toString()}function _D(d,o,c,h){const m=h.patternDependencies;let p=!1;for(const v of o){const T=v.paint.get(`${d}-pattern`);T.isConstant()||(p=!0),FU(T.constantOr(null),m,c)&&(p=!0)}return p}function xD(d,o,c,h,m,p){const v=p.patternDependencies;for(const T of o){const M=T.paint.get(`${d}-pattern`).value;if(M.kind!=="constant"){let O=M.evaluate({zoom:h},c,{},p.availableImages);O=O&&O.name?O.name:O;const w=FU(O,v,m);w&&(c.patterns[T.id]=w)}}return c}var bD,BU,wD,$U,SD,UU,VU,V2={};function WU(){if(BU)return bD;BU=1;var d=Pr();function o(m,p,v,T,M){this.properties={},this.extent=v,this.type=0,this._pbf=m,this._geometry=-1,this._keys=T,this._values=M,m.readFields(c,this,p)}function c(m,p,v){m==1?p.id=v.readVarint():m==2?function(T,M){for(var O=T.readVarint()+T.pos;T.pos<O;){var w=M._keys[T.readVarint()],P=M._values[T.readVarint()];M.properties[w]=P}}(v,p):m==3?p.type=v.readVarint():m==4&&(p._geometry=v.pos)}function h(m){for(var p,v,T=0,M=0,O=m.length,w=O-1;M<O;w=M++)T+=((v=m[w]).x-(p=m[M]).x)*(p.y+v.y);return T}return bD=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var p,v=m.readVarint()+m.pos,T=1,M=0,O=0,w=0,P=[];m.pos<v;){if(M<=0){var D=m.readVarint();T=7&D,M=D>>3}if(M--,T===1||T===2)O+=m.readSVarint(),w+=m.readSVarint(),T===1&&(p&&P.push(p),p=[]),p.push(new d(O,w));else{if(T!==7)throw new Error("unknown command "+T);p&&p.push(p[0].clone())}}return p&&P.push(p),P},o.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var p=m.readVarint()+m.pos,v=1,T=0,M=0,O=0,w=1/0,P=-1/0,D=1/0,I=-1/0;m.pos<p;){if(T<=0){var k=m.readVarint();v=7&k,T=k>>3}if(T--,v===1||v===2)(M+=m.readSVarint())<w&&(w=M),M>P&&(P=M),(O+=m.readSVarint())<D&&(D=O),O>I&&(I=O);else if(v!==7)throw new Error("unknown command "+v)}return[w,D,P,I]},o.prototype.toGeoJSON=function(m,p,v){var T,M,O=this.extent*Math.pow(2,v),w=this.extent*m,P=this.extent*p,D=this.loadGeometry(),I=o.types[this.type];function k(Z){for(var ee=0;ee<Z.length;ee++){var Q=Z[ee];Z[ee]=[360*(Q.x+w)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+P)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(T=0;T<D.length;T++)N[T]=D[T][0];k(D=N);break;case 2:for(T=0;T<D.length;T++)k(D[T]);break;case 3:for(D=function(Z){var ee=Z.length;if(ee<=1)return[Z];for(var Q,K,ie=[],se=0;se<ee;se++){var de=h(Z[se]);de!==0&&(K===void 0&&(K=de<0),K===de<0?(Q&&ie.push(Q),Q=[Z[se]]):Q.push(Z[se]))}return Q&&ie.push(Q),ie}(D),T=0;T<D.length;T++)for(M=0;M<D[T].length;M++)k(D[T][M])}D.length===1?D=D[0]:I="Multi"+I;var W={type:"Feature",geometry:{type:I,coordinates:D},properties:this.properties};return"id"in this&&(W.id=this.id),W},bD}function GU(){if($U)return wD;$U=1;var d=WU();function o(h,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(c,this,m),this.length=this._features.length}function c(h,m,p){h===15?m.version=p.readVarint():h===1?m.name=p.readString():h===5?m.extent=p.readVarint():h===2?m._features.push(p.pos):h===3?m._keys.push(p.readString()):h===4&&m._values.push(function(v){for(var T=null,M=v.readVarint()+v.pos;v.pos<M;){var O=v.readVarint()>>3;T=O===1?v.readString():O===2?v.readFloat():O===3?v.readDouble():O===4?v.readVarint64():O===5?v.readVarint():O===6?v.readSVarint():O===7?v.readBoolean():null}return T}(p))}return wD=o,o.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var m=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,m,this.extent,this._keys,this._values)},wD}function qU(){return VU||(VU=1,V2.VectorTile=function(){if(UU)return SD;UU=1;var d=GU();function o(c,h,m){if(c===3){var p=new d(m,m.readVarint()+m.pos);p.length&&(h[p.name]=p)}}return SD=function(c,h){this.layers=c.readFields(o,{},h)},SD}(),V2.VectorTileFeature=WU(),V2.VectorTileLayer=GU()),V2}var Vf=qU();const dg="3d_elevation_id",HU="level";class sce{constructor(){this._valid=!1}reset(o){return this.feature=o,this._valid=!0,this._geometry=o.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(o,c){return this._valid&&o(c(this._geometry)),this}require(o,c,h){return this.get(o,!0,c,h)}optional(o,c,h){return this.get(o,!1,c,h)}success(){return this._valid}get(o,c,h,m){const p=this.feature.properties.hasOwnProperty(o)?+this.feature.properties[o]:void 0;return this._valid&&p!==void 0?h(m?m(p):p):c&&(this._valid=!1),this}}class ZU{constructor(o,c){this.featureFunc=o,this.vertexFunc=c}parseFeature(o,c,h){return this.featureFunc(o,c,h)}parseVertex(o,c,h){return this.vertexFunc(o,c,h)}}const lce=new ZU((d,o,c)=>d.reset(o).require(dg,h=>{c.id=h}).optional("fixed_height_relative",h=>{c.constantHeight=h},ih.decodeRelativeHeight).geometry(h=>{c.bounds=h},ih.computeBounds).success(),(d,o,c)=>d.reset(o).require(dg,h=>{c.id=h}).require("elevation_idx",h=>{c.idx=h}).require("extent",h=>{c.extent=h}).require("height_relative",h=>{c.height=h},ih.decodeRelativeHeight).geometry(h=>{c.position=h},ih.getPoint).success()),cce=new ZU((d,o,c)=>d.reset(o).require(dg,h=>{c.id=h}).optional("fixed_height",h=>{c.constantHeight=h},ih.decodeMetricHeight).geometry(h=>{c.bounds=h},ih.computeBounds).success(),(d,o,c)=>d.reset(o).require(dg,h=>{c.id=h}).require("elevation_idx",h=>{c.idx=h}).require("extent",h=>{c.extent=h}).require("height",h=>{c.height=h},ih.decodeMetricHeight).geometry(h=>{c.position=h},ih.getPoint).success());class ih{static computeBounds(o){const c=new _t(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),h=new _t(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const m of o[0])c.x>m.x&&(c.x=m.x),c.y>m.y&&(c.y=m.y),h.x<m.x&&(h.x=m.x),h.y<m.y&&(h.y=m.y);return{min:c,max:h}}static getPoint(o){return ge.vec2.fromValues(o[0][0].x,o[0][0].y)}static decodeRelativeHeight(o){return 1e-4*o*5}static decodeMetricHeight(o){return 1e-4*o}static parse(o){const c=[],h=[],m=o.length,p=new sce;for(let T=0;T<m;T++){const M=o.feature(T),O=M.properties.hasOwnProperty("version")?String(M.properties.version):void 0,w=(v=O)?v==="1.0.1"?cce:void 0:lce;if(w===void 0){pi(`Unknown elevation feature version number ${O||"(unknown)"}`);continue}const P=M.properties.hasOwnProperty("type")?M.properties.type:void 0;if(P){if(Vf.VectorTileFeature.types[M.type]==="Point"&&P==="curve_point"){const D={};w.parseVertex(p,M,D)&&c.push(D)}else if(Vf.VectorTileFeature.types[M.type]==="Polygon"&&P==="curve_meta"){const D={};w.parseFeature(p,M,D)&&h.push(D)}}}var v;return{vertices:c,features:h}}}class TD{constructor(o,c,h,m,p,v){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=o,this.heightRange={min:h,max:h},this.safeArea=c,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||m.length!==0)){this.vertices=m,this.edges=p,this.edges=this.edges.filter(T=>T.a<this.vertices.length&&T.b<this.vertices.length&&!ge.vec2.exactEquals(this.vertices[T.a].position,this.vertices[T.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const T of this.vertices)this.vertexProps.push({dir:ge.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,T.height),this.heightRange.max=Math.max(this.heightRange.max,T.height);for(const T of this.edges){const M=this.vertices[T.a].position,O=this.vertices[T.b].position,w=ge.vec2.subtract(ge.vec2.create(),O,M),P=ge.vec2.length(w),D=ge.vec2.scale(ge.vec2.create(),w,1/P);this.edgeProps.push({vec:w,dir:D,len:P});const I=this.vertexProps[T.a].dir,k=this.vertexProps[T.b].dir;ge.vec2.add(I,I,D),ge.vec2.add(k,k,D)}for(const T of this.vertexProps)T.dir[0]===0&&T.dir[1]===0||ge.vec2.normalize(T.dir,T.dir);this.tessellate(v)}}pointElevation(o){if(this.constantHeight!=null)return this.constantHeight;const c=this.getClosestEdge(o);if(c==null)return 0;const[h,m]=c;return((p,v,T)=>(1-T)*p+T*v)(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,m)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(o){if(this.edges.length===0)return;let c=0,h=Number.POSITIVE_INFINITY,m=0;const p=ge.vec2.fromValues(o.x,o.y);for(let v=0;v<this.edges.length;v++){const T=this.edges[v],M=this.edgeProps[v].dir,O=new Mr(p,this.edgeProps[v].dir),w=this.vertices[T.a].position,P=this.vertices[T.b].position,D=ge.vec2.create(),I=ge.vec2.create(),k=O.intersectsPlane(w,this.vertexProps[T.a].dir,D),N=O.intersectsPlane(P,this.vertexProps[T.b].dir,I);if(!k||!N)continue;const W=ge.vec2.subtract(ge.vec2.create(),I,D),Z=ge.vec2.subtract(ge.vec2.create(),p,D),ee=ge.vec2.dot(W,W),Q=ee>0?ge.vec2.dot(Z,W)/ee:0,K=Kt(Q,0,1),ie=Math.abs((Q-K)*this.edgeProps[v].len),se=ge.vec2.subtract(ge.vec2.create(),p,w),de=ie+Math.abs(ge.vec2.dot(se,ge.vec2.fromValues(M[1],-M[0])));de<h&&(c=v,h=de,m=K)}return[c,m]}tessellate(o){for(let c=this.edges.length-1;c>=0;--c){const h=this.edges[c].a,m=this.edges[c].b,{position:p,height:v,extent:T}=this.vertices[h],{position:M,height:O,extent:w}=this.vertices[m],P=this.vertexProps[h].dir,D=this.vertexProps[m].dir,I=ge.vec3.fromValues(p[0]/o,p[1]/o,v),k=ge.vec3.fromValues(M[0]/o,M[1]/o,O),N=ge.vec3.fromValues(P[1],-P[0],0);ge.vec3.scale(N,N,T);const W=ge.vec3.fromValues(D[1],-D[0],0);if(ge.vec3.scale(W,W,w),this.distSqLines(ge.vec3.fromValues(I[0]+.5*N[0],I[1]+.5*N[1],I[2]+.5*N[2]),ge.vec3.fromValues(k[0]-.5*W[0],k[1]-.5*W[1],k[2]-.5*W[2]),ge.vec3.fromValues(I[0]-.5*N[0],I[1]-.5*N[1],I[2]-.5*N[2]),ge.vec3.fromValues(k[0]+.5*W[0],k[1]+.5*W[1],k[2]+.5*W[2]))<=.05*.05)continue;const Z=this.vertices.length,ee=ge.vec2.add(ge.vec2.create(),p,M);this.vertices.push({position:ge.vec2.scale(ee,ee,.5),height:.5*(v+O),extent:.5*(T+w)});const Q=ge.vec2.add(ge.vec2.create(),P,D);this.vertexProps.push({dir:ge.vec2.normalize(Q,Q)}),this.edges.splice(c,1),this.edgeProps.splice(c,1),this.edges.push({a:h,b:Z}),this.edges.push({a:Z,b:m});const K=ge.vec2.subtract(ge.vec2.create(),this.vertices[Z].position,p),ie=ge.vec2.length(K),se={vec:K,dir:ge.vec2.scale(ge.vec2.create(),K,1/ie),len:ie};this.edgeProps.push(se),this.edgeProps.push(se)}}distSqLines(o,c,h,m){const p=ge.vec3.subtract(ge.vec3.create(),c,o),v=ge.vec3.subtract(ge.vec3.create(),m,h),T=ge.vec3.subtract(ge.vec3.create(),o,h),M=ge.vec3.dot(p,p),O=ge.vec3.dot(p,v),w=ge.vec3.dot(p,T),P=ge.vec3.dot(v,v),D=ge.vec3.dot(v,T),I=M*P-O*O;if(I===0){const ee=ge.vec3.dot(T,v)/ge.vec3.dot(v,v),Q=ge.vec3.lerp(ge.vec3.create(),h,m,ee);return ge.vec3.squaredDistance(Q,o)}const k=(O*D-w*P)/I,N=(M*D-O*w)/I,W=ge.vec3.lerp(ge.vec3.create(),o,c,k),Z=ge.vec3.lerp(ge.vec3.create(),h,m,N);return ge.vec3.squaredDistance(W,Z)}}class uce{constructor(o,c){this.zScale=1,this.xOffset=0,this.yOffset=0,o.equals(c)||(this.zScale=Math.pow(2,c.z-o.z),this.xOffset=(o.x*this.zScale-c.x)*Bt,this.yOffset=(o.y*this.zScale-c.y)*Bt)}constantElevation(o,c){if(o.constantHeight!=null)return this.computeBiasedHeight(o.constantHeight,c)}pointElevation(o,c,h){const m=this.constantElevation(c,h);return m??(o.x=o.x*this.zScale+this.xOffset,o.y=o.y*this.zScale+this.yOffset,this.computeBiasedHeight(c.pointElevation(o),h))}computeBiasedHeight(o,c){return c<=0?o:o+c*Zr(0,c,o>=0?o:Math.abs(.5*o))}}Jt(TD,"ElevationFeature");class XU{constructor(){this.polygons=new Map}add(o,...c){this.polygons.has(o)?this.polygons.get(o).push(...c):this.polygons.set(o,c)}merge(o){for(const[c,h]of o.polygons)this.add(c,...h)}}class hg{constructor(){this.portals=[]}static evaluate(o){if(o.length===0)return new hg;let c=[];for(const O of o)c.push(...O.portals);if(c.length===0)return new hg;const h=(O,w)=>O<=0&&w<=0||O>=Bt&&w>=Bt;for(const O of c){const w=O.va,P=O.vb;(h(w.x,P.x)||h(w.y,P.y))&&(O.type="border")}const m=c.filter(O=>O.type!=="unevaluated"),p=c.filter(O=>O.type==="unevaluated");if(p.length===0)return new hg;p.sort((O,w)=>O.hash===w.hash?O.isTunnel===w.isTunnel?0:O.isTunnel?-1:1:O.hash<w.hash?1:-1),c=m.concat(p);let v=m.length,T=v,M=v;do if(T++,T===c.length||c[v].hash!==c[T].hash){if(T-v==2){M<v&&(c[M]=c[v],c[v]=null);const O=c[M],w=c[T-1];O.type=O.isTunnel!==w.isTunnel?"tunnel":"polygon",O.connection={a:O.connection.a,b:w.connection.a},M++}v=T}while(v!==c.length);return c.splice(M),c.sort((O,w)=>O.hash<w.hash?1:-1),{portals:c}}}Jt(hg,"ElevationPortalGraph"),Jt(XU,"ElevationPolygons");class dce{constructor(o,c,h){this.outPositions=o,this.outNormals=c,this.outIndices=h,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(o,c,h){let m=o[2];h!=null&&(m*=h);const p=this.getVec3Bits(o)<<96n|this.getVec3Bits(c),v=this.vertexLookup.get(p);if(v!=null)return v;const T=this.outPositions.length;this.vertexLookup.set(p,T);const M=Math.trunc(16384*c[0]),O=Math.trunc(16384*c[1]),w=Math.trunc(16384*c[2]);return this.outPositions.emplaceBack(o[0],o[1],m),this.outNormals.emplaceBack(M,O,w),T}addVertices(o,c,...h){const m=[];for(const p of h){const v=this.addVertex(p,o,c);m.push(v)}return m}addTriangles(o,c,h){if(c&&h){const m=h.length===1,p=ge.vec3.fromValues(0,0,0);for(let v=0;v<o.length;v+=3){const T=c[o[v+0]],M=c[o[v+1]],O=c[o[v+2]],w=m?h[0]:h[o[v+1]],P=m?h[0]:h[o[v+2]],D=this.addVertex(ge.vec3.fromValues(T.x,T.y,m?h[0]:h[o[v+0]]),p),I=this.addVertex(ge.vec3.fromValues(M.x,M.y,w),p),k=this.addVertex(ge.vec3.fromValues(O.x,O.y,P),p);this.outIndices.emplaceBack(D,I,k)}}else for(let m=0;m<o.length;m+=3)this.outIndices.emplaceBack(o[m+0],o[m+1],o[m+2])}addQuad(o,c){const h=this.addVertices(c,void 0,...o.map(M=>ge.vec3.fromValues(M.coord.x,M.coord.y,M.height))),[m,p,v,T]=h;this.addTriangles([m,p,v,v,T,m])}getBits(o){return this.view.setFloat32(0,o),BigInt(this.view.getUint32(0))}getVec3Bits(o){return this.getBits(o[0])<<64n|this.getBits(o[1])<<32n|this.getBits(o[2])}}class Yc{constructor(o){this.unevaluatedPortals=new hg,this.portalPolygons=new XU,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Km,this.vertexNormals=new Jb,this.indexArray=new Bo,this.tileToMeters=y(o)}addVertices(o,c){const h=this.unevalVertices.length;for(let m=0;m<o.length;m++)this.unevalVertices.push(o[m]),this.unevalHeights.push(c[m]);return h}addTriangles(o,c,h){const m=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const p of o)m.push(p+c)}addRenderableRing(o,c,h,m,p){const v=[new _t(p.min.x,p.min.y),new _t(p.max.x,p.min.y),new _t(p.max.x,p.max.y),new _t(p.min.x,p.max.y)];for(let T=0;T<h-1;T++){const M=c+T,O=M+1,w=this.unevalVertices[M],P=this.unevalVertices[O];if(!(w.x>=p.min.x&&w.x<=p.max.x&&w.y>=p.min.y&&w.y<=p.max.y||P.x>=p.min.x&&P.x<=p.max.x&&P.y>=p.min.y&&P.y<=p.max.y||Ne(w,P,v))||this.isOnBorder(w.x,P.x)||this.isOnBorder(w.y,P.y))continue;const D=Yc.computeEdgeHash(this.unevalVertices[M],this.unevalVertices[O]);let I,k=this.vertexHashLookup.get(Yc.computePosHash(w));k!=null?I=k.next:(k=this.vertexHashLookup.get(Yc.computePosHash(P)),I=k!=null?k.prev:D),this.unevalEdges.push({polygonIdx:o,a:M,b:O,hash:D,portalHash:I,isTunnel:m,type:"unevaluated"})}}addPortalCandidates(o,c,h,m,p){if(c.length===0)return;this.portalPolygons.add(o,{geometry:c,zLevel:p});const v=c[0];this.vertexHashLookup.clear();let T=Yc.computeEdgeHash(v[v.length-2],v[v.length-1]);for(let M=0;M<v.length-1;M++){const O=v[M+0],w=v[M+1],P=ge.vec2.fromValues(w.x-O.x,w.y-O.y),D=ge.vec2.length(P);if(D===0)continue;let I="unevaluated";const k=m.pointElevation(O),N=m.pointElevation(w);Math.abs(k)<.01&&Math.abs(N)<.01?I="entrance":(this.isOnBorder(O.x,w.x)||this.isOnBorder(O.y,w.y))&&(I="border");const W=Yc.computeEdgeHash(O,w);this.unevaluatedPortals.portals.push({connection:{a:o,b:void 0},va:O,vb:w,vab:P,length:D,hash:W,isTunnel:h,type:I});const Z=Yc.computePosHash(O);this.vertexHashLookup.set(Z,{prev:T,next:W}),T=W}}construct(o){if(this.unevalVertices.length===0)return;const c=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=P=>{P.primitiveLength=this.indexArray.length-P.primitiveOffset},m=new dce(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(o.portals,this.unevalEdges);const p=c(),v=c(),T=c(),M=(P,D)=>{P.sort((k,N)=>k.type===D&&N.type!==D?-1:k.type!==D&&N.type===D?1:0);const I=P.findIndex(k=>k.type!==D);return I>=0?I:P.length};let O=0;this.unevalEdges.length>0&&(O=M(this.unevalEdges,"none"),this.constructBridgeStructures(m,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},this.tileToMeters));const w=c();if(this.unevalEdges.length>0){const P=this.unevalEdges.splice(O),D=M(P,"tunnel")+O;this.unevalEdges.push(...P),this.constructTunnelStructures(m,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},{min:O,max:D})}h(T),m.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(w),m.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(v),m.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(p),this.maskSegments=si.simpleSegment(0,w.primitiveOffset,0,w.primitiveLength),this.depthSegments=si.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.renderableSegments=si.simpleSegment(0,T.primitiveOffset,0,T.primitiveLength),this.shadowCasterSegments=si.simpleSegment(0,p.primitiveOffset,0,p.primitiveLength)}upload(o){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=o.createVertexBuffer(this.vertexPositions,Xle.members),this.vertexBufferNormal=o.createVertexBuffer(this.vertexNormals,Yle.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(o,c,h,m){const p=new Map;for(let v=h;v<m;v++){const T=c[v],M=T.a,O=T.b;p.has(M)||p.set(M,{}),p.has(O)||p.set(O,{});const w=p.get(M),P=p.get(O);o[O]>0&&(w.to=O),o[M]>0&&(P.from=M)}return p}constructBridgeStructures(o,c,h,m,p,v){const T=this.computeVertexConnections(h,m,p.min,p.max),M=1/v,O=.5*M,w=D=>ge.vec3.fromValues(c[D].x,c[D].y,h[D]*M),P=D=>{const I=T.get(D),k=I.from,N=I.to;if(!k||!N)return;const W=w(k),Z=w(D),ee=w(N),Q=ge.vec3.fromValues(0,0,0);if(!ge.vec3.exactEquals(W,Z)){const ie=ge.vec3.sub(ge.vec3.create(),Z,W);ge.vec3.add(Q,Q,ge.vec3.normalize(ie,ie))}if(!ge.vec3.exactEquals(ee,Z)){const ie=ge.vec3.sub(ge.vec3.create(),ee,Z);ge.vec3.add(Q,Q,ge.vec3.normalize(ie,ie))}const K=ge.vec3.len(Q);return K>0?ge.vec3.scale(Q,Q,1/K):void 0};for(let D=p.min;D<p.max;D++){const I=m[D],k=this.prepareEdgePoints(c,h,I,(It,yr)=>It>=yr);if(k==null)continue;const N=k[0],W=k[1],Z=ge.vec3.fromValues(N.coord.x,N.coord.y,M*N.height),ee=ge.vec3.fromValues(W.coord.x,W.coord.y,M*W.height);if(ge.vec3.exactEquals(Z,ee))continue;const Q=ge.vec3.sub(ge.vec3.create(),ee,Z);ge.vec3.normalize(Q,Q);const K=It=>ge.vec3.normalize(It,It),ie=P(I.a)||Q,se=P(I.b)||Q,de=K(ge.vec3.fromValues(ie[1],-ie[0],0)),we=K(ge.vec3.fromValues(se[1],-se[0],0)),_e=K(ge.vec3.cross(ge.vec3.create(),de,ie)),xe=K(ge.vec3.cross(ge.vec3.create(),we,se)),ke=ge.vec3.create(),Se=[ge.vec3.add(ge.vec3.create(),Z,ge.vec3.scale(ke,ge.vec3.sub(ke,de,_e),O)),ge.vec3.add(ge.vec3.create(),Z,ge.vec3.scale(ke,ge.vec3.add(ke,de,_e),O)),ge.vec3.add(ge.vec3.create(),Z,ge.vec3.scale(ke,_e,O)),Z],De=[ge.vec3.add(ge.vec3.create(),ee,ge.vec3.scale(ke,ge.vec3.sub(ke,we,xe),O)),ge.vec3.add(ge.vec3.create(),ee,ge.vec3.scale(ke,ge.vec3.add(ke,we,xe),O)),ge.vec3.add(ge.vec3.create(),ee,ge.vec3.scale(ke,xe,O)),ee],[Ve,Fe]=o.addVertices(de,v,Se[0],Se[1]),[Ze,He]=o.addVertices(we,v,De[0],De[1]);o.addTriangles([Ve,Fe,Ze,Fe,He,Ze]);const[tt,Ke]=o.addVertices(_e,v,Se[1],Se[2]),[nt,Ct]=o.addVertices(xe,v,De[1],De[2]);o.addTriangles([tt,Ke,nt,Ke,Ct,nt]);const[At,Qt]=o.addVertices(ge.vec3.negate(de,de),v,Se[2],Se[3]),[Rt,Ft]=o.addVertices(ge.vec3.negate(we,we),v,De[2],De[3]);o.addTriangles([At,Qt,Rt,Qt,Ft,Rt])}}constructTunnelStructures(o,c,h,m,p,v){const T=M=>ge.vec3.normalize(M,M);for(let M=p.min;M<p.max;M++){const O=this.prepareEdgePoints(c,h,m[M],(I,k)=>I<=k);if(O==null)continue;const[w,P]=O,D=T(ge.vec3.fromValues(P.coord.y-w.coord.y,-(P.coord.x-w.coord.x),0));o.addQuad([w,P,{coord:P.coord,height:m[M].isTunnel?-.1:0},{coord:w.coord,height:m[M].isTunnel?-.1:0}],D)}for(let M=v.min;M<v.max;M++){const O=m[M],w=c[O.a],P=c[O.b],D=T(ge.vec3.fromValues(P.y-w.y,-(P.x-w.x),0));o.addQuad([{coord:P,height:0},{coord:w,height:0},{coord:w,height:h[O.a]+4},{coord:P,height:h[O.b]+4}],D),o.addQuad([{coord:w,height:0},{coord:P,height:0},{coord:P,height:h[O.b]+4},{coord:w,height:h[O.a]+4}],D)}}prepareEdgePoints(o,c,h,m){const p=o[h.a],v=o[h.b];let T=c[h.a],M=c[h.b];if(!(T!==0&&m(T,0)||M!==0&&m(M,0)))return;const O=p.clone(),w=v.clone();if(m(T,0)){if(!m(M,0)){const P=M/(M-T);w.x=_r(w.x,O.x,P),w.y=_r(w.y,O.y,P),M=_r(M,T,P)}}else{const P=T/(T-M);O.x=_r(O.x,w.x,P),O.y=_r(O.y,w.y,P),T=_r(T,M,P)}return[{coord:O,height:T},{coord:w,height:M}]}prepareEdges(o,c){if(c.length===0)return;c.sort((T,M)=>T.hash===M.hash?M.polygonIdx-T.polygonIdx:M.hash>T.hash?1:-1);let h=0,m=0,p=0,v=c[h].polygonIdx;do m++,(m===c.length||c[h].hash!==c[m].hash)&&((m-h==1||c[m-1].polygonIdx!==v)&&(p<h&&(c[p]=c[h],c[h]=null),c[p].type="none",p++),h=m,h!==c.length&&(v=c[h].polygonIdx));while(h!==c.length);if(c.splice(p),c.length!==0&&o.length!==0){c.sort((O,w)=>O.hash<w.hash?1:-1);let T=0,M=0;for(;T!==c.length&&M!==o.length;){const O=c[T],w=o[M];O.portalHash>w.hash?T++:w.hash>O.portalHash?M++:(O.type=w.type,T++)}}}isOnBorder(o,c){return o<=0&&c<=0||o>=Bt&&c>=Bt}static computeEdgeHash(o,c){return(o.y===c.y&&o.x>c.x||o.y>c.y)&&([o,c]=[c,o]),BigInt(Yc.computePosHash(o))<<32n|BigInt(Yc.computePosHash(c))}static computePosHash(o){return((65535&o.x)<<16|65535&o.y)>>>0}}class ED{constructor(o,c){this.layoutVertexArray=new Gc,this.indexArray=new Bo,this.lineIndexArray=new Yu,this.triangleSegments=new si,this.lineSegments=new si,this.programConfigurations=new Ju(o.layers,{zoom:o.zoom,lut:o.lut}),this.uploaded=!1,c&&(this.elevatedLayoutVertexArray=new Jd)}update(o,c,h,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,h,m,v,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Hle.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.lineIndexBuffer=o.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=o.createVertexBuffer(this.elevatedLayoutVertexArray,Zle.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(o,c,h,m,p,v){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,c,h,m,p,v)}}class AD{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new ED(o,!1),this.elevationBufferData=new ED(o,!0),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=o.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(o,c){}populate(o,c,h,m){this.hasPattern=_D("fill",this.layers,this.pixelRatio,c);const p=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:M,index:O,sourceLayerIndex:w}of o){const P=this.layers[0]._featureFilter.needGeometry,D=V(T,P);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),D,h))continue;const I=p?p.evaluate(D,{},h,c.availableImages):void 0,k={id:M,properties:T.properties,type:T.type,sourceLayerIndex:w,index:O,geometry:P?D.geometry:B(T,h,m),patterns:{},sortKey:I};v.push(k)}p&&v.sort((T,M)=>T.sortKey-M.sortKey);for(const T of v){const{geometry:M,index:O,sourceLayerIndex:w}=T;if(this.hasPattern){const P=xD("fill",this.layers,T,this.zoom,this.pixelRatio,c);this.patternFeatures.push(P)}else this.addFeature(T,M,O,h,{},c.availableImages,c.brightness,c.elevationFeatures);c.featureIndex.insert(o[O].feature,M,O,w,this.index)}}update(o,c,h,m,p,v,T){this.bufferData.update(o,c,h,m,p,v,T),this.elevationBufferData.update(o,c,h,m,p,v,T)}addFeatures(o,c,h,m,p,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,c,h,m,v,o.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(o){this.bufferData.upload(o),this.elevationBufferData.upload(o),this.elevatedStructures&&this.elevatedStructures.upload(o)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(o,c,h,m,p,v=[],T,M){const O=U2(c,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(o,O,m,h,M):this.addGeometry(O,this.bufferData),this.bufferData.populatePaintArrays(o,h,p,v,m,T),this.elevationBufferData.populatePaintArrays(o,h,p,v,m,T)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(o){this.elevatedStructures&&this.elevatedStructures.construct(o)}addElevatedRoadFeature(o,c,h,m,p){const v=new Array,T=this.getElevationFeature(o,p);if(T){v.push({polygons:c,elevationFeature:T,elevationTileID:h});for(const M of v)if(M.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Yc(M.elevationTileID));const w=M.elevationFeature.isTunnel();let P=0;o.properties.hasOwnProperty(HU)&&(P=+o.properties[HU]);for(const D of M.polygons)this.elevatedStructures.addPortalCandidates(M.elevationFeature.id,D,w,M.elevationFeature,P)}const O=new uce(h,M.elevationTileID);this.addElevatedGeometry(M.polygons,O,M.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,m)}}else this.addGeometry(c,this.bufferData)}addElevatedGeometry(o,c,h,m,p){const v={elevation:h,elevationSampler:c,bias:m,index:p},[T,M]=this.addGeometry(o,this.elevationBufferData,v);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:M}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,M))}addGeometry(o,c,h){let m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,v=null;h&&(v=h.elevationSampler.constantElevation(h.elevation,h.bias),v!=null&&(m=v,p=v));const T=(M,O,w)=>{if(h!=null)if(O.push(M),v!=null)c.elevatedLayoutVertexArray.emplaceBack(v),w.push(v);else{const P=h.elevationSampler.pointElevation(M,h.elevation,h.bias);c.elevatedLayoutVertexArray.emplaceBack(P),w.push(P),m=Math.min(m,P),p=Math.max(p,P)}};for(const M of o){let O=0;for(const Q of M)O+=Q.length;const w=c.triangleSegments.prepareSegment(O,c.layoutVertexArray,c.indexArray),P=w.vertexLength,D=[],I=[],k=[],N=[],W=[],Z=c.layoutVertexArray.length;for(const Q of M){if(Q.length===0)continue;Q!==M[0]&&I.push(D.length/2);const K=c.lineSegments.prepareSegment(Q.length,c.layoutVertexArray,c.lineIndexArray),ie=K.vertexLength;h&&W.push(c.layoutVertexArray.length-Z),T(Q[0],k,N),c.layoutVertexArray.emplaceBack(Q[0].x,Q[0].y),c.lineIndexArray.emplaceBack(ie+Q.length-1,ie),D.push(Q[0].x),D.push(Q[0].y);for(let se=1;se<Q.length;se++)T(Q[se],k,N),c.layoutVertexArray.emplaceBack(Q[se].x,Q[se].y),c.lineIndexArray.emplaceBack(ie+se-1,ie+se),D.push(Q[se].x),D.push(Q[se].y);K.vertexLength+=Q.length,K.primitiveLength+=Q.length}const ee=x1(D,I);for(let Q=0;Q<ee.length;Q+=3)c.indexArray.emplaceBack(P+ee[Q],P+ee[Q+1],P+ee[Q+2]);if(h&&this.elevationMode==="hd-road-base"){const Q=h.elevation.isTunnel(),K=h.elevation.safeArea,ie=this.elevatedStructures.addVertices(k,N);this.elevatedStructures.addTriangles(ee,ie,Q);const se=W.length;if(se>0){for(let de=0;de<se-1;de++)this.elevatedStructures.addRenderableRing(h.index,W[de]+ie,W[de+1]-W[de],Q,K);this.elevatedStructures.addRenderableRing(h.index,W[se-1]+ie,k.length-W[se-1],Q,K)}}w.vertexLength+=O,w.primitiveLength+=ee.length/3}return[m,p]}getElevationFeature(o,c){if(!c)return;const h=+o.properties[dg];return h!=null?c.find(m=>m.id===h):void 0}}let YU,KU,JU,QU;Jt(AD,"FillBucket",{omit:["layers","patternFeatures"]}),Jt(ED,"FillBufferData"),Jt(Yc,"ElevatedStructures");class MD{constructor(o,c,h,m){if(this.triangleCount=c.length/3,this.min=new _t(0,0),this.max=new _t(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;const[p,v]=[o[0].clone(),o[0].clone()];for(let P=1;P<o.length;++P){const D=o[P];p.x=Math.min(p.x,D.x),p.y=Math.min(p.y,D.y),v.x=Math.max(v.x,D.x),v.y=Math.max(v.y,D.y)}if(m){const P=Math.ceil(Math.max(v.x-p.x,v.y-p.y)/m);h=Math.max(h,P)}if(h===0)return;this.min=p,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const M=Math.max(T.x,T.y)/h;this.cellsX=Math.max(1,Math.ceil(T.x/M)),this.cellsY=Math.max(1,Math.ceil(T.y/M)),this.xScale=1/M,this.yScale=1/M;const O=[];for(let P=0;P<this.triangleCount;P++){const D=o[c[3*P+0]].sub(this.min),I=o[c[3*P+1]].sub(this.min),k=o[c[3*P+2]].sub(this.min),N=td(Math.floor(Math.min(D.x,I.x,k.x)),this.xScale,this.cellsX),W=td(Math.floor(Math.max(D.x,I.x,k.x)),this.xScale,this.cellsX),Z=td(Math.floor(Math.min(D.y,I.y,k.y)),this.yScale,this.cellsY),ee=td(Math.floor(Math.max(D.y,I.y,k.y)),this.yScale,this.cellsY),Q=new _t(0,0),K=new _t(0,0),ie=new _t(0,0),se=new _t(0,0);for(let de=Z;de<=ee;++de){Q.y=K.y=de*M,ie.y=se.y=(de+1)*M;for(let we=N;we<=W;++we)Q.x=ie.x=we*M,K.x=se.x=(we+1)*M,(dt(D,I,k,Q,K,se)||dt(D,I,k,Q,se,ie))&&O.push({cellIdx:de*this.cellsX+we,triIdx:P})}}if(O.length===0)return;O.sort((P,D)=>P.cellIdx-D.cellIdx||P.triIdx-D.triIdx);let w=0;for(;w<O.length;){const P=O[w].cellIdx,D={start:this.payload.length,len:0};for(;w<O.length&&O[w].cellIdx===P;)++D.len,this.payload.push(O[w++].triIdx);this.cells[P]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,c){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const h=td(o.x-this.min.x,this.xScale,this.cellsX),m=td(o.y-this.min.y,this.yScale,this.cellsY),p=this.cells[m*this.cellsX+h];if(p){this._lazyInitLookup();for(let v=0;v<p.len;v++){const T=this.payload[p.start+v],M=Math.floor(T/8),O=1<<T%8;if(!(this.lookup[M]&O)&&(this.lookup[M]|=O,c.push(T),c.length===this.triangleCount))return}}}query(o,c,h){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>c.x||o.y>this.max.y||this.min.y>c.y)return;this._lazyInitLookup();const m=td(o.x-this.min.x,this.xScale,this.cellsX),p=td(c.x-this.min.x,this.xScale,this.cellsX),v=td(o.y-this.min.y,this.yScale,this.cellsY),T=td(c.y-this.min.y,this.yScale,this.cellsY);for(let M=v;M<=T;M++)for(let O=m;O<=p;O++){const w=this.cells[M*this.cellsX+O];if(w)for(let P=0;P<w.len;P++){const D=this.payload[w.start+P],I=Math.floor(D/8),k=1<<D%8;if(!(this.lookup[I]&k)&&(this.lookup[I]|=k,h.push(D),h.length===this.triangleCount))return}}}}function td(d,o,c){return Math.max(0,Math.min(c-1,Math.floor(d*o)))}Jt(MD,"TriangleGridIndex");class e6{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.footprints=[]}updateFootprints(o,c){for(const h of this.footprints)c.push({footprint:h,id:o})}populate(o,c,h,m){const p=[];for(const{feature:v,id:T,index:M,sourceLayerIndex:O}of o){const w=this.layers[0]._featureFilter.needGeometry,P=V(v,w);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),P,h))continue;const D={id:T,properties:v.properties,type:v.type,sourceLayerIndex:O,index:M,geometry:w?P.geometry:B(v,h,m),patterns:{}};p.push(D)}for(const v of p){const{geometry:T,index:M,sourceLayerIndex:O}=v;this.addFeature(v,T,M,h,{},c.availableImages,c.brightness),c.featureIndex.insert(o[M].feature,T,M,O,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,c,h,m,p,v,T){}destroy(){}addFeature(o,c,h,m,p,v=[],T){for(const M of U2(c,2)){const O=[],w=[],P=[],D=new _t(1/0,1/0),I=new _t(-1/0,-1/0);for(const W of M)if(W.length!==0){W!==M[0]&&P.push(w.length/2);for(let Z=0;Z<W.length;Z++)w.push(W[Z].x),w.push(W[Z].y),O.push(W[Z]),D.x=Math.min(D.x,W[Z].x),D.y=Math.min(D.y,W[Z].y),I.x=Math.max(I.x,W[Z].x),I.y=Math.max(I.y,W[Z].y)}const k=x1(w,P),N=new MD(O,k,8,256);this.footprints.push({vertices:O,indices:k,grid:N,min:D,max:I})}}}Jt(e6,"ClipBucket",{omit:["layers"]});const hce=mn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fce=mn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),pce=mn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),mce=mn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),gce=mn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),yce=mn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:vce}=hce;class fg extends _t{constructor(o,c,h){super(o,c),this.z=h}}class t6 extends fg{constructor(o,c,h,m){super(o,c,h),this.w=m}}function W2(d,o,c,h){const m=[],p=h===0?(v,T,M,O,w,P)=>{v.push(new _t(P,M+(P-T)/(O-T)*(w-M)))}:(v,T,M,O,w,P)=>{v.push(new _t(T+(P-M)/(w-M)*(O-T),P))};for(const v of d){const T=[];for(const M of v){if(M.length<=2)continue;const O=[];for(let D=0;D<M.length-1;D++){const I=M[D].x,k=M[D].y,N=M[D+1].x,W=M[D+1].y,Z=h===0?I:k,ee=h===0?N:W;Z<o?ee>o&&p(O,I,k,N,W,o):Z>c?ee<c&&p(O,I,k,N,W,c):O.push(M[D]),ee<o&&Z>=o&&p(O,I,k,N,W,o),ee>c&&Z<=c&&p(O,I,k,N,W,c)}let w=M[M.length-1];const P=h===0?w.x:w.y;P>=o&&P<=c&&O.push(w),O.length&&(w=O[O.length-1],O[0].x===w.x&&O[0].y===w.y||O.push(O[0]),T.push(O))}T.length&&m.push(T)}return m}function r6(d,o,c,h){const m=c==="x"?"y":"x",p=(h-d[c])/(o[c]-d[c]);d[m]=d[m]+(o[m]-d[m])*p,d[c]=h,d.hasOwnProperty("z")&&(d.z=_r(d.z,o.z,p)),d.hasOwnProperty("w")&&(d.w=_r(d.w,o.w,p))}function n6(d,o,c,h){const m=c,p=h;for(const v of["x","y"]){let T=d,M=o;T[v]>=M[v]&&(T=o,M=d),T[v]<m&&M[v]>m&&r6(T,M,v,m),T[v]<p&&M[v]>p&&r6(M,T,v,p)}}const G2=Number.MAX_SAFE_INTEGER;function i6(d,o,c,h){return d.order<o||d.order===G2||!(d.clipMask&c)||function(m,p){return p.length!==0&&p.find(v=>v===m)===void 0}(h,d.clipScope)}function q2(d,o){return d.x-o.x||d.y-o.y}function o6(d,o){return q2(d.min,o.min)===0&&q2(d.max,o.max)===0}function CD(d,o){return!(d.min.x>o.max.x||d.max.x<o.min.x||d.min.y>o.max.y||d.max.y<o.min.y)}function PD(d,o){if(d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(d[c].sourceId!==o[c].sourceId||!o6(d[c],o[c])||d[c].order!==o[c].order||d[c].clipMask!==o[c].clipMask||!hn(d[c].clipScope,o[c].clipScope))return!1;return!0}function a6(d,o,c){const h=1/Bt,m=1/(1<<c.canonical.z),p=(o.x*h+c.canonical.x)*m+c.wrap,v=(o.y*h+c.canonical.y)*m;return{min:new _t((d.x*h+c.canonical.x)*m+c.wrap,(d.y*h+c.canonical.y)*m),max:new _t(p,v)}}function _ce(d,o,c){const h=1<<c.canonical.z,m=((o.x-c.wrap)*h-c.canonical.x)*Bt,p=(o.y*h-c.canonical.y)*Bt;return{min:new _t(((d.x-c.wrap)*h-c.canonical.x)*Bt,(d.y*h-c.canonical.y)*Bt),max:new _t(m,p)}}function s6(d,o,c,h,m,p,v){const T=d.indices,M=d.vertices,O=[];for(let w=h;w<h+m;w+=3){const P=o[c[w+0]+p],D=o[c[w+1]+p],I=o[c[w+2]+p],k=Math.min(P.x,D.x,I.x),N=Math.max(P.x,D.x,I.x),W=Math.min(P.y,D.y,I.y),Z=Math.max(P.y,D.y,I.y);O.length=0,d.grid.query(new _t(k,W),new _t(N,Z),O);for(let ee=0;ee<O.length;ee++){const Q=O[ee];if(dt(M[T[3*Q+0]],M[T[3*Q+1]],M[T[3*Q+2]],P,D,I,v))return!0}}return!1}function l6(d,o,c,h){if(!d||!c)return!1;let m=d.vertices;if(!o.canonical.equals(h.canonical)||o.wrap!==h.wrap){if(c.vertices.length<d.vertices.length)return l6(c,h,d,o);const p=o.canonical,v=h.canonical,T=Math.pow(2,v.z-p.z);m=d.vertices.map(M=>new _t((M.x+p.x*Bt)*T-v.x*Bt,(M.y+p.y*Bt)*T-v.y*Bt))}return s6(c,m,d.indices,0,d.indices.length,0,0)}function c6(d,o,c,h){const m=Math.pow(2,h.z-c.z);return new _t((d+c.x*Bt)*m-h.x*Bt,(o+c.y*Bt)*m-h.y*Bt)}function u6(d,o){const c=[];o.grid.queryPoint(d,c);const h=o.indices,m=o.vertices;for(let p=0;p<c.length;p++){const v=c[p];if(Ce([m[h[3*v+0]],m[h[3*v+1]],m[h[3*v+2]]],d))return!0}return!1}const ID=[new _t(0,0),new _t(Bt,0),new _t(Bt,Bt),new _t(0,Bt)];function d6(d,o){const c=[];let h=[];if(!o||d.length<2)return[d];if(d.length===2)return Ne(d[0],d[1],ID)?[d]:[];for(let m=0;m<d.length+2;m++){const p=d[m%d.length],v=d[(m+1)%d.length],T=Ne(m===0?d[d.length-1]:d[(m-1)%d.length],p,ID),M=Ne(p,v,ID),O=T||M;O&&h.push(p),O&&M||h.length>0&&(h.length>1&&c.push(h),h=[])}return h.length>1&&c.push(h),c}const OD=Vf.VectorTileFeature.types,xce=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],bce=["fill-extrusion-flood-light-ground-radius"],wce=Math.pow(2,13),Sce=Math.pow(2,15)-1,h6=new _t(0,1),Wf=2147483648;function T1(d,o,c,h,m,p,v,T){d.emplaceBack((o<<1)+v,(c<<1)+p,(Math.floor(h*wce)<<1)+m,Math.round(T))}function E1(d,o,c){d.emplaceBack(o.x*Bt,o.y*Bt,c?1:0)}function H2(d,o,c,h,m,p){d.emplaceBack(o.x,o.y,(c.x<<1)+h,(c.y<<1)+m,p)}function A1(d,o,c){d.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class f6{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class p6{constructor(){this.centroidXY=new _t(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new _t(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new _t(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new _t(this.max.x-this.min.x,this.max.y-this.min.y)}}class m6{constructor(){this.acc=new _t(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,c){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=c.x,o.min.y=o.max.y=c.y)}appendEdge(o,c,h){this.accCount++,this.acc._add(c);let m=!!this.borders;c.x<o.min.x?(o.min.x=c.x,m=!0):c.x>o.max.x&&(o.max.x=c.x,m=!0),c.y<o.min.y?(o.min.y=c.y,m=!0):c.y>o.max.y&&(o.max.y=c.y,m=!0),((c.x===0||c.x===Bt)&&c.x===h.x)!=((c.y===0||c.y===Bt)&&c.y===h.y)&&this.processBorderOverlap(c,h),m&&this.checkBorderIntersection(c,h)}checkBorderIntersection(o,c){c.x<0!=o.x<0&&this.addBorderIntersection(0,_r(c.y,o.y,(0-c.x)/(o.x-c.x))),c.x>Bt!=o.x>Bt&&this.addBorderIntersection(1,_r(c.y,o.y,(Bt-c.x)/(o.x-c.x))),c.y<0!=o.y<0&&this.addBorderIntersection(2,_r(c.x,o.x,(0-c.y)/(o.y-c.y))),c.y>Bt!=o.y>Bt&&this.addBorderIntersection(3,_r(c.x,o.x,(Bt-c.y)/(o.y-c.y)))}addBorderIntersection(o,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[o];c<h[0]&&(h[0]=c),c>h[1]&&(h[1]=c)}processBorderOverlap(o,c){if(o.x===c.x){if(o.y===c.y)return;const h=o.x===0?0:1;this.addBorderIntersection(h,c.y),this.addBorderIntersection(h,o.y)}else{const h=o.y===0?2:3;this.addBorderIntersection(h,c.x),this.addBorderIntersection(h,o.x)}}centroid(){return this.accCount===0?new _t(0,0):new _t(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,c)=>o+ +(c[0]!==Number.MAX_VALUE),0):0}}function g6(d,o){const c=d.add(o)._unit(),h=Kt(d.x*c.x+d.y*c.y,-1,1);var m,p,v;return v=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(v)))/4*Sce*((m=d).x*(p=o).y-m.y*p.x<0?-1:1)}const Tce=[d=>d.x<0,d=>d.x>Bt,d=>d.y<0,d=>d.y>Bt];function Ece(d,o,c,h){const m=[4];if(h===0)return m;c._mult(h);const p=d.sub(c),v=o.sub(c),T=[d,o,p,v];for(let M=0;M<4;M++)for(const O of T)if(Tce[M](O)){m.push(M);break}return m}class y6{constructor(o){this.vertexArray=new Us,this.indexArray=new Bo,this.programConfigurations=new Ju(o.layers,{zoom:o.zoom,lut:o.lut},c=>bce.includes(c)),this._segments=new si,this.hiddenByLandmarkVertexArray=new l1,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new si}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,c,h,m=!1){const p=o.length;if(p>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*p,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let M;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const O=o[0],w=o[1];M=g6(O.sub(o[p-1])._perp()._unit(),w.sub(O)._perp()._unit())}for(let O=0;O<p;O++){const w=O===p-1?0:O+1,P=o[O],D=o[w],I=o[w===p-1?0:w+1],k=D.sub(P)._perp()._unit(),N=g6(k,I.sub(D)._perp()._unit()),W=M,Z=N;if(kD(P,D,c)||m&&x6(P,c)&&x6(D,c)){M=N;continue}const ee=T.vertexLength;H2(this.vertexArray,P,D,1,1,W),H2(this.vertexArray,P,D,1,0,W),H2(this.vertexArray,P,D,0,1,Z),H2(this.vertexArray,P,D,0,0,Z),T.vertexLength+=4;const Q=Ece(P,D,k,h);for(const K of Q)this._segmentToGroundQuads[v].push({id:ee,region:K}),this._segmentToRegionTriCounts[v][K]+=2,T.primitiveLength+=2;M=N}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),c=o.length;for(let h=0;h<c;h++)this._segmentToGroundQuads[h].sort((m,p)=>m.region-p.region);for(let h=0;h<c;h++){const m=this._segmentToGroundQuads[h],p=o[h],v=this._segmentToRegionTriCounts[h];v.reduce((M,O)=>M+O,0);let T=0;for(let M=0;M<=4;M++){const O=v[M];if(O!==0){let w=this.regionSegments[M];w||(w=this.regionSegments[M]=new si);const P={vertexOffset:p.vertexOffset,primitiveOffset:p.primitiveOffset+T,vertexLength:p.vertexLength,primitiveLength:O};w.get().push(P)}T+=O}for(let M=0;M<m.length;M++){const O=m[M].id;this.indexArray.emplaceBack(O,O+1,O+3),this.indexArray.emplaceBack(O,O+3,O+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,c,h,m,p,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,c,h,m,p,v)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,fce.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,c,h,m,p,v,T){this.hasData()&&this.programConfigurations.updatePaintArrays(o,c,h,m,p,v,T)}updateHiddenByLandmark(o){if(!this.hasData())return;const c=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;const h=o.flags&Wf?1:0;for(let m=o.groundVertexArrayOffset;m<c;++m)this.hiddenByLandmarkVertexArray.emplace(m,h);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,gce.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const c=this.regionSegments[o];c&&c.destroy()}}}}class Z2{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Bo,this.footprintVertices=new Gc,this.footprintSegments=[],this.layoutVertexArray=new qc,this.centroidVertexArray=new ng,this.wallVertexArray=new O2,this.indexArray=new Bo,this.programConfigurations=new Ju(o.layers,{zoom:o.zoom,lut:o.lut},c=>xce.includes(c)),this.segments=new si,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.groundEffect=new y6(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,c){}populate(o,c,h,m){this.features=[],this.hasPattern=_D("fill-extrusion",this.layers,this.pixelRatio,c),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=y(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:p,id:v,index:T,sourceLayerIndex:M}of o){const O=this.layers[0]._featureFilter.needGeometry,w=V(p,O);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),w,h))continue;const P={id:v,sourceLayerIndex:M,index:T,geometry:O?w.geometry:B(p,h,m),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length,I=OD[P.type]==="Polygon";if(this.hasPattern)this.features.push(xD("fill-extrusion",this.layers,P,this.zoom,this.pixelRatio,c));else if(this.wallMode)for(const k of P.geometry)for(const N of d6(k,I))this.addFeature(P,[N],T,h,{},c.availableImages,m,c.brightness);else this.addFeature(P,P.geometry,T,h,{},c.availableImages,m,c.brightness);c.featureIndex.insert(p,P.geometry,T,M,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,c,h,m,p,v){for(const T of this.features){const M=OD[T.type]==="Polygon",{geometry:O}=T;if(this.wallMode)for(const w of O)for(const P of d6(w,M))this.addFeature(T,[P],T.index,c,h,m,p,v);else this.addFeature(T,O,T.index,c,h,m,p,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,c,h,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,h,m,v,T),this.groundEffect.update(o,c,p,h,m,v,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,vce),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,mce.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,yce.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,pce.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,h,m,p,v,T,M){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,w=[new _t(0,0),new _t(Bt,Bt)],P=T.projection,D=P.name==="globe",I=this.wallMode||OD[o.type]==="Polygon",k=new m6;k.centroidDataIndex=this.centroidData.length;const N=new p6,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},m)<=0,Z=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},m);let ee;if(N.height=Z,N.vertexArrayOffset=this.layoutVertexArray.length,N.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Cv),this.wallMode){if(D)return void pi("Non zero fill-extrusion-line-width is not yet supported on globe.");if(c.length!==1)return;ee=function(xe){const ke=xe[0].x===xe[xe.length-1].x&&xe[0].y===xe[xe.length-1].y;(function(Ft){let It=0;const yr=Ft.length;for(let Zt=0;Zt<yr;Zt++)It+=(Ft[(Zt+1)%yr].x-Ft[Zt].x)*(Ft[(Zt+1)%yr].y+Ft[Zt].y);return It>=0})(xe)||(xe=xe.reverse());const De={geometry:[],joinNormals:[],indices:[]},Ve=[],Fe=[],Ze=[];let He=xe.length;for(;He>=2&&xe[He-1].equals(xe[He-2]);)He--;if(He<(ke?3:2))return De;let tt,Ke,nt,Ct,At,Qt=0;for(;Qt<He-1&&xe[Qt].equals(xe[Qt+1]);)Qt++;ke&&(tt=xe[He-2],At=xe[Qt].sub(tt)._unit()._perp());for(let Ft=Qt;Ft<He;Ft++){if(nt=Ft===He-1?ke?xe[Qt+1]:void 0:xe[Ft+1],nt&&xe[Ft].equals(nt))continue;At&&(Ct=At),tt&&(Ke=tt),tt=xe[Ft],At=nt?nt.sub(tt)._unit()._perp():Ct,Ct=Ct||At;let It=Ct.add(At);It.x===0&&It.y===0||It._unit();const yr=It.x*At.x+It.y*At.y,Zt=yr!==0?1/yr:1/0,nr=Ct.x*At.y-Ct.y*At.x>0;let Er="miter";const Vr=2;Er==="miter"&&Zt>Vr&&(Er="bevel"),Er==="bevel"&&(Zt>100&&(Er="flipbevel"),Zt<Vr&&(Er="miter"));const Cr=(Yr,Ur,Qr,un)=>{const Un=new _t(Yr.x,Yr.y),Ar=new _t(Yr.x,Yr.y);Un.x+=Ur.x*un,Un.y+=Ur.y*un,Ar.x-=Ur.x*Math.max(Qr,1),Ar.y-=Ur.y*Math.max(Qr,1),Ze.push(Ur),Ve.push(Un),Fe.push(Ar)};if(Er==="miter")It._mult(Zt),Cr(tt,It,0,0);else if(Er==="flipbevel")It=At.mult(-1),Cr(tt,It,0,0),Cr(tt,It.mult(-1),0,0);else{const Yr=-Math.sqrt(Zt*Zt-1),Ur=nr?Yr:0,Qr=nr?0:Yr;Ke&&Cr(tt,Ct,Ur,Qr),nt&&Cr(tt,At,Ur,Qr)}}De.geometry=[...Ve,...Fe.reverse(),Ve[0]],De.joinNormals=[...Ze,...Ze.reverse(),Ze[Ze.length-1]];const Rt=De.geometry.length-1;for(let Ft=0;Ft<Rt/2;Ft++)if(Ft+1<Rt/2){let It=Ft,yr=Ft+1,Zt=Rt-1-Ft,nr=Rt-2-Ft;It=It===0?Rt-1:It-1,yr=yr===0?Rt-1:yr-1,Zt=Zt===0?Rt-1:Zt-1,nr=nr===0?Rt-1:nr-1,De.indices.push(Zt),De.indices.push(yr),De.indices.push(It),De.indices.push(Zt),De.indices.push(nr),De.indices.push(yr)}return De}(c[0]),c=[ee.geometry]}const Q=(xe,ke)=>xe<(ke.length-1)/2||xe===ke.length-1,K=this.wallMode?[c]:U2(c,500);for(let xe=K.length-1;xe>=0;xe--){const ke=K[xe];(ke.length===0||(ie=ke[0]).every(Se=>Se.x<=0)||ie.every(Se=>Se.x>=Bt)||ie.every(Se=>Se.y<=0)||ie.every(Se=>Se.y>=Bt))&&K.splice(xe,1)}var ie;let se;if(D)se=T6(K,w,m);else{se=[];for(const xe of K)se.push({polygon:xe,bounds:w})}const de=I?this.edgeRadius:0,we=de>0&&this.zoom<17,_e=(xe,ke)=>{if(xe.length===0)return!1;const Se=xe[xe.length-1];return ke.x===Se.x&&ke.y===Se.y};for(const{polygon:xe,bounds:ke}of se){let Se=0,De=0;for(const He of xe)I&&!He[0].equals(He[He.length-1])&&He.push(He[0]),De+=I?He.length-1:He.length;const Ve=this.segments.prepareSegment((I?5:4)*De,this.layoutVertexArray,this.indexArray);N.footprintSegIdx<0&&(N.footprintSegIdx=this.footprintSegments.length),N.polygonSegIdx<0&&(N.polygonSegIdx=this.polygonSegments.length);const Fe={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ze=new f6;if(Ze.vertexOffset=this.footprintVertices.length,Ze.indexOffset=3*this.footprintIndices.length,Ze.ringIndices=[],I){const He=[],tt=[];Se=Ve.vertexLength;for(let nt=0;nt<xe.length;nt++){const Ct=xe[nt];Ct.length&&nt!==0&&tt.push(He.length/2);const At=[];let Qt,Rt;Qt=Ct[1].sub(Ct[0])._perp()._unit(),Ze.ringIndices.push(Ct.length-1);for(let Ft=1;Ft<Ct.length;Ft++){const It=Ct[Ft],yr=Ct[Ft===Ct.length-1?1:Ft+1],Zt=It.clone();if(de){Rt=yr.sub(It)._perp()._unit();const nr=Qt.add(Rt)._unit(),Er=de*Math.min(4,1/(Qt.x*nr.x+Qt.y*nr.y));Zt.x+=Er*nr.x,Zt.y+=Er*nr.y,Zt.x=Math.round(Zt.x),Zt.y=Math.round(Zt.y),Qt=Rt}if(!W||de!==0&&!we||_e(At,Zt)||At.push(Zt),T1(this.layoutVertexArray,Zt.x,Zt.y,0,0,1,1,0),this.wallMode){const nr=Q(Ft,Ct);E1(this.wallVertexArray,ee.joinNormals[Ft],!nr)}Ve.vertexLength++,this.footprintVertices.emplaceBack(It.x,It.y),He.push(It.x,It.y),D&&A1(this.layoutVertexExtArray,P.projectTilePoint(Zt.x,Zt.y,m),P.upVector(m,Zt.x,Zt.y))}W&&(de===0||we)&&(At.length!==0&&_e(At,At[0])&&At.pop(),this.groundEffect.addData(At,ke,O))}const Ke=this.wallMode?ee.indices:x1(He,tt);for(let nt=0;nt<Ke.length;nt+=3)this.footprintIndices.emplaceBack(Ze.vertexOffset+Ke[nt+0],Ze.vertexOffset+Ke[nt+1],Ze.vertexOffset+Ke[nt+2]),this.indexArray.emplaceBack(Se+Ke[nt],Se+Ke[nt+2],Se+Ke[nt+1]),Ve.primitiveLength++;Ze.indexCount+=Ke.length,Ze.vertexCount+=this.footprintVertices.length-Ze.vertexOffset}for(let He=0;He<xe.length;He++){const tt=xe[He];k.startRing(N,tt[0]);let Ke=tt.length>4&&b6(tt[tt.length-2],tt[0],tt[1]),nt=de?Ace(tt[tt.length-2],tt[0],tt[1],de):0;const Ct=[];let At,Qt,Rt;Qt=tt[1].sub(tt[0])._perp()._unit();let Ft=!0;for(let It=1,yr=0;It<tt.length;It++){let Zt=tt[It-1],nr=tt[It];const Er=tt[It===tt.length-1?1:It+1];if(k.appendEdge(N,nr,Zt),kD(nr,Zt,ke)){de&&(Qt=Er.sub(nr)._perp()._unit(),Ft=!Ft);continue}const Vr=nr.sub(Zt)._perp(),Cr=Vr.x/(Math.abs(Vr.x)+Math.abs(Vr.y)),Yr=Vr.y>0?1:0,Ur=Zt.dist(nr);if(yr+Ur>32768&&(yr=0),de){Rt=Er.sub(nr)._perp()._unit();let Ar=_6(Zt,nr,Er,v6(Qt,Rt),de);isNaN(Ar)&&(Ar=0);const an=nr.sub(Zt)._unit();Zt=Zt.add(an.mult(nt))._round(),nr=nr.add(an.mult(-Ar))._round(),nt=Ar,Qt=Rt,W&&this.zoom>=17&&(_e(Ct,Zt)||Ct.push(Zt),_e(Ct,nr)||Ct.push(nr))}const Qr=Ve.vertexLength,un=tt.length>4&&b6(Zt,nr,Er);let Un=w6(yr,Ke,Ft);if(T1(this.layoutVertexArray,Zt.x,Zt.y,Cr,Yr,0,0,Un),T1(this.layoutVertexArray,Zt.x,Zt.y,Cr,Yr,0,1,Un),this.wallMode){const Ar=Q(It-1,tt),an=ee.joinNormals[It-1];E1(this.wallVertexArray,an,Ar),E1(this.wallVertexArray,an,Ar)}if(yr+=Ur,Un=w6(yr,un,!Ft),Ke=un,T1(this.layoutVertexArray,nr.x,nr.y,Cr,Yr,0,0,Un),T1(this.layoutVertexArray,nr.x,nr.y,Cr,Yr,0,1,Un),this.wallMode){const Ar=Q(It,tt),an=ee.joinNormals[It];E1(this.wallVertexArray,an,Ar),E1(this.wallVertexArray,an,Ar)}if(Ve.vertexLength+=4,this.indexArray.emplaceBack(Qr+0,Qr+1,Qr+2),this.indexArray.emplaceBack(Qr+1,Qr+3,Qr+2),Ve.primitiveLength+=2,de){const Ar=Se+(It===1?tt.length-2:It-2),an=It===1?Se:Ar+1;if(this.indexArray.emplaceBack(Qr+1,Ar,Qr+3),this.indexArray.emplaceBack(Ar,an,Qr+3),Ve.primitiveLength+=2,At===void 0&&(At=Qr),!kD(Er,tt[It],ke)){const ri=It===tt.length-1?At:Ve.vertexLength;this.indexArray.emplaceBack(Qr+2,Qr+3,ri),this.indexArray.emplaceBack(Qr+3,ri+1,ri),this.indexArray.emplaceBack(Qr+3,an,ri+1),Ve.primitiveLength+=3}Ft=!Ft}if(D){const Ar=this.layoutVertexExtArray,an=P.projectTilePoint(Zt.x,Zt.y,m),ri=P.projectTilePoint(nr.x,nr.y,m),gi=P.upVector(m,Zt.x,Zt.y),wi=P.upVector(m,nr.x,nr.y);A1(Ar,an,gi),A1(Ar,an,gi),A1(Ar,ri,wi),A1(Ar,ri,wi)}}I&&(Se+=tt.length-1),W&&de&&this.zoom>=17&&(Ct.length!==0&&_e(Ct,Ct[0])&&Ct.pop(),this.groundEffect.addData(Ct,ke,O,de>0))}this.footprintSegments.push(Ze),Fe.triangleCount=this.indexArray.length-Fe.triangleArrayOffset,this.polygonSegments.push(Fe),++N.footprintSegLen,++N.polygonSegLen}if(N.vertexCount=this.layoutVertexArray.length-N.vertexArrayOffset,N.groundVertexCount=this.groundEffect.vertexArray.length-N.groundVertexArrayOffset,N.vertexCount!==0){if(N.centroidXY=k.borders?h6:this.encodeCentroid(k,N),this.centroidData.push(N),k.borders){this.featuresOnBorder.push(k);const xe=this.featuresOnBorder.length-1;for(let ke=0;ke<k.borders.length;ke++)k.borders[ke][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ke].push(xe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,p,v,m,M),this.groundEffect.addPaintPropertiesData(o,h,p,v,m,M),this.maxHeight=Math.max(this.maxHeight,Z)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((c,h)=>this.featuresOnBorder[c].borders[o][0]-this.featuresOnBorder[h].borders[o][0])}splitToSubtiles(){const o=[];for(let T=0;T<this.centroidData.length;T++){const M=this.centroidData[T],O=+(M.min.y+M.max.y>Bt),w=2*O+(+(M.min.x+M.max.x>Bt)^O);for(let P=0;P<M.polygonSegLen;P++){const D=M.polygonSegIdx+P;o.push({centroidIdx:T,subtile:w,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const c=new Bo;o.sort((T,M)=>T.triangleSegmentIdx===M.triangleSegmentIdx?T.subtile-M.subtile:T.triangleSegmentIdx-M.triangleSegmentIdx);let h=0,m=0,p=0;for(const T of o){if(T.triangleSegmentIdx!==h)break;p++}const v=o.length;for(;m!==o.length;){h=o[m].triangleSegmentIdx;let T=0,M=m,O=m;for(let w=M;w<p&&o[w].subtile===T;w++)O++;for(;M!==p;){const w=o[M];T=w.subtile;const P=this.centroidData[w.centroidIdx].min.clone(),D=this.centroidData[w.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:c.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let k=M;k<O;k++){const N=o[k],W=this.polygonSegments[N.polygonSegmentIdx],Z=this.centroidData[N.centroidIdx].min,ee=this.centroidData[N.centroidIdx].max,Q=this.indexArray.uint16;for(let K=W.triangleArrayOffset;K<W.triangleArrayOffset+W.triangleCount;K++)c.emplaceBack(Q[3*K],Q[3*K+1],Q[3*K+2]);I.primitiveLength+=W.triangleCount,P.x=Math.min(P.x,Z.x),P.y=Math.min(P.y,Z.y),D.x=Math.max(D.x,ee.x),D.y=Math.max(D.y,ee.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:P,max:D}),M=O;for(let k=M;k<p&&o[k].subtile===o[M].subtile;k++)O++}m=p;for(let w=m;w<v&&o[w].triangleSegmentIdx===o[m].triangleSegmentIdx;w++)p++}c._trim(),this.indexArray=c}getVisibleSegments(o,c,h){const m=new si;if(this.wallMode){for(const N of this.triangleSubSegments)m.segments.push(N.segment);return m}let p=0,v=0;const T=1<<o.canonical.z;if(c){const N=c.getMinMaxForTile(o);N&&(p=N.min,v=N.max)}v+=this.maxHeight;const M=o.toUnwrapped();let O;const w=[M.canonical.x/T+M.wrap,M.canonical.y/T],P=[(M.canonical.x+1)/T+M.wrap,(M.canonical.y+1)/T],D=(N,W,Z)=>[N[0]*(1-Z[0])+W[0]*Z[0],N[1]*(1-Z[1])+W[1]*Z[1]],I=[],k=[];for(const N of this.triangleSubSegments){I[0]=N.min.x/Bt,I[1]=N.min.y/Bt,k[0]=N.max.x/Bt,k[1]=N.max.y/Bt;const W=D(w,P,I),Z=D(w,P,k);if(new or([W[0],W[1],p],[Z[0],Z[1],v]).intersectsPrecise(h)===0){O&&(m.segments.push(O),O=void 0);continue}const ee=N.segment;O&&O.vertexOffset!==ee.vertexOffset&&(m.segments.push(O),O=void 0),O?(O.vertexLength+=ee.vertexLength,O.primitiveLength+=ee.primitiveLength):O={vertexOffset:ee.vertexOffset,primitiveLength:ee.primitiveLength,vertexLength:ee.vertexLength,primitiveOffset:ee.primitiveOffset,sortKey:void 0,vaos:{}}}return O&&m.segments.push(O),m}encodeCentroid(o,c){const h=o.centroid(),m=c.span(),p=Math.min(7,Math.round(m.x*this.tileToMeter/10)),v=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new _t(Kt(h.x,1,Bt-1)<<3|p,Kt(h.y,1,Bt-1)<<3|v)}encodeBorderCentroid(o){if(!o.borders)return new _t(0,0);const c=o.borders,h=Number.MAX_VALUE;if(c[0][0]!==h||c[1][0]!==h){const m=c[0][0]!==h?0:1;return new _t(6|(c[0][0]!==h?0:65528),(c[m][0]+c[m][1])/2<<3|6)}{const m=c[2][0]!==h?2:3;return new _t((c[m][0]+c[m][1])/2<<3|6,6|(c[2][0]!==h?0:65528))}}showCentroid(o){const c=this.centroidData[o.centroidDataIndex];c.flags&=Wf,c.centroidXY.x=0,c.centroidXY.y=0,this.writeCentroidToBuffer(c)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const c=o.vertexArrayOffset,h=o.vertexCount+o.vertexArrayOffset,m=o.flags&Wf?h6:o.centroidXY,p=this.centroidVertexArray.geta_centroid_pos0(c);if(this.centroidVertexArray.geta_centroid_pos1(c)!==m.y||p!==m.x){for(let v=c;v<h;++v)this.centroidVertexArray.emplace(v,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,c,h){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const m=c.getReplacementRegionsForTile(o.toUnwrapped());if(PD(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const p=[];for(const v of this.activeReplacements){if(v.order<h)continue;const T=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-o.canonical.z));for(const M of this.centroidData)if(!(M.flags&Wf||v.min.x>M.max.x||M.min.x>v.max.x||v.min.y>M.max.y||M.min.y>v.max.y))for(let O=0;O<M.footprintSegLen;O++){const w=this.footprintSegments[M.footprintSegIdx+O];if(p.length=0,Mce(this.footprintVertices,w.vertexOffset,w.vertexCount,v.footprintTileId.canonical,o.canonical,p),s6(v.footprint,p,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-T)){M.flags|=Wf;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,c,h){let m=!1;for(let p=0;p<h.footprintSegLen;p++){const v=this.footprintSegments[h.footprintSegIdx+p];let T=0;for(const M of v.ringIndices){for(let O=T,w=M+T-1;O<M+T;w=O++){const P=this.footprintVertices.int16[2*(O+v.vertexOffset)+0],D=this.footprintVertices.int16[2*(O+v.vertexOffset)+1],I=this.footprintVertices.int16[2*(w+v.vertexOffset)+1];D>c!=I>c&&o<(this.footprintVertices.int16[2*(w+v.vertexOffset)+0]-P)*(c-D)/(I-D)+P&&(m=!m)}T=M}}return m}getHeightAtTileCoord(o,c){let h=Number.NEGATIVE_INFINITY,m=!0;const p=4*(o+Bt)*Bt+(c+Bt);if(this.partLookup.hasOwnProperty(p)){const v=this.partLookup[p];return v?{height:v.height,hidden:!!(v.flags&Wf)}:void 0}for(const v of this.centroidData)o>v.max.x||v.min.x>o||c>v.max.y||v.min.y>c||this.footprintContainsPoint(o,c,v)&&v&&v.height>h&&(h=v.height,this.partLookup[p]=v,m=!!(v.flags&Wf));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:m};this.partLookup[p]=void 0}}function v6(d,o){const c=d.add(o)._unit();return d.x*c.x+d.y*c.y}function Ace(d,o,c,h){const m=o.sub(d)._perp()._unit(),p=c.sub(o)._perp()._unit();return _6(d,o,c,v6(m,p),h)}function _6(d,o,c,h,m){const p=Math.sqrt(1-h*h);return Math.min(d.dist(o)/3,o.dist(c)/3,m*p/h)}function kD(d,o,c){return d.x<c[0].x&&o.x<c[0].x||d.x>c[1].x&&o.x>c[1].x||d.y<c[0].y&&o.y<c[0].y||d.y>c[1].y&&o.y>c[1].y}function x6(d,o){return d.x<o[0].x||d.x>o[1].x||d.y<o[0].y||d.y>o[1].y}function b6(d,o,c){if(d.x<0||d.x>=Bt||o.x<0||o.x>=Bt||c.x<0||c.x>=Bt)return!1;const h=c.sub(o),m=h.perp(),p=d.sub(o);return(h.x*p.x+h.y*p.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(p.x*p.x+p.y*p.y))>-.866&&m.x*p.x+m.y*p.y<0}function w6(d,o,c){const h=o?2|d:-3&d;return c?1|h:-2&h}function S6(){const d=Math.PI/32,o=Math.tan(d),c=nh;return c*Math.sqrt(1+2*o*o)-c}function T6(d,o,c){const h=1<<c.z,m=qa(c.x/h),p=qa((c.x+1)/h),v=$o(c.y/h),T=$o((c.y+1)/h);return function(M,O,w,P,D=0,I){const k=[];if(!M.length||!w||!P)return k;const N=(se,de)=>{for(const we of se)k.push({polygon:we,bounds:de})},W=Math.ceil(Math.log2(w)),Z=Math.ceil(Math.log2(P)),ee=W-Z,Q=[];for(let se=0;se<Math.abs(ee);se++)Q.push(ee>0?0:1);for(let se=0;se<Math.min(W,Z);se++)Q.push(0),Q.push(1);let K=M;if(K=W2(K,O[0].y-D,O[1].y+D,1),K=W2(K,O[0].x-D,O[1].x+D,0),!K.length)return k;const ie=[];for(Q.length?ie.push({polygons:K,bounds:O,depth:0}):N(K,O);ie.length;){const se=ie.pop(),de=se.depth,we=Q[de],_e=se.bounds[0],xe=se.bounds[1],ke=we===0?_e.x:_e.y,Se=we===0?xe.x:xe.y,De=I?I(we,ke,Se):.5*(ke+Se),Ve=W2(se.polygons,ke-D,De+D,we),Fe=W2(se.polygons,De-D,Se+D,we);if(Ve.length){const Ze=[_e,new _t(we===0?De:xe.x,we===1?De:xe.y)];Q.length>de+1?ie.push({polygons:Ve,bounds:Ze,depth:de+1}):N(Ve,Ze)}if(Fe.length){const Ze=[new _t(we===0?De:_e.x,we===1?De:_e.y),xe];Q.length>de+1?ie.push({polygons:Fe,bounds:Ze,depth:de+1}):N(Fe,Ze)}}return k}(d,o,Math.ceil((p-m)/11.25),Math.ceil((v-T)/11.25),1,(M,O,w)=>{if(M===0)return .5*(O+w);{const P=$o((c.y+O/Bt)/h);return(Ga(.5*($o((c.y+w/Bt)/h)+P))*h-c.y)*Bt}})}function Mce(d,o,c,h,m,p){const v=Math.pow(2,h.z-m.z);for(let T=0;T<c;T++){let M=d.int16[2*(T+o)+0],O=d.int16[2*(T+o)+1];M=(M+m.x*Bt)*v-h.x*Bt,O=(O+m.y*Bt)*v-h.y*Bt,p.push(new _t(M,O))}}let E6,A6;function M1(d,o){return d.x*o.x+d.y*o.y}function M6(d,o){if(d.length===1){let c=0;const h=o[c++];let m;for(;!m||h.equals(m);)if(m=o[c++],!m)return 1/0;for(;c<o.length;c++){const p=o[c],v=d[0],T=m.sub(h),M=p.sub(h),O=v.sub(h),w=M1(T,T),P=M1(T,M),D=M1(M,M),I=M1(O,T),k=M1(O,M),N=w*D-P*P,W=(D*I-P*k)/N,Z=(w*k-P*I)/N,ee=h.z*(1-W-Z)+m.z*W+p.z*Z;if(isFinite(ee))return ee}return 1/0}{let c=1/0;for(const h of o)c=Math.min(c,h.z);return c}}function C6(d,o,c,h,m,p,v,T){const M=v*m.getElevationAt(d,o,!0,!0),O=p[0]!==0,w=O?p[1]===0?v*(p[0]/7-450):v*function(P,D,I){const k=Math.floor(D[0]/8),N=Math.floor(D[1]/8),W=10*(D[0]-8*k),Z=10*(D[1]-8*N),ee=P.getElevationAt(k,N,!0,!0),Q=P.getMeterToDEM(I),K=Math.floor(.5*(W*Q-1)),ie=Math.floor(.5*(Z*Q-1)),se=P.tileCoordToPixel(k,N),de=2*K+1,we=2*ie+1,_e=function(Fe,Ze,He,tt,Ke){return[Fe.getElevationAtPixel(Ze,He,!0),Fe.getElevationAtPixel(Ze+Ke,He,!0),Fe.getElevationAtPixel(Ze,He+Ke,!0),Fe.getElevationAtPixel(Ze+tt,He+Ke,!0)]}(P,se.x-K,se.y-ie,de,we),xe=Math.abs(_e[0]-_e[1]),ke=Math.abs(_e[2]-_e[3]),Se=Math.abs(_e[0]-_e[2])+Math.abs(_e[1]-_e[3]),De=Math.min(.25,.5*Q*(xe+ke)/de),Ve=Math.min(.25,.5*Q*Se/we);return ee+Math.max(De*W,Ve*Z)}(m,p,T):M;return{base:M+(c===0?-1:c),top:O?Math.max(w+h,M+c+2):M+h}}Jt(Z2,"FillExtrusionBucket",{omit:["layers","features"]}),Jt(p6,"PartData"),Jt(f6,"FootprintSegment"),Jt(m6,"BorderCentroidData"),Jt(y6,"GroundEffect");const Cce=mn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Pce=mn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Ice}=Cce,Oce=mn([{name:"a_packed",components:3,type:"Float32"}]),{members:kce}=Oce,Rce=mn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Dce}=Rce;class P6{constructor(o,c){this.width=o,this.height=c,this.nextRow=0,this.image=new Uf({width:o,height:c}),this.positions={},this.uploaded=!1}getDash(o,c){const h=this.getKey(o,c);return this.positions[h]}trim(){const o=this.width,c=this.height=yl(this.nextRow);this.image.resize({width:o,height:c})}getKey(o,c){return o.join(",")+c}getDashRanges(o,c,h){const m=[];let p=o.length%2==1?-o[o.length-1]*h:0,v=o[0]*h,T=!0;m.push({left:p,right:v,isDash:T,zeroLength:o[0]===0});let M=o[0];for(let O=1;O<o.length;O++){T=!T;const w=o[O];p=M*h,M+=w,v=M*h,m.push({left:p,right:v,isDash:T,zeroLength:w===0})}return m}addRoundDash(o,c,h){const m=c/2;for(let p=-h;p<=h;p++){const v=this.width*(this.nextRow+h+p);let T=0,M=o[T];for(let O=0;O<this.width;O++){O/M.right>1&&(M=o[++T]);const w=Math.abs(O-M.left),P=Math.abs(O-M.right),D=Math.min(w,P);let I;const k=p/h*(m+1);if(M.isDash){const N=m-Math.abs(k);I=Math.sqrt(D*D+N*N)}else I=m-Math.sqrt(D*D+k*k);this.image.data[v+O]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(o,c){for(let M=o.length-1;M>=0;--M){const O=o[M],w=o[M+1];O.zeroLength?o.splice(M,1):w&&w.isDash===O.isDash&&(w.left=O.left,o.splice(M,1))}const h=o[0],m=o[o.length-1];h.isDash===m.isDash&&(h.left=m.left-this.width,m.right=h.right+this.width);const p=this.width*this.nextRow;let v=0,T=o[v];for(let M=0;M<this.width;M++){M/T.right>1&&(T=o[++v]);const O=Math.abs(M-T.left),w=Math.abs(M-T.right),P=Math.min(O,w);this.image.data[p+M]=Math.max(0,Math.min(255,(T.isDash?P:-P)+c+128))}}addDash(o,c){const h=this.getKey(o,c);if(this.positions[h])return this.positions[h];const m=c==="round",p=m?7:0,v=2*p+1;if(this.nextRow+v>this.height)return pi("LineAtlas out of space"),null;o.length===0&&o.push(1);let T=0;for(let w=0;w<o.length;w++)o[w]<0&&(pi("Negative value is found in line dasharray, replacing values with 0"),o[w]=0),T+=o[w];if(T!==0){const w=this.width/T,P=this.getDashRanges(o,this.width,w);m?this.addRoundDash(P,w,p):this.addRegularDash(P,c==="square"?.5*w:0)}const M=this.nextRow+p;this.nextRow+=v;const O={tl:[M,p],br:[T,0]};return this.positions[h]=O,O}}Jt(P6,"LineAtlas");const Lce=Vf.VectorTileFeature.types,Nce=Math.cos(Math.PI/180*37.5),zce=Math.cos(Math.PI/180*5);class RD{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Qb,this.layoutVertexArray2=new Tl,this.patternVertexArray=new Tl,this.indexArray=new Bo,this.programConfigurations=new Ju(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new si,this.maxLineLength=0,this.zOffsetVertexArray=new Tl,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:Bt/64}updateFootprints(o,c){}populate(o,c,h,m){this.hasPattern=_D("line",this.layers,this.pixelRatio,c);const p=this.layers[0].layout.get("line-sort-key");this.tileToMeter=y(h);const v=this.layers[0].layout.get("line-z-offset"),T=v.isConstant()&&!v.constantOr(0),M=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=M==="sea"||M==="ground"||!T&&M==="none",this.hasZOffset&&M==="none"&&pi(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const O=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&O!==void 0;const w=[];for(const{feature:k,id:N,index:W,sourceLayerIndex:Z}of o){const ee=this.layers[0]._featureFilter.needGeometry,Q=V(k,ee);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),Q,h))continue;const K=p?p.evaluate(Q,{},h):void 0,ie={id:N,properties:k.properties,type:k.type,sourceLayerIndex:Z,index:W,geometry:ee?Q.geometry:B(k,h,m),patterns:{},sortKey:K};w.push(ie)}p&&w.sort((k,N)=>k.sortKey-N.sortKey);const{lineAtlas:P,featureIndex:D}=c,I=this.addConstantDashes(P);for(const k of w){const{geometry:N,index:W,sourceLayerIndex:Z}=k;if(I&&this.addFeatureDashes(k,P),this.hasPattern){const ee=xD("line",this.layers,k,this.zoom,this.pixelRatio,c);this.patternFeatures.push(ee)}else this.addFeature(k,N,W,h,P.positions,c.availableImages,c.brightness);D.insert(o[W].feature,N,W,Z,this.index)}}addConstantDashes(o){let c=!1;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,p=h.layout.get("line-cap").value;if(m.kind!=="constant"||p.kind!=="constant")c=!0;else{const v=p.value,T=m.value;if(!T)continue;o.addDash(T,v)}}return c}addFeatureDashes(o,c){const h=this.zoom;for(const m of this.layers){const p=m.paint.get("line-dasharray").value,v=m.layout.get("line-cap").value;if(p.kind==="constant"&&v.kind==="constant")continue;let T,M;if(p.kind==="constant"){if(T=p.value,!T)continue}else T=p.evaluate({zoom:h},o);M=v.kind==="constant"?v.value:v.evaluate({zoom:h},o),c.addDash(T,M),o.patterns[m.id]=c.getKey(T,M)}}update(o,c,h,m,p,v,T){this.programConfigurations.updatePaintArrays(o,c,p,h,m,v,T)}addFeatures(o,c,h,m,p,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,c,h,m,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,kce)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,Dce)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Pce.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Ice),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,h,m,p,v,T){const M=this.layers[0].layout,O=M.get("line-join").evaluate(o,{}),w=M.get("line-cap").evaluate(o,{}),P=M.get("line-miter-limit"),D=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=M.get("line-z-offset").value;const I=this.layers[0].paint.get("line-width").value;I.kind!=="constant"&&I.isLineProgressConstant===!1&&(this.variableWidthValue=I);for(const k of c)this.addLine(k,o,m,O,w,P,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,p,v,m,T)}addLine(o,c,h,m,p,v,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const M=m==="none";if(this.patternJoinNone=this.hasPattern&&M,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<o.length-1;Q++)this.totalDistance+=o[Q].dist(o[Q+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=Lce[c.type]==="Polygon";let w=o.length;for(;w>=2&&o[w-1].equals(o[w-2]);)w--;let P=0;for(;P<w-1&&o[P].equals(o[P+1]);)P++;if(w<(O?3:2))return;m==="bevel"&&(v=1.05);const D=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let I,k,N,W,Z,ee;this.e1=this.e2=-1,O&&(I=o[w-2],Z=o[P].sub(I)._unit()._perp());for(let Q=P;Q<w;Q++){if(N=Q===w-1?O?o[P+1]:void 0:o[Q+1],N&&o[Q].equals(N))continue;Z&&(W=Z),I&&(k=I),I=o[Q],ee=this.evaluateLineProgressFeatures(k?k.dist(I):0),Z=N?N.sub(I)._unit()._perp():W,W=W||Z;const K=k&&N;let ie=K?m:O||M?"butt":p;const se=W.x*Z.x+W.y*Z.y;if(M){const Ve=function(Fe){if(Fe.patternJoinNone){const Ze=Fe.segmentPoints.length/2,He=Fe.lineSoFar-Fe.segmentStart;for(let tt=0;tt<Ze;++tt){const Ke=Fe.segmentPoints[2*tt+1],nt=Math.round(Fe.segmentPoints[2*tt])+.5+.25*Ke;Fe.patternVertexArray.emplaceBack(nt,He,Fe.segmentStart),Fe.patternVertexArray.emplaceBack(nt,He,Fe.segmentStart)}Fe.segmentPoints.length=0}Fe.e1=Fe.e2=-1};if(K&&se<zce){this.updateDistance(k,I),this.addCurrentVertex(I,W,1,1,D,ee),Ve(this),this.addCurrentVertex(I,Z,-1,-1,D,ee);continue}if(k){if(!N){this.updateDistance(k,I),this.addCurrentVertex(I,W,1,1,D,ee),Ve(this);continue}ie="miter"}}let de=W.add(Z);de.x===0&&de.y===0||de._unit();const we=de.x*Z.x+de.y*Z.y,_e=we!==0?1/we:1/0,xe=2*Math.sqrt(2-2*we),ke=we<Nce&&k&&N,Se=W.x*Z.y-W.y*Z.x>0,De=this.overscaling<=16?15*Bt/(512*this.overscaling):0;if(K&&ie==="round"){if(_e<T)ie="miter";else if(_e<=2){const Ve=DD(I,-10,Bt+10);ie=this.hasZOffset&&(Ve||this.hasCrossSlope)?"miter":"fakeround"}}if(ie==="miter"&&_e>v&&(ie="bevel"),ie==="bevel"&&(_e>2&&(ie="flipbevel"),_e<v&&(ie="miter")),k&&!(ie==="miter"&&ke)&&this.updateDistance(k,I),ie==="miter")if(ke){const Ve=I.dist(k);if(Ve>2*De){const Ze=I.sub(I.sub(k)._mult(De/Ve)._round());this.updateDistance(k,Ze),this.addCurrentVertex(Ze,W,0,0,D,ee),k=Ze}this.updateDistance(k,I),de._mult(_e),this.addCurrentVertex(I,de,0,0,D,ee);const Fe=I.dist(N);if(Fe>2*De){const Ze=I.add(N.sub(I)._mult(De/Fe)._round());this.updateDistance(I,Ze),this.addCurrentVertex(Ze,Z,0,0,D,ee),I=Ze}}else de._mult(_e),this.addCurrentVertex(I,de,0,0,D,ee);else if(ie==="flipbevel"){if(_e>100)de=Z.mult(-1);else{const Ve=_e*W.add(Z).mag()/W.sub(Z).mag();de._perp()._mult(Ve*(Se?-1:1))}this.addCurrentVertex(I,de,0,0,D,ee),this.addCurrentVertex(I,de.mult(-1),0,0,D,ee)}else if(ie==="bevel"||ie==="fakeround"){ee!=null&&k&&this.addCurrentVertex(I,W,-1,-1,D,ee);const Ve=I.dist(k)<=2*De&&ie!=="bevel",Fe=de.mult(Se?1:-1);Fe._mult(_e);const Ze=Z.mult(Se?-1:1),He=W.mult(Se?-1:1),tt=this.evaluateLineProgressFeatures(this.distance);if(ee==null&&(this.addHalfVertex(I,Fe.x,Fe.y,!1,!Se,0,D,tt),Ve||this.addHalfVertex(I,Fe.x+2*He.x,Fe.y+2*He.y,!1,Se,0,D,tt)),ie==="fakeround"){const Ke=Math.round(180*xe/Math.PI/20);this.addHalfVertex(I,He.x,He.y,!1,Se,0,D,tt);for(let nt=0;nt<Ke;nt++){let Ct=nt/Ke;if(Ct!==.5){const Qt=Ct-.5;Ct+=Ct*Qt*(Ct-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*Qt*Qt+(.848013+se*(.215638*se-1.06021)))}const At=Ze.sub(He)._mult(Ct)._add(He)._unit();this.addHalfVertex(I,At.x,At.y,!1,Se,0,D,tt)}this.addHalfVertex(I,Ze.x,Ze.y,!1,Se,0,D,tt)}Ve||ee!=null||this.addHalfVertex(I,Fe.x+2*Ze.x,Fe.y+2*Ze.y,!1,Se,0,D,tt),ee!=null&&N&&this.addCurrentVertex(I,Z,1,1,D,ee)}else ie==="butt"?this.addCurrentVertex(I,de,0,0,D,ee):ie==="square"?(k||this.addCurrentVertex(I,de,-1,-1,D,ee),this.addCurrentVertex(I,de,0,0,D,ee),k&&this.addCurrentVertex(I,de,1,1,D,ee)):ie==="round"&&(k&&(this.addCurrentVertex(I,W,0,0,D,ee),this.addCurrentVertex(I,W,1,1,D,ee,!0)),N&&(this.addCurrentVertex(I,Z,-1,-1,D,ee,!0),this.addCurrentVertex(I,Z,0,0,D,ee)))}}addVerticesTo(o,c,h,m,p,v,T,M,O,w){const P=(c.w-o.w)/this.tessellationStep|0;let D=0;const I=this.scaledDistance;if(P>1){this.lineSoFar=o.w;const N=(c.x-o.x)/P,W=(c.y-o.y)/P,Z=(c.z-o.z)/P,ee=(c.w-o.w)/P;for(let Q=1;Q<P;++Q){o.x+=N,o.y+=W,o.z+=Z,this.lineSoFar+=ee,D+=ee;const K=this.evaluateLineProgressFeatures(this.prevDistance+D);this.scaledDistance=(this.prevDistance+D)/this.totalDistance,this.addHalfVertex(o,h,m,w,!1,T,O,K),this.addHalfVertex(o,p,v,w,!0,-M,O,K)}}this.lineSoFar=c.w,this.scaledDistance=I;const k=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(c,h,m,w,!1,T,O,k),this.addHalfVertex(c,p,v,w,!0,-M,O,k)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):pi(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let c=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(c=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:c}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:c}:{zOffset:0,variableWidth:c}}addCurrentVertex(o,c,h,m,p,v,T=!1){const M=c.x+c.y*h,O=c.y-c.x*h,w=c.y*m-c.x,P=-c.y-c.x*m;if(v!=null){const D=this.hasZOffset,I=-10,k=Bt+10,N=v.zOffset,W=new t6(o.x,o.y,N,this.lineSoFar),Z=!!D&&DD(o,I,k),ee=this.lineSoFar,Q=this.distance;if(this.currentVertex)if(Z){const K=this.currentVertexIsOutside,ie=this.currentVertex,se=new t6(o.x,o.y,N,this.lineSoFar);if(n6(ie,se,I,k),!DD(se,I,k)){if(K){this.e1=this.e2=-1,this.distance-=ie.dist(W),this.lineSoFar=ie.w;const de=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,M,O,T,!1,h,p,de),this.addHalfVertex(ie,w,P,T,!0,-m,p,de),this.prevDistance=this.distance}this.distance=this.prevDistance+ie.dist(se),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ie,se,M,O,w,P,h,m,p,T),this.distance=Q,this.scaledDistance=this.distance/this.totalDistance}}else{const K=this.currentVertex;if(this.currentVertexIsOutside){n6(K,W,I,k),this.e1=this.e2=-1,this.distance-=K.dist(W),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=K.w;const ie=this.evaluateLineProgressFeatures(K.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(K,M,O,T,!1,h,p,ie),this.addHalfVertex(K,w,P,T,!0,-m,p,ie),this.prevDistance=this.distance,this.distance=Q,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(K,W,M,O,w,P,h,m,p,T)}else Z||(this.addHalfVertex(o,M,O,T,!1,h,p,v),this.addHalfVertex(o,w,P,T,!0,-m,p,v));this.currentVertex=W,this.currentVertexIsOutside=Z,this.lineSoFar=ee}else this.addHalfVertex(o,M,O,T,!1,h,p,v),this.addHalfVertex(o,w,P,T,!0,-m,p,v)}addHalfVertex({x:o,y:c},h,m,p,v,T,M,O){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((o<<1)+(p?1:0),(c<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const P=_r(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,P)}const w=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),M.primitiveLength++),v?this.e2=w:this.e1=w,O!=null&&this.zOffsetVertexArray.emplaceBack(O.zOffset,O.variableWidth,O.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,c){this.prevDistance=this.distance,this.distance+=o.dist(c),this.updateScaledDistance()}}function DD(d,o,c){return d.x<o||d.x>c||d.y<o||d.y>c}let I6,O6;function k6(d,o,c){return o*(Bt/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}Jt(RD,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const R6=(d,o,c)=>(1-c)*d+c*o;function D6(d,o){return 1/k6(d,1,o.tileZoom)}function L6(d,o,c,h){return d.translatePosMatrix(h||o.tileID.projMatrix,o,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const N6=d=>{const o=[];z6(d)&&o.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const c=d.paint.get("line-trim-offset");c[0]===0&&c[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),d.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");const h=d.layout.get("line-join").constantOr("miter")==="none",m=!!d.paint.get("line-pattern").constantOr(1);return h&&m&&o.push("LINE_JOIN_NONE"),o};function z6(d){const o=d.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let LD;const j6=()=>LD||(LD={layout:I6||(I6=new bi({"line-cap":new Yt(it.layout_line["line-cap"]),"line-join":new Yt(it.layout_line["line-join"]),"line-miter-limit":new zt(it.layout_line["line-miter-limit"]),"line-round-limit":new zt(it.layout_line["line-round-limit"]),"line-sort-key":new Yt(it.layout_line["line-sort-key"]),"line-z-offset":new Yt(it.layout_line["line-z-offset"]),"line-elevation-reference":new zt(it.layout_line["line-elevation-reference"]),"line-cross-slope":new zt(it.layout_line["line-cross-slope"]),visibility:new zt(it.layout_line.visibility),"line-width-unit":new zt(it.layout_line["line-width-unit"])})),paint:O6||(O6=new bi({"line-opacity":new Yt(it.paint_line["line-opacity"]),"line-color":new Yt(it.paint_line["line-color"]),"line-translate":new zt(it.paint_line["line-translate"]),"line-translate-anchor":new zt(it.paint_line["line-translate-anchor"]),"line-width":new Yt(it.paint_line["line-width"]),"line-gap-width":new Yt(it.paint_line["line-gap-width"]),"line-offset":new Yt(it.paint_line["line-offset"]),"line-blur":new Yt(it.paint_line["line-blur"]),"line-dasharray":new Yt(it.paint_line["line-dasharray"]),"line-pattern":new Yt(it.paint_line["line-pattern"]),"line-gradient":new kf(it.paint_line["line-gradient"]),"line-trim-offset":new zt(it.paint_line["line-trim-offset"]),"line-trim-fade-range":new zt(it.paint_line["line-trim-fade-range"]),"line-trim-color":new zt(it.paint_line["line-trim-color"]),"line-emissive-strength":new zt(it.paint_line["line-emissive-strength"]),"line-border-width":new Yt(it.paint_line["line-border-width"]),"line-border-color":new Yt(it.paint_line["line-border-color"]),"line-occlusion-opacity":new zt(it.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},LD);class jce extends Yt{possiblyEvaluate(o,c){return c=new $n(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,transition:c.transition}),super.possiblyEvaluate(o,c)}evaluate(o,c,h,m){return c=Pi({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(o,c,h,m)}}let C1;function F6(d,o){return o>0?o+2*d:d}const Fce=mn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bce=mn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),$ce=mn([{name:"a_projected_pos",components:4,type:"Float32"}],4);mn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Uce=mn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Vce=mn([{name:"a_texb",components:2,type:"Uint16"}]),Wce=mn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Gce=mn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);mn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const B6=mn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qce=mn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);mn([{name:"triangle",components:3,type:"Uint16"}]),mn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),mn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),mn([{type:"Float32",name:"offsetX"}]),mn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Jo=24;const Kc=128;function $6(d,o,c,h,m){if(d.kind==="camera")return d.maxSize;if(d.kind==="composite"){const p=o.possiblyEvaluate(new $n(d.maxZoom),c).evaluate(m,{},c),v=o.possiblyEvaluate(new $n(d.minZoom),c).evaluate(m,{},c);return Math.max(p,v)}return o.possiblyEvaluate(new $n(h)).evaluate(m,{},c)}function ND(d,o){const{expression:c}=o;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new $n(d+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=c;let p=0;for(;p<h.length&&h[p]<=d;)p++;p=Math.max(0,p-1);let v=p;for(;v<h.length&&h[v]<d+1;)v++;v=Math.min(h.length-1,v);const T=h[p],M=h[v];return c.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:M,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:M,minSize:c.evaluate(new $n(T)),maxSize:c.evaluate(new $n(M)),interpolationType:m}}}function X2(d,{uSize:o,uSizeT:c},{lowerSize:h,upperSize:m}){return d.kind==="source"?h/Kc:d.kind==="composite"?_r(h/Kc,m/Kc,c):o}function Uv(d,o,c=1){let h=0,m=0;if(d.kind==="constant")m=d.layoutSize*c;else if(d.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:T}=d,M=p?Kt(hs.interpolationFactor(p,o,v,T),0,1):0;d.kind==="camera"?m=_r(d.minSize,d.maxSize,M)*c:h=M*c}return{uSizeT:h,uSize:m}}var Hce=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Kc,evaluateSizeForFeature:X2,evaluateSizeForZoom:Uv,getRasterizedIconSize:$6,getSizeData:ND});function Zce(d,o,c){return d.sections.forEach(h=>{h.text=function(m,p,v){const T=p.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),$s.applyArabicShaping&&(m=$s.applyArabicShaping(m)),m}(h.text,o,c)}),d}const P1={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function Xce(d){return d==="︶"||d==="﹈"||d==="︸"||d==="﹄"||d==="﹂"||d==="︾"||d==="︼"||d==="︺"||d==="︘"||d==="﹀"||d==="︐"||d==="︓"||d==="︔"||d==="｀"||d==="￣"||d==="︑"||d==="︒"}function Yce(d){return d==="︵"||d==="﹇"||d==="︷"||d==="﹃"||d==="﹁"||d==="︽"||d==="︻"||d==="︹"||d==="︗"||d==="︿"}var U6,zD,V6,jD={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Kce(){return U6||(U6=1,jD.read=function(d,o,c,h,m){var p,v,T=8*m-h-1,M=(1<<T)-1,O=M>>1,w=-7,P=c?m-1:0,D=c?-1:1,I=d[o+P];for(P+=D,p=I&(1<<-w)-1,I>>=-w,w+=T;w>0;p=256*p+d[o+P],P+=D,w-=8);for(v=p&(1<<-w)-1,p>>=-w,w+=h;w>0;v=256*v+d[o+P],P+=D,w-=8);if(p===0)p=1-O;else{if(p===M)return v?NaN:1/0*(I?-1:1);v+=Math.pow(2,h),p-=O}return(I?-1:1)*v*Math.pow(2,p-h)},jD.write=function(d,o,c,h,m,p){var v,T,M,O=8*p-m-1,w=(1<<O)-1,P=w>>1,D=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=h?0:p-1,k=h?1:-1,N=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(T=isNaN(o)?1:0,v=w):(v=Math.floor(Math.log(o)/Math.LN2),o*(M=Math.pow(2,-v))<1&&(v--,M*=2),(o+=v+P>=1?D/M:D*Math.pow(2,1-P))*M>=2&&(v++,M/=2),v+P>=w?(T=0,v=w):v+P>=1?(T=(o*M-1)*Math.pow(2,m),v+=P):(T=o*Math.pow(2,P-1)*Math.pow(2,m),v=0));m>=8;d[c+I]=255&T,I+=k,T/=256,m-=8);for(v=v<<m|T,O+=m;O>0;d[c+I]=255&v,I+=k,v/=256,O-=8);d[c+I-k]|=128*N}),jD}function W6(){if(V6)return zD;V6=1,zD=o;var d=Kce();function o(K){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(K)?K:new Uint8Array(K||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var c=4294967296,h=1/c,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function p(K){return K.type===o.Bytes?K.readVarint()+K.pos:K.pos+1}function v(K,ie,se){return se?4294967296*ie+(K>>>0):4294967296*(ie>>>0)+(K>>>0)}function T(K,ie,se){var de=ie<=16383?1:ie<=2097151?2:ie<=268435455?3:Math.floor(Math.log(ie)/(7*Math.LN2));se.realloc(de);for(var we=se.pos-1;we>=K;we--)se.buf[we+de]=se.buf[we]}function M(K,ie){for(var se=0;se<K.length;se++)ie.writeVarint(K[se])}function O(K,ie){for(var se=0;se<K.length;se++)ie.writeSVarint(K[se])}function w(K,ie){for(var se=0;se<K.length;se++)ie.writeFloat(K[se])}function P(K,ie){for(var se=0;se<K.length;se++)ie.writeDouble(K[se])}function D(K,ie){for(var se=0;se<K.length;se++)ie.writeBoolean(K[se])}function I(K,ie){for(var se=0;se<K.length;se++)ie.writeFixed32(K[se])}function k(K,ie){for(var se=0;se<K.length;se++)ie.writeSFixed32(K[se])}function N(K,ie){for(var se=0;se<K.length;se++)ie.writeFixed64(K[se])}function W(K,ie){for(var se=0;se<K.length;se++)ie.writeSFixed64(K[se])}function Z(K,ie){return(K[ie]|K[ie+1]<<8|K[ie+2]<<16)+16777216*K[ie+3]}function ee(K,ie,se){K[se]=ie,K[se+1]=ie>>>8,K[se+2]=ie>>>16,K[se+3]=ie>>>24}function Q(K,ie){return(K[ie]|K[ie+1]<<8|K[ie+2]<<16)+(K[ie+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(K,ie,se){for(se=se||this.length;this.pos<se;){var de=this.readVarint(),we=de>>3,_e=this.pos;this.type=7&de,K(we,ie,this),this.pos===_e&&this.skip(de)}return ie},readMessage:function(K,ie){return this.readFields(K,ie,this.readVarint()+this.pos)},readFixed32:function(){var K=Z(this.buf,this.pos);return this.pos+=4,K},readSFixed32:function(){var K=Q(this.buf,this.pos);return this.pos+=4,K},readFixed64:function(){var K=Z(this.buf,this.pos)+Z(this.buf,this.pos+4)*c;return this.pos+=8,K},readSFixed64:function(){var K=Z(this.buf,this.pos)+Q(this.buf,this.pos+4)*c;return this.pos+=8,K},readFloat:function(){var K=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,K},readDouble:function(){var K=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,K},readVarint:function(K){var ie,se,de=this.buf;return ie=127&(se=de[this.pos++]),se<128?ie:(ie|=(127&(se=de[this.pos++]))<<7,se<128?ie:(ie|=(127&(se=de[this.pos++]))<<14,se<128?ie:(ie|=(127&(se=de[this.pos++]))<<21,se<128?ie:function(we,_e,xe){var ke,Se,De=xe.buf;if(ke=(112&(Se=De[xe.pos++]))>>4,Se<128||(ke|=(127&(Se=De[xe.pos++]))<<3,Se<128)||(ke|=(127&(Se=De[xe.pos++]))<<10,Se<128)||(ke|=(127&(Se=De[xe.pos++]))<<17,Se<128)||(ke|=(127&(Se=De[xe.pos++]))<<24,Se<128)||(ke|=(1&(Se=De[xe.pos++]))<<31,Se<128))return v(we,ke,_e);throw new Error("Expected varint not more than 10 bytes")}(ie|=(15&(se=de[this.pos]))<<28,K,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var K=this.readVarint();return K%2==1?(K+1)/-2:K/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var K=this.readVarint()+this.pos,ie=this.pos;return this.pos=K,K-ie>=12&&m?function(se,de,we){return m.decode(se.subarray(de,we))}(this.buf,ie,K):function(se,de,we){for(var _e="",xe=de;xe<we;){var ke,Se,De,Ve=se[xe],Fe=null,Ze=Ve>239?4:Ve>223?3:Ve>191?2:1;if(xe+Ze>we)break;Ze===1?Ve<128&&(Fe=Ve):Ze===2?(192&(ke=se[xe+1]))==128&&(Fe=(31&Ve)<<6|63&ke)<=127&&(Fe=null):Ze===3?(Se=se[xe+2],(192&(ke=se[xe+1]))==128&&(192&Se)==128&&((Fe=(15&Ve)<<12|(63&ke)<<6|63&Se)<=2047||Fe>=55296&&Fe<=57343)&&(Fe=null)):Ze===4&&(Se=se[xe+2],De=se[xe+3],(192&(ke=se[xe+1]))==128&&(192&Se)==128&&(192&De)==128&&((Fe=(15&Ve)<<18|(63&ke)<<12|(63&Se)<<6|63&De)<=65535||Fe>=1114112)&&(Fe=null)),Fe===null?(Fe=65533,Ze=1):Fe>65535&&(Fe-=65536,_e+=String.fromCharCode(Fe>>>10&1023|55296),Fe=56320|1023&Fe),_e+=String.fromCharCode(Fe),xe+=Ze}return _e}(this.buf,ie,K)},readBytes:function(){var K=this.readVarint()+this.pos,ie=this.buf.subarray(this.pos,K);return this.pos=K,ie},readPackedVarint:function(K,ie){if(this.type!==o.Bytes)return K.push(this.readVarint(ie));var se=p(this);for(K=K||[];this.pos<se;)K.push(this.readVarint(ie));return K},readPackedSVarint:function(K){if(this.type!==o.Bytes)return K.push(this.readSVarint());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readSVarint());return K},readPackedBoolean:function(K){if(this.type!==o.Bytes)return K.push(this.readBoolean());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readBoolean());return K},readPackedFloat:function(K){if(this.type!==o.Bytes)return K.push(this.readFloat());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readFloat());return K},readPackedDouble:function(K){if(this.type!==o.Bytes)return K.push(this.readDouble());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readDouble());return K},readPackedFixed32:function(K){if(this.type!==o.Bytes)return K.push(this.readFixed32());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readFixed32());return K},readPackedSFixed32:function(K){if(this.type!==o.Bytes)return K.push(this.readSFixed32());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readSFixed32());return K},readPackedFixed64:function(K){if(this.type!==o.Bytes)return K.push(this.readFixed64());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readFixed64());return K},readPackedSFixed64:function(K){if(this.type!==o.Bytes)return K.push(this.readSFixed64());var ie=p(this);for(K=K||[];this.pos<ie;)K.push(this.readSFixed64());return K},skip:function(K){var ie=7&K;if(ie===o.Varint)for(;this.buf[this.pos++]>127;);else if(ie===o.Bytes)this.pos=this.readVarint()+this.pos;else if(ie===o.Fixed32)this.pos+=4;else{if(ie!==o.Fixed64)throw new Error("Unimplemented type: "+ie);this.pos+=8}},writeTag:function(K,ie){this.writeVarint(K<<3|ie)},realloc:function(K){for(var ie=this.length||16;ie<this.pos+K;)ie*=2;if(ie!==this.length){var se=new Uint8Array(ie);se.set(this.buf),this.buf=se,this.length=ie}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(K){this.realloc(4),ee(this.buf,K,this.pos),this.pos+=4},writeSFixed32:function(K){this.realloc(4),ee(this.buf,K,this.pos),this.pos+=4},writeFixed64:function(K){this.realloc(8),ee(this.buf,-1&K,this.pos),ee(this.buf,Math.floor(K*h),this.pos+4),this.pos+=8},writeSFixed64:function(K){this.realloc(8),ee(this.buf,-1&K,this.pos),ee(this.buf,Math.floor(K*h),this.pos+4),this.pos+=8},writeVarint:function(K){(K=+K||0)>268435455||K<0?function(ie,se){var de,we;if(ie>=0?(de=ie%4294967296|0,we=ie/4294967296|0):(we=~(-ie/4294967296),4294967295^(de=~(-ie%4294967296))?de=de+1|0:(de=0,we=we+1|0)),ie>=18446744073709552e3||ie<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");se.realloc(10),function(_e,xe,ke){ke.buf[ke.pos++]=127&_e|128,_e>>>=7,ke.buf[ke.pos++]=127&_e|128,_e>>>=7,ke.buf[ke.pos++]=127&_e|128,_e>>>=7,ke.buf[ke.pos++]=127&_e|128,ke.buf[ke.pos]=127&(_e>>>=7)}(de,0,se),function(_e,xe){var ke=(7&_e)<<4;xe.buf[xe.pos++]|=ke|((_e>>>=3)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(xe.buf[xe.pos++]=127&_e)))))}(we,se)}(K,this):(this.realloc(4),this.buf[this.pos++]=127&K|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=K>>>7&127))))},writeSVarint:function(K){this.writeVarint(K<0?2*-K-1:2*K)},writeBoolean:function(K){this.writeVarint(!!K)},writeString:function(K){K=String(K),this.realloc(4*K.length),this.pos++;var ie=this.pos;this.pos=function(de,we,_e){for(var xe,ke,Se=0;Se<we.length;Se++){if((xe=we.charCodeAt(Se))>55295&&xe<57344){if(!ke){xe>56319||Se+1===we.length?(de[_e++]=239,de[_e++]=191,de[_e++]=189):ke=xe;continue}if(xe<56320){de[_e++]=239,de[_e++]=191,de[_e++]=189,ke=xe;continue}xe=ke-55296<<10|xe-56320|65536,ke=null}else ke&&(de[_e++]=239,de[_e++]=191,de[_e++]=189,ke=null);xe<128?de[_e++]=xe:(xe<2048?de[_e++]=xe>>6|192:(xe<65536?de[_e++]=xe>>12|224:(de[_e++]=xe>>18|240,de[_e++]=xe>>12&63|128),de[_e++]=xe>>6&63|128),de[_e++]=63&xe|128)}return _e}(this.buf,K,this.pos);var se=this.pos-ie;se>=128&&T(ie,se,this),this.pos=ie-1,this.writeVarint(se),this.pos+=se},writeFloat:function(K){this.realloc(4),d.write(this.buf,K,this.pos,!0,23,4),this.pos+=4},writeDouble:function(K){this.realloc(8),d.write(this.buf,K,this.pos,!0,52,8),this.pos+=8},writeBytes:function(K){var ie=K.length;this.writeVarint(ie),this.realloc(ie);for(var se=0;se<ie;se++)this.buf[this.pos++]=K[se]},writeRawMessage:function(K,ie){this.pos++;var se=this.pos;K(ie,this);var de=this.pos-se;de>=128&&T(se,de,this),this.pos=se-1,this.writeVarint(de),this.pos+=de},writeMessage:function(K,ie,se){this.writeTag(K,o.Bytes),this.writeRawMessage(ie,se)},writePackedVarint:function(K,ie){ie.length&&this.writeMessage(K,M,ie)},writePackedSVarint:function(K,ie){ie.length&&this.writeMessage(K,O,ie)},writePackedBoolean:function(K,ie){ie.length&&this.writeMessage(K,D,ie)},writePackedFloat:function(K,ie){ie.length&&this.writeMessage(K,w,ie)},writePackedDouble:function(K,ie){ie.length&&this.writeMessage(K,P,ie)},writePackedFixed32:function(K,ie){ie.length&&this.writeMessage(K,I,ie)},writePackedSFixed32:function(K,ie){ie.length&&this.writeMessage(K,k,ie)},writePackedFixed64:function(K,ie){ie.length&&this.writeMessage(K,N,ie)},writePackedSFixed64:function(K,ie){ie.length&&this.writeMessage(K,W,ie)},writeBytesField:function(K,ie){this.writeTag(K,o.Bytes),this.writeBytes(ie)},writeFixed32Field:function(K,ie){this.writeTag(K,o.Fixed32),this.writeFixed32(ie)},writeSFixed32Field:function(K,ie){this.writeTag(K,o.Fixed32),this.writeSFixed32(ie)},writeFixed64Field:function(K,ie){this.writeTag(K,o.Fixed64),this.writeFixed64(ie)},writeSFixed64Field:function(K,ie){this.writeTag(K,o.Fixed64),this.writeSFixed64(ie)},writeVarintField:function(K,ie){this.writeTag(K,o.Varint),this.writeVarint(ie)},writeSVarintField:function(K,ie){this.writeTag(K,o.Varint),this.writeSVarint(ie)},writeStringField:function(K,ie){this.writeTag(K,o.Bytes),this.writeString(ie)},writeFloatField:function(K,ie){this.writeTag(K,o.Fixed32),this.writeFloat(ie)},writeDoubleField:function(K,ie){this.writeTag(K,o.Fixed64),this.writeDouble(ie)},writeBooleanField:function(K,ie){this.writeVarintField(K,!!ie)}},zD}var Y2=_(W6());const FD=3;function Jce(d,o,c){o.glyphs=[],d===1&&c.readMessage(Qce,o)}function Qce(d,o,c){if(d===3){const{id:h,bitmap:m,width:p,height:v,left:T,top:M,advance:O}=c.readMessage(eue,{});o.glyphs.push({id:h,bitmap:new Uf({width:p+2*FD,height:v+2*FD},m),metrics:{width:p,height:v,left:T,top:M,advance:O}})}else d===4?o.ascender=c.readSVarint():d===5&&(o.descender=c.readSVarint())}function eue(d,o,c){d===1?o.id=c.readVarint():d===2?o.bitmap=c.readBytes():d===3?o.width=c.readVarint():d===4?o.height=c.readVarint():d===5?o.left=c.readSVarint():d===6?o.top=c.readSVarint():d===7&&(o.advance=c.readVarint())}const G6=FD,ys={horizontal:1,vertical:2,horizontalOnly:3};class I1{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,c){const h=new I1;return h.scale=o||1,h.fontStack=c,h}static forImage(o){const c=new I1;return c.image=o,c}}class Vv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c,h){const m=new Vv;for(let p=0;p<o.sections.length;p++){const v=o.sections[p];v.image?m.addImageSection(v,h):m.addTextSection(v,c)}return m}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(c,h){let m="";for(let p=0;p<c.length;p++){const v=c.charCodeAt(p+1)||null,T=c.charCodeAt(p-1)||null;m+=!h&&(v&&$b(v)&&!P1[c[p+1]]||T&&$b(T)&&!P1[c[p-1]])||!P1[c[p]]?c[p]:P1[c[p]]}return m}(this.text,o)}trim(){let o=0;for(let h=0;h<this.text.length&&K2[this.text.charCodeAt(h)];h++)o++;let c=this.text.length;for(let h=this.text.length-1;h>=0&&h>=o&&K2[this.text.charCodeAt(h)];h--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const h=new Vv;return h.text=this.text.substring(o,c),h.sectionIndex=this.sectionIndex.slice(o,c),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(I1.forText(o.scale,o.fontStack||c));const h=this.sections.length-1;for(let m=0;m<o.text.length;++m)this.sectionIndex.push(h)}addImageSection(o,c){const h=o.image?o.image.getPrimary():null;if(!h)return void pi("Can't add FormattedSection with an empty image.");h.scaleSelf(c);const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCodePoint(m),this.sections.push(I1.forImage(h)),this.sectionIndex.push(this.sections.length-1)):pi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function BD(d,o,c,h,m,p,v,T,M,O,w,P,D,I,k,N=1){const W=Vv.fromFeature(d,m,N);P===ys.vertical&&W.verticalizePunctuation(D);let Z=[];const ee=function(de,we,_e,xe,ke,Se){if(!de)return[];const De=[],Ve=function(tt,Ke,nt,Ct,At,Qt){let Rt=0;for(let Ft=0;Ft<tt.length();Ft++){const It=tt.getSection(Ft);Rt+=q6(tt.getCodePoint(Ft),It,Ct,At,Ke,Qt)}return Rt/Math.max(1,Math.ceil(Rt/nt))}(de,we,_e,xe,ke,Se),Fe=de.text.indexOf("​")>=0;let Ze=0;for(let tt=0;tt<de.length();tt++){const Ke=de.getSection(tt),nt=de.getCodePoint(tt);if(K2[nt]||(Ze+=q6(nt,Ke,xe,ke,we,Se)),tt<de.length()-1){const Ct=!((He=nt)<11904||!(pr["Bopomofo Extended"](He)||pr.Bopomofo(He)||pr["CJK Compatibility Forms"](He)||pr["CJK Compatibility Ideographs"](He)||pr["CJK Compatibility"](He)||pr["CJK Radicals Supplement"](He)||pr["CJK Strokes"](He)||pr["CJK Symbols and Punctuation"](He)||pr["CJK Unified Ideographs Extension A"](He)||pr["CJK Unified Ideographs"](He)||pr["Enclosed CJK Letters and Months"](He)||pr["Halfwidth and Fullwidth Forms"](He)||pr.Hiragana(He)||pr["Ideographic Description Characters"](He)||pr["Kangxi Radicals"](He)||pr["Katakana Phonetic Extensions"](He)||pr.Katakana(He)||pr["Vertical Forms"](He)||pr["Yi Radicals"](He)||pr["Yi Syllables"](He)));(tue[nt]||Ct||Ke.image)&&De.push(Z6(tt+1,Ze,Ve,De,rue(nt,de.getCodePoint(tt+1),Ct&&Fe),!1))}}var He;return X6(Z6(de.length(),Ze,Ve,De,0,!0))}(W,O,p,o,h,I),{processBidirectionalText:Q,processStyledBidirectionalText:K}=$s;if(Q&&W.sections.length===1){const de=Q(W.toString(),ee);for(const we of de){const _e=new Vv;_e.text=we,_e.sections=W.sections;for(let xe=0;xe<we.length;xe++)_e.sectionIndex.push(0);Z.push(_e)}}else if(K){const de=K(W.text,W.sectionIndex,ee);for(const we of de){const _e=new Vv;_e.text=we[0],_e.sectionIndex=we[1],_e.sections=W.sections,Z.push(_e)}}else Z=function(de,we){const _e=[],xe=de.text;let ke=0;for(const Se of we)_e.push(de.substring(ke,Se)),ke=Se;return ke<xe.length&&_e.push(de.substring(ke,xe.length)),_e}(W,ee);const ie=[],se={positionedLines:ie,text:W.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(de,we,_e,xe,ke,Se,De,Ve,Fe,Ze,He,tt){let Ke=0,nt=0,Ct=0;const At=Ve==="right"?1:Ve==="left"?0:.5;let Qt=!1;for(const nr of ke){const Er=nr.getSections();for(const Vr of Er){if(Vr.image)continue;const Cr=we[Vr.fontStack];if(Cr&&(Qt=Cr.ascender!==void 0&&Cr.descender!==void 0,!Qt))break}if(!Qt)break}let Rt=0;for(const nr of ke){nr.trim();const Er=nr.getMaxScale(),Vr=(Er-1)*Jo,Cr={positionedGlyphs:[],lineOffset:0};de.positionedLines[Rt]=Cr;const Yr=Cr.positionedGlyphs;let Ur=0;if(!nr.length()){nt+=Se,++Rt;continue}let Qr=0,un=0;for(let Ar=0;Ar<nr.length();Ar++){const an=nr.getSection(Ar),ri=nr.getSectionIndex(Ar),gi=nr.getCodePoint(Ar);let wi=an.scale,Ei=null,zn=null,bo=null,Da=Jo,Zi=0;Fe===ys.vertical&&((Ft=gi)===12312||Ft===12313||Ft===12316||Ft===12540||Ft===12448)&&(Fe=ys.horizontal);const oo=!(Fe===ys.horizontal||!He&&!_v(gi)||He&&(K2[gi]||g2(gi)));if(an.image){const ca=xe.get(an.image.toString());if(!ca)continue;bo=an.image,de.iconsInText=de.iconsInText||!0,zn=ca.paddedRect;const Vo=ca.displaySize;wi=wi*Jo/tt,Ei={width:Vo[0],height:Vo[1],left:0,top:-G6,advance:oo?Vo[1]:Vo[0],localGlyph:!1},Zi=Qt?-Ei.height*wi:Er*Jo-17-Vo[1]*wi,Da=Ei.advance;const Ml=(oo?Vo[0]:Vo[1])*wi-Jo*Er;Ml>0&&Ml>Ur&&(Ur=Ml)}else{const ca=_e[an.fontStack];if(!ca)continue;ca[gi]&&(zn=ca[gi]);const Vo=we[an.fontStack];if(!Vo)continue;const Ml=Vo.glyphs[gi];if(!Ml)continue;if(Ei=Ml.metrics,Da=gi!==8203?Jo:0,Qt){const Yf=Vo.ascender!==void 0?Math.abs(Vo.ascender):0,cc=Vo.descender!==void 0?Math.abs(Vo.descender):0,ru=(Yf+cc)*wi;Qr<ru&&(Qr=ru,un=(Yf-cc)/2*wi),Zi=-Yf*wi}else Zi=(Er-wi)*Jo-17}oo?(de.verticalizable=!0,Yr.push({glyph:gi,image:bo,x:Ke,y:nt+Zi,vertical:oo,scale:wi,localGlyph:Ei.localGlyph,fontStack:an.fontStack,sectionIndex:ri,metrics:Ei,rect:zn}),Ke+=Da*wi+Ze):(Yr.push({glyph:gi,image:bo,x:Ke,y:nt+Zi,vertical:oo,scale:wi,localGlyph:Ei.localGlyph,fontStack:an.fontStack,sectionIndex:ri,metrics:Ei,rect:zn}),Ke+=Ei.advance*wi+Ze)}Yr.length!==0&&(Ct=Math.max(Ke-Ze,Ct),Qt?Y6(Yr,At,Ur,un,Se*Er/2):Y6(Yr,At,Ur,0,Se/2)),Ke=0;const Un=Se*Er+Ur;Cr.lineOffset=Math.max(Ur,Vr),nt+=Un,++Rt}var Ft;const It=nt,{horizontalAlign:yr,verticalAlign:Zt}=$D(De);(function(nr,Er,Vr,Cr,Yr,Ur){const Qr=(Er-Vr)*Yr,un=-Ur*Cr;for(const Un of nr)for(const Ar of Un.positionedGlyphs)Ar.x+=Qr,Ar.y+=un})(de.positionedLines,At,yr,Zt,Ct,It),de.top+=-Zt*It,de.bottom=de.top+It,de.left+=-yr*Ct,de.right=de.left+Ct,de.hasBaseline=Qt}(se,o,c,h,Z,v,T,M,P,O,D,k),!function(de){for(const we of de)if(we.positionedGlyphs.length!==0)return!1;return!0}(ie))return se}const K2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},tue={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function q6(d,o,c,h,m,p){if(o.image){const v=h.get(o.image.toString());return v?v.displaySize[0]*o.scale*Jo/p+m:0}{const v=c[o.fontStack],T=v&&v.glyphs[d];return T?T.metrics.advance*o.scale+m:0}}function H6(d,o,c,h){const m=Math.pow(d-o,2);return h?d<o?m/2:2*m:m+Math.abs(c)*c}function rue(d,o,c){let h=0;return d===10&&(h-=1e4),c&&(h+=150),d!==40&&d!==65288||(h+=50),o!==41&&o!==65289||(h+=50),h}function Z6(d,o,c,h,m,p){let v=null,T=H6(o,c,m,p);for(const M of h){const O=H6(o-M.x,c,m,p)+M.badness;O<=T&&(v=M,T=O)}return{index:d,x:o,priorBreak:v,badness:T}}function X6(d){return d?X6(d.priorBreak).concat(d.index):[]}function $D(d){let o=.5,c=.5;switch(d){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function Y6(d,o,c,h,m){if(!(o||c||h||m))return;const p=d.length-1,v=d[p],T=(v.x+v.metrics.advance*v.scale)*o;for(let M=0;M<=p;M++)d[M].x-=T,d[M].y+=c+h+m}function nue(d,o,c,h){const{horizontalAlign:m,verticalAlign:p}=$D(h),v=c[0]-d.displaySize[0]*m,T=c[1]-d.displaySize[1]*p;return{imagePrimary:d,imageSecondary:o,top:T,bottom:T+d.displaySize[1],left:v,right:v+d.displaySize[0]}}function K6(d,o,c,h,m,p){const v=d.imagePrimary;let T;if(v.content){const W=v.content,Z=v.pixelRatio||1;T=[W[0]/Z,W[1]/Z,v.displaySize[0]-W[2]/Z,v.displaySize[1]-W[3]/Z]}const M=o.left*p,O=o.right*p;let w,P,D,I;c==="width"||c==="both"?(I=m[0]+M-h[3],P=m[0]+O+h[1]):(I=m[0]+(M+O-v.displaySize[0])/2,P=I+v.displaySize[0]);const k=o.top*p,N=o.bottom*p;return c==="height"||c==="both"?(w=m[1]+k-h[0],D=m[1]+N+h[2]):(w=m[1]+(k+N-v.displaySize[1])/2,D=w+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:w,right:P,bottom:D,left:I,collisionPadding:T}}class oh extends _t{constructor(o,c,h,m,p){super(o,c),this.angle=m,this.z=h,p!==void 0&&(this.segment=p)}clone(){return new oh(this.x,this.y,this.z,this.angle,this.segment)}}function J6(d,o,c,h,m){if(o.segment===void 0)return!0;let p=o,v=o.segment+1,T=0;for(;T>-c/2;){if(v--,v<0)return!1;T-=d[v].dist(p),p=d[v]}T+=d[v].dist(d[v+1]),v++;const M=[];let O=0;for(;T<c/2;){const w=d[v],P=d[v+1];if(!P)return!1;let D=d[v-1].angleTo(w)-w.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:T,angleDelta:D}),O+=D;T-M[0].distance>h;)O-=M.shift().angleDelta;if(O>m)return!1;v++,T+=w.dist(P)}return!0}function Q6(d){let o=0;for(let c=0;c<d.length-1;c++)o+=d[c].dist(d[c+1]);return o}function eV(d,o,c){return d?.6*o*c:0}function tV(d,o){return Math.max(d?d.right-d.left:0,o?o.right-o.left:0)}function iue(d,o,c,h,m,p){const v=eV(c,m,p),T=tV(c,h)*p;let M=0;const O=Q6(d)/2;for(let w=0;w<d.length-1;w++){const P=d[w],D=d[w+1],I=P.dist(D);if(M+I>O){const k=(O-M)/I,N=_r(P.x,D.x,k),W=_r(P.y,D.y,k),Z=new oh(N,W,0,D.angleTo(P),w);return!v||J6(d,Z,T,v,o)?Z:void 0}M+=I}}function oue(d,o,c,h,m,p,v,T,M){const O=eV(h,p,v),w=tV(h,m),P=w*v,D=d[0].x===0||d[0].x===M||d[0].y===0||d[0].y===M;return o-P<o/4&&(o=P+o/4),rV(d,D?o/2*T%o:(w/2+2*p)*v*T%o,o,O,c,P,D,!1,M)}function rV(d,o,c,h,m,p,v,T,M){const O=p/2,w=Q6(d);let P=0,D=o-c,I=[];for(let k=0;k<d.length-1;k++){const N=d[k],W=d[k+1],Z=N.dist(W),ee=W.angleTo(N);for(;D+c<P+Z;){D+=c;const Q=(D-P)/Z,K=_r(N.x,W.x,Q),ie=_r(N.y,W.y,Q);if(K>=0&&K<M&&ie>=0&&ie<M&&D-O>=0&&D+O<=w){const se=new oh(K,ie,0,ee,k);h&&!J6(d,se,p,h,m)||I.push(se)}}P+=Z}return T||I.length||v||(I=rV(d,P/2,c,h,m,p,v,!0,M)),I}function nV(d,o,c,h,m){const p=[];for(let v=0;v<d.length;v++){const T=d[v];let M;for(let O=0;O<T.length-1;O++){let w=T[O],P=T[O+1];w.x<o&&P.x<o||(w.x<o?w=new _t(o,w.y+(o-w.x)/(P.x-w.x)*(P.y-w.y))._round():P.x<o&&(P=new _t(o,w.y+(o-w.x)/(P.x-w.x)*(P.y-w.y))._round()),w.y<c&&P.y<c||(w.y<c?w=new _t(w.x+(c-w.y)/(P.y-w.y)*(P.x-w.x),c)._round():P.y<c&&(P=new _t(w.x+(c-w.y)/(P.y-w.y)*(P.x-w.x),c)._round()),w.x>=h&&P.x>=h||(w.x>=h?w=new _t(h,w.y+(h-w.x)/(P.x-w.x)*(P.y-w.y))._round():P.x>=h&&(P=new _t(h,w.y+(h-w.x)/(P.x-w.x)*(P.y-w.y))._round()),w.y>=m&&P.y>=m||(w.y>=m?w=new _t(w.x+(m-w.y)/(P.y-w.y)*(P.x-w.x),m)._round():P.y>=m&&(P=new _t(w.x+(m-w.y)/(P.y-w.y)*(P.x-w.x),m)._round()),M&&w.equals(M[M.length-1])||(M=[w],p.push(M)),M.push(P)))))}}return p}function iV(d){let o=0,c=0;for(const v of d)o+=v.w*v.h,c=Math.max(c,v.w);d.sort((v,T)=>T.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let m=0,p=0;for(const v of d)for(let T=h.length-1;T>=0;T--){const M=h[T];if(!(v.w>M.w||v.h>M.h)){if(v.x=M.x,v.y=M.y,p=Math.max(p,v.y+v.h),m=Math.max(m,v.x+v.w),v.w===M.w&&v.h===M.h){const O=h.pop();T<h.length&&(h[T]=O)}else v.h===M.h?(M.x+=v.w,M.w-=v.w):v.w===M.w?(M.y+=v.h,M.h-=v.h):(h.push({x:M.x+v.w,y:M.y,w:M.w-v.w,h:v.h}),M.y+=v.h,M.h-=v.h);break}}return{w:m,h:p,fill:o/(m*p)||0}}Jt(oh,"Anchor");const Wv=1;class O1{static getImagePositionScale(o,c,h){if(c&&o&&o.options&&o.options.transform){const m=o.options.transform;return{x:m.a,y:m.d}}return{x:h,y:h}}constructor(o,c,h,m){this.paddedRect=o;const{pixelRatio:p,version:v,stretchX:T,stretchY:M,content:O,sdf:w,usvg:P}=c;this.pixelRatio=p,this.stretchX=T,this.stretchY=M,this.content=O,this.version=v,this.padding=h,this.sdf=w,this.scale=O1.getImagePositionScale(m,P,p)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function oV(d,o,c){const h=tc.parse(d),m=function(p,v,T=[1,1]){return{x:0,y:0,w:(p.data?p.data.width:p.width*T[0])+2*v,h:(p.data?p.data.height:p.height*T[1])+2*v}}(o,c,[h.options.transform.a,h.options.transform.d]);return{bin:m,imagePosition:new O1(m,o,c,h),imageVariant:h}}class aV{constructor(o,c,h){const m=new Map,p=new Map;this.haveRenderCallbacks=[];const v=[];this.addImages(o,m,Wv,v),this.addImages(c,p,2,v);const{w:T,h:M}=iV(v),O=new Ko({width:T||1,height:M||1});for(const[w,P]of o.entries()){const D=m.get(w).paddedRect;Ko.copy(P.data,O,{x:0,y:0},{x:D.x+Wv,y:D.y+Wv},P.data,h,P.sdf)}for(const[w,P]of c.entries()){const D=p.get(w),I=D.paddedRect;let k=D.padding;const N=I.x+k,W=I.y+k,Z=P.data.width,ee=P.data.height;k=k>1?k-1:k,Ko.copy(P.data,O,{x:0,y:0},{x:N,y:W},P.data,h),Ko.copy(P.data,O,{x:0,y:ee-k},{x:N,y:W-k},{width:Z,height:k},h),Ko.copy(P.data,O,{x:0,y:0},{x:N,y:W+ee},{width:Z,height:k},h),Ko.copy(P.data,O,{x:Z-k,y:0},{x:N-k,y:W},{width:k,height:ee},h),Ko.copy(P.data,O,{x:0,y:0},{x:N+Z,y:W},{width:k,height:ee},h),Ko.copy(P.data,O,{x:Z-k,y:ee-k},{x:N-k,y:W-k},{width:k,height:k},h),Ko.copy(P.data,O,{x:0,y:ee-k},{x:N+Z,y:W-k},{width:k,height:k},h),Ko.copy(P.data,O,{x:0,y:0},{x:N+Z,y:W+ee},{width:k,height:k},h),Ko.copy(P.data,O,{x:Z-k,y:0},{x:N-k,y:W+ee},{width:k,height:k},h)}this.lut=h,this.image=O,this.iconPositions=m,this.patternPositions=p}addImages(o,c,h,m){for(const[p,v]of o.entries()){const{bin:T,imagePosition:M,imageVariant:O}=oV(p,v,h);c.set(p,M),m.push(T),v.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(o,c,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>o.hasImage(m,h)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const m of o.getUpdatedImages(h)){for(const p of this.iconPositions.keys()){const v=tc.parse(p);if(Oa.isEqual(v.id,m)){const T=o.getImage(m,h);this.patchUpdatedImage(this.iconPositions.get(p),T,c)}}for(const p of this.patternPositions.keys()){const v=tc.parse(p);if(Oa.isEqual(v.id,m)){const T=o.getImage(m,h);this.patchUpdatedImage(this.patternPositions.get(p),T,c)}}}}patchUpdatedImage(o,c,h){if(!o||!c||o.version===c.version)return;o.version=c.version;const[m,p]=o.tl,v=o.sdf;if(this.lut||v){const T={width:c.data.width,height:c.data.height},M=new Ko(T);Ko.copy(c.data,M,{x:0,y:0},{x:0,y:0},T,this.lut,v),h.update(M,{position:{x:m,y:p}})}else h.update(c.data,{position:{x:m,y:p}})}}Jt(O1,"ImagePosition"),Jt(aV,"ImageAtlas");const k1=1e20;function sV(d,o,c,h,m,p,v,T,M){for(let O=o;O<o+h;O++)lV(d,c*p+O,p,m,v,T,M);for(let O=c;O<c+m;O++)lV(d,O*p+o,1,h,v,T,M)}function lV(d,o,c,h,m,p,v){p[0]=0,v[0]=-k1,v[1]=k1,m[0]=d[o];for(let T=1,M=0,O=0;T<h;T++){m[T]=d[o+T*c];const w=T*T;do{const P=p[M];O=(m[T]-m[P]+w-P*P)/(T-P)/2}while(O<=v[M]&&--M>-1);M++,p[M]=T,v[M]=O,v[M+1]=k1}for(let T=0,M=0;T<h;T++){for(;v[M+1]<T;)M++;const O=p[M],w=T-O;d[o+T*c]=m[O]+w*w}}const Jc=2,UD={none:0,ideographs:1,all:2};class Gv{constructor(o,c,h){this.requestManager=o,this.localGlyphMode=c,this.localFontFamily=h,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,c){this.urls[c]=o}getGlyphs(o,c,h){const m=[],p=this.urls[c]||pe.GLYPHS_URL;for(const v in o)for(const T of o[v])m.push({stack:v,id:T});Qn(m,({stack:v,id:T},M)=>{let O=this.entries[v];O||(O=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=O.glyphs[T];if(w!==void 0)return void M(null,{stack:v,id:T,glyph:w});if(w=this._tinySDF(O,v,T),w)return O.glyphs[T]=w,void M(null,{stack:v,id:T,glyph:w});const P=Math.floor(T/256);if(256*P>65535)return pi("glyphs > 65535 not supported"),void M(null,{stack:v,id:T,glyph:w});if(O.ranges[P])return void M(null,{stack:v,id:T,glyph:w});let D=O.requests[P];D||(D=O.requests[P]=[],Gv.loadGlyphRange(v,P,p,this.requestManager,(I,k)=>{if(k){O.ascender=k.ascender,O.descender=k.descender;for(const N in k.glyphs)this._doesCharSupportLocalGlyph(+N)||(O.glyphs[+N]=k.glyphs[+N]);O.ranges[P]=!0}for(const N of D)N(I,k);delete O.requests[P]})),D.push((I,k)=>{I?M(I):k&&M(null,{stack:v,id:T,glyph:k.glyphs[T]||null})})},(v,T)=>{if(v)h(v);else if(T){const M={};for(const{stack:O,id:w,glyph:P}of T)M[O]===void 0&&(M[O]={}),M[O].glyphs===void 0&&(M[O].glyphs={}),M[O].glyphs[w]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},M[O].ascender=this.entries[O].ascender,M[O].descender=this.entries[O].descender;h(null,M)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==UD.none&&(this.localGlyphMode===UD.all?!!this.localFontFamily:!!this.localFontFamily&&(pr["CJK Unified Ideographs"](o)||pr["Hangul Syllables"](o)||pr.Hiragana(o)||pr.Katakana(o)||pr["CJK Symbols and Punctuation"](o)||pr["CJK Unified Ideographs Extension A"](o)||pr["CJK Unified Ideographs Extension B"](o)||pr.Osage(o)))}_tinySDF(o,c,h){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(h))return;let p=o.tinySDF;if(!p){let N="400";/bold/i.test(c)?N="900":/medium/i.test(c)?N="500":/light/i.test(c)&&(N="200"),p=o.tinySDF=new Gv.TinySDF({fontFamily:m,fontWeight:N,fontSize:24*Jc,buffer:3*Jc,radius:8*Jc}),p.fontWeight=N}if(this.localGlyphs[p.fontWeight][h])return this.localGlyphs[p.fontWeight][h];const v=String.fromCodePoint(h),{data:T,width:M,height:O,glyphWidth:w,glyphHeight:P,glyphLeft:D,glyphTop:I,glyphAdvance:k}=p.draw(v);return this.localGlyphs[p.fontWeight][h]={id:h,bitmap:new Uf({width:M,height:O},T),metrics:{width:w/Jc,height:P/Jc,left:D/Jc,top:I/Jc-27,advance:k/Jc,localGlyph:!0}}}}Gv.loadGlyphRange=function(d,o,c,h,m){const p=256*o,v=p+255,T=h.transformRequest(h.normalizeGlyphsURL(c).replace("{fontstack}",d).replace("{range}",`${p}-${v}`),Io.Glyphs);Rc(T,(M,O)=>{if(M)m(M);else if(O){const w={},P=function(D){return new Y2(D).readFields(Jce,{})}(O);for(const D of P.glyphs)w[D.id]=D;m(null,{glyphs:w,ascender:P.ascender,descender:P.descender})}})},Gv.TinySDF=class{constructor({fontSize:d=24,buffer:o=3,radius:c=8,cutoff:h=.25,fontFamily:m="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=o,this.cutoff=h,this.radius=c;const T=this.size=d+4*o,M=this._createCanvas(T),O=this.ctx=M.getContext("2d",{willReadFrequently:!0});O.font=`${v} ${p} ${d}px ${m}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(d){const o=document.createElement("canvas");return o.width=o.height=d,o}draw(d){const{width:o,actualBoundingBoxAscent:c,actualBoundingBoxDescent:h,actualBoundingBoxLeft:m,actualBoundingBoxRight:p}=this.ctx.measureText(d),v=Math.ceil(c),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-m))),M=Math.min(this.size-this.buffer,v+Math.ceil(h)),O=T+2*this.buffer,w=M+2*this.buffer,P=Math.max(O*w,0),D=new Uint8ClampedArray(P),I={data:D,width:O,height:w,glyphWidth:T,glyphHeight:M,glyphTop:v,glyphLeft:0,glyphAdvance:o};if(T===0||M===0)return I;const{ctx:k,buffer:N,gridInner:W,gridOuter:Z}=this;k.clearRect(N,N,T,M),k.fillText(d,N,N+v);const ee=k.getImageData(N,N,T,M);Z.fill(k1,0,P),W.fill(0,0,P);for(let Q=0;Q<M;Q++)for(let K=0;K<T;K++){const ie=ee.data[4*(Q*T+K)+3]/255;if(ie===0)continue;const se=(Q+N)*O+K+N;if(ie===1)Z[se]=0,W[se]=k1;else{const de=.5-ie;Z[se]=de>0?de*de:0,W[se]=de<0?de*de:0}}sV(Z,0,0,O,w,O,this.f,this.v,this.z),sV(W,N,N,T,M,O,this.f,this.v,this.z);for(let Q=0;Q<P;Q++){const K=Math.sqrt(Z[Q])-Math.sqrt(W[Q]);D[Q]=Math.round(255-255*(K/this.radius+this.cutoff))}return I}};const Gf=Wv;function cV(d,o){return d+o[1]-o[0]}function uV(d,o,c,h,m=1){const p=[],v=d.imagePrimary,T=v.pixelRatio,M=v.paddedRect.w-2*Gf,O=v.paddedRect.h-2*Gf,w=(d.right-d.left)*m,P=(d.bottom-d.top)*m,D=v.stretchX||[[0,M]],I=v.stretchY||[[0,O]],k=D.reduce(cV,0),N=I.reduce(cV,0),W=M-k,Z=O-N;let ee=0,Q=k,K=0,ie=N,se=0,de=W,we=0,_e=Z;if(v.content&&h){const ke=v.content;ee=J2(D,0,ke[0]),K=J2(I,0,ke[1]),Q=J2(D,ke[0],ke[2]),ie=J2(I,ke[1],ke[3]),se=ke[0]-ee,we=ke[1]-K,de=ke[2]-ke[0]-Q,_e=ke[3]-ke[1]-ie}const xe=(ke,Se,De,Ve)=>{const Fe=Q2(ke.stretch-ee,Q,w,d.left*m),Ze=eA(ke.fixed-se,de,ke.stretch,k),He=Q2(Se.stretch-K,ie,P,d.top*m),tt=eA(Se.fixed-we,_e,Se.stretch,N),Ke=Q2(De.stretch-ee,Q,w,d.left*m),nt=eA(De.fixed-se,de,De.stretch,k),Ct=Q2(Ve.stretch-K,ie,P,d.top*m),At=eA(Ve.fixed-we,_e,Ve.stretch,N),Qt=new _t(Fe,He),Rt=new _t(Ke,He),Ft=new _t(Ke,Ct),It=new _t(Fe,Ct),yr=new _t(Ze/T,tt/T),Zt=new _t(nt/T,At/T),nr=o*Math.PI/180;if(nr){const Qr=Math.sin(nr),un=Math.cos(nr),Un=[un,-Qr,Qr,un];Qt._matMult(Un),Rt._matMult(Un),It._matMult(Un),Ft._matMult(Un)}const Er=ke.stretch+ke.fixed,Vr=De.stretch+De.fixed,Cr=Se.stretch+Se.fixed,Yr=Ve.stretch+Ve.fixed,Ur=d.imageSecondary;return{tl:Qt,tr:Rt,bl:It,br:Ft,texPrimary:{x:v.paddedRect.x+Gf+Er,y:v.paddedRect.y+Gf+Cr,w:Vr-Er,h:Yr-Cr},texSecondary:Ur?{x:Ur.paddedRect.x+Gf+Er,y:Ur.paddedRect.y+Gf+Cr,w:Vr-Er,h:Yr-Cr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:yr,pixelOffsetBR:Zt,minFontScaleX:de/T/w,minFontScaleY:_e/T/P,isSDF:c}};if(h&&(v.stretchX||v.stretchY)){const ke=dV(D,W,k),Se=dV(I,Z,N);for(let De=0;De<ke.length-1;De++){const Ve=ke[De],Fe=ke[De+1];for(let Ze=0;Ze<Se.length-1;Ze++)p.push(xe(Ve,Se[Ze],Fe,Se[Ze+1]))}}else p.push(xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:O+1}));return p}function J2(d,o,c){let h=0;for(const m of d)h+=Math.max(o,Math.min(c,m[1]))-Math.max(o,Math.min(c,m[0]));return h}function dV(d,o,c){const h=[{fixed:-Gf,stretch:0}];for(const[m,p]of d){const v=h[h.length-1];h.push({fixed:m-v.stretch,stretch:v.stretch}),h.push({fixed:m-v.stretch,stretch:v.stretch+(p-m)})}return h.push({fixed:o+Gf,stretch:c}),h}function Q2(d,o,c,h){return d/o*c+h}function eA(d,o,c,h){return d-o*c/h}function aue(d,o,c,h){const m=o+d.positionedLines[h].lineOffset;return h===0?c+m/2:c+(m+(o+d.positionedLines[h-1].lineOffset))/2}function sue(d,o=1,c=!1){let h=1/0,m=1/0,p=-1/0,v=-1/0;const T=d[0];for(let I=0;I<T.length;I++){const k=T[I];(!I||k.x<h)&&(h=k.x),(!I||k.y<m)&&(m=k.y),(!I||k.x>p)&&(p=k.x),(!I||k.y>v)&&(v=k.y)}const M=Math.min(p-h,v-m);let O=M/2;const w=new zm([],lue);if(M===0)return new _t(h,m);for(let I=h;I<p;I+=M)for(let k=m;k<v;k+=M)w.push(new qv(I+O,k+O,O,d));let P=function(I){let k=0,N=0,W=0;const Z=I[0];for(let ee=0,Q=Z.length,K=Q-1;ee<Q;K=ee++){const ie=Z[ee],se=Z[K],de=ie.x*se.y-se.x*ie.y;N+=(ie.x+se.x)*de,W+=(ie.y+se.y)*de,k+=3*de}return new qv(N/k,W/k,0,I)}(d),D=w.length;for(;w.length;){const I=w.pop();(I.d>P.d||!P.d)&&(P=I,c&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,D)),I.max-P.d<=o||(O=I.h/2,w.push(new qv(I.p.x-O,I.p.y-O,O,d)),w.push(new qv(I.p.x+O,I.p.y-O,O,d)),w.push(new qv(I.p.x-O,I.p.y+O,O,d)),w.push(new qv(I.p.x+O,I.p.y+O,O,d)),D+=4)}return c&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function lue(d,o){return o.max-d.max}class qv{constructor(o,c,h,m){this.p=new _t(o,c),this.h=h,this.d=function(p,v){let T=!1,M=1/0;for(let O=0;O<v.length;O++){const w=v[O];for(let P=0,D=w.length,I=D-1;P<D;I=P++){const k=w[P],N=w[I];k.y>p.y!=N.y>p.y&&p.x<(N.x-k.x)*(p.y-k.y)/(N.y-k.y)+k.x&&(T=!T),M=Math.min(M,Oe(p,k,N))}}return(T?1:-1)*Math.sqrt(M)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const VD=Number.POSITIVE_INFINITY,cue=Math.sqrt(2);function hV(d,[o,c]){let h=0,m=0;if(c===VD){o<0&&(o=0);const p=o/cue;switch(d){case"top-right":case"top-left":m=p-7;break;case"bottom-right":case"bottom-left":m=7-p;break;case"bottom":m=7-o;break;case"top":m=o-7}switch(d){case"top-right":case"bottom-right":h=-p;break;case"top-left":case"bottom-left":h=p;break;case"left":h=o;break;case"right":h=-o}}else{switch(o=Math.abs(o),c=Math.abs(c),d){case"top-right":case"top-left":case"top":m=c-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-c}switch(d){case"top-right":case"bottom-right":case"right":h=-o;break;case"top-left":case"bottom-left":case"left":h=o}}return[h,m]}function fV(d,o,c,h,m,p,v,T){if(!d)return;const M=$6(o,c,h,m,p);return d.scaleSelf(M*T*v)}function pV(d,o,c,h,m,p,v,T){return{iconPrimary:fV(d.getPrimary(),o,c,h,m,p,v,T),iconSecondary:fV(d.getSecondary(),o,c,h,m,p,v,T)}}function mV(d,o,c,h){if(!d)return;const m=o.get(c.toString());if(d.imagePrimary=m,h){const p=o.get(h.toString());d.imageSecondary=p}}function uue(d,o){for(const c in d.horizontal)gV(d.horizontal[c],o);gV(d.vertical,o)}function gV(d,o){if(d){for(const c of d.positionedLines)for(const h of c.positionedGlyphs)if(h.image!==null){const m=h.image.toString();h.rect=o.get(m).paddedRect}}}function WD(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function due(d,o,c,h,m,p,v,T,M){const O=GD(p.horizontal)||p.vertical,w=c.get("icon-text-fit-padding").evaluate(h,{},m);let P,D=o;return o&&M!=="none"&&(d.allowVerticalPlacement&&p.vertical&&(P=K6(o,p.vertical,M,w,T,v)),O&&(D=K6(o,O,M,w,T,v))),{defaultShapedIcon:D,verticallyShapedIcon:P}}function hue(d,o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z,ee,Q){let K=v.textMaxSize.evaluate(o,{},D);K===void 0?K=T*v.textScaleFactor:K*=v.textScaleFactor;const ie=d.layers[0].layout,se=GD(c.horizontal)||c.vertical,de=I.name==="globe",we=Jo,_e=d.tilePixelRatio*K/we,xe=(Ze=d.overscaling,d.zoom>18&&Ze>2&&(Ze>>=1),Math.max(Bt/(512*Ze),1)*ie.get("symbol-spacing")),ke=ie.get("text-padding")*d.tilePixelRatio,Se=ie.get("icon-padding")*d.tilePixelRatio,De=Ge(ie.get("text-max-angle")),Ve=ie.get("icon-rotation-alignment")==="map"&&Q!=="point",Fe=xe/2;var Ze;d.hasAnyIconTextFit===!1&&W!=="none"&&(d.hasAnyIconTextFit=!0);const He=o.properties?+o.properties[dg]:null,tt=He&&d.elevationFeatureIdToIndex?d.elevationFeatureIdToIndex.get(He):65535,Ke=(nt,Ct,At)=>{if(Ct.x<0||Ct.x>=Bt||Ct.y<0||Ct.y>=Bt)return;let Qt=null;if(de){const{x:Rt,y:Ft,z:It}=I.projectTilePoint(Ct.x,Ct.y,At);Qt={anchor:new oh(Rt,Ft,It,0,void 0),up:I.upVector(At,Ct.x,Ct.y)}}(function(Rt,Ft,It,yr,Zt,nr,Er,Vr,Cr,Yr,Ur,Qr,un,Un,Ar,an,ri,gi,wi,Ei,zn,bo,Da,Zi,oo,ca,Vo,Ml,Yf){const cc=Rt.addToLineVertexArray(Ft,yr);let ru,Kf,Jf,vg,J8,Q8,eW,tW=0,rW=0,nW=0,iW=0,TL=-1,EL=-1;const rd={};let oW=us("");const _g=It?It.anchor:Ft,AL=Ml!=="none";let ML=0,CL=0;if(Cr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[ML,CL]=Cr.layout.get("text-offset").evaluate(zn,{},oo).map(Cl=>Cl*Jo):(ML=Cr.layout.get("text-radial-offset").evaluate(zn,{},oo)*Jo,CL=VD),Rt.allowVerticalPlacement&&Zt.vertical){const Cl=Zt.vertical;if(Ar)Q8=qD(Cl),Vr&&(eW=qD(Vr));else{const vs=Cr.layout.get("text-rotate").evaluate(zn,{},oo)+90;Jf=tA(Yr,_g,Ft,Ur,Qr,un,Cl,Un,vs,an),Vr&&(vg=tA(Yr,_g,Ft,Ur,Qr,un,Vr,gi,vs))}}if(nr){const Cl=Rt.iconSizeData,vs=Cr.layout.get("icon-rotate").evaluate(zn,{},oo),K1=uV(nr,vs,Da,AL,bo.iconScaleFactor),IL=Vr?uV(Vr,vs,Da,AL,bo.iconScaleFactor):void 0;Kf=tA(Yr,_g,Ft,Ur,Qr,un,nr,gi,vs,null),tW=4*K1.length;let xg=null;Cl.kind==="source"?(xg=[Kc*Cr.layout.get("icon-size").evaluate(zn,{},oo)*bo.iconScaleFactor],xg[0]>qf&&pi(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${R1}. Reduce your "icon-size".`)):Cl.kind==="composite"&&(xg=[Kc*bo.compositeIconSizes[0].evaluate(zn,{},oo)*bo.iconScaleFactor,Kc*bo.compositeIconSizes[1].evaluate(zn,{},oo)*bo.iconScaleFactor],(xg[0]>qf||xg[1]>qf)&&pi(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${R1}. Reduce your "icon-size".`)),Rt.addSymbols(Rt.icon,K1,xg,Ei,wi,zn,!1,It,Ft,cc.lineStartIndex,cc.lineLength,-1,Zi,oo,ca,Vo),TL=Rt.icon.placedSymbolArray.length-1,IL&&(rW=4*IL.length,Rt.addSymbols(Rt.icon,IL,xg,Ei,wi,zn,ys.vertical,It,Ft,cc.lineStartIndex,cc.lineLength,-1,Zi,oo,ca,Vo),EL=Rt.icon.placedSymbolArray.length-1)}for(const Cl in Zt.horizontal){const vs=Zt.horizontal[Cl];ru||(oW=us(vs.text),Ar?J8=qD(vs):ru=tA(Yr,_g,Ft,Ur,Qr,un,vs,Un,Cr.layout.get("text-rotate").evaluate(zn,{},oo),an));const K1=vs.positionedLines.length===1;if(nW+=yV(Rt,It,Ft,vs,Er,Cr,Ar,zn,an,cc,Zt.vertical?ys.horizontal:ys.horizontalOnly,K1?Object.keys(Zt.horizontal):[Cl],rd,TL,bo,Zi,oo,ca),K1)break}Zt.vertical&&(iW+=yV(Rt,It,Ft,Zt.vertical,Er,Cr,Ar,zn,an,cc,ys.vertical,["vertical"],rd,EL,bo,Zi,oo,ca));let Qf=-1;const PL=(Cl,vs)=>Cl?Math.max(Cl,vs):vs;Qf=PL(J8,Qf),Qf=PL(Q8,Qf),Qf=PL(eW,Qf);const Wde=Qf>-1?1:0;Rt.glyphOffsetArray.length>=65535&&pi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zn.sortKey!==void 0&&Rt.addToSortKeyRanges(Rt.symbolInstances.length,zn.sortKey),Rt.symbolInstances.emplaceBack(Ft.x,Ft.y,_g.x,_g.y,_g.z,rd.right>=0?rd.right:-1,rd.center>=0?rd.center:-1,rd.left>=0?rd.left:-1,rd.vertical>=0?rd.vertical:-1,TL,EL,oW,ru!==void 0?ru:Rt.collisionBoxArray.length,ru!==void 0?ru+1:Rt.collisionBoxArray.length,Jf!==void 0?Jf:Rt.collisionBoxArray.length,Jf!==void 0?Jf+1:Rt.collisionBoxArray.length,Kf!==void 0?Kf:Rt.collisionBoxArray.length,Kf!==void 0?Kf+1:Rt.collisionBoxArray.length,vg||Rt.collisionBoxArray.length,vg?vg+1:Rt.collisionBoxArray.length,Ur,nW,iW,tW,rW,Wde,0,ML,CL,Qf,0,AL?1:0,Yf)})(d,Ct,Qt,nt,c,h,p,m,d.layers[0],d.collisionBoxArray,o.index,o.sourceLayerIndex,d.index,ke,ee,O,0,Se,Ve,Z,o,v,w,P,D,k,N,W,tt)};if(Q==="line")for(const nt of nV(o.geometry,0,0,Bt,Bt)){const Ct=oue(nt,xe,De,c.vertical||se,h,we,_e,d.overscaling,Bt);for(const At of Ct)se&&fue(d,se.text,Fe,At)||Ke(nt,At,D)}else if(Q==="line-center"){for(const nt of o.geometry)if(nt.length>1){const Ct=iue(nt,De,c.vertical||se,h,we,_e);Ct&&Ke(nt,Ct,D)}}else if(o.type==="Polygon")for(const nt of U2(o.geometry,0)){const Ct=sue(nt,16);Ke(nt[0],new oh(Ct.x,Ct.y,0,0,void 0),D)}else if(o.type==="LineString")for(const nt of o.geometry)Ke(nt,new oh(nt[0].x,nt[0].y,0,0,void 0),D);else if(o.type==="Point")for(const nt of o.geometry)for(const Ct of nt)Ke([Ct],new oh(Ct.x,Ct.y,0,0,void 0),D)}const R1=255,qf=R1*Kc;function yV(d,o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W,Z){const ee=function(ie,se,de,we,_e,xe,ke,Se){const De=[];if(se.positionedLines.length===0)return De;const Ve=we.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,Fe=function(nt){const Ct=nt[0],At=nt[1],Qt=Ct*At;return Qt>0?[Ct,-At]:Qt<0?[-Ct,At]:Ct===0?[At,Ct]:[At,-Ct]}(de);let Ze=Math.abs(se.top-se.bottom);for(const nt of se.positionedLines)Ze-=nt.lineOffset;const He=se.positionedLines.length,tt=Ze/He;let Ke=se.top-de[1];for(let nt=0;nt<He;++nt){const Ct=se.positionedLines[nt];Ke=aue(se,tt,Ke,nt);for(const At of Ct.positionedGlyphs){if(!At.rect)continue;const Qt=At.rect||{};let Rt=G6+1,Ft=!0,It=1,yr=0;if(At.image){const zn=ke.get(At.image.toString());if(!zn)continue;if(zn.sdf){pi("SDF images are not supported in formatted text and will be ignored.");continue}Ft=!1,It=zn.pixelRatio,Rt=Wv/It}const Zt=(_e||Se)&&At.vertical,nr=At.metrics.advance*At.scale/2,Er=At.metrics,Vr=At.rect;if(Vr===null)continue;Se&&se.verticalizable&&(yr=At.image?nr-At.metrics.width*At.scale/2:0);const Cr=_e?[At.x+nr,At.y]:[0,0];let Yr=[0,0],Ur=[0,0],Qr=!1;_e||(Zt?(Ur=[At.x+nr+Fe[0],At.y+Fe[1]-yr],Qr=!0):Yr=[At.x+nr+de[0],At.y+de[1]-yr]);const un=Vr.w*At.scale/(It*(At.localGlyph?Jc:1)),Un=Vr.h*At.scale/(It*(At.localGlyph?Jc:1));let Ar,an,ri,gi;if(Zt){const zn=At.y-Ke,bo=new _t(-nr,nr-zn),Da=-Math.PI/2,Zi=new _t(...Ur);Ar=new _t(-nr+Yr[0],Yr[1]),Ar._rotateAround(Da,bo)._add(Zi),Ar.x+=-zn+nr,Ar.y-=(Er.left-Rt)*At.scale;const oo=At.image?Er.advance*At.scale:Jo*At.scale,ca=String.fromCodePoint(At.glyph);Xce(ca)?Ar.x+=(1-Rt)*At.scale:Yce(ca)?Ar.x+=oo-Er.height*At.scale+(-Rt-1)*At.scale:Ar.x+=At.image||Er.width+2*Rt===Vr.w&&Er.height+2*Rt===Vr.h?(oo-Un)/2:(oo-(Er.height+2*Rt)*At.scale)/2,an=new _t(Ar.x,Ar.y-un),ri=new _t(Ar.x+Un,Ar.y),gi=new _t(Ar.x+Un,Ar.y-un)}else{const zn=(Er.left-Rt)*At.scale-nr+Yr[0],bo=(-Er.top-Rt)*At.scale+Yr[1],Da=zn+un,Zi=bo+Un;Ar=new _t(zn,bo),an=new _t(Da,bo),ri=new _t(zn,Zi),gi=new _t(Da,Zi)}if(Ve){let zn;zn=_e?new _t(0,0):Qr?new _t(Fe[0],Fe[1]):new _t(de[0],de[1]),Ar._rotateAround(Ve,zn),an._rotateAround(Ve,zn),ri._rotateAround(Ve,zn),gi._rotateAround(Ve,zn)}const wi=new _t(0,0),Ei=new _t(0,0);De.push({tl:Ar,tr:an,bl:ri,br:gi,texPrimary:Qt,texSecondary:void 0,writingMode:se.writingMode,glyphOffset:Cr,sectionIndex:At.sectionIndex,isSDF:Ft,pixelOffsetTL:wi,pixelOffsetBR:Ei,minFontScaleX:0,minFontScaleY:0})}}return De}(0,h,M,p,v,T,m,d.allowVerticalPlacement),Q=d.textSizeData;let K=null;Q.kind==="source"?(K=[Kc*p.layout.get("text-size").evaluate(T,{},W)*k.textScaleFactor],K[0]>qf&&pi(`${d.layerIds[0]}: Value for "text-size" is >= ${R1}. Reduce your "text-size".`)):Q.kind==="composite"&&(K=[Kc*k.compositeTextSizes[0].evaluate(T,{},W)*k.textScaleFactor,Kc*k.compositeTextSizes[1].evaluate(T,{},W)*k.textScaleFactor],(K[0]>qf||K[1]>qf)&&pi(`${d.layerIds[0]}: Value for "text-size" is >= ${R1}. Reduce your "text-size".`)),d.addSymbols(d.text,ee,K,M,v,T,w,o,c,O.lineStartIndex,O.lineLength,I,N,W,Z,!1);for(const ie of P)D[ie]=d.text.placedSymbolArray.length-1;return 4*ee.length}function GD(d){for(const o in d)return d[o];return null}function tA(d,o,c,h,m,p,v,T,M,O){let w=v.top,P=v.bottom,D=v.left,I=v.right;const k=v.collisionPadding;if(k&&(D-=k[0],w-=k[1],I+=k[2],P+=k[3]),M){const N=new _t(D,w),W=new _t(I,w),Z=new _t(D,P),ee=new _t(I,P),Q=Ge(M);let K=new _t(0,0);O&&(K=new _t(O[0],O[1])),N._rotateAround(Q,K),W._rotateAround(Q,K),Z._rotateAround(Q,K),ee._rotateAround(Q,K),D=Math.min(N.x,W.x,Z.x,ee.x),I=Math.max(N.x,W.x,Z.x,ee.x),w=Math.min(N.y,W.y,Z.y,ee.y),P=Math.max(N.y,W.y,Z.y,ee.y)}return d.emplaceBack(o.x,o.y,o.z,c.x,c.y,D,w,I,P,T,h,m,p),d.length-1}function qD(d){d.collisionPadding&&(d.top-=d.collisionPadding[1],d.bottom+=d.collisionPadding[3]);const o=d.bottom-d.top;return o>0?Math.max(10,o):null}function fue(d,o,c,h){const m=d.compareText;if(o in m){const p=m[o];for(let v=p.length-1;v>=0;v--)if(h.dist(p[v])<c)return!0}else m[o]=[];return m[o].push(h),!1}function vV(d,o){const c=d.fovAboveCenter,h=d.elevation?d.elevation.getMinElevationBelowMSL()*o:0,m=(d._camera.position[2]*d.worldSize-h)/Math.cos(d._pitch),p=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-d._pitch-c,.01));let v=Math.sin(d._pitch)*p+m;const T=m*(1/d._horizonShift);if(!d.elevation||d.elevation.exaggeration()===0){let M=Math.max(d.zoom-17,0);d.isOrthographic&&(M/=10),v*=1+M}return Math.min(1.01*v,T)}function D1(d,o){if(!o.isReprojectedInTileSpace)return{scale:1<<d.z,x:d.x,y:d.y,x2:d.x+1,y2:d.y+1,projection:o};const c=Math.pow(2,-d.z),h=d.x*c,m=(d.x+1)*c,p=d.y*c,v=(d.y+1)*c,T=qa(h),M=qa(m),O=$o(p),w=$o(v),P=o.project(T,O),D=o.project(M,O),I=o.project(M,w),k=o.project(T,w);let N=Math.min(P.x,D.x,I.x,k.x),W=Math.min(P.y,D.y,I.y,k.y),Z=Math.max(P.x,D.x,I.x,k.x),ee=Math.max(P.y,D.y,I.y,k.y);const Q=c/16;function K(se,de,we,_e,xe,ke){const Se=(we+xe)/2,De=(_e+ke)/2,Ve=o.project(qa(Se),$o(De)),Fe=Math.max(0,N-Ve.x,W-Ve.y,Ve.x-Z,Ve.y-ee);N=Math.min(N,Ve.x),Z=Math.max(Z,Ve.x),W=Math.min(W,Ve.y),ee=Math.max(ee,Ve.y),Fe>Q&&(K(se,Ve,we,_e,Se,De),K(Ve,de,Se,De,xe,ke))}K(P,D,h,p,m,p),K(D,I,m,p,m,v),K(I,k,m,v,h,v),K(k,P,h,v,h,p),N-=Q,W-=Q,Z+=Q,ee+=Q;const ie=1/Math.max(Z-N,ee-W);return{scale:ie,x:N*ie,y:W*ie,x2:Z*ie,y2:ee*ie,projection:o}}function _V(d,{x:o,y:c},h=0){return new _t(((o-h)*d.scale-d.x)*Bt,(c*d.scale-d.y)*Bt)}const pue=ge.mat4.identity(new Float32Array(16));class Hf{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,c){return{x:0,y:0,z:0}}unproject(o,c){return new gn(0,0)}projectTilePoint(o,c,h){return{x:o,y:c,z:0}}locationPoint(o,c,h,m=!0){return o._coordinatePoint(o.locationCoordinate(c,h),m)}pixelsPerMeter(o,c){return Yo(1,o)*c}pixelSpaceConversion(o,c,h){return 1}farthestPixelDistance(o){return vV(o,o.pixelsPerMeter)}pointCoordinate(o,c,h,m){const p=o.horizonLineFromTop(!1),v=new _t(c,Math.max(p,h));return o.rayIntersectionCoordinate(o.pointRayIntersection(v,m))}pointCoordinate3D(o,c,h){const m=new _t(c,h);if(o.elevation)return o.elevation.pointCoordinate(m);{const p=this.pointCoordinate(o,m.x,m.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(o,c){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,c.x,c.y);const h=o.horizonLineFromTop();return c.y<h}createInversionMatrix(o,c){return pue}createTileMatrix(o,c,h){let m,p,v;const T=h.canonical,M=ge.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=D1(T,this);m=1,p=O.x+h.wrap*O.scale,v=O.y,ge.mat4.scale(M,M,[m/O.scale,m/O.scale,o.pixelsPerMeter/c])}else m=c/o.zoomScale(T.z),p=(T.x+Math.pow(2,T.z)*h.wrap)*m,v=T.y*m;return ge.mat4.translate(M,M,[p,v,0]),ge.mat4.scale(M,M,[m/Bt,m/Bt,1]),M}upVector(o,c,h){return[0,0,1]}upVectorScale(o,c,h){return{metersToTile:1}}}class mue extends Hf{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[c,h]=this.parallels=o.parallels||[29.5,45.5],m=Math.sin(Ge(c));this.n=(m+Math.sin(Ge(h)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(o,c){const{n:h,c:m,r0:p}=this,v=Ge(o-this.center[0]),T=Ge(c),M=Math.sqrt(m-2*h*Math.sin(T))/h;return{x:M*Math.sin(v*h),y:M*Math.cos(v*h)-p,z:0}}unproject(o,c){const{n:h,c:m,r0:p}=this,v=p+c;let T=Math.atan2(o,Math.abs(v))*Math.sign(v);v*h<0&&(T-=Math.PI*Math.sign(o)*Math.sign(v));const M=Ge(this.center[0])*h;T=fi(T,-Math.PI-M,Math.PI-M);const O=Kt(vt(T/h)+this.center[0],-180,180),w=Math.asin(Kt((m-(o*o+v*v)*h*h)/(2*h),-1,1)),P=Kt(vt(w),-ji,ji);return new gn(O,P)}}const L1=1.340264,N1=-.081106,z1=893e-6,j1=.003796,rA=Math.sqrt(3)/2;class gue extends Hf{project(o,c){c=c/180*Math.PI,o=o/180*Math.PI;const h=Math.asin(rA*Math.sin(c)),m=h*h,p=m*m*m;return{x:.5*(o*Math.cos(h)/(rA*(L1+3*N1*m+p*(7*z1+9*j1*m)))/Math.PI+.5),y:1-.5*(h*(L1+N1*m+p*(z1+j1*m))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,m=h*h,p=m*m*m;for(let w,P,D,I=0;I<12&&(P=h*(L1+N1*m+p*(z1+j1*m))-c,D=L1+3*N1*m+p*(7*z1+9*j1*m),w=P/D,h=Kt(h-w,-Math.PI/3,Math.PI/3),m=h*h,p=m*m*m,!(Math.abs(w)<1e-12));++I);const v=rA*o*(L1+3*N1*m+p*(7*z1+9*j1*m))/Math.cos(h),T=Math.asin(Math.sin(h)/rA),M=Kt(180*v/Math.PI,-180,180),O=Kt(180*T/Math.PI,-ji,ji);return new gn(M,O)}}class yue extends Hf{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){return{x:.5+o/360,y:.5-c/360,z:0}}unproject(o,c){const h=360*(o-.5),m=Kt(360*(.5-c),-ji,ji);return new gn(h,m)}}const Hv=Math.PI/2;function nA(d){return Math.tan((Hv+d)/2)}class vue extends Hf{constructor(o){super(o),this.center=o.center||[0,30];const[c,h]=this.parallels=o.parallels||[30,30];let m=Ge(c),p=Ge(h);this.southernCenter=m+p<0,this.southernCenter&&(m=-m,p=-p);const v=Math.cos(m),T=nA(m);this.n=m===p?Math.sin(m):Math.log(v/Math.cos(p))/Math.log(nA(p)/T),this.f=v*Math.pow(nA(m),this.n)/this.n}project(o,c){c=Ge(c),this.southernCenter&&(c=-c),o=Ge(o-this.center[0]);const h=1e-6,{n:m,f:p}=this;p>0?c<-Hv+h&&(c=-Hv+h):c>Hv-h&&(c=Hv-h);const v=p/Math.pow(nA(c),m);let T=v*Math.sin(m*o),M=p-v*Math.cos(m*o);return T=.5*(T/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:T,y:this.southernCenter?M:1-M,z:0}}unproject(o,c){o=(2*o-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:h,f:m}=this,p=m-c,v=Math.sign(p),T=Math.sign(h)*Math.sqrt(o*o+p*p);let M=Math.atan2(o,Math.abs(p))*v;p*h<0&&(M-=Math.PI*Math.sign(o)*v);const O=Kt(vt(M/h)+this.center[0],-180,180),w=Kt(vt(2*Math.atan(Math.pow(m/T,1/h))-Hv),-ji,ji);return new gn(O,this.southernCenter?-w:w)}}class xV extends Hf{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,c){return{x:oc(o),y:Ga(c),z:0}}unproject(o,c){const h=qa(o),m=$o(c);return new gn(h,m)}}const bV=Ge(ji);class _ue extends Hf{project(o,c){const h=(c=Ge(c))*c,m=h*h;return{x:.5*((o=Ge(o))*(.8707-.131979*h+m*(m*(.003971*h-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+h*(.015085+m*(.028874*h-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,m=25,p=0,v=h*h;do{v=h*h;const O=v*v;p=(h*(1.007226+v*(.015085+O*(.028874*v-.044475-.005916*O)))-c)/(1.007226+v*(.045255+O*(.259866*v-.311325-.005916*11*O))),h=Kt(h-p,-bV,bV)}while(Math.abs(p)>1e-6&&--m>0);v=h*h;const T=Kt(vt(o/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),M=vt(h);return new gn(T,M)}}const wV=Ge(ji);class xue extends Hf{project(o,c){c=Ge(c),o=Ge(o);const h=Math.cos(c),m=2/Math.PI,p=Math.acos(h*Math.cos(o/2)),v=Math.sin(p)/p,T=.5*(o*m+2*h*Math.sin(o/2)/v)||0,M=.5*(c+Math.sin(c)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(o,c){let h=o=(2*o-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,p=25;const v=1e-6;let T=0,M=0;do{const O=Math.cos(m),w=Math.sin(m),P=2*w*O,D=w*w,I=O*O,k=Math.cos(h/2),N=Math.sin(h/2),W=2*k*N,Z=N*N,ee=1-I*k*k,Q=ee?1/ee:0,K=ee?Math.acos(O*k)*Math.sqrt(1/ee):0,ie=.5*(2*K*O*N+2*h/Math.PI)-o,se=.5*(K*w+m)-c,de=.5*Q*(I*Z+K*O*k*D)+1/Math.PI,we=Q*(W*P/4-K*w*N),_e=.125*Q*(P*N-K*w*I*W),xe=.5*Q*(D*k+K*Z*O)+.5,ke=we*_e-xe*de;T=(se*we-ie*xe)/ke,M=(ie*_e-se*de)/ke,h=Kt(h-T,-Math.PI,Math.PI),m=Kt(m-M,-wV,wV)}while((Math.abs(T)>v||Math.abs(M)>v)&&--p>0);return new gn(vt(h),vt(m))}}class SV extends Hf{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ge(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){const{scale:h,cosPhi:m}=this;return{x:Ge(o)*m*h+.5,y:-Math.sin(Ge(c))/m*h+.5,z:0}}unproject(o,c){const{scale:h,cosPhi:m}=this,p=-(c-.5)/h,v=Kt(vt((o-.5)/h)/m,-180,180),T=Math.asin(Kt(p*m,-1,1)),M=Kt(vt(T),-ji,ji);return new gn(v,M)}}class bue extends xV{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,c,h){const m=vn(o,c,h),p=ti(ho(h));return ge.vec3.transformMat4(m,m,p),{x:m[0],y:m[1],z:m[2]}}locationPoint(o,c,h){const m=rh(c.lat,c.lng),p=ge.vec3.normalize([],m),v=h?o._centerAltitude+h:o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(c),o._centerAltitude):o._centerAltitude,T=Yo(1,0)*Bt*v;ge.vec3.scaleAndAdd(m,m,p,T);const M=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(M,o.pixelMatrix,o.globeMatrix),ge.vec3.transformMat4(m,m,M),new _t(m[0],m[1])}pixelsPerMeter(o,c){return Yo(1,0)*c}pixelSpaceConversion(o,c,h){const m=Yo(1,o)*c,p=_r(Yo(1,45)*c,m,h);return this.pixelsPerMeter(o,c)/p}createTileMatrix(o,c,h){const m=fo(ho(h.canonical));return ge.mat4.multiply(new Float64Array(16),o.globeMatrix,m)}createInversionMatrix(o,c){const{center:h}=o,m=ti(ho(c));return ge.mat4.rotateY(m,m,Ge(h.lng)),ge.mat4.rotateX(m,m,Ge(h.lat)),ge.mat4.scale(m,m,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(o,c,h,m){return cn(o,c,h,!0)||new s(0,0)}pointCoordinate3D(o,c,h){const m=this.pointCoordinate(o,c,h,0);return[m.x,m.y,m.z]}isPointAboveHorizon(o,c){return!cn(o,c.x,c.y,!1)}farthestPixelDistance(o){const c=function(m,p){const v=m.cameraToCenterDistance,T=m._centerAltitude*p,M=m._camera,O=m._camera.forward(),w=ge.vec3.add([],ge.vec3.scale([],O,-v),[0,0,T]),P=m.worldSize/(2*Math.PI),D=[0,0,-P],I=m.width/m.height,k=Math.tan(m.fovAboveCenter),N=ge.vec3.scale([],M.up(),k),W=ge.vec3.scale([],M.right(),k*I),Z=ge.vec3.normalize([],ge.vec3.add([],ge.vec3.add([],O,N),W)),ee=[];let Q;if(new Tr(w,Z).closestPointOnSphere(D,P,ee)){const K=ge.vec3.add([],ee,D),ie=ge.vec3.sub([],K,w);Q=Math.cos(m.fovAboveCenter)*ge.vec3.length(ie)}else{const K=ge.vec3.sub([],w,D),ie=ge.vec3.sub([],D,w);ge.vec3.normalize(ie,ie);const se=ge.vec3.length(K)-P;Q=Math.sqrt(se*(se+2*P));const de=Math.acos(Q/(P+se))-Math.acos(ge.vec3.dot(O,ie));Q*=Math.cos(de)}return 1.01*Q}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),h=Ra(o.zoom);if(h>0){const m=vV(o,Yo(1,o.center.lat)*o.worldSize),p=o.worldSize/(2*Math.PI),v=Math.max(o.width,o.height)/o.worldSize*Math.PI;return _r(c,m+p*(1-Math.cos(v)),Math.pow(h,10))}return c}upVector(o,c,h){return vn(c,h,o,1)}upVectorScale(o){return{metersToTile:on(Nn(ho(o)))}}}function TV(d){const o=d.parallels,c=!!o&&Math.abs(o[0]+o[1])<.01;switch(d.name){case"mercator":return new xV(d);case"equirectangular":return new yue(d);case"naturalEarth":return new _ue(d);case"equalEarth":return new gue(d);case"winkelTripel":return new xue(d);case"albers":return c?new SV(d):new mue(d);case"lambertConformalConic":return c?new SV(d):new vue(d);case"globe":return new bue(d)}throw new Error(`Invalid projection name: ${d.name}`)}const wue=Vf.VectorTileFeature.types,Sue=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function iA(d,o,c,h,m,p,v,T,M,O,w,P,D){const I=T?Math.min(qf,Math.round(T[0])):0,k=T?Math.min(qf,Math.round(T[1])):0;d.emplaceBack(o,c,Math.round(32*h),Math.round(32*m),p,v,(I<<1)+(M?1:0),k,16*O,16*w,256*P,256*D)}function oA(d,o,c){d.emplaceBack(o,c)}function aA(d,o,c,h,m,p,v){d.emplaceBack(o,c,h,m,p,v)}function sA(d,o,c,h,m){d.emplaceBack(o,c,h,m),d.emplaceBack(o,c,h,m),d.emplaceBack(o,c,h,m),d.emplaceBack(o,c,h,m)}function Tue(d){for(const o of d.sections)if(y2(o.text))return!0;return!1}class HD{constructor(o){this.layoutVertexArray=new e1,this.indexArray=new Bo,this.programConfigurations=o,this.segments=new si,this.dynamicLayoutVertexArray=new Qd,this.opacityVertexArray=new r1,this.placedSymbolArray=new A2,this.iconTransitioningVertexArray=new Yu,this.globeExtVertexArray=new t1,this.zOffsetVertexArray=new Jd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,c,h,m,p){this.isEmpty()||(h&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Fce.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,$ce.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Sue,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,Vce.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Bce.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||p)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Uce.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Jt(HD,"SymbolBuffers");class ZD{constructor(o,c,h){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new h,this.segments=new si,this.collisionVertexArray=new o1,this.collisionVertexArrayExt=new Qd}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,Wce.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,Gce.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Jt(ZD,"CollisionBuffers");class lA{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ge.mat4.identity([]),this.placementViewportMatrix=ge.mat4.identity([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ND(this.zoom,c["text-size"]),this.iconSizeData=ND(this.zoom,c["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),p=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(v=>ys[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new HD(new Ju(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new HD(new Ju(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new P2,this.lineVertexArray=new tg,this.symbolInstances=new C2}calculateGlyphDependencies(o,c,h,m,p){for(const v of o){const T=v.codePointAt(0);if(T===void 0)break;if(c[T]=!0,m&&p&&T<=65535){const M=P1[v];M&&(c[M.charCodeAt(0)]=!0)}}}updateFootprints(o,c){}updateReplacement(o,c){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const h=c.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!PD(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(o,c,h,m){const p=this.layers[0],v=p.layout,T=this.projection.name==="globe",M=v.get("text-font"),O=v.get("text-field"),w=v.get("icon-image"),[P,D]=v.get("icon-size-scale-range"),I=Kt(c.scaleFactor||1,P,D),k=(O.value.kind!=="constant"||O.value.value instanceof aa&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),N=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!k&&!N)return;const Z=c.iconDependencies,ee=c.glyphDependencies,Q=c.availableImages,K=new $n(this.zoom);for(const{feature:ie,id:se,index:de,sourceLayerIndex:we}of o){const _e=p._featureFilter.needGeometry,xe=V(ie,_e);if(!p._featureFilter.filter(K,xe,h))continue;if(_e||(xe.geometry=B(ie,h,m)),T&&ie.type!==1&&h.z<=5){const Fe=xe.geometry,Ze=.98078528056,He=(tt,Ke)=>{const nt=vn(tt.x,tt.y,h,1),Ct=vn(Ke.x,Ke.y,h,1);return ge.vec3.dot(nt,Ct)<Ze};for(let tt=0;tt<Fe.length;tt++)Fe[tt]=S(Fe[tt],He)}let ke,Se;if(k){const Fe=p.getValueAndResolveTokens("text-field",xe,h,Q),Ze=aa.factory(Fe);Tue(Ze)&&(this.hasRTLText=!0),(!this.hasRTLText||wv()==="unavailable"||this.hasRTLText&&$s.isParsed())&&(ke=Zce(Ze,p,xe))}if(N){const Fe=p.getValueAndResolveTokens("icon-image",xe,h,Q);Se=Fe instanceof sa?Fe:sa.build(Fe)}if(!ke&&!Se)continue;const De=this.sortFeaturesByKey?W.evaluate(xe,{},h):void 0,Ve={id:se,text:ke,icon:Se,index:de,sourceLayerIndex:we,geometry:xe.geometry,properties:ie.properties,type:wue[ie.type],sortKey:De};if(this.features.push(Ve),Se){const Fe=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Ze,iconSecondary:He}=pV(Se,this.iconSizeData,Fe["icon-size"],h,this.zoom,Ve,this.pixelRatio,I),tt=Ze.id.toString();if(Z.has(tt)?Z.get(tt).push(Ze):Z.set(tt,[Ze]),He){const Ke=He.id.toString();Z.has(Ke)?Z.get(Ke).push(He):Z.set(Ke,[He])}}if(ke){const Fe=M.evaluate(xe,{},h).join(","),Ze=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ys.vertical)>=0;for(const He of ke.sections)if(He.image){const tt=He.image.getPrimary().scaleSelf(this.pixelRatio),Ke=tt.id.toString(),nt=Z.get(Ke)||[];nt.push(tt),Z.set(Ke,nt)}else{const tt=Bb(ke.toString()),Ke=He.fontStack||Fe,nt=ee[Ke]=ee[Ke]||{};this.calculateGlyphDependencies(He.text,nt,Ze,this.allowVerticalPlacement,tt)}}}if(v.get("symbol-placement")==="line"&&(this.features=function(ie){const se={},de={},we=[];let _e=0;function xe(Ve){we.push(ie[Ve]),_e++}function ke(Ve,Fe,Ze){const He=de[Ve];return delete de[Ve],de[Fe]=He,we[He].geometry[0].pop(),we[He].geometry[0]=we[He].geometry[0].concat(Ze[0]),He}function Se(Ve,Fe,Ze){const He=se[Fe];return delete se[Fe],se[Ve]=He,we[He].geometry[0].shift(),we[He].geometry[0]=Ze[0].concat(we[He].geometry[0]),He}function De(Ve,Fe,Ze){const He=Ze?Fe[0][Fe[0].length-1]:Fe[0][0];return`${Ve}:${He.x}:${He.y}`}for(let Ve=0;Ve<ie.length;Ve++){const Fe=ie[Ve],Ze=Fe.geometry,He=Fe.text?Fe.text.toString():null;if(!He){xe(Ve);continue}const tt=De(He,Ze),Ke=De(He,Ze,!0);if(tt in de&&Ke in se&&de[tt]!==se[Ke]){const nt=Se(tt,Ke,Ze),Ct=ke(tt,Ke,we[nt].geometry);delete se[tt],delete de[Ke],de[De(He,we[Ct].geometry,!0)]=Ct,we[nt].geometry=null}else tt in de?ke(tt,Ke,Ze):Ke in se?Se(tt,Ke,Ze):(xe(Ve),se[tt]=_e-1,de[Ke]=_e-1)}return we.filter(Ve=>Ve.geometry)}(this.features)),v.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",c.elevationFeatures){!this.elevationFeatures&&c.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ie of c.elevationFeatures)this.elevationFeatureIdToIndex.set(ie.id,this.elevationFeatures.length),this.elevationFeatures.push(ie)}}else v.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ie,se)=>ie.sortKey-se.sortKey)}update(o,c,h,m,p,v,T){this.text.programConfigurations.updatePaintArrays(o,c,p,h,m,v,T),this.icon.programConfigurations.updatePaintArrays(o,c,p,h,m,v,T)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);if(h.elevationFeatureIndex===65535)continue;const m=this.elevationFeatures[h.elevationFeatureIndex];if(m){const p=.05+m.pointElevation(new _t(h.tileAnchorX,h.tileAnchorY));h.zOffset!==p&&(o=!0,h.zOffset=p)}}o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const o=(p,v,T)=>{h+=v,h>p.length&&p.resize(h);for(let M=-v;M<0;M++)p.emplace(M+h,T)},c=(p,v,T)=>{m+=v,m>p.length&&p.resize(m);for(let M=-v;M<0;M++)p.emplace(M+m,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,m=0;for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:M,numIconVertices:O}=v,w=v.zOffset,P=O>0;if((T>0||M>0)&&(o(this.text.zOffsetVertexArray,T,w),o(this.text.zOffsetVertexArray,M,w)),P){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:I}=v;D>=0&&c(this.icon.zOffsetVertexArray,O,w),I>=0&&c(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=TV(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const h=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:m,y:p}of c)this.lineVertexArray.emplaceBack(m,p);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(o,c,h,m,p,v,T,M,O,w,P,D,I,k,N,W){const Z=o.indexArray,ee=o.layoutVertexArray,Q=o.globeExtVertexArray,K=o.segments.prepareSegment(4*c.length,ee,Z,this.canOverlap?v.sortKey:void 0),ie=this.glyphOffsetArray.length,se=K.vertexLength,de=this.allowVerticalPlacement&&T===ys.vertical?Math.PI/2:0,we=v.text&&v.text.sections;for(let xe=0;xe<c.length;xe++){const{tl:ke,tr:Se,bl:De,br:Ve,texPrimary:Fe,texSecondary:Ze,pixelOffsetTL:He,pixelOffsetBR:tt,minFontScaleX:Ke,minFontScaleY:nt,glyphOffset:Ct,isSDF:At,sectionIndex:Qt}=c[xe],Rt=K.vertexLength,Ft=Ct[1];if(iA(ee,O.x,O.y,ke.x,Ft+ke.y,Fe.x,Fe.y,h,At,He.x,He.y,Ke,nt),iA(ee,O.x,O.y,Se.x,Ft+Se.y,Fe.x+Fe.w,Fe.y,h,At,tt.x,He.y,Ke,nt),iA(ee,O.x,O.y,De.x,Ft+De.y,Fe.x,Fe.y+Fe.h,h,At,He.x,tt.y,Ke,nt),iA(ee,O.x,O.y,Ve.x,Ft+Ve.y,Fe.x+Fe.w,Fe.y+Fe.h,h,At,tt.x,tt.y,Ke,nt),M){const{x:It,y:yr,z:Zt}=M.anchor,[nr,Er,Vr]=M.up;aA(Q,It,yr,Zt,nr,Er,Vr),aA(Q,It,yr,Zt,nr,Er,Vr),aA(Q,It,yr,Zt,nr,Er,Vr),aA(Q,It,yr,Zt,nr,Er,Vr),sA(o.dynamicLayoutVertexArray,It,yr,Zt,de)}else sA(o.dynamicLayoutVertexArray,O.x,O.y,O.z,de);if(W){const It=Ze||Fe;oA(o.iconTransitioningVertexArray,It.x,It.y),oA(o.iconTransitioningVertexArray,It.x+It.w,It.y),oA(o.iconTransitioningVertexArray,It.x,It.y+It.h),oA(o.iconTransitioningVertexArray,It.x+It.w,It.y+It.h)}Z.emplaceBack(Rt,Rt+1,Rt+2),Z.emplaceBack(Rt+1,Rt+2,Rt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ct[0]),xe!==c.length-1&&Qt===c[xe+1].sectionIndex||o.programConfigurations.populatePaintArrays(ee.length,v,v.index,{},I,k,N,we&&we[Qt])}const _e=M?M.anchor:O;o.placedSymbolArray.emplaceBack(_e.x,_e.y,_e.z,O.x,O.y,ie,this.glyphOffsetArray.length-ie,se,w,P,O.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],T,0,!1,0,D,0)}_commitLayoutVertex(o,c,h,m,p,v,T){o.emplaceBack(c,h,m,p,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(o,c,h,m,p,v,T){const M=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),O=M.vertexLength,w=T.tileAnchorX,P=T.tileAnchorY;for(let I=0;I<4;I++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,c,o.padding,T.zOffset),this._commitLayoutVertex(h.layoutVertexArray,m,p,v,w,P,new _t(o.x1,o.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,p,v,w,P,new _t(o.x2,o.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,p,v,w,P,new _t(o.x2,o.y2)),this._commitLayoutVertex(h.layoutVertexArray,m,p,v,w,P,new _t(o.x1,o.y2)),M.vertexLength+=4;const D=h.indexArray;D.emplaceBack(O,O+1),D.emplaceBack(O+1,O+2),D.emplaceBack(O+2,O+3),D.emplaceBack(O+3,O),M.primitiveLength+=4}_addTextDebugCollisionBoxes(o,c,h,m,p,v){for(let T=m;T<p;T++){const M=h.get(T),O=this.getSymbolInstanceTextSize(o,v,c,T);this._addCollisionDebugVertices(M,O,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(o,c,h,m,p,v){for(let T=m;T<p;T++){const M=h.get(T),O=this.getSymbolInstanceIconSize(o,c,v.placedIconSymbolIndex);this._addCollisionDebugVertices(M,O,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,v)}}generateCollisionDebugBuffers(o,c,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ZD(Jm,B6.members,Yu),this.iconCollisionBox=new ZD(Jm,B6.members,Yu);const m=Uv(this.iconSizeData,o),p=Uv(this.textSizeData,o,h);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(p,o,c,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(p,o,c,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,o,c,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,o,c,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(o,c,h,m){const p=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),v=X2(this.textSizeData,o,p)/Jo;return this.tilePixelRatio*v}getSymbolInstanceIconSize(o,c,h){const m=this.icon.placedSymbolArray.get(h),p=X2(this.iconSizeData,o,m);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(o,c,h,m){o.emplaceBack(c,-h,-h,m),o.emplaceBack(c,h,-h,m),o.emplaceBack(c,h,h,m),o.emplaceBack(c,-h,h,m)}_updateTextDebugCollisionBoxes(o,c,h,m,p,v,T){for(let M=m;M<p;M++){const O=h.get(M),w=this.getSymbolInstanceTextSize(o,v,c,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,O.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(o,c,h,m,p,v,T){for(let M=m;M<p;M++){const O=h.get(M),w=this.getSymbolInstanceIconSize(o,c,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,O.padding,v.zOffset)}}updateCollisionDebugBuffers(o,c,h,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=Uv(this.iconSizeData,o,m),v=Uv(this.textSizeData,o,h);for(let T=0;T<this.symbolInstances.length;T++){const M=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(v,o,c,M.textBoxStartIndex,M.textBoxEndIndex,M,h),this._updateTextDebugCollisionBoxes(v,o,c,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M,h),this._updateIconDebugCollisionBoxes(p,o,c,M.iconBoxStartIndex,M.iconBoxEndIndex,M,m),this._updateIconDebugCollisionBoxes(p,o,c,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,c,h,m,p,v,T,M,O){const w={};if(c<h){const{x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K,featureIndex:ie}=o.get(c);w.textBox={x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K},w.textFeatureIndex=ie}if(m<p){const{x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K,featureIndex:ie}=o.get(m);w.verticalTextBox={x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K},w.verticalTextFeatureIndex=ie}if(v<T){const{x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K,featureIndex:ie}=o.get(v);w.iconBox={x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K},w.iconFeatureIndex=ie}if(M<O){const{x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K,featureIndex:ie}=o.get(M);w.verticalIconBox={x1:P,y1:D,x2:I,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:Z,projectedAnchorZ:ee,tileAnchorX:Q,tileAnchorY:K},w.verticalIconFeatureIndex=ie}return w}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,c){const h=o.placedSymbolArray.get(c),m=h.vertexStartIndex+4*h.numGlyphs;for(let p=h.vertexStartIndex;p<m;p+=4)o.indexArray.emplaceBack(p,p+1,p+2),o.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(o),h=Math.cos(o),m=[],p=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const M=this.symbolInstances.get(T);m.push(0|Math.round(c*M.tileAnchorX+h*M.tileAnchorY)),p.push(M.featureIndex)}return v.sort((T,M)=>m[T]-m[M]||p[M]-p[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,c)=>this.symbolInstances.get(c).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,c){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===c?h.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const h=this.symbolInstances.get(c);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:O}=h;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),p>=0&&p!==m&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let EV,AV,XD;Jt(lA,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),lA.addDynamicAttributes=sA;class MV{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:sf,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Jt(MV,"FormatSectionOverride",{omit:["defaultValue"]});const YD=()=>XD||(XD={layout:EV||(EV=new bi({"symbol-placement":new zt(it.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(it.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(it.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yt(it.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(it.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new zt(it.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new zt(it.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new zt(it.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new zt(it.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(it.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(it.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yt(it.layout_symbol["icon-size"]),"icon-size-scale-range":new zt(it.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Yt(it.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Yt(it.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yt(it.layout_symbol["icon-image"]),"icon-rotate":new Yt(it.layout_symbol["icon-rotate"]),"icon-padding":new zt(it.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(it.layout_symbol["icon-keep-upright"]),"icon-offset":new Yt(it.layout_symbol["icon-offset"]),"icon-anchor":new Yt(it.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(it.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(it.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(it.layout_symbol["text-rotation-alignment"]),"text-field":new Yt(it.layout_symbol["text-field"]),"text-font":new Yt(it.layout_symbol["text-font"]),"text-size":new Yt(it.layout_symbol["text-size"]),"text-size-scale-range":new zt(it.layout_symbol["text-size-scale-range"]),"text-max-width":new Yt(it.layout_symbol["text-max-width"]),"text-line-height":new Yt(it.layout_symbol["text-line-height"]),"text-letter-spacing":new Yt(it.layout_symbol["text-letter-spacing"]),"text-justify":new Yt(it.layout_symbol["text-justify"]),"text-radial-offset":new Yt(it.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(it.layout_symbol["text-variable-anchor"]),"text-anchor":new Yt(it.layout_symbol["text-anchor"]),"text-max-angle":new zt(it.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(it.layout_symbol["text-writing-mode"]),"text-rotate":new Yt(it.layout_symbol["text-rotate"]),"text-padding":new zt(it.layout_symbol["text-padding"]),"text-keep-upright":new zt(it.layout_symbol["text-keep-upright"]),"text-transform":new Yt(it.layout_symbol["text-transform"]),"text-offset":new Yt(it.layout_symbol["text-offset"]),"text-allow-overlap":new zt(it.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new zt(it.layout_symbol["text-ignore-placement"]),"text-optional":new zt(it.layout_symbol["text-optional"]),visibility:new zt(it.layout_symbol.visibility)})),paint:AV||(AV=new bi({"icon-opacity":new Yt(it.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Yt(it.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Yt(it.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Yt(it.paint_symbol["text-emissive-strength"]),"icon-color":new Yt(it.paint_symbol["icon-color"]),"icon-halo-color":new Yt(it.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yt(it.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yt(it.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(it.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(it.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Yt(it.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Yt(it.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Yt(it.paint_symbol["text-occlusion-opacity"]),"text-color":new Yt(it.paint_symbol["text-color"],{runtimeType:oa,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Yt(it.paint_symbol["text-halo-color"]),"text-halo-width":new Yt(it.paint_symbol["text-halo-width"]),"text-halo-blur":new Yt(it.paint_symbol["text-halo-blur"]),"text-translate":new zt(it.paint_symbol["text-translate"]),"text-translate-anchor":new zt(it.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new zt(it.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new zt(it.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new zt(it.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new zt(it.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Yt(it.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},XD);class cA extends ko{constructor(o,c,h,m){super(o,YD(),c,h,m),this._colorAdjustmentMatrix=ge.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,c){super.recalculate(o,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const p of h)m.indexOf(p)<0&&m.push(p);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,c,h,m){return this._saturation===o&&this._contrast===c&&this._brightnessMin===h&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(p,v,T,M){p=mt(p),v=Cm(v);const O=ge.mat4.create(),w=p/3,P=1-2*w,D=[P,w,w,0,w,P,w,0,w,w,P,0,0,0,0,1],I=.5-.5*v,k=M-T;return ge.mat4.multiply(O,[k,0,0,0,0,k,0,0,0,0,k,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,I,I,I,1]),ge.mat4.multiply(O,O,D),O}(o,c,h,m),this._saturation=o,this._contrast=c,this._brightnessMin=h,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,c,h,m){const p=this.layout.get(o).evaluate(c,{},h,m),v=this._unevaluatedLayout._values[o];return v.isDataDriven()||mv(v.value)||!p?p:function(T,M){return M.replace(/{([^{}]+)}/g,(O,w)=>w in T?String(T[w]):"")}(c.properties,p)}createBucket(o){return new lA(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of YD().paint.overridableProperties){if(!cA.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),h=new MV(c),m=new Lb(h,c.property.specification,this.scope,this.options);let p=null;p=c.value.kind==="constant"||c.value.kind==="source"?new Nb("source",m):new Ef("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[o]=new If(c.property,p,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,h){return!(!this.layout||c.isDataDriven()||h.isDataDriven())&&cA.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const h=o.get("text-field"),m=YD().paint.properties[c];let p=!1;const v=T=>{for(const M of T)if(m.overrides&&m.overrides.hasOverride(M))return void(p=!0)};if(h.value.kind==="constant"&&h.value.value instanceof aa)v(h.value.value.sections);else if(h.value.kind==="source"){const T=O=>{p||(O instanceof Nc&&no(O.value)===Om?v(O.value.sections):O instanceof df?v(O.sections):O.eachChild(T))},M=h.value;M._styleExpression&&T(M._styleExpression.expression)}return p}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,c,h){return{config:new th(this,{zoom:c,lut:h}),overrideFog:!1}}}let CV,PV,IV,OV;var KD=mn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function JD(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function QD(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class eL{constructor(o,c,h,m){this.context=o,this.format=h,this.useMipmap=m&&m.useMipmap,this.texture=o.gl.createTexture(),this.update(c,{premultiply:m&&m.premultiply})}update(o,c){const h=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,m=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:p}=this,{gl:v}=p,{x:T,y:M}=c&&c.position?c.position:{x:0,y:0},O=T+h,w=M+m;!this.size||this.size[0]===O&&this.size[1]===w||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!c||c.premultiply!==!1));const P=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&O>0&&w>0){const D=this.useMipmap?Math.floor(Math.log2(Math.max(O,w)))+1:1;v.texStorage2D(v.TEXTURE_2D,D,this.format,O,w),this.size=[O,w]}if(this.size)if(P)v.texSubImage2D(v.TEXTURE_2D,0,T,M,JD(this.format),QD(this.format),o);else{const D=o.data;D&&v.texSubImage2D(v.TEXTURE_2D,0,T,M,h,m,JD(this.format),QD(this.format),D)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(o,c,h=!1){const{context:m}=this,{gl:p}=m;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap&&!h?o===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),c!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,c),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,c),this.wrapS=c)}bindExtraParam(o,c,h,m){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),c!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,c),this.magFilter=c),o!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?o===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),h!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,h),this.wrapS=h),m!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class uA{constructor(o,c){this.context=o,this.texture=c}bind(o,c){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,o),this.minFilter=o),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrapS=c)}}function dA(d,o,c,h,m,p,v,T){const M=[d,o,1,c,h,1,m,p,1],O=[v,T,1],w=ge.mat3.adjoint([],M),[P,D,I]=ge.vec3.transformMat3(O,O,w);return ge.mat3.multiply(M,M,[P,0,0,0,D,0,0,0,I])}function kV(d,o,c,h,m,p,v,T){const M=function(O,w,P,D,I,k,N,W){const Z=dA(0,0,1,0,1,1,0,1),ee=dA(O,w,P,D,I,k,N,W),Q=ge.mat3.adjoint([],Z);return ge.mat3.multiply(ee,ee,Q)}(d,o,c,h,m,p,v,T);return[M[2]/M[8]/Bt,M[5]/M[8]/Bt]}function hA(d){return[d[0],Math.min(Math.max(d[1],-ji),ji)]}class RV extends xl{constructor(o,c,h,m){super(),this.id=o,this.dispatcher=h,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=c,this._dirty=!1}load(o,c){if(this._loaded=c||!1,this.fire(new Ua("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=nb(this.map._requestManager.transformRequest(this.url,Io.Image),(h,m)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new af(h)):m&&(this.image=m instanceof HTMLImageElement?pt.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new uA(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ua("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof uA||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let c=o[0][1],h=o[0][1];for(const p of o)p[1]>h&&(h=p[1]),p[1]<c&&(c=p[1]);const m=(h+c)/2;if(m>ji?this.onNorthPole=!0:m<-ji&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const p=o.map(s.fromLngLat);this.tileID=function(v){let T=1/0,M=1/0,O=-1/0,w=-1/0;for(const N of v)T=Math.min(T,N.x),M=Math.min(M,N.y),O=Math.max(O,N.x),w=Math.max(w,N.y);const P=Math.max(O-T,w-M),D=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),I=Math.pow(2,D);let k=Math.floor((T+O)/2*I);return k>1&&(k-=1),new Et(D,k,Math.floor((M+w)/2*I))}(p),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ua("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const Z in this.tiles){const ee=this.tiles[Z];ee.state!=="loaded"&&(ee.state="loaded",ee.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const c=D1(new Et(0,0,0),this.map.transform.projection),h=[c.projection.project(this.coordinates[0][0],this.coordinates[0][1]),c.projection.project(this.coordinates[1][0],this.coordinates[1][1]),c.projection.project(this.coordinates[2][0],this.coordinates[2][1]),c.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Z){const ee=Z[1].x-Z[0].x,Q=Z[1].y-Z[0].y,K=Z[2].x-Z[1].x,ie=Z[2].y-Z[1].y,se=Z[3].x-Z[2].x,de=Z[3].y-Z[2].y,we=Z[0].x-Z[3].x,_e=Z[0].y-Z[3].y,xe=ee*ie-K*Q,ke=K*de-se*ie,Se=se*_e-we*de,De=we*Q-ee*_e;return xe>0&&ke>0&&Se>0&&De>0||xe<0&&ke<0&&Se<0&&De<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=D1(this.tileID,this.map.transform.projection),[p,v,T,M]=this.coordinates.map(Z=>{const ee=m.projection.project(Z[0],Z[1]);return _V(m,ee)._round()});this.perspectiveTransform=kV(p.x,p.y,v.x,v.y,T.x,T.y,M.x,M.y);const O=this._boundsArray=new qc;O.emplaceBack(p.x,p.y,0,0),O.emplaceBack(v.x,v.y,Bt,0),O.emplaceBack(M.x,M.y,0,Bt),O.emplaceBack(T.x,T.y,Bt,Bt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(O,KD.members),this.boundsSegments=si.simpleSegment(0,0,4,2);const w=[],P=[hA((D=this.coordinates)[0]),hA(D[1]),hA(D[2]),hA(D[3])];var D;const[I,k,N,W]=function(Z){let ee=Z[0][0],Q=ee,K=Z[0][1],ie=K;for(let se=1;se<Z.length;se++)Z[se][0]<ee?ee=Z[se][0]:Z[se][0]>Q&&(Q=Z[se][0]),Z[se][1]<K?K=Z[se][1]:Z[se][1]>ie&&(ie=Z[se][1]);return[ee,K,Q-ee,ie-K]}(P);{const Z=new qc,[ee,Q,K,ie]=function(He){let tt=He[0].x,Ke=tt,nt=He[0].y,Ct=nt;for(let At=1;At<He.length;At++)He[At].x<tt?tt=He[At].x:He[At].x>Ke&&(Ke=He[At].x),He[At].y<nt?nt=He[At].y:He[At].y>Ct&&(Ct=He[At].y);return[tt,nt,Ke-tt,Ct-nt]}(h),se=He=>[(He.x-ee)/K,(He.y-Q)/ie],[de,we,_e,xe]=h.map(se),ke=function(He,tt,Ke,nt,Ct,At,Qt,Rt){const Ft=dA(0,0,1,0,1,1,0,1),It=dA(He,tt,Ke,nt,Ct,At,Qt,Rt),yr=ge.mat3.adjoint([],It);return ge.mat3.multiply(Ft,Ft,yr)}(de[0],de[1],we[0],we[1],_e[0],_e[1],xe[0],xe[1]);this.elevatedGlobePerspectiveTransform=kV(de[0],de[1],we[0],we[1],_e[0],_e[1],xe[0],xe[1]);const Se=(He,tt)=>{w.push(He.lng);const Ke=Math.round((He.lng-I)/N*Bt),nt=Math.round((He.lat-k)/W*Bt),Ct=se(tt),At=ge.vec3.transformMat3([],[Ct[0],Ct[1],1],ke),Qt=Math.round(At[0]/At[2]*Bt),Rt=Math.round(At[1]/At[2]*Bt);Z.emplaceBack(Ke,nt,Qt,Rt)},De=h[3].x-h[0].x,Ve=h[3].y-h[0].y,Fe=h[2].x-h[1].x,Ze=h[2].y-h[1].y;for(let He=0;He<65;He++){const tt=He/64,Ke=[h[0].x+tt*De,h[0].y+tt*Ve],nt=[h[1].x+tt*Fe,h[1].y+tt*Ze],Ct=nt[0]-Ke[0],At=nt[1]-Ke[1];for(let Qt=0;Qt<65;Qt++){const Rt=Qt/64,Ft={x:Ke[0]+Ct*Rt,y:Ke[1]+At*Rt,z:0};Se(c.projection.unproject(Ft.x,Ft.y),Ft)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(Z,KD.members)}{this.maxLongitudeTriangleSize=0;let Z=[],ee=new Bo;const Q=(K,ie,se)=>{ee.emplaceBack(K,ie,se);const de=w[K],we=w[ie],_e=w[se],xe=Math.min(Math.min(de,we),_e),ke=Math.max(Math.max(de,we),_e)-xe;ke>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ke),Z.push(xe+ke/2)};for(let K=0;K<64;K++)for(let ie=0;ie<64;ie++){const se=65*K+ie,de=se+1,we=se+65,_e=we+1;Q(se,we,de),Q(de,we,_e)}[Z,ee]=function(K,ie){const se=Array.from({length:K.length},(_e,xe)=>xe);se.sort((_e,xe)=>K[_e]-K[xe]);const de=[],we=new Bo;for(let _e=0;_e<se.length;_e++){const xe=se[_e];de.push(K[xe]);const ke=3*xe,Se=ke+1;we.emplaceBack(ie.uint16[ke],ie.uint16[Se],ie.uint16[Se+1])}return[de,we]}(Z,ee),this.elevatedGlobeTrianglesCenterLongitudes=Z,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(ee)}this.elevatedGlobeSegments=si.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,N/Bt,0,W/Bt,0,0,k,I,0])}prepare(){const o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;const c=this.map.painter.context,h=c.gl;!this._dirty||this.texture instanceof uA||(this.texture?this.texture.update(this.image):(this.texture=new eL(c,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(c)}loadTile(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const c=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!c)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let m=(p=o+180)+360*Math.round((h[0]-p)/360);var p;const v=new si,T=(P,D)=>{v.segments.push({vertexOffset:0,primitiveOffset:P,vertexLength:c.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},M=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-m)<=M){const P=Gy(h,0,h.length,m+M);return P===h.length||T(P,Wy(h,P+1,h.length,m+360-M)-P),v}m<h[0]&&(m+=360);const O=Wy(h,0,h.length,m-M);if(O===h.length)return T(0,h.length),v;T(0,O-0);const w=Gy(h,O+1,h.length,m+M);return w!==h.length&&T(w,h.length-w),v}}const Eue=(Math.pow(256,2)-1)/16907520;class DV extends ko{constructor(o,c,h,m){super(o,{layout:IV||(IV=new bi({visibility:new zt(it.layout_raster.visibility)})),paint:OV||(OV=new bi({"raster-opacity":new zt(it.paint_raster["raster-opacity"]),"raster-color":new kf(it.paint_raster["raster-color"]),"raster-color-mix":new zt(it.paint_raster["raster-color-mix"]),"raster-color-range":new zt(it.paint_raster["raster-color-range"]),"raster-hue-rotate":new zt(it.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(it.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(it.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(it.paint_raster["raster-saturation"]),"raster-contrast":new zt(it.paint_raster["raster-contrast"]),"raster-resampling":new zt(it.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(it.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new zt(it.paint_raster["raster-emissive-strength"]),"raster-array-band":new zt(it.paint_raster["raster-array-band"]),"raster-elevation":new zt(it.paint_raster["raster-elevation"]),"raster-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},c,h,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof RV&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const c=this._transitionablePaint._values["raster-color"].value.expression,[h,m]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(m)||h===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=_1({expression:c,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,m])}}let LV,NV,zV,jV,FV;class BV extends ko{constructor(o,c,h,m){super(o,{layout:LV||(LV=new bi({visibility:new zt(it["layout_raster-particle"].visibility)})),paint:NV||(NV=new bi({"raster-particle-array-band":new zt(it["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new zt(it["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new kf(it["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new zt(it["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new zt(it["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new zt(it["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new zt(it["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new zt(it["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},c,h,m),this._updateColorRamp(),this.lastInvalidatedAt=pt.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,c=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=_1({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:c}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=pt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Aue extends ko{constructor(o,c){super(o,{},c,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(o){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function tL(d,o,c){const h=[0,0,1],m=ge.quat.identity([]);return ge.quat.rotateY(m,m,c?-Ge(d)+Math.PI:Ge(d)),ge.quat.rotateX(m,m,-Ge(o)),ge.vec3.transformQuat(h,h,m),ge.vec3.normalize(h,h)}function $V(d,o){const c=fA(d.projection,d.zoom,d.width,d.height),h=function(p,v,T,M,O){const w=new gn(T.lng-180*Zf,T.lat),P=new gn(T.lng+180*Zf,T.lat),D=p.project(w.lng,w.lat),I=p.project(P.lng,P.lat),k=-Math.atan2(I.y-D.y,I.x-D.x),N=s.fromLngLat(T);N.y=Kt(N.y,-1+Zf,1-Zf);const W=N.toLngLat(),Z=p.project(W.lng,W.lat),ee=s.fromLngLat(W);ee.x+=Zf;const Q=ee.toLngLat(),K=p.project(Q.lng,Q.lat),ie=VV(K.x-Z.x,K.y-Z.y,k),se=s.fromLngLat(W);se.y+=Zf;const de=se.toLngLat(),we=p.project(de.lng,de.lat),_e=VV(we.x-Z.x,we.y-Z.y,k),xe=Math.abs(ie.x)/Math.abs(_e.y),ke=ge.mat4.identity([]);ge.mat4.rotateZ(ke,ke,-k*(1-(O?0:M)));const Se=ge.mat4.identity([]);return ge.mat4.scale(Se,Se,[1,1-(1-xe)*M,1]),Se[4]=-_e.x/_e.y*M,ge.mat4.rotateZ(Se,Se,k),ge.mat4.multiply(Se,ke,Se),Se}(d.projection,0,d.center,c,o),m=UV(d);return ge.mat4.scale(h,h,[m,m,1]),h}function UV(d){const o=d.projection,c=fA(d.projection,d.zoom,d.width,d.height),h=rL(o,d.center),m=rL(o,gn.convert(o.center));return Math.pow(2,h*c+(1-c)*m)}function fA(d,o,c,h,m=1/0){const p=d.range;if(!p)return 0;const v=Math.min(m,Math.max(c,h)),T=Math.log(v/1024)/Math.LN2;return Zr(p[0]+T,p[1]+T,o)}const Zf=1/4e4;function rL(d,o){const c=Kt(o.lat,-ji,ji),h=new gn(o.lng-180*Zf,c),m=new gn(o.lng+180*Zf,c),p=d.project(h.lng,c),v=d.project(m.lng,c),T=s.fromLngLat(h),M=s.fromLngLat(m),O=v.x-p.x,w=v.y-p.y,P=M.x-T.x,D=M.y-T.y,I=Math.sqrt((P*P+D*D)/(O*O+w*w));return Math.log(I)/Math.LN2}function VV(d,o,c){const h=Math.cos(c),m=Math.sin(c);return{x:d*h-o*m,y:d*m+o*h}}function WV(d,o,c){ge.mat4.identity(d),ge.mat4.rotateZ(d,d,Ge(o[2])),ge.mat4.rotateX(d,d,Ge(o[0])),ge.mat4.rotateY(d,d,Ge(o[1])),ge.mat4.scale(d,d,c),ge.mat4.multiply(d,d,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function pA(d,o,c,h,m,p,v,T){const M=[c[0]-o[0],c[1]-o[1],0],O=[h[0]-o[0],h[1]-o[1],0];if(ge.vec3.length(M)<1e-12||ge.vec3.length(O)<1e-12)return ge.quat.identity(d);const w=ge.vec3.cross([],M,O);ge.vec3.normalize(w,w),ge.vec3.subtract(O,h,o),M[2]=(p-m)*T,O[2]=(v-m)*T;const P=M;return ge.vec3.cross(P,M,O),ge.vec3.normalize(P,P),ge.quat.rotationTo(d,w,P)}function nL(d,o,c=!1){const h=Ra(o.zoom),m=function(p,v,T){const M=v.worldSize,O=[p[12],p[13],p[14]],w=$o(O[1]/M),P=qa(O[0]/M),D=ge.mat4.identity([]),I=Yo(1,w)*M,k=Yo(1,0)*M*ed(w,v.zoom),N=1/ac(M);let W=k*N;if(T){const K=fA(v.projection,v.zoom,v.width,v.height,1024);W=N*v.projection.pixelSpaceConversion(v.center.lat,M,K)}const Z=rh(w,P);ge.vec3.add(Z,Z,ge.vec3.scale([],ge.vec3.normalize([],Z),I*W*O[2]));const ee=function(K){const ie=[K[0],K[1],K[2]];let se=[0,1,0];const de=ge.vec3.cross([],se,ie);return ge.vec3.cross(se,ie,de),ge.vec3.squaredLength(se)===0&&(se=[0,1,0],ge.vec3.cross(de,ie,se)),ge.vec3.normalize(de,de),ge.vec3.normalize(se,se),ge.vec3.normalize(ie,ie),[de[0],de[1],de[2],0,se[0],se[1],se[2],0,ie[0],ie[1],ie[2],0,K[0],K[1],K[2],1]}(Z);ge.mat4.scale(D,D,[W,W,W*I]),ge.mat4.translate(D,D,[-O[0],-O[1],-O[2]]);const Q=ge.mat4.multiply([],v.globeMatrix,ee);return ge.mat4.multiply(Q,Q,D),ge.mat4.multiply(Q,Q,p),Q}(d,o,c);if(h>0){const p=function(v,T){const M=T.worldSize,O=Yo(1,0)*M*ed(T.center.lat,T.zoom)/ac(M),w=Yo(1,T.center.lat)*M,P=ge.mat4.identity([]);return ge.mat4.rotateY(P,P,Ge(T.center.lng)),ge.mat4.rotateX(P,P,Ge(T.center.lat)),ge.mat4.translate(P,P,[0,0,ba]),ge.mat4.scale(P,P,[O,O,O*w]),ge.mat4.translate(P,P,[T.point.x-.5*M,T.point.y-.5*M,0]),ge.mat4.multiply(P,P,v),ge.mat4.multiply(P,T.globeMatrix,P)}(d,o);return function(v,T,M){const O=(k,N,W)=>{const Z=ge.vec3.length(k),ee=ge.vec3.length(N),Q=_o(k,N,W);return ge.vec3.scale(Q,Q,1/ge.vec3.length(Q)*_r(Z,ee,W))},w=O([v[0],v[1],v[2]],[T[0],T[1],T[2]],M),P=O([v[4],v[5],v[6]],[T[4],T[5],T[6]],M),D=O([v[8],v[9],v[10]],[T[8],T[9],T[10]],M),I=_o([v[12],v[13],v[14]],[T[12],T[13],T[14]],M);return[w[0],w[1],w[2],0,P[0],P[1],P[2],0,D[0],D[1],D[2],0,I[0],I[1],I[2],1]}(m,p,h)}return m}function GV(d,o,c,h){const m=or.projectAabbCorners(h,c);let p=Number.MAX_VALUE,v=-1;for(let O=0;O<m.length;++O){const w=m[O];w[0]=(.5*w[0]+.5)*o.width,w[1]=(.5-.5*w[1])*o.height,w[2]<p&&(v=O,p=w[2])}const T=O=>new _t(m[O][0],m[O][1]);let M;switch(v){case 0:case 6:M=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:M=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:M=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:M=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(ce(d,M))return p}const Mue=mn([{name:"a_pos_3f",components:3,type:"Float32"}]),Cue=mn([{name:"a_color_3f",components:3,type:"Float32"}]),Pue=mn([{name:"a_color_4f",components:4,type:"Float32"}]),Iue=mn([{name:"a_uv_2f",components:2,type:"Float32"}]),Oue=mn([{name:"a_normal_3f",components:3,type:"Float32"}]),kue=mn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Rue=mn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),qV={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class mA{constructor(o,c,h,m){this.message=(o?`${o}: `:"")+h,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function HV(d,o){const c=d.indexOf("://")===-1;try{return new URL(d,c&&o?"http://example.com":void 0),!0}catch{return!1}}class ZV{constructor(o,c){this.feature=o,this.instancedDataOffset=c,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class XV{constructor(){this.instancedDataArray=new Rv,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class iL{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(o,c){}populate(o,c,h,m){this.tileToMeter=y(h);const p=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:M,sourceLayerIndex:O}of o){const w=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),P=V(v,p);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),P,h))continue;const D={id:w,sourceLayerIndex:O,index:M,geometry:p?P.geometry:B(v,h,m),properties:v.properties,type:v.type,patterns:{}},I=this.addFeature(D,D.geometry,P);I&&c.featureIndex.insert(v,D.geometry,M,O,this.index,this.instancesPerModel[I].instancedDataArray.length,Bt/32)}this.lookup=null}update(o,c,h,m){for(const p in this.instancesPerModel){const v=this.instancesPerModel[p];for(const T in o)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],o[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const c in this.instancesPerModel){const h=this.instancesPerModel[c];for(const m of h.features){const p=this.layers[0],v=m.feature,T=this.canonical,M=p.paint.get("model-rotation").evaluate(v,{},T),O=p.paint.get("model-scale").evaluate(v,{},T),w=p.paint.get("model-translation").evaluate(v,{},T);ge.vec3.exactEquals(m.rotation,M)&&ge.vec3.exactEquals(m.scale,O)&&ge.vec3.exactEquals(m.translation,w)||(this.evaluate(m,m.featureStates,h,!0),o=!0)}}return o}updateReplacement(o,c,h,m){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(PD(this.activeReplacements,p))return!1;this.activeReplacements=p;let v=!1;for(const T in this.instancesPerModel){const M=this.instancesPerModel[T],O=M.instancedDataArray;for(const w of M.features){const P=w.instancedDataOffset,D=w.instancedDataCount;for(let I=0;I<D;I++){const k=16*(I+P);let N=O.float32[k+0];const W=N>Bt;N=W?N-Bt:N;const Z=Math.floor(N),ee=O.float32[k+1];let Q=!1;for(const K of this.activeReplacements)if(!i6(K,h,qV.Model,m)&&!(K.min.x>Z||Z>K.max.x||K.min.y>ee||ee>K.max.y)&&(Q=u6(c6(Z,ee,o.canonical,K.footprintTileId.canonical),K.footprint),Q))break;O.float32[k]=Q?N+Bt:N,v=v||Q!==W}}}return v}isEmpty(){for(const o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const c in this.instancesPerModel){const h=this.instancesPerModel[c];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=o.createVertexBuffer(h.instancedDataArray,kue.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const c in this.instancesPerModel){const h=this.instancesPerModel[c];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris)for(const c of this.modelUris)o.removeModel(c,"")}addFeature(o,c,h){const m=this.layers[0],p=m.layout.get("model-id").evaluate(h,{},this.canonical);if(!p)return pi(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),p;HV(p,!1)&&(this.modelUris.includes(p)||this.modelUris.push(p)),this.instancesPerModel[p]||(this.instancesPerModel[p]=new XV);const v=this.instancesPerModel[p],T=v.instancedDataArray,M=new ZV(h,T.length);for(const O of c)for(const w of O){if(w.x<0||w.x>=Bt||w.y<0||w.y>=Bt)continue;const P=(this.lookupDim-1)/Bt,D=this.lookupDim*(w.y*P|0)+w.x*P|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const I=T.length;T.resize(I+1),v.instancesEvaluatedElevation.push(0),T.float32[16*I]=w.x,T.float32[16*I+1]=w.y}return M.instancedDataCount=v.instancedDataArray.length-M.instancedDataOffset,M.instancedDataCount>0&&(o.id&&(v.idToFeaturesIndex[o.id]=v.features.length),v.features.push(M),this.evaluate(M,{},v,!1)),p}getModelUris(){return this.modelUris}evaluate(o,c,h,m){const p=this.layers[0],v=o.feature,T=this.canonical,M=o.rotation=p.paint.get("model-rotation").evaluate(v,c,T),O=o.scale=p.paint.get("model-scale").evaluate(v,c,T),w=o.translation=p.paint.get("model-translation").evaluate(v,c,T),P=p.paint.get("model-color").evaluate(v,c,T);P.a=p.paint.get("model-color-mix-intensity").evaluate(v,c,T);const D=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,O[0]),Math.max(O[1],O[2])),WV(D,M,O);const I=Math.round(100*P.a)+P.b/1.05;for(let k=0;k<o.instancedDataCount;++k){const N=o.instancedDataOffset+k,W=16*N,Z=h.instancedDataArray.float32;let ee=0;m&&(ee=Z[W+6]-h.instancesEvaluatedElevation[N]);const Q=0|Z[W+1];Z[W]=(0|Z[W])+P.r/1.05,Z[W+1]=Q+P.g/1.05,Z[W+2]=I,Z[W+3]=1/(T.z>10?this.tileToMeter:y(T,Q)),Z[W+4]=w[0],Z[W+5]=w[1],Z[W+6]=w[2]+ee,Z[W+7]=D[0],Z[W+8]=D[1],Z[W+9]=D[2],Z[W+10]=D[4],Z[W+11]=D[5],Z[W+12]=D[6],Z[W+13]=D[8],Z[W+14]=D[9],Z[W+15]=D[10],h.instancesEvaluatedElevation[N]=w[2]}}}let YV,KV;Jt(iL,"ModelBucket",{omit:["layers"]}),Jt(XV,"PerModelAttributes"),Jt(ZV,"ModelFeature");const pg=64,Zv={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function JV(d,o,c,h,m,p,v,T,M,O=!1){const w=c.zoom,P=c.project(h),D=ed(h.lat,w),I=1/D;ge.mat4.identity(d),ge.mat4.translate(d,d,[P.x+v[0]*I,P.y+v[1]*I,v[2]]);let k=1,N=1;const W=c.worldSize;if(O){if(c.projection.name==="mercator"){let K=0;c.elevation&&(K=c.elevation.getAtPointOrZero(new s(P.x/W,P.y/W),0));const ie=ge.vec4.transformMat4([],[P.x,P.y,K,1],c.projMatrix)[3]/c.cameraToCenterDistance;k=ie,N=ie*ed(c.center.lat,w)}else if(c.projection.name==="globe"){const K=nL(d,c),ie=ge.mat4.multiply([],c.projMatrix,K),se=[0,0,0,1];ge.vec4.transformMat4(se,se,ie);const de=se[3]/c.cameraToCenterDistance,we=Ra(w),_e=c.projection.pixelsPerMeter(h.lat,W)*ed(h.lat,w),xe=c.projection.pixelsPerMeter(c.center.lat,W)*ed(c.center.lat,w);k=de/_r(_e,j2(c.center.lat),we),N=de*D/_e,k*=xe,N*=xe}}else k=I;ge.mat4.scale(d,d,[k,k,N]);const Z=[...d],ee=o.orientation,Q=[];if(WV(Q,[ee[0]+m[0],ee[1]+m[1],ee[2]+m[2]],p),ge.mat4.multiply(d,Z,Q),T&&c.elevation){let K=0;const ie=[];if(M&&c.elevation){K=function(we,_e,xe,ke,Se){const De=_e.elevation;if(!De)return 0;const Ve=or.projectAabbCorners(xe,ke),Fe=Yo(1,Se.lat)*_e.worldSize,Ze=function(yr,Zt){const nr=[0,0,1],Er=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Vr of Er){const Cr=yr[Vr.corners[0]],Yr=yr[Vr.corners[1]],Ur=yr[Vr.corners[2]],Qr=[Yr[0]-Cr[0],Yr[1]-Cr[1],Zt*(Yr[2]-Cr[2])],un=ge.vec3.cross(Qr,Qr,[Ur[0]-Cr[0],Ur[1]-Cr[1],Zt*(Ur[2]-Cr[2])]);ge.vec3.normalize(un,un),Vr.dotProductWithUp=ge.vec3.dot(un,nr)}return Er.sort((Vr,Cr)=>Vr.dotProductWithUp-Cr.dotProductWithUp),Er[0].corners}(Ve,Fe),He=Ve[Ze[0]],tt=Ve[Ze[1]],Ke=Ve[Ze[2]],nt=Ve[Ze[3]],Ct=De.getAtPointOrZero(new s(He[0]/_e.worldSize,He[1]/_e.worldSize),0),At=De.getAtPointOrZero(new s(tt[0]/_e.worldSize,tt[1]/_e.worldSize),0),Qt=De.getAtPointOrZero(new s(Ke[0]/_e.worldSize,Ke[1]/_e.worldSize),0),Rt=De.getAtPointOrZero(new s(nt[0]/_e.worldSize,nt[1]/_e.worldSize),0),Ft=(Ct+Rt)/2,It=(At+Qt)/2;return Ft>It?At<Qt?pA(we,tt,nt,He,At,Rt,Ct,Fe):pA(we,Ke,He,nt,Qt,Ct,Rt,Fe):Ct<Rt?pA(we,He,tt,Ke,Ct,At,Qt,Fe):pA(we,nt,Ke,tt,Rt,Qt,At,Fe),Math.max(Ft,It)}(ie,c,o.aabb,d,h);const se=ge.mat4.fromQuat([],ie),de=ge.mat4.multiply([],se,Q);ge.mat4.multiply(d,Z,de)}else K=c.elevation.getAtPointOrZero(new s(P.x/W,P.y/W),0);K!==0&&(d[14]+=K)}}function F1(d,o,c=!1){d.uploaded||(d.gfxTexture=new eL(o,d.image,c?o.gl.R8:o.gl.RGBA8,{useMipmap:d.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),d.uploaded=!0,d.image=null)}function Due(d,o,c){d.indexBuffer=o.createIndexBuffer(d.indexArray,!1,!0),d.vertexBuffer=o.createVertexBuffer(d.vertexArray,Mue.members,!1,!0),d.normalArray&&(d.normalBuffer=o.createVertexBuffer(d.normalArray,Oue.members,!1,!0)),d.texcoordArray&&(d.texcoordBuffer=o.createVertexBuffer(d.texcoordArray,Iue.members,!1,!0)),d.colorArray&&(d.colorBuffer=o.createVertexBuffer(d.colorArray,(d.colorArray.bytesPerElement===12?Cue:Pue).members,!1,!0)),d.featureArray&&(d.pbrBuffer=o.createVertexBuffer(d.featureArray,Rue.members,!0)),d.segments=si.simpleSegment(0,0,d.vertexArray.length,d.indexArray.length);const h=d.material;h.pbrMetallicRoughness.baseColorTexture&&F1(h.pbrMetallicRoughness.baseColorTexture,o),h.pbrMetallicRoughness.metallicRoughnessTexture&&F1(h.pbrMetallicRoughness.metallicRoughnessTexture,o),h.normalTexture&&F1(h.normalTexture,o),h.occlusionTexture&&F1(h.occlusionTexture,o,c),h.emissionTexture&&F1(h.emissionTexture,o)}function oL(d,o,c){if(d.meshes)for(const h of d.meshes)Due(h,o,c);if(d.children)for(const h of d.children)oL(h,o,c)}function gA(d){if(d.meshes)for(const o of d.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(d.children)for(const o of d.children)gA(o)}function aL(d){if(d.meshes)for(const c of d.meshes)c.vertexBuffer&&(c.vertexBuffer.destroy(),c.indexBuffer.destroy(),c.normalBuffer&&c.normalBuffer.destroy(),c.texcoordBuffer&&c.texcoordBuffer.destroy(),c.colorBuffer&&c.colorBuffer.destroy(),c.pbrBuffer&&c.pbrBuffer.destroy(),c.segments.destroy(),c.material&&((o=c.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(d.children)for(const c of d.children)aL(c)}class Xv{constructor(o,c,h){this._demTile=o,this._dem=this._demTile.dem,this._scale=c,this._offset=h}static create(o,c,h){const m=h||o.findDEMTileFor(c);if(!m||!m.dem)return;const p=m.dem,v=m.tileID,T=1<<c.canonical.z-v.canonical.z;return new Xv(m,p.dim/Bt/T,[(c.canonical.x/T-v.canonical.x)*p.dim,(c.canonical.y/T-v.canonical.y)*p.dim])}tileCoordToPixel(o,c){const h=c*this._scale+this._offset[1],m=Math.floor(o*this._scale+this._offset[0]),p=Math.floor(h);return new _t(m,p)}getElevationAt(o,c,h,m){const p=o*this._scale+this._offset[0],v=c*this._scale+this._offset[1],T=Math.floor(p),M=Math.floor(v),O=this._dem;return m=!!m,h?_r(_r(O.get(T,M,m),O.get(T,M+1,m),v-M),_r(O.get(T+1,M,m),O.get(T+1,M+1,m),v-M),p-T):O.get(T,M,m)}getElevationAtPixel(o,c,h){return this._dem.get(o,c,!!h)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Yo(1,o)*this._dem.stride}}const sL=new Float32Array(262144),mg=new Uint8Array(262144);function QV(d){let o=0;if(d.meshes)for(const c of d.meshes)o=Math.max(o,c.aabb.max[2]);if(d.children)for(const c of d.children)o=Math.max(o,QV(c));return o}function e8(d,o,c){if(d.meshes)for(const h of d.meshes){if(h.aabb.min[0]===1/0)continue;const m=or.applyTransform(h.aabb,d.matrix);c.insert(o,m.min[0],m.min[1],m.max[0],m.max[1])}if(d.children)for(const h of d.children)e8(h,o,c)}const t8=["","wall","door","roof","window","lamp","logo"];class r8{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:QV(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new or([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const c=new or([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==o&&(h.transformedAabb=or.applyTransformFast(h.aabb,this.node.matrix),c.encapsulate(h.transformedAabb)),o++;this.aabb=c}return this.aabb}}class yA{constructor(o,c,h,m,p,v,T){this.id=h,this.layers=o,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=Zv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=Zv.HasMapboxMeshFeatures),p&&(this.modelTraits|=Zv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const M of c)this.nodesInfo.push(new r8(M)),e8(M,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,c){for(const h of this.getNodesInfo()){const m=h.node;m.footprint&&c.push({footprint:m.footprint,id:o})}}update(o){const c=Object.keys(o).length!==0;if(c&&!this.stateDependentLayers.length)return;const h=c?this.stateDependentLayers:this.layers;if(!hn(o,this.states))for(const m of h)this.evaluate(m,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const c=this.getNodesInfo();for(const h of c){const m=h.node;this.uploaded?this.updatePbrBuffer(m):oL(m,o,!0)}for(const h of c)gA(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let c=!1;if(!o.meshes)return c;for(const h of o.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),c=!0);return c}needsReEvaluation(o,c,h){const m=o.transform.projectionOptions,p=o.style.getBrightness(),v=this.brightness!==p;if(!this.uploaded||this.dirty||m.name!==this.projection.name||B1(h.paint.get("model-color").value,v)||B1(h.paint.get("model-color-mix-intensity").value,v)||B1(h.paint.get("model-roughness").value,v)||B1(h.paint.get("model-emissive-strength").value,v)||B1(h.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=m,this.brightness=p;const T=this.getNodesInfo();for(const M of T)M.state=null;return!0}return!1}evaluateScale(o,c){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const h=this.getNodesInfo(),m=this.id.canonical;for(const p of h){const v=p.feature;p.evaluatedScale=c.paint.get("model-scale").evaluate(v,{},m)}}evaluate(o,c){const h=this.getNodesInfo();for(const m of h){if(!m.node.meshes)continue;const p=m.feature,v=c&&c[p.id];if(hn(v,m.state))continue;m.state=structuredClone(v);const T=m.node.meshes&&m.node.meshes[0].featureData,M=m.evaluatedColor[2],O=m.evaluatedRMEA[2],w=this.id.canonical;if(m.hasTranslucentParts=!1,T){for(let P=0;P<t8.length;P++){const D=t8[P];D.length&&(p.properties.part=D);const I=o.paint.get("model-color").evaluate(p,v,w).toRenderColor(null),k=o.paint.get("model-color-mix-intensity").evaluate(p,v,w);m.evaluatedColor[P]=[I.r,I.g,I.b,k],m.evaluatedRMEA[P][0]=o.paint.get("model-roughness").evaluate(p,v,w),m.evaluatedRMEA[P][2]=o.paint.get("model-emissive-strength").evaluate(p,v,w),m.evaluatedRMEA[P][3]=I.a,m.emissionHeightBasedParams[P]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(p,v,w),!m.hasTranslucentParts&&I.a<1&&(m.hasTranslucentParts=!0)}delete p.properties.part,Nue(m,M!==m.evaluatedColor[2]||O!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(p,v,w);m.evaluatedScale=o.paint.get("model-scale").evaluate(p,v,w),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,c,h,m){const p=o.findDEMTileFor(h);if(p&&(p.tileID.canonical!==this.terrainTile||c!==this.terrainExaggeration)){if(p.dem&&p.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=p.tileID.overscaledZ;const v=Xv.create(o,h,p);if(!v)return;this.modelTraits&Zv.HasMapboxMeshFeatures&&this.updateDEM(o,v,h,m);for(const T of this.getNodesInfo()){const M=T.node;if(!M.footprint||!M.footprint.vertices||!M.footprint.vertices.length)continue;const O=M.footprint.vertices;let w=v.getElevationAt(O[0].x,O[0].y,!0,!0);for(let P=1;P<O.length;P++)w=Math.min(w,v.getElevationAt(O[P].x,O[P].y,!0,!0));M.elevation=w}}this.terrainTile=p.tileID.canonical,this.terrainExaggeration=c}}updateDEM(o,c,h,m){let p=c._dem._modifiedForSources[m];if(p===void 0&&(c._dem._modifiedForSources[m]=[],p=c._dem._modifiedForSources[m]),p.includes(h.canonical))return;const v=c._dem.dim;p.push(h.canonical);let T=!1;for(const M of this.getNodesInfo()){const O=M.node;if(!O.footprint||!O.footprint.grid)continue;const w=O.footprint.grid,P=c.tileCoordToPixel(w.min.x,w.min.y),D=c.tileCoordToPixel(w.max.x,w.max.y),I=Math.min(Math.min(v-D.y,P.x),Math.min(P.y,v-D.x));if(I<0)continue;const k=Kt(I,2,5);let N=Math.max(0,P.x-k),W=Math.max(0,P.y-k),Z=Math.min(D.x+k,v-1),ee=Math.min(D.y+k,v-1);for(let se=W;se<=ee;++se)for(let de=N;de<=Z;++de)mg[se*v+de]=255;let Q=0,K=0;for(let se=0;se<w.cellsY;++se)for(let de=0;de<w.cellsX;++de){if(!w.cells[se*w.cellsX+de])continue;const we=c.tileCoordToPixel(w.min.x+de/w.xScale,w.min.y+se/w.yScale),_e=c.tileCoordToPixel(w.min.x+(de+1)/w.xScale,w.min.y+(se+1)/w.yScale);for(let xe=we.y;xe<=Math.min(_e.y+1,v-1);++xe)for(let ke=we.x;ke<=Math.min(_e.x+1,v-1);++ke)mg[xe*v+ke]===255&&(mg[xe*v+ke]=0,Q+=c.getElevationAtPixel(ke,xe),K++)}const ie=Q/K;N=Math.max(1,P.x-k),W=Math.max(1,P.y-k),Z=Math.min(D.x+k,v-2),ee=Math.min(D.y+k,v-2),T=!0;for(let se=W;se<=ee;++se)for(let de=N;de<=Z;++de)mg[se*v+de]===0&&(sL[se*v+de]=c._dem.set(de,se,ie));for(let se=1;se<k;++se){N=Math.max(1,P.x-se),W=Math.max(1,P.y-se),Z=Math.min(D.x+se,v-2),ee=Math.min(D.y+se,v-2);for(let de=W;de<=ee;++de)for(let we=N;we<=Z;++we){const _e=de*v+we;if(mg[_e]===255){let xe=0,ke=0,Se=-1,De=-1;for(let Ve=-1;Ve<=1;++Ve)for(let Fe=-1;Fe<=1;++Fe){const Ze=(de+Ve)*v+we+Fe;if(mg[Ze]>=se)continue;const He=sL[Ze],tt=Math.abs(He);tt>ke&&(xe=He,ke=tt,Se=Fe,De=Ve)}if(ke>.1){const Ve=1-(se+.5*Math.abs(Se*De))/k;let Fe=c._dem.get(we,de)+xe*Ve;const Ze=c._dem.get(we+Se,de+De),He=c._dem.get(we-Se,de-De,!0);(Fe-Ze)*(Fe-He)>0&&(Fe=(Ze+He)/2),sL[_e]=c._dem.set(we,de,Fe),mg[_e]=se}}}}}T&&(c._demTile.needsDEMTextureUpload=!0,c._dem._timestamp=pt.now())}setFilter(o){this.filter=o?Xb(o):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(o=>this.filter.filter(new $n(this.id.overscaledZ),o.feature,this.id.canonical)):this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const c of o)gA(c.node),aL(c.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,c){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const h=c.getReplacementRegionsForTile(o.toUnwrapped()),m=this.getNodesInfo();for(let p=0;p<this.nodesInfo.length;p++){const v=m[p].node;m[p].hiddenByReplacement=!!v.footprint&&!h.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(o,c){const h=this.getNodesInfo(),m=[],p=[0,0,0],v=ge.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const M=h[T],O=M.node.meshes[0],w=O.transformedAabb;if(o<w.min[0]||c<w.min[1]||o>w.max[0]||c>w.max[1])continue;if(M.node.hidden===!0)return{height:1/0,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};ge.mat4.invert(v,M.node.matrix),p[0]=o,p[1]=c,ge.vec3.transformMat4(p,p,v);const P=(p[0]-O.aabb.min[0])/(O.aabb.max[0]-O.aabb.min[0])*pg|0,D=Math.min(63,(p[1]-O.aabb.min[1])/(O.aabb.max[1]-O.aabb.min[1])*pg|0)*pg+Math.min(63,P),I=O.heightmap[D];if(!(I<0&&M.node.footprint))return M.hiddenByReplacement?void 0:{height:I,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};if(M.node.footprint.grid.query(new _t(o,c),new _t(o,c),m),m.length>0)return{height:void 0,maxHeight:M.feature.properties.height,hidden:M.hiddenByReplacement,verticalScale:M.evaluatedScale[2]}}}}function B1(d,o){return!d.isLightConstant&&o}function Lue(d,o,c,h,m,p,v,T){let M=(61440&o|(61440&o)>>4)>>8,O=(3840&o|(3840&o)>>4)>>4,w=240&o|(240&o)>>4;c[3]>0&&(M=_r(M,255*c[0],c[3]),O=_r(O,255*c[1],c[3]),w=_r(w,255*c[2],c[3]));const P=M<<8|O,D=w<<8|Math.floor(255*h[3]),I=function(se){const de=Kt(se,0,2);return Math.min(Math.round(.5*de*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],k=Kt(m[0],0,1),N=Kt(m[1],0,1),W=Kt(m[2],0,1),Z=Kt(m[3],0,1);let ee,Q,K,ie;if(k!==N&&v!==p&&N!==k){const se=v-p;Q=1/(se*(N-k)),K=-(p+se*k)/(se*(N-k));const de=Kt(m[4],-1,1);ie=Math.pow(10,de),ee=255*W<<8|255*Z}else ee=65535,Q=0,K=1,ie=1;if(d.emplaceBack(P,D,I,ee,Q,K,ie),T){const se=T.length;T.clear();for(let de=0;de<se;de++)T.emplaceBack(P,D,I,ee,Q,K,ie)}}function Nue(d,o,c){const h=d.node;let m=0;const p=c&Zv.HasMeshoptCompression;for(const v of h.meshes){if(h.lights&&h.lightMeshIndex===m||!v.featureData)continue;v.featureArray=new Dv,v.featureArray.reserve(v.featureData.length);let T=o;for(const M of v.featureData){const O=p?65535&M:M>>16&65535,w=p?M>>16&65535:65535&M,P=(15&w)<8?15&w:0,D=d.evaluatedRMEA[P],I=d.evaluatedColor[P],k=d.emissionHeightBasedParams[P];let N;if(T&&P===2&&h.lights&&(N=new Dv,N.resize(10*h.lights.length)),Lue(v.featureArray,O,I,D,k,v.aabb.min[2],v.aabb.max[2],N),N&&T){T=!1;const W=h.meshes[h.lightMeshIndex];W.featureArray=N,W.featureArray._trim()}}v.featureArray._trim(),m++}}function n8(d,o,c,h){const m=1<<d.z;o.lat=$o((h/Bt+d.y)/m),o.lng=qa((c/Bt+d.x)/m)}Jt(yA,"Tiled3dModelBucket",{omit:["layers"]}),Jt(r8,"Tiled3dModelFeature");const zue={circle:class extends ko{constructor(d,o,c,h){super(d,{layout:Qe||(Qe=new bi({"circle-sort-key":new Yt(it.layout_circle["circle-sort-key"]),"circle-elevation-reference":new zt(it.layout_circle["circle-elevation-reference"]),visibility:new zt(it.layout_circle.visibility)})),paint:bt||(bt=new bi({"circle-radius":new Yt(it.paint_circle["circle-radius"]),"circle-color":new Yt(it.paint_circle["circle-color"]),"circle-blur":new Yt(it.paint_circle["circle-blur"]),"circle-opacity":new Yt(it.paint_circle["circle-opacity"]),"circle-translate":new zt(it.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(it.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(it.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(it.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yt(it.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yt(it.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yt(it.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new zt(it.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h)}createBucket(d){return new re(d)}queryRadius(d){const o=d;return et("circle-radius",this,o)+et("circle-stroke-width",this,o)+wt(this.paint.get("circle-translate"))}queryIntersectsFeature(d,o,c,h,m,p,v,T){const M=Dt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c);return Bv(d,h,p,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,O)}getProgramIds(){return["circle"]}getDefaultProgramParams(d,o,c){const h=$f(this);return{config:new th(this,{zoom:o,lut:c}),defines:h,overrideFog:!1}}},heatmap:class extends ko{createBucket(d){return new MU(d)}constructor(d,o,c,h){super(d,{layout:CU||(CU=new bi({visibility:new zt(it.layout_heatmap.visibility)})),paint:PU||(PU=new bi({"heatmap-radius":new Yt(it.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yt(it.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(it.paint_heatmap["heatmap-intensity"]),"heatmap-color":new kf(it.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(it.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(d){return et("heatmap-radius",this,d)}queryIntersectsFeature(d,o,c,h,m,p,v,T){const M=this.paint.get("heatmap-radius").evaluate(o,c);return Bv(d,h,p,v,T,!0,!0,new _t(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(d,o,c){return d==="heatmap"?{config:new th(this,{zoom:o,lut:c}),overrideFog:!1}:{}}},hillshade:class extends ko{constructor(d,o,c,h){super(d,{layout:IU||(IU=new bi({visibility:new zt(it.layout_hillshade.visibility)})),paint:OU||(OU=new bi({"hillshade-illumination-direction":new zt(it.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zt(it.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(it.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(it.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(it.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(it.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new zt(it.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(d,o,c){return{overrideFog:!1}}},fill:class extends ko{constructor(d,o,c,h){super(d,{layout:YU||(YU=new bi({"fill-sort-key":new Yt(it.layout_fill["fill-sort-key"]),visibility:new zt(it.layout_fill.visibility),"fill-elevation-reference":new zt(it.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Yt(it.layout_fill["fill-construct-bridge-guard-rail"])})),paint:KU||(KU=new bi({"fill-antialias":new zt(it.paint_fill["fill-antialias"]),"fill-opacity":new Yt(it.paint_fill["fill-opacity"]),"fill-color":new Yt(it.paint_fill["fill-color"]),"fill-outline-color":new Yt(it.paint_fill["fill-outline-color"]),"fill-translate":new zt(it.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(it.paint_fill["fill-translate-anchor"]),"fill-pattern":new Yt(it.paint_fill["fill-pattern"]),"fill-emissive-strength":new zt(it.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Yt(it.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Yt(it.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Yt(it.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h)}getProgramIds(){const d=this.paint.get("fill-pattern"),o=d&&d.constantOr(1),c=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getDefaultProgramParams(d,o,c){return{config:new th(this,{zoom:o,lut:c}),overrideFog:!1}}recalculate(d,o){super.recalculate(d,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new AD(d)}queryRadius(){return wt(this.paint.get("fill-translate"))}queryIntersectsFeature(d,o,c,h,m,p){return!d.queryGeometry.isAboveHorizon&&fe(Tt(d.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(d){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const o=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return d!=null?o&&!d:o}},"fill-extrusion":class extends ko{constructor(d,o,c,h){super(d,{layout:E6||(E6=new bi({visibility:new zt(it["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new zt(it["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:A6||(A6=new bi({"fill-extrusion-opacity":new zt(it["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yt(it["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(it["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(it["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Yt(it["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yt(it["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yt(it["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new zt(it["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new zt(it["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new zt(it["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new zt(it["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new zt(it["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new zt(it["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new zt(it["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new zt(it["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new zt(it["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new zt(it["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Yt(it["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Yt(it["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new zt(it["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new zt(it["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new zt(it["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new zt(it["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Yt(it["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Yt(it["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new zt(it["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new Z2(d)}queryRadius(){return wt(this.paint.get("fill-extrusion-translate"))}is3D(d){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(d,o,c,h,m,p,v,T,M){const O=Dt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(o,c),P=this.paint.get("fill-extrusion-base").evaluate(o,c),D=[0,0],I=T&&p.elevation,k=p.elevation?p.elevation.exaggeration():1,N=d.tile.getBucket(this);if(I&&N instanceof Z2){const K=N.centroidVertexArray,ie=M+1;ie<K.length&&(D[0]=K.geta_centroid_pos0(ie),D[1]=K.geta_centroid_pos1(ie))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(h=T6([h],[new _t(0,0),new _t(Bt,Bt)],d.tileID.canonical).map(K=>K.polygon).flat());const W=I?T:null,[Z,ee]=function(K,ie,se,de,we,_e,xe,ke,Se,De,Ve){return K.projection.name==="globe"?function(Fe,Ze,He,tt,Ke,nt,Ct,At,Qt,Rt,Ft){const It=[],yr=[],Zt=Fe.projection.upVectorScale(Ft,Fe.center.lat,Fe.worldSize).metersToTile,nr=[0,0,0,1],Er=[0,0,0,1],Vr=(Yr,Ur,Qr,un)=>{Yr[0]=Ur,Yr[1]=Qr,Yr[2]=un,Yr[3]=1},Cr=S6();He>0&&(He+=Cr),tt+=Cr;for(const Yr of Ze){const Ur=[],Qr=[];for(const un of Yr){const Un=un.x+Ke.x,Ar=un.y+Ke.y,an=Fe.projection.projectTilePoint(Un,Ar,Ft),ri=Fe.projection.upVector(Ft,un.x,un.y);let gi=He,wi=tt;if(Ct){const Ei=C6(Un,Ar,He,tt,Ct,At,Qt,Rt);gi+=Ei.base,wi+=Ei.top}He!==0?Vr(nr,an.x+ri[0]*Zt*gi,an.y+ri[1]*Zt*gi,an.z+ri[2]*Zt*gi):Vr(nr,an.x,an.y,an.z),Vr(Er,an.x+ri[0]*Zt*wi,an.y+ri[1]*Zt*wi,an.z+ri[2]*Zt*wi),ge.vec3.transformMat4(nr,nr,nt),ge.vec3.transformMat4(Er,Er,nt),Ur.push(new fg(nr[0],nr[1],nr[2])),Qr.push(new fg(Er[0],Er[1],Er[2]))}It.push(Ur),yr.push(Qr)}return[It,yr]}(K,ie,se,de,we,_e,xe,ke,Se,De,Ve):xe?function(Fe,Ze,He,tt,Ke,nt,Ct,At,Qt){const Rt=[],Ft=[],It=[0,0,0,1];for(const yr of Fe){const Zt=[],nr=[];for(const Er of yr){const Vr=Er.x+tt.x,Cr=Er.y+tt.y,Yr=C6(Vr,Cr,Ze,He,nt,Ct,At,Qt);It[0]=Vr,It[1]=Cr,It[2]=Yr.base,It[3]=1,ge.vec4.transformMat4(It,It,Ke),It[3]=Math.max(It[3],1e-5);const Ur=new fg(It[0]/It[3],It[1]/It[3],It[2]/It[3]);It[0]=Vr,It[1]=Cr,It[2]=Yr.top,It[3]=1,ge.vec4.transformMat4(It,It,Ke),It[3]=Math.max(It[3],1e-5);const Qr=new fg(It[0]/It[3],It[1]/It[3],It[2]/It[3]);Zt.push(Ur),nr.push(Qr)}Rt.push(Zt),Ft.push(nr)}return[Rt,Ft]}(ie,se,de,we,_e,xe,ke,Se,De):function(Fe,Ze,He,tt,Ke){const nt=[],Ct=[],At=Ke[8]*Ze,Qt=Ke[9]*Ze,Rt=Ke[10]*Ze,Ft=Ke[11]*Ze,It=Ke[8]*He,yr=Ke[9]*He,Zt=Ke[10]*He,nr=Ke[11]*He;for(const Er of Fe){const Vr=[],Cr=[];for(const Yr of Er){const Ur=Yr.x+tt.x,Qr=Yr.y+tt.y,un=Ke[0]*Ur+Ke[4]*Qr+Ke[12],Un=Ke[1]*Ur+Ke[5]*Qr+Ke[13],Ar=Ke[2]*Ur+Ke[6]*Qr+Ke[14],an=Ke[3]*Ur+Ke[7]*Qr+Ke[15],ri=un+At,gi=Un+Qt,wi=Ar+Rt,Ei=Math.max(an+Ft,1e-5),zn=un+It,bo=Un+yr,Da=Ar+Zt,Zi=Math.max(an+nr,1e-5);Vr.push(new fg(ri/Ei,gi/Ei,wi/Ei)),Cr.push(new fg(zn/Zi,bo/Zi,Da/Zi))}nt.push(Vr),Ct.push(Cr)}return[nt,Ct]}(ie,se,de,we,_e)}(p,h,P,w,O,v,W,D,k,p.center.lat,d.tileID.canonical),Q=d.queryGeometry;return function(K,ie,se){let de=1/0;fe(se,ie)&&(de=M6(se,ie[0]));for(let we=0;we<ie.length;we++){const _e=ie[we],xe=K[we];for(let ke=0;ke<_e.length-1;ke++){const Se=_e[ke],De=[Se,_e[ke+1],xe[ke+1],xe[ke],Se];ce(se,De)&&(de=Math.min(de,M6(se,De)))}}return de!==1/0&&de}(Z,ee,Q.isPointQuery()?Q.screenBounds:Q.screenGeometry)}},line:class extends ko{constructor(d,o,c,h){const m=j6();super(d,m,o,c,h),m.layout&&(this.layout=new Of(m.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(d){if(d==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof rc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(d,o){super.recalculate(d,o),this.paint._values["line-floorwidth"]=(()=>{if(C1)return C1;const c=j6();return C1=new jce(c.paint.properties["line-width"].specification),C1.useIntegerZoom=!0,C1})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new RD(d)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(d,o,c){const h=N6(this);return{config:new th(this,{zoom:o,lut:c}),defines:h,overrideFog:!1}}queryRadius(d){const o=d,c=F6(et("line-width",this,o),et("line-gap-width",this,o)),h=et("line-offset",this,o);return c/2+Math.abs(h)+wt(this.paint.get("line-translate"))}queryIntersectsFeature(d,o,c,h,m,p){if(d.queryGeometry.isAboveHorizon)return!1;const v=Tt(d.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),T=d.pixelToTileUnitsFactor/2*F6(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),M=this.paint.get("line-offset").evaluate(o,c);return M&&(h=function(O,w){const P=[],D=new _t(0,0);for(let I=0;I<O.length;I++){const k=O[I],N=[];for(let W=0;W<k.length;W++){const Z=k[W],ee=k[W+1],Q=W===0?D:Z.sub(k[W-1])._unit()._perp(),K=W===k.length-1?D:ee.sub(Z)._unit()._perp(),ie=Q._add(K)._unit();ie._mult(1/(ie.x*K.x+ie.y*K.y)),N.push(ie._mult(w)._add(Z))}P.push(N)}return P}(h,M*d.pixelToTileUnitsFactor)),function(O,w,P){for(let D=0;D<w.length;D++){const I=w[D];if(O.length>=3){for(let k=0;k<I.length;k++)if(Ce(O,I[k]))return!0}if(me(O,I,P))return!0}return!1}(v,h,T)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(d){return!this.hasElevatedBuckets}},symbol:cA,background:class extends ko{constructor(d,o,c,h){super(d,{layout:CV||(CV=new bi({visibility:new zt(it.layout_background.visibility)})),paint:PV||(PV=new bi({"background-pitch-alignment":new zt(it.paint_background["background-pitch-alignment"]),"background-color":new zt(it.paint_background["background-color"]),"background-pattern":new zt(it.paint_background["background-pattern"]),"background-opacity":new zt(it.paint_background["background-opacity"]),"background-emissive-strength":new zt(it.paint_background["background-emissive-strength"]),"background-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(d,o,c){return{overrideFog:!1}}is3D(d){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:DV,"raster-particle":BV,sky:class extends ko{constructor(d,o,c,h){super(d,{layout:zV||(zV=new bi({visibility:new zt(it.layout_sky.visibility)})),paint:jV||(jV=new bi({"sky-type":new zt(it.paint_sky["sky-type"]),"sky-atmosphere-sun":new zt(it.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new zt(it.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new zt(it.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new zt(it.paint_sky["sky-gradient-radius"]),"sky-gradient":new kf(it.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new zt(it.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new zt(it.paint_sky["sky-atmosphere-color"]),"sky-opacity":new zt(it.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="sky-gradient"?this._updateColorRamp():d!=="sky-atmosphere-sun"&&d!=="sky-atmosphere-halo-color"&&d!=="sky-atmosphere-color"&&d!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=_1({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(d){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=d.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(d,o){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),m=!h,p=d.style.light,v=p.properties.get("position");return m&&p.properties.get("anchor")==="viewport"&&pi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?tL(v.azimuthal,90-v.polar,o):tL(h[0],90-h[1],o)}const c=this.paint.get("sky-gradient-center");return tL(c[0],90-c[1],o)}isSky(){return!0}markSkyboxValid(d){this._skyboxInvalidated=!1,this._lightPosition=d.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const d=this.paint.get("sky-type");return d==="atmosphere"?["skyboxCapture","skybox"]:d==="gradient"?["skyboxGradient"]:null}},slot:class extends ko{constructor(d,o,c,h){super(d,{paint:FV||(FV=new bi({}))},o,null)}},model:class extends ko{constructor(d,o,c,h){super(d,{layout:YV||(YV=new bi({visibility:new zt(it.layout_model.visibility),"model-id":new Yt(it.layout_model["model-id"])})),paint:KV||(KV=new bi({"model-opacity":new Yt(it.paint_model["model-opacity"]),"model-rotation":new Yt(it.paint_model["model-rotation"]),"model-scale":new Yt(it.paint_model["model-scale"]),"model-translation":new Yt(it.paint_model["model-translation"]),"model-color":new Yt(it.paint_model["model-color"]),"model-color-mix-intensity":new Yt(it.paint_model["model-color-mix-intensity"]),"model-type":new zt(it.paint_model["model-type"]),"model-cast-shadows":new zt(it.paint_model["model-cast-shadows"]),"model-receive-shadows":new zt(it.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new zt(it.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Yt(it.paint_model["model-emissive-strength"]),"model-roughness":new Yt(it.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Yt(it.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new zt(it.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new zt(it.paint_model["model-front-cutoff"]),"model-color-use-theme":new Yt({type:"string",default:"default","property-type":"data-driven"})}))},o,c,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new iL(d)}getProgramIds(){return["model"]}is3D(d){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(d){return d instanceof yA?Bt-1:0}queryIntersectsFeature(d,o,c,h,m,p){if(!this.modelManager)return!1;const v=this.modelManager,T=d.tile.getBucket(this);if(!(T&&T instanceof iL))return!1;for(const M in T.instancesPerModel){const O=T.instancesPerModel[M],w=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(O.idToFeaturesIndex.hasOwnProperty(w)){const P=O.features[O.idToFeaturesIndex[w]],D=v.getModel(M,this.scope);if(!D)return!1;let I=ge.mat4.create();const k=new gn(0,0),N=T.canonical;let W=Number.MAX_VALUE;for(let Z=0;Z<P.instancedDataCount;++Z){const ee=16*(P.instancedDataOffset+Z),Q=O.instancedDataArray.float32,K=[Q[ee+4],Q[ee+5],Q[ee+6]];n8(N,k,Q[ee],0|Q[ee+1]),JV(I,D,p,k,P.rotation,P.scale,K,!1,!1,!1),p.projection.name==="globe"&&(I=nL(I,p));const ie=ge.mat4.multiply([],p.projMatrix,I),se=d.queryGeometry,de=GV(se.isPointQuery()?se.screenBounds:se.screenGeometry,p,ie,D.aabb);de!=null&&(W=Math.min(de,W))}return W!==Number.MAX_VALUE&&W}}return!1}_handleOverridablePaintPropertyUpdate(d,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven()||d!=="model-color"&&d!=="model-color-mix-intensity"&&d!=="model-rotation"&&d!=="model-scale"&&d!=="model-translation"&&d!=="model-emissive-strength")}_isPropertyZoomDependent(d){const o=this._transitionablePaint._values[d];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof Ef}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ko{constructor(d,o,c,h){super(d,{layout:JU||(JU=new bi({"clip-layer-types":new zt(it.layout_clip["clip-layer-types"]),"clip-layer-scope":new zt(it.layout_clip["clip-layer-scope"])})),paint:QU||(QU=new bi({}))},o,c,h)}recalculate(d,o){super.recalculate(d,o)}createBucket(d){return new e6(d)}is3D(d){return!0}}};class jue{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Fue{constructor(){this.tasks={},this.taskQueue=[],Ql(["process"],this),this.invoker=new jue(this.process),this.nextId=0}add(o,c){const h=this.nextId++,m=function({type:p,isSymbolTile:v,zoom:T}){return T=T||0,p==="message"?0:p!=="maybePrepare"||v?p!=="parseTile"||v?p==="parseTile"&&v?300-T:p==="maybePrepare"&&v?400-T:500:200-T:100-T}(c);if(m===0){try{o()}finally{}return null}return this.tasks[h]={fn:o,metadata:c,priority:m,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const c=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let o=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const p=this.tasks[this.taskQueue[m]];p.priority<c&&(c=p.priority,o=m)}if(o===null)return null;const h=this.taskQueue[o];return this.taskQueue.splice(o,1),h}remove(){this.invoker.remove()}}class i8{constructor(o,c,h){this.target=o,this.parent=c,this.mapId=h,this.callbacks={},this.cancelCallbacks={},Ql(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Fue}send(o,c,h,m,p=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=v,this.callbacks[T]=h);const M=new Set;return this.target.postMessage({id:T,type:o,hasCallback:!!h,targetMapId:m,mustQueue:p,sourceMapId:this.mapId,data:qu(c,M)},M),{cancel:()=>{h&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(o){const c=o.data;if(!c)return;const h=c.id;if(h&&(!c.targetMapId||this.mapId===c.targetMapId))if(c.type==="<cancel>"){const m=this.cancelCallbacks[h];delete this.cancelCallbacks[h],m&&m.cancel()}else if(c.mustQueue||Li()){const m=this.callbacks[h],p=this.scheduler.add(()=>this.processTask(h,c),m&&m.metadata||{type:"message"});p&&(this.cancelCallbacks[h]=p)}else this.processTask(h,c)}processTask(o,c){if(delete this.cancelCallbacks[o],c.type==="<response>"){const h=this.callbacks[o];delete this.callbacks[o],h&&(c.error?h(fs(c.error)):h(null,fs(c.data)))}else{const h=new Set,m=c.hasCallback?(v,T)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:v?qu(v):null,data:qu(T,h)},h)}:()=>{},p=fs(c.data);if(this.parent[c.type])this.parent[c.type](c.sourceMapId,p,m);else if(this.parent.getWorkerSource){const v=c.type.split(".");this.parent.getWorkerSource(c.sourceMapId,v[0],p.source,p.scope)[v[1]](p,m)}else m(new Error(`Could not find function ${c.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var $1={workerUrl:"",workerClass:null,workerParams:void 0};const lL="mapboxgl_preloaded_worker_pool";class gg{constructor(){this.active={}}acquire(o,c=gg.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<c;)this.workers.push($1.workerClass!=null?new $1.workerClass:new self.Worker($1.workerUrl,$1.workerParams));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.workers&&this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[lL]}numActive(){return Object.keys(this.active).length}}gg.workerCount=2;class Yv{constructor(o,c,h="Worker",m=gg.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=na();const p=this.workerPool.acquire(this.id,m);for(let v=0;v<p.length;v++){const T=new Yv.Actor(p[v],c,this.id);T.name=`${h} ${v}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,c,h){Qn(this.actors,(m,p)=>{m.send(o,c,p)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let U1,cL;function vA(){return U1||(U1=new gg),U1}Yv.Actor=i8;const uL=new An(0,0,0);var dL=(d=>(d[d.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",d[d.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",d[d.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",d))(dL||{}),_A=(d=>(d[d.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",d[d.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",d[d.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",d[d.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",d))(_A||{}),V1=(d=>(d[d.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",d[d.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",d[d.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",d[d.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",d[d.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",d))(V1||{}),o8=(d=>(d[d.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",d[d.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",d[d.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",d))(o8||{}),Kv=(d=>(d[d.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",d[d.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",d[d.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",d[d.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",d[d.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",d[d.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",d))(Kv||{}),a8=(d=>(d[d.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",d[d.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",d[d.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",d))(a8||{});function Bue(d,o,c){d===1&&o.icons.push(function(h,m){return function(p){if(p.usvg_tree.height||(p.usvg_tree.height=p.usvg_tree.width),!p.metadata)return p;const{metadata:v}=p;if(v.content_area){const{content_area:T}=v;T.top==null&&(T.top=T.left),T.width==null&&(T.width=p.usvg_tree.width),T.height==null&&(T.height=T.width)}return v.stretch_x&&v.stretch_x.length&&s8(v,"x"),v.stretch_y&&v.stretch_y.length&&s8(v,"y"),p}(h.readFields($ue,{name:void 0},m))}(c,c.readVarint()+c.pos))}function s8(d,o){const c=[],h=d[`stretch_${o}`];let m=null;for(let p=0;p<h.length;p++)m===null?m=c.length===0?h[0]:c[c.length-1][1]+h[p]:(c.push([m,m+h[p]]),m=null);d[`stretch_${o}_areas`]=c}function $ue(d,o,c){d===1?o.name=c.readString():d===2?o.metadata=function(h,m){return h.readFields(Uue,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},m)}(c,c.readVarint()+c.pos):d===3&&(o.usvg_tree=function(h,m){return h.readFields(Gue,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},m)}(c,c.readVarint()+c.pos),o.data="usvg_tree")}function Uue(d,o,c){d===1?o.stretch_x=c.readPackedVarint():d===2?o.stretch_y=c.readPackedVarint():d===3?o.content_area=function(h,m){return h.readFields(Vue,{left:0},m)}(c,c.readVarint()+c.pos):d===4&&o.variables.push(function(h,m){return h.readFields(Wue,{name:void 0},m)}(c,c.readVarint()+c.pos))}function Vue(d,o,c){d===1?o.left=c.readVarint():d===2?o.width=c.readVarint():d===3?o.top=c.readVarint():d===4&&(o.height=c.readVarint())}function Wue(d,o,c){d===1?o.name=c.readString():d===2&&(o.rgb_color=wA(c.readVarint()),o.value="rgb_color")}function Gue(d,o,c){d===1?o.width=o.height=c.readVarint():d===2?o.height=c.readVarint():d===3?o.children.push(xA(c,c.readVarint()+c.pos)):d===4?o.linear_gradients.push(function(h,m){return h.readFields(Jue,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},m)}(c,c.readVarint()+c.pos)):d===5?o.radial_gradients.push(function(h,m){return h.readFields(ede,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},m)}(c,c.readVarint()+c.pos)):d===7?o.clip_paths.push(function(h,m){return h.readFields(tde,{children:[]},m)}(c,c.readVarint()+c.pos)):d===8&&o.masks.push(function(h,m){const p=h.readFields(rde,{left:0,width:20,mask_type:1,children:[]},m);return p.height==null&&(p.height=p.width),p.top==null&&(p.top=p.left),p}(c,c.readVarint()+c.pos))}function xA(d,o){return d.readFields(que,{},o)}function que(d,o,c){d===1?(o.group=function(h,m){return h.readFields(Hue,{opacity:255,children:[]},m)}(c,c.readVarint()+c.pos),o.node="group"):d===2&&(o.path=function(h,m){return h.readFields(Xue,{paint_order:1,commands:[],step:1,diffs:[],rule:1},m)}(c,c.readVarint()+c.pos),o.node="path")}function Hue(d,o,c){d===1?o.transform=bA(c,c.readVarint()+c.pos):d===2?o.opacity=c.readVarint():d===5?o.clip_path_idx=c.readVarint():d===6?o.mask_idx=c.readVarint():d===7&&o.children.push(xA(c,c.readVarint()+c.pos))}function bA(d,o){return d.readFields(Zue,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function Zue(d,o,c){d===1?o.sx=c.readFloat():d===2?o.ky=c.readFloat():d===3?o.kx=c.readFloat():d===4?o.sy=c.readFloat():d===5?o.tx=c.readFloat():d===6&&(o.ty=c.readFloat())}function Xue(d,o,c){d===1?o.fill=function(h,m){return h.readFields(Yue,{rgb_color:uL,paint:"rgb_color",opacity:255},m)}(c,c.readVarint()+c.pos):d===2?o.stroke=function(h,m){return h.readFields(Kue,{rgb_color:uL,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},m)}(c,c.readVarint()+c.pos):d===3?o.paint_order=c.readVarint():d===5?c.readPackedVarint(o.commands):d===6?o.step=c.readFloat():d===7?c.readPackedSVarint(o.diffs):d===8&&(o.rule=c.readVarint())}function Yue(d,o,c){d===1?(o.rgb_color=wA(c.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=c.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=c.readVarint(),o.paint="radial_gradient_idx"):d===5&&(o.opacity=c.readVarint())}function wA(d){return new An((d>>16&255)/255,(d>>8&255)/255,(255&d)/255,1)}function Kue(d,o,c){d===1?(o.rgb_color=wA(c.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=c.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=c.readVarint(),o.paint="radial_gradient_idx"):d===5?c.readPackedFloat(o.dasharray):d===6?o.dashoffset=c.readFloat():d===7?o.miterlimit=c.readFloat():d===8?o.opacity=c.readVarint():d===9?o.width=c.readFloat():d===10?o.linecap=c.readVarint():d===11&&(o.linejoin=c.readVarint())}function Jue(d,o,c){d===1?o.transform=bA(c,c.readVarint()+c.pos):d===2?o.spread_method=c.readVarint():d===3?o.stops.push(l8(c,c.readVarint()+c.pos)):d===4?o.x1=c.readFloat():d===5?o.y1=c.readFloat():d===6?o.x2=c.readFloat():d===7&&(o.y2=c.readFloat())}function l8(d,o){return d.readFields(Que,{offset:0,opacity:255,rgb_color:uL},o)}function Que(d,o,c){d===1?o.offset=c.readFloat():d===2?o.opacity=c.readVarint():d===3&&(o.rgb_color=wA(c.readVarint()))}function ede(d,o,c){d===1?o.transform=bA(c,c.readVarint()+c.pos):d===2?o.spread_method=c.readVarint():d===3?o.stops.push(l8(c,c.readVarint()+c.pos)):d===4?o.cx=c.readFloat():d===5?o.cy=c.readFloat():d===6?o.r=c.readFloat():d===7?o.fx=c.readFloat():d===8?o.fy=c.readFloat():d===9&&(o.fr=c.readFloat())}function tde(d,o,c){d===1?o.transform=bA(c,c.readVarint()+c.pos):d===2?o.clip_path_idx=c.readVarint():d===3&&o.children.push(xA(c,c.readVarint()+c.pos))}function rde(d,o,c){d===1?o.left=o.top=c.readFloat():d===2?o.width=o.height=c.readFloat():d===3?o.top=c.readFloat():d===4?o.height=c.readFloat():d===5?o.mask_type=c.readVarint():d===6?o.mask_idx=c.readVarint():d===7&&o.children.push(xA(c,c.readVarint()+c.pos))}class nde{static calculate(o={},c=[]){const h=new Map,m=new Map;if(Object.keys(o).length===0)return h;c.forEach(p=>{m.set(p.name,p.rgb_color||new An(0,0,0))});for(const[p,v]of Object.entries(o))m.has(p)?h.set(m.get(p).toStringPremultipliedAlpha(),v):console.warn(`Ignoring unknown image variable "${p}"`);return h}}function Jv(d,o=255,c){const h=o/255,m=d.toStringPremultipliedAlpha(),p=c.has(m)?c.get(m).clone():d.clone();return p.a*=h,p.toString()}function W1(d,o){if(!yt()){const c=document.createElement("canvas");return c.width=d,c.height=o,c}return new OffscreenCanvas(d,o)}function ide(d,o){const c=nde.calculate(o.params,d.metadata?d.metadata.variables:[]),h=d.usvg_tree,m=h.width,p=h.height,v=o.transform?o.transform:new DOMMatrix,T=Math.max(1,Math.round(m*v.a)),M=Math.max(1,Math.round(p*v.d)),O=new DOMMatrix([T/m,0,0,M/p,0,0]),w=W1(T,M).getContext("2d");return hL(w,O,h,h,c),w.getImageData(0,0,T,M)}function hL(d,o,c,h,m){for(const p of h.children)c8(d,o,c,p,m)}function c8(d,o,c,h,m){h.group?(d.save(),function(p,v,T,M,O){const w=M.mask_idx!=null?T.masks[M.mask_idx]:null,P=M.clip_path_idx!=null?T.clip_paths[M.clip_path_idx]:null;if(M.transform&&(v=SA(M.transform).preMultiplySelf(v)),!function(k,N,W){return k.opacity!==255||N||W}(M,P!=null,w!=null))return void hL(p,v,T,M,O);const D=W1(p.canvas.width,p.canvas.height),I=D.getContext("2d");hL(I,v,T,M,O),P&&g8(I,v,T,P),w&&y8(I,v,T,w,O),p.globalAlpha=M.opacity/255,p.drawImage(D,0,0)}(d,o,c,h.group,m),d.restore()):h.path&&(d.save(),function(p,v,T,M,O){const w=v8(M);p.setTransform(v),M.paint_order===o8.PAINT_ORDER_FILL_AND_STROKE?(u8(p,T,M,w,O),h8(p,T,M,w,O)):(h8(p,T,M,w,O),u8(p,T,M,w,O))}(d,o,c,h.path,m),d.restore())}function u8(d,o,c,h,m){const p=c.fill;if(!p)return;const v=p.opacity/255;switch(p.paint){case"rgb_color":d.fillStyle=Jv(p.rgb_color,p.opacity,m);break;case"linear_gradient_idx":d.fillStyle=f8(d,o.linear_gradients[p.linear_gradient_idx],v,m);break;case"radial_gradient_idx":d.fillStyle=p8(d,o.radial_gradients[p.radial_gradient_idx],v,m)}d.fill(h,d8(c))}function d8(d){return d.rule===dL.PATH_RULE_NON_ZERO?"nonzero":d.rule===dL.PATH_RULE_EVEN_ODD?"evenodd":void 0}function h8(d,o,c,h,m){const p=c.stroke;if(!p)return;d.lineWidth=p.width,d.miterLimit=p.miterlimit,d.setLineDash(p.dasharray),d.lineDashOffset=p.dashoffset;const v=p.opacity/255;switch(p.paint){case"rgb_color":d.strokeStyle=Jv(p.rgb_color,p.opacity,m);break;case"linear_gradient_idx":d.strokeStyle=f8(d,o.linear_gradients[p.linear_gradient_idx],v,m);break;case"radial_gradient_idx":d.strokeStyle=p8(d,o.radial_gradients[p.radial_gradient_idx],v,m)}switch(p.linejoin){case V1.LINE_JOIN_MITER_CLIP:case V1.LINE_JOIN_MITER:d.lineJoin="miter";break;case V1.LINE_JOIN_ROUND:d.lineJoin="round";break;case V1.LINE_JOIN_BEVEL:d.lineJoin="bevel"}switch(p.linecap){case _A.LINE_CAP_BUTT:d.lineCap="butt";break;case _A.LINE_CAP_ROUND:d.lineCap="round";break;case _A.LINE_CAP_SQUARE:d.lineCap="square"}d.stroke(h)}function f8(d,o,c,h){if(o.stops.length===1){const D=o.stops[0];return Jv(D.rgb_color,D.opacity*c,h)}const m=SA(o.transform),{x1:p,y1:v,x2:T,y2:M}=o,O=m.transformPoint(new DOMPoint(p,v)),w=m.transformPoint(new DOMPoint(T,M)),P=d.createLinearGradient(O.x,O.y,w.x,w.y);for(const D of o.stops)P.addColorStop(D.offset,Jv(D.rgb_color,D.opacity*c,h));return P}function p8(d,o,c,h){if(o.stops.length===1){const D=o.stops[0];return Jv(D.rgb_color,D.opacity*c,h)}const m=SA(o.transform),{fx:p,fy:v,cx:T,cy:M}=o,O=m.transformPoint(new DOMPoint(p,v)),w=m.transformPoint(new DOMPoint(T,M)),P=d.createRadialGradient(O.x,O.y,0,w.x,w.y,o.r*((m.a+m.d)/2));for(const D of o.stops)P.addColorStop(D.offset,Jv(D.rgb_color,D.opacity*c,h));return P}function m8(d,o,c,h){const m=h.transform?SA(h.transform).preMultiplySelf(o):o,p=W1(d.canvas.width,d.canvas.height),v=p.getContext("2d");for(const M of h.children)if(M.group)m8(v,m,c,M.group);else if(M.path){const O=M.path,w=new Path2D;w.addPath(v8(O),m),v.fill(w,d8(O))}const T=h.clip_path_idx!=null?c.clip_paths[h.clip_path_idx]:null;T&&g8(v,m,c,T),d.globalCompositeOperation="source-over",d.drawImage(p,0,0)}function g8(d,o,c,h){const m=W1(d.canvas.width,d.canvas.height);m8(m.getContext("2d"),o,c,h),d.globalCompositeOperation="destination-in",d.drawImage(m,0,0)}function y8(d,o,c,h,m){if(h.children.length===0)return;const p=h.mask_idx!=null?c.masks[h.mask_idx]:null;p&&y8(d,o,c,p,m);const v=d.canvas.width,T=d.canvas.height,M=W1(v,T),O=M.getContext("2d"),w=h.width,P=h.height,D=h.left,I=h.top,k=new Path2D,N=new Path2D;N.rect(D,I,w,P),k.addPath(N,o),O.clip(k);for(const ee of h.children)c8(O,o,c,ee,m);const W=O.getImageData(0,0,v,T),Z=W.data;if(h.mask_type===a8.MASK_TYPE_LUMINANCE)for(let ee=0;ee<Z.length;ee+=4)Z[ee+3]=Z[ee+3]/255*(.2126*Z[ee]+.7152*Z[ee+1]+.0722*Z[ee+2]);O.putImageData(W,0,0),d.globalCompositeOperation="destination-in",d.drawImage(M,0,0)}function SA(d){return d?new DOMMatrix([d.sx,d.ky,d.kx,d.sy,d.tx,d.ty]):new DOMMatrix}function v8(d){const o=new Path2D,c=d.step;let h=d.diffs[0]*c,m=d.diffs[1]*c;o.moveTo(h,m);for(let p=0,v=2;p<d.commands.length;p++)switch(d.commands[p]){case Kv.PATH_COMMAND_MOVE:h+=d.diffs[v++]*c,m+=d.diffs[v++]*c,o.moveTo(h,m);break;case Kv.PATH_COMMAND_LINE:h+=d.diffs[v++]*c,m+=d.diffs[v++]*c,o.lineTo(h,m);break;case Kv.PATH_COMMAND_QUAD:{const T=h+d.diffs[v++]*c,M=m+d.diffs[v++]*c;h=T+d.diffs[v++]*c,m=M+d.diffs[v++]*c,o.quadraticCurveTo(T,M,h,m);break}case Kv.PATH_COMMAND_CUBIC:{const T=h+d.diffs[v++]*c,M=m+d.diffs[v++]*c,O=T+d.diffs[v++]*c,w=M+d.diffs[v++]*c;h=O+d.diffs[v++]*c,m=w+d.diffs[v++]*c,o.bezierCurveTo(T,M,O,w,h,m);break}case Kv.PATH_COMMAND_CLOSE:o.closePath()}return o}class TA{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const c=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,c),c}put(o,c){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,c)}delete(o){this.cache.delete(o)}}Jt(TA,"LRUCache");class fL{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new Ko(o,o.data)}getFromCache(o,c,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new TA(150)),this.cacheMap.get(h).get(Df(o.toString(),c))}setInCache(o,c,h,m){this.cacheDependenciesMap.has(m)||this.cacheDependenciesMap.set(m,new Map),this.cacheMap.has(m)||this.cacheMap.set(m,new TA(150));const p=this.cacheDependenciesMap.get(m),v=Df(o.id.toString(),h);p.get(v)||p.set(v,new Set);const T=this.cacheMap.get(m),M=o.toString();p.get(v).add(M),T.put(Df(o.toString(),h),c)}removeImagesFromCacheByIds(o,c,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const m=this.cacheMap.get(h),p=this.cacheDependenciesMap.get(h);for(const v of o){const T=Df(v.toString(),c);if(p.has(T)){for(const M of p.get(T))m.delete(M);p.delete(T)}}}rasterize(o,c,h,m,p=ide){const v=this.getFromCache(o,h,m);if(v)return v.clone();const T=p(c.icon,o.options),M=fL._getImage(T);return this.setInCache(o,M,h,m),M.clone()}}class _8{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,c){const h=this.toIdx(o,c);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(o,c){return this.leaves[this.toIdx(o,c)]}toIdx(o,c){return c*this.size+o}}function x8(d,o,c,h){let m=0,p=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(h[v])<1e-15){if(c[v]<d[v]||c[v]>o[v])return null}else{const T=1/h[v];let M=(d[v]-c[v])*T,O=(o[v]-c[v])*T;if(M>O){const w=M;M=O,O=w}if(M>m&&(m=M),O<p&&(p=O),m>p)return null}return m}function b8(d,o,c,h,m,p,v,T,M,O,w){const P=h-d,D=m-o,I=p-c,k=v-d,N=T-o,W=M-c,Z=w[1]*W-w[2]*N,ee=w[2]*k-w[0]*W,Q=w[0]*N-w[1]*k,K=P*Z+D*ee+I*Q;if(Math.abs(K)<1e-15)return null;const ie=1/K,se=O[0]-d,de=O[1]-o,we=O[2]-c,_e=(se*Z+de*ee+we*Q)*ie;if(_e<0||_e>1)return null;const xe=de*I-we*D,ke=we*P-se*I,Se=se*D-de*P,De=(w[0]*xe+w[1]*ke+w[2]*Se)*ie;return De<0||_e+De>1?null:(k*xe+N*ke+W*Se)*ie}function w8(d,o,c){return(d-o)/(c-o)}function S8(d,o,c,h,m,p,v,T,M){const O=1<<c,w=p-h,P=v-m,D=(d+1)/O*w+h,I=(o+0)/O*P+m,k=(o+1)/O*P+m;T[0]=(d+0)/O*w+h,T[1]=I,M[0]=D,M[1]=k}class T8{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(p){const v=Math.ceil(Math.log2(p.dim/8)),T=[];let M=Math.ceil(Math.pow(2,v));const O=1/M,w=(I,k,N,W,Z)=>{const ee=W?1:0,Q=(I+1)*N-ee,K=k*N,ie=(k+1)*N-ee;Z[0]=I*N,Z[1]=K,Z[2]=Q,Z[3]=ie};let P=new _8(M);const D=[];for(let I=0;I<M*M;I++){w(I%M,Math.floor(I/M),O,!1,D);const k=Xf(D[0],D[1],p),N=Xf(D[2],D[1],p),W=Xf(D[2],D[3],p),Z=Xf(D[0],D[3],p);P.minimums.push(Math.min(k,N,W,Z)),P.maximums.push(Math.max(k,N,W,Z)),P.leaves.push(1)}for(T.push(P),M/=2;M>=1;M/=2){const I=T[T.length-1];P=new _8(M);for(let k=0;k<M*M;k++){w(k%M,Math.floor(k/M),2,!0,D);const N=I.getElevation(D[0],D[1]),W=I.getElevation(D[2],D[1]),Z=I.getElevation(D[2],D[3]),ee=I.getElevation(D[0],D[3]),Q=I.isLeaf(D[0],D[1]),K=I.isLeaf(D[2],D[1]),ie=I.isLeaf(D[2],D[3]),se=I.isLeaf(D[0],D[3]),de=Math.min(N.min,W.min,Z.min,ee.min),we=Math.max(N.max,W.max,Z.max,ee.max),_e=Q&&K&&ie&&se;P.maximums.push(we),P.minimums.push(de),P.leaves.push(we-de<=5&&_e?1:0)}T.push(P)}return T}(this.dem),h=c.length-1,m=c[h];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,h,0)}raycastRoot(o,c,h,m,p,v,T=1){return x8([o,c,-100],[h,m,this.maximums[0]*T],p,v)}raycast(o,c,h,m,p,v,T=1){if(!this.nodeCount)return null;const M=this.raycastRoot(o,c,h,m,p,v,T);if(M==null)return null;const O=[],w=[],P=[],D=[],I=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:k,t:N,nodex:W,nodey:Z,depth:ee}=I.pop();if(this.leaves[k]){S8(W,Z,ee,o,c,h,m,P,D);const K=1<<ee,ie=(W+0)/K,se=(W+1)/K,de=(Z+0)/K,we=(Z+1)/K,_e=Xf(ie,de,this.dem)*T,xe=Xf(se,de,this.dem)*T,ke=Xf(se,we,this.dem)*T,Se=Xf(ie,we,this.dem)*T,De=b8(P[0],P[1],_e,D[0],P[1],xe,D[0],D[1],ke,p,v),Ve=b8(D[0],D[1],ke,P[0],D[1],Se,P[0],P[1],_e,p,v),Fe=Math.min(De!==null?De:Number.MAX_VALUE,Ve!==null?Ve:Number.MAX_VALUE);if(Fe!==Number.MAX_VALUE)return Fe;{const Ze=ge.vec3.scaleAndAdd([],p,v,N);if(E8(_e,xe,Se,ke,w8(Ze[0],P[0],D[0]),w8(Ze[1],P[1],D[1]))>=Ze[2])return N}continue}let Q=0;for(let K=0;K<this._siblingOffset.length;K++){S8((W<<1)+this._siblingOffset[K][0],(Z<<1)+this._siblingOffset[K][1],ee+1,o,c,h,m,P,D),P[2]=-100,D[2]=this.maximums[this.childOffsets[k]+K]*T;const ie=x8(P,D,p,v);if(ie!=null){const se=ie;O[K]=se;let de=!1;for(let we=0;we<Q&&!de;we++)se>=O[w[we]]&&(w.splice(we,0,K),de=!0);de||(w[Q]=K),Q++}}for(let K=0;K<Q;K++){const ie=w[K];I.push({idx:this.childOffsets[k]+ie,t:O[ie],nodex:(W<<1)+this._siblingOffset[ie][0],nodey:(Z<<1)+this._siblingOffset[ie][1],depth:ee+1})}}return null}_addNode(o,c,h){return this.minimums.push(o),this.maximums.push(c),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(o,c,h,m,p){if(o[m].isLeaf(c,h)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const v=m-1,T=o[v];let M=0,O=0;for(let w=0;w<this._siblingOffset.length;w++){const P=2*c+this._siblingOffset[w][0],D=2*h+this._siblingOffset[w][1],I=T.getElevation(P,D),k=T.isLeaf(P,D),N=this._addNode(I.min,I.max,k);k&&(M|=1<<w),O||(O=N)}for(let w=0;w<this._siblingOffset.length;w++)M&1<<w||this._construct(o,2*c+this._siblingOffset[w][0],2*h+this._siblingOffset[w][1],v,O+w)}}function E8(d,o,c,h,m,p){return _r(_r(d,c,p),_r(o,h,p),m)}function Xf(d,o,c){const h=c.dim,m=Kt(d*h-.5,0,h-1),p=Kt(o*h-.5,0,h-1),v=Math.floor(m),T=Math.floor(p),M=Math.min(v+1,h-1),O=Math.min(T+1,h-1);return E8(c.get(v,T),c.get(M,T),c.get(v,O),c.get(M,O),m-v,p-T)}const ode={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function ade(d,o,c){return(256*d*256+256*o+c)/10-1e4}function sde(d,o,c){return 256*d+o+c/256-32768}class EA{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,c,h,m=!1){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void pi(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const p=this.dim=c.height-2,v=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.floatView=new Float32Array(c.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let M=0;M<p;M++)v[this._idx(-1,M)]=v[this._idx(0,M)],v[this._idx(p,M)]=v[this._idx(p-1,M)],v[this._idx(M,-1)]=v[this._idx(M,0)],v[this._idx(M,p)]=v[this._idx(M,p-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(p,-1)]=v[this._idx(p-1,0)],v[this._idx(-1,p)]=v[this._idx(0,p-1)],v[this._idx(p,p)]=v[this._idx(p-1,p-1)]}const T=h==="terrarium"?sde:ade;for(let M=0;M<v.length;++M){const O=4*M;this.floatView[M]=T(this.pixels[O],this.pixels[O+1],this.pixels[O+2])}this._timestamp=pt.now()}_buildQuadTree(){this._tree=new T8(this)}get(o,c,h=!1){h&&(o=Kt(o,-1,this.dim),c=Kt(c,-1,this.dim));const m=this._idx(o,c);return this.floatView[m]}set(o,c,h){const m=this._idx(o,c),p=this.floatView[m];return this.floatView[m]=h,h-p}static getUnpackVector(o){return ode[o]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}static pack(o,c){const h=[0,0,0,0],m=EA.getUnpackVector(c);let p=Math.floor((o+m[3])/m[2]);return h[2]=p%256,p=Math.floor(p/256),h[1]=p%256,p=Math.floor(p/256),h[0]=p,h}getPixels(){return new DU({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,c,h){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,p=c*this.dim+this.dim,v=h*this.dim,T=h*this.dim+this.dim;switch(c){case-1:m=p-1;break;case 1:p=m+1}switch(h){case-1:v=T-1;break;case 1:T=v+1}const M=-c*this.dim,O=-h*this.dim;for(let w=v;w<T;w++)for(let P=m;P<p;P++){const D=4*this._idx(P,w),I=4*this._idx(P+M,w+O);this.pixels[D+0]=o.pixels[I+0],this.pixels[D+1]=o.pixels[I+1],this.pixels[D+2]=o.pixels[I+2],this.pixels[D+3]=o.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function lde(d,o,c){d===1?o.headerLength=c.readFixed32():d===2?o.x=c.readVarint():d===3?o.y=c.readVarint():d===4?o.z=c.readVarint():d===5&&o.layers.push(function(h,m){return h.readFields(fde,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(c,c.readVarint()+c.pos))}function cde(d,o,c){d===1?(o.delta_filter=function(h,m){return h.readFields(ude,{blockSize:0},m)}(c,c.readVarint()+c.pos),o.filter="delta_filter"):d===2?(c.readVarint(),o.filter="zigzag_filter"):d===3?(c.readVarint(),o.filter="bitshuffle_filter"):d===4&&(c.readVarint(),o.filter="byteshuffle_filter")}function ude(d,o,c){d===1&&(o.blockSize=c.readVarint())}function dde(d,o,c){d===1?(c.readVarint(),o.codec="gzip_data"):d===2?(c.readVarint(),o.codec="jpeg_image"):d===3?(c.readVarint(),o.codec="webp_image"):d===4&&(c.readVarint(),o.codec="png_image")}function hde(d,o,c){let h=0,m=0;d===1?o.firstByte=c.readFixed64():d===2?o.lastByte=c.readFixed64():d===3?o.filters.push(function(p,v){return p.readFields(cde,{},v)}(c,c.readVarint()+c.pos)):d===4?o.codec=function(p,v){return p.readFields(dde,{},v)}(c,c.readVarint()+c.pos):d===5?m=c.readFloat():d===6?h=c.readFloat():d===7?o.bands.push(c.readString()):d===8?o.offset=c.readDouble():d===9&&(o.scale=c.readDouble()),o.offset===0&&(o.offset=m),o.scale===0&&(o.scale=h)}function fde(d,o,c){d===1?o.version=c.readVarint():d===2?o.name=c.readString():d===3?o.units=c.readString():d===4?o.tileSize=c.readVarint():d===5?o.buffer=c.readVarint():d===6?o.pixelFormat=c.readVarint():d===7&&o.dataIndex.push(function(h,m){return h.readFields(hde,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(c,c.readVarint()+c.pos))}function pde(d,o,c){if(d===2)(function(h,m,p){h.readFields(mde,p,m)})(c,c.readVarint()+c.pos,o);else if(d===3)throw new Error("Not implemented")}function mde(d,o,c){if(d===1){let h=0;const m=c.readVarint()+c.pos;for(;c.pos<m;)o[h++]=c.readVarint()}}function gde(d,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let c=o[3];for(let h=2;h>=1;h--){const m=h===1?1:0,p=h===2?1:0;for(let v=0;v<o[0];v++){const T=o[1]*v;for(let M=m;M<o[1];M++){const O=o[2]*(M+T);for(let w=p;w<o[2];w++){const P=o[3]*(w+O);for(let D=0;D<o[3];D++){const I=P+D;d[I]+=d[I-c]}}}}c*=o[h]}return d}function yde(d){for(let o=0,c=d.length;o<c;o++)d[o]=d[o]>>>1^-(1&d[o]);return d}function vde(d,o){switch(o){case"uint32":return d;case"uint16":for(let c=0;c<d.length;c+=2){const h=d[c],m=d[c+1];d[c]=(240&h)>>4|(61440&h)>>8|(240&m)<<4|61440&m,d[c+1]=15&h|(3840&h)>>4|(15&m)<<8|(3840&m)<<4}return d;case"uint8":for(let c=0;c<d.length;c+=4){const h=d[c],m=d[c+1],p=d[c+2],v=d[c+3];d[c+0]=(192&h)>>6|(192&m)>>4|(192&p)>>2|192&v,d[c+1]=(48&h)>>4|(48&m)>>2|48&p|(48&v)<<2,d[c+2]=(12&h)>>2|12&m|(12&p)<<2|(12&v)<<4,d[c+3]=3&h|(3&m)<<2|(3&p)<<4|(3&v)<<6}return d;default:throw new Error(`Invalid pixel format, "${o}"`)}}Jt(EA,"DEMData"),Jt(T8,"DemMinMaxQuadTree",{omit:["dem"]});var Al=Uint8Array,G1=Uint16Array,_de=Int32Array,A8=new Al([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),M8=new Al([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xde=new Al([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),C8=function(d,o){for(var c=new G1(31),h=0;h<31;++h)c[h]=o+=1<<d[h-1];var m=new _de(c[30]);for(h=1;h<30;++h)for(var p=c[h];p<c[h+1];++p)m[p]=p-c[h]<<5|h;return{b:c,r:m}},P8=C8(A8,2),I8=P8.b,bde=P8.r;I8[28]=258,bde[258]=28;for(var wde=C8(M8,0).b,O8=new G1(32768),io=0;io<32768;++io){var Qv=(43690&io)>>1|(21845&io)<<1;O8[io]=((65280&(Qv=(61680&(Qv=(52428&Qv)>>2|(13107&Qv)<<2))>>4|(3855&Qv)<<4))>>8|(255&Qv)<<8)>>1}var q1=function(d,o,c){for(var h=d.length,m=0,p=new G1(o);m<h;++m)d[m]&&++p[d[m]-1];var v,T=new G1(o);for(m=1;m<o;++m)T[m]=T[m-1]+p[m-1]<<1;v=new G1(1<<o);var M=15-o;for(m=0;m<h;++m)if(d[m])for(var O=m<<4|d[m],w=o-d[m],P=T[d[m]-1]++<<w,D=P|(1<<w)-1;P<=D;++P)v[O8[P]>>M]=O;return v},H1=new Al(288);for(io=0;io<144;++io)H1[io]=8;for(io=144;io<256;++io)H1[io]=9;for(io=256;io<280;++io)H1[io]=7;for(io=280;io<288;++io)H1[io]=8;var k8=new Al(32);for(io=0;io<32;++io)k8[io]=5;var Sde=q1(H1,9),Tde=q1(k8,5),pL=function(d){for(var o=d[0],c=1;c<d.length;++c)d[c]>o&&(o=d[c]);return o},Qc=function(d,o,c){var h=o/8|0;return(d[h]|d[h+1]<<8)>>(7&o)&c},mL=function(d,o){var c=o/8|0;return(d[c]|d[c+1]<<8|d[c+2]<<16)>>(7&o)},Ede=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],eu=function(d,o,c){var h=new Error(o||Ede[d]);if(h.code=d,Error.captureStackTrace&&Error.captureStackTrace(h,eu),!c)throw h;return h},Ade=new Al(0),Mde=typeof TextDecoder<"u"&&new TextDecoder;try{Mde.decode(Ade,{stream:!0})}catch{}const Cde={gzip_data:"gzip"};class lc extends Error{constructor(o){super(o),this.name="MRTError"}}const Pde={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},R8={uint32:1,uint16:2,uint8:4},Ide={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let gL;class AA{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const c=this.layers[o];if(!c)throw new lc(`Layer '${o}' not found`);return c}getHeaderLength(o){const c=new Uint8Array(o),h=new DataView(o);if(c[0]!==13)throw new lc("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(o){const c=new Uint8Array(o),h=this.getHeaderLength(o);if(c.length<h)throw new lc(`Expected header with length >= ${h} but got buffer of length ${c.length}`);const m=function(p,v){return p.readFields(lde,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new gL(c.subarray(0,h)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new lc(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const p of m.layers)this.layers[p.name]=new D8(p,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const c=[],h=this.getLayer(o.layerName);for(let m of o.blockIndices){const p=h.dataIndex[m],v=p.firstByte-o.firstByte,T=p.lastByte-o.firstByte;if(h._blocksInProgress.has(m))continue;const M={layerName:h.name,firstByte:v,lastByte:T,pixelFormat:h.pixelFormat,blockIndex:m,blockShape:[p.bands.length].concat(h.bandShape),buffer:h.buffer,codec:p.codec.codec,filters:p.filters.map(O=>O.filter)};h._blocksInProgress.add(m),c.push(M)}return new L8(c,()=>{c.forEach(m=>h._blocksInProgress.delete(m.blockIndex))},(m,p)=>{if(c.forEach(v=>h._blocksInProgress.delete(v.blockIndex)),m)throw m;p.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class D8{constructor({version:o,name:c,units:h,tileSize:m,pixelFormat:p,buffer:v,dataIndex:T},M){if(this.version=o,this.version!==1)throw new lc(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=c,this.units=h,this.tileSize=m,this.buffer=v,this.pixelFormat=Pde[p],this.dataIndex=T,this.bandShape=[m+2*v,m+2*v,R8[this.pixelFormat]],this._decodedBlocks=new TA(M?M.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return R8[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const c=o.blockIndex.toString();this._decodedBlocks.get(c)||this._decodedBlocks.put(c,o.data)}getBlockForBand(o){let c=0;switch(typeof o){case"string":for(const[h,m]of this.dataIndex.entries()){for(const[p,v]of m.bands.entries())if(v===o)return{bandIndex:c+p,blockIndex:h,blockBandIndex:p};c+=m.bands.length}break;case"number":for(const[h,m]of this.dataIndex.entries()){if(o>=c&&o<c+m.bands.length)return{bandIndex:o,blockIndex:h,blockBandIndex:o-c};c+=m.bands.length}break;default:throw new lc(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}throw new lc(`Band not found: ${JSON.stringify(o)}`)}getDataRange(o){let c=1/0,h=-1/0;const m=[],p=new Set;for(const v of o){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new lc(`Invalid band: ${JSON.stringify(v)}`);const M=this.dataIndex[T];m.includes(T)||m.push(T),p.add(T),c=Math.min(c,M.firstByte),h=Math.max(h,M.lastByte)}if(p.size>this.cacheSize)throw new lc(`Number of blocks to decode (${p.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:c,lastByte:h,blockIndices:m}}hasBand(o){const{blockIndex:c}=this.getBlockForBand(o);return c>=0}hasDataForBand(o){const{blockIndex:c}=this.getBlockForBand(o);return c>=0&&!!this._decodedBlocks.get(c.toString())}getBandView(o){const{blockIndex:c,blockBandIndex:h}=this.getBlockForBand(o),m=this._decodedBlocks.get(c.toString());if(!m)throw new lc(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const p=this.dataIndex[c],v=this.bandShape.reduce((O,w)=>O*w,1),T=h*v,M=m.subarray(T,T+v);return{data:M,bytes:new Uint8Array(M.buffer).subarray(M.byteOffset,M.byteOffset+M.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:p.offset,scale:p.scale}}}AA.setPbf=function(d){gL=d};class L8{constructor(o,c,h){this.tasks=o,this._onCancel=c,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,c){this._finalized||(this._onComplete(o,c),this._finalized=!0)}}AA.performDecoding=function(d,o){const c=new Uint8Array(d);return Promise.all(o.tasks.map(h=>{const{layerName:m,firstByte:p,lastByte:v,pixelFormat:T,blockShape:M,blockIndex:O,filters:w,codec:P}=h,D=c.subarray(p,v+1),I=new Uint32Array(M[0]*M[1]*M[2]);let k;if(P!=="gzip_data")throw new lc(`Unhandled codec: ${P}`);return k=function(N,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((K=function(de){de[0]==31&&de[1]==139&&de[2]==8||eu(6,"invalid gzip data");var we=de[3],_e=10;4&we&&(_e+=2+(de[10]|de[11]<<8));for(var xe=(we>>3&1)+(we>>4&1);xe>0;xe-=!de[_e++]);return _e+(2&we)}(Q=N))+8>Q.length&&eu(6,"invalid gzip data"),function(de,we,_e,xe){var ke=de.length;if(!ke||we.f&&!we.l)return _e||new Al(0);var Se=!_e,De=Se||we.i!=2,Ve=we.i;Se&&(_e=new Al(3*ke));var Fe,Ze,He=function(Kf){var Jf=_e.length;if(Kf>Jf){var vg=new Al(Math.max(2*Jf,Kf));vg.set(_e),_e=vg}},tt=we.f||0,Ke=we.p||0,nt=we.b||0,Ct=we.l,At=we.d,Qt=we.m,Rt=we.n,Ft=8*ke;do{if(!Ct){tt=Qc(de,Ke,1);var It=Qc(de,Ke+1,3);if(Ke+=3,!It){var yr=de[(Ar=4+((Ke+7)/8|0))-4]|de[Ar-3]<<8,Zt=Ar+yr;if(Zt>ke){Ve&&eu(0);break}De&&He(nt+yr),_e.set(de.subarray(Ar,Zt),nt),we.b=nt+=yr,we.p=Ke=8*Zt,we.f=tt;continue}if(It==1)Ct=Sde,At=Tde,Qt=9,Rt=5;else if(It==2){var nr=Qc(de,Ke,31)+257,Er=Qc(de,Ke+10,15)+4,Vr=nr+Qc(de,Ke+5,31)+1;Ke+=14;for(var Cr=new Al(Vr),Yr=new Al(19),Ur=0;Ur<Er;++Ur)Yr[xde[Ur]]=Qc(de,Ke+3*Ur,7);Ke+=3*Er;var Qr=pL(Yr),un=(1<<Qr)-1,Un=q1(Yr,Qr);for(Ur=0;Ur<Vr;){var Ar,an=Un[Qc(de,Ke,un)];if(Ke+=15&an,(Ar=an>>4)<16)Cr[Ur++]=Ar;else{var ri=0,gi=0;for(Ar==16?(gi=3+Qc(de,Ke,3),Ke+=2,ri=Cr[Ur-1]):Ar==17?(gi=3+Qc(de,Ke,7),Ke+=3):Ar==18&&(gi=11+Qc(de,Ke,127),Ke+=7);gi--;)Cr[Ur++]=ri}}var wi=Cr.subarray(0,nr),Ei=Cr.subarray(nr);Qt=pL(wi),Rt=pL(Ei),Ct=q1(wi,Qt),At=q1(Ei,Rt)}else eu(1);if(Ke>Ft){Ve&&eu(0);break}}De&&He(nt+131072);for(var zn=(1<<Qt)-1,bo=(1<<Rt)-1,Da=Ke;;Da=Ke){var Zi=(ri=Ct[mL(de,Ke)&zn])>>4;if((Ke+=15&ri)>Ft){Ve&&eu(0);break}if(ri||eu(2),Zi<256)_e[nt++]=Zi;else{if(Zi==256){Da=Ke,Ct=null;break}var oo=Zi-254;Zi>264&&(oo=Qc(de,Ke,(1<<(Ml=A8[Ur=Zi-257]))-1)+I8[Ur],Ke+=Ml);var ca=At[mL(de,Ke)&bo],Vo=ca>>4;if(ca||eu(3),Ke+=15&ca,Ei=wde[Vo],Vo>3){var Ml=M8[Vo];Ei+=mL(de,Ke)&(1<<Ml)-1,Ke+=Ml}if(Ke>Ft){Ve&&eu(0);break}De&&He(nt+131072);var Yf=nt+oo;if(nt<Ei){var cc=0-Ei,ru=Math.min(Ei,Yf);for(cc+nt<0&&eu(3);nt<ru;++nt)_e[nt]=(void 0)[cc+nt]}for(;nt<Yf;++nt)_e[nt]=_e[nt-Ei]}}we.l=Ct,we.p=Da,we.b=nt,we.f=tt,Ct&&(tt=1,we.m=Qt,we.d=At,we.n=Rt)}while(!tt);return nt!=_e.length&&Se?(Fe=_e,((Ze=nt)==null||Ze>Fe.length)&&(Ze=Fe.length),new Al(Fe.subarray(0,Ze))):_e.subarray(0,nt)}(Q.subarray(K,-8),{i:2},new Al(((Z=Q)[(ee=Z.length)-4]|Z[ee-3]<<8|Z[ee-2]<<16|Z[ee-1]<<24)>>>0))));var Z,ee,Q,K;const ie=Cde[W];if(!ie)throw new Error(`Unhandled codec: ${W}`);const se=new globalThis.DecompressionStream(ie);return new Response(new Blob([N]).stream().pipeThrough(se)).arrayBuffer().then(de=>new Uint8Array(de))}(D,P).then(N=>(function(W,Z){W.readFields(pde,Z)}(new gL(N),I),new Ide[T](I.buffer))),k.then(N=>{for(let W=w.length-1;W>=0;W--)switch(w[W]){case"delta_filter":gde(N,M);break;case"zigzag_filter":yde(N);break;case"bitshuffle_filter":vde(N,T);break;default:throw new lc(`Unhandled filter "${w[W]}"`)}return{layerName:m,blockIndex:O,data:N}}).catch(N=>{throw N})}))},Jt(L8,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Jt(AA,"MapboxRasterTile"),Jt(D8,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let Z1,yL,tu,e_,vL,t_=null;function N8(){return Li()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:yL||pe.DRACO_URL}function z8(){if(Li()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(e_)return e_;const d=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return e_=WebAssembly.validate(d)?pe.MESHOPT_SIMD_URL:pe.MESHOPT_URL,e_}const MA={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ode={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},X1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function j8(d,o,c){const h=c.json.bufferViews.length,m=c.buffers.length;o.bufferView=h,c.json.bufferViews[h]={buffer:m,byteLength:d.byteLength},c.buffers[m]=d}const _L="KHR_draco_mesh_compression";function kde(d,o){const c=d.extensions&&d.extensions[_L];if(!c)return;const h=new tu.Decoder,m=U8(o,c.bufferView),p=new tu.Mesh;if(!h.DecodeArrayToMesh(m,m.byteLength,p))throw new Error("Failed to decode Draco mesh");const v=o.json.accessors[d.indices],T=MA[v.componentType],M=v.count*T.BYTES_PER_ELEMENT,O=tu._malloc(M);T===Uint16Array?h.GetTrianglesUInt16Array(p,M,O):h.GetTrianglesUInt32Array(p,M,O),j8(tu.memory.buffer.slice(O,O+M),v,o),tu._free(O);for(const w of Object.keys(c.attributes)){const P=h.GetAttributeByUniqueId(p,c.attributes[w]),D=o.json.accessors[d.attributes[w]],I=Ode[D.componentType],k=D.count*X1[D.type]*MA[D.componentType].BYTES_PER_ELEMENT,N=tu._malloc(k);h.GetAttributeDataArrayForAllPoints(p,P,tu[I],k,N),j8(tu.memory.buffer.slice(N,N+k),D,o),tu._free(N)}h.destroy(),p.destroy(),delete d.extensions[_L]}const CA="EXT_meshopt_compression";function Rde(d,o){if(!d.extensions||!d.extensions[CA])return;const c=d.extensions[CA],h=new Uint8Array(o.buffers[c.buffer],c.byteOffset||0,c.byteLength||0),m=new Uint8Array(c.count*c.byteStride);vL.decodeGltfBuffer(m,c.count,c.byteStride,h,c.mode,c.filter),d.buffer=o.buffers.length,d.byteOffset=0,o.buffers[d.buffer]=m.buffer,delete d.extensions[CA]}const F8=1179937895,B8=new TextDecoder("utf8");function $8(d,o){return new URL(d,o).href}function Dde(d,o,c,h){return fetch($8(d.uri,h)).then(m=>m.arrayBuffer()).then(m=>{o.buffers[c]=m})}function U8(d,o){const c=d.json.bufferViews[o];return new Uint8Array(d.buffers[c.buffer],c.byteOffset||0,c.byteLength)}function Lde(d,o,c,h){if(d.uri){const m=$8(d.uri,h);return fetch(m).then(p=>p.blob()).then(p=>createImageBitmap(p)).then(p=>{o.images[c]=p})}if(d.bufferView!==void 0){const m=U8(o,d.bufferView),p=new Blob([m],{type:d.mimeType});return createImageBitmap(p).then(v=>{o.images[c]=v})}}function V8(d,o=0,c){const h={json:null,images:[],buffers:[]};if(new Uint32Array(d,o,1)[0]===F8){const w=new Uint32Array(d,o);let P=2;const D=(w[P++]>>2)-3,I=w[P++]>>2;if(P++,h.json=JSON.parse(B8.decode(w.subarray(P,P+I))),P+=I,P<D){const k=w[P++];P++;const N=o+(P<<2);h.buffers[0]=d.slice(N,N+k)}}else h.json=JSON.parse(B8.decode(new Uint8Array(d,o)));const{buffers:m,images:p,meshes:v,extensionsUsed:T,bufferViews:M}=h.json;let O=Promise.resolve();if(m){const w=[];for(let P=0;P<m.length;P++){const D=m[P];D.uri?w.push(Dde(D,h,P,c)):h.buffers[P]||(h.buffers[P]=null)}O=Promise.all(w)}return O.then(()=>{const w=[],P=T&&T.includes(_L),D=T&&T.includes(CA);if(P&&w.push(function(){if(!tu)return Z1??(Z1=function(I){let k,N=null;function W(){k=new Uint8Array(N.buffer)}function Z(){throw new Error("Unexpected Draco error.")}const ee={a:{a:Z,d:function(Q,K,ie){return k.copyWithin(Q,K,K+ie)},c:function(Q){const K=k.length,ie=Math.max(Q>>>0,Math.ceil(1.2*K)),se=Math.ceil((ie-K)/65536);try{return N.grow(se),W(),!0}catch{return!1}},b:Z}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(I,ee):I.then(Q=>Q.arrayBuffer()).then(Q=>WebAssembly.instantiate(Q,ee))).then(Q=>{const{Rb:K,Qb:ie,P:se,T:de,X:we,Ja:_e,La:xe,Qa:ke,Va:Se,Wa:De,eb:Ve,jb:Fe,f:Ze,e:He,yb:tt,zb:Ke,Ab:nt,Bb:Ct,Db:At,Gb:Qt}=Q.instance.exports;N=He;const Rt=(()=>{let Ft=0,It=0,yr=0,Zt=0;return nr=>{yr&&(K(Zt),K(Ft),It+=yr,yr=Ft=0),Ft||(It+=128,Ft=ie(It));const Er=nr.length+7&-8;let Vr=Ft;Er>=It&&(yr=Er,Vr=Zt=ie(Er));for(let Cr=0;Cr<nr.length;Cr++)k[Vr+Cr]=nr[Cr];return Vr}})();return W(),Ze(),{memory:He,_free:K,_malloc:ie,Mesh:class{constructor(){this.ptr=se()}destroy(){de(this.ptr)}},Decoder:class{constructor(){this.ptr=_e()}destroy(){Fe(this.ptr)}DecodeArrayToMesh(Ft,It,yr){const Zt=Rt(Ft),nr=xe(this.ptr,Zt,It,yr.ptr);return!!we(nr)}GetAttributeByUniqueId(Ft,It){return{ptr:ke(this.ptr,Ft.ptr,It)}}GetTrianglesUInt16Array(Ft,It,yr){Se(this.ptr,Ft.ptr,It,yr)}GetTrianglesUInt32Array(Ft,It,yr){De(this.ptr,Ft.ptr,It,yr)}GetAttributeDataArrayForAllPoints(Ft,It,yr,Zt,nr){Ve(this.ptr,Ft.ptr,It.ptr,yr,Zt,nr)}},DT_INT8:tt(),DT_UINT8:Ke(),DT_INT16:nt(),DT_UINT16:Ct(),DT_UINT32:At(),DT_FLOAT32:Qt()}})}(fetch(N8())),Z1.then(I=>{tu=I,Z1=void 0}))}()),D&&w.push(function(){if(vL)return;const I=function(k){let N;const W=WebAssembly.instantiateStreaming(k,{}).then(Q=>{N=Q.instance,N.exports.__wasm_call_ctors()}),Z={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ee={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(Q,K,ie,se,de,we){(function(_e,xe,ke,Se,De,Ve,Fe){const Ze=_e.exports.sbrk,He=Se+3&-4,tt=Ze(He*De),Ke=Ze(Ve.length),nt=new Uint8Array(_e.exports.memory.buffer);nt.set(Ve,Ke);const Ct=xe(tt,Se,De,Ke,Ve.length);if(Ct===0&&Fe&&Fe(tt,He,De),ke.set(nt.subarray(tt,tt+Se*De)),Ze(tt-Ze(0)),Ct!==0)throw new Error(`Malformed buffer data: ${Ct}`)})(N,N.exports[ee[de]],Q,K,ie,se,N.exports[Z[we]])}}}(fetch(z8()));return I.ready.then(()=>{vL=I})}()),p)for(let I=0;I<p.length;I++)w.push(Lde(p[I],h,I,c));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(P&&v)for(const{primitives:I}of v)for(const k of I)kde(k,h);if(D&&v&&M)for(const I of M)Rde(I,h);return h})})}function yg(d,o){const c=d.json.bufferViews[o.bufferView],h=MA[o.componentType];return new h(d.buffers[c.buffer],(o.byteOffset||0)+(c.byteOffset||0),o.count*(c.byteStride&&c.byteStride!==X1[o.type]*h.BYTES_PER_ELEMENT?c.byteStride/h.BYTES_PER_ELEMENT:X1[o.type]))}function xL(d,o,c,h){const m=MA[o.componentType],p=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),v=d.json.bufferViews[o.bufferView],T=v.byteStride?v.byteStride/m.BYTES_PER_ELEMENT:X1[o.type],M=c.float32,O=M.length/c.capacity;for(let w=0,P=0;w<o.count*T;w+=T,P+=O)for(let D=0;D<O;D++)M[P+D]=h[w+D]*p;c._trim()}function Nde(d,o,c){const h=d.indices,m=d.attributes,p={};p.indexArray=new Bo;const v=o.json.accessors[h],T=v.count/3;p.indexArray.reserve(T);const M=yg(o,v);for(let D=0;D<T;D++)p.indexArray.emplaceBack(M[3*D],M[3*D+1],M[3*D+2]);p.indexArray._trim(),p.vertexArray=new Tl;const O=o.json.accessors[m.POSITION];p.vertexArray.reserve(O.count);const w=yg(o,O);for(let D=0;D<O.count;D++)p.vertexArray.emplaceBack(w[3*D],w[3*D+1],w[3*D+2]);if(p.vertexArray._trim(),p.aabb=new or(O.min,O.max),p.centroid=function(D,I){const k=[0,0,0],N=D.length;if(N>0){for(let W=0;W<N;W++){const Z=3*D[W];k[0]+=I[Z],k[1]+=I[Z+1],k[2]+=I[Z+2]}k[0]/=N,k[1]/=N,k[2]/=N}return k}(M,w),m.COLOR_0!==void 0){const D=o.json.accessors[m.COLOR_0],I=X1[D.type],k=yg(o,D);p.colorArray=I===3?new Tl:new Qd,p.colorArray.resize(D.count),xL(o,D,p.colorArray,k)}if(m.NORMAL!==void 0){p.normalArray=new Tl;const D=o.json.accessors[m.NORMAL];p.normalArray.resize(D.count);const I=yg(o,D);xL(o,D,p.normalArray,I)}if(m.TEXCOORD_0!==void 0&&c.length>0){p.texcoordArray=new Nf;const D=o.json.accessors[m.TEXCOORD_0];p.texcoordArray.resize(D.count);const I=yg(o,D);xL(o,D,p.texcoordArray,I)}if(m._FEATURE_ID_RGBA4444!==void 0){const D=o.json.accessors[m._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(p.featureData=yg(o,D))}m._FEATURE_RGBA4444!==void 0&&(p.featureData=new Uint32Array(yg(o,o.json.accessors[m._FEATURE_RGBA4444]).buffer));const P=d.material;return p.material=function(D,I){const{emissiveFactor:k=[0,0,0],alphaMode:N="OPAQUE",alphaCutoff:W=.5,normalTexture:Z,occlusionTexture:ee,emissiveTexture:Q,doubleSided:K}=D,{baseColorFactor:ie=[1,1,1,1],metallicFactor:se=1,roughnessFactor:de=1,baseColorTexture:we,metallicRoughnessTexture:_e}=D.pbrMetallicRoughness||{},xe=ee?I[ee.index]:void 0;if(ee&&ee.extensions&&ee.extensions.KHR_texture_transform&&xe){const ke=ee.extensions.KHR_texture_transform;xe.offsetScale=[ke.offset[0],ke.offset[1],ke.scale[0],ke.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new An(...ie),metallicFactor:se,roughnessFactor:de,baseColorTexture:we?I[we.index]:void 0,metallicRoughnessTexture:_e?I[_e.index]:void 0},doubleSided:K,emissiveFactor:k,alphaMode:N,alphaCutoff:W,normalTexture:Z?I[Z.index]:void 0,occlusionTexture:xe,emissionTexture:Q?I[Q.index]:void 0,defined:D.defined===void 0}}(P!==void 0?o.json.materials[P]:{defined:!1},c),p}function W8(d,o,c){const{matrix:h,rotation:m,translation:p,scale:v,mesh:T,extras:M,children:O}=d,w={};if(w.matrix=h||ge.mat4.fromRotationTranslationScale([],m||[0,0,0,1],p||[0,0,0],v||[1,1,1]),T!==void 0){w.meshes=c[T];const P=w.anchor=[0,0];for(const D of w.meshes){const{min:I,max:k}=D.aabb;P[0]+=I[0]+k[0],P[1]+=I[1]+k[1]}P[0]=Math.floor(P[0]/w.meshes.length/2),P[1]=Math.floor(P[1]/w.meshes.length/2)}if(M&&(M.id&&(w.id=M.id),M.lights&&(w.lights=function(P){if(!P.length)return[];const D=function(Z){const ee=atob(Z),Q=new Uint8Array(ee.length);for(let K=0;K<ee.length;K++)Q[K]=ee.codePointAt(K);return Q}(P),I=[],k=D.length/24,N=new Uint16Array(D.buffer),W=new Float32Array(D.buffer);for(let Z=0;Z<k;Z++){const ee=N[2*Z*6]/30,Q=N[2*Z*6+1]/30,K=N[2*Z*6+10]/100,ie=W[6*Z+1],se=W[6*Z+2],de=W[6*Z+3],we=W[6*Z+4],_e=de-ie,xe=we-se,ke=Math.hypot(_e,xe);I.push({pos:[ie+.5*_e,se+.5*xe,Q],normal:[xe/ke,-_e/ke,0],width:ke,height:ee,depth:K,points:[ie,se,de,we]})}return I}(M.lights))),O){const P=[];for(const D of O)P.push(W8(o.json.nodes[D],o,c));w.children=P}return w}function zde(d){if(d.vertices.length===0||d.indices.length===0)return null;const o=new MD(d.vertices,d.indices,8,256),[c,h]=[o.min.clone(),o.max.clone()];return{vertices:d.vertices,indices:d.indices,grid:o,min:c,max:h}}function jde(d){if(!d.extras||!d.extras.ground)return null;const o=d.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;const c=o[0];if(!c||!Array.isArray(c)||c.length===0)return null;const h=[];for(const v of c){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],M=v[1];typeof T=="number"&&typeof M=="number"&&h.push(new _t(T,M))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let m=0;for(let v=0;v<h.length;v++){const T=h[v],M=h[(v+1)%h.length],O=h[(v+2)%h.length];m+=(T.x-M.x)*(O.y-M.y)-(O.x-M.x)*(T.y-M.y)}m>0&&h.reverse();const p=x1(h.flatMap(v=>[v.x,v.y]),[]);return p.length===0?null:{vertices:h,indices:p}}function Fde(d,o){const c=[],h=[];let m=0;const p=[];for(const v of d){m=c.length;const T=v.vertexArray.float32,M=v.indexArray.uint16;for(let O=0;O<v.vertexArray.length;O++)p[0]=T[3*O+0],p[1]=T[3*O+1],p[2]=T[3*O+2],ge.vec3.transformMat4(p,p,o),c.push(new _t(p[0],p[1]));for(let O=0;O<3*v.indexArray.length;O++)h.push(M[O]+m)}if(h.length%3!=0)return null;for(let v=0;v<h.length;v+=3){const T=c[h[v+0]],M=c[h[v+1]],O=c[h[v+2]];(T.x-M.x)*(O.y-M.y)-(O.x-M.x)*(T.y-M.y)>0&&([h[v+1],h[v+2]]=[h[v+2],h[v+1]])}return{vertices:c,indices:h}}function G8(d){const o=function(M,O){const w=[],P=WebGL2RenderingContext;if(M.json.textures)for(const D of M.json.textures){const I={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};D.sampler!==void 0&&Object.assign(I,M.json.samplers[D.sampler]),w.push({image:O[D.source],sampler:I,uploaded:!1})}return w}(d,d.images),c=function(M,O){const w=[];for(const P of M.json.meshes){const D=[];for(const I of P.primitives)D.push(Nde(I,M,O));w.push(D)}return w}(d,o),{scenes:h,scene:m,nodes:p}=d.json,v=h?h[m||0].nodes:p,T=[];for(const M of v)T.push(W8(p[M],d,c));return function(M,O,w){const P={},D=new Set;for(let I=0;I<M.length;I++){const k=w[O[I]];if(!k.extras)continue;const N=k.extras["mapbox:footprint:version"],W=k.extras["mapbox:footprint:id"];(N||W)&&D.add(I),N==="1.0.0"&&W&&(P[W]=I)}for(let I=0;I<M.length;I++){if(D.has(I))continue;const k=M[I],N=w[O[I]];if(!N.extras)continue;let W=null;k.id in P&&(W=Fde(M[P[k.id]].meshes,k.matrix)),W||(W=jde(N)),W&&(k.footprint=zde(W))}if(D.size>0){const I=Array.from(D.values()).sort((k,N)=>k-N);for(let k=I.length-1;k>=0;k--)M.splice(I[k],1)}}(T,v,d.json.nodes),T}function Bde(d){d.heightmap=new Float32Array(4096),d.heightmap.fill(-1);const o=d.vertexArray.float32,c=d.aabb.min[0]-1,h=d.aabb.min[1]-1,m=pg/(d.aabb.max[0]-c+2),p=pg/(d.aabb.max[1]-h+2);for(let v=0;v<o.length;v+=3){const T=o[v+2],M=(o[v+0]-c)*m|0,O=(o[v+1]-h)*p|0;T>d.heightmap[O*pg+M]&&(d.heightmap[O*pg+M]=T)}}function $de(d,o){const c={};c.indexArray=new Bo,c.indexArray.reserve(4*d.length),c.vertexArray=new Tl,c.vertexArray.reserve(10*d.length),c.colorArray=new Qd,c.vertexArray.reserve(10*d.length);let h=0;for(const v of d){const T=Math.min(10,Math.max(4,1.3*v.height))*o,M=[-v.normal[1],v.normal[0],0],O=Math.min(.29,.1*v.width/v.depth),w=v.width-2*v.depth*o*(O+.01),P=ge.vec3.scaleAndAdd([],v.pos,M,w/2),D=ge.vec3.scaleAndAdd([],v.pos,M,-w/2),I=[P[0],P[1],P[2]+v.height],k=[D[0],D[1],D[2]+v.height],N=ge.vec3.scaleAndAdd([],v.normal,M,O);ge.vec3.scale(N,N,T);const W=ge.vec3.scaleAndAdd([],v.normal,M,-O);ge.vec3.scale(W,W,T),ge.vec3.add(N,P,N),ge.vec3.add(W,D,W),P[2]+=.1,D[2]+=.1,c.vertexArray.emplaceBack(N[0],N[1],N[2]),c.vertexArray.emplaceBack(W[0],W[1],W[2]),c.vertexArray.emplaceBack(P[0],P[1],P[2]),c.vertexArray.emplaceBack(D[0],D[1],D[2]),c.vertexArray.emplaceBack(I[0],I[1],I[2]),c.vertexArray.emplaceBack(k[0],k[1],k[2]),c.vertexArray.emplaceBack(P[0],P[1],P[2]),c.vertexArray.emplaceBack(D[0],D[1],D[2]),c.vertexArray.emplaceBack(N[0],N[1],N[2]),c.vertexArray.emplaceBack(W[0],W[1],W[2]);const Z=w/T/2;c.colorArray.emplaceBack(-Z-O,-1,Z,.8),c.colorArray.emplaceBack(Z+O,-1,Z,.8),c.colorArray.emplaceBack(-Z,0,Z,1.3),c.colorArray.emplaceBack(Z,0,Z,1.3),c.colorArray.emplaceBack(Z+O,-.8,Z,.7),c.colorArray.emplaceBack(Z+O,-.8,Z,.7),c.colorArray.emplaceBack(0,0,Z,1.3),c.colorArray.emplaceBack(0,0,Z,1.3),c.colorArray.emplaceBack(Z+O,-1.2,Z,.8),c.colorArray.emplaceBack(Z+O,-1.2,Z,.8),c.indexArray.emplaceBack(6+h,4+h,8+h),c.indexArray.emplaceBack(7+h,9+h,5+h),c.indexArray.emplaceBack(0+h,1+h,2+h),c.indexArray.emplaceBack(1+h,3+h,2+h),h+=10}const m={defined:!0,emissiveFactor:[0,0,0]},p={};return p.baseColorFactor=An.white,m.pbrMetallicRoughness=p,c.material=m,c.aabb=new or([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),c}class q8{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const h=o[c];this._stringToNumber[h]=c,this._numberToString[c]=h}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const Ude=["id","tile","layer","source","sourceLayer","state"];class r_{constructor(o,c,h,m,p){this.type="Feature",this._vectorTileFeature=o,this._z=c,this._x=h,this._y=m,this.properties=o.properties,this.id=p}clone(){const o=new r_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const c of Ude)this[c]!==void 0&&(o[c]=this[c]);return o}}class H8{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Af(Bt,16,0),this.featureIndexArray=new Wa,this.promoteId=c,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,c,h,m,p,v=0,T=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,p,v);const O=this.grid;for(let w=0;w<c.length;w++){const P=c[w],D=[1/0,1/0,-1/0,-1/0];for(let I=0;I<P.length;I++){const k=P[I];D[0]=Math.min(D[0],k.x),D[1]=Math.min(D[1],k.y),D[2]=Math.max(D[2],k.x),D[3]=Math.max(D[3],k.y)}T!==0&&(D[0]-=T,D[1]-=T,D[2]+=T,D[3]+=T),D[0]<Bt&&D[1]<Bt&&D[2]>=0&&D[3]>=0&&O.insert(M,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Vf.VectorTile(new Y2(this.rawTileData)).layers,this.sourceLayerCoder=new q8(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,c){const{tilespaceGeometry:h,transform:m,tileTransform:p,pixelPosMatrix:v,availableImages:T}=c;this.loadVTLayers(),this.serializedLayersCache.clear();const M=h.bufferedTilespaceBounds,O=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(I,k,N,W)=>Pe(h.bufferedTilespaceGeometry,I,k,N,W));O.sort(Vde);let w=null;m.elevation&&O.length>0&&(w=Xv.create(m.elevation,this.tileID));const P={};let D;for(let I=0;I<O.length;I++){const k=O[I];if(k===D)continue;D=k;const N=this.featureIndexArray.get(k);let W=null;this.is3DTile?this.loadMatchingModelFeature(P,N,o,h,m):this.loadMatchingFeature(P,N,o,T,(Z,ee,Q,K=0)=>(W||(W=B(Z,this.tileID.canonical,p)),ee.queryIntersectsFeature(h,Z,Q,W,this.z,m,v,w,K)))}return P}loadMatchingFeature(o,c,h,m,p){const{featureIndex:v,bucketIndex:T,sourceLayerIndex:M,layoutVertexArrayOffset:O}=c,w=this.bucketLayerIDs[T],P=h.layers,D=Object.keys(P);if(D.length&&!function(Z,ee){for(let Q=0;Q<Z.length;Q++)if(ee.indexOf(Z[Q])>=0)return!0;return!1}(D,w))return;const I=h.sourceCache,k=this.sourceLayerCoder.decode(M),N=this.vtLayers[k].feature(v),W=this.getId(N,k);for(let Z=0;Z<w.length;Z++){const ee=w[Z];if(!P[ee])continue;const{styleLayer:Q,targets:K}=P[ee];let ie={};W!==void 0&&(ie=I.getFeatureState(Q.sourceLayer,W));const se=!p||p(N,Q,ie,O);if(!se)continue;const de=new r_(N,this.z,this.x,this.y,W);de.tile=this.tileID.canonical,de.state=ie;let we=this.serializedLayersCache.get(ee);we||(we=Q.serialize(),we.id=ee,this.serializedLayersCache.set(ee,we)),de.source=we.source,de.sourceLayer=we["source-layer"],de.layer=Pi({},we),de.layer.paint=Z8(we.paint,Q.paint,N,ie,m),de.layer.layout=Z8(we.layout,Q.layout,N,ie,m);let _e=!1;for(const xe of K){this.updateFeatureProperties(de,xe);const{filter:ke}=xe;if(ke){if(N.properties=de.properties,ke.needGeometry){const Se=V(N,!0);if(!ke.filter(new $n(this.tileID.overscaledZ),Se,this.tileID.canonical))continue}else if(!ke.filter(new $n(this.tileID.overscaledZ),N))continue}_e=!0,xe.targetId&&this.addFeatureVariant(de,xe)}_e&&this.appendToResult(o,ee,v,de,se)}}loadMatchingModelFeature(o,c,h,m,p){const v=this.bucketLayerIDs[0][0],T=h.layers;if(!T[v])return;const{styleLayer:M,targets:O}=T[v];if(M.type!=="model")return;const w=m.tile,P=c.featureIndex,D=w.getBucket(M);if(!(D&&D instanceof yA))return;const I=function(we,_e,xe,ke){const Se=we.getNodesInfo()[_e];if(Se.hiddenByReplacement||!Se.node.meshes)return;let De=Number.MAX_VALUE;const Ve=Se.node,Fe=xe.tile,Ze=ke.calculatePosMatrix(Fe.tileID.toUnwrapped(),ke.worldSize),He=Se.evaluatedScale;let tt=0;ke.elevation&&Ve.elevation&&(tt=Ve.elevation*ke.elevation.exaggeration()),ge.mat4.translate(Ze,Ze,[(Ve.anchor?Ve.anchor[0]:0)*(He[0]-1),(Ve.anchor?Ve.anchor[1]:0)*(He[1]-1),tt]),ge.mat4.scale(Ze,Ze,He);const Ke=xe.queryGeometry,nt=Ke.isPointQuery()?Ke.screenBounds:Ke.screenGeometry,Ct=function(Qt){const Rt=ge.mat4.multiply([],Ze,Qt.matrix);ge.mat4.multiply(Rt,ke.expandedFarZProjMatrix,Rt);for(let Ft=0;Ft<Qt.meshes.length;++Ft){const It=Qt.meshes[Ft];if(Ft===Qt.lightMeshIndex)continue;const yr=GV(nt,ke,Rt,It.aabb);yr!=null&&(De=Math.min(yr,De))}if(Qt.children)for(const Ft of Qt.children)Ct(Ft)};if(Ct(Ve),De===Number.MAX_VALUE)return;const At=new gn(0,0);return n8(Fe.tileID.canonical,At,Se.node.anchor[0],Se.node.anchor[1]),{intersectionZ:De,position:At,feature:Se.feature}}(D,P,m,p);if(!I)return;const{z:k,x:N,y:W}=w.tileID.canonical,{feature:Z,intersectionZ:ee,position:Q}=I;let K={};Z.id!==void 0&&(K=h.sourceCache.getFeatureState(M.sourceLayer,Z.id));const ie=new r_({},k,N,W,Z.id);ie.tile=this.tileID.canonical,ie.state=K,ie.properties=Z.properties,ie.geometry={type:"Point",coordinates:[Q.lng,Q.lat]};let se=this.serializedLayersCache.get(v);se||(se=M.serialize(),se.id=v,this.serializedLayersCache.set(v,se)),ie.source=se.source,ie.sourceLayer=se["source-layer"],ie.layer=Pi({},se);let de=!1;for(const we of O){this.updateFeatureProperties(ie,we);const{filter:_e}=we;if(_e){if(Z.properties=ie.properties,_e.needGeometry){if(!_e.filter(new $n(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!_e.filter(new $n(this.tileID.overscaledZ),Z))continue}de=!0,we.targetId&&this.addFeatureVariant(ie,we)}de&&this.appendToResult(o,v,P,ie,ee)}updateFeatureProperties(o,c,h){if(c.properties){const m={};for(const p in c.properties){const v=c.properties[p].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,h);v!=null&&(m[p]=v)}o.properties=m}}addFeatureVariant(o,c,h){const m={target:c.target,namespace:c.namespace,uniqueFeatureID:c.uniqueFeatureID};c.properties&&(m.properties=o.properties),o.variants=o.variants||{},o.variants[c.targetId]=o.variants[c.targetId]||[],o.variants[c.targetId].push(m)}appendToResult(o,c,h,m,p){let v=o[c];v===void 0&&(v=o[c]=[]),v.push({featureIndex:h,feature:m,intersectionZ:p})}lookupSymbolFeatures(o,c,h,m,p){const v={};this.loadVTLayers();for(const T of o)this.loadMatchingFeature(v,{bucketIndex:c,sourceLayerIndex:h,featureIndex:T,layoutVertexArrayOffset:0},m,p);return v}loadFeature(o){const{featureIndex:c,sourceLayerIndex:h}=o;this.loadVTLayers();const m=this.sourceLayerCoder.decode(h),p=this.vtFeatures[m];if(p[c])return p[c];const v=this.vtLayers[m].feature(c);return p[c]=v,v}hasLayer(o){for(const c of this.bucketLayerIDs)for(const h of c)if(o===h)return!0;return!1}getId(o,c){let h=o.id;if(this.promoteId){const m=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[c];if(m!=null)if(Array.isArray(m)){if(!this.promoteIdExpression){const p=Tf(m);if(p.result!=="success"){const v=p.value.map(T=>`${T.key}: ${T.message}`).join(", ");return void pi(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=p.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Yy),h=this.promoteIdExpression.evaluate({zoom:0},o)}else h=o.properties[m];typeof h=="boolean"&&(h=Number(h))}return h}}function Z8(d,o,c,h,m){return ls(d,(p,v)=>{const T=o instanceof Of?o.get(v):null;return T&&T.evaluate?T.evaluate(c,h,m):T})}function Vde(d,o){return o-d}Jt(H8,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const X8=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bL{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,h]=new Uint8Array(o,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const p=X8[15&h];if(!p)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(o,2,1),[T]=new Uint32Array(o,4,1);return new bL(T,v,p,o)}constructor(o,c=64,h=Float64Array,m){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=h,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const p=X8.indexOf(this.ArrayType),v=2*o*this.ArrayType.BYTES_PER_ELEMENT,T=o*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-T%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+M,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+M),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+M,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=o)}add(o,c){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=o,this.coords[this._pos++]=c,h}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return wL(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,c,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:T}=this,M=[0,p.length-1,0],O=[];for(;M.length;){const w=M.pop()||0,P=M.pop()||0,D=M.pop()||0;if(P-D<=T){for(let W=D;W<=P;W++){const Z=v[2*W],ee=v[2*W+1];Z>=o&&Z<=h&&ee>=c&&ee<=m&&O.push(p[W])}continue}const I=D+P>>1,k=v[2*I],N=v[2*I+1];k>=o&&k<=h&&N>=c&&N<=m&&O.push(p[I]),(w===0?o<=k:c<=N)&&(M.push(D),M.push(I-1),M.push(1-w)),(w===0?h>=k:m>=N)&&(M.push(I+1),M.push(P),M.push(1-w))}return O}within(o,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:p,nodeSize:v}=this,T=[0,m.length-1,0],M=[],O=h*h;for(;T.length;){const w=T.pop()||0,P=T.pop()||0,D=T.pop()||0;if(P-D<=v){for(let W=D;W<=P;W++)K8(p[2*W],p[2*W+1],o,c)<=O&&M.push(m[W]);continue}const I=D+P>>1,k=p[2*I],N=p[2*I+1];K8(k,N,o,c)<=O&&M.push(m[I]),(w===0?o-h<=k:c-h<=N)&&(T.push(D),T.push(I-1),T.push(1-w)),(w===0?o+h>=k:c+h>=N)&&(T.push(I+1),T.push(P),T.push(1-w))}return M}}function wL(d,o,c,h,m,p){if(m-h<=c)return;const v=h+m>>1;Y8(d,o,v,h,m,p),wL(d,o,c,h,v-1,1-p),wL(d,o,c,v+1,m,1-p)}function Y8(d,o,c,h,m,p){for(;m>h;){if(m-h>600){const O=m-h+1,w=c-h+1,P=Math.log(O),D=.5*Math.exp(2*P/3),I=.5*Math.sqrt(P*D*(O-D)/O)*(w-O/2<0?-1:1);Y8(d,o,c,Math.max(h,Math.floor(c-w*D/O+I)),Math.min(m,Math.floor(c+(O-w)*D/O+I)),p)}const v=o[2*c+p];let T=h,M=m;for(Y1(d,o,h,c),o[2*m+p]>v&&Y1(d,o,h,m);T<M;){for(Y1(d,o,T,M),T++,M--;o[2*T+p]<v;)T++;for(;o[2*M+p]>v;)M--}o[2*h+p]===v?Y1(d,o,h,M):(M++,Y1(d,o,M,m)),M<=c&&(h=M+1),c<=M&&(m=M-1)}}function Y1(d,o,c,h){SL(d,c,h),SL(o,2*c,2*h),SL(o,2*c+1,2*h+1)}function SL(d,o,c){const h=d[o];d[o]=d[c],d[c]=h}function K8(d,o,c,h){const m=d-c,p=o-h;return m*m+p*p}i.$=xa,i.A=Ua,i.B=tc,i.C=Df,i.D=Yv,i.E=xl,i.F=2,i.G=O1,i.H=iV,i.I=Oa,i.J=class extends mA{},i.K=zc,i.L=fn,i.M=_2,i.N=Rb,i.O=Sf,i.P=_t,i.Q=c2,i.R=Io,i.S=mv,i.T=eL,i.U=Tv,i.V=mA,i.W=zb,i.X=Tf,i.Y=Bm,i.Z=Uc,i._=vf,i.a=function(d){return pe.API_CDN_URL_REGEX.test(d)},i.a$=V,i.a0=js,i.a1=Zb,i.a2=fv,i.a3=hv,i.a4=function(d){const o=d.value;let c=[];if(!o)return c;const h=zc(o);return h!=="string"?(c=c.concat([new mA(d.key,o,`string expected, "${h}" found`)]),c):(HV(o,!0)||(c=c.concat([new mA(d.key,o,`invalid url "${o}"`)])),c)},i.a5=it,i.a6=Hb,i.a7=bi,i.a8=zt,i.a9=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return ei(d.expression.evaluate(o))}interpolate(d,o,c){return{x:_r(d.x,o.x,c),y:_r(d.y,o.y,c),z:_r(d.z,o.z,c),azimuthal:_r(d.azimuthal,o.azimuthal,c),polar:_r(d.polar,o.polar,c)}}},i.aA=function(d,o){const c={};for(let h=0;h<o.length;h++){const m=o[h];m in d&&(c[m]=d[m])}return c},i.aB=Qu,i.aC=Ga,i.aD=class{constructor(d){this.entries={},this.scheduler=d}request(d,o,c,h){const m=this.entries[d]=this.entries[d]||{callbacks:[]};if(m.result){const[p,v]=m.result;return this.scheduler?this.scheduler.add(()=>{h(p,v)},o):h(p,v),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=c((p,v)=>{m.result=[p,v];for(const T of m.callbacks)this.scheduler?this.scheduler.add(()=>{T(p,v)},o):T(p,v);setTimeout(()=>delete this.entries[d],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(p=>p!==h),m.callbacks.length||(m.cancel(),delete this.entries[d]))}}},i.aE=function(d,o,c){const h=JSON.stringify(d.request);return d.data&&(this.deduped.entries[h]={result:[null,d.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:d.isSymbolTile,zoom:d.tileZoom},m=>{const p=Rc(d.request,(v,T,M,O)=>{v?m(v):T&&m(null,{vectorTile:c?void 0:new Vf.VectorTile(new Y2(T)),rawData:T,cacheControl:M,expires:O})});return()=>{p.cancel(),m()}},o)},i.aF=function(d){Tn++,Tn>Br&&(d.getActor().send("enforceCacheSizeLimit",Rr),Tn=0)},i.aG=function(d){return d<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))},i.aH=Mt,i.aI=DV,i.aJ=BV,i.aK=RV,i.aL=function(d,o){const c=document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let h=0;h<d.length;h++){const m=document.createElement("source");rb(d[h])||(c.crossOrigin="Anonymous"),m.src=d[h],c.appendChild(m)}return{cancel:()=>{}}},i.aM=uA,i.aN=function(d){return fetch(d).then(o=>o.arrayBuffer()).then(o=>V8(o,0,d))},i.aO=G8,i.aP=class{constructor(d,o,c,h){this.id=d,this.position=o!=null?new gn(o[0],o[1]):new gn(0,0),this.orientation=c??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new or([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(d,o){if(ge.mat4.multiply(d.matrix,o,d.matrix),d.meshes)for(const c of d.meshes){const h=or.applyTransformFast(c.aabb,d.matrix);this.aabb.encapsulate(h)}if(d.children)for(const c of d.children)this._applyTransformations(c,d.matrix)}computeBoundsAndApplyParent(){const d=ge.mat4.identity([]);for(const o of this.nodes)this._applyTransformations(o,d)}computeModelMatrix(d,o,c,h,m,p,v=!1){JV(this.matrix,this,d.transform,this.position,o,c,h,m,p,v)}upload(d){if(!this.uploaded){for(const o of this.nodes)oL(o,d);for(const o of this.nodes)gA(o);this.uploaded=!0}}destroy(){for(const d of this.nodes)aL(d)}},i.aQ=Ql,i.aR=D1,i.aS=qa,i.aT=$o,i.aU=qc,i.aV=Bo,i.aW=na,i.aX=eg,i.aY=lA,i.aZ=function(){$s.isLoading()||$s.isLoaded()||wv()!=="deferred"||v2()},i.a_=Xb,i.aa=$n,i.ab=Ef,i.ac=s,i.ad=ge,i.ae=Zr,i.af=Of,i.ag=Ra,i.ah=_r,i.ai=Bt,i.aj=GE,i.ak=Ge,i.al=An,i.am=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return function([c,h]){const m=ei([1,c,h]);return{x:m.x,y:m.y,z:m.z}}(d.expression.evaluate(o))}interpolate(d,o,c){return{x:_r(d.x,o.x,c),y:_r(d.y,o.y,c),z:_r(d.z,o.z,c)}}},i.an=function(d,o,c=0,h=!0){const m=new _t(c,c),p=d.sub(m),v=o.add(m),T=[p,new _t(v.x,p.y),v,new _t(p.x,v.y)];return h&&T.push(p.clone()),T},i.ao=function(d,o){const c=[];for(let h=0;h<d.length;h++){const m=fi(h-1,-1,d.length-1),p=fi(h+1,-1,d.length-1),v=d[h],T=d[p],M=d[m].sub(v).unit(),O=T.sub(v).unit(),w=O.angleWithSep(M.x,M.y),P=M.add(O).unit().mult(-1*o/Math.sin(w/2));c.push(v.add(P))}return c},i.ap=_V,i.aq=Pe,i.ar=function(d,o,c=0){return ge.vec3.fromValues(((o.x-c)*d.scale-d.x)*Bt,(o.y*d.scale-d.y)*Bt,g1(o.z,o.y))},i.as=Tr,i.at=k6,i.au=function(d){let o=1/0,c=1/0,h=-1/0,m=-1/0;for(const p of d)o=Math.min(o,p.x),c=Math.min(c,p.y),h=Math.max(h,p.x),m=Math.max(m,p.y);return{min:new _t(o,c),max:new _t(h,m)}},i.av=oc,i.aw=Ce,i.ax=g,i.ay=Kt,i.az=ba,i.b=function(d){return pe.API_FONTS_REGEX.test(d)},i.b$=fA,i.b0=r_,i.b1=Ho,i.b2=RD,i.b3=AD,i.b4=B,i.b5=Gc,i.b6=kv,i.b7=vr,i.b8=si,i.b9=x1,i.bA=u6,i.bB=WD,i.bC=hV,i.bD=$D,i.bE=bL,i.bF=fi,i.bG=Fu,i.bH=Yo,i.bI=function(d,o,c){d[4*o+0]=c[0],d[4*o+1]=c[1],d[4*o+2]=c[2],d[4*o+3]=c[3]},i.bJ=lg,i.bK=Vs,i.bL=zf,i.bM=Ui,i.bN=ag,i.bO=gn,i.bP=TV,i.bQ=ht,i.bR=Lr,i.bS=UV,i.bT=Et,i.bU=la,i.bV=function(d,o,c,h,m,p,v,T,M){if(M.name==="globe")return la(d,o,new Et(c,h,m),!1);const O=D1({z:c,x:h,y:m},M);return new or([(p+O.x/O.scale)*o,o*(O.y/O.scale),v],[(p+O.x2/O.scale)*o,o*(O.y2/O.scale),T])},i.bW=function(d,o,c){let h=0;for(let m=0;m<2;++m)d[m]>0&&(h+=(d[m]-0)*(d[m]-0)),o[m]<0&&(h+=(0-o[m])*(0-o[m]));return h},i.bX=ji,i.bY=N2,i.bZ=function(d){const o=ge.mat4.identity(new Float64Array(16));ge.mat4.multiply(o,d.pixelMatrix,d.globeMatrix);const c=[0,ps,0],h=[0,ms,0];return ge.vec3.transformMat4(c,c,o),ge.vec3.transformMat4(h,h,o),[c[0]>0&&c[0]<=d.width&&c[1]>0&&c[1]<=d.height&&!Za(d,new gn(d.center.lat,90)),h[0]>0&&h[0]<=d.width&&h[1]>0&&h[1]<=d.height&&!Za(d,new gn(d.center.lat,-90))]},i.b_=function(d,o){const{scale:c}=d.tileTransform,h=c*Bt/(d.tileSize*Math.pow(2,o.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return ge.mat2.scale(new Float32Array(4),o.inverseAdjustmentMatrix,[h,h])},i.ba=KD,i.bb=function(d,o){const c=Ra(o.zoom);if(c===0)return ho(d);const h=sn(d),m=ci(h),p=oc(h.getWest())*o.worldSize,v=oc(h.getEast())*o.worldSize,T=Ga(h.getNorth())*o.worldSize,M=Ga(h.getSouth())*o.worldSize,O=[p,T,0],w=[v,T,0],P=[p,M,0],D=[v,M,0],I=ge.mat4.invert([],o.globeMatrix);return ge.vec3.transformMat4(O,O,I),ge.vec3.transformMat4(w,w,I),ge.vec3.transformMat4(P,P,I),ge.vec3.transformMat4(D,D,I),m[0]=_o(m[0],P,c),m[1]=_o(m[1],D,c),m[2]=_o(m[2],w,c),m[3]=_o(m[3],O,c),or.fromPoints(m)},i.bc=ti,i.bd=vn,i.be=_o,i.bf=Lf,i.bg=Or,i.bh=AA,i.bi=Y2,i.bj=Rc,i.bk=function(d,o){const c=[];for(const h in d)h in o||c.push(h);return c},i.bl=Qn,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=hn,i.bo=function(d,o){const{x:c,y:h}=d.point,m=Ws(c,h,d.worldSize/d._pixelsPerMercatorPixel,0,0);return ge.mat4.multiply(m,m,fo(ho(o)))},i.bp=Uv,i.bq=ys,i.br=X2,i.bs=function(d,o,c,h,m){const p=5*o+2;d.float32[p+0]=c,d.float32[p+1]=h,d.float32[p+2]=m},i.bt=sA,i.bu=nV,i.bv=ce,i.bw=Jo,i.bx=i6,i.by=qV,i.bz=c6,i.c=Ae,i.c$=N6,i.c0=$V,i.c1=function(d){const o=$V(d,!0);return ge.mat2.invert([],[o[0],o[1],o[4],o[5]])},i.c2=tn,i.c3=function(d){const{x:o,y:c}=d.point,{lng:h,lat:m}=d._center;return Ws(o,c,d.worldSize,h,m)},i.c4=vt,i.c5=Vt,i.c6=jf,i.c7=function(d){const o=Math.round((d+45+360)%360/90)%4;return kt[o]},i.c8=45,i.c9=qE,i.cA=R2,i.cB=class extends ic{constructor(d){super(d),this.current=h1}set(d,o,c){if(this.fetchUniformLocation(d,o)){for(let h=0;h<9;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},i.cC=dr,i.cD=function(d,o,c){const h=Ra(c.zoom),m=d.style.map._antialias,p=d.terrain&&d.terrain.exaggeration()>0;return h===0&&!m&&!p},i.cE=function(d){const o=d.pixelsPerMeter,c=o/Yo(1,d.center.lat),h=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(h,h,[d.point.x,d.point.y,0]),ge.mat4.scale(h,h,[c,c,o]),Float32Array.from(h)},i.cF=sn,i.cG=function(d){const o=ji-5;d=Kt(d,-o,o)/o*90;const c=Math.pow(Math.abs(Math.sin(Ge(d))),3);return Math.round(c*(jv.length-1))},i.cH=function(d,o,c,h){const m=o.getNorth(),p=o.getSouth(),v=o.getWest(),T=o.getEast(),M=1<<d.z,O=T-v,w=m-p,P=O/Ff,D=-w/jv[c],I=[0,P,0,D,0,0,m,v,0];if(d.z>0){const k=180/h;ge.mat3.multiply(I,I,[k/O+1,0,0,0,k/w+1,0,-.5*k/P,.5*k/D,1])}return I[2]=M,I[5]=d.x,I[8]=d.y,I},i.cI=ho,i.cJ=function(d,o,c){const h=ge.mat4.identity(new Float64Array(16)),m=(o/(1<<d)-.5)*Math.PI*2;return ge.mat4.rotateY(h,c.globeMatrix,m),Float32Array.from(h)},i.cK=class{isDataAvailableAtPoint(d){const o=this._source();if(this.isUsingMockSource()||!o||d.y<0||d.y>1)return!1;const c=o.getSource().maxzoom,h=1<<c,m=Math.floor(d.x),p=Math.floor((d.x-m)*h),v=Math.floor(d.y*h),T=this.findDEMTileFor(new Mt(c,m,c,p,v));return!(!T||!T.dem)}getAtPointOrZero(d,o=0){return this.getAtPoint(d,o)||0}getAtPoint(d,o,c=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const h=this._source();if(!h||d.y<0||d.y>1)return o;const m=h.getSource().maxzoom,p=1<<m,v=Math.floor(d.x),T=d.x-v,M=new Mt(m,v,m,Math.floor(T*p),Math.floor(d.y*p)),O=this.findDEMTileFor(M);if(!O||!O.dem)return o;const w=O.dem,P=1<<O.tileID.canonical.z,D=(T*P-O.tileID.canonical.x)*w.dim,I=(d.y*P-O.tileID.canonical.y)*w.dim,k=Math.floor(D),N=Math.floor(I);return(c?this.exaggeration():1)*_r(_r(w.get(k,N),w.get(k,N+1),I-N),_r(w.get(k+1,N),w.get(k+1,N+1),I-N),D-k)}getAtTileOffset(d,o,c){const h=1<<d.canonical.z;return this.getAtPointOrZero(new s(d.wrap+(d.canonical.x+o/Bt)/h,(d.canonical.y+c/Bt)/h))}getAtTileOffsetFunc(d,o,c,h){return m=>{const p=this.getAtTileOffset(d,m.x,m.y),v=h.upVector(d.canonical,m.x,m.y),T=h.upVectorScale(d.canonical,o,c).metersToTile;return ge.vec3.scale(v,v,p*T),v}}getForTilePoints(d,o,c,h){if(this.isUsingMockSource())return!1;const m=Xv.create(this,d,h);return!!m&&(o.forEach(p=>{p[2]=this.exaggeration()*m.getElevationAt(p[0],p[1],c)}),!0)}getMinMaxForTile(d){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(d);if(!o||!o.dem)return null;const c=o.dem.tree,h=o.tileID,m=1<<d.canonical.z-h.canonical.z;let p=d.canonical.x/m-h.canonical.x,v=d.canonical.y/m-h.canonical.y,T=0;for(let M=0;M<d.canonical.z-h.canonical.z&&!c.leaves[T];M++){p*=2,v*=2;const O=2*Math.floor(v)+Math.floor(p);T=c.childOffsets[T]+O,p%=1,v%=1}return{min:this.exaggeration()*c.minimums[T],max:this.exaggeration()*c.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(d,o,c){throw new Error("Pure virtual method called.")}pointCoordinate(d){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(d){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const d=this.visibleDemTiles;if(d.length===0)return null;let o=!1,c=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const m of d){const p=this.getMinMaxForTile(m.tileID);p&&(c=Math.min(c,p.min),h=Math.max(h,p.max),o=!0)}return o?{min:c,max:h}:null}},i.cL=DU,i.cM=on,i.cN=function(d,o){return[Math.pow(d[0],2.2)*o,Math.pow(d[1],2.2)*o,Math.pow(d[2],2.2)*o]},i.cO=Ha,i.cP=mt,i.cQ=Cm,i.cR=256,i.cS=function(d,o){const c=[0,0,0],h=ti(ho(o.canonical));return ge.vec3.transformMat4(c,c,h),ge.vec3.transformMat4(c,c,d),c},i.cT=d=>({u_camera_to_center_distance:new Ui(d),u_extrude_scale:new f1(d),u_device_pixel_ratio:new Ui(d),u_matrix:new lg(d),u_inv_rot_matrix:new lg(d),u_merc_center:new Vs(d),u_tile_id:new zf(d),u_zoom_transition:new Ui(d),u_up_dir:new zf(d),u_emissive_strength:new Ui(d)}),i.cU=d=>({u_matrix:new lg(d),u_pixels_to_tile_units:new f1(d),u_device_pixel_ratio:new Ui(d),u_width_scale:new Ui(d),u_floor_width_scale:new Ui(d),u_units_to_pixels:new Vs(d),u_dash_image:new ag(d),u_gradient_image:new ag(d),u_image_height:new Ui(d),u_texsize:new Vs(d),u_tile_units_to_pixels:new Ui(d),u_alpha_discard_threshold:new Ui(d),u_trim_offset:new Vs(d),u_trim_fade_range:new Vs(d),u_trim_color:new sg(d),u_emissive_strength:new Ui(d),u_zbias_factor:new Ui(d),u_tile_to_meter:new Ui(d)}),i.cV=d=>({u_matrix:new lg(d),u_texsize:new Vs(d),u_pixels_to_tile_units:new f1(d),u_device_pixel_ratio:new Ui(d),u_width_scale:new Ui(d),u_floor_width_scale:new Ui(d),u_image:new ag(d),u_units_to_pixels:new Vs(d),u_tile_units_to_pixels:new Ui(d),u_alpha_discard_threshold:new Ui(d),u_trim_offset:new Vs(d),u_trim_fade_range:new Vs(d),u_trim_color:new sg(d),u_emissive_strength:new Ui(d),u_zbias_factor:new Ui(d),u_tile_to_meter:new Ui(d)}),i.cW=i1,i.cX=qce,i.cY=Hce,i.cZ=$f,i.c_=(d,o,c,h,m,p)=>{const v=d.transform,T=v.projection.name==="globe";let M;if(p.paint.get("circle-pitch-alignment")==="map")if(T){const w=Ha(v.zoom,o.canonical)*v._pixelsPerMercatorPixel;M=Float32Array.from([w,0,0,w])}else M=v.calculatePixelsToTileUnitsMatrix(c);else M=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const O={u_camera_to_center_distance:d.transform.getCameraToCenterDistance(v.projection),u_matrix:d.translatePosMatrix(o.projMatrix,c,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:pt.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:y1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:p.paint.get("circle-emissive-strength")};if(T){O.u_inv_rot_matrix=h,O.u_merc_center=m,O.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],O.u_zoom_transition=Ra(v.zoom);const w=m[0]*Bt,P=m[1]*Bt;O.u_up_dir=v.projection.upVector(new Et(0,0,0),w,P)}return O},i.ca=Fv,i.cb=sg,i.cc=function(d,o,c){const h=Math.sqrt(d*d+o*o+c*c),m=h>0?Math.acos(c/h)*Ln:0;let p=d!==0||o!==0?Math.atan2(-o,-d)*Ln+90:0;return p<0&&(p+=360),[h,p,m]},i.cd=y,i.ce=or,i.cf=ei,i.cg=function(d){return[Math.pow(d[0],1/2.2),Math.pow(d[1],1/2.2),Math.pow(d[2],1/2.2)]},i.ch=function(d,o){return d.readFields(Bue,{icons:[]},o)},i.ci=function(d){return d({pluginStatus:ka,pluginURL:Hu}),Mf.on("pluginStateChange",d),d},i.cj=vA,i.ck=Gv,i.cl=UD,i.cm=rf,i.cn=Zm,i.co=Xt,i.cp=us,i.cq=Co,i.cr=function(d){const o=d.indexOf(Av);return o>=0?d.slice(0,o):d},i.cs=function(d){return d.indexOf(Av)>=0},i.ct=function(d){const o=d.indexOf(Av);return o>=0?d.slice(o+1):""},i.cu=function(d){const o=[],c=d.id;return c===void 0&&o.push({message:`layers.${c}: missing required property "id"`}),d.render===void 0&&o.push({message:`layers.${c}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},i.cv=function(d,o,c,h){return d.type==="custom"?new Aue(d,o):new zue[d.type](d,o,c,h)},i.cw=vl,i.cx=class extends r_{constructor(d,o){super(d._vectorTileFeature,d._z,d._x,d._y,d.id),d.state&&(this.state=Object.assign({},d.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=d.source,this.sourceLayer=d.sourceLayer,this.layer=d.layer)}toJSON(){const d=super.toJSON();return d.target=this.target,d.namespace=this.namespace,d}},i.cy=Mf,i.cz=zs,i.d=function(d){return pe.API_TILEJSON_REGEX.test(d)},i.d$=q8,i.d0=sa,i.d1=(d,o,c,h,m,p,v,T)=>{const M=d.transform,O=M.pitch<15?R6(.07,.7,Kt((14-M.zoom)/5,0,1)):.07,w=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:L6(d,o,c,h),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:m,u_width_scale:p,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:D6(o,M),u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(w?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:O,u_tile_to_meter:y(o.tileID.canonical,0)}},i.d2=(d,o,c,h,m,p,v,T,M)=>{const O=d.transform,w=O.calculatePixelsToTileUnitsMatrix(o),P=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none",D=O.pitch<15?R6(.07,.7,Kt((14-O.zoom)/5,0,1)):.07;return{u_matrix:L6(d,o,c,h),u_pixels_to_tile_units:w,u_device_pixel_ratio:p,u_width_scale:v,u_floor_width_scale:T,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:z6(c)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:D6(o,d.transform),u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(P?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:y(o.tileID.canonical,0)}},i.d3=yl,i.d4=_1,i.d5=g1,i.d6=S6,i.d7=Wt,i.d8=Z2,i.d9=Wf,i.dA=G2,i.dB=lr,i.dC=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.dD=sr,i.dE=mD,i.dF=rh,i.dG=function([d,o,c]){const h=Math.hypot(d,o,c),m=Math.atan2(d,c),p=.5*Math.PI-Math.acos(-o/h);return new gn(vt(m),vt(p))},i.dH=rL,i.dI=function(d){const o=d.navigator?d.navigator.userAgent:null;return!!function(c){if(ec==null){const h=c.navigator?c.navigator.userAgent:null;ec=!!c.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return ec}(d)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dJ=function(d,o){Rr=d,Br=o},i.dK=Za,i.dL=Gs,i.dM=function(d){const o=[0,0,0],c=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(c,d.pixelMatrix,d.globeMatrix),ge.vec3.transformMat4(o,o,c),new _t(o[0],o[1])},i.dN=function(d,o,c=!1){if(ka===Vb||ka===nc||ka===Wb)throw new Error("setRTLTextPlugin cannot be called multiple times.");Hu=pt.resolveURL(d),ka=Vb,Gb=o,bv(),c||v2()},i.dO=wv,i.dP=function(){vA().acquire(lL)},i.dQ=function(){const d=U1;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(lL),U1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dR=gg,i.dS=function(d){const o=_i();if(!o)return;const c=o.delete(er);d&&c.catch(d).then(()=>d())},i.dT=$1,i.dU=N8,i.dV=function(d){yL=pt.resolveURL(d),t_||(t_=new Yv(vA(),new xl)),t_.broadcast("setDracoUrl",yL)},i.dW=z8,i.dX=function(d){e_=pt.resolveURL(d),t_||(t_=new Yv(vA(),new xl)),t_.broadcast("setMeshoptUrl",e_)},i.dY=Jt,i.dZ=Uf,i.d_=Jc,i.da=450,i.db=7,i.dc=Eue,i.dd=mn,i.de=Lv,i.df=256,i.dg=fo,i.dh=Tl,i.di=Va,i.dj=Ov,i.dk=function(d,o,c,h,m){return Kt((d-o)/(c-o)*(m-h)+h,h,m)},i.dl=Pb,i.dm=ed,i.dn=class{constructor(d,o,c,h){this.context=d,this.format=h,this.size=c,this.texture=d.gl.createTexture();const[m,p,v]=this.size,{gl:T}=d;T.bindTexture(T.TEXTURE_3D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,m,p,v,0,JD(this.format),QD(this.format),o.data)}bind(d,o){const{context:c}=this,{gl:h}=c;h.bindTexture(h.TEXTURE_3D,this.texture),d!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,d),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,d),this.minFilter=d),o!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,o),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}},i.dp=nL,i.dq=[1,1,1],i.dr=Xv,i.ds=Zv,i.dt=Yu,i.du=Nf,i.dv=nh,i.dw=s1,i.dx=a1,i.dy=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new _t(1/0,1/0),max:new _t(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(d,o=!1){const c=a6(new _t(0,0),new _t(Bt,Bt),d),h=[];if(o&&!CD(c,this._globalClipBounds))return h;for(const m of this._activeRegions){if(m.hiddenByOverlap||!CD(c,m))continue;const p=_ce(m.min,m.max,d);h.push({min:p.min,max:p.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return h}setSources(d){this._setSources(d.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const c=[];for(const h of o.cache.getVisibleCoordinates()){const m=o.cache.getTile(h).buckets[o.layer];m&&m.updateFootprints(h.toUnwrapped(),c)}return c},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(d){const o=d.getFootprints();if(o.length===0)return;const c=d.getOrder(),h=d.getClipMask(),m=d.getClipScope();for(const p of o){if(!p.footprint)continue;const v=a6(p.footprint.min,p.footprint.max,p.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:p.id,footprint:p.footprint,order:c,clipMask:h,clipScope:m})}this._sourceIds.push(d.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,c)=>o.priority-c.priority||q2(o.min,c.min)||q2(o.max,c.max)||o.order-c.order||o.clipMask-c.clipMask||function(h,m){const p=(v,T)=>v+T;return h.length-m.length||h.reduce(p,"").localeCompare(m.reduce(p,""))}(o.clipScope,c.clipScope));let d=this._activeRegions.length!==this._prevRegions.length;if(!d){let o=0;for(;!d&&o!==this._activeRegions.length;){const c=this._activeRegions[o],h=this._prevRegions[o];d=c.priority!==h.priority||!o6(c,h)||c.order!==h.order||c.clipMask!==h.clipMask||!hn(c.clipScope,h.clipScope),++o}}if(d){++this._updateTime;for(const c of this._activeRegions)c.order!==G2&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,c.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,c.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,c.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,c.max.y));const o=c=>{const h=this._activeRegions;if(c>=h.length)return c;const m=h[c].priority;for(;c<h.length&&h[c].priority===m;)++c;return c};if(this._sourceIds.length>1){let c=0,h=o(c);for(;c!==h;){let m=c;const p=c;for(;m!==h;){const v=this._activeRegions[m];v.hiddenByOverlap=!1;for(let T=0;T<p;T++){const M=this._activeRegions[T];if(!M.hiddenByOverlap&&v.order===G2&&CD(v,M)&&(v.hiddenByOverlap=l6(v.footprint,v.tileId,M.footprint,M.tileId),v.hiddenByOverlap))break}++m}c=h,h=o(c)}}}}_setSources(d){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=d.length-1;o>=0;o--)this._addSource(d[o]);this._computeReplacement()}},i.dz=class{constructor(d){this._createGrid(d),this._createPoles(d)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const d of this._poleSegments)d.destroy();for(const d of this._gridSegments)d.withSkirts.destroy(),d.withoutSkirts.destroy()}_fillGridMeshWithLods(d,o){const c=new Gc,h=new Bo,m=[],p=d+1+2,v=o[0]+1,T=o[0]+1+(1+o.length),M=(O,w,P)=>{let D=O===p-1?O-2:O===0?O:O-1;return D+=P?24575:0,[D,w]};for(let O=0;O<p;++O)c.emplaceBack(...M(O,0,!0));for(let O=0;O<v;++O)for(let w=0;w<p;++w)c.emplaceBack(...M(w,O,(w===0||w===p-1)&&!0));for(let O=0;O<o.length;++O){const w=o[O];for(let P=0;P<p;++P)c.emplaceBack(...M(P,w,!0))}for(let O=0;O<o.length;++O){const w=h.length,P=o[O]+1+2,D=new Bo;for(let N=0;N<P-1;N++){const W=N===P-2,Z=W?p*(T-o.length+O-N):p;for(let ee=0;ee<p-1;ee++){const Q=N*p+ee;N===0||W||ee===0||ee===p-2?(D.emplaceBack(Q+1,Q,Q+Z),D.emplaceBack(Q+Z,Q+Z+1,Q+1)):(h.emplaceBack(Q+1,Q,Q+Z),h.emplaceBack(Q+Z,Q+Z+1,Q+1))}}const I=si.simpleSegment(0,w,c.length,h.length-w);for(let N=0;N<D.uint16.length;N+=3)h.emplaceBack(D.uint16[N],D.uint16[N+1],D.uint16[N+2]);const k=si.simpleSegment(0,w,c.length,h.length-w);m.push({withoutSkirts:I,withSkirts:k})}return{vertices:c,indices:h,segments:m}}_createGrid(d){const o=this._fillGridMeshWithLods(Ff,jv);this._gridSegments=o.segments,this._gridBuffer=d.createVertexBuffer(o.vertices,vr.members),this._gridIndexBuffer=d.createIndexBuffer(o.indices,!0)}_createPoles(d){const o=new Bo;for(let v=0;v<=Ff;v++)o.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=d.createIndexBuffer(o,!0);const c=new Va,h=new Va,m=new Va,p=new Va;this._poleSegments=[];for(let v=0,T=0;v<jf;v++){const M=360/(1<<v);c.emplaceBack(0,-ba,0,.5,0),h.emplaceBack(0,-ba,0,.5,1),m.emplaceBack(0,-ba,0,.5,.5),p.emplaceBack(0,-ba,0,.5,.5);for(let O=0;O<=Ff;O++){let w=O/Ff,P=0;const D=_r(0,M,w),[I,k,N]=Bf(sc,Xc,D,ba);c.emplaceBack(I,k,N,w,P),h.emplaceBack(I,k,N,w,1-P);const W=Ge(D);w=.5+.5*Math.sin(W),P=.5+.5*Math.cos(W),m.emplaceBack(I,k,N,w,P),p.emplaceBack(I,k,N,w,1-P)}this._poleSegments.push(si.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=d.createVertexBuffer(c,ir,!1),this._poleSouthVertexBuffer=d.createVertexBuffer(h,ir,!1),this._texturedPoleNorthVertexBuffer=d.createVertexBuffer(m,ir,!1),this._texturedPoleSouthVertexBuffer=d.createVertexBuffer(p,ir,!1)}getGridBuffers(d,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[d].withSkirts:this._gridSegments[d].withoutSkirts]}getPoleBuffers(d,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[d]]}},i.e=pe,i.e0=H8,i.e1=P6,i.e2=dg,i.e3="hd_road_elevation",i.e4=class{static parseFrom(d,o){const c=ih.parse(d);if(!c)return[];let{vertices:h,features:m}=c;const p=1/y(o);m.sort((O,w)=>O.id-w.id),h.sort((O,w)=>O.id-w.id||O.idx-w.idx),h=h.filter((O,w,P)=>w===P.findIndex(D=>D.id===O.id&&D.idx===O.idx));const v=new Array;let T=0;const M=h.length;for(const O of m){if(O.constantHeight){v.push(new TD(O.id,O.bounds,O.constantHeight));continue}for(;T!==M&&h[T].id<O.id;)T++;if(T===M||h[T].id!==O.id)continue;const w=new Array,P=new Array,D=T;for(;T!==M&&h[T].id===O.id;){const I=h[T];if(w.push({position:I.position,height:I.height,extent:I.extent}),T!==D&&h[T-1].idx===I.idx-1){const k=T-D;P.push({a:k-1,b:k})}T++}v.push(new TD(O.id,O.bounds,void 0,w,P,p))}return v}},i.e5=ls,i.e6=hg,i.e7=oV,i.e8=Wv,i.e9=function(d,o,c,h,m,p,v,T=1,M){d.createArrays(),d.tilePixelRatio=Bt/(512*d.overscaling),d.compareText={},d.iconsNeedLinear=!1;const O=d.layers[0].layout,w=d.layers[0]._unevaluatedLayout._values,P={};P.scaleFactor=T,P.textSizeScaleRange=O.get("text-size-scale-range"),P.iconSizeScaleRange=O.get("icon-size-scale-range");const[D,I]=P.textSizeScaleRange,[k,N]=P.iconSizeScaleRange;P.textScaleFactor=Kt(P.scaleFactor,D,I),P.iconScaleFactor=Kt(P.scaleFactor,k,N);const W=w["text-size"],Z=w["icon-size"];if(d.textSizeData.kind==="composite"){const{minZoom:de,maxZoom:we}=d.textSizeData;P.compositeTextSizes=[W.possiblyEvaluate(new $n(de),p),W.possiblyEvaluate(new $n(we),p)]}if(d.iconSizeData.kind==="composite"){const{minZoom:de,maxZoom:we}=d.iconSizeData;P.compositeIconSizes=[Z.possiblyEvaluate(new $n(de),p),Z.possiblyEvaluate(new $n(we),p)]}P.layoutTextSize=W.possiblyEvaluate(new $n(v+1),p),P.layoutIconSize=Z.possiblyEvaluate(new $n(v+1),p),P.textMaxSize=W.possiblyEvaluate(new $n(18),p);const ee=O.get("symbol-placement"),Q=O.get("text-rotation-alignment")==="map"&&ee!=="point",K=O.get("text-size");let ie=!1;const se=[];for(const de of d.features){const we=O.get("text-font").evaluate(de,{},p).join(","),_e=K.evaluate(de,{},p)*P.textScaleFactor,xe=P.layoutTextSize.evaluate(de,{},p)*P.textScaleFactor,ke=P.layoutIconSize.evaluate(de,{},p)*P.iconScaleFactor,Se={horizontal:{},vertical:void 0},De=de.text;let Ve,Fe=[0,0];if(De){const It=De.toString(),yr=O.get("text-letter-spacing").evaluate(de,{},p)*Jo,Zt=O.get("text-line-height").evaluate(de,{},p)*Jo,nr=rD(It)?yr:0,Er=O.get("text-anchor").evaluate(de,{},p),Vr=O.get("text-variable-anchor");if(!Vr){const un=O.get("text-radial-offset").evaluate(de,{},p);Fe=un?hV(Er,[un*Jo,VD]):O.get("text-offset").evaluate(de,{},p).map(Un=>Un*Jo)}let Cr=Q?"center":O.get("text-justify").evaluate(de,{},p);const Yr=ee==="point",Ur=Yr?O.get("text-max-width").evaluate(de,{},p)*Jo:1/0,Qr=un=>{d.allowVerticalPlacement&&Bb(It)&&(Se.vertical=BD(De,o,c,m,we,Ur,Zt,Er,un,nr,Fe,ys.vertical,!0,xe,_e,M))};if(!Q&&Vr){const un=Cr==="auto"?Vr.map(Ar=>WD(Ar)):[Cr];let Un=!1;for(let Ar=0;Ar<un.length;Ar++){const an=un[Ar];if(!Se.horizontal[an])if(Un)Se.horizontal[an]=Se.horizontal[0];else{const ri=BD(De,o,c,m,we,Ur,Zt,"center",an,nr,Fe,ys.horizontal,!1,xe,_e,M);ri&&(Se.horizontal[an]=ri,Un=ri.positionedLines.length===1)}}Qr("left")}else{if(Cr==="auto"&&(Cr=WD(Er)),Yr||O.get("text-writing-mode").indexOf("horizontal")>=0||!Bb(It)){const un=BD(De,o,c,m,we,Ur,Zt,Er,Cr,nr,Fe,ys.horizontal,!1,xe,_e,M);un&&(Se.horizontal[Cr]=un)}Qr(Yr?"left":Cr)}}let Ze,He,tt,Ke,nt,Ct=!1;if(de.icon&&de.icon.hasPrimary()){const It=pV(de.icon,d.iconSizeData,w["icon-size"],p,d.zoom,de,M,P.iconScaleFactor);Ze=It.iconPrimary,He=It.iconSecondary;const yr=Ze.toString(),Zt=h.get(yr);Zt&&(tt=O.get("icon-offset").evaluate(de,{},p),Ke=O.get("icon-anchor").evaluate(de,{},p),nt=O.get("icon-text-fit").evaluate(de,{},p),Ve=nue(m.get(yr),He?m.get(He.toString()):void 0,tt,Ke),Ct=Zt.sdf,d.sdfIcons===void 0?d.sdfIcons=Zt.sdf:d.sdfIcons!==Zt.sdf&&pi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Zt.pixelRatio!==d.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(d.iconsNeedLinear=!0))}ie=ie||!(!de.icon||!de.icon.hasSecondary());const At=GD(Se.horizontal)||Se.vertical;d.iconsInText||(d.iconsInText=!!At&&At.iconsInText);const Qt=xe*P.textScaleFactor/Jo,{defaultShapedIcon:Rt,verticallyShapedIcon:Ft}=due(d,Ve,O,de,p,Se,Qt,tt,nt);Ve=Rt,se.push({feature:de,shapedTextOrientations:Se,shapedText:At,shapedIcon:Ve,iconPrimary:Ze,iconSecondary:He,iconOffset:tt,iconAnchor:Ke,verticallyShapedIcon:Ft,layoutTextSize:xe,layoutIconSize:ke,textOffset:Fe,isSDFIcon:Ct,iconTextFit:nt})}return{featureData:se,sizes:P,hasAnySecondaryIcon:ie,textAlongLine:Q,symbolPlacement:ee}},i.ea=aV,i.eb=function(d,o,c,h,m,p,v,T,M,O){const{featureData:w,hasAnySecondaryIcon:P,sizes:D,textAlongLine:I,symbolPlacement:k}=o;for(const N of w){const{shapedIcon:W,verticallyShapedIcon:Z,feature:ee,shapedTextOrientations:Q,shapedText:K,layoutTextSize:ie,textOffset:se,isSDFIcon:de,iconPrimary:we,iconSecondary:_e,iconTextFit:xe,iconOffset:ke}=N;mV(W,O.iconPositions,we,_e),mV(Z,O.iconPositions,we,_e),uue(Q,O.iconPositions),(K||W)&&hue(d,ee,Q,W,Z,M,D,ie,0,se,de,h,m,v,T,P,xe,ke,I,k)}c&&d.generateCollisionDebugBuffers(p,d.collisionBoxArray,D.textScaleFactor)},i.ec=Vf,i.ed=EA,i.ee=Pr,i.ef=qU,i.eg=W6,i.eh=_,i.ei=function(d){let o=0;if(new Uint32Array(d,0,1)[0]!==F8){const c=new Uint32Array(d,0,7),[,,h,m,p,v]=c;o=c.byteLength+m+p+v+p,(h!==d.byteLength||o>=d.byteLength)&&pi("Invalid b3dm header information.")}return V8(d,o)},i.ej=function(d,o){const c=G8(d);for(const h of c){for(const m of h.meshes)Bde(m);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push($de(h.lights,o)))}return c},i.ek=yA,i.el=i8,i.em=$s,i.en=function(d){Jr(),Gr!=null&&Gr.then(o=>{o.keys().then(c=>{for(let h=0;h<c.length-d;h++)o.delete(c[h])})})},i.f=function(d){return d.indexOf("mapbox:")===0},i.g=function(d,o){return zs(Pi(d,{method:"GET"}),o)},i.h=ye,i.i=function(d){return pe.API_STYLE_REGEX.test(d)&&!Ae(d)},i.j=function(d){return decodeURIComponent(atob(d).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(d){return btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(o,c)=>String.fromCharCode(+("0x"+c))))},i.l=Pi,i.m=En,i.n=function(d,o){return zs(Pi(d,{type:"json"}),o)},i.o=nb,i.p=function(d,o){return zs(Pi(d,{method:"POST"}),o)},i.q=pt,i.r=Ko,i.s=function(d){try{const o=self[d];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=yt,i.u=function(){return function d(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,d)}()},i.v=function(d){return!!d&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d)},i.w=pi,i.x=function(){return cL||(cL=new gg),cL},i.y=fL,i.z=af}),l(["./shared"],function(i){function _(mt){const pe=mt?mt.url.toString():void 0;return pe?performance.getEntriesByName(pe):[]}function b(mt){if(typeof mt=="number"||typeof mt=="boolean"||typeof mt=="string"||mt==null)return JSON.stringify(mt);if(Array.isArray(mt)){let ye="[";for(const Ae of mt)ye+=`${b(Ae)},`;return`${ye}]`}let pe="{";for(const ye of Object.keys(mt).sort())pe+=`${ye}:${b(mt[ye])},`;return`${pe}}`}function E(mt){let pe="";for(const ye of i.bm)(mt.type!=="model"||ye!=="minzoom"&&ye!=="maxzoom")&&(pe+=`/${b(mt[ye])}`);return pe}class C{constructor(pe){this.keyCache={},this._layers={},this._layerConfigs={},pe&&this.replace(pe)}replace(pe,ye){this._layerConfigs={},this._layers={},this.update(pe,[],ye)}update(pe,ye,Ae){this._options=Ae;for(const Le of pe)this._layerConfigs[Le.id]=Le,(this._layers[Le.id]=i.cv(Le,this.scope,null,this._options)).compileFilter(Ae),this.keyCache[Le.id]&&delete this.keyCache[Le.id];for(const Le of ye)delete this.keyCache[Le],delete this._layerConfigs[Le],delete this._layers[Le];this.familiesBySource={};const je=function(Le,qe){const lt={};for(let ft=0;ft<Le.length;ft++){const yt=Le[ft];let pt=qe&&qe[yt.id];!pt&&(pt=E(yt),yt.type==="line"&&yt.paint)&&function Xt(er){return typeof er=="string"&&er==="line-progress"||(Array.isArray(er)?er.some(Xt):!(!er||typeof er!="object")&&Object.values(er).some(Xt))}(yt.paint["line-width"])&&(pt+=`/${b(yt.paint["line-width"])}`),qe&&(qe[yt.id]=pt);let Nt=lt[pt];Nt||(Nt=lt[pt]=[]),Nt.push(yt)}const Xe=[];for(const ft in lt)Xe.push(lt[ft]);return Xe}(Object.values(this._layerConfigs),this.keyCache);for(const Le of je){const qe=Le.map(Nt=>this._layers[Nt.id]),lt=qe[0];if(lt.visibility==="none")continue;const Xe=lt.source||"";let ft=this.familiesBySource[Xe];ft||(ft=this.familiesBySource[Xe]={});const yt=lt.sourceLayer||"_geojsonTileLayer";let pt=ft[yt];pt||(pt=ft[yt]=[]),pt.push(qe)}}}const R=1*i.d_;class F{constructor(pe){const ye={},Ae=[];for(const lt in pe){const Xe=pe[lt],ft=ye[lt]={};for(const yt in Xe.glyphs){const pt=Xe.glyphs[+yt];if(!pt||pt.bitmap.width===0||pt.bitmap.height===0)continue;const Nt=pt.metrics.localGlyph?R:1,Xt={x:0,y:0,w:pt.bitmap.width+2*Nt,h:pt.bitmap.height+2*Nt};Ae.push(Xt),ft[yt]=Xt}}const{w:je,h:Le}=i.H(Ae),qe=new i.dZ({width:je||1,height:Le||1});for(const lt in pe){const Xe=pe[lt];for(const ft in Xe.glyphs){const yt=Xe.glyphs[+ft];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const pt=ye[lt][ft],Nt=yt.metrics.localGlyph?R:1;i.dZ.copy(yt.bitmap,qe,{x:0,y:0},{x:pt.x+Nt,y:pt.y+Nt},yt.bitmap)}}this.image=qe,this.positions=ye}}i.dY(F,"GlyphAtlas");class U{constructor(pe){this.tileID=new i.aH(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.tileZoom=pe.tileZoom,this.uid=pe.uid,this.zoom=pe.zoom,this.lut=pe.lut,this.canonical=pe.tileID.canonical,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.scope=pe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=pe.showCollisionBoxes,this.collectResourceTiming=!!pe.request&&pe.request.collectResourceTiming,this.promoteId=pe.promoteId,this.isSymbolTile=pe.isSymbolTile,this.tileTransform=i.aR(pe.tileID.canonical,pe.projection),this.projection=pe.projection,this.worldview=pe.worldview,this.localizableLayerIds=pe.localizableLayerIds,this.brightness=pe.brightness,this.extraShadowCaster=!!pe.extraShadowCaster,this.tessellationStep=pe.tessellationStep,this.scaleFactor=pe.scaleFactor}parse(pe,ye,Ae,je,Le){this.status="parsing",this.data=pe,this.collisionBoxArray=new i.aX;const qe=new i.d$(Object.keys(pe.layers).sort()),lt=new i.e0(this.tileID,this.promoteId);lt.bucketLayerIDs=[];const Xe={},ft=new i.e1(256,256),yt={featureIndex:lt,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:ft,availableImages:Ae,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},pt=ye.familiesBySource[this.source];for(const Jr in pt){const Tn=pe.layers[Jr];if(!Tn)continue;let En=!1,Pn=!1,Ni=!1;for(const _a of pt[Jr])_a[0].type==="symbol"?En=!0:Pn=!0,_a[0].is3D()&&_a[0].type!=="model"&&(Ni=!0);if(this.extraShadowCaster&&!Ni||this.isSymbolTile===!0&&!En||this.isSymbolTile===!1&&!Pn)continue;Tn.version===1&&i.w(`Vector tile source "${this.source}" layer "${Jr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Po=qe.encode(Jr),ia=[];let Ns=!1;for(let _a=0,Io=0;_a<Tn.length;_a++){const Fo=Tn.feature(_a),rf=lt.getId(Fo,Jr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Jr)){const zs=Fo.properties?Fo.properties.worldview:null;if(this.worldview&&typeof zs=="string")if(zs==="all")Fo.properties.$localized=!0;else{if(!zs.split(",").includes(this.worldview))continue;Fo.properties.$localized=!0,Fo.properties.worldview=this.worldview}}!Ns&&Fo.properties&&Fo.properties.hasOwnProperty(i.e2)&&(Ns=!0),ia.push({feature:Fo,id:rf,index:Io,sourceLayerIndex:Po}),Io++}Ns&&!yt.elevationFeatures&&pe.layers.hasOwnProperty(i.e3)&&(yt.elevationFeatures=i.e4.parseFrom(pe.layers[i.e3],this.canonical));for(const _a of pt[Jr]){const Io=_a[0];(!this.extraShadowCaster||Io.is3D()&&Io.type!=="model")&&(this.isSymbolTile!==void 0&&Io.type==="symbol"!==this.isSymbolTile||Io.minzoom&&this.zoom<Math.floor(Io.minzoom)||Io.maxzoom&&this.zoom>=Io.maxzoom||Io.visibility!=="none"&&($(_a,this.zoom,yt.brightness,Ae),(Xe[Io.id]=Io.createBucket({index:lt.bucketLayerIDs.length,layers:_a,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Po,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(ia,yt,this.tileID.canonical,this.tileTransform),lt.bucketLayerIDs.push(_a.map(Fo=>i.C(Fo.id,Fo.scope)))))}}let Nt,Xt,er,Rr,Br,$r;ft.trim();const Gr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Gn=()=>{if(Nt)return this.status="done",Le(Nt);if(this.extraShadowCaster)this.status="done",Le(null,{buckets:Object.values(Xe).filter(Jr=>!Jr.isEmpty()),featureIndex:lt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:yt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Xt&&er&&Rr){const Jr=new F(Xt),Tn=new Map;for(const[Ni,Po]of er.entries()){const{imagePosition:ia}=i.e7(Ni,Po,i.e8);Tn.set(Ni,ia)}const En={};for(const Ni in Xe){const Po=Xe[Ni];Po instanceof i.aY&&($(Po.layers,this.zoom,yt.brightness,Ae),En[Ni]=i.e9(Po,Xt,Jr.positions,er,Tn,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio))}const Pn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(je,er,Br,()=>{Pn.iconsPending=!1,_i(En,Jr,Pn)}),this.rasterizeIfNeeded(je,Rr,$r,()=>{Pn.patternsPending=!1,_i(En,Jr,Pn)})}},_i=(Jr,Tn,En,Pn)=>{if(En.iconsPending||En.patternsPending)return;const Ni=new i.ea(er,Rr,this.lut);for(const Po in Xe){const ia=Xe[Po];if(Po in Jr)i.eb(ia,Jr[Po],this.showCollisionBoxes,Ae,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,er,Ni);else if(ia.hasPattern&&(ia instanceof i.b2||ia instanceof i.b3||ia instanceof i.d8)){$(ia.layers,this.zoom,yt.brightness,Ae);const Ns=Object.fromEntries(Ni.patternPositions);ia.addFeatures(yt,this.tileID.canonical,Ns,Ae,this.tileTransform,this.brightness)}}this.status="done",Le(null,{buckets:Object.values(Xe).filter(Po=>!Po.isEmpty()),featureIndex:lt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tn.image,lineAtlas:ft,imageAtlas:Ni,brightness:yt.brightness})};if(!this.extraShadowCaster){const Jr=i.e5(yt.glyphDependencies,Pn=>Object.keys(Pn).map(Number));Object.keys(Jr).length?je.send("getGlyphs",{uid:this.uid,stacks:Jr,scope:this.scope},(Pn,Ni)=>{Nt||(Nt=Pn,Xt=Ni,Gn())},void 0,!1,Gr):Xt={};const Tn=Array.from(yt.iconDependencies.keys()).map(Pn=>i.I.parse(Pn));Tn.length?je.send("getImages",{images:Tn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Pn,Ni)=>{Nt||(Nt=Pn,er=new Map,Br=this.updateImageMapAndGetImageTaskQueue(er,Ni,yt.iconDependencies),Gn())},void 0,!1,Gr):(er=new Map,Br=new Map);const En=Array.from(yt.patternDependencies.keys()).map(Pn=>i.I.parse(Pn));En.length?je.send("getImages",{images:En,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Pn,Ni)=>{Nt||(Nt=Pn,Rr=new Map,$r=this.updateImageMapAndGetImageTaskQueue(Rr,Ni,yt.patternDependencies),Gn())},void 0,!1,Gr):(Rr=new Map,$r=new Map)}if(yt.elevationFeatures&&yt.elevationFeatures.length>0){const Jr=[];for(const En of Object.values(Xe))if(En instanceof i.b3){const Pn=En.getUnevaluatedPortalGraph();Pn&&Jr.push(Pn)}const Tn=i.e6.evaluate(Jr);for(const En of Object.values(Xe))En instanceof i.b3&&En.setEvaluatedPortalGraph(Tn)}Gn()}rasterizeIfNeeded(pe,ye,Ae,je){Array.from(ye.values()).some(Le=>Le.usvg)?this.rasterize(pe,ye,Ae,je):je()}updateImageMapAndGetImageTaskQueue(pe,ye,Ae){const je=new Map;for(const Le of ye.keys()){const qe=Ae.get(Le)||[];for(const lt of qe){const Xe=lt.toString(),ft=ye.get(lt.id.toString());ft.usvg?je.has(Xe)||(je.set(Xe,lt),pe.set(Xe,Object.assign({},ft))):pe.set(Xe,ft)}}return je}rasterize(pe,ye,Ae,je){this.rasterizeTask=pe.send("rasterizeImages",{scope:this.scope,tasks:Ae},(Le,qe)=>{if(!Le)for(const[lt,Xe]of qe.entries()){const ft=Object.assign(ye.get(lt),{data:Xe});ye.set(lt,ft)}je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function $(mt,pe,ye,Ae){const je=new i.aa(pe,{brightness:ye});for(const Le of mt)Le.recalculate(je,Ae)}class H extends i.E{constructor(pe,ye,Ae,je,Le,qe){super(),this.actor=pe,this.layerIndex=ye,this.availableImages=Ae,this.loadVectorData=Le||i.aE,this.loading={},this.loaded={},this.deduped=new i.aD(pe.scheduler),this.isSpriteLoaded=je,this.scheduler=pe.scheduler,this.brightness=qe}loadTile(pe,ye){const Ae=pe.uid,je=pe&&pe.request,Le=je&&je.collectResourceTiming,qe=this.loading[Ae]=new U(pe);qe.abort=this.loadVectorData(pe,(lt,Xe)=>{const ft=!this.loading[Ae];if(delete this.loading[Ae],qe.cancelRasterize(),ft||lt||!Xe)return qe.status="done",ft||(this.loaded[Ae]=qe),ye(lt);const yt=Xe.rawData,pt={};Xe.expires&&(pt.expires=Xe.expires),Xe.cacheControl&&(pt.cacheControl=Xe.cacheControl),qe.vectorTile=Xe.vectorTile||new i.ec.VectorTile(new i.bi(yt));const Nt=()=>{qe.parse(qe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Xt,er)=>{if(Xt||!er)return ye(Xt);const Rr={};if(Le){const Br=_(je);Br.length>0&&(Rr.resourceTiming=JSON.parse(JSON.stringify(Br)))}ye(null,i.l({rawTileData:yt.slice(0)},er,pt,Rr))})};this.isSpriteLoaded?Nt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Nt,{type:"parseTile",isSymbolTile:pe.isSymbolTile,zoom:pe.tileZoom}):Nt()}),this.loaded=this.loaded||{},this.loaded[Ae]=qe})}reloadTile(pe,ye){const Ae=this.loaded,je=pe.uid;if(Ae&&Ae[je]){const Le=Ae[je];Le.scaleFactor=pe.scaleFactor,Le.showCollisionBoxes=pe.showCollisionBoxes,Le.projection=pe.projection,Le.brightness=pe.brightness,Le.tileTransform=i.aR(pe.tileID.canonical,pe.projection),Le.extraShadowCaster=pe.extraShadowCaster,Le.lut=pe.lut;const qe=(lt,Xe)=>{const ft=Le.reloadCallback;ft&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,ft)),ye(lt,Xe)};Le.status==="parsing"?Le.reloadCallback=qe:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,qe):qe())}else ye(null,void 0)}abortTile(pe,ye){const Ae=pe.uid,je=this.loading[Ae];je&&(je.abort&&je.abort(),delete this.loading[Ae]),ye()}removeTile(pe,ye){const Ae=this.loaded,je=pe.uid;Ae&&Ae[je]&&delete Ae[je],ye()}}class q{loadTile(pe,ye){const{uid:Ae,encoding:je,rawImageData:Le,padding:qe}=pe,lt=ImageBitmap&&Le instanceof ImageBitmap?this.getImageData(Le,qe):Le;ye(null,new i.ed(Ae,lt,je,qe<1))}reloadTile(pe,ye){ye(null,null)}abortTile(pe,ye){ye()}removeTile(pe,ye){ye()}getImageData(pe,ye){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pe.width,pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pe.width,this.offscreenCanvas.height=pe.height,this.offscreenCanvasContext.drawImage(pe,0,0,pe.width,pe.height);const Ae=this.offscreenCanvasContext.getImageData(-ye,-ye,pe.width+2*ye,pe.height+2*ye);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ae}}i.bh.setPbf(i.bi);class G{constructor(pe){this._mrt=new i.bh(pe.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=pe.uid,this.tileID=pe.tileID,this.source=pe.source}parse(pe,ye){const Ae=this._mrt;this.status="parsing",this._entireBuffer=pe;try{Ae.parseHeader(pe),this._isHeaderLoaded=!0;const je=[];for(const Le in Ae.layers){const qe=Ae.getLayer(Le),lt=qe.getDataRange(qe.getBandList()),Xe=Ae.createDecodingTask(lt),ft=pe.slice(lt.firstByte,lt.lastByte+1),yt=i.bh.performDecoding(ft,Xe).then(pt=>Xe.complete(null,pt)).catch(pt=>Xe.complete(pt,null));je.push(yt)}Promise.allSettled(je).then(()=>ye(null,Ae))}catch(je){ye(je)}}}class J{constructor(pe){this.actor=pe,this.loading={},this.loaded={}}loadTile(pe,ye){const Ae=pe.uid,je=pe.request,Le=this.loading[Ae]=new G(pe),{cancel:qe}=i.bj(je,(lt,Xe,ft,yt)=>{const pt=!this.loading[Ae];if(delete this.loading[Ae],pt||lt||!Xe)return Le.status="done",pt||(this.loaded[Ae]=Le),ye(lt);Le.parse(Xe,(Nt,Xt)=>{if(Nt||!Xt)return ye(Nt);ye(null,Xt,ft,yt)}),this.loaded[Ae]=Le});Le.abort=qe}reloadTile(pe,ye){ye(null,void 0)}abortTile(pe,ye){const Ae=pe.uid,je=this.loading[Ae];je&&(je.abort&&je.abort(),delete this.loading[Ae]),ye()}removeTile(pe,ye){const Ae=pe.uid;this.loaded[Ae]&&delete this.loaded[Ae],ye()}decodeRasterArray({task:pe,buffer:ye},Ae){i.bh.performDecoding(ye,pe).then(je=>Ae(null,je)).catch(je=>Ae(je))}}const te=i.ec.VectorTileFeature.prototype.toGeoJSON;class oe{constructor(pe){this._feature=pe,this.extent=i.ai,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))}loadGeometry(){if(this._feature.type===1){const pe=[];for(const ye of this._feature.geometry)pe.push([new i.P(ye[0],ye[1])]);return pe}{const pe=[];for(const ye of this._feature.geometry){const Ae=[];for(const je of ye)Ae.push(new i.P(je[0],je[1]));pe.push(Ae)}return pe}}toGeoJSON(pe,ye,Ae){return te.call(this,pe,ye,Ae)}}class he{constructor(pe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ai,this.length=pe.length,this._features=pe}feature(pe){return new oe(this._features[pe])}}const le=64/4096,ve=128;class We{constructor(){this.features=new Map}clear(){this.features.clear()}load(pe=[],ye){for(const Ae of pe){const je=Ae.id;if(je==null)continue;let Le=this.features.get(je);Le&&this.updateCache(Le,ye),Ae.geometry?(Le=Re(Ae),this.updateCache(Le,ye),this.features.set(je,Le)):this.features.delete(je),this.updateCache(Le,ye)}}updateCache(pe,ye){for(const{canonical:Ae,uid:je}of Object.values(ye)){const{z:Le,x:qe,y:lt}=Ae;Ie(pe,Math.pow(2,Le),qe,lt)&&delete ye[je]}}getTile(pe,ye,Ae){const je=Math.pow(2,pe),Le=[];for(const qe of this.features.values())Ie(qe,je,ye,Ae)&&Le.push(rt(qe,je,ye,Ae));return{features:Le}}getFeatures(){return[...this.features.values()]}}function Ie({minX:mt,minY:pe,maxX:ye,maxY:Ae},je,Le,qe){return mt<(Le+1+le)/je&&pe<(qe+1+le)/je&&ye>(Le-le)/je&&Ae>(qe-le)/je}function Re(mt){const{id:pe,geometry:ye,properties:Ae}=mt;if(!ye)return;if(ye.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:je,coordinates:Le}=ye,qe={id:pe,type:1,geometry:[],tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},lt=qe.geometry;if(je==="Point")$e(Le,lt,qe);else if(je==="MultiPoint")for(const Xe of Le)$e(Xe,lt,qe);else if(je==="LineString")qe.type=2,ot(Le,lt,qe);else if(je==="MultiLineString")qe.type=2,Je(Le,lt,qe);else if(je==="Polygon")qe.type=3,Je(Le,lt,qe,!0);else{if(je!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");qe.type=3;for(const Xe of Le)Je(Xe,lt,qe,!0)}return qe}function $e([mt,pe],ye,Ae){const je=i.av(mt);let Le=i.aC(pe);Le=Le<0?0:Le>1?1:Le,ye.push(je,Le),Ae.minX=Math.min(Ae.minX,je),Ae.minY=Math.min(Ae.minY,Le),Ae.maxX=Math.max(Ae.maxX,je),Ae.maxY=Math.max(Ae.maxY,Le)}function ot(mt,pe,ye,Ae=!1,je=!1){const Le=[];for(const qe of mt)$e(qe,Le,ye);pe.push(Le),Ae&&function(qe,lt){let Xe=0;for(let ft=0,yt=qe.length,pt=yt-2;ft<yt;pt=ft,ft+=2)Xe+=(qe[ft]-qe[pt])*(qe[ft+1]+qe[pt+1]);if(Xe>0===lt)for(let ft=0,yt=qe.length;ft<yt/2;ft+=2){const pt=qe[ft],Nt=qe[ft+1];qe[ft]=qe[yt-2-ft],qe[ft+1]=qe[yt-1-ft],qe[yt-2-ft]=pt,qe[yt-1-ft]=Nt}}(Le,je)}function Je(mt,pe,ye,Ae=!1){for(let je=0;je<mt.length;je++)ot(mt[je],pe,ye,Ae,je===0)}function rt(mt,pe,ye,Ae){const{id:je,type:Le,geometry:qe,tags:lt}=mt,Xe=[];if(Le===1)(function(ft,yt,pt,Nt,Xt){for(let er=0;er<ft.length;er+=2){const Rr=Math.round(i.ai*(ft[er+0]*yt-pt)),Br=Math.round(i.ai*(ft[er+1]*yt-Nt));Xt.push([Rr,Br])}})(qe,pe,ye,Ae,Xe);else for(const ft of qe)st(ft,pe,ye,Ae,Xe);return{id:je,type:Le,geometry:Xe,tags:lt}}function st(mt,pe,ye,Ae,je){const Le=-ve,qe=i.ai+ve;let lt;for(let Xe=0;Xe<mt.length-2;Xe+=2){let ft=Math.round(i.ai*(mt[Xe+0]*pe-ye)),yt=Math.round(i.ai*(mt[Xe+1]*pe-Ae)),pt=Math.round(i.ai*(mt[Xe+2]*pe-ye)),Nt=Math.round(i.ai*(mt[Xe+3]*pe-Ae));const Xt=pt-ft,er=Nt-yt;ft<Le&&pt<Le||(ft<Le?(yt+=Math.round(er*((Le-ft)/Xt)),ft=Le):pt<Le&&(Nt=yt+Math.round(er*((Le-ft)/Xt)),pt=Le),yt<Le&&Nt<Le||(yt<Le?(ft+=Math.round(Xt*((Le-yt)/er)),yt=Le):Nt<Le&&(pt=ft+Math.round(Xt*((Le-yt)/er)),Nt=Le),ft>=qe&&pt>=qe||(ft>=qe?(yt+=Math.round(er*((qe-ft)/Xt)),ft=qe):pt>=qe&&(Nt=yt+Math.round(er*((qe-ft)/Xt)),pt=qe),yt>=qe&&Nt>=qe||(yt>=qe?(ft+=Math.round(Xt*((qe-yt)/er)),yt=qe):Nt>=qe&&(pt=ft+Math.round(Xt*((qe-yt)/er)),Nt=qe),lt&&ft===lt[lt.length-1][0]&&yt===lt[lt.length-1][1]||(lt=[[ft,yt]],je.push(lt)),lt.push([pt,Nt])))))}}var at,Be,ct,jt={exports:{}},Lt=function(){if(ct)return jt.exports;ct=1;var mt=i.eg(),pe=function(){if(Be)return at;Be=1;var yt=i.ee(),pt=i.ef().VectorTileFeature;function Nt(er,Rr){this.options=Rr||{},this.features=er,this.length=er.length}function Xt(er,Rr){this.id=typeof er.id=="number"?er.id:void 0,this.type=er.type,this.rawGeometry=er.type===1?[er.geometry]:er.geometry,this.properties=er.tags,this.extent=Rr||4096}return at=Nt,Nt.prototype.feature=function(er){return new Xt(this.features[er],this.options.extent)},Xt.prototype.loadGeometry=function(){var er=this.rawGeometry;this.geometry=[];for(var Rr=0;Rr<er.length;Rr++){for(var Br=er[Rr],$r=[],Gr=0;Gr<Br.length;Gr++)$r.push(new yt(Br[Gr][0],Br[Gr][1]));this.geometry.push($r)}return this.geometry},Xt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var er=this.geometry,Rr=1/0,Br=-1/0,$r=1/0,Gr=-1/0,Gn=0;Gn<er.length;Gn++)for(var _i=er[Gn],Jr=0;Jr<_i.length;Jr++){var Tn=_i[Jr];Rr=Math.min(Rr,Tn.x),Br=Math.max(Br,Tn.x),$r=Math.min($r,Tn.y),Gr=Math.max(Gr,Tn.y)}return[Rr,$r,Br,Gr]},Xt.prototype.toGeoJSON=pt.prototype.toGeoJSON,at}();function ye(yt){var pt=new mt;return function(Nt,Xt){for(var er in Nt.layers)Xt.writeMessage(3,Ae,Nt.layers[er])}(yt,pt),pt.finish()}function Ae(yt,pt){var Nt;pt.writeVarintField(15,yt.version||1),pt.writeStringField(1,yt.name||""),pt.writeVarintField(5,yt.extent||4096);var Xt={keys:[],values:[],keycache:{},valuecache:{}};for(Nt=0;Nt<yt.length;Nt++)Xt.feature=yt.feature(Nt),pt.writeMessage(2,je,Xt);var er=Xt.keys;for(Nt=0;Nt<er.length;Nt++)pt.writeStringField(3,er[Nt]);var Rr=Xt.values;for(Nt=0;Nt<Rr.length;Nt++)pt.writeMessage(4,ft,Rr[Nt])}function je(yt,pt){var Nt=yt.feature;Nt.id!==void 0&&pt.writeVarintField(1,Nt.id),pt.writeMessage(2,Le,yt),pt.writeVarintField(3,Nt.type),pt.writeMessage(4,Xe,Nt)}function Le(yt,pt){var Nt=yt.feature,Xt=yt.keys,er=yt.values,Rr=yt.keycache,Br=yt.valuecache;for(var $r in Nt.properties){var Gr=Nt.properties[$r],Gn=Rr[$r];if(Gr!==null){Gn===void 0&&(Xt.push($r),Rr[$r]=Gn=Xt.length-1),pt.writeVarint(Gn);var _i=typeof Gr;_i!=="string"&&_i!=="boolean"&&_i!=="number"&&(Gr=JSON.stringify(Gr));var Jr=_i+":"+Gr,Tn=Br[Jr];Tn===void 0&&(er.push(Gr),Br[Jr]=Tn=er.length-1),pt.writeVarint(Tn)}}}function qe(yt,pt){return(pt<<3)+(7&yt)}function lt(yt){return yt<<1^yt>>31}function Xe(yt,pt){for(var Nt=yt.loadGeometry(),Xt=yt.type,er=0,Rr=0,Br=Nt.length,$r=0;$r<Br;$r++){var Gr=Nt[$r],Gn=1;Xt===1&&(Gn=Gr.length),pt.writeVarint(qe(1,Gn));for(var _i=Xt===3?Gr.length-1:Gr.length,Jr=0;Jr<_i;Jr++){Jr===1&&Xt!==1&&pt.writeVarint(qe(2,_i-1));var Tn=Gr[Jr].x-er,En=Gr[Jr].y-Rr;pt.writeVarint(lt(Tn)),pt.writeVarint(lt(En)),er+=Tn,Rr+=En}Xt===3&&pt.writeVarint(qe(7,1))}}function ft(yt,pt){var Nt=typeof yt;Nt==="string"?pt.writeStringField(1,yt):Nt==="boolean"?pt.writeBooleanField(7,yt):Nt==="number"&&(yt%1!=0?pt.writeDoubleField(3,yt):yt<0?pt.writeSVarintField(6,yt):pt.writeVarintField(5,yt))}return jt.exports=ye,jt.exports.fromVectorTileJs=ye,jt.exports.fromGeojsonVt=function(yt,pt){pt=pt||{};var Nt={};for(var Xt in yt)Nt[Xt]=new pe(yt[Xt].features,pt),Nt[Xt].name=Xt,Nt[Xt].version=pt.version,Nt[Xt].extent=pt.extent;return ye({layers:Nt})},jt.exports.GeoJSONWrapper=pe,jt.exports}(),$t=i.eh(Lt);const ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:mt=>mt},tr=Math.fround||(mr=new Float32Array(1),mt=>(mr[0]=+mt,mr[0]));var mr;const rr=3,Ut=5,gr=6;class Gt{constructor(pe){this.options=Object.assign(Object.create(ut),pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(pe){const{log:ye,minZoom:Ae,maxZoom:je}=this.options;ye&&console.time("total time");const Le=`prepare ${pe.length} points`;ye&&console.time(Le),this.points=pe;const qe=[];for(let Xe=0;Xe<pe.length;Xe++){const ft=pe[Xe];if(!ft.geometry)continue;const[yt,pt]=ft.geometry.coordinates,Nt=tr(Ot(yt)),Xt=tr(Pr(pt));qe.push(Nt,Xt,1/0,Xe,-1,1),this.options.reduce&&qe.push(0)}let lt=this.trees[je+1]=this._createTree(qe);ye&&console.timeEnd(Le);for(let Xe=je;Xe>=Ae;Xe--){const ft=+Date.now();lt=this.trees[Xe]=this._createTree(this._cluster(lt,Xe)),ye&&console.log("z%d: %d clusters in %dms",Xe,lt.numItems,+Date.now()-ft)}return ye&&console.timeEnd("total time"),this}getClusters(pe,ye){let Ae=((pe[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,pe[1]));let Le=pe[2]===180?180:((pe[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,pe[3]));if(pe[2]-pe[0]>=360)Ae=-180,Le=180;else if(Ae>Le){const pt=this.getClusters([Ae,je,180,qe],ye),Nt=this.getClusters([-180,je,Le,qe],ye);return pt.concat(Nt)}const lt=this.trees[this._limitZoom(ye)],Xe=lt.range(Ot(Ae),Pr(qe),Ot(Le),Pr(je)),ft=lt.data,yt=[];for(const pt of Xe){const Nt=this.stride*pt;yt.push(ft[Nt+Ut]>1?ge(ft,Nt,this.clusterProps):this.points[ft[Nt+rr]])}return yt}getChildren(pe){const ye=this._getOriginId(pe),Ae=this._getOriginZoom(pe),je="No cluster with the specified id.",Le=this.trees[Ae];if(!Le)throw new Error(je);const qe=Le.data;if(ye*this.stride>=qe.length)throw new Error(je);const lt=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),Xe=Le.within(qe[ye*this.stride],qe[ye*this.stride+1],lt),ft=[];for(const yt of Xe){const pt=yt*this.stride;qe[pt+4]===pe&&ft.push(qe[pt+Ut]>1?ge(qe,pt,this.clusterProps):this.points[qe[pt+rr]])}if(ft.length===0)throw new Error(je);return ft}getLeaves(pe,ye,Ae){const je=[];return this._appendLeaves(je,pe,ye=ye||10,Ae=Ae||0,0),je}getTile(pe,ye,Ae){const je=this.trees[this._limitZoom(pe)],Le=Math.pow(2,pe),{extent:qe,radius:lt}=this.options,Xe=lt/qe,ft=(Ae-Xe)/Le,yt=(Ae+1+Xe)/Le,pt={features:[]};return this._addTileFeatures(je.range((ye-Xe)/Le,ft,(ye+1+Xe)/Le,yt),je.data,ye,Ae,Le,pt),ye===0&&this._addTileFeatures(je.range(1-Xe/Le,ft,1,yt),je.data,Le,Ae,Le,pt),ye===Le-1&&this._addTileFeatures(je.range(0,ft,Xe/Le,yt),je.data,-1,Ae,Le,pt),pt.features.length?pt:null}getClusterExpansionZoom(pe){let ye=this._getOriginZoom(pe)-1;for(;ye<=this.options.maxZoom;){const Ae=this.getChildren(pe);if(ye++,Ae.length!==1)break;pe=Ae[0].properties.cluster_id}return ye}_appendLeaves(pe,ye,Ae,je,Le){const qe=this.getChildren(ye);for(const lt of qe){const Xe=lt.properties;if(Xe&&Xe.cluster?Le+Xe.point_count<=je?Le+=Xe.point_count:Le=this._appendLeaves(pe,Xe.cluster_id,Ae,je,Le):Le<je?Le++:pe.push(lt),pe.length===Ae)break}return Le}_createTree(pe){const ye=new i.bE(pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ae=0;Ae<pe.length;Ae+=this.stride)ye.add(pe[Ae],pe[Ae+1]);return ye.finish(),ye.data=pe,ye}_addTileFeatures(pe,ye,Ae,je,Le,qe){for(const lt of pe){const Xe=lt*this.stride,ft=ye[Xe+Ut]>1;let yt,pt,Nt;if(ft)yt=cr(ye,Xe,this.clusterProps),pt=ye[Xe],Nt=ye[Xe+1];else{const Rr=this.points[ye[Xe+rr]];yt=Rr.properties;const[Br,$r]=Rr.geometry.coordinates;pt=Ot(Br),Nt=Pr($r)}const Xt={type:1,geometry:[[Math.round(this.options.extent*(pt*Le-Ae)),Math.round(this.options.extent*(Nt*Le-je))]],tags:yt};let er;er=ft||this.options.generateId?ye[Xe+rr]:this.points[ye[Xe+rr]].id,er!==void 0&&(Xt.id=er),qe.features.push(Xt)}}_limitZoom(pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+pe),this.options.maxZoom+1))}_cluster(pe,ye){const{radius:Ae,extent:je,reduce:Le,minPoints:qe}=this.options,lt=Ae/(je*Math.pow(2,ye)),Xe=pe.data,ft=[],yt=this.stride;for(let pt=0;pt<Xe.length;pt+=yt){if(Xe[pt+2]<=ye)continue;Xe[pt+2]=ye;const Nt=Xe[pt],Xt=Xe[pt+1],er=pe.within(Xe[pt],Xe[pt+1],lt),Rr=Xe[pt+Ut];let Br=Rr;for(const $r of er){const Gr=$r*yt;Xe[Gr+2]>ye&&(Br+=Xe[Gr+Ut])}if(Br>Rr&&Br>=qe){let $r,Gr=Nt*Rr,Gn=Xt*Rr,_i=-1;const Jr=(pt/yt<<5)+(ye+1)+this.points.length;for(const Tn of er){const En=Tn*yt;if(Xe[En+2]<=ye)continue;Xe[En+2]=ye;const Pn=Xe[En+Ut];Gr+=Xe[En]*Pn,Gn+=Xe[En+1]*Pn,Xe[En+4]=Jr,Le&&($r||($r=this._map(Xe,pt,!0),_i=this.clusterProps.length,this.clusterProps.push($r)),Le($r,this._map(Xe,En)))}Xe[pt+4]=Jr,ft.push(Gr/Br,Gn/Br,1/0,Jr,-1,Br),Le&&ft.push(_i)}else{for(let $r=0;$r<yt;$r++)ft.push(Xe[pt+$r]);if(Br>1)for(const $r of er){const Gr=$r*yt;if(!(Xe[Gr+2]<=ye)){Xe[Gr+2]=ye;for(let Gn=0;Gn<yt;Gn++)ft.push(Xe[Gr+Gn])}}}}return ft}_getOriginId(pe){return pe-this.points.length>>5}_getOriginZoom(pe){return(pe-this.points.length)%32}_map(pe,ye,Ae){if(pe[ye+Ut]>1){const qe=this.clusterProps[pe[ye+gr]];return Ae?Object.assign({},qe):qe}const je=this.points[pe[ye+rr]].properties,Le=this.options.map(je);return Ae&&Le===je?Object.assign({},Le):Le}}function ge(mt,pe,ye){return{type:"Feature",id:mt[pe+rr],properties:cr(mt,pe,ye),geometry:{type:"Point",coordinates:[(Ae=mt[pe],360*(Ae-.5)),_t(mt[pe+1])]}};var Ae}function cr(mt,pe,ye){const Ae=mt[pe+Ut],je=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae,Le=mt[pe+gr],qe=Le===-1?{}:Object.assign({},ye[Le]);return Object.assign(qe,{cluster:!0,cluster_id:mt[pe+rr],point_count:Ae,point_count_abbreviated:je})}function Ot(mt){return mt/360+.5}function Pr(mt){const pe=Math.sin(mt*Math.PI/180),ye=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return ye<0?0:ye>1?1:ye}function _t(mt){const pe=(180-360*mt)*Math.PI/180;return 360*Math.atan(Math.exp(pe))/Math.PI-90}function hn(mt,pe,ye,Ae){let je=Ae;const Le=pe+(ye-pe>>1);let qe,lt=ye-pe;const Xe=mt[pe],ft=mt[pe+1],yt=mt[ye],pt=mt[ye+1];for(let Nt=pe+3;Nt<ye;Nt+=3){const Xt=qr(mt[Nt],mt[Nt+1],Xe,ft,yt,pt);if(Xt>je)qe=Nt,je=Xt;else if(Xt===je){const er=Math.abs(Nt-Le);er<lt&&(qe=Nt,lt=er)}}je>Ae&&(qe-pe>3&&hn(mt,pe,qe,Ae),mt[qe+2]=je,ye-qe>3&&hn(mt,qe,ye,Ae))}function qr(mt,pe,ye,Ae,je,Le){let qe=je-ye,lt=Le-Ae;if(qe!==0||lt!==0){const Xe=((mt-ye)*qe+(pe-Ae)*lt)/(qe*qe+lt*lt);Xe>1?(ye=je,Ae=Le):Xe>0&&(ye+=qe*Xe,Ae+=lt*Xe)}return qe=mt-ye,lt=pe-Ae,qe*qe+lt*lt}function Ln(mt,pe,ye,Ae){const je={id:mt??null,type:pe,geometry:ye,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")Ge(je,ye);else if(pe==="Polygon")Ge(je,ye[0]);else if(pe==="MultiLineString")for(const Le of ye)Ge(je,Le);else if(pe==="MultiPolygon")for(const Le of ye)Ge(je,Le[0]);return je}function Ge(mt,pe){for(let ye=0;ye<pe.length;ye+=3)mt.minX=Math.min(mt.minX,pe[ye]),mt.minY=Math.min(mt.minY,pe[ye+1]),mt.maxX=Math.max(mt.maxX,pe[ye]),mt.maxY=Math.max(mt.maxY,pe[ye+1])}function vt(mt,pe,ye,Ae){if(!pe.geometry)return;const je=pe.geometry.coordinates;if(je&&je.length===0)return;const Le=pe.geometry.type,qe=Math.pow(ye.tolerance/((1<<ye.maxZoom)*ye.extent),2);let lt=[],Xe=pe.id;if(ye.promoteId?Xe=pe.properties[ye.promoteId]:ye.generateId&&(Xe=Ae||0),Le==="Point")kt(je,lt);else if(Le==="MultiPoint")for(const ft of je)kt(ft,lt);else if(Le==="LineString")dr(je,lt,qe,!1);else if(Le==="MultiLineString"){if(ye.lineMetrics){for(const ft of je)lt=[],dr(ft,lt,qe,!1),mt.push(Ln(Xe,"LineString",lt,pe.properties));return}lr(je,lt,qe,!1)}else if(Le==="Polygon")lr(je,lt,qe,!0);else{if(Le!=="MultiPolygon"){if(Le==="GeometryCollection"){for(const ft of pe.geometry.geometries)vt(mt,{id:Xe,geometry:ft,properties:pe.properties},ye,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ft of je){const yt=[];lr(ft,yt,qe,!0),lt.push(yt)}}mt.push(Ln(Xe,Le,lt,pe.properties))}function kt(mt,pe){pe.push(sr(mt[0]),Kt(mt[1]),0)}function dr(mt,pe,ye,Ae){let je,Le,qe=0;for(let Xe=0;Xe<mt.length;Xe++){const ft=sr(mt[Xe][0]),yt=Kt(mt[Xe][1]);pe.push(ft,yt,0),Xe>0&&(qe+=Ae?(je*yt-ft*Le)/2:Math.sqrt(Math.pow(ft-je,2)+Math.pow(yt-Le,2))),je=ft,Le=yt}const lt=pe.length-3;pe[2]=1,hn(pe,0,lt,ye),pe[lt+2]=1,pe.size=Math.abs(qe),pe.start=0,pe.end=pe.size}function lr(mt,pe,ye,Ae){for(let je=0;je<mt.length;je++){const Le=[];dr(mt[je],Le,ye,Ae),pe.push(Le)}}function sr(mt){return mt/360+.5}function Kt(mt){const pe=Math.sin(mt*Math.PI/180),ye=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return ye<0?0:ye>1?1:ye}function Zr(mt,pe,ye,Ae,je,Le,qe,lt){if(Ae/=pe,Le>=(ye/=pe)&&qe<Ae)return mt;if(qe<ye||Le>=Ae)return null;const Xe=[];for(const ft of mt){const yt=ft.geometry;let pt=ft.type;const Nt=je===0?ft.minX:ft.minY,Xt=je===0?ft.maxX:ft.maxY;if(Nt>=ye&&Xt<Ae){Xe.push(ft);continue}if(Xt<ye||Nt>=Ae)continue;let er=[];if(pt==="Point"||pt==="MultiPoint")fi(yt,er,ye,Ae,je);else if(pt==="LineString")Qn(yt,er,ye,Ae,je,!1,lt.lineMetrics);else if(pt==="MultiLineString")qo(yt,er,ye,Ae,je,!1);else if(pt==="Polygon")qo(yt,er,ye,Ae,je,!0);else if(pt==="MultiPolygon")for(const Rr of yt){const Br=[];qo(Rr,Br,ye,Ae,je,!0),Br.length&&er.push(Br)}if(er.length){if(lt.lineMetrics&&pt==="LineString"){for(const Rr of er)Xe.push(Ln(ft.id,pt,Rr,ft.tags));continue}pt!=="LineString"&&pt!=="MultiLineString"||(er.length===1?(pt="LineString",er=er[0]):pt="MultiLineString"),pt!=="Point"&&pt!=="MultiPoint"||(pt=er.length===3?"Point":"MultiPoint"),Xe.push(Ln(ft.id,pt,er,ft.tags))}}return Xe.length?Xe:null}function fi(mt,pe,ye,Ae,je){for(let Le=0;Le<mt.length;Le+=3){const qe=mt[Le+je];qe>=ye&&qe<=Ae&&na(pe,mt[Le],mt[Le+1],mt[Le+2])}}function Qn(mt,pe,ye,Ae,je,Le,qe){let lt=Pi(mt);const Xe=je===0?yl:Ql;let ft,yt,pt=mt.start;for(let Br=0;Br<mt.length-3;Br+=3){const $r=mt[Br],Gr=mt[Br+1],Gn=mt[Br+2],_i=mt[Br+3],Jr=mt[Br+4],Tn=je===0?$r:Gr,En=je===0?_i:Jr;let Pn=!1;qe&&(ft=Math.sqrt(Math.pow($r-_i,2)+Math.pow(Gr-Jr,2))),Tn<ye?En>ye&&(yt=Xe(lt,$r,Gr,_i,Jr,ye),qe&&(lt.start=pt+ft*yt)):Tn>Ae?En<Ae&&(yt=Xe(lt,$r,Gr,_i,Jr,Ae),qe&&(lt.start=pt+ft*yt)):na(lt,$r,Gr,Gn),En<ye&&Tn>=ye&&(yt=Xe(lt,$r,Gr,_i,Jr,ye),Pn=!0),En>Ae&&Tn<=Ae&&(yt=Xe(lt,$r,Gr,_i,Jr,Ae),Pn=!0),!Le&&Pn&&(qe&&(lt.end=pt+ft*yt),pe.push(lt),lt=Pi(mt)),qe&&(pt+=ft)}let Nt=mt.length-3;const Xt=mt[Nt],er=mt[Nt+1],Rr=je===0?Xt:er;Rr>=ye&&Rr<=Ae&&na(lt,Xt,er,mt[Nt+2]),Nt=lt.length-3,Le&&Nt>=3&&(lt[Nt]!==lt[0]||lt[Nt+1]!==lt[1])&&na(lt,lt[0],lt[1],lt[2]),lt.length&&pe.push(lt)}function Pi(mt){const pe=[];return pe.size=mt.size,pe.start=mt.start,pe.end=mt.end,pe}function qo(mt,pe,ye,Ae,je,Le){for(const qe of mt)Qn(qe,pe,ye,Ae,je,Le,!1)}function na(mt,pe,ye,Ae){mt.push(pe,ye,Ae)}function yl(mt,pe,ye,Ae,je,Le){const qe=(Le-pe)/(Ae-pe);return na(mt,Le,ye+(je-ye)*qe,1),qe}function Ql(mt,pe,ye,Ae,je,Le){const qe=(Le-ye)/(je-ye);return na(mt,pe+(Ae-pe)*qe,Le,1),qe}function ls(mt,pe){const ye=[];for(let Ae=0;Ae<mt.length;Ae++){const je=mt[Ae],Le=je.type;let qe;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")qe=vl(je.geometry,pe);else if(Le==="MultiLineString"||Le==="Polygon"){qe=[];for(const lt of je.geometry)qe.push(vl(lt,pe))}else if(Le==="MultiPolygon"){qe=[];for(const lt of je.geometry){const Xe=[];for(const ft of lt)Xe.push(vl(ft,pe));qe.push(Xe)}}ye.push(Ln(je.id,Le,qe,je.tags))}return ye}function vl(mt,pe){const ye=[];ye.size=mt.size,mt.start!==void 0&&(ye.start=mt.start,ye.end=mt.end);for(let Ae=0;Ae<mt.length;Ae+=3)ye.push(mt[Ae]+pe,mt[Ae+1],mt[Ae+2]);return ye}function Co(mt,pe){if(mt.transformed)return mt;const ye=1<<mt.z,Ae=mt.x,je=mt.y;for(const Le of mt.features){const qe=Le.geometry,lt=Le.type;if(Le.geometry=[],lt===1)for(let Xe=0;Xe<qe.length;Xe+=2)Le.geometry.push(Ia(qe[Xe],qe[Xe+1],pe,ye,Ae,je));else for(let Xe=0;Xe<qe.length;Xe++){const ft=[];for(let yt=0;yt<qe[Xe].length;yt+=2)ft.push(Ia(qe[Xe][yt],qe[Xe][yt+1],pe,ye,Ae,je));Le.geometry.push(ft)}}return mt.transformed=!0,mt}function Ia(mt,pe,ye,Ae,je,Le){return[Math.round(ye*(mt*Ae-je)),Math.round(ye*(pe*Ae-Le))]}function pi(mt,pe,ye,Ae,je){const Le=pe===je.maxZoom?0:je.tolerance/((1<<pe)*je.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:mt.length,source:null,x:ye,y:Ae,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const lt of mt)wr(qe,lt,Le,je);return qe}function wr(mt,pe,ye,Ae){const je=pe.geometry,Le=pe.type,qe=[];if(mt.minX=Math.min(mt.minX,pe.minX),mt.minY=Math.min(mt.minY,pe.minY),mt.maxX=Math.max(mt.maxX,pe.maxX),mt.maxY=Math.max(mt.maxY,pe.maxY),Le==="Point"||Le==="MultiPoint")for(let lt=0;lt<je.length;lt+=3)qe.push(je[lt],je[lt+1]),mt.numPoints++,mt.numSimplified++;else if(Le==="LineString")mi(qe,je,mt,ye,!1,!1);else if(Le==="MultiLineString"||Le==="Polygon")for(let lt=0;lt<je.length;lt++)mi(qe,je[lt],mt,ye,Le==="Polygon",lt===0);else if(Le==="MultiPolygon")for(let lt=0;lt<je.length;lt++){const Xe=je[lt];for(let ft=0;ft<Xe.length;ft++)mi(qe,Xe[ft],mt,ye,!0,ft===0)}if(qe.length){let lt=pe.tags||null;if(Le==="LineString"&&Ae.lineMetrics){lt={};for(const ft in pe.tags)lt[ft]=pe.tags[ft];lt.mapbox_clip_start=je.start/je.size,lt.mapbox_clip_end=je.end/je.size}const Xe={geometry:qe,type:Le==="Polygon"||Le==="MultiPolygon"?3:Le==="LineString"||Le==="MultiLineString"?2:1,tags:lt};pe.id!==null&&(Xe.id=pe.id),mt.features.push(Xe)}}function mi(mt,pe,ye,Ae,je,Le){const qe=Ae*Ae;if(Ae>0&&pe.size<(je?qe:Ae))return void(ye.numPoints+=pe.length/3);const lt=[];for(let Xe=0;Xe<pe.length;Xe+=3)(Ae===0||pe[Xe+2]>qe)&&(ye.numSimplified++,lt.push(pe[Xe],pe[Xe+1])),ye.numPoints++;je&&function(Xe,ft){let yt=0;for(let pt=0,Nt=Xe.length,Xt=Nt-2;pt<Nt;Xt=pt,pt+=2)yt+=(Xe[pt]-Xe[Xt])*(Xe[pt+1]+Xe[Xt+1]);if(yt>0===ft)for(let pt=0,Nt=Xe.length;pt<Nt/2;pt+=2){const Xt=Xe[pt],er=Xe[pt+1];Xe[pt]=Xe[Nt-2-pt],Xe[pt+1]=Xe[Nt-1-pt],Xe[Nt-2-pt]=Xt,Xe[Nt-1-pt]=er}}(lt,Le),mt.push(lt)}const ei={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Li{constructor(pe,ye){const Ae=(ye=this.options=function(Le,qe){for(const lt in qe)Le[lt]=qe[lt];return Le}(Object.create(ei),ye)).debug;if(Ae&&console.time("preprocess data"),ye.maxZoom<0||ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ye.promoteId&&ye.generateId)throw new Error("promoteId and generateId cannot be used together.");let je=function(Le,qe){const lt=[];if(Le.type==="FeatureCollection")for(let Xe=0;Xe<Le.features.length;Xe++)vt(lt,Le.features[Xe],qe,Xe);else vt(lt,Le.type==="Feature"?Le:{geometry:Le},qe);return lt}(pe,ye);this.tiles={},this.tileCoords=[],Ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ye.indexMaxZoom,ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),je=function(Le,qe){const lt=qe.buffer/qe.extent;let Xe=Le;const ft=Zr(Le,1,-1-lt,lt,0,-1,2,qe),yt=Zr(Le,1,1-lt,2+lt,0,-1,2,qe);return(ft||yt)&&(Xe=Zr(Le,1,-lt,1+lt,0,-1,2,qe)||[],ft&&(Xe=ls(ft,1).concat(Xe)),yt&&(Xe=Xe.concat(ls(yt,-1)))),Xe}(je,ye),je.length&&this.splitTile(je,0,0,0),Ae&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(pe,ye,Ae,je,Le,qe,lt){const Xe=[pe,ye,Ae,je],ft=this.options,yt=ft.debug;for(;Xe.length;){je=Xe.pop(),Ae=Xe.pop(),ye=Xe.pop(),pe=Xe.pop();const pt=1<<ye,Nt=Ho(ye,Ae,je);let Xt=this.tiles[Nt];if(!Xt&&(yt>1&&console.time("creation"),Xt=this.tiles[Nt]=pi(pe,ye,Ae,je,ft),this.tileCoords.push({z:ye,x:Ae,y:je}),yt)){yt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ye,Ae,je,Xt.numFeatures,Xt.numPoints,Xt.numSimplified),console.timeEnd("creation"));const Pn=`z${ye}`;this.stats[Pn]=(this.stats[Pn]||0)+1,this.total++}if(Xt.source=pe,Le==null){if(ye===ft.indexMaxZoom||Xt.numPoints<=ft.indexMaxPoints)continue}else{if(ye===ft.maxZoom||ye===Le)continue;if(Le!=null){const Pn=Le-ye;if(Ae!==qe>>Pn||je!==lt>>Pn)continue}}if(Xt.source=null,pe.length===0)continue;yt>1&&console.time("clipping");const er=.5*ft.buffer/ft.extent,Rr=.5-er,Br=.5+er,$r=1+er;let Gr=null,Gn=null,_i=null,Jr=null,Tn=Zr(pe,pt,Ae-er,Ae+Br,0,Xt.minX,Xt.maxX,ft),En=Zr(pe,pt,Ae+Rr,Ae+$r,0,Xt.minX,Xt.maxX,ft);pe=null,Tn&&(Gr=Zr(Tn,pt,je-er,je+Br,1,Xt.minY,Xt.maxY,ft),Gn=Zr(Tn,pt,je+Rr,je+$r,1,Xt.minY,Xt.maxY,ft),Tn=null),En&&(_i=Zr(En,pt,je-er,je+Br,1,Xt.minY,Xt.maxY,ft),Jr=Zr(En,pt,je+Rr,je+$r,1,Xt.minY,Xt.maxY,ft),En=null),yt>1&&console.timeEnd("clipping"),Xe.push(Gr||[],ye+1,2*Ae,2*je),Xe.push(Gn||[],ye+1,2*Ae,2*je+1),Xe.push(_i||[],ye+1,2*Ae+1,2*je),Xe.push(Jr||[],ye+1,2*Ae+1,2*je+1)}}getTile(pe,ye,Ae){pe=+pe,ye=+ye,Ae=+Ae;const je=this.options,{extent:Le,debug:qe}=je;if(pe<0||pe>24)return null;const lt=1<<pe,Xe=Ho(pe,ye=ye+lt&lt-1,Ae);if(this.tiles[Xe])return Co(this.tiles[Xe],Le);qe>1&&console.log("drilling down to z%d-%d-%d",pe,ye,Ae);let ft,yt=pe,pt=ye,Nt=Ae;for(;!ft&&yt>0;)yt--,pt>>=1,Nt>>=1,ft=this.tiles[Ho(yt,pt,Nt)];return ft&&ft.source?(qe>1&&(console.log("found parent tile z%d-%d-%d",yt,pt,Nt),console.time("drilling down")),this.splitTile(ft.source,yt,pt,Nt,pe,ye,Ae),qe>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Co(this.tiles[Xe],Le):null):null}}function Ho(mt,pe,ye){return 32*((1<<mt)*ye+pe)+mt}function ec(mt,pe){const ye=mt.tileID.canonical;if(!this._geoJSONIndex)return void pe(null,null);const Ae=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);if(!Ae)return void pe(null,null);const je=new he(Ae.features);let Le=$t(je);Le.byteOffset===0&&Le.byteLength===Le.buffer.byteLength||(Le=new Uint8Array(Le)),pe(null,{vectorTile:je,rawData:Le.buffer})}class Fu extends H{constructor(pe,ye,Ae,je,Le,qe){super(pe,ye,Ae,je,ec,qe),Le&&(this.loadGeoJSON=Le),this._dynamicIndex=new We}loadData(pe,ye){const Ae=pe&&pe.request,je=Ae&&Ae.collectResourceTiming;this.loadGeoJSON(pe,(Le,qe)=>{if(Le||!qe)return ye(Le);if(typeof qe!="object")return ye(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));{try{if(pe.filter){const Xe=i.X(pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Xe.result==="error")throw new Error(Xe.value.map(ft=>`${ft.key}: ${ft.message}`).join(", "));qe.features=qe.features.filter(ft=>Xe.value.evaluate({zoom:0},ft))}pe.dynamic?(qe.type==="Feature"&&(qe={type:"FeatureCollection",features:[qe]}),pe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(qe.features,this.loaded),pe.cluster&&(qe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=pe.cluster?new Gt(function({superclusterOptions:Xe,clusterProperties:ft}){if(!ft||!Xe)return Xe;const yt={},pt={},Nt={accumulated:null,zoom:0},Xt={properties:null},er=Object.keys(ft);for(const Rr of er){const[Br,$r]=ft[Rr],Gr=i.X($r),Gn=i.X(typeof Br=="string"?[Br,["accumulated"],["get",Rr]]:Br);yt[Rr]=Gr.value,pt[Rr]=Gn.value}return Xe.map=Rr=>{Xt.properties=Rr;const Br={};for(const $r of er)Br[$r]=yt[$r].evaluate(Nt,Xt);return Br},Xe.reduce=(Rr,Br)=>{Xt.properties=Br;for(const $r of er)Nt.accumulated=Rr[$r],Rr[$r]=pt[$r].evaluate(Nt,Xt)},Xe}(pe)).load(qe.features):pe.dynamic?this._dynamicIndex:function(Xe,ft){return new Li(Xe,ft)}(qe,pe.geojsonVtOptions)}catch(Xe){return ye(Xe)}const lt={};if(je){const Xe=_(Ae);Xe&&(lt.resourceTiming={},lt.resourceTiming[pe.source]=JSON.parse(JSON.stringify(Xe)))}ye(null,lt)}})}reloadTile(pe,ye){const Ae=this.loaded;return Ae&&Ae[pe.uid]?pe.partial?ye(null,void 0):super.reloadTile(pe,ye):this.loadTile(pe,ye)}loadGeoJSON(pe,ye){if(pe.request)i.n(pe.request,ye);else{if(typeof pe.data!="string")return ye(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));try{return ye(null,JSON.parse(pe.data))}catch{return ye(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(pe,ye){try{ye(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(Ae){ye(Ae)}}getClusterChildren(pe,ye){try{ye(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(Ae){ye(Ae)}}getClusterLeaves(pe,ye){try{ye(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(Ae){ye(Ae)}}}class Wy{constructor(pe,ye){this.tileID=new i.aH(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.tileZoom=pe.tileZoom,this.uid=pe.uid,this.zoom=pe.zoom,this.canonical=pe.tileID.canonical,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=pe.projection,this.brightness=ye}parse(pe,ye,Ae,je){this.status="parsing";const Le=new i.aH(Ae.tileID.overscaledZ,Ae.tileID.wrap,Ae.tileID.canonical.z,Ae.tileID.canonical.x,Ae.tileID.canonical.y),qe=[],lt=ye.familiesBySource[Ae.source],Xe=new i.e0(Le,Ae.promoteId);return Xe.bucketLayerIDs=[],Xe.is3DTile=!0,i.ei(pe).then(ft=>{if(!ft)return je(new Error("Could not parse tile"));const yt=i.ej(ft,1/i.cd(Ae.tileID.canonical)),pt=ft.json.extensionsUsed&&ft.json.extensionsUsed.includes("MAPBOX_mesh_features")||ft.json.asset.extras&&ft.json.asset.extras.MAPBOX_mesh_features,Nt=ft.json.extensionsUsed&&ft.json.extensionsUsed.includes("EXT_meshopt_compression"),Xt=new i.aa(this.zoom,{brightness:this.brightness});for(const er in lt)for(const Rr of lt[er]){const Br=Rr[0];Xe.bucketLayerIDs.push(Rr.map(Gr=>i.C(Gr.id,Gr.scope))),Br.recalculate(Xt,[]);const $r=new i.ek(Rr,yt,Le,pt,Nt,this.brightness,Xe);pt||($r.needsUpload=!0),qe.push($r),$r.evaluate(Br)}this.status="done",je(null,{buckets:qe,featureIndex:Xe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(ft=>je(new Error(ft.message)))}}class Gy{constructor(pe,ye,Ae,je,Le,qe){this.actor=pe,this.layerIndex=ye,this.availableImages=Ae,this.brightness=qe,this.loading={},this.loaded={}}loadTile(pe,ye){const Ae=pe.uid,je=this.loading[Ae]=new Wy(pe,this.brightness);i.bj(pe.request,(Le,qe)=>{const lt=!this.loading[Ae];return delete this.loading[Ae],lt||Le?(je.status="done",lt||(this.loaded[Ae]=je),ye(Le)):qe&&qe.byteLength!==0?void je.parse(qe,this.layerIndex,pe,(Xe,ft)=>{je.status="done",this.loaded=this.loaded||{},this.loaded[Ae]=je,Xe||!ft?ye(Xe):ye(null,ft)}):(je.status="done",this.loaded[Ae]=je,ye())})}reloadTile(pe,ye){const Ae=this.loaded,je=pe.uid;if(Ae&&Ae[je]){const Le=Ae[je];Le.projection=pe.projection,Le.brightness=pe.brightness;const qe=(lt,Xe)=>{Le.reloadCallback&&(delete Le.reloadCallback,this.loadTile(pe,ye)),ye(lt,Xe)};Le.status==="parsing"?Le.reloadCallback=qe:Le.status==="done"&&this.loadTile(pe,ye)}}abortTile(pe,ye){const Ae=pe.uid;this.loading[Ae]&&delete this.loading[Ae],ye()}removeTile(pe,ye){const Ae=this.loaded,je=pe.uid;Ae&&Ae[je]&&delete Ae[je],ye()}}class Cm{constructor(pe){this.self=pe,this.actor=new i.el(pe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.y,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:H,geojson:Fu,"raster-dem":q,"raster-array":J,"batched-model":Gy},this.workerSources={},this.self.registerWorkerSource=(ye,Ae)=>{if(this.workerSourceTypes[ye])throw new Error(`Worker source with name "${ye}" already registered.`);this.workerSourceTypes[ye]=Ae},this.self.registerRTLTextPlugin=ye=>{if(i.em.isParsed())throw new Error("RTL text plugin already registered.");i.em.applyArabicShaping=ye.applyArabicShaping,i.em.processBidirectionalText=ye.processBidirectionalText,i.em.processStyledBidirectionalText=ye.processStyledBidirectionalText}}clearCaches(pe,ye,Ae){delete this.layerIndexes[pe],delete this.availableImages[pe],delete this.workerSources[pe],Ae()}checkIfReady(pe,ye,Ae){Ae()}setReferrer(pe,ye){this.referrer=ye}spriteLoaded(pe,{scope:ye,isLoaded:Ae}){if(this.isSpriteLoaded[pe]||(this.isSpriteLoaded[pe]={}),this.isSpriteLoaded[pe][ye]=Ae,this.workerSources[pe]&&this.workerSources[pe][ye])for(const je in this.workerSources[pe][ye]){const Le=this.workerSources[pe][ye][je];for(const qe in Le){const lt=Le[qe];lt instanceof H&&(lt.isSpriteLoaded=Ae,lt.fire(new i.A("isSpriteLoaded")))}}}setImages(pe,{scope:ye,images:Ae},je){if(this.availableImages[pe]||(this.availableImages[pe]={}),this.availableImages[pe][ye]=Ae,this.workerSources[pe]&&this.workerSources[pe][ye]){for(const Le in this.workerSources[pe][ye]){const qe=this.workerSources[pe][ye][Le];for(const lt in qe)qe[lt].availableImages=Ae}je()}else je()}setProjection(pe,ye){this.projections[pe]=i.bP(ye)}setBrightness(pe,ye,Ae){this.brightness=ye,Ae()}setLayers(pe,ye,Ae){this.getLayerIndex(pe,ye.scope).replace(ye.layers,ye.options),Ae()}updateLayers(pe,ye,Ae){this.getLayerIndex(pe,ye.scope).update(ye.layers,ye.removedIds,ye.options),Ae()}loadTile(pe,ye,Ae){ye.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,ye.type,ye.source,ye.scope).loadTile(ye,Ae)}decodeRasterArray(pe,ye,Ae){this.getWorkerSource(pe,ye.type,ye.source,ye.scope).decodeRasterArray(ye,Ae)}reloadTile(pe,ye,Ae){ye.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,ye.type,ye.source,ye.scope).reloadTile(ye,Ae)}abortTile(pe,ye,Ae){this.getWorkerSource(pe,ye.type,ye.source,ye.scope).abortTile(ye,Ae)}removeTile(pe,ye,Ae){this.getWorkerSource(pe,ye.type,ye.source,ye.scope).removeTile(ye,Ae)}removeSource(pe,ye,Ae){if(!(this.workerSources[pe]&&this.workerSources[pe][ye.scope]&&this.workerSources[pe][ye.scope][ye.type]&&this.workerSources[pe][ye.scope][ye.type][ye.source]))return;const je=this.workerSources[pe][ye.scope][ye.type][ye.source];delete this.workerSources[pe][ye.scope][ye.type][ye.source],je.removeSource!==void 0?je.removeSource(ye,Ae):Ae()}loadWorkerSource(pe,ye,Ae){try{this.self.importScripts(ye.url),Ae()}catch(je){Ae(je.toString())}}syncRTLPluginState(pe,ye,Ae){try{i.em.setState(ye);const je=i.em.getPluginURL();if(i.em.isLoaded()&&!i.em.isParsed()&&je!=null){this.self.importScripts(je);const Le=i.em.isParsed();Ae(Le?void 0:new Error(`RTL Text Plugin failed to import scripts from ${je}`),Le)}}catch(je){Ae(je.toString())}}setDracoUrl(pe,ye){this.dracoUrl=ye}getAvailableImages(pe,ye){this.availableImages[pe]||(this.availableImages[pe]={});let Ae=this.availableImages[pe][ye];return Ae||(Ae=[]),Ae}getLayerIndex(pe,ye){this.layerIndexes[pe]||(this.layerIndexes[pe]={});let Ae=this.layerIndexes[pe][ye];return Ae||(Ae=this.layerIndexes[pe][ye]=new C,Ae.scope=ye),Ae}getWorkerSource(pe,ye,Ae,je){const Le=this.workerSources;return Le[pe]||(Le[pe]={}),Le[pe][je]||(Le[pe][je]={}),Le[pe][je][ye]||(Le[pe][je][ye]={}),this.isSpriteLoaded[pe]||(this.isSpriteLoaded[pe]={}),Le[pe][je][ye][Ae]||(Le[pe][je][ye][Ae]=new this.workerSourceTypes[ye]({send:(qe,lt,Xe,ft,yt,pt)=>{this.actor.send(qe,lt,Xe,pe,yt,pt)},scheduler:this.actor.scheduler},this.getLayerIndex(pe,je),this.getAvailableImages(pe,je),this.isSpriteLoaded[pe][je],void 0,this.brightness)),Le[pe][je][ye][Ae]}rasterizeImages(pe,ye,Ae){const je=new Map;for(const[Le,{image:qe,imageVariant:lt}]of ye.tasks.entries()){const Xe=this.imageRasterizer.rasterize(lt,qe,ye.scope,pe);je.set(Le,Xe)}Ae(void 0,je)}removeRasterizedImages(pe,ye,Ae){this.imageRasterizer.removeImagesFromCacheByIds(ye.imageIds,ye.scope,pe),Ae()}enforceCacheSizeLimit(pe,ye){i.en(ye)}getWorkerPerformanceMetrics(pe,ye,Ae){Ae(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Cm(self)),Cm}),l(["./shared"],function(i){var _="3.11.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},E={mark(y){performance.mark(y)},measure(y,s,u){performance.measure(y,s,u)}};function C(y){const s=y.name.split("?")[0];return i.a(s)&&s.includes("mapbox-gl.js")?"javascript":i.a(s)&&s.includes("mapbox-gl.css")?"css":i.b(s)?"fontRange":i.c(s)?"sprite":i.i(s)?"style":i.d(s)?"tilejson":"other"}var R,F={},U=function(){if(R)return F;function y(g){return!s(g)}function s(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,A,L=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(L);try{A=new Worker(z),S=!0}catch{S=!1}return A&&A.terminate(),URL.revokeObjectURL(z),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var A=S.getContext("2d");if(!A)return!1;var L=A.getImageData(0,0,1,1);return L&&L.width===S.width}()?(u[x=g&&g.failIfMajorPerformanceCaveat]===void 0&&(u[x]=function(S){var A,L=function(z){var B=document.createElement("canvas"),V=Object.create(y.webGLContextAttributes);return V.failIfMajorPerformanceCaveat=z,B.getContext("webgl2",V)}(S);if(!L)return!1;try{A=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!A||L.isContextLost())&&(L.shaderSource(A,"void main() {}"),L.compileShader(A),L.getShaderParameter(A,L.COMPILE_STATUS)===!0)}(x)),u[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}R=1,F.supported=y,F.notSupportedReason=s;var u={};return y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},F}();function $(y,s,u){const g=document.createElement(y);return s!=null&&(g.className=s),u&&u.appendChild(g),g}function H(y,s,u){const g=document.createElementNS("http://www.w3.org/2000/svg",y);for(const x of Object.keys(s))g.setAttributeNS(null,x,String(s[x]));return u&&u.appendChild(g),g}const q=typeof document<"u"?document.documentElement&&document.documentElement.style:null,G=q&&q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let J;function te(){q&&G&&(J=q[G],q[G]="none")}function oe(){q&&G&&(q[G]=J)}function he(y){y.preventDefault(),y.stopPropagation(),window.removeEventListener("click",he,!0)}function le(){window.addEventListener("click",he,!0),window.setTimeout(()=>{window.removeEventListener("click",he,!0)},0)}function ve(y,s){const u=y.getBoundingClientRect();return Re(y,u,s)}function We(y,s){const u=y.getBoundingClientRect(),g=[];for(let x=0;x<s.length;x++)g.push(Re(y,u,s[x]));return g}function Ie(y){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&y.button===2&&y.ctrlKey?0:y.button}function Re(y,s,u){const g=y.offsetWidth===s.width?1:y.offsetWidth/s.width;return new i.P((u.clientX-s.left)*g,(u.clientY-s.top)*g)}const $e="01",ot="NO_ACCESS_TOKEN";class Je{constructor(s,u,g){this._transformRequestFn=s,this._customAccessToken=u,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const s=function(){let u="";for(let g=0;g<10;g++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$e,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,u){return this._transformRequestFn&&this._transformRequestFn(s,u)||{url:s}}normalizeStyleURL(s,u){if(!i.f(s))return s;const g=st(s);return g.params.push(`sdk=js-${_}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeGlyphsURL(s,u){if(!i.f(s))return s;const g=st(s);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeModelURL(s,u){if(!i.f(s))return s;const g=st(s);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeSourceURL(s,u,g,x){if(!i.f(s))return s;const S=st(s);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),g&&S.params.push(`language=${g}`),x&&S.params.push(`worldview=${x}`),this._makeAPIURL(S,this._customAccessToken||u)}normalizeIconsetURL(s,u){const g=st(s);return i.f(s)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||u)):at(g)}normalizeSpriteURL(s,u,g,x){const S=st(s);return i.f(s)?(S.path=`/styles/v1${S.path}/sprite${u}${g}`,this._makeAPIURL(S,this._customAccessToken||x)):(S.path+=`${u}${g}`,at(S))}normalizeTileURL(s,u,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!i.f(s))return s;const x=st(s);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||g&&x.authority!=="raster"&&g===512?"@2x":""}${i.m.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const S=this._customAccessToken||function(A){for(const L of A){const z=L.match(/^access_token=(.*)$/);if(z)return z[1]}return null}(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,S)}canonicalizeTileURL(s,u){const g=st(s);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return s;let x="mapbox://";g.path.match(/^\/raster\/v1\//)?x+=`raster/${g.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${g.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${g.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let S=g.params;return u&&(S=S.filter(A=>!A.match(/^access_token=/))),S.length&&(x+=`?${S.join("&")}`),x}canonicalizeTileset(s,u){const g=!!u&&i.f(u),x=[];for(const S of s.tiles||[])i.h(S)?x.push(this.canonicalizeTileURL(S,g)):x.push(S);return x}_makeAPIURL(s,u){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=st(i.e.API_URL);if(s.protocol=x.protocol,s.authority=x.authority,s.protocol==="http"){const S=s.params.indexOf("secure");S>=0&&s.params.splice(S,1)}if(x.path!=="/"&&(s.path=`${x.path}${s.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return at(s);if(u=u||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return s.params=s.params.filter(S=>S.indexOf("access_token")===-1),s.params.push(`access_token=${u||""}`),at(s)}}const rt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function st(y){const s=y.match(rt);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function at(y){const s=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${s}`}const Be="mapbox.eventData";function ct(y){if(!y)return null;const s=y.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(i.j(s[1]))}catch{return null}}class jt{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const u=ct(i.e.ACCESS_TOKEN);let g="";return g=u&&u.u?i.k(u.u):i.e.ACCESS_TOKEN||"",s?`${Be}.${s}:${g}`:`${Be}:${g}`}fetchEventData(){const s=i.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid");if(s)try{const x=localStorage.getItem(u);x&&(this.eventData=JSON.parse(x));const S=localStorage.getItem(g);S&&(this.anonId=S)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const s=i.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),x=this.anonId;if(s&&x)try{localStorage.setItem(g,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,u,g,x){if(!i.e.EVENTS_URL)return;const S=st(i.e.EVENTS_URL);S.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const A={event:this.type,created:new Date(s).toISOString()},L=u?i.l(A,u):A,z={url:at(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=i.p(z,B=>{this.pendingRequest=null,g(B),this.saveEventData(),this.processRequests(x)})}queueRequest(s,u){this.queue.push(s),this.processRequests(u)}}const Lt=new class extends jt{constructor(y){super("appUserTurnstile"),this._customAccessToken=y}postTurnstileEvent(y,s){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(y)&&y.some(u=>i.f(u)||i.h(u))&&this.queueRequest(Date.now(),s)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=ct(i.e.ACCESS_TOKEN),u=s?s.u:i.e.ACCESS_TOKEN;let g=u!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),g=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),A=new Date(x),L=(x-this.eventData.lastSuccess)/864e5;g=g||L>=1||L<-1||S.getDate()!==A.getDate()}else g=!0;g?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:$e,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=x,this.eventData.tokenU=u)},y):this.processRequests()}},$t=Lt.postTurnstileEvent.bind(Lt),ut=new class extends jt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(y,s,u,g){this.skuToken=s,this.errorCb=g,i.e.EVENTS_URL&&(u||i.e.ACCESS_TOKEN?this.queueRequest({id:y,timestamp:Date.now()},u):this.errorCb(new Error(ot)))}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:$e,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},y))}remove(){this.errorCb=null}},tr=ut.postMapLoadEvent.bind(ut),mr=new class extends jt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(y){let s=this.mapInstanceIdMap.get(y);return s||(s=i.u(),this.mapInstanceIdMap.set(y,s)),s}getEventId(y){const s=this.eventIdPerMapInstanceMap.get(y)||0;return this.eventIdPerMapInstanceMap.set(y,s+1),s}postStyleLoadEvent(y,s){const{map:u,style:g,importedStyles:x}=s;if(!i.e.EVENTS_URL||!y&&!i.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(u),A={mapInstanceId:S,eventId:this.getEventId(S),style:g};x.length&&(A.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:A},y)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:u}=this.queue.shift();this.postEvent(s,u,()=>{},y)}},rr=mr.postStyleLoadEvent.bind(mr),Ut=new class extends jt{constructor(){super("gljs.performance")}postPerformanceEvent(y,s){i.e.EVENTS_URL&&(y||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},y)}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:u}=this.queue.shift(),g=function(x){const S=performance.getEntriesByType("resource"),A=performance.getEntriesByType("mark"),L=function(re){const ce={};if(re){for(const ae in re)if(ae!=="other")for(const fe of re[ae]){const me=`${ae}ResolveRangeMin`,be=`${ae}ResolveRangeMax`,Ee=`${ae}RequestCount`,Te=`${ae}RequestCachedCount`;ce[me]=Math.min(ce[me]||1/0,fe.startTime),ce[be]=Math.max(ce[be]||-1/0,fe.responseEnd);const Oe=Me=>{ce[Me]===void 0&&(ce[Me]=0),++ce[Me]};fe.transferSize!==void 0&&fe.transferSize===0&&Oe(Te),Oe(Ee)}}return ce}(function(re,ce){const ae={};if(re)for(const fe of re){const me=ce(fe);ae[me]===void 0&&(ae[me]=[]),ae[me].push(fe)}return ae}(S,C)),z=window.devicePixelRatio,B=navigator.connection||navigator.mozConnection||navigator.webkitConnection,V=B?B.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},Y=(re,ce,ae)=>{ae!=null&&re.push({name:ce,value:ae.toString()})};for(const re in L)Y(X.counters,re,L[re]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(Y(X.counters,"interactionRangeMin",x.interactionRange[0]),Y(X.counters,"interactionRangeMax",x.interactionRange[1])),A)for(const re of Object.keys(b)){const ce=b[re],ae=A.find(fe=>fe.name===ce);ae&&Y(X.counters,ce,ae.startTime)}return Y(X.counters,"visibilityHidden",x.visibilityHidden),Y(X.attributes,"style",function(re){if(re)for(const ce of re){const ae=ce.name.split("?")[0];if(i.i(ae)){const fe=ae.split("/").slice(-2);if(fe.length===2)return`mapbox://styles/${fe[0]}/${fe[1]}`}}}(S)),Y(X.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),Y(X.attributes,"fogEnabled",x.fogEnabled?"true":"false"),Y(X.attributes,"projection",x.projection),Y(X.attributes,"zoom",x.zoom),Y(X.metadata,"devicePixelRatio",z),Y(X.metadata,"connectionEffectiveType",V),Y(X.metadata,"navigatorUserAgent",navigator.userAgent),Y(X.metadata,"screenWidth",window.screen.width),Y(X.metadata,"screenHeight",window.screen.height),Y(X.metadata,"windowWidth",window.innerWidth),Y(X.metadata,"windowHeight",window.innerHeight),Y(X.metadata,"mapWidth",x.width/z),Y(X.metadata,"mapHeight",x.height/z),Y(X.metadata,"webglRenderer",x.renderer),Y(X.metadata,"webglVendor",x.vendor),Y(X.metadata,"sdkVersion",_),Y(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(u);for(const x of g.metadata);for(const x of g.counters);for(const x of g.attributes);this.postEvent(s,g,()=>{},y)}},gr=Ut.postPerformanceEvent.bind(Ut),Gt=new class extends jt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(y,s,u,g){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=st(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${s||""}`),x.params.push(`access_token=${g||i.e.ACCESS_TOKEN||""}`);const S={url:at(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(S,A=>{this.pendingRequest=null,u(A),this.saveEventData(),this.processRequests(g)})}getSessionAPI(y,s,u,g){this.skuToken=s,this.errorCb=g,i.e.SESSION_PATH&&i.e.API_URL&&(u||i.e.ACCESS_TOKEN?this.queueRequest({id:y,timestamp:Date.now()},u):this.errorCb(new Error(ot)))}processRequests(y){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||this.getSession(u,this.skuToken,g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},y)}remove(){this.errorCb=null}},ge=Gt.getSessionAPI.bind(Gt),cr=new Set;function Ot(y,s){s?cr.add(y):cr.delete(y)}class Pr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,u){this._updatedSourceCaches[s]=u,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const u=s.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(s.id),this.setDirty()}removeLayer(s){const u=s.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][s.id]=s,this._updatedLayers[u].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const u in this._updatedLayers)s[u]=s[u]||{},s[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)s[u]=s[u]||{},s[u].removedIds=Object.keys(this._removedLayers[u]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(s){this._updatedImages.add(i.I.toString(s)),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function _t(y){const{userImage:s}=y;return!!(s&&s.render&&s.render())&&(y.data.replace(new Uint8Array(s.data.buffer)),!0)}class hn extends i.E{constructor(s){super(),this._images={},this._iconsets={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.patternsInFlight=new Set,this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=s,s!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.y),this._imageRasterizer}createScope(s){this._images[s]={},this._iconsets[s]={},this.loaded[s]=!1,this.updatedImages[s]=new Set,this.patterns[s]={},this.callbackDispatchedThisFrame[s]=new Set,this.atlasImage[s]=new i.r({width:1,height:1})}createIconset(s,u){this._iconsets[s][u]={}}isLoaded(){for(const s in this.loaded)if(!this.loaded[s])return!1;return!0}setLoaded(s,u){if(this.loaded[u]!==s&&(this.loaded[u]=s,s)){for(const{ids:g,callback:x}of this.requestors)this._notify(g,u,x);this.requestors=[]}}hasImage(s,u){return!!this.getImage(s,u)}getImage(s,u){return(s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u])[s.name]}addImage(s,u,g){const x=s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u];this._validate(s,g)&&(x[s.name]=g)}_validate(s,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new i.z(new Error(`Image "${s.name}" has invalid "content" value`))),g=!1),g}_validateStretch(s,u){if(!s)return!0;let g=0;for(const x of s){if(x[0]<g||x[1]<x[0]||u<x[1])return!1;g=x[1]}return!0}_validateContent(s,u){return s?s.length!==4||!u.usvg&&(s[0]<0||u.data.width<s[0]||s[1]<0||u.data.height<s[1]||s[2]<0||u.data.width<s[2]||s[3]<0||u.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,u,g){const x=s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u];g.version=x[s.name].version+1,x[s.name]=g,this.updatedImages[u].add(s),this.removeFromImageRasterizerCache(s,u)}clearUpdatedImages(s){this.updatedImages[s].clear()}removeFromImageRasterizerCache(s,u){if(this.spriteFormat!=="raster")if(i.t()){const g={imageIds:[s],scope:u};this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",g)}else this.imageRasterizer.removeImagesFromCacheByIds([s],u)}removeImage(s,u){const g=s.iconsetId?this._iconsets[u][s.iconsetId]:this._images[u],x=g[s.name];delete g[s.name],delete this.patterns[u][s.name],this.removeFromImageRasterizerCache(s,u),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(s){const u=[];for(const g of Object.keys(this._images[s]))u.push(new i.I(g));for(const g in this._iconsets[s])for(const x of Object.keys(this._iconsets[s][g]))u.push(new i.I({name:x,iconsetId:g}));return u}getImages(s,u,g){let x=!0;const S=!!this.loaded[u];if(!S)for(const A of s)(A.iconsetId?this._iconsets[u][A.iconsetId]:this._images[u])[A.name]||(x=!1);S||x?this._notify(s,u,g):this.requestors.push({ids:s,scope:u,callback:g})}rasterizeImages({scope:s,tasks:u},g){const x=new Map;for(const[S,A]of u.entries()){const L=this.getImage(A.id,s);L&&x.set(S,{image:L,imageVariant:A})}this._rasterizeImages(s,x,g)}_rasterizeImages(s,u,g){if(i.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{tasks:u,scope:s},g);else{const x=new Map;for(const[S,{image:A,imageVariant:L}]of u.entries())x.set(S,this.imageRasterizer.rasterize(L,A,s,0));g(void 0,x)}}getUpdatedImages(s){return this.updatedImages[s]||new Set}_notify(s,u,g){const x=new Map;for(const S of s){S.iconsetId&&(this._iconsets[u][S.iconsetId]=this._iconsets[u][S.iconsetId]||{});const A=(S.iconsetId?this._iconsets[u][S.iconsetId]:this._images[u])[S.name];if(!A){if(S.iconsetId)continue;i.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`),this.fire(new i.A("styleimagemissing",{id:S.name}));continue}const L={data:A.usvg?null:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,usvg:A.usvg,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)};A.usvg&&Object.assign(L,{width:A.icon.usvg_tree.width,height:A.icon.usvg_tree.height}),x.set(i.I.toString(S),L)}g(null,x)}getPixelSize(s){const{width:u,height:g}=this.atlasImage[s];return{width:u,height:g}}getPattern(s,u,g){const x=this.patterns[u][s.name],S=this.getImage(s,u);if(!S)return null;if(x){if(x.position.version===S.version)return x.position;x.position.version=S.version}else{if(S.usvg&&!S.data){const A=this.getPatternInFlightId(s.toString(),u);if(this.patternsInFlight.has(A))return null;this.patternsInFlight.add(A);const L=new i.B(s).scaleSelf(i.q.devicePixelRatio),z=new Map([[L.toString(),{image:S,imageVariant:L}]]);return this._rasterizeImages(u,z,(B,V)=>this.storePatternImage(L,u,S,g,V)),null}this.storePattern(s,u,S)}return this._updatePatternAtlas(u,g),this.patterns[u][s.name].position}getPatternInFlightId(s,u){return i.C(s,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,u,g,x,S){const A=s.toString(),L=S?S.get(A):void 0;L&&(g.data=L,this.storePattern(s.id,u,g),this._updatePatternAtlas(u,x),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),u)))}storePattern(s,u,g){const x={w:g.data.width+2*i.F,h:g.data.height+2*i.F,x:0,y:0},S=new i.G(x,g,i.F);this.patterns[u][s.name]={bin:x,position:S}}bind(s,u){const g=s.gl;let x=this.atlasTexture[u];x?this.dirty&&(x.update(this.atlasImage[u]),this.dirty=!1):(x=new i.T(s,this.atlasImage[u],g.RGBA8),this.atlasTexture[u]=x),x.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(s,u){const g=[];for(const L in this.patterns[s])g.push(this.patterns[s][L].bin);const{w:x,h:S}=i.H(g),A=this.atlasImage[s];A.resize({width:x||1,height:S||1});for(const L in this.patterns[s]){const{bin:z,position:B}=this.patterns[s][L];let V=B.padding;const X=z.x+V,Y=z.y+V,re=this._images[s][L].data,ce=re.width,ae=re.height;V=V>1?V-1:V,i.r.copy(re,A,{x:0,y:0},{x:X,y:Y},{width:ce,height:ae},u),i.r.copy(re,A,{x:0,y:ae-V},{x:X,y:Y-V},{width:ce,height:V},u),i.r.copy(re,A,{x:0,y:0},{x:X,y:Y+ae},{width:ce,height:V},u),i.r.copy(re,A,{x:ce-V,y:0},{x:X-V,y:Y},{width:V,height:ae},u),i.r.copy(re,A,{x:0,y:0},{x:X+ce,y:Y},{width:V,height:ae},u),i.r.copy(re,A,{x:ce-V,y:ae-V},{x:X-V,y:Y-V},{width:V,height:V},u),i.r.copy(re,A,{x:0,y:ae-V},{x:X+ce,y:Y-V},{width:V,height:V},u),i.r.copy(re,A,{x:0,y:0},{x:X+ce,y:Y+ae},{width:V,height:V},u),i.r.copy(re,A,{x:ce-V,y:0},{x:X-V,y:Y+ae},{width:V,height:V},u)}this.dirty=!0}beginFrame(){for(const s in this._images)this.callbackDispatchedThisFrame[s]=new Set}dispatchRenderCallbacks(s,u){for(const g of s){if(this.callbackDispatchedThisFrame[u].has(g.toString()))continue;this.callbackDispatchedThisFrame[u].add(g.toString());const x=(g.iconsetId?this._iconsets[u][g.iconsetId]:this._images[u])[g.name];_t(x)&&this.updateImage(g,u,x)}}}function qr(y){const s=y.key,u=y.value,g=y.valueSpec||{},x=y.objectElementValidators||{},S=y.style,A=y.styleSpec;let L=[];const z=i.K(u);if(z!=="object")return[new i.V(s,u,`object expected, ${z} found`)];for(const B in u){const V=B.split(".")[0];let X;x[V]?X=x[V]:g[V]?X=wr:x["*"]?X=x["*"]:g["*"]&&(X=wr),X?L=L.concat(X({key:(s&&`${s}.`)+B,value:u[B],valueSpec:g[V]||g["*"],style:S,styleSpec:A,object:u,objectKey:B},u)):L.push(new i.J(s,u[B],`unknown property "${B}"`))}for(const B in g)x[B]||g[B].required&&g[B].default===void 0&&u[B]===void 0&&L.push(new i.V(s,u,`missing required property "${B}"`));return L}function Ln(y){const s=y.value,u=y.valueSpec,g=y.style,x=y.styleSpec,S=y.key,A=y.arrayElementValidator||wr;if(i.K(s)!=="array")return[new i.V(S,s,`array expected, ${i.K(s)} found`)];if(u.length&&s.length!==u.length)return[new i.V(S,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new i.V(S,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let L={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};x.$version<7&&(L.function=u.function),i.K(u.value)==="object"&&(L=u.value);let z=[];for(let B=0;B<s.length;B++)z=z.concat(A({array:s,arrayIndex:B,value:s[B],valueSpec:L,style:g,styleSpec:x,key:`${S}[${B}]`},!0));return z}function Ge(y){const s=y.key,u=y.value,g=y.valueSpec;let x=i.K(u);if(x==="number"&&u!=u&&(x="NaN"),x!=="number")return[new i.V(s,u,`number expected, ${x} found`)];if("minimum"in g){let S=g.minimum;if(i.K(g.minimum)==="array"&&(S=g.minimum[y.arrayIndex]),u<S)return[new i.V(s,u,`${u} is less than the minimum value ${S}`)]}if("maximum"in g){let S=g.maximum;if(i.K(g.maximum)==="array"&&(S=g.maximum[y.arrayIndex]),u>S)return[new i.V(s,u,`${u} is greater than the maximum value ${S}`)]}return[]}function vt(y){const s=y.valueSpec,u=i.M(y.value.type);let g,x,S,A={};const L=u!=="categorical"&&y.value.property===void 0,z=!L,B=i.K(y.value.stops)==="array"&&i.K(y.value.stops[0])==="array"&&i.K(y.value.stops[0][0])==="object",V=qr({key:y.key,value:y.value,valueSpec:y.styleSpec.function,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{stops:function(re){if(u==="identity")return[new i.V(re.key,re.value,'identity function may not have a "stops" property')];let ce=[];const ae=re.value;return ce=ce.concat(Ln({key:re.key,value:ae,valueSpec:re.valueSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:X})),i.K(ae)==="array"&&ae.length===0&&ce.push(new i.V(re.key,ae,"array must have at least one stop")),ce},default:function(re){return wr({key:re.key,value:re.value,valueSpec:s,style:re.style,styleSpec:re.styleSpec})}}});return u==="identity"&&L&&V.push(new i.V(y.key,y.value,'missing required property "property"')),u==="identity"||y.value.stops||V.push(new i.V(y.key,y.value,'missing required property "stops"')),u==="exponential"&&y.valueSpec.expression&&!i.N(y.valueSpec)&&V.push(new i.V(y.key,y.value,"exponential functions not supported")),y.styleSpec.$version>=8&&(z&&!i.O(y.valueSpec)?V.push(new i.V(y.key,y.value,"property functions not supported")):L&&!i.Q(y.valueSpec)&&V.push(new i.V(y.key,y.value,"zoom functions not supported"))),u!=="categorical"&&!B||y.value.property!==void 0||V.push(new i.V(y.key,y.value,'"property" property is required')),V;function X(re){let ce=[];const ae=re.value,fe=re.key;if(i.K(ae)!=="array")return[new i.V(fe,ae,`array expected, ${i.K(ae)} found`)];if(ae.length!==2)return[new i.V(fe,ae,`array length 2 expected, length ${ae.length} found`)];if(B){if(i.K(ae[0])!=="object")return[new i.V(fe,ae,`object expected, ${i.K(ae[0])} found`)];if(ae[0].zoom===void 0)return[new i.V(fe,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new i.V(fe,ae,"object stop key must have value")];const me=i.M(ae[0].zoom);if(typeof me!="number")return[new i.V(fe,ae[0].zoom,"stop zoom values must be numbers")];if(S&&S>me)return[new i.V(fe,ae[0].zoom,"stop zoom values must appear in ascending order")];me!==S&&(S=me,x=void 0,A={}),ce=ce.concat(qr({key:`${fe}[0]`,value:ae[0],valueSpec:{zoom:{}},style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:Ge,value:Y}}))}else ce=ce.concat(Y({key:`${fe}[0]`,value:ae[0],valueSpec:{},style:re.style,styleSpec:re.styleSpec},ae));return i.S(i.U(ae[1]))?ce.concat([new i.V(`${fe}[1]`,ae[1],"expressions are not allowed in function stops.")]):ce.concat(wr({key:`${fe}[1]`,value:ae[1],valueSpec:s,style:re.style,styleSpec:re.styleSpec}))}function Y(re,ce){const ae=i.K(re.value),fe=i.M(re.value),me=re.value!==null?re.value:ce;if(g){if(ae!==g)return[new i.V(re.key,me,`${ae} stop domain type must match previous stop domain type ${g}`)]}else g=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean"&&typeof fe!="number"&&typeof fe!="string"&&typeof fe!="boolean")return[new i.V(re.key,me,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&u!=="categorical"){let be=`number expected, ${ae} found`;return i.O(s)&&u===void 0&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(re.key,me,be)]}return u!=="categorical"||ae!=="number"||typeof fe=="number"&&isFinite(fe)&&Math.floor(fe)===fe?u!=="categorical"&&ae==="number"&&typeof fe=="number"&&typeof x=="number"&&x!==void 0&&fe<x?[new i.V(re.key,me,"stop domain values must appear in ascending order")]:(x=fe,u==="categorical"&&fe in A?[new i.V(re.key,me,"stop domain values must be unique")]:(A[fe]=!0,[])):[new i.V(re.key,me,`integer expected, found ${String(fe)}`)]}}function kt(y){const s=(y.expressionContext==="property"?i.W:i.X)(i.U(y.value),y.valueSpec);if(s.result==="error")return s.value.map(g=>new i.V(`${y.key}${g.key}`,y.value,g.message));const u=s.value.expression||s.value._styleExpression.expression;if(y.expressionContext==="property"&&y.propertyKey==="text-font"&&!u.outputDefined())return[new i.V(y.key,y.value,`Invalid data expression for "${y.propertyKey}". Output values must be contained as literals within the expression.`)];if(y.expressionContext==="property"&&y.propertyType==="layout"&&!i.Y(u))return[new i.V(y.key,y.value,'"feature-state" data expressions are not supported with layout properties.')];if(y.expressionContext==="filter")return dr(u,y);if(y.expressionContext&&y.expressionContext.indexOf("cluster")===0){if(!i.Z(u,["zoom","feature-state"]))return[new i.V(y.key,y.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(y.expressionContext==="cluster-initial"&&!i._(u))return[new i.V(y.key,y.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dr(y,s){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const x of s.valueSpec.expression.parameters)u.delete(x);if(u.size===0)return[];const g=[];return y instanceof i.$&&u.has(y.name)?[new i.V(s.key,s.value,`["${y.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(y.eachChild(x=>{g.push(...dr(x,s))}),g)}function lr(y){const s=y.key,u=y.value,g=y.valueSpec,x=[];return Array.isArray(g.values)?g.values.indexOf(i.M(u))===-1&&x.push(new i.V(s,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(i.M(u))===-1&&x.push(new i.V(s,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),x}function sr(y){return i.a1(i.U(y.value))?kt(i.L({},y,{expressionContext:"filter",valueSpec:y.styleSpec[`filter_${y.layerType||"fill"}`]})):Kt(y)}function Kt(y){const s=y.value,u=y.key;if(i.K(s)!=="array")return[new i.V(u,s,`array expected, ${i.K(s)} found`)];const g=y.styleSpec;let x,S=[];if(s.length<1)return[new i.V(u,s,"filter array must have at least 1 element")];switch(S=S.concat(lr({key:`${u}[0]`,value:s[0],valueSpec:g.filter_operator,style:y.style,styleSpec:y.styleSpec})),i.M(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&i.M(s[1])==="$type"&&S.push(new i.V(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&S.push(new i.V(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(x=i.K(s[1]),x!=="string"&&S.push(new i.V(`${u}[1]`,s[1],`string expected, ${x} found`)));for(let A=2;A<s.length;A++)x=i.K(s[A]),i.M(s[1])==="$type"?S=S.concat(lr({key:`${u}[${A}]`,value:s[A],valueSpec:g.geometry_type,style:y.style,styleSpec:y.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&S.push(new i.V(`${u}[${A}]`,s[A],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let A=1;A<s.length;A++)S=S.concat(Kt({key:`${u}[${A}]`,value:s[A],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":x=i.K(s[1]),s.length!==2?S.push(new i.V(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):x!=="string"&&S.push(new i.V(`${u}[1]`,s[1],`string expected, ${x} found`))}return S}function Zr(y,s){const u=y.key,g=y.style,x=y.layer,S=y.styleSpec,A=y.value,L=y.objectKey,z=S[`${s}_${y.layerType}`];if(!z)return[];const B=L.match(/^(.*)-use-theme$/);if(s==="paint"&&B&&z[B[1]])return i.S(A)?[].concat(wr({key:y.key,value:A,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:S,expressionContext:"property",propertyType:s,propertyKey:L})):wr({key:u,value:A,valueSpec:{type:"string"},style:g,styleSpec:S});const V=L.match(/^(.*)-transition$/);if(s==="paint"&&V&&z[V[1]]&&z[V[1]].transition)return wr({key:u,value:A,valueSpec:S.transition,style:g,styleSpec:S});const X=y.valueSpec||z[L];if(!X)return[new i.J(u,A,`unknown property "${L}"`)];let Y;if(i.K(A)==="string"&&i.O(X)&&!X.tokens&&(Y=/^{([^}]+)}$/.exec(A))){const ce=`\`{ "type": "identity", "property": ${Y?JSON.stringify(Y[1]):'"_"'} }\``;return[new i.V(u,A,`"${L}" does not support interpolation syntax
Use an identity property function instead: ${ce}.`)]}const re=[];if(y.layerType==="symbol")L!=="text-field"||!g||g.glyphs||g.imports||re.push(new i.V(u,A,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&i.a2(i.U(A))&&i.M(A.type)==="identity"&&re.push(new i.V(u,A,'"text-font" does not support identity functions'));else if(y.layerType==="model"&&s==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.O(X)&&(i.a3(X)||i.Q(X))){const ce=i.W(i.U(A),X),ae=ce.value.expression||ce.value._styleExpression.expression;ae&&!i.Z(ae,["measure-light"])&&(L==="model-emissive-strength"&&i._(ae)&&i.Y(ae)||re.push(new i.V(u,A,`${L} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return re.concat(wr({key:y.key,value:A,valueSpec:X,style:g,styleSpec:S,expressionContext:"property",propertyType:s,propertyKey:L}))}function fi(y){return Zr(y,"paint")}function Qn(y){return Zr(y,"layout")}function Pi(y){let s=[];const u=y.value,g=y.key,x=y.style,S=y.styleSpec;u.type||u.ref||s.push(new i.V(g,u,'either "type" or "ref" is required'));let A=i.M(u.type);const L=i.M(u.ref);if(u.id){const z=i.M(u.id);for(let B=0;B<y.arrayIndex;B++){const V=x.layers[B];i.M(V.id)===z&&s.push(new i.V(g,u.id,`duplicate layer id "${u.id}", previously used at line ${V.id.__line__}`))}}if("ref"in u){let z;["type","source","source-layer","filter","layout"].forEach(B=>{B in u&&s.push(new i.V(g,u[B],`"${B}" is prohibited for ref layers`))}),x.layers.forEach(B=>{i.M(B.id)===L&&(z=B)}),z?z.ref?s.push(new i.V(g,u.ref,"ref cannot reference another ref layer")):A=i.M(z.type):typeof L=="string"&&s.push(new i.V(g,u.ref,`ref layer "${L}" not found`))}else if(A!=="background"&&A!=="sky"&&A!=="slot")if(u.source){const z=x.sources&&x.sources[u.source],B=z&&i.M(z.type);z?B==="vector"&&A==="raster"?s.push(new i.V(g,u.source,`layer "${u.id}" requires a raster source`)):B==="raster"&&A!=="raster"?s.push(new i.V(g,u.source,`layer "${u.id}" requires a vector source`)):B!=="vector"||u["source-layer"]?B==="raster-dem"&&A!=="hillshade"?s.push(new i.V(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="raster-array"||["raster","raster-particle"].includes(A)?A!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||B==="geojson"&&z.lineMetrics?A==="raster-particle"&&B!=="raster-array"&&s.push(new i.V(g,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):s.push(new i.V(g,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new i.V(g,u.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new i.V(g,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new i.V(g,u.source,`source "${u.source}" not found`))}else s.push(new i.V(g,u,'missing required property "source"'));return s=s.concat(qr({key:g,value:u,valueSpec:S.layer,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wr({key:`${g}.type`,value:u.type,valueSpec:S.layer.type,style:y.style,styleSpec:y.styleSpec,object:u,objectKey:"type"}),filter:z=>sr(i.L({layerType:A},z)),layout:z=>qr({layer:u,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":B=>Qn(i.L({layerType:A},B))}}),paint:z=>qr({layer:u,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":B=>fi(i.L({layerType:A,layer:u},B))}})}})),s}function qo(y){const s=y.value,u=y.key,g=i.K(s);return g!=="string"?[new i.V(u,s,`string expected, ${g} found`)]:[]}const na={promoteId:function y({key:s,value:u}){if(i.K(u)==="string")return qo({key:s,value:u});if(Array.isArray(u)){const g=[],x=i.U(u),S=i.X(x);return S.result==="error"&&S.value.forEach(A=>{g.push(new i.V(`${s}${A.key}`,null,`${A.message}`))}),i.Z(S.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new i.V(`${s}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const x in u)g.push(...y({key:`${s}.${x}`,value:u[x]}));return g}}};function yl(y){const s=y.value,u=y.key,g=y.styleSpec,x=y.style;if(!s.type)return[new i.V(u,s,'"type" is required')];const S=i.M(s.type);let A=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&(s.url||s.tiles||A.push(new i.J(u,s,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return A=A.concat(qr({key:u,value:s,valueSpec:g[`source_${S.replace("-","_")}`],style:y.style,styleSpec:g,objectElementValidators:na})),A;case"geojson":if(A=qr({key:u,value:s,valueSpec:g.source_geojson,style:x,styleSpec:g,objectElementValidators:na}),s.cluster)for(const L in s.clusterProperties){const[z,B]=s.clusterProperties[L],V=typeof z=="string"?[z,["accumulated"],["get",L]]:z;A.push(...kt({key:`${u}.${L}.map`,value:B,expressionContext:"cluster-map"})),A.push(...kt({key:`${u}.${L}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return A;case"video":return qr({key:u,value:s,valueSpec:g.source_video,style:x,styleSpec:g});case"image":return qr({key:u,value:s,valueSpec:g.source_image,style:x,styleSpec:g});case"canvas":return[new i.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return lr({key:`${u}.type`,value:s.type,valueSpec:{values:Ql(g)},style:x,styleSpec:g})}}function Ql(y){return y.source.reduce((s,u)=>{const g=y[u];return g.type.type==="enum"&&(s=s.concat(Object.keys(g.type.values))),s},[])}function ls(y){const s=y.value,u=y.styleSpec,g=u.light,x=y.style;let S=[];const A=i.K(s);if(s===void 0)return S;if(A!=="object")return S=S.concat([new i.V("light",s,`object expected, ${A} found`)]),S;for(const L in s){const z=L.match(/^(.*)-transition$/),B=L.match(/^(.*)-use-theme$/);S=S.concat(B&&g[B[1]]?wr({key:L,value:s[L],valueSpec:{type:"string"},style:x,styleSpec:u}):z&&g[z[1]]&&g[z[1]].transition?wr({key:L,value:s[L],valueSpec:u.transition,style:x,styleSpec:u}):g[L]?wr({key:L,value:s[L],valueSpec:g[L],style:x,styleSpec:u}):[new i.V(L,s[L],`unknown property "${L}"`)])}return S}function vl(y){const s=y.value;let u=[];if(!s)return u;const g=i.K(s);if(g!=="object")return u=u.concat([new i.V("light-3d",s,`object expected, ${g} found`)]),u;const x=y.styleSpec,S=x["light-3d"],A=y.key,L=y.style,z=y.style.lights;for(const X of["type","id"])if(!(X in s))return u=u.concat([new i.V("light-3d",s,`missing property ${X} on light`)]),u;if(s.type&&z)for(let X=0;X<y.arrayIndex;X++){const Y=i.M(s.type),re=z[X];i.M(re.type)===Y&&u.push(new i.V(A,s.id,`duplicate light type "${s.type}", previously defined at line ${re.id.__line__}`))}const B=`properties_light_${s.type}`;if(!(B in x))return u=u.concat([new i.V("light-3d",s,`Invalid light type ${s.type}`)]),u;const V=x[B];for(const X in s)if(X==="properties"){const Y=s[X],re=i.K(Y);if(re!=="object")return u=u.concat([new i.V("properties",Y,`object expected, ${re} found`)]),u;for(const ce in Y)u=u.concat(V[ce]?wr({key:ce,value:Y[ce],valueSpec:V[ce],style:L,styleSpec:x}):[new i.J(y.key,Y[ce],`unknown property "${ce}"`)])}else{const Y=X.match(/^(.*)-transition$/),re=X.match(/^(.*)-use-theme$/);u=u.concat(re&&S[re[1]]?wr({key:X,value:s[X],valueSpec:{type:"string"},style:L,styleSpec:x}):Y&&S[Y[1]]&&S[Y[1]].transition?wr({key:X,value:s[X],valueSpec:x.transition,style:L,styleSpec:x}):S[X]?wr({key:X,value:s[X],valueSpec:S[X],style:L,styleSpec:x}):[new i.J(X,s[X],`unknown property "${X}"`)])}return u}function Co(y){const s=y.value,u=y.key,g=y.style,x=y.styleSpec,S=x.terrain;let A=[];const L=i.K(s);if(s===void 0||L==="null")return A;if(L!=="object")return A=A.concat([new i.V("terrain",s,`object expected, ${L} found`)]),A;for(const z in s){const B=z.match(/^(.*)-transition$/),V=z.match(/^(.*)-use-theme$/);A=A.concat(V&&S[V[1]]?wr({key:z,value:s[z],valueSpec:{type:"string"},style:g,styleSpec:x}):B&&S[B[1]]&&S[B[1]].transition?wr({key:z,value:s[z],valueSpec:x.transition,style:g,styleSpec:x}):S[z]?wr({key:z,value:s[z],valueSpec:S[z],style:g,styleSpec:x}):[new i.J(z,s[z],`unknown property "${z}"`)])}if(s.source){const z=g.sources&&g.sources[s.source],B=z&&i.M(z.type);z?B!=="raster-dem"&&A.push(new i.V(u,s.source,`terrain cannot be used with a source of type ${String(B)}, it only be used with a "raster-dem" source type`)):A.push(new i.V(u,s.source,`source "${s.source}" not found`))}else A.push(new i.V(u,s,'terrain is missing required property "source"'));return A}function Ia(y){const s=y.value,u=y.style,g=y.styleSpec,x=g.fog;let S=[];const A=i.K(s);if(s===void 0)return S;if(A!=="object")return S=S.concat([new i.V("fog",s,`object expected, ${A} found`)]),S;for(const L in s){const z=L.match(/^(.*)-transition$/),B=L.match(/^(.*)-use-theme$/);S=S.concat(B&&x[B[1]]?wr({key:L,value:s[L],valueSpec:{type:"string"},style:u,styleSpec:g}):z&&x[z[1]]&&x[z[1]].transition?wr({key:L,value:s[L],valueSpec:g.transition,style:u,styleSpec:g}):x[L]?wr({key:L,value:s[L],valueSpec:x[L],style:u,styleSpec:g}):[new i.J(L,s[L],`unknown property "${L}"`)])}return S}const pi={"*":()=>[],array:Ln,boolean:function(y){const s=y.value,u=y.key,g=i.K(s);return g!=="boolean"?[new i.V(u,s,`boolean expected, ${g} found`)]:[]},number:Ge,color:function(y){const s=y.key,u=y.value,g=i.K(u);return g!=="string"?[new i.V(s,u,`color expected, ${g} found`)]:i.a0.parseCSSColor(u)===null?[new i.V(s,u,`color expected, "${u}" found`)]:[]},enum:lr,filter:sr,function:vt,layer:Pi,object:qr,source:yl,model:i.a4,light:ls,"light-3d":vl,terrain:Co,fog:Ia,string:qo,formatted:function(y){return qo(y).length===0?[]:kt(y)},resolvedImage:function(y){return qo(y).length===0?[]:kt(y)},projection:function(y){const s=y.value,u=y.styleSpec,g=u.projection,x=y.style;let S=[];const A=i.K(s);if(A==="object")for(const L in s)S=S.concat(wr({key:L,value:s[L],valueSpec:g[L],style:x,styleSpec:u}));else A!=="string"&&(S=S.concat([new i.V("projection",s,`object or string expected, ${A} found`)]));return S},import:function(y){const{value:s,styleSpec:u}=y,{data:g,...x}=s;Object.defineProperty(x,"__line__",{value:s.__line__,enumerable:!1});let S=qr(i.L({},y,{value:x,valueSpec:u.import}));return i.M(x.id)===""&&S.push(new i.V(`${y.key}.id`,x,"import id can't be an empty string")),g&&(S=S.concat(ei(g,u,{key:`${y.key}.data`}))),S},iconset:function(y){const s=y.value,u=y.key,g=y.styleSpec,x=y.style;if(!s.type)return[new i.V(u,s,'"type" is required')];const S=i.M(s.type);let A=[];if(A=A.concat(qr({key:u,value:s,valueSpec:g[`iconset_${S}`],style:x,styleSpec:g})),S==="source"&&s.source){const L=x.sources&&x.sources[s.source],z=L&&i.M(L.type);L?z!=="raster-array"&&A.push(new i.V(u,s.source,`iconset cannot be used with a source of type ${String(z)}, it only be used with a "raster-array" source type`)):A.push(new i.V(u,s.source,`source "${s.source}" not found`))}return A}};function wr(y,s=!1){const u=y.value,g=y.valueSpec,x=y.styleSpec;if(g.expression&&i.a2(i.M(u)))return vt(y);if(g.expression&&i.S(i.U(u)))return kt(y);if(g.type&&pi[g.type]){const S=pi[g.type](y);return s===!0&&S.length>0&&i.K(y.value)==="array"?kt(y):S}return qr(i.L({},y,{valueSpec:g.type?x[g.type]:g}))}function mi(y){const s=y.value,u=y.key,g=qo(y);return g.length||(s.indexOf("{fontstack}")===-1&&g.push(new i.V(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&g.push(new i.V(u,s,'"glyphs" url must include a "{range}" token'))),g}function ei(y,s=i.a5,u={}){return wr({key:u.key||"",value:y,valueSpec:s.$root,styleSpec:s,style:y,objectElementValidators:{glyphs:mi,"*":()=>[]}})}function Li(y,s=i.a5){return qe(ei(y,s))}const Ho=y=>qe(yl(y)),ec=y=>qe(ls(y)),Fu=y=>qe(vl(y)),Wy=y=>qe(Co(y)),Gy=y=>qe(Ia(y)),Cm=y=>qe(function(s){const u=s.value,g=s.style,x=s.styleSpec,S=x.snow;let A=[];const L=i.K(u);if(u===void 0)return A;if(L!=="object")return A=A.concat([new i.V("snow",u,`object expected, ${L} found`)]),A;for(const z in u){const B=z.match(/^(.*)-transition$/);A=A.concat(B&&S[B[1]]&&S[B[1]].transition?wr({key:z,value:u[z],valueSpec:x.transition,style:g,styleSpec:x}):S[z]?wr({key:z,value:u[z],valueSpec:S[z],style:g,styleSpec:x}):[new i.J(z,u[z],`unknown property "${z}"`)])}return A}(y)),mt=y=>qe(function(s){const u=s.value,g=s.style,x=s.styleSpec,S=x.rain;let A=[];const L=i.K(u);if(u===void 0)return A;if(L!=="object")return A=A.concat([new i.V("rain",u,`object expected, ${L} found`)]),A;for(const z in u){const B=z.match(/^(.*)-transition$/);A=A.concat(B&&S[B[1]]&&S[B[1]].transition?wr({key:z,value:u[z],valueSpec:x.transition,style:g,styleSpec:x}):S[z]?wr({key:z,value:u[z],valueSpec:S[z],style:g,styleSpec:x}):[new i.J(z,u[z],`unknown property "${z}"`)])}return A}(y)),pe=y=>qe(Pi(y)),ye=y=>qe(sr(y)),Ae=y=>qe(fi(y)),je=y=>qe(Qn(y)),Le=y=>qe(i.a4(y));function qe(y){return y.slice().sort((s,u)=>s.line&&u.line?s.line-u.line:0)}function lt(y,s){let u=!1;if(s&&s.length)for(const g of s)g instanceof i.J?i.w(g.message):(y.fire(new i.z(new Error(g.message))),u=!0);return u}let Xe;class ft extends i.E{constructor(s,u="flat"){super(),this._transitionable=new i.a6(Xe||(Xe=new i.a7({anchor:new i.a8(i.a5.light.anchor),position:new i.a9(i.a5.light.position),color:new i.a8(i.a5.light.color),intensity:new i.a8(i.a5.light.intensity)}))),this.setLight(s,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u,g={}){this._validate(ec,s,g)||(this._transitionable.setTransitionOrValue(s),this.id=u)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,g){return(!g||g.validate!==!1)&&lt(this,s.call(Li,i.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let yt=class extends i.E{constructor(y,s,u,g){super(),this.scope=u,this._transitionable=new i.a6(new i.a7({source:new i.a8(i.a5.terrain.source),exaggeration:new i.a8(i.a5.terrain.exaggeration)}),u,g),this._transitionable.setTransitionOrValue(y,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(y,s){this._transitionable.setTransitionOrValue(y,s)}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}getExaggeration(y){return this._transitioning.possiblyEvaluate(new i.aa(y)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const y=this._transitionable._values.exaggeration;if(!y)return null;const s=y.value.expression;if(!s)return null;let u=-1,g=-1,x=1;for(const S of s.zoomStops)x=s.evaluate(new i.aa(S)),x>.01?(u=S,g=-1):g=S;return x<.01&&u>0&&g>u?[u,g]:null}isZoomDependent(){const y=this._transitionable._values.exaggeration;return y!=null&&y.value!=null&&y.value.expression!=null&&y.value.expression instanceof i.ab}};const pt=45,Nt=65,Xt=.05;function er(y,s,u,g){const x=i.ae(pt,Nt,u),[S,A]=Rr(y,g);let L=1-Math.min(1,Math.exp((s-S)/(A-S)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*x*y.alpha}function Rr(y,s){const u=.5/Math.tan(.5*s);return[y.range[0]+u,y.range[1]+u]}function Br(y,s,u,g,x){const S=i.ad.vec3.transformMat4([],[s,u,g],x.mercatorFogMatrix);return er(y,i.ad.vec3.length(S),x.pitch,x._fov)}function $r(y,s,u,g,x,S,A){const L=[[u,g,0],[x,g,0],[x,S,0],[u,S,0]];let z=Number.MAX_VALUE,B=-Number.MAX_VALUE;for(const V of L){const X=i.ad.vec3.transformMat4([],V,s),Y=i.ad.vec3.length(X);z=Math.min(z,Y),B=Math.max(B,Y)}return[er(y,z,A.pitch,A._fov),er(y,B,A.pitch,A._fov)]}class Gr extends i.E{constructor(s,u,g,x){super();const S=new i.a7({range:new i.a8(i.a5.fog.range),color:new i.a8(i.a5.fog.color),"color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a8(i.a5.fog["high-color"]),"high-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a8(i.a5.fog["space-color"]),"space-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a8(i.a5.fog["horizon-blend"]),"star-intensity":new i.a8(i.a5.fog["star-intensity"]),"vertical-range":new i.a8(i.a5.fog["vertical-range"])});this._transitionable=new i.a6(S,g,new Map(x)),this.set(s,x),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new i.af(S),this.scope=g}get state(){const s=this._transform,u=s.projection.name==="globe",g=i.ag(s.zoom),x=this.properties.get("range"),S=[.5,3];return{range:u?[i.ah(S[0],x[0],g),i.ah(S[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,u,g={}){if(this._validate(Gy,s,g))return;const x=i.l({},s);for(const S of Object.keys(i.a5.fog))x[S]===void 0&&(x[S]=i.a5.fog[S].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ae(pt,Nt,s))*u.a}getOpacityAtLatLng(s,u){return this._transform.projection.supportsFog?function(g,x,S){const A=i.ac.fromLngLat(x),L=S.elevation?S.elevation.getAtPointOrZero(A):0;return Br(g,A.x,A.y,L,S)}(this.state,s,u):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(s.toUnwrapped());return $r(this.state,u,0,0,i.ai,i.ai,this._transform)}getOpacityForBounds(s,u,g,x,S){return this._transform.projection.supportsFog?$r(this.state,s,u,g,x,S,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Rr(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const g of u){const x=s.points[g];let S;if(x[2]>=0)S=x;else{const A=s.points[g-4];S=i.aj(A,x,A[2]/(A[2]-x[2]))}if(Br(this.state,S[0],S[1],0,this._transform)>=Xt)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,g){return(!g||g.validate!==!1)&&lt(this,s.call(Li,i.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let Gn,_i,Jr,Tn,En=class extends i.E{constructor(y,s,u,g){super();const x=Gn||(Gn=new i.a7({density:new i.a8(i.a5.snow.density),intensity:new i.a8(i.a5.snow.intensity),color:new i.a8(i.a5.snow.color),opacity:new i.a8(i.a5.snow.opacity),vignette:new i.a8(i.a5.snow.vignette),"vignette-color":new i.a8(i.a5.snow["vignette-color"]),"center-thinning":new i.a8(i.a5.snow["center-thinning"]),direction:new i.a8(i.a5.snow.direction),"flake-size":new i.a8(i.a5.snow["flake-size"])}));this._transitionable=new i.a6(x,u,new Map(g)),this.set(y,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.af(x),this.scope=u}get state(){const y=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),g=i.ak(u[0]),x=-Math.max(i.ak(u[1]),.01),S=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette"),L=this.properties.get("vignette-color");return L.a=A,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.al(s.r,s.g,s.b,s.a*y),direction:S,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:L}}get(){return this._transitionable.serialize()}set(y,s,u={}){if(this._validate(Cm,y,u))return;const g=i.l({},y);for(const x of Object.keys(i.a5.snow))g[x]===void 0&&(g[x]=i.a5.snow[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(y){this._transitionable.setTransitionOrValue(this._options,new Map(y))}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}_validate(y,s,u){return(!u||u.validate!==!1)&&lt(this,y.call(Li,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}},Pn=class extends i.E{constructor(y,s,u,g){super();const x=_i||(_i=new i.a7({density:new i.a8(i.a5.rain.density),intensity:new i.a8(i.a5.rain.intensity),color:new i.a8(i.a5.rain.color),opacity:new i.a8(i.a5.rain.opacity),vignette:new i.a8(i.a5.rain.vignette),"vignette-color":new i.a8(i.a5.rain["vignette-color"]),"center-thinning":new i.a8(i.a5.rain["center-thinning"]),direction:new i.a8(i.a5.rain.direction),"droplet-size":new i.a8(i.a5.rain["droplet-size"]),"distortion-strength":new i.a8(i.a5.rain["distortion-strength"])}));this._transitionable=new i.a6(x,u,new Map(g)),this.set(y,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.af(x),this.scope=u}get state(){const y=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),g=i.ak(u[0]),x=-Math.max(i.ak(u[1]),.01),S=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette-color");return A.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.al(s.r,s.g,s.b,s.a*y),direction:S,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:A}}get(){return this._transitionable.serialize()}set(y,s,u={}){if(this._validate(mt,y,u))return;const g=i.l({},y);for(const x of Object.keys(i.a5.rain))g[x]===void 0&&(g[x]=i.a5.rain[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(y){this._transitionable.setTransitionOrValue(this._options,new Map(y))}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}_validate(y,s,u){return(!u||u.validate!==!1)&&lt(this,y.call(Li,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}};class Ni extends i.E{constructor(s,u,g,x){super(),this.scope=g,this._options=s,this.properties=new i.af(u),this._transitionable=new i.a6(u,g,new Map(x)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,u){this._options=s,this._transitionable.setTransitionOrValue(s.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Po{constructor(s,u,g,x){this.screenBounds=s,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(s,u){let g,x;if(s instanceof i.P||typeof s[0]=="number"){const S=i.P.convert(s);g=[S],x=u.isPointAboveHorizon(S)}else{const S=i.P.convert(s[0]),A=i.P.convert(s[1]);g=[S,A],x=i.an(S,A).every(L=>u.isPointAboveHorizon(L))}return new Po(g,u.getCameraPoint(),x,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return i.an(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.an(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),i.ao(x,s)}bufferedCameraGeometryGlobe(s){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.an(u,g,s),S=this.cameraPoint.clone();switch(3*((S.y>u.y)+(S.y>g.y))+((S.x>u.x)+(S.x>g.x))){case 0:x[0]=S,x[4]=S.clone();break;case 1:x.splice(1,0,S);break;case 2:x[1]=S;break;case 3:x.splice(4,0,S);break;case 5:x.splice(2,0,S);break;case 6:x[3]=S;break;case 7:x.splice(3,0,S);break;case 8:x[2]=S}return x}containsTile(s,u,g,x=0){const S=s.queryPadding/u._pixelsPerMercatorPixel+1,A=g?this._bufferedCameraMercator(S,u):this._bufferedScreenMercator(S,u);let L=s.tileID.wrap+(A.unwrapped?x:0);const z=A.polygon.map(fe=>i.ap(s.tileTransform,fe,L));if(!i.aq(z,0,0,i.ai,i.ai))return;L=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const B=this.screenGeometryMercator.polygon.map(fe=>i.ar(s.tileTransform,fe,L)),V=B.map(fe=>new i.P(fe[0],fe[1])),X=u.getFreeCameraOptions().position||new i.ac(0,0,0),Y=i.ar(s.tileTransform,X,L),re=B.map(fe=>{const me=i.ad.vec3.sub(fe,fe,Y);return i.ad.vec3.normalize(me,me),new i.as(Y,me)}),ce=i.at(s,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:re,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(ae=i.au(z),ae.min.x=i.ay(ae.min.x,0,i.ai),ae.min.y=i.ay(ae.min.y,0,i.ai),ae.max.x=i.ay(ae.max.x,0,i.ai),ae.max.y=i.ay(ae.max.y,0,i.ai),ae),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ce};var ae}_bufferedScreenMercator(s,u){const g=_a(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),u):{polygon:this.bufferedScreenGeometry(s).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(s,u){const g=_a(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),u):{polygon:this.bufferedCameraGeometry(s).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(s,u){const g=function(S,A){const L=i.ad.mat4.multiply([],A.pixelMatrix,A.globeMatrix),z=[0,-i.az,0,1],B=[0,i.az,0,1],V=[0,0,0,1];i.ad.vec4.transformMat4(z,z,L),i.ad.vec4.transformMat4(B,B,L),i.ad.vec4.transformMat4(V,V,L);const X=new i.P(z[0]/z[3],z[1]/z[3]),Y=new i.P(B[0]/B[3],B[1]/B[3]),re=i.aw(S,X)&&z[3]<V[3],ce=i.aw(S,Y)&&B[3]<V[3];if(!re&&!ce)return null;const ae=function(Ce,Pe,Ne){for(let Ue=1;Ue<Ce.length;Ue++){const dt=Ns(Pe.pointCoordinate3D(Ce[Ue-1]).x),et=Ns(Pe.pointCoordinate3D(Ce[Ue]).x);if(Ne<0){if(dt<et)return{idx:Ue,t:-dt/(et-1-dt)}}else if(et<dt)return{idx:Ue,t:(1-dt)/(et+1-dt)}}return null}(S,A,re?-1:1);if(!ae)return null;const{idx:fe,t:me}=ae;let be=fe>1?ia(S.slice(0,fe),A):[],Ee=fe<S.length?ia(S.slice(fe),A):[];be=be.map(Ce=>new i.P(Ns(Ce.x),Ce.y)),Ee=Ee.map(Ce=>new i.P(Ns(Ce.x),Ce.y));const Te=[...be];Te.length===0&&Te.push(Ee[Ee.length-1]);const Oe=i.ah(Te[Te.length-1].y,(Ee.length===0?be[0]:Ee[0]).y,me);let Me;return Me=re?[new i.P(0,Oe),new i.P(0,0),new i.P(1,0),new i.P(1,Oe)]:[new i.P(1,Oe),new i.P(1,1),new i.P(0,1),new i.P(0,Oe)],Te.push(...Me),Ee.length===0?Te.push(be[0]):Te.push(...Ee),{polygon:Te.map(Ce=>new i.ac(Ce.x,Ce.y)),unwrapped:!1}}(s,u);if(g)return g;const x=function(S,A){let L=!1,z=-1/0,B=0;for(let X=0;X<S.length-1;X++)S[X].x>z&&(z=S[X].x,B=X);for(let X=0;X<S.length-1;X++){const Y=(B+X)%(S.length-1),re=S[Y],ce=S[Y+1];Math.abs(re.x-ce.x)>.5&&(re.x<ce.x?(re.x+=1,Y===0&&(S[S.length-1].x+=1)):(ce.x+=1,Y+1===S.length-1&&(S[0].x+=1)),L=!0)}const V=i.av(A.center.lng);return L&&V<Math.abs(V-1)&&S.forEach(X=>{X.x-=1}),{polygon:S,unwrapped:L}}(ia(s,u).map(S=>new i.P(Ns(S.x),S.y)),u);return{polygon:x.polygon.map(S=>new i.ac(S.x,S.y)),unwrapped:x.unwrapped}}}function ia(y,s){return i.ax(y,u=>{const g=s.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function Ns(y){return y<0?1+y%1:y%1}function _a(y){return 100*y|0}function Io(y,s,u,g,x){const S=function(L,z){if(L)return x(L);if(z){if(y.url&&z.tiles&&y.tiles&&delete y.tiles,z.variants){if(!Array.isArray(z.variants))return x(new Error("variants must be an array"));for(const V of z.variants){if(V==null||typeof V!="object"||V.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(V.capabilities))return x(new Error("capabilities must be an array"));if(V.capabilities.length===1&&V.capabilities[0]==="meshopt"){z=i.l(z,V);break}}}const B=i.aA(i.l({},z,y),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);B.tiles=s.canonicalizeTileset(B,y.url),x(null,B)}},A=function(L,z,B){if(!L)return null;if(!z&&!B)return L;B=B||L.worldview_default;const V=Object.values(L.language||{});if(V.length===0)return null;const X=Object.values(L.worldview||{});if(X.length===0)return null;const Y=V.every(ce=>ce===z),re=X.every(ce=>ce===B);return Y&&re?L:z in(L.language_options||{})||B in(L.worldview_options||{})?null:L.language_options&&L.worldview_options?L:null}(y.data,u,g);return A?i.q.frame(()=>S(null,A)):y.url?i.n(s.transformRequest(s.normalizeSourceURL(y.url,null,u,g),i.R.Source),S):i.q.frame(()=>{const{data:L,...z}=y;S(null,z)})}class Fo{constructor(s,u,g){this.bounds=i.aB.convert(this.validateBounds(s)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const u=Math.pow(2,s.z),g=Math.floor(i.av(this.bounds.getWest())*u),x=Math.floor(i.aC(this.bounds.getNorth())*u),S=Math.ceil(i.av(this.bounds.getEast())*u),A=Math.ceil(i.aC(this.bounds.getSouth())*u);return s.x>=g&&s.x<S&&s.y>=x&&s.y<A}}class rf extends i.E{constructor(s,u,g,x){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.aA(u,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aD}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Io(this._options,this.map._requestManager,u,g,(x,S)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new i.z(x));else if(S){if(i.l(this,S),this.hasWorldviews=!!S.worldview_options,S.worldview_default&&(this.worldviewDefault=S.worldview_default),S.vector_layers){this.vectorLayers=S.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const A of S.vector_layers)this.vectorLayerIds.push(A.id),S.worldview&&S.worldview[A.source]&&this.localizableLayerIds.add(A.id)}S.bounds&&(this.tileBounds=new Fo(S.bounds,this.minzoom,this.maxzoom)),$t(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}s&&s(x)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(s,u){const g=s.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(g),S=this.map._requestManager.transformRequest(x,i.R.Tile),A=this.map.style?this.map.style.getLut(this.scope):null,L=A?{image:A.image.clone()}:null,z={request:S,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:L,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(g)&&(z.worldview=this.map.getWorldview()||this.worldviewDefault,z.localizableLayerIds=this.localizableLayerIds),z.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=u:s.request=s.actor.send("reloadTile",z,B.bind(this));else if(s.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",z,B.bind(this),void 0,!0);else{const V=i.aE.call({deduped:this._deduped},z,(X,Y)=>{X||!Y?B.call(this,X):(z.data={cacheControl:Y.cacheControl,expires:Y.expires,rawData:Y.rawData.slice(0)},s.actor&&s.actor.send("loadTile",z,B.bind(this),void 0,!0))},!0);s.request={cancel:V}}function B(V,X){return delete s.request,s.aborted?u(null):V&&V.status!==404?u(V):(X&&X.resourceTiming&&(s.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&s.setExpiryData(X),s.loadVectorData(X,this.map.painter),i.aF(this.dispatcher),u(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class zs extends i.E{constructor(s,u,g,x){super(),this.id=s,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},u),i.l(this,i.aA(u,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._tileJSONRequest=Io(this._options,this.map._requestManager,null,null,(u,g)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new i.z(u)):g&&(i.l(this,g),g.raster_layers&&(this.rasterLayers=g.raster_layers,this.rasterLayerIds=this.rasterLayers.map(x=>x.id)),g.bounds&&(this.tileBounds=new Fo(g.bounds,this.minzoom,this.maxzoom)),$t(g.tiles),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),s&&s(u)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,u){const g=i.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=i.o(this.map._requestManager.transformRequest(x,i.R.Tile),(S,A,L,z)=>(delete s.request,s.aborted?(s.state="unloaded",u(null)):S?(s.state="errored",u(S)):A?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:L,expires:z}),s.setTexture(A,this.map.painter),s.state="loaded",i.aF(this.dispatcher),void u(null)):u(null)))}abortTile(s,u){s.request&&(s.request.cancel(),delete s.request),u&&u()}unloadTile(s,u){s.texture&&s.texture instanceof i.T?(s.destroy(!0),s.texture&&s.texture instanceof i.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Rc extends zs{constructor(s,u,g,x){super(s,u,g,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this.iconsets={},this._options=i.l({type:"raster-array"},u)}triggerRepaint(s){const u=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);u&&u.enabled&&g&&u._clearRenderCacheForTile(g.id,s.tileID),this.map.triggerRepaint()}loadTile(s,u){const g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,i.R.Tile),S={request:x,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=x,s.actor||(s.actor=this.dispatcher.getActor());const A=(L,z,B,V)=>{if(delete s.request,s.aborted)return s.state="unloaded",u(null);if(L)return L.name==="AbortError"?void 0:(s.state="errored",u(L));if(this.map._refreshExpiredTiles&&z&&s.setExpiryData({cacheControl:B,expires:V}),this.partial)s.state="empty";else{if(!z)return u(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=z;const X=new Map;for(const Y in s._mrt.layers){const re=s.getLayer(Y);if(re)for(const ce of re.getBandList()){const{bytes:ae,tileSize:fe,buffer:me}=re.getBandView(ce),be=fe+2*me,Ee={data:new i.r({width:be,height:be},ae),pixelRatio:2,sdf:!1,usvg:!1,version:0};X.set(`${Y}/${ce}`,Ee)}}for(const Y in this.iconsets)this.iconsets[Y].addIcons(X)}u(null)};s.request=this.partial?s.fetchHeader(void 0,A.bind(this)):s.actor.send("loadTile",S,A.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){const g=s.texture;g&&g instanceof i.T?(s.destroy(!0),this.map.painter.saveTileTexture(g)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,u,g){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(u,g,(x,S)=>{if(x)return s.state="errored",this.fire(new i.z(x)),void this.triggerRepaint(s);S&&(s._isHeaderLoaded=!0,s.setTexture(S,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:S})=>S===s),g=u&&u.fields,x=g&&g.bands&&g.bands;return x?x[0]:0}getTextureDescriptor(s,u,g){if(!s)return;const x=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let S=null;u instanceof i.aI?S=u.paint.get("raster-array-band"):u instanceof i.aJ&&(S=u.paint.get("raster-particle-array-band"));const A=S||this.getInitialBand(x);if(A!=null)if(s.textureDescriptor){if(!s.updateNeeded(x,A)||g)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,x,A)}addIconset(s,u){this.iconsets[s]=u,this.partial=!1}}const rb={vector:rf,raster:zs,"raster-dem":class extends zs{constructor(y,s,u,g){super(y,s,u,g),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(y,s){const u=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,S){x&&(y.state="errored",s(x)),S&&(y.dem=S,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",s(null))}y.request=i.o(this.map._requestManager.transformRequest(u,i.R.Tile),(function(x,S,A,L){if(delete y.request,y.aborted)y.state="unloaded",s(null);else if(x)y.state="errored",s(x);else if(S){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:A,expires:L});const z=ImageBitmap&&S instanceof ImageBitmap&&i.t(),B=1-(S.width-i.aG(S.width))/2;B<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const V=z?S:i.q.getImageData(S,B),X={uid:y.uid,tileID:y.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:V,encoding:this.encoding,padding:B};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadTile",X,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(y){const s=y.canonical,u=Math.pow(2,s.z),g=(s.x-1+u)%u,x=s.x===0?y.wrap-1:y.wrap,S=(s.x+1+u)%u,A=s.x+1===u?y.wrap+1:y.wrap,L={};return L[new i.aH(y.overscaledZ,x,s.z,g,s.y).key]={backfilled:!1},L[new i.aH(y.overscaledZ,A,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(L[new i.aH(y.overscaledZ,x,s.z,g,s.y-1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,y.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,A,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<u&&(L[new i.aH(y.overscaledZ,x,s.z,g,s.y+1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,y.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},L[new i.aH(y.overscaledZ,A,s.z,S,s.y+1).key]={backfilled:!1}),L}},"raster-array":Rc,geojson:class extends i.E{constructor(y,s,u,g){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=s.data,this._options=i.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const x=i.ai/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*x,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*x,extent:i.ai,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:i.ai,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*x,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}updateData(y){if(!this._options.dynamic)return this.fire(new i.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof y!="string"&&(y.type==="Feature"&&(y={type:"FeatureCollection",features:[y]}),y.type!=="FeatureCollection"))return this.fire(new i.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof y!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const u of this._data.features)s.set(u.id,u);for(const u of y.features)s.set(u.id,u);this._data.features=[...s.values()]}else this._data=y;return this._updateWorkerData(!0),this}getClusterExpansionZoom(y,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id,scope:this.scope},s),this}getClusterChildren(y,s){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id,scope:this.scope},s),this}getClusterLeaves(y,s,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:y,limit:s,offset:u},g),this}_updateWorkerData(y=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.A("dataloading",{dataType:"source"})),this._loaded=!1;const s=i.l({append:y},this.workerOptions);s.scope=this.scope;const u=this._data;typeof u=="string"?(s.request=this.map._requestManager.transformRequest(i.q.resolveURL(u),i.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(g,x)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new i.z(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(S.resourceTiming=x.resourceTiming[this.id]),y&&(this._partialReload=!0),this.fire(new i.A("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(y),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const y=i.C(this.id,this.scope);this.map.style.clearSource(y),this._updateWorkerData()}loadTile(y,s){const u=y.actor?"reloadTile":"loadTile";y.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,x=g?{image:g.image.clone()}:null,S=this._partialReload,A={type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:S};y.request=this.actor.send(u,A,(L,z)=>S&&!z?(y.state="loaded",s(null)):(delete y.request,y.destroy(),y.aborted?s(null):L?s(L):(y.loadVectorData(z,this.map.painter,u==="reloadTile"),s(null))),void 0,u==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y,s){this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id,scope:this.scope}),y.destroy()}onRemove(y){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aK{constructor(y,s,u,g){super(y,s,u,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const s of y.urls)this.urls.push(this.map._requestManager.transformRequest(s,i.R.Source).url);i.aL(this.urls,(s,u)=>{this._loaded=!0,s?this.fire(new i.z(s)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const s=this.video.seekable;y<s.start(0)||y>s.end(0)?this.fire(new i.z(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,s=y.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(y,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aK,model:class extends i.E{constructor(y,s,u,g){super(),this.id=y,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const y=[];for(const s in this._options.models){const u=this._options.models[s],g=i.aN(this.map._requestManager.transformRequest(u.uri,i.R.Model).url).then(x=>{if(!x)return;const S=i.aO(x),A=new i.aP(s,u.position,u.orientation,S);A.computeBoundsAndApplyParent(),this.models.push(A)}).catch(x=>{this.fire(new i.z(new Error(`Could not load model ${s} from ${u.uri}: ${x.message}`)))});y.push(g)}return Promise.allSettled(y).then(()=>{this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this.fire(new i.z(new Error(`Could not load models: ${s.message}`)))})}onAdd(y){this.map=y,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(y,s){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(y,s,u,g){super(),this.type="batched-model",this.id=y,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(y){this.map=y,this.load()}reload(){this.cancelTileJSONRequest();const y=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(y))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(y){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Io(this._options,this.map._requestManager,s,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new i.z(g))):x&&(i.l(this,x),x.bounds&&(this.tileBounds=new Fo(x.bounds,this.minzoom,this.maxzoom)),$t(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),y&&y(g)})}hasTransition(){return!1}hasTile(y){return!this.tileBounds||this.tileBounds.contains(y.canonical)}loaded(){return this._loaded}loadTile(y,s){const u=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,i.R.Tile),data:void 0,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,tileSize:this.tileSize*y.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:y.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.q.devicePixelRatio,promoteId:this.promoteId};if(y.actor&&y.state!=="expired")if(y.state==="loading")y.reloadCallback=s;else{if(y.buckets){const S=Object.values(y.buckets);for(const A of S)A.dirty=!0;return void(y.state="loaded")}y.request=y.actor.send("reloadTile",g,x.bind(this))}else y.actor=this.dispatcher.getActor(),y.request=y.actor.send("loadTile",g,x.bind(this),void 0,!0);function x(S,A){return y.aborted?s(null):S&&S.status!==404?s(S):(this.map._refreshExpiredTiles&&A&&y.setExpiryData(A),y.loadModelData(A,this.map.painter),y.state="loaded",void s(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aK{constructor(y,s,u,g){super(y,s,u,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new i.z(new i.V(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.z(new i.V(`sources.${y}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new i.z(new i.V(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new i.z(new i.V(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.z(new i.V(`sources.${y}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(y){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!y&&!this._playing||this.texture instanceof i.aM||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends i.E{constructor(y,s,u,g){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Fo(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.aA(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aA(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this.map=y,this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:s,y:u,z:g}=y.canonical;return this._implementation.hasTile({x:s,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,s){const{x:u,y:g,z:x}=y.tileID.canonical,S=new AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:x},{signal:S.signal})).then((function(A){return delete y.request,y.aborted?(y.state="unloaded",s(null)):A===void 0?(y.state="errored",s(null)):A===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",s(null)):function(L){return L instanceof ImageData||L instanceof HTMLCanvasElement||L instanceof ImageBitmap||L instanceof HTMLImageElement}(A)?(this.loadTileData(y,A),y.state="loaded",void s(null)):(y.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(A=>{A.name!=="AbortError"&&(y.state="errored",s(A))}),y.request.cancel=()=>S.abort()}loadTileData(y,s){y.setTexture(s,this.map.painter)}unloadTile(y,s){if(y.texture&&y.texture instanceof i.T?(y.destroy(!0),y.texture&&y.texture instanceof i.T&&this.map.painter.saveTileTexture(y.texture)):y.destroy(),this._implementation.unloadTile){const{x:u,y:g,z:x}=y.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:x})}s&&s()}abortTile(y,s){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){const y=i.C(this.id,this.scope);this.map.style.clearSource(y)}_update(){this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}}},qy=function(y,s,u,g){const x=new rb[s.type](y,s,u,g);if(x.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${x.id}`);return i.aQ(["load","abort","unload","serialize","prepare"],x),x};function Pm(y,s,u=""){return`${u}:${s.id||""}:${s.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:x,importId:S}=g;return`featureset:${x}${S?`:import:${S}`:""}`}}(y.target)}`}function nf(y,s,u,g=""){if(y.uniqueFeatureID){const x=Pm(y,s,g);if(u.has(x))return!0;u.add(x)}return!1}function nb(y,s,u,g,x=!1){const S=s.sourceCache.transform,A=s.sourceCache.tilesIn(y,s.has3DLayers,x);A.sort(ib);const L=[];for(const z of A){const B=z.tile.queryRenderedFeatures(s,z,u,g,S,x);Object.keys(B).length&&L.push({wrappedTileID:z.tile.tileID.wrapped().key,queryResults:B})}return L.length===0?{}:function(z){const B={},V={};for(const X of z){const Y=X.queryResults,re=X.wrappedTileID,ce=V[re]=V[re]||{};for(const ae in Y){const fe=Y[ae],me=ce[ae]=ce[ae]||{},be=B[ae]=B[ae]||[];for(const Ee of fe)me[Ee.featureIndex]||(me[Ee.featureIndex]=!0,be.push(Ee))}}return B}(L)}function UE(y,s,u,g,x){const S={},A=g.queryRenderedSymbols(y),L=[];for(const z of Object.keys(A).map(Number))L.push(x[z]);L.sort(ib);for(const z of L){const B=z.featureIndex.lookupSymbolFeatures(A[z.bucketInstanceId],z.bucketIndex,z.sourceLayerIndex,s,u);for(const V in B){const X=S[V]=S[V]||[],Y=B[V];Y.sort((re,ce)=>{const ae=z.featureSortOrder;if(ae){const fe=ae.indexOf(re.featureIndex);return ae.indexOf(ce.featureIndex)-fe}return ce.featureIndex-re.featureIndex});for(const re of Y)X.push(re)}}return S}function VE(y,s){const u=y.getRenderableIds().map(S=>y.getTileByID(S)),g=[],x={};for(let S=0;S<u.length;S++){const A=u[S],L=A.tileID.canonical.key;x[L]||(x[L]=!0,A.querySourceFeatures(g,s))}return g}function ib(y,s){const u=y.tileID,g=s.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function of(y,s){const u={};if(!s)return u;for(const g of y){const x=g.layerIds.map(S=>s.getLayer(S)).filter(Boolean);if(x.length!==0){g.layers=x,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(S=>x.filter(A=>A.id===S)[0]));for(const S of x)u[S.fqid]=g}}return u}const cs=32,_l=33,Bu=new Uint16Array(8184);for(let y=0;y<2046;y++){let s=y+2,u=0,g=0,x=0,S=0,A=0,L=0;for(1&s?x=S=A=cs:u=g=L=cs;(s>>=1)>1;){const B=u+x>>1,V=g+S>>1;1&s?(x=u,S=g,u=A,g=L):(u=x,g=S,x=A,S=L),A=B,L=V}const z=4*y;Bu[z+0]=u,Bu[z+1]=g,Bu[z+2]=x,Bu[z+3]=S}const us=new Uint16Array(2178),Ua=new Uint8Array(1089),af=new Uint16Array(1089);function ob(y){return y===0?-.03125:y===32?.03125:0}const Hy={type:2,extent:i.ai,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ai+1,0),new i.P(i.ai+1,i.ai+1),new i.P(0,i.ai+1),new i.P(0,0)]]};class xl{constructor(s,u,g,x,S){this.tileID=s,this.uid=i.aW(),this.uses=0,this.tileSize=u,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(s){const u=s+this.timeAdded;u<i.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aR(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,u,g){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=of(s.buckets,u.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const S=this.buckets[x];if(S instanceof i.aY){if(this.hasSymbolBuckets=!0,!g)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const S=this.buckets[x];if(S instanceof i.aY&&S.hasRTLText){this.hasRTLText=!0,i.aZ();break}}this.queryPadding=0;for(const x in this.buckets){const S=this.buckets[x],A=u.style.getOwnLayer(x);if(!A)continue;const L=A.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,L)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new i.aX}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,u,g){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,of(s.buckets,u.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const x in this.buckets){const S=this.buckets[x];S.uploadPending()&&S.upload(s)}const u=s.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new i.T(s,g.image,u.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(s,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(s,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(s,u,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,g),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=u.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(s,u,g,x,S,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const L=function(z,B){const V=i.ad.mat4.fromScaling([],[.5*z.width,.5*-z.height,1]);return i.ad.mat4.translate(V,V,[1,-1,0]),i.ad.mat4.multiply(V,V,z.calculateProjMatrix(B.toUnwrapped())),Float32Array.from(V)}(S,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:u,pixelPosMatrix:L,transform:x,availableImages:g,tileTransform:this.tileTransform})}querySourceFeatures(s,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),S=u?u.sourceLayer:"",A=x._geojsonTileLayer||x[S];if(!A)return;const L=i.a_(u&&u.filter),{z,x:B,y:V}=this.tileID.canonical,X={z,x:B,y:V};for(let Y=0;Y<A.length;Y++){const re=A.feature(Y);if(L.needGeometry){const fe=i.a$(re,!0);if(!L.filter(new i.aa(this.tileID.overscaledZ),fe,this.tileID.canonical))continue}else if(!L.filter(new i.aa(this.tileID.overscaledZ),re))continue;const ce=g.getId(re,S),ae=new i.b0(re,z,B,V,ce);ae.tile=X,s.push(ae)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const u=this.expirationTime;if(s.cacheControl){const g=i.b1(s.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(u)if(this.expirationTime<u)x=!0;else{const S=this.expirationTime-u;S?this.expirationTime=g+Math.max(S,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,u){if(!this.latestFeatureIndex||!s.style)return;const g=this.latestFeatureIndex.loadVTLayers(),x=s.style.listImages(),S=s.style.getBrightness();for(const A in this.buckets){if(!s.style.hasLayer(A))continue;const L=this.buckets[A],z=L.layers[0],B=z.sourceLayer||"_geojsonTileLayer",V=g[B],X=s.style.getLayerSourceCache(z);let Y={};X&&(Y=X._state.getState(B,void 0));const re=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ce=Object.keys(Y).length>0&&!u;ce&&!L.stateDependentLayers.length&&!u||L.update(Y,V,x,re,ce?L.stateDependentLayers:L.layers,u,S),(L instanceof i.b2||L instanceof i.b3)&&s._terrain&&s._terrain.enabled&&X&&L.uploadPending()&&s._terrain._clearRenderCacheForTile(X.id,this.tileID);const ae=s&&s.style&&s.style.getOwnLayer(A);ae&&(this.queryPadding=Math.max(this.queryPadding,ae.queryRadius(L)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=i.q.now()+s}setTexture(s,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s):(this.texture=new i.T(g,s,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(s,u){const g={};for(const x of u)g[x]=!0;this.dependencies[s]=g}hasDependency(s,u){for(const g of s){const x=this.dependencies[g];if(x){for(const S of u)if(x[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const g=i.b4(Hy,this.tileID.canonical,this.tileTransform)[0],x=new i.b5,S=new i.b6;for(let A=0;A<g.length;A++){const{x:L,y:z}=g[A];x.emplaceBack(L,z),S.emplaceBack(A)}S.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(S),this._tileDebugBuffer=s.createVertexBuffer(x,i.b7.members),this._tileDebugSegments=i.b8.simpleSegment(0,0,x.length,S.length)}_makeTileBoundsBuffers(s,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const g=i.b4(Hy,this.tileID.canonical,this.tileTransform)[0];let x,S;if(this.isRaster){const A=function(L,z){const B=i.aR(L,z),V=Math.pow(2,L.z);for(let fe=0;fe<_l;fe++)for(let me=0;me<_l;me++){const be=i.aS((L.x+(me+ob(me))/cs)/V),Ee=i.aT((L.y+(fe+ob(fe))/cs)/V),Te=z.project(be,Ee),Oe=fe*_l+me;us[2*Oe+0]=Math.round((Te.x*B.scale-B.x)*i.ai),us[2*Oe+1]=Math.round((Te.y*B.scale-B.y)*i.ai)}Ua.fill(0),af.fill(0);for(let fe=2045;fe>=0;fe--){const me=4*fe,be=Bu[me+0],Ee=Bu[me+1],Te=Bu[me+2],Oe=Bu[me+3],Me=be+Te>>1,Ce=Ee+Oe>>1,Pe=Me+Ce-Ee,Ne=Ce+be-Me,Ue=Ee*_l+be,dt=Oe*_l+Te,et=Ce*_l+Me,wt=Math.hypot((us[2*Ue+0]+us[2*dt+0])/2-us[2*et+0],(us[2*Ue+1]+us[2*dt+1])/2-us[2*et+1])>=16;Ua[et]=Ua[et]||(wt?1:0),fe<1022&&(Ua[et]=Ua[et]||Ua[(Ee+Ne>>1)*_l+(be+Pe>>1)]||Ua[(Oe+Ne>>1)*_l+(Te+Pe>>1)])}const X=new i.aU,Y=new i.aV;let re=0;function ce(fe,me){const be=me*_l+fe;return af[be]===0&&(X.emplaceBack(us[2*be+0],us[2*be+1],fe*i.ai/cs,me*i.ai/cs),af[be]=++re),af[be]-1}function ae(fe,me,be,Ee,Te,Oe){const Me=fe+be>>1,Ce=me+Ee>>1;if(Math.abs(fe-Te)+Math.abs(me-Oe)>1&&Ua[Ce*_l+Me])ae(Te,Oe,fe,me,Me,Ce),ae(be,Ee,Te,Oe,Me,Ce);else{const Pe=ce(fe,me),Ne=ce(be,Ee),Ue=ce(Te,Oe);Y.emplaceBack(Pe,Ne,Ue)}}return ae(0,0,cs,cs,cs,0),ae(cs,cs,0,0,0,cs),{vertices:X,indices:Y}}(this.tileID.canonical,u);x=A.vertices,S=A.indices}else{x=new i.aU,S=new i.aV;for(const{x:L,y:z}of g)x.emplaceBack(L,z,0,0);const A=i.b9(x.int16,void 0,4);for(let L=0;L<A.length;L+=3)S.emplaceBack(A[L],A[L+1],A[L+2])}this._tileBoundsBuffer=s.createVertexBuffer(x,i.ba.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(S),this._tileBoundsSegments=i.b8.simpleSegment(0,0,x.length,S.length)}_makeGlobeTileDebugBuffers(s,u){const g=u.projection;if(!g||g.name!=="globe"||u.freezeTileCoverage)return;const x=this.tileID.canonical,S=i.bb(x,u),A=i.bc(S),L=i.ag(u.zoom);let z;L>0&&(z=i.ad.mat4.invert(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,x,u,A,z,L),this._makeGlobeTileDebugTextBuffer(s,x,u,A,z,L)}_globePoint(s,u,g,x,S,A,L){let z=i.bd(s,u,g);if(A){const B=1<<g.z,V=i.av(x.center.lng),X=i.aC(x.center.lat),Y=(g.x+.5)/B-V;let re=0;Y>.5?re=-1:Y<-.5&&(re=1);let ce=(s/i.ai+g.x)/B+re,ae=(u/i.ai+g.y)/B;ce=(ce-V)*x._pixelsPerMercatorPixel+V,ae=(ae-X)*x._pixelsPerMercatorPixel+X;const fe=[ce*x.worldSize,ae*x.worldSize,0];i.ad.vec3.transformMat4(fe,fe,A),z=i.be(z,fe,L)}return i.ad.vec3.transformMat4(z,z,S)}_makeGlobeTileDebugBorderBuffer(s,u,g,x,S,A){const L=new i.b5,z=new i.b6,B=new i.bf,V=(Y,re,ce,ae,fe)=>{const me=(ce-Y)/(fe-1),be=(ae-re)/(fe-1),Ee=L.length;for(let Te=0;Te<fe;Te++){const Oe=Y+Te*me,Me=re+Te*be;L.emplaceBack(Oe,Me);const Ce=this._globePoint(Oe,Me,u,g,x,S,A);B.emplaceBack(Ce[0],Ce[1],Ce[2]),z.emplaceBack(Ee+Te)}},X=i.ai;V(0,0,X,0,16),V(X,0,X,X,16),V(X,X,0,X,16),V(0,X,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(z),this._tileDebugBuffer=s.createVertexBuffer(L,i.b7.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(B,i.bg.members),this._tileDebugSegments=i.b8.simpleSegment(0,0,L.length,z.length)}_makeGlobeTileDebugTextBuffer(s,u,g,x,S,A){const L=i.ai/4,z=new i.b5,B=new i.aV,V=new i.bf,X=25;B.reserve(32),z.reserve(X),V.reserve(X);const Y=(re,ce)=>X*re+ce;for(let re=0;re<X;re++){const ce=re*L;for(let ae=0;ae<X;ae++){const fe=ae*L;z.emplaceBack(fe,ce);const me=this._globePoint(fe,ce,u,g,x,S,A);V.emplaceBack(me[0],me[1],me[2])}}for(let re=0;re<4;re++)for(let ce=0;ce<4;ce++){const ae=Y(re,ce),fe=Y(re,ce+1),me=Y(re+1,ce),be=Y(re+1,ce+1);B.emplaceBack(ae,fe,me),B.emplaceBack(me,fe,be)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(B),this._tileDebugTextBuffer=s.createVertexBuffer(z,i.b7.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(V,i.bg.members),this._tileDebugTextSegments=i.b8.simpleSegment(0,0,X,32)}destroy(s=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bh.setPbf(i.bi);class Oa extends xl{constructor(s,u,g,x,S){super(s,u,g,x,S),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexture(s,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s,{premultiply:!1}):this.texture=new i.T(g,s,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,u){const g=this._mrt=new i.bh(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=i.bj(x,(S,A,L,z)=>{if(S)u(S);else try{const B=g.getHeaderLength(A);if(B>s)return void(this.request=this.fetchHeader(B,u));g.parseHeader(A),this._isHeaderLoaded=!0;let V=0;for(const X of Object.values(g.layers))V=Math.max(V,X.dataIndex[X.dataIndex.length-1].lastByte);A.byteLength>=V&&(this.entireBuffer=A),u(null,this.entireBuffer||A,L,z)}catch(B){u(B)}}),this.request}fetchBand(s,u,g){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void g(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void g(new Error("Can't fetch tile band without an actor"));let A;const L=(X,Y)=>{A.complete(X,Y),X?g(X):(this.updateTextureDescriptor(s,u),g(null,this.textureDescriptor&&this.textureDescriptor.img))},z=(X,Y)=>{if(X)return g(X);const re=S.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Y,task:A},L,void 0,!0);this._workQueue.push(()=>{re&&re.cancel(),A.cancel()})},B=x.getLayer(s);if(!B)return void g(new Error(`Unknown sourceLayer "${s}"`));if(B.hasDataForBand(u))return this.updateTextureDescriptor(s,u),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const V=B.getDataRange([u]);if(A=x.createDecodingTask(V),!A||A.tasks.length)if(this.flushQueues(),this.entireBuffer)z(null,this.entireBuffer.slice(V.firstByte,V.lastByte+1));else{const X=Object.assign({},this.requestParams,{headers:{Range:`bytes=${V.firstByte}-${V.lastByte}`}}),Y=i.bj(X,z);this._fetchQueue.push(()=>{Y.cancel(),A.cancel()})}else g(null)}updateNeeded(s,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,u){if(!this._mrt)return;const g=this._mrt.getLayer(s);if(!g||!g.hasBand(u)||!g.hasDataForBand(u))return;const{bytes:x,tileSize:S,buffer:A,offset:L,scale:z}=g.getBandView(u),B=S+2*A,V=new i.r({width:B,height:B},x),X=this.texture;X&&X instanceof i.T&&X.update(V,{premultiply:!1}),this.textureDescriptor={layer:s,band:u,img:V,buffer:A,offset:L,tileSize:S,format:g.pixelFormat,mix:[z,256*z,65536*z,16777216*z]}}}class WE{constructor(s,u){this.max=s,this.onRemove=u,this.reset()}reset(){for(const s in this.data)for(const u of this.data[s])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(s,u,g){const x=s.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const S={value:u,timeout:void 0};if(g!==void 0&&(S.timeout=setTimeout(()=>{this.remove(s,S)},g)),this.data[x].push(S),this.order.push(x),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const u=this.data[s].shift();return u.timeout&&clearTimeout(u.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),u.value}getByKey(s){const u=this.data[s];return u?u[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,u){if(!this.has(s))return this;const g=s.wrapped().key,x=u===void 0?0:this.data[g].indexOf(u),S=this.data[g][x];return this.data[g].splice(x,1),S.timeout&&clearTimeout(S.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(S.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(s){const u=[];for(const g in this.data)for(const x of this.data[g])s(x.value)||u.push(x);for(const g of u)this.remove(g.value.tileID,g)}}class ab{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,u,g){const x=String(u);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][x]=this.stateChanges[s][x]||{},i.l(this.stateChanges[s][x],g),this.deletedStates[s]===null){this.deletedStates[s]={};for(const S in this.state[s])S!==x&&(this.deletedStates[s][S]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][x]===null){this.deletedStates[s][x]={};for(const S in this.state[s][x])g[S]||(this.deletedStates[s][x][S]=null)}else for(const S in g)this.deletedStates[s]&&this.deletedStates[s][x]&&this.deletedStates[s][x][S]===null&&delete this.deletedStates[s][x][S]}removeFeatureState(s,u,g){if(this.deletedStates[s]===null)return;const x=String(u);if(this.deletedStates[s]=this.deletedStates[s]||{},g&&u!==void 0)this.deletedStates[s][x]!==null&&(this.deletedStates[s][x]=this.deletedStates[s][x]||{},this.deletedStates[s][x][g]=null);else if(u!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][x])for(g in this.deletedStates[s][x]={},this.stateChanges[s][x])this.deletedStates[s][x][g]=null;else this.deletedStates[s][x]=null;else this.deletedStates[s]=null}getState(s,u){const g=this.state[s]||{},x=this.stateChanges[s]||{},S=this.deletedStates[s];if(S===null)return{};if(u!==void 0){const L=String(u),z=i.l({},g[L],x[L]);if(S){const B=S[u];if(B===null)return{};for(const V in B)delete z[V]}return z}const A=i.l({},g,x);if(S)for(const L in S)delete A[L];return A}initializeTileState(s,u){s.refreshFeatureState(u)}coalesceChanges(s,u){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const S={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),i.l(this.state[x][A],this.stateChanges[x][A]),S[A]=this.state[x][A];g[x]=S}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const S={};if(this.deletedStates[x]===null)for(const A in this.state[x])S[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else if(this.state[x][A])for(const L of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][L];S[A]=this.state[x][A]}g[x]=g[x]||{},i.l(g[x],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in s)s[x].refreshFeatureState(u)}}class js extends i.E{constructor(s,u,g){super(),this.id=s,this._onlySymbols=g,u.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new WE(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ab,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,u){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,u)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(s),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(An).map(s=>s.key)}getRenderableIds(s,u){const g=[];for(const x in this._tiles)this._isIdRenderable(+x,s,u)&&g.push(this._tiles[x]);return s?g.sort((x,S)=>{const A=x.tileID,L=S.tileID,z=new i.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),B=new i.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-L.overscaledZ||B.y-z.y||B.x-z.x}).map(x=>x.tileID.key):g.map(x=>x.tileID).sort(An).map(x=>x.key)}hasRenderableParent(s){const u=this.findLoadedParent(s,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(s,u,g){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(u||!this._tiles[s].holdingForFade())&&(g||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,u){const g=this._tiles[s];g&&(g.state!=="loading"&&(g.state=u),this._loadTile(g,this._tileLoaded.bind(this,g,s,u)))}_tileLoaded(s,u,g,x){if(x)if(s.state="errored",x.status!==404)this._source.fire(new i.z(x,{tile:s}));else{if(this._source.fire(new i.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const S=this.map.painter.terrain;this.update(this.transform,S.getScaledDemTileSize(),!0),S.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=i.q.now(),g==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(u,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new i.A("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const u=this.getRenderableIds();for(let x=0;x<u.length;x++){const S=u[x];if(s.neighboringTiles&&s.neighboringTiles[S]){const A=this.getTileByID(S);g(s,A),g(A,s)}}function g(x,S){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let A=S.tileID.canonical.x-x.tileID.canonical.x;const L=S.tileID.canonical.y-x.tileID.canonical.y,z=Math.pow(2,x.tileID.canonical.z),B=S.tileID.key;A===0&&L===0||Math.abs(L)>1||(Math.abs(A)>1&&(Math.abs(A+z)===1?A+=z:Math.abs(A-z)===1&&(A-=z)),S.dem&&x.dem&&(x.dem.backfillBorder(S.dem,A,L),x.neighboringTiles&&x.neighboringTiles[B]&&(x.neighboringTiles[B].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,u,g,x){for(const S in this._tiles){let A=this._tiles[S];if(x[S]||!A.hasData()||A.tileID.overscaledZ<=u||A.tileID.overscaledZ>g)continue;let L=A.tileID;for(;A&&A.tileID.overscaledZ>u+1;){const B=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[B.key],A&&A.hasData()&&(L=B)}let z=L;for(;z.overscaledZ>u;)if(z=z.scaledTo(z.overscaledZ-1),s[z.key]){x[L.key]=L;break}}}findLoadedParent(s,u){if(s.key in this._loadedParentTiles){const g=this._loadedParentTiles[s.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=s.overscaledZ-1;g>=u;g--){const x=s.scaledTo(g),S=this._getLoadedTile(x);if(S)return S}}_getLoadedTile(s){const u=this._tiles[s.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,u){u=u||this._source.tileSize;const g=Math.ceil(s.width/u)+1,x=Math.ceil(s.height/u)+1,S=Math.floor(g*x*5),A=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(L)}handleWrapJump(s){const u=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,u){const g={};for(const x in this._tiles){const S=this._tiles[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),g[S.tileID.key]=S}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(s,u,g,x){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(s,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let A,L=this._source.maxzoom;const z=this.map&&this.map.painter?this.map.painter._terrain:null;if(z&&z.sourceCache===this&&z.attenuationRange()){const X=z.attenuationRange()[0],Y=Math.floor(X)-Math.log2(z.getDemUpscale());L>Y&&(L=Y)}if(this.used||this.usedForTerrain){if(this._source.tileID)A=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(X=>new i.aH(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y));else if(this.tileCoverLift!==0){const X=s.clone();X.tileCoverLift=this.tileCoverLift,A=X.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&s.projection.name==="globe"&&(A.push(new i.aH(1,0,1,0,0)),A.push(new i.aH(1,0,1,1,0)),A.push(new i.aH(1,0,1,0,1)),A.push(new i.aH(1,0,1,1,1)))}else if(A=s.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const X=this._source.hasTile.bind(this._source);A=A.filter(Y=>X(Y))}}else A=[];if(A.length>0&&this.castsShadows&&x&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!sb(this._source.type)){const X=s.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),Y=Math.min(X,this._source.maxzoom);if(S){const re=s.extendTileCover(A,Y);for(const ce of re)A.push(ce)}else{const re=s.extendTileCover(A,Y,x);for(const ce of re)this._shadowCasterTiles[ce.key]=!0,A.push(ce)}}const B=this._updateRetainedTiles(A);if(sb(this._source.type)&&A.length!==0){const X={},Y={},re=Object.keys(B);for(const ae of re){const fe=B[ae],me=this._tiles[ae];if(!me||me.fadeEndTime&&me.fadeEndTime<=i.q.now())continue;const be=this.findLoadedParent(fe,Math.max(fe.overscaledZ-js.maxOverzooming,this._source.minzoom));be&&(this._addTile(be.tileID),X[be.tileID.key]=be.tileID),Y[ae]=fe}const ce=A[A.length-1].overscaledZ;for(const ae in this._tiles){const fe=this._tiles[ae];if(B[ae]||!fe.hasData())continue;let me=fe.tileID;for(;me.overscaledZ>ce;){me=me.scaledTo(me.overscaledZ-1);const be=this._tiles[me.key];if(be&&be.hasData()&&Y[me.key]){B[ae]=fe.tileID;break}}}for(const ae in X)B[ae]||(this._coveredTiles[ae]=!0,B[ae]=X[ae])}for(const X in B)this._tiles[X].clearFadeHold();const V=i.bk(this._tiles,B);for(const X of V){const Y=this._tiles[X];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(+X)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const u={};if(s.length===0)return u;const g={},x=s.reduce((B,V)=>Math.min(B,V.overscaledZ),1/0),S=s[0].overscaledZ,A=Math.max(S-js.maxOverzooming,this._source.minzoom),L=Math.max(S+js.maxUnderzooming,this._source.minzoom),z={};for(const B of s){const V=this._addTile(B);u[B.key]=B,V.hasData()||x<this._source.maxzoom&&(z[B.key]=B)}this._retainLoadedChildren(z,x,L,u);for(const B of s){let V=this._tiles[B.key];if(V.hasData())continue;if(B.canonical.z>=this._source.maxzoom){const Y=B.children(this._source.maxzoom)[0],re=this.getTile(Y);if(re&&re.hasData()){u[Y.key]=Y;continue}}else{const Y=B.children(this._source.maxzoom);if(u[Y[0].key]&&u[Y[1].key]&&u[Y[2].key]&&u[Y[3].key])continue}let X=V.wasRequested();for(let Y=B.overscaledZ-1;Y>=A;--Y){const re=B.scaledTo(Y);if(g[re.key]||(g[re.key]=!0,V=this.getTile(re),!V&&X&&(V=this._addTile(re)),V&&(u[re.key]=re,X=V.wasRequested(),V.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const u=[];let g,x=this._tiles[s].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}u.push(x.key);const S=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(S),g)break;x=S}for(const S of u)this._loadedParentTiles[S]=g}}_addTile(s){let u=this._tiles[s.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),u;u=this._cache.getAndRemove(s),u&&(this._setTileReloadTimer(s.key,u),u.tileID=s,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,u)));const g=!!u;if(!g){const x=this.map?this.map.painter:null,S=this._source.tileSize*s.overscaleFactor();u=this._source.type==="raster-array"?new Oa(s,S,this.transform.tileZoom,x,this._isRaster):new xl(s,S,this.transform.tileZoom,x,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,s.key,u.state))}return u?(u.uses++,this._tiles[s.key]=u,g||this._source.fire(new i.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(s,u){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const g=u.getExpiryTimeout();g&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},g))}_removeTile(s){const u=this._tiles[s];u&&(u.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,u,g){const x=[],S=this.transform;if(!S)return x;const A=S.projection.name==="globe",L=i.av(S.center.lng);for(const z in this._tiles){const B=this._tiles[z];if(g&&B.clearQueryDebugViz(),B.holdingForFade())continue;let V;if(A){const X=B.tileID.canonical;if(X.z===0){const Y=[Math.abs(i.ay(L,..._r(X,-1))-L),Math.abs(i.ay(L,..._r(X,1))-L)];V=[0,2*Y.indexOf(Math.min(...Y))-1]}else{const Y=[Math.abs(i.ay(L,..._r(X,-1))-L),Math.abs(i.ay(L,..._r(X,0))-L),Math.abs(i.ay(L,..._r(X,1))-L)];V=[Y.indexOf(Math.min(...Y))-1]}}else V=[0];for(const X of V){const Y=s.containsTile(B,S,u,X);Y&&x.push(Y)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,u){const g=this.getRenderableIds(s,u).map(S=>this._tiles[S].tileID),x=this.transform.projection.name==="globe";for(const S of g)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=x?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return g}sortCoordinatesByDistance(s){const u=s.slice(),g=this.transform._camera.position,x=this.transform._camera.forward(),S={};for(const A of u){const L=1/(1<<A.canonical.z);S[A.key]=((A.canonical.x+.5)*L+A.wrap-g[0])*x[0]+((A.canonical.y+.5)*L-g[1])*x[1]-g[2]*x[2]}return u.sort((A,L)=>S[A.key]-S[L.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(sb(this._source.type))for(const s in this._tiles){const u=this._tiles[s];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(s,u,g){this._state.updateState(s=s||"_geojsonTileLayer",u,g)}removeFeatureState(s,u,g){this._state.removeFeatureState(s=s||"_geojsonTileLayer",u,g)}getFeatureState(s,u){return this._state.getState(s=s||"_geojsonTileLayer",u)}setDependencies(s,u,g){const x=this._tiles[s];x&&x.setDependencies(u,g)}reloadTilesForDependencies(s,u){for(const g in this._tiles)this._tiles[g].hasDependency(s,u)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(s,u))}_preloadTiles(s,u){if(!this._sourceLoaded){const z=()=>{this._sourceLoaded&&(this._source.off("data",z),this._preloadTiles(s,u))};return void this._source.on("data",z)}const g=new Map,x=Array.isArray(s)?s:[s],S=this.map.painter.terrain,A=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const z of x){const B=z.coveringTiles({tileSize:A,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const V of B)g.set(V.key,V);this.usedForTerrain&&z.updateElevation(!1)}const L=Array.from(g.values());i.bl(L,(z,B)=>{const V=new xl(z,this._source.tileSize*z.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(V,X=>{this._source.type==="raster-dem"&&V.dem&&this._backfillDEM(V),B(X,V)})},u)}}function An(y,s){const u=Math.abs(2*y.wrap)-+(y.wrap<0),g=Math.abs(2*s.wrap)-+(s.wrap<0);return y.overscaledZ-s.overscaledZ||g-u||s.canonical.y-y.canonical.y||s.canonical.x-y.canonical.x}function sb(y){return y==="raster"||y==="image"||y==="video"||y==="custom"}function _r(y,s){const u=1<<y.z;return[y.x/u+s,(y.x+1)/u+s]}js.maxOverzooming=10,js.maxUnderzooming=3;class GE{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,u=!1;for(const g in this.style._mergedLayers){const x=this.style._mergedLayers[g];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:s,visibilityChanged:u});else if(x.type==="model"){const S=this.style.getLayerSource(x);S&&S.type==="batched-model"&&this.layers.push({layer:x,visible:s,visibilityChanged:u})}}}onNewFrame(s){this.layersGotHidden=!1;for(const u of this.layers){const g=u.layer;let x=!1;g.type==="fill-extrusion"?x=!g.isHidden(s)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="model"&&(x=!g.isHidden(s)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&u.visible,u.visible=x}}updateZOffset(s,u){this.currentBuildingBuckets=[];for(const x of this.layers){const S=x.layer,A=this.style.getLayerSourceCache(S);let L=1;S.type==="fill-extrusion"&&(L=x.visible?S.paint.get("fill-extrusion-vertical-scale"):0);let z=A?A.getTile(u):null;if(!z&&A&&u.canonical.z>A.getSource().minzoom){let B=u.scaledTo(Math.min(A.getSource().maxzoom,u.overscaledZ-1));for(;B.overscaledZ>=A.getSource().minzoom&&(z=A.getTile(B),!z&&B.overscaledZ!==0);)B=B.scaledTo(B.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:z?z.getBucket(S):null,tileID:z?z.tileID:u,verticalScale:L})}s.hasAnyZOffset=!1;let g=!1;for(let x=0;x<s.symbolInstances.length;x++){const S=s.symbolInstances.get(x),A=S.zOffset,L=this._getHeightAtTileOffset(u,S.tileAnchorX,S.tileAnchorY);S.zOffset=L!==Number.NEGATIVE_INFINITY?L:A,g||A===S.zOffset||(g=!0),s.hasAnyZOffset||S.zOffset===0||(s.hasAnyZOffset=!0)}g&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,u,g,x){let S=u,A=g;if(s.canonical.z!==x.canonical.z){const L=x.canonical,z=1/(1<<s.canonical.z-L.z);S=(u+s.canonical.x*i.ai)*z-L.x*i.ai|0,A=(g+s.canonical.y*i.ai)*z-L.y*i.ai|0}return{tileX:S,tileY:A}}_getHeightAtTileOffset(s,u,g){let x,S;for(let A=0;A<this.layers.length;++A){if(this.layers[A].layer.type!=="fill-extrusion")continue;const{bucket:L,tileID:z,verticalScale:B}=this.currentBuildingBuckets[A];if(!L)continue;const{tileX:V,tileY:X}=this._mapCoordToOverlappingTile(s,u,g,z),Y=L.getHeightAtTileCoord(V,X);Y&&Y.height!==void 0&&(Y.hidden?x=Y.height:S=Math.max(Y.height*B,S||0))}if(S!==void 0)return S;for(let A=0;A<this.layers.length;++A){const L=this.layers[A];if(L.layer.type!=="model"||!L.visible)continue;const{bucket:z,tileID:B}=this.currentBuildingBuckets[A];if(!z)continue;const{tileX:V,tileY:X}=this._mapCoordToOverlappingTile(s,u,g,B),Y=z.getHeightAtTileCoord(V,X);if(Y&&!Y.hidden)return Y.height===void 0&&x!==void 0?Math.min(Y.maxHeight,x)*Y.verticalScale:Y.height?Y.height*Y.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function qE(y,s){const u={};for(const g in y)g!=="ref"&&(u[g]=y[g]);return i.bm.forEach(g=>{g in s&&(u[g]=s[g])}),u}function Im(y){y=y.slice();const s=Object.create(null);for(let u=0;u<y.length;u++)s[y[u].id]=y[u];for(let u=0;u<y.length;u++)"ref"in y[u]&&(y[u]=qE(y[u],s[y[u].ref]));return y}const fn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Fs(y,s,u){u.push({command:fn.addSource,args:[y,s[y]]})}function Zy(y,s,u){s.push({command:fn.removeSource,args:[y]}),u[y]=!0}function sf(y,s,u,g){Zy(y,u,g),Fs(y,s,u)}function ar(y,s,u){let g;for(g in y[u])if(y[u].hasOwnProperty(g)&&g!=="data"&&!i.bn(y[u][g],s[u][g]))return!1;for(g in s[u])if(s[u].hasOwnProperty(g)&&g!=="data"&&!i.bn(y[u][g],s[u][g]))return!1;return!0}function wn(y,s,u,g,x,S){let A;for(A in s=s||{},y=y||{})y.hasOwnProperty(A)&&(i.bn(y[A],s[A])||u.push({command:S,args:[g,A,s[A],x]}));for(A in s)s.hasOwnProperty(A)&&!y.hasOwnProperty(A)&&(i.bn(y[A],s[A])||u.push({command:S,args:[g,A,s[A],x]}))}function ln(y){return y.id}function oa(y,s){return y[s.id]=s,y}class lf{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=i.ay(s,0,1);let u=1,g=this._distances[u];const x=s*this.paddedLength+this.padding;for(;g<x&&u<this._distances.length;)g=this._distances[++u];const S=u-1,A=this._distances[S],L=g-A,z=L>0?(x-A)/L:0;return this.points[S].mult(1-z).add(this.points[u].mult(z))}}class pn{constructor(s,u,g){const x=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(u/g);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,g,x,S){this._forEachCell(u,g,x,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(S)}insertCircle(s,u,g,x){this._forEachCell(u-x,g-x,u+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(g),this.circles.push(x)}_insertBoxCell(s,u,g,x,S,A){this.boxCells[S].push(A)}_insertCircleCell(s,u,g,x,S,A){this.circleCells[S].push(A)}_query(s,u,g,x,S,A){if(g<0||s>this.width||x<0||u>this.height)return!S&&[];const L=[];if(s<=0&&u<=0&&this.width<=g&&this.height<=x){if(S)return!0;for(let z=0;z<this.boxKeys.length;z++)L.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const B=this.circles[3*z],V=this.circles[3*z+1],X=this.circles[3*z+2];L.push({key:this.circleKeys[z],x1:B-X,y1:V-X,x2:B+X,y2:V+X})}return A?L.filter(A):L}return this._forEachCell(s,u,g,x,this._queryCell,L,{hitTest:S,seenUids:{box:{},circle:{}}},A),S?L.length>0:L}_queryCircle(s,u,g,x,S){const A=s-g,L=s+g,z=u-g,B=u+g;if(L<0||A>this.width||B<0||z>this.height)return!x&&[];const V=[];return this._forEachCell(A,z,L,B,this._queryCellCircle,V,{hitTest:x,circle:{x:s,y:u,radius:g},seenUids:{box:{},circle:{}}},S),x?V.length>0:V}query(s,u,g,x,S){return this._query(s,u,g,x,!1,S)}hitTest(s,u,g,x,S){return this._query(s,u,g,x,!0,S)}hitTestCircle(s,u,g,x){return this._queryCircle(s,u,g,!0,x)}_queryCell(s,u,g,x,S,A,L,z){const B=L.seenUids,V=this.boxCells[S];if(V!==null){const Y=this.bboxes;for(const re of V)if(!B.box[re]){B.box[re]=!0;const ce=4*re;if(s<=Y[ce+2]&&u<=Y[ce+3]&&g>=Y[ce+0]&&x>=Y[ce+1]&&(!z||z(this.boxKeys[re]))){if(L.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[re],x1:Y[ce],y1:Y[ce+1],x2:Y[ce+2],y2:Y[ce+3]})}}}const X=this.circleCells[S];if(X!==null){const Y=this.circles;for(const re of X)if(!B.circle[re]){B.circle[re]=!0;const ce=3*re;if(this._circleAndRectCollide(Y[ce],Y[ce+1],Y[ce+2],s,u,g,x)&&(!z||z(this.circleKeys[re]))){if(L.hitTest)return A.push(!0),!0;{const ae=Y[ce],fe=Y[ce+1],me=Y[ce+2];A.push({key:this.circleKeys[re],x1:ae-me,y1:fe-me,x2:ae+me,y2:fe+me})}}}}}_queryCellCircle(s,u,g,x,S,A,L,z){const B=L.circle,V=L.seenUids,X=this.boxCells[S];if(X!==null){const re=this.bboxes;for(const ce of X)if(!V.box[ce]){V.box[ce]=!0;const ae=4*ce;if(this._circleAndRectCollide(B.x,B.y,B.radius,re[ae+0],re[ae+1],re[ae+2],re[ae+3])&&(!z||z(this.boxKeys[ce])))return A.push(!0),!0}}const Y=this.circleCells[S];if(Y!==null){const re=this.circles;for(const ce of Y)if(!V.circle[ce]){V.circle[ce]=!0;const ae=3*ce;if(this._circlesCollide(re[ae],re[ae+1],re[ae+2],B.x,B.y,B.radius)&&(!z||z(this.circleKeys[ce])))return A.push(!0),!0}}}_forEachCell(s,u,g,x,S,A,L,z){const B=this._convertToXCellCoord(s),V=this._convertToYCellCoord(u),X=this._convertToXCellCoord(g),Y=this._convertToYCellCoord(x);for(let re=B;re<=X;re++)for(let ce=V;ce<=Y;ce++)if(S.call(this,s,u,g,x,this.xCellCount*ce+re,A,L,z))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,g,x,S,A){const L=x-s,z=S-u,B=g+A;return B*B>L*L+z*z}_circleAndRectCollide(s,u,g,x,S,A,L){const z=(A-x)/2,B=Math.abs(s-(x+z));if(B>z+g)return!1;const V=(L-S)/2,X=Math.abs(u-(S+V));if(X>V+g)return!1;if(B<=z||X<=V)return!0;const Y=B-z,re=X-V;return Y*Y+re*re<=g*g}}const Dc={unknown:0,flipRequired:1,flipNotRequired:2},Om=Math.tan(85*Math.PI/180);function Lc(y,s,u,g,x,S,A){const L=i.ad.mat4.create();if(u)if(S.name==="globe"){const z=i.bo(x,s);i.ad.mat4.multiply(L,L,z)}else{const z=i.ad.mat2.invert([],A);L[0]=z[0],L[1]=z[1],L[4]=z[2],L[5]=z[3],g||i.ad.mat4.rotateZ(L,L,x.angle)}else i.ad.mat4.multiply(L,x.labelPlaneMatrix,y);return L}function Zo(y,s,u,g,x,S,A){const L=Lc(y,s,u,g,x,S,A);return S.name==="globe"&&u||(L[2]=L[6]=L[10]=L[14]=0),L}function zi(y,s,u,g,x,S,A){if(u){if(S.name==="globe"){const L=Lc(y,s,u,g,x,S,A);return i.ad.mat4.invert(L,L),i.ad.mat4.multiply(L,y,L),L}{const L=i.ad.mat4.clone(y),z=i.ad.mat4.identity([]);return z[0]=A[0],z[1]=A[1],z[4]=A[2],z[5]=A[3],i.ad.mat4.multiply(L,L,z),g||i.ad.mat4.rotateZ(L,L,-x.angle),L}}return x.glCoordMatrix}function bl(y,s,u,g){const x=[y,s,u,1];u?i.ad.vec4.transformMat4(x,x,g):no(x,x,g);const S=x[3];return x[0]/=S,x[1]/=S,x[2]/=S,x}function cf(y,s){return Math.min(.5+y/s*.5,1.5)}function lb(y,s){const u=y[0]/y[3],g=y[1]/y[3];return u>=-s[0]&&u<=s[0]&&g>=-s[1]&&g<=s[1]}function uf(y,s,u,g,x,S,A,L,z,B){const V=u.transform,X=g?y.textSizeData:y.iconSizeData,Y=i.bp(X,u.transform.zoom),re=V.projection.name==="globe",ce=[256/u.width*2+1,256/u.height*2+1],ae=g?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ae.clear();let fe=null;re&&(fe=g?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const me=y.lineVertexArray,be=g?y.text.placedSymbolArray:y.icon.placedSymbolArray,Ee=u.transform.width/u.transform.height;let Te,Oe=!1;for(let Me=0;Me<be.length;Me++){const Ce=be.get(Me),{numGlyphs:Pe,writingMode:Ne}=Ce;if(Ne!==i.bq.vertical||Oe||Te===i.bq.horizontal||(Oe=!0),Te=Ne,(Ce.hidden||Ne===i.bq.vertical)&&!Oe){wl(Pe,ae);continue}Oe=!1;const Ue=new i.P(Ce.tileAnchorX,Ce.tileAnchorY);let{x:dt,y:et,z:wt}=V.projection.projectTilePoint(Ue.x,Ue.y,B.canonical);if(z){const[Wt,Ht,ir]=z(Ue);dt+=Wt,et+=Ht,wt+=ir}const Tt=[dt,et,wt,1];if(i.ad.vec4.transformMat4(Tt,Tt,s),!lb(Tt,ce)){wl(Pe,ae);continue}const Dt=Tt[3],Qe=cf(u.transform.getCameraToCenterDistance(V.projection),Dt),bt=i.br(X,Y,Ce),Ye=A?bt/Qe:bt*Qe,xt=bl(dt,et,wt,x);if(xt[3]<=0){wl(Pe,ae);continue}let gt={};const Et=i.ak(y.layers[0].layout.get("text-max-angle")),ht=Math.cos(Et),Mt=A?null:z,Vt=aa(Ce,Ye,!1,L,s,x,S,y.glyphOffsetArray,me,ae,fe,xt,Ue,gt,Ee,Mt,V.projection,B,A,ht);Oe=Vt.useVertical,Mt&&Vt.needsFlipping&&(gt={}),(Vt.notEnoughRoom||Oe||Vt.needsFlipping&&aa(Ce,Ye,!0,L,s,x,S,y.glyphOffsetArray,me,ae,fe,xt,Ue,gt,Ee,Mt,V.projection,B,A,ht).notEnoughRoom)&&wl(Pe,ae)}g?(y.text.dynamicLayoutVertexBuffer.updateData(ae),fe&&y.text.globeExtVertexBuffer&&y.text.globeExtVertexBuffer.updateData(fe)):(y.icon.dynamicLayoutVertexBuffer.updateData(ae),fe&&y.icon.globeExtVertexBuffer&&y.icon.globeExtVertexBuffer.updateData(fe))}function Xy(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe){const{lineStartIndex:me,glyphStartIndex:be,segment:Ee}=L,Te=be+L.numGlyphs,Oe=me+L.lineLength,Me=s.getoffsetX(be),Ce=s.getoffsetX(Te-1),Pe=Rm(y*Me,u,g,x,S,A,Ee,me,Oe,z,B,V,X,Y,!0,re,ce,ae,fe);if(!Pe)return null;const Ne=Rm(y*Ce,u,g,x,S,A,Ee,me,Oe,z,B,V,X,Y,!0,re,ce,ae,fe);return Ne?{first:Pe,last:Ne}:null}function km(y,s,u,g){return y===i.bq.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:y===i.bq.vertical?g>0?{needsFlipping:!0}:null:s!==Dc.unknown&&function(x,S){return x===0||Math.abs(S/x)>Om}(u,g)?s===Dc.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function aa(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me,be,Ee){const Te=s/24,Oe=y.lineOffsetX*Te,Me=y.lineOffsetY*Te,{lineStartIndex:Ce,glyphStartIndex:Pe,numGlyphs:Ne,segment:Ue,writingMode:dt,flipState:et}=y,wt=Ce+y.lineLength,Tt=Dt=>{if(V){const[xt,gt,Et]=Dt.up,ht=B.length;i.bs(V,ht+0,xt,gt,Et),i.bs(V,ht+1,xt,gt,Et),i.bs(V,ht+2,xt,gt,Et),i.bs(V,ht+3,xt,gt,Et)}const[Qe,bt,Ye]=Dt.point;i.bt(B,Qe,bt,Ye,Dt.angle)};if(Ne>1){const Dt=Xy(Te,L,Oe,Me,u,X,Y,y,z,S,re,ae,!1,fe,me,be,Ee);if(!Dt)return{notEnoughRoom:!0};if(g&&!u){let[Qe,bt,Ye]=Dt.first.point,[xt,gt,Et]=Dt.last.point;[Qe,bt]=bl(Qe,bt,Ye,A),[xt,gt]=bl(xt,gt,Et,A);const ht=km(dt,et,(xt-Qe)*ce,gt-bt);if(y.flipState=ht&&ht.needsFlipping?Dc.flipRequired:Dc.flipNotRequired,ht)return ht}Tt(Dt.first);for(let Qe=Pe+1;Qe<Pe+Ne-1;Qe++){const bt=Rm(Te*L.getoffsetX(Qe),Oe,Me,u,X,Y,Ue,Ce,wt,z,S,re,ae,!1,!1,fe,me,be,Ee);if(!bt)return B.length-=4*(Qe-Pe),{notEnoughRoom:!0};Tt(bt)}Tt(Dt.last)}else{if(g&&!u){const Qe=bl(Y.x,Y.y,0,x),bt=Ce+Ue+1,Ye=new i.P(z.getx(bt),z.gety(bt)),xt=bl(Ye.x,Ye.y,0,x),gt=xt[3]>0?xt:sa(Y,Ye,Qe,1,x,void 0,fe,me.canonical),Et=km(dt,et,(gt[0]-Qe[0])*ce,gt[1]-Qe[1]);if(y.flipState=Et&&Et.needsFlipping?Dc.flipRequired:Dc.flipNotRequired,Et)return Et}const Dt=Rm(Te*L.getoffsetX(Pe),Oe,Me,u,X,Y,Ue,Ce,wt,z,S,re,ae,!1,!1,fe,me,be,Ee);if(!Dt)return{notEnoughRoom:!0};Tt(Dt)}return{}}function tc(y,s,u,g,x){const{x:S,y:A,z:L}=g.projectTilePoint(y.x,y.y,s);if(!x)return bl(S,A,L,u);const[z,B,V]=x(y);return bl(S+z,A+B,L+V,u)}function sa(y,s,u,g,x,S,A,L){const z=tc(y.sub(s)._unit()._add(y),L,x,A,S);return i.ad.vec3.sub(z,u,z),i.ad.vec3.normalize(z,z),i.ad.vec3.scaleAndAdd(z,u,z,g)}function Rm(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me,be){const Ee=g?y-s:y+s;let Te=Ee>0?1:-1,Oe=0;g&&(Te*=-1,Oe=Math.PI),Te<0&&(Oe+=Math.PI);let Me=L+A+(Te>0?0:1)|0,Ce=x,Pe=x,Ne=0,Ue=0;const dt=Math.abs(Ee),et=[],wt=[];let Tt=S,Dt=Tt,Qe=i.ad.vec3.zero([]);const bt=()=>sa(Dt,Tt,Pe,dt-Ne+1,V,Y,ae,fe.canonical);for(;Ne+Ue<=dt;){if(Me+=Te,Me<L||Me>=z)return null;if(Pe=Ce,Dt=Tt,et.push(Pe),re&&wt.push(Dt),Tt=new i.P(B.getx(Me),B.gety(Me)),Ce=X[Me],!Ce){const ir=tc(Tt,fe.canonical,V,ae,Y);Ce=ir[3]>0?X[Me]=ir:bt()}Ne+=Ue;const Wt=i.ad.vec3.sub([],Ce,Pe),Ht=i.ad.vec3.distance(Pe,Ce);if(u&&Ht>0&&Ue>0&&i.ad.vec3.dot(Qe,Wt)/(Ue*Ht)<be)return null;Ue=Ht,Qe=Wt}ce&&Y&&(X[Me]&&(Ce=bt(),Ue=i.ad.vec3.distance(Pe,Ce),Qe=i.ad.vec3.sub([],Ce,Pe)),X[Me]=Ce);const Ye=(dt-Ne)/Ue,xt=Tt.sub(Dt)._mult(Ye)._add(Dt),gt=i.ad.vec3.scaleAndAdd([],Pe,Qe,Ye);let Et=[0,0,1],ht=Qe[0],Mt=Qe[1];if(me&&(Et=ae.upVector(fe.canonical,xt.x,xt.y),Et[0]!==0||Et[1]!==0||Et[2]!==1)){const Wt=[Et[2],0,-Et[0]],Ht=i.ad.vec3.cross([],Et,Wt);i.ad.vec3.normalize(Wt,Wt),i.ad.vec3.normalize(Ht,Ht),ht=i.ad.vec3.dot(Qe,Wt),Mt=i.ad.vec3.dot(Qe,Ht)}if(u){const Wt=i.ad.vec3.cross([],Et,Qe);i.ad.vec3.normalize(Wt,Wt),i.ad.vec3.scaleAndAdd(gt,gt,Wt,u*Te)}const Vt=Oe+Math.atan2(Mt,ht);return et.push(gt),re&&wt.push(xt),{point:gt,angle:Vt,path:et,tilePath:wt,up:Et}}function wl(y,s){const u=s.length,g=u+4*y;s.resize(g),s.float32.fill(-1/0,4*u,4*g)}function no(y,s,u){const g=s[0],x=s[1];return y[0]=u[0]*g+u[4]*x+u[12],y[1]=u[1]*g+u[5]*x+u[13],y[3]=u[3]*g+u[7]*x+u[15],y}const Oo=100;class Nc{constructor(s,u,g=new pn(s.width+200,s.height+200,25),x=new pn(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Oo,this.screenBottomBoundary=s.height+Oo,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=u}placeCollisionBox(s,u,g,x,S,A,L,z){let B=g.projectedAnchorX,V=g.projectedAnchorY,X=g.projectedAnchorZ;const Y=g.elevation,re=g.tileID,ce=s.getProjection();if(Y&&re){const[Me,Ce,Pe]=ce.upVector(re.canonical,g.tileAnchorX,g.tileAnchorY),Ne=ce.upVectorScale(re.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=Me*Y*Ne,V+=Ce*Y*Ne,X+=Pe*Y*Ne}const ae=this.projectAndGetPerspectiveRatio(L,B,V,X,g.tileID,ce.name==="globe"||!!Y||this.transform.pitch>0,ce),fe=A*ae.perspectiveRatio,me=(g.x1*u+x.x-g.padding)*fe+ae.point.x,be=(g.y1*u+x.y-g.padding)*fe+ae.point.y,Ee=(g.x2*u+x.x+g.padding)*fe+ae.point.x,Te=(g.y2*u+x.y+g.padding)*fe+ae.point.y,Oe=ae.perspectiveRatio<=.55||ae.occluded;return!this.isInsideGrid(me,be,Ee,Te)||!S&&this.grid.hitTest(me,be,Ee,Te,z)||Oe?{box:[],offscreen:!1,occluded:ae.occluded}:{box:[me,be,Ee,Te],offscreen:this.isOffscreen(me,be,Ee,Te),occluded:!1}}placeCollisionCircles(s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae){const fe=[],me=this.transform.elevation,be=s.getProjection(),Ee=me?me.getAtTileOffsetFunc(ae,this.transform.center.lat,this.transform.worldSize,be):null,Te=new i.P(g.tileAnchorX,g.tileAnchorY);let{x:Oe,y:Me,z:Ce}=be.projectTilePoint(Te.x,Te.y,ae.canonical);if(Ee){const[Et,ht,Mt]=Ee(Te);Oe+=Et,Me+=ht,Ce+=Mt}const Pe=be.name==="globe",Ne=this.projectAndGetPerspectiveRatio(L,Oe,Me,Ce,ae,Pe||!!me||this.transform.pitch>0,be),{perspectiveRatio:Ue}=Ne,dt=(X?A/Ue:A*Ue)/i.bw,et=bl(Oe,Me,Ce,z),wt=g.lineOffsetX*dt,Tt=g.lineOffsetY*dt,Dt=i.ak(s.layers[0].layout.get("text-max-angle")),Qe=Math.cos(Dt),bt=Ne.signedDistanceFromCamera>0?Xy(dt,S,wt,Tt,!1,et,Te,g,x,z,{},me&&!X?Ee:null,X&&!!me,be,ae,X,Qe):null;let Ye=!1,xt=!1,gt=!0;if(bt&&!Ne.occluded){const Et=.5*re*Ue+ce,ht=new i.P(-100,-100),Mt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Vt=new lf,{first:Wt,last:Ht}=bt,ir=Wt.path.length;let Or=[];for(let Tr=ir-1;Tr>=1;Tr--)Or.push(Wt.path[Tr]);for(let Tr=1;Tr<Ht.path.length;Tr++)Or.push(Ht.path[Tr]);const vr=2.5*Et;B&&(Or=Or.map(([Tr,tn,yn],Wn)=>(Ee&&!Pe&&(yn=Ee(Wn<ir-1?Wt.tilePath[ir-1-Wn]:Ht.tilePath[Wn-ir+2])[2]),bl(Tr,tn,yn,B))),Or.some(Tr=>Tr[3]<=0)&&(Or=[]));let Mr=[];if(Or.length>0){let Tr=1/0,tn=-1/0,yn=1/0,Wn=-1/0;for(const Hr of Or)Tr=Math.min(Tr,Hr[0]),yn=Math.min(yn,Hr[1]),tn=Math.max(tn,Hr[0]),Wn=Math.max(Wn,Hr[1]);tn>=ht.x&&Tr<=Mt.x&&Wn>=ht.y&&yn<=Mt.y&&(Mr=[Or.map(Hr=>new i.P(Hr[0],Hr[1]))],(Tr<ht.x||tn>Mt.x||yn<ht.y||Wn>Mt.y)&&(Mr=i.bu(Mr,ht.x,ht.y,Mt.x,Mt.y)))}for(const Tr of Mr){Vt.reset(Tr,.25*Et);let tn=0;tn=Vt.length<=.5*Et?1:Math.ceil(Vt.paddedLength/vr)+1;for(let yn=0;yn<tn;yn++){const Wn=yn/Math.max(tn-1,1),Hr=Vt.lerp(Wn),li=Hr.x+Oo,Lr=Hr.y+Oo;fe.push(li,Lr,Et,0);const or=li-Et,on=Lr-Et,Mn=li+Et,cn=Lr+Et;if(gt=gt&&this.isOffscreen(or,on,Mn,cn),xt=xt||this.isInsideGrid(or,on,Mn,cn),!u&&this.grid.hitTestCircle(li,Lr,Et,Y)&&(Ye=!0,!V))return{circles:[],offscreen:!1,collisionDetected:Ye,occluded:!1}}}}return{circles:!V&&Ye||!xt?[]:fe,offscreen:gt,collisionDetected:Ye,occluded:Ne.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,x=1/0,S=-1/0,A=-1/0;for(const V of s){const X=new i.P(V.x+Oo,V.y+Oo);g=Math.min(g,X.x),x=Math.min(x,X.y),S=Math.max(S,X.x),A=Math.max(A,X.y),u.push(X)}const L=this.grid.query(g,x,S,A).concat(this.ignoredGrid.query(g,x,S,A)),z={},B={};for(const V of L){const X=V.key;if(z[X.bucketInstanceId]===void 0&&(z[X.bucketInstanceId]={}),z[X.bucketInstanceId][X.featureIndex])continue;const Y=[new i.P(V.x1,V.y1),new i.P(V.x2,V.y1),new i.P(V.x2,V.y2),new i.P(V.x1,V.y2)];i.bv(u,Y)&&(z[X.bucketInstanceId][X.featureIndex]=!0,B[X.bucketInstanceId]===void 0&&(B[X.bucketInstanceId]=[]),B[X.bucketInstanceId].push(X.featureIndex))}return B}insertCollisionBox(s,u,g,x,S){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:S},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,g,x,S){const A=u?this.ignoredGrid:this.grid,L={bucketInstanceId:g,featureIndex:x,collisionGroupID:S};for(let z=0;z<s.length;z+=4)A.insertCircle(L,s[z],s[z+1],s[z+2])}projectAndGetPerspectiveRatio(s,u,g,x,S,A,L){const z=[u,g,x,1];let B=!1;x||this.transform.pitch>0?(i.ad.vec4.transformMat4(z,z,s),this.fogState&&S&&L.name!=="globe"&&(B=function(Y,re,ce,ae,fe,me){const be=me.calculateFogTileMatrix(fe),Ee=[re,ce,ae];return i.ad.vec3.transformMat4(Ee,Ee,be),er(Y,i.ad.vec3.length(Ee),me.pitch,me._fov)}(this.fogState,u,g,x,S.toUnwrapped(),this.transform)>.9)):no(z,z,s);const V=z[3];return{point:new i.P((z[0]/V+1)/2*this.transform.width+Oo,(-z[1]/V+1)/2*this.transform.height+Oo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/V*.5,1.5),signedDistanceFromCamera:V,occluded:A&&z[2]>V||B}}isOffscreen(s,u,g,x){return g<Oo||s>=this.screenRightBoundary||x<Oo||u>this.screenBottomBoundary}isInsideGrid(s,u,g,x){return g>=0&&s<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=i.ad.mat4.identity([]);return i.ad.mat4.translate(s,s,[-100,-100,0]),s}}function $i(y,s,u){const g=s.createTileMatrix(y,y.worldSize,u.toUnwrapped());return i.ad.mat4.multiply(new Float32Array(16),y.projMatrix,g)}function cb(y,s,u){if(s.projection.name===u.projection.name)return y.projMatrix;const g=u.clone();return g.setProjection(s.projection),$i(g,s.getProjection(),y)}function ds(y,s,u){return s.name===u.projection.name?y.projMatrix:$i(u,s,y)}class df{constructor(s,u,g,x){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class $u{constructor(s,u,g,x,S,A=!1){this.text=new df(s?s.text:null,u,g,S),this.icon=new df(s?s.icon:null,u,x,S),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zc{constructor(s,u,g,x=!1){this.text=s,this.icon=u,this.skipFade=g,this.clipped=x}}class kR{constructor(){this.invProjMatrix=i.ad.mat4.create(),this.viewportMatrix=i.ad.mat4.create(),this.circles=[]}}class jc{constructor(s,u,g,x,S){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=S}}class RR{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[s]}}function Yy(y,s,u,g,x){const{horizontalAlign:S,verticalAlign:A}=i.bD(y),L=-(S-.5)*s,z=-(A-.5)*u,B=i.bC(y,g);return new i.P(L+B[0]*x,z+B[1]*x)}function xa(y,s,u,g,x){const S=new i.P(y,s);return u&&S._rotate(g?x:-x),S}class DR{constructor(s,u,g,x,S,A){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Nc(this.transform,S),this.buildingIndex=A,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new RR(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,u,g,x,S=1){const A=g.getBucket(u),L=g.latestFeatureIndex;if(!A||!L||u.fqid!==A.layerIds[0])return;const z=A.layers[0].layout,B=A.layers[0].paint,V=g.collisionBoxArray,X=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),Y=g.tileSize/i.ai,re=g.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ce=(ae=g.tileID,fe=A.getProjection(),me=this.transform,fe.name===this.projection?me.calculateProjMatrix(ae.toUnwrapped()):$i(me,fe,ae));var ae,fe,me;const be=z.get("text-pitch-alignment")==="map",Ee=z.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const Te=u.dynamicFilter(),Oe=u.dynamicFilterNeedsFeature(),Me=this.transform.calculatePixelsToTileUnitsMatrix(g),Ce=Zo(ce,g.tileID.canonical,be,Ee,this.transform,A.getProjection(),Me);let Pe=null;if(be){const bt=zi(ce,g.tileID.canonical,be,Ee,this.transform,A.getProjection(),Me);Pe=i.ad.mat4.multiply([],this.transform.labelPlaneMatrix,bt)}let Ne=null;Te&&g.latestFeatureIndex&&(Ne={unwrappedTileID:re,dynamicFilter:Te,dynamicFilterNeedsFeature:Oe}),this.retainedQueryData[A.bucketInstanceId]=new jc(A.bucketInstanceId,L,A.sourceLayerIndex,A.index,g.tileID);const[Ue,dt]=A.layers[0].layout.get("text-size-scale-range"),et=i.ay(S,Ue,dt),[wt,Tt]=z.get("icon-size-scale-range"),Dt=i.ay(S,wt,Tt),Qe={bucket:A,layout:z,paint:B,posMatrix:ce,textLabelPlaneMatrix:Ce,labelToScreenMatrix:Pe,clippingData:Ne,scale:X,textPixelRatio:Y,holdingForFade:g.holdingForFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:i.bp(A.textSizeData,this.transform.zoom,et),partiallyEvaluatedIconSize:i.bp(A.iconSizeData,this.transform.zoom,Dt),collisionGroup:this.collisionGroups.get(A.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(x)for(const bt of A.sortKeyRanges){const{sortKey:Ye,symbolInstanceStart:xt,symbolInstanceEnd:gt}=bt;s.push({sortKey:Ye,symbolInstanceStart:xt,symbolInstanceEnd:gt,parameters:Qe})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:Qe})}attemptAnchorPlacement(s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me,be){const{textOffset0:Ee,textOffset1:Te,crossTileID:Oe}=Y,Me=[Ee,Te],Ce=Yy(s,g,x,Me,S),Pe=this.collisionIndex.placeCollisionBox(ce,S,u,xa(Ce.x,Ce.y,A,L,this.transform.angle),X,z,B,V.predicate);if(fe){const Ne=ce.getSymbolInstanceIconSize(be,this.transform.zoom,Y.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ce,Ne,fe,xa(Ce.x,Ce.y,A,L,this.transform.angle),X,z,B,V.predicate).box.length===0)return}if(Pe.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Oe]&&this.prevPlacement.placements[Oe]&&this.prevPlacement.placements[Oe].text&&(Ne=this.prevPlacement.variableOffsets[Oe].anchor),this.variableOffsets[Oe]={textOffset:Me,width:g,height:x,anchor:s,textScale:S,prevAnchor:Ne},this.markUsedJustification(ce,s,Y,ae),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,ae,Y),this.placedOrientations[Oe]=ae),{shift:Ce,placedGlyphBoxes:Pe}}}placeLayerBucketPart(s,u,g,x,S=1){const{bucket:A,layout:L,paint:z,posMatrix:B,textLabelPlaneMatrix:V,labelToScreenMatrix:X,clippingData:Y,textPixelRatio:re,holdingForFade:ce,collisionBoxArray:ae,partiallyEvaluatedTextSize:fe,partiallyEvaluatedIconSize:me,collisionGroup:be,latestFeatureIndex:Ee}=s.parameters,Te=L.get("text-optional"),Oe=L.get("icon-optional"),Me=L.get("text-allow-overlap"),Ce=L.get("icon-allow-overlap"),Pe=L.get("text-rotation-alignment")==="map",Ne=L.get("text-pitch-alignment")==="map",Ue=z.get("symbol-z-offset"),dt=L.get("symbol-elevation-reference")==="sea",[et,wt]=L.get("text-size-scale-range"),[Tt,Dt]=L.get("icon-size-scale-range"),Qe=i.ay(S,et,wt),bt=i.ay(S,Tt,Dt);this.transform.setProjection(A.projection);let Ye=Me&&(Ce||!A.hasIconData()||Oe),xt=Ce&&(Me||!A.hasTextData()||Te);const gt=!Ue.isConstant();!A.collisionArrays&&ae&&A.deserializeCollisionBoxes(ae),g&&x&&A.updateCollisionDebugBuffers(this.transform.zoom,ae,Qe,bt);const Et=(ht,Mt,Vt)=>{const{crossTileID:Wt,numVerticalGlyphVertices:Ht}=ht;let ir=null;if(Y&&Y.dynamicFilterNeedsFeature||gt){const sn=this.retainedQueryData[A.bucketInstanceId];ir=Ee.loadFeature({featureIndex:ht.featureIndex,bucketIndex:sn.bucketIndex,sourceLayerIndex:sn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Y&&!(0,Y.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},ir,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new i.P(ht.tileAnchorX,ht.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[Wt]=new zc(!1,!1,!1,!0),void u.add(Wt);const Or=Ue.evaluate(ir,{});if(u.has(Wt))return;if(ce)return void(this.placements[Wt]=new zc(!1,!1,!1));let vr=!1,Mr=!1,Tr=!0,tn=!1,yn=!1,Wn=null,Hr={box:null,offscreen:null,occluded:null},li={box:null,offscreen:null,occluded:null},Lr=null,or=null,on=null,Mn=0,cn=0,Ti=0;Vt.textFeatureIndex?Mn=Vt.textFeatureIndex:ht.useRuntimeCollisionCircles&&(Mn=ht.featureIndex),Vt.verticalTextFeatureIndex&&(cn=Vt.verticalTextFeatureIndex);const Hi=sn=>{sn.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const ci=this.transform.elevation;sn.elevation=dt?Or:Or+(ci?ci.getAtTileOffset(sn.tileID,sn.tileAnchorX,sn.tileAnchorY):0),sn.elevation+=ht.zOffset},ho=Vt.textBox;if(ho){Hi(ho);const sn=vn=>{let Nn=i.bq.horizontal;if(A.allowVerticalPlacement&&!vn&&this.prevPlacement){const Uo=this.prevPlacement.placedOrientations[Wt];Uo&&(this.placedOrientations[Wt]=Uo,Nn=Uo,this.markUsedOrientation(A,Nn,ht))}return Nn},ci=(vn,Nn)=>{if(A.allowVerticalPlacement&&Ht>0&&Vt.verticalTextBox){for(const Uo of A.writingModes)if(Uo===i.bq.vertical?(Hr=Nn(),li=Hr):Hr=vn(),Hr&&Hr.box&&Hr.box.length)break}else Hr=vn()};if(L.get("text-variable-anchor")){let vn=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Wt]){const ti=this.prevPlacement.variableOffsets[Wt];vn.indexOf(ti.anchor)>0&&(vn=vn.filter(fo=>fo!==ti.anchor),vn.unshift(ti.anchor))}const Nn=(ti,fo,ac)=>{const Ha=A.getSymbolInstanceTextSize(fe,ht,this.transform.zoom,Mt),Ws=(ti.x2-ti.x1)*Ha+2*ti.padding,Ra=(ti.y2-ti.y1)*Ha+2*ti.padding,Gs=ht.hasIconTextFit&&!Ce?fo:null;Gs&&Hi(Gs);let Za={box:[],offscreen:!1,occluded:!1};const Zc=Me?2*vn.length:vn.length;for(let sc=0;sc<Zc;++sc){const Xc=this.attemptAnchorPlacement(vn[sc%vn.length],ti,Ws,Ra,Ha,Pe,Ne,re,B,be,sc>=vn.length,ht,Mt,A,ac,Gs,fe,me);if(Xc&&(Za=Xc.placedGlyphBoxes,Za&&Za.box&&Za.box.length)){vr=!0,Wn=Xc.shift;break}}return Za};ci(()=>Nn(ho,Vt.iconBox,i.bq.horizontal),()=>{const ti=Vt.verticalTextBox;return ti&&Hi(ti),A.allowVerticalPlacement&&!(Hr&&Hr.box&&Hr.box.length)&&Ht>0&&ti?Nn(ti,Vt.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Hr&&(vr=Hr.box,Tr=Hr.offscreen,tn=Hr.occluded);const Uo=sn(!(!Hr||!Hr.box));if(!vr&&this.prevPlacement){const ti=this.prevPlacement.variableOffsets[Wt];ti&&(this.variableOffsets[Wt]=ti,this.markUsedJustification(A,ti.anchor,ht,Uo))}}else{const vn=(Nn,Uo)=>{const ti=A.getSymbolInstanceTextSize(fe,ht,this.transform.zoom,Mt,S),fo=this.collisionIndex.placeCollisionBox(A,ti,Nn,new i.P(0,0),Me,re,B,be.predicate);return fo&&fo.box&&fo.box.length&&(this.markUsedOrientation(A,Uo,ht),this.placedOrientations[Wt]=Uo),fo};ci(()=>vn(ho,i.bq.horizontal),()=>{const Nn=Vt.verticalTextBox;return A.allowVerticalPlacement&&Ht>0&&Nn?(Hi(Nn),vn(Nn,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),sn(!!(Hr&&Hr.box&&Hr.box.length))}}if(Lr=Hr,vr=Lr&&Lr.box&&Lr.box.length>0,Tr=Lr&&Lr.offscreen,tn=Lr&&Lr.occluded,ht.useRuntimeCollisionCircles){const sn=A.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex>=0?ht.centerJustifiedTextSymbolIndex:ht.verticalPlacedTextSymbolIndex),ci=i.br(A.textSizeData,fe,sn),vn=L.get("text-padding");or=this.collisionIndex.placeCollisionCircles(A,Me,sn,A.lineVertexArray,A.glyphOffsetArray,ci,B,V,X,g,Ne,be.predicate,ht.collisionCircleDiameter*ci/i.bw,vn,this.retainedQueryData[A.bucketInstanceId].tileID),vr=Me||or.circles.length>0&&!or.collisionDetected,Tr=Tr&&or.offscreen,tn=or.occluded}if(Vt.iconFeatureIndex&&(Ti=Vt.iconFeatureIndex),Vt.iconBox){const sn=ci=>{Hi(ci);const vn=ht.hasIconTextFit&&Wn?xa(Wn.x,Wn.y,Pe,Ne,this.transform.angle):new i.P(0,0),Nn=A.getSymbolInstanceIconSize(me,this.transform.zoom,ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,Nn,ci,vn,Ce,re,B,be.predicate)};li&&li.box&&li.box.length&&Vt.verticalIconBox?(on=sn(Vt.verticalIconBox),Mr=on.box.length>0):(on=sn(Vt.iconBox),Mr=on.box.length>0),Tr=Tr&&on.offscreen,yn=on.occluded}const _o=Te||ht.numHorizontalGlyphVertices===0&&Ht===0,gs=Oe||ht.numIconVertices===0;if(_o||gs?gs?_o||(Mr=Mr&&vr):vr=Mr&&vr:Mr=vr=Mr&&vr,vr&&Lr&&Lr.box&&this.collisionIndex.insertCollisionBox(Lr.box,L.get("text-ignore-placement"),A.bucketInstanceId,li&&li.box&&cn?cn:Mn,be.ID),Mr&&on&&this.collisionIndex.insertCollisionBox(on.box,L.get("icon-ignore-placement"),A.bucketInstanceId,Ti,be.ID),or&&(vr&&this.collisionIndex.insertCollisionCircles(or.circles,L.get("text-ignore-placement"),A.bucketInstanceId,Mn,be.ID),g)){const sn=A.bucketInstanceId;let ci=this.collisionCircleArrays[sn];ci===void 0&&(ci=this.collisionCircleArrays[sn]=new kR);for(let vn=0;vn<or.circles.length;vn+=4)ci.circles.push(or.circles[vn+0]),ci.circles.push(or.circles[vn+1]),ci.circles.push(or.circles[vn+2]),ci.circles.push(or.collisionDetected?1:0)}const la=A.projection.name!=="globe";Ye=Ye&&(la||!tn),xt=xt&&(la||!yn),this.placements[Wt]=new zc(vr||Ye,Mr||xt,Tr||A.justReloaded),u.add(Wt)};if(A.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(A,this.retainedQueryData[A.bucketInstanceId].tileID),A.elevationType==="road"&&A.updateRoadElevation(),A.updateZOffset(),A.sortFeaturesByY){const ht=A.getSortedSymbolIndexes(this.transform.angle);for(let Mt=ht.length-1;Mt>=0;--Mt){const Vt=ht[Mt];Et(A.symbolInstances.get(Vt),Vt,A.collisionArrays[Vt])}A.hasAnyZOffset&&i.w(`${A.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(A.hasAnyZOffset){const ht=A.getSortedIndexesByZOffset();for(let Mt=0;Mt<ht.length;++Mt){const Vt=ht[Mt];Et(A.symbolInstances.get(Vt),Vt,A.collisionArrays[Vt])}}else for(let ht=s.symbolInstanceStart;ht<s.symbolInstanceEnd;ht++)Et(A.symbolInstances.get(ht),ht,A.collisionArrays[ht]);if(g&&A.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[A.bucketInstanceId];i.ad.mat4.invert(ht.invProjMatrix,B),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(s,u,g,x){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:z,crossTileID:B}=g,V=i.bB(u),X=x===i.bq.vertical?z:V==="left"?S:V==="center"?A:V==="right"?L:-1;S>=0&&(s.text.placedSymbolArray.get(S).crossTileID=X>=0&&S!==X?0:B),A>=0&&(s.text.placedSymbolArray.get(A).crossTileID=X>=0&&A!==X?0:B),L>=0&&(s.text.placedSymbolArray.get(L).crossTileID=X>=0&&L!==X?0:B),z>=0&&(s.text.placedSymbolArray.get(z).crossTileID=X>=0&&z!==X?0:B)}markUsedOrientation(s,u,g){const x=u===i.bq.horizontal||u===i.bq.horizontalOnly?u:0,S=u===i.bq.vertical?u:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:B}=g,V=s.text.placedSymbolArray;A>=0&&(V.get(A).placedOrientation=x),L>=0&&(V.get(L).placedOrientation=x),z>=0&&(V.get(z).placedOrientation=x),B>=0&&(V.get(B).placedOrientation=S)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(s):1,S=u?u.opacities:{},A=u?u.variableOffsets:{},L=u?u.placedOrientations:{};for(const z in this.placements){const B=this.placements[z],V=S[z];V?(this.opacities[z]=new $u(V,x,B.text,B.icon,null,B.clipped),g=g||B.text!==V.text.placed||B.icon!==V.icon.placed):(this.opacities[z]=new $u(null,x,B.text,B.icon,B.skipFade,B.clipped),g=g||B.text||B.icon)}for(const z in S){const B=S[z];if(!this.opacities[z]){const V=new $u(B,x,!1,!1);V.isHidden()||(this.opacities[z]=V,g=g||B.text.placed||B.icon.placed)}}for(const z in A)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=A[z]);for(const z in L)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=L[z]);g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u,g,x){const S=new Set;for(const A of u){const L=A.getBucket(s);L&&A.latestFeatureIndex&&s.fqid===L.layerIds[0]&&(this.updateBucketOpacities(L,S,A,A.collisionBoxArray,g,x,A.tileID,s.scope),L.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(L,A.tileID),L.elevationType==="road"&&L.updateRoadElevation(),L.updateZOffset())}}updateBucketOpacities(s,u,g,x,S,A,L,z){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const B=s.layers[0].layout,V=s.layers[0].paint,X=!!s.layers[0].dynamicFilter(),Y=new $u(null,0,!1,!1,!0),re=B.get("text-allow-overlap"),ce=B.get("icon-allow-overlap"),ae=B.get("text-variable-anchor"),fe=B.get("text-rotation-alignment")==="map",me=B.get("text-pitch-alignment")==="map",be=V.get("symbol-z-offset"),Ee=B.get("symbol-elevation-reference")==="sea",Te=!be.isConstant(),Oe=new $u(null,0,re&&(ce||!s.hasIconData()||B.get("icon-optional")),ce&&(re||!s.hasTextData()||B.get("text-optional")),!0);!s.collisionArrays&&x&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(x);const Me=(Pe,Ne,Ue)=>{for(let dt=0;dt<Ne/4;dt++)Pe.opacityVertexArray.emplaceBack(Ue)};let Ce=0;A&&s.updateReplacement(L,A);for(let Pe=0;Pe<s.symbolInstances.length;Pe++){const Ne=s.symbolInstances.get(Pe),{numHorizontalGlyphVertices:Ue,numVerticalGlyphVertices:dt,crossTileID:et,numIconVertices:wt,tileAnchorX:Tt,tileAnchorY:Dt}=Ne;let Qe=null;const bt=this.retainedQueryData[s.bucketInstanceId];Te&&Ne&&bt&&(Qe=g.latestFeatureIndex.loadFeature({featureIndex:Ne.featureIndex,bucketIndex:bt.bucketIndex,sourceLayerIndex:bt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ye=be.evaluate(Qe,{}),xt=u.has(et);let gt=this.opacities[et];xt?gt=Y:gt||(gt=Oe,this.opacities[et]=gt),u.add(et);const Et=Ue>0||dt>0,ht=wt>0,Mt=this.placedOrientations[et],Vt=Mt===i.bq.vertical,Wt=Mt===i.bq.horizontal||Mt===i.bq.horizontalOnly;!Et&&!ht||gt.isHidden()||Ce++;let Ht=!1;if((Et||ht)&&A)for(const ir of s.activeReplacements){if(i.bx(ir,S,i.by.Symbol,z)||ir.min.x>Tt||Tt>ir.max.x||ir.min.y>Dt||Dt>ir.max.y)continue;const Or=i.bz(Tt,Dt,L.canonical,ir.footprintTileId.canonical);if(Ht=i.bA(Or,ir.footprint),Ht)break}if(Et){const ir=Ht?qd:Gd(gt.text);Me(s.text,Ue,Vt?qd:ir),Me(s.text,dt,Wt?qd:ir);const Or=gt.text.isHidden(),{leftJustifiedTextSymbolIndex:vr,centerJustifiedTextSymbolIndex:Mr,rightJustifiedTextSymbolIndex:Tr,verticalPlacedTextSymbolIndex:tn}=Ne,yn=s.text.placedSymbolArray,Wn=Or||Vt?1:0;vr>=0&&(yn.get(vr).hidden=Wn),Mr>=0&&(yn.get(Mr).hidden=Wn),Tr>=0&&(yn.get(Tr).hidden=Wn),tn>=0&&(yn.get(tn).hidden=Or||Wt?1:0);const Hr=this.variableOffsets[et];Hr&&this.markUsedJustification(s,Hr.anchor,Ne,Mt);const li=this.placedOrientations[et];li&&(this.markUsedJustification(s,"left",Ne,li),this.markUsedOrientation(s,li,Ne))}if(ht){const ir=Ht?qd:Gd(gt.icon),{placedIconSymbolIndex:Or,verticalPlacedIconSymbolIndex:vr}=Ne,Mr=s.icon.placedSymbolArray,Tr=gt.icon.isHidden()?1:0;Or>=0&&(Me(s.icon,wt,Vt?qd:ir),Mr.get(Or).hidden=Tr),vr>=0&&(Me(s.icon,Ne.numVerticalIconVertices,Wt?qd:ir),Mr.get(vr).hidden=Tr)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const ir=s.collisionArrays[Pe];if(ir){let Or=new i.P(0,0),vr=!0;if(ir.textBox||ir.verticalTextBox){if(ae){const Tr=this.variableOffsets[et];Tr?(Or=Yy(Tr.anchor,Tr.width,Tr.height,Tr.textOffset,Tr.textScale),fe&&Or._rotate(me?this.transform.angle:-this.transform.angle)):vr=!1}X&&(vr=!gt.clipped),ir.textBox&&Wd(s.textCollisionBox.collisionVertexArray,gt.text.placed,!vr||Vt,Ye,Ee,Or.x,Or.y),ir.verticalTextBox&&Wd(s.textCollisionBox.collisionVertexArray,gt.text.placed,!vr||Wt,Ye,Ee,Or.x,Or.y)}const Mr=vr&&!!(!Wt&&ir.verticalIconBox);ir.iconBox&&Wd(s.iconCollisionBox.collisionVertexArray,gt.icon.placed,Mr,Ye,Ee,Ne.hasIconTextFit?Or.x:0,Ne.hasIconTextFit?Or.y:0),ir.verticalIconBox&&Wd(s.iconCollisionBox.collisionVertexArray,gt.icon.placed,!Mr,Ye,Ee,Ne.hasIconTextFit?Or.x:0,Ne.hasIconTextFit?Or.y:0)}}}if(s.fullyClipped=Ce===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Pe=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Pe.invProjMatrix,s.placementViewportMatrix=Pe.viewportMatrix,s.collisionCircleArray=Pe.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function Wd(y,s,u,g,x,S,A){y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0),y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0),y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0),y.emplaceBack(s?1:0,u?1:0,S||0,A||0,g,x?1:0)}const HE=Math.pow(2,25),Dm=Math.pow(2,24),LR=Math.pow(2,17),NR=Math.pow(2,16),Lm=Math.pow(2,9),Nm=Math.pow(2,8),zR=Math.pow(2,1);function Gd(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const s=y.placed?1:0,u=Math.floor(127*y.opacity);return u*HE+s*Dm+u*LR+s*NR+u*Lm+s*Nm+u*zR+s}const qd=0;class Ky{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,u,g,x,S,A){const L=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(L,x,s[this._currentTileIndex],this._sortAcrossTiles,A),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((z,B)=>z.sortKey-B.sortKey));this._currentPartIndex<L.length;){const z=L[this._currentPartIndex];if(u.placeLayerBucketPart(z,this._seenCrossTileIDs,g,z.symbolInstanceStart===0,A),this._currentPartIndex++,S())return!0}return!1}}class Uu{constructor(s,u,g,x,S,A,L,z,B){this.placement=new DR(s,S,A,L,z,B),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(s,u,g,x,S){const A=i.q.now(),L=()=>{const z=i.q.now()-A;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=u[s[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=B)&&(!z.maxzoom||z.maxzoom>B)){const V=z,X=V.layout.get("symbol-z-elevate"),Y=V.layout.get("symbol-sort-key").constantOr(1)!==void 0,re=V.layout.get("symbol-z-order"),ce=re==="viewport-y"||re==="auto"&&!(re!=="viewport-y"&&Y),ae=V.layout.get("text-allow-overlap")||V.layout.get("icon-allow-overlap")||V.layout.get("text-ignore-placement")||V.layout.get("icon-ignore-placement"),fe=ce&&ae,me=this._inProgressLayer=this._inProgressLayer||new Ky(V),be=i.C(z.source,z.scope);if(me.continuePlacement(X||fe?x[be]:g[be],this.placement,this._showCollisionBoxes,z,L,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const ub=512/i.ai/2;class jR{constructor(s,u,g){this.tileID=s,this.bucketInstanceId=g,this.index=new i.bE(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=s.canonical.x*i.ai,S=s.canonical.y*i.ai;for(let A=0;A<u.length;A++){const{key:L,crossTileID:z,tileAnchorX:B,tileAnchorY:V}=u.get(A),X=Math.floor((x+B)*ub),Y=Math.floor((S+V)*ub);this.index.add(X,Y),this.keys.push(L),this.crossTileIDs.push(z)}this.index.finish()}findMatches(s,u,g){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),S=ub/Math.pow(2,u.canonical.z-this.tileID.canonical.z),A=u.canonical.x*i.ai,L=u.canonical.y*i.ai;for(let z=0;z<s.length;z++){const B=s.get(z);if(B.crossTileID)continue;const{key:V,tileAnchorX:X,tileAnchorY:Y}=B,re=Math.floor((A+X)*S),ce=Math.floor((L+Y)*S),ae=this.index.range(re-x,ce-x,re+x,ce+x);for(const fe of ae){const me=this.crossTileIDs[fe];if(this.keys[fe]===V&&!g.has(me)){g.add(me),B.crossTileID=me;break}}}}}class FR{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ZE{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(u!==0)for(const g in this.indexes){const x=this.indexes[g],S={};for(const A in x){const L=x[A];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+u),S[L.tileID.key]=L}this.indexes[g]=S}this.lng=s}addBucket(s,u,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let S=0;S<u.symbolInstances.length;S++)u.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const x=this.usedCrossTileIDs[s.overscaledZ];for(const S in this.indexes){const A=this.indexes[S];if(Number(S)>s.overscaledZ)for(const L in A){const z=A[L];z.tileID.isChildOf(s)&&z.findMatches(u.symbolInstances,s,x)}else{const L=A[s.scaledTo(Number(S)).key];L&&L.findMatches(u.symbolInstances,s,x)}}for(let S=0;S<u.symbolInstances.length;S++){const A=u.symbolInstances.get(S);A.crossTileID||(A.crossTileID=g.generate(),x.add(A.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new jR(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let u=!1;for(const g in this.indexes){const x=this.indexes[g];for(const S in x)s[x[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[S]),delete x[S],u=!0)}return u}}class BR{constructor(){this.layerIndexes={},this.crossTileIDs=new FR,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,g,x){let S=this.layerIndexes[s.fqid];S===void 0&&(S=this.layerIndexes[s.fqid]=new ZE);let A=!1;const L={};x.name!=="globe"&&S.handleWrapJump(g);for(const z of u){const B=z.getBucket(s);B&&s.fqid===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(z.tileID,B,this.crossTileIDs)&&(A=!0),L[B.bucketInstanceId]=!0)}return S.removeStaleBuckets(L)&&(A=!0),A}pruneUnusedLayers(s){const u={};s.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const Vu=771;class Xr{constructor(s,u,g,x){this.blendFunction=s,this.blendColor=u,this.mask=g,this.blendEquation=x}}Xr.Replace=[1,0,1,0],Xr.disabled=new Xr(Xr.Replace,i.al.transparent,[!1,!1,!1,!1]),Xr.unblended=new Xr(Xr.Replace,i.al.transparent,[!0,!0,!0,!0]),Xr.alphaBlended=new Xr([1,Vu,1,Vu],i.al.transparent,[!0,!0,!0,!0]),Xr.alphaBlendedNonPremultiplied=new Xr([770,Vu,770,Vu],i.al.transparent,[!0,!0,!0,!0]),Xr.multiply=new Xr([774,0,774,0],i.al.transparent,[!0,!0,!0,!0]);class hr{constructor(s,u,g){this.func=s,this.mask=u,this.range=g}}hr.ReadOnly=!1,hr.ReadWrite=!0,hr.disabled=new hr(519,hr.ReadOnly,[0,1]);const Jy=7680;class Dr{constructor(s,u,g,x,S,A){this.test=s,this.ref=u,this.mask=g,this.fail=x,this.depthFail=S,this.pass=A}}Dr.disabled=new Dr({func:519,mask:0},0,0,Jy,Jy,Jy);const Fc=1029,hf=2305;class Ir{constructor(s,u,g){this.enable=s,this.mode=u,this.frontFace=g}}function db(y,s){const u=i.bG(y,3);i.ad.mat4.fromQuat(y,s),i.bI(y,3,u)}function Hd(y,s){const u=i.ad.quat.identity([]);return i.ad.quat.rotateZ(u,u,-s),i.ad.quat.rotateX(u,u,-y),u}function ff(y,s){const u=[y[0],y[1],0],g=[s[0],s[1],0];if(i.ad.vec3.length(u)>=1e-15){const A=i.ad.vec3.normalize([],u);i.ad.vec3.scale(g,A,i.ad.vec3.dot(g,A)),s[0]=g[0],s[1]=g[1]}const x=i.ad.vec3.cross([],s,y);if(i.ad.vec3.len(x)<1e-15)return null;const S=Math.atan2(-x[1],x[0]);return Hd(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),S)}Ir.disabled=new Ir(!1,Fc,hf),Ir.backCCW=new Ir(!0,Fc,hf),Ir.backCW=new Ir(!0,Fc,2304),Ir.frontCW=new Ir(!0,1028,2304),Ir.frontCCW=new Ir(!0,1028,hf);class hb{constructor(s,u){this.position=s,this.orientation=u}get position(){return this._position}set position(s){if(s){const u=s instanceof i.ac?s:new i.ac(s[0],s[1],s[2]);this._renderWorldCopies&&(u.x=i.bF(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(s,u){if(this.orientation=null,!this.position)return;const g=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.ac.fromLngLat(s)):0,S=i.ac.fromLngLat(s,x),A=[S.x-g.x,S.y-g.y,S.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=ff(A,u)}setPitchBearing(s,u){this.orientation=Hd(i.ak(s),i.ak(-u))}}class pf{constructor(s,u){this._transform=i.ad.mat4.identity([]),this.orientation=u,this.position=s}get mercatorPosition(){const s=this.position;return new i.ac(s[0],s[1],s[2])}get position(){const s=i.bG(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var u;s&&i.bI(this._transform,3,[(u=s)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||i.ad.quat.identity([]),s&&db(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,u){this._orientation=Hd(s,u),db(this._transform,this._orientation)}forward(){const s=i.bG(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=i.bG(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=i.bG(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,u){const g=new Float64Array(16);return i.ad.mat4.invert(g,this.getWorldToCamera(s,u)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,u,g){const x=this.position;i.ad.vec3.scale(x,x,-s);const S=new Float64Array(16);return i.ad.mat4.fromScaling(S,[g,g,g]),i.ad.mat4.translate(S,S,x),S[10]*=u,S}getWorldToCamera(s,u){const g=new Float64Array(16),x=new Float64Array(4),S=this.position;return i.ad.quat.conjugate(x,this._orientation),i.ad.vec3.scale(S,S,-s),i.ad.mat4.fromQuat(g,x),i.ad.mat4.translate(g,g,S),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(s,u,g,x){const S=new Float64Array(16);return i.ad.mat4.perspective(S,s,u,g,x),S}getCameraToClipOrthographic(s,u,g,x,S,A){const L=new Float64Array(16);return i.ad.mat4.ortho(L,s,u,g,x,S,A),L}getDistanceToElevation(s,u=!1){const g=s===0?0:i.bH(s,u?i.aT(this.position[1]):this.position[1]),x=this.forward();return(g-this.position[2])/x[2]}clone(){return new pf([...this.position],[...this.orientation])}}const Ii={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class zm{constructor(s=0,u=0,g=0,x=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=g,this.right=x}interpolate(s,u,g){return u.top!=null&&s.top!=null&&(this.top=i.ah(s.top,u.top,g)),u.bottom!=null&&s.bottom!=null&&(this.bottom=i.ah(s.bottom,u.bottom,g)),u.left!=null&&s.left!=null&&(this.left=i.ah(s.left,u.left,g)),u.right!=null&&s.right!=null&&(this.right=i.ah(s.right,u.right,g)),this}getCenter(s,u){const g=i.ay((this.left+s-this.right)/2,0,s),x=i.ay((this.top+u-this.bottom)/2,0,u);return new i.P(g,x)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new zm(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Bt=15;class Qy{constructor(s,u,g,x,S,A,L){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=s||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=x??60,this.setProjection(A),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new zm,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new pf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new Qy(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Bt}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return i.aA(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const g=this.getProjection(),x=!i.bn(u,g);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const u=s!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const u=-s*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=i.ad.mat2.create(),i.ad.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const u=i.ay(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=i.ak(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const u=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,S=0;for(let A=0;A<u.length;A++){const L=new i.P(u[A][0]*this.width,g+u[A][1]*(this.height-g)),z=s.pointCoordinate(L);if(!z)continue;const B=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);x+=z[3]*B,S+=B}return S===0?NaN:x/S}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(s),S=this._mercatorZfromZoom(this._maxZoom),A=Math.max(x-g,S);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let g;g=s.z<this._camera.position[2]?[u.x,u.y,u.z]:[s.x,s.y,s.z];const x=i.ad.vec3.length(i.ad.vec3.sub([],this._camera.position,g));return i.ay(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let u=!1;if(s.orientation&&!i.ad.quat.exactEquals(s.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(s.orientation)),s.position){const g=[s.position.x,s.position.y,s.position.z];i.ad.vec3.exactEquals(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,u=new hb;return u.position=new i.ac(s[0],s[1],s[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(s){if(!i.ad.quat.length(s))return!1;i.ad.quat.normalize(s,s);const u=i.ad.vec3.transformQuat([],[0,0,-1],s),g=i.ad.vec3.transformQuat([],[0,-1,0],s);if(g[2]<0)return!1;const x=ff(u,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(s){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;s[2]=i.ay(s[2],x/g,x/u),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,g){this._unmodified=!1,this._edgeInsets.interpolate(s,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const u=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(s){const u=[new i.bQ(0,s)];if(this.renderWorldCopies){const g=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),S=this.pointCoordinate(new i.P(this.width,this.height)),A=this.pointCoordinate(new i.P(0,this.height)),L=Math.floor(Math.min(g.x,x.x,S.x,A.x)),z=Math.floor(Math.max(g.x,x.x,S.x,A.x)),B=1;for(let V=L-B;V<=z+B;V++)V!==0&&u.push(new i.bQ(V,s))}return u}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,u,g){let x=[];const S=g!==void 0,A=!S;if(A&&this.zoom<u||S&&g[0]===0&&g[1]===0)return x;const L=new Set,z=(V,X,Y,re,ce)=>{const ae=i.c5(X,V,Y,re,ce);L.has(ae)||(x.push(new i.aH(V,X,Y,re,ce)),L.add(ae))};for(let V=0;V<s.length;V++){const X=s[V];if(A&&X.canonical.z!==u)continue;const Y=X.canonical,re=X.overscaledZ,ce=X.wrap,ae=1<<Y.z,fe=Y.x+1<ae,me=Y.x>0,be=Y.y+1<ae,Ee=Y.y>0,Te=X.wrap-(me?0:1),Oe=X.wrap+(fe?0:1),Me=me?Y.x-1:ae-1,Ce=fe?Y.x+1:0;if(S)g[0]<0?(z(re,Oe,Y.z,Ce,Y.y),g[1]<0&&be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Oe,Y.z,Ce,Y.y+1)),g[1]>0&&Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Oe,Y.z,Ce,Y.y-1))):g[0]>0?(z(re,Te,Y.z,Me,Y.y),g[1]<0&&be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Te,Y.z,Me,Y.y+1)),g[1]>0&&Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Te,Y.z,Me,Y.y-1))):g[1]<0&&be?z(re,ce,Y.z,Y.x,Y.y+1):Ee&&z(re,ce,Y.z,Y.x,Y.y-1);else{const Pe=X.visibleQuadrants;1&Pe&&(z(re,Te,Y.z,Me,Y.y),Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Te,Y.z,Me,Y.y-1))),2&Pe&&(z(re,Oe,Y.z,Ce,Y.y),Ee&&(z(re,ce,Y.z,Y.x,Y.y-1),z(re,Oe,Y.z,Ce,Y.y-1))),4&Pe&&(z(re,Te,Y.z,Me,Y.y),be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Te,Y.z,Me,Y.y+1))),8&Pe&&(z(re,Oe,Y.z,Ce,Y.y),be&&(z(re,ce,Y.z,Y.x,Y.y+1),z(re,Oe,Y.z,Ce,Y.y+1)))}}const B=[];for(const V of x)x.some(X=>V.isChildOf(X))||B.push(V);if(x=B.filter(V=>!s.some(X=>!!(V.overscaledZ<u&&X.isChildOf(V))||V.equals(X)||V.isChildOf(X))),A){const V=1<<u,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Y=[V*X.x,V*X.y],re=4,ce=re*re;x=x.filter(ae=>{const fe=ae.canonical.x+.5-Y[0],me=ae.canonical.y+.5-Y[1];return fe*fe+me*me<ce})}return x}coveringTiles(s){let u=this.coveringZoomLevel(s);const g=u,x=this.elevation&&this.elevation.exaggeration(),S=x&&!s.isTerrainDEM,A=this.projection.name==="mercator";if(s.minzoom!==void 0&&u<s.minzoom)return[];s.maxzoom!==void 0&&u>s.maxzoom&&(u=s.maxzoom);const L=this.locationCoordinate(this.center),z=this.center.lat,B=1<<u,V=[B*L.x,B*L.y,0],X=this.projection.name==="globe",Y=!X,re=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,Y),ce=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ae=B*i.bH(1,this.center.lat),fe=this._camera.position[2]/i.bH(1,this.center.lat),me=[B*ce.x,B*ce.y,fe*(Y?1:ae)],be=X||x,Ee=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Te=this.isLODDisabled(!0)?u:0;let Oe;if(this._elevation&&s.isTerrainDEM)Oe=1e4*this._elevation.exaggeration();else if(this._elevation){const Ye=this._elevation.getMinMaxForVisibleTiles();Oe=Ye?Ye.max:this._centerAltitude}else Oe=this._centerAltitude;const Me=s.isTerrainDEM?-Oe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ce=this.projection.isReprojectedInTileSpace?i.bS(this):1,Pe=Ye=>{const gt=new i.ac(Ye.x+25e-6,Ye.y,Ye.z),Et=new i.ac(Ye.x,Ye.y+25e-6,Ye.z),ht=Ye.toLngLat(),Mt=gt.toLngLat(),Vt=Et.toLngLat(),Wt=this.locationCoordinate(ht),Ht=this.locationCoordinate(Mt),ir=this.locationCoordinate(Vt),Or=Math.hypot(Ht.x-Wt.x,Ht.y-Wt.y),vr=Math.hypot(ir.x-Wt.x,ir.y-Wt.y);return Math.sqrt(Or*vr)*Ce/25e-6},Ne=Ye=>{const xt=Oe,gt=Me;return{aabb:i.bV(this,B,0,0,0,Ye,gt,xt,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:xt,wrap:Ye,fullyVisible:!1}},Ue=[];let dt=[];const et=u,wt=s.reparseOverscaled?g:u,Tt=(fe-this._centerAltitude)*ae,Dt=Ye=>{if(!this._elevation||!Ye.tileID||!A)return;const xt=this._elevation.getMinMaxForTile(Ye.tileID),gt=Ye.aabb;xt?(gt.min[2]=xt.min,gt.max[2]=xt.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(Ye.shouldSplit=bt(Ye),Ye.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},Qe=(Ye,xt)=>{if(.707*xt<Ye)return 1;const gt=xt/Ye;return gt/(1.4144271570014144+(Math.pow(1.1,gt-1.4144271570014144+1)-1)/(1.1-1)-1)},bt=Ye=>{if(Ye.zoom<Te)return!0;if(Ye.zoom===et)return!1;if(Ye.shouldSplit!=null)return Ye.shouldSplit;const xt=Ye.aabb.distanceX(me),gt=Ye.aabb.distanceY(me);let Et=Tt,ht=1;if(X){Et=Ye.aabb.distanceZ(me);const vr=Math.pow(2,Ye.zoom),Mr=i.aT((Ye.y+1)/vr),Tr=i.aT(Ye.y/vr),tn=Math.min(Math.max(z,Mr),Tr),yn=i.ca(tn)/i.ca(z);if(ht=tn===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,yn/this._mercatorScaleRatio),this.zoom<=i.c6&&Ye.zoom===et-1&&yn>=.9)return!0}else if(S&&(Et=Ye.aabb.distanceZ(me)*ae),this.projection.isReprojectedInTileSpace&&g<=5){const vr=Math.pow(2,Ye.zoom),Mr=Pe(new i.ac((Ye.x+.5)/vr,(Ye.y+.5)/vr));ht=Mr>.85?1:Mr}if(!A){const vr=Math.sqrt(xt*xt+gt*gt+Et*Et);let Mr=(1<<et-Ye.zoom)*Ee*ht;return Mr*=Qe(Math.max(Et,Tt),vr),vr<Mr}let Mt=Number.MAX_VALUE,Vt=0;const Wt=Ye.aabb.getCorners(),Ht=[];for(const vr of Wt){i.ad.vec3.sub(Ht,vr,me),X||(S?Ht[2]*=ae:Ht[2]=Tt);const Mr=i.ad.vec3.dot(Ht,this._camera.forward());Mr<Mt&&(Mt=Mr,Vt=Math.abs(Ht[2]))}let ir=(1<<et-Ye.zoom)*Ee*ht;if(ir*=Qe(Math.max(Vt,Tt),Mt),Mt<ir)return!0;const Or=Ye.aabb.closestPoint(V);return Or[0]===V[0]&&Or[1]===V[1]};if(this.renderWorldCopies)for(let Ye=1;Ye<=3;Ye++)Ue.push(Ne(-Ye)),Ue.push(Ne(Ye));for(Ue.push(Ne(0));Ue.length>0;){const Ye=Ue.pop(),xt=Ye.x,gt=Ye.y;let Et=Ye.fullyVisible;const ht=()=>this.projection.name==="globe"&&(Ye.y===0||Ye.y===(1<<Ye.zoom)-1);if(!Et){let Mt=be?Ye.aabb.intersects(re):Ye.aabb.intersectsFlat(re);if(Mt===0&&ht()){const Vt=new i.bT(Ye.zoom,xt,gt);Mt=i.bU(this,B,Vt,!0).intersects(re)}if(Mt===0)continue;Et=Mt===2}if(Ye.zoom!==et&&bt(Ye))for(let Mt=0;Mt<4;Mt++){const Vt=(xt<<1)+Mt%2,Wt=(gt<<1)+(Mt>>1),Ht={aabb:A?Ye.aabb.quadrant(Mt):i.bV(this,B,Ye.zoom+1,Vt,Wt,Ye.wrap,Ye.minZ,Ye.maxZ,this.projection),zoom:Ye.zoom+1,x:Vt,y:Wt,wrap:Ye.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:Ye.minZ,maxZ:Ye.maxZ};S&&!X&&(Ht.tileID=new i.aH(Ye.zoom+1===et?wt:Ye.zoom+1,Ye.wrap,Ye.zoom+1,Vt,Wt),Dt(Ht)),Ue.push(Ht)}else{const Mt=Ye.zoom===et?wt:Ye.zoom;if(s.minzoom&&s.minzoom>Mt)continue;let Vt=0;if(!Et){let Or=be?Ye.aabb.intersectsPrecise(re):Ye.aabb.intersectsPreciseFlat(re);if(Or===0&&ht()){const vr=new i.bT(Ye.zoom,xt,gt);Or=i.bU(this,B,vr,!0).intersectsPrecise(re)}if(Or===0)continue;if(s.calculateQuadrantVisibility)if(re.containsPoint(Ye.aabb.center))Vt=15;else for(let vr=0;vr<4;vr++)Ye.aabb.quadrant(vr).intersects(re)!==0&&(Vt|=1<<vr)}const Wt=V[0]-(.5+xt+(Ye.wrap<<Ye.zoom))*(1<<u-Ye.zoom),Ht=V[1]-.5-gt,ir=Ye.tileID?Ye.tileID:new i.aH(Mt,Ye.wrap,Ye.zoom,xt,gt);s.calculateQuadrantVisibility&&(ir.visibleQuadrants=Vt),dt.push({tileID:ir,distanceSq:Wt*Wt+Ht*Ht})}}if(this.fogCullDistSq){const Ye=this.fogCullDistSq,xt=this.horizonLineFromTop();dt=dt.filter(gt=>{const Et=[0,0,0,1],ht=[i.ai,i.ai,0,1],Mt=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());i.ad.vec4.transformMat4(Et,Et,Mt),i.ad.vec4.transformMat4(ht,ht,Mt);const Vt=i.ad.vec4.min([],Et,ht),Wt=i.ad.vec4.max([],Et,ht),Ht=i.bW(Vt,Wt);if(Ht===0)return!0;let ir=!1;const Or=this._elevation;if(Or&&Ht>Ye&&xt!==0){const vr=this.calculateProjMatrix(gt.tileID.toUnwrapped());let Mr;s.isTerrainDEM||(Mr=Or.getMinMaxForTile(gt.tileID)),Mr||(Mr={min:Me,max:Oe});const Tr=i.c7(this.rotation),tn=[Tr[0]*i.ai,Tr[1]*i.ai,Mr.max];i.ad.vec3.transformMat4(tn,tn,vr),ir=(1-tn[1])*this.height*.5<xt}return Ht<Ye||ir})}return dt.sort((Ye,xt)=>Ye.distanceSq-xt.distanceSq).map(Ye=>Ye.tileID)}resize(s,u){this.width=s,this.height=u,this.pixelsToGLUnits=[2/s,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const u=i.ay(s.lat,-i.bX,i.bX),g=this.projection.project(s.lng,u);return new i.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,u){let g,x;const S=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;g=(u.x-S.x)/L,x=(u.y-S.y)/L}else{const L=this.pointCoordinate(u),z=this.pointCoordinate(S);g=L.x-z.x,x=L.y-z.y}const A=this.locationCoordinate(s);this.setLocation(new i.ac(A.x-g,A.y-x))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,u){return this.projection.locationPoint(this,s,u)}locationPoint3D(s,u){return this.projection.locationPoint(this,s,u,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,u){return this.coordinateLocation(this.pointCoordinate3D(s,u))}locationCoordinate(s,u){const g=u?i.bH(u,s.lat):void 0,x=this.projection.project(s.lng,s.lat);return new i.ac(x.x,x.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,u){const g=u??this._centerAltitude,x=[s.x,s.y,0,1],S=[s.x,s.y,1,1];i.ad.vec4.transformMat4(x,x,this.pixelMatrixInverse),i.ad.vec4.transformMat4(S,S,this.pixelMatrixInverse);const A=S[3];i.ad.vec4.scale(x,x,1/x[3]),i.ad.vec4.scale(S,S,1/A);const L=x[2],z=S[2];return{p0:x,p1:S,t:L===z?0:(g-L)/(z-L)}}screenPointToMercatorRay(s){const u=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return i.ad.vec4.transformMat4(u,u,this.pixelMatrixInverse),i.ad.vec4.transformMat4(g,g,this.pixelMatrixInverse),i.ad.vec4.scale(u,u,1/u[3]),i.ad.vec4.scale(g,g,1/g[3]),u[2]=i.bH(u[2],this._center.lat)*this.worldSize,g[2]=i.bH(g[2],this._center.lat)*this.worldSize,i.ad.vec4.scale(u,u,1/this.worldSize),i.ad.vec4.scale(g,g,1/this.worldSize),new i.as([u[0],u[1],u[2]],i.ad.vec3.normalize([],i.ad.vec3.sub([],g,u)))}rayIntersectionCoordinate(s){const{p0:u,p1:g,t:x}=s,S=i.bH(u[2],this._center.lat),A=i.bH(g[2],this._center.lat);return new i.ac(i.ah(u[0],g[0],x)/this.worldSize,i.ah(u[1],g[1],x)/this.worldSize,i.ah(S,A,x))}pointCoordinate(s,u=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,u)}pointCoordinate3D(s,u){if(!this.elevation)return this.pointCoordinate(s,u);let g=this.projection.pointCoordinate3D(this,s.x,s.y);if(g)return new i.ac(g[0],g[1],g[2]);let x=0,S=this.horizonLineFromTop();if(s.y>S)return this.pointCoordinate(s,u);const A=.02*S,L=s.clone();for(let z=0;z<10&&S-x>A;z++){L.y=i.ah(x,S,.66);const B=this.projection.pointCoordinate3D(this,L.x,L.y);B?(S=L.y,g=B):x=L.y}return g?new i.ac(g[0],g[1],g[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(s);const u=this.pointCoordinate(s);return u.y>=0&&u.y<=1}_coordinatePoint(s,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,x=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return i.ad.vec4.transformMat4(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,S=this.pointLocation3D(new i.P(u,s)),A=this.pointLocation3D(new i.P(x,s)),L=this.pointLocation3D(new i.P(x,g)),z=this.pointLocation3D(new i.P(u,g));let B=Math.min(S.lng,A.lng,L.lng,z.lng),V=Math.max(S.lng,A.lng,L.lng,z.lng),X=Math.min(S.lat,A.lat,L.lat,z.lat),Y=Math.max(S.lat,A.lat,L.lat,z.lat);const re=Math.pow(2,-this.zoom)/16*270,ce=this.projection.name==="globe"?1:4,ae=(fe,me,be,Ee,Te)=>{const Oe=(fe+be)/2,Me=(me+Ee)/2,Ce=new i.P(Oe,Me),{lng:Pe,lat:Ne}=this.pointLocation3D(Ce),Ue=Math.max(0,B-Pe,X-Ne,Pe-V,Ne-Y);B=Math.min(B,Pe),V=Math.max(V,Pe),X=Math.min(X,Ne),Y=Math.max(Y,Ne),(Te<ce||Ue>re)&&(ae(fe,me,Oe,Me,Te+1),ae(Oe,Me,be,Ee,Te+1))};if(ae(u,s,x,s,1),ae(x,s,x,g,1),ae(x,g,u,g,1),ae(u,g,u,s,1),this.projection.name==="globe"){const[fe,me]=i.bZ(this);fe?(Y=90,V=180,B=-180):me&&(X=-90,V=180,B=-180)}return new i.aB(new i.bO(B,X),new i.bO(V,Y))}_getBoundsRectangular(s,u){const{top:g,left:x}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,L=new i.P(x,g),z=new i.P(A,g),B=new i.P(A,S),V=new i.P(x,S);let X=this.pointCoordinate(L,s),Y=this.pointCoordinate(z,s);const re=this.pointCoordinate(B,u),ce=this.pointCoordinate(V,u),ae=(fe,me)=>(me.y-fe.y)/(me.x-fe.x);return X.y>1&&Y.y>=0?X=new i.ac((1-ce.y)/ae(ce,X)+ce.x,1):X.y<0&&Y.y<=1&&(X=new i.ac(-ce.y/ae(ce,X)+ce.x,0)),Y.y>1&&X.y>=0?Y=new i.ac((1-re.y)/ae(re,Y)+re.x,1):Y.y<0&&X.y<=1&&(Y=new i.ac(-re.y/ae(re,Y)+re.x,0)),new i.aB().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(re))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=s.visibleDemTiles.reduce((g,x)=>{if(x.dem){const S=x.dem.tree;g.min=Math.min(g.min,S.minimums[0]),g.max=Math.max(g.max,S.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*s.exaggeration(),u.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.av(this.minLng)*this.tileSize,this.worldMaxX=i.av(this.maxLng)*this.tileSize,this.worldMinY=i.aC(this.maxLat)*this.tileSize,this.worldMaxY=i.aC(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,u){return this.projection.createTileMatrix(this,u,s)}calculateDistanceTileData(s){const u=s.key,g=this._distanceTileDataCache;if(g[u])return g[u];const x=s.canonical,S=1/this.height,A=this.cameraWorldSize,L=A/this.zoomScale(x.z),z=(x.x+Math.pow(2,x.z)*s.wrap)*L,B=x.y*L,V=this.point;V.x*=A/this.worldSize,V.y*=A/this.worldSize;const X=this.angle,Y=Math.sin(-X),re=-Math.cos(-X);return g[u]={bearing:[Y,re],center:[(V.x-z)*S,(V.y-B)*S],scale:L/i.ai*S},g[u]}calculateFogTileMatrix(s){const u=s.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return i.ad.mat4.multiply(x,this.worldToFogMatrix,x),g[u]=new Float32Array(x),g[u]}calculateProjMatrix(s,u=!1,g=!1){const x=s.key;let S;if(S=g?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,S[x])return S[x];const A=this.calculatePosMatrix(s,this.worldSize);let L;return L=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,i.ad.mat4.multiply(A,L,A),S[x]=new Float32Array(A),S[x]}calculatePixelsToTileUnitsMatrix(s){const u=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const x=i.b_(s,this);return g[u]=x,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,u=i.ad.mat4.fromScaling([],[s,s,s]);return i.ad.mat4.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const u=i.bH(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),x=this._camera.forward(),S=i.bH(1,this._center.lat);g[2]/=S,x[2]/=S,i.ad.vec3.normalize(x,x);const A=s.raycast(g,x,s.exaggeration());if(A){const L=i.ad.vec3.scaleAndAdd([],g,x,A),z=new i.ac(L[0],L[1],i.bH(L[2],i.aT(L[1]))),B=(z.z+i.ad.vec3.length([z.x-g[0],z.y-g[1],z.z-g[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const u=this._elevation,g=i.bH(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(g),S=u.getAtPointOrZero(new i.ac(...x)),A=this.pixelsPerMeter/this.worldSize*S,L=this._minimumHeightOverTerrain(),z=x[2]-A;if(z<=L)if(z<0||s){const B=this.locationCoordinate(this._center,this._centerAltitude),V=[x[0],x[1],B.z-x[2]],X=i.ad.vec3.length(V);V[2]-=(L-z)/this._pixelsPerMercatorPixel;const Y=i.ad.vec3.length(V);if(Y===0)return;i.ad.vec3.scale(V,V,X/Y*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],B.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const Y=this.center;return Y.lat=i.ay(Y.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(Y.lng=i.ay(Y.lng,this.minLng,this.maxLng)),this.center=Y,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:x}=this.point;let S=0,A=g,L=x;const z=this.width/2,B=this.height/2,V=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(x-B<V&&(L=V+B),x+B>X&&(L=X-B),X-V<this.height&&(S=Math.max(S,this.height/(X-V)),L=(X+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Y=this.worldMinX*this.scale,re=this.worldMaxX*this.scale,ce=this.worldSize/2-(Y+re)/2;A=(g+ce+this.worldSize)%this.worldSize-ce,A-z<Y&&(A=Y+z),A+z>re&&(A=re-z),re-Y<this.width&&(S=Math.max(S,this.width/(re-Y)),A=(re+Y)/2)}A===g&&L===x||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(A,L))),S&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,u=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const x=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?g:1,A=this._camera.getWorldToCamera(this.worldSize,S);let L;const z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(z[8]=2*-s.x/this.width,z[9]=2*s.y/this.height,this.isOrthographic){let Ne=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ue=Ne*this.aspect,dt=-Ue,et=-Ne;Ue-=s.x,dt-=s.x,Ne+=s.y,et+=s.y,L=this._camera.getCameraToClipOrthographic(dt,Ue,et,Ne,this._nearZ,this._farZ),((wt,Tt,Dt,Qe)=>{for(let bt=0;bt<16;bt++)wt[bt]=i.ah(Tt[bt],Dt[bt],Qe)})(L,L,z,i.c9(this.pitch>=Bt?1:this.pitch/Bt))}else L=z;const B=i.ad.mat4.mul([],z,A);let V=i.ad.mat4.mul([],L,A);if(this.projection.isReprojectedInTileSpace){const Ne=this.locationCoordinate(this.center),Ue=i.ad.mat4.identity([]);i.ad.mat4.translate(Ue,Ue,[Ne.x*this.worldSize,Ne.y*this.worldSize,0]),i.ad.mat4.multiply(Ue,Ue,i.c0(this)),i.ad.mat4.translate(Ue,Ue,[-Ne.x*this.worldSize,-Ne.y*this.worldSize,0]),i.ad.mat4.multiply(V,V,Ue),i.ad.mat4.multiply(B,B,Ue),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ad.mat4.scale([],V,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=V,this.invProjMatrix=i.ad.mat4.invert(new Float64Array(16),this.projMatrix),u){const Ne=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ne[8]=2*-s.x/this.width,Ne[9]=2*s.y/this.height,this.expandedFarZProjMatrix=i.ad.mat4.mul([],Ne,A)}else this.expandedFarZProjMatrix=this.projMatrix;const X=i.ad.mat4.invert([],L);this.frustumCorners=i.c2.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const Y=new Float32Array(16);i.ad.mat4.identity(Y),i.ad.mat4.scale(Y,Y,[1,-1,1]),i.ad.mat4.rotateX(Y,Y,this._pitch),i.ad.mat4.rotateZ(Y,Y,this.angle);const re=i.ad.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ad.mat4.clone(re);const ce=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;re[8]=2*-s.x/this.width,re[9]=2*(s.y+ce)/this.height,this.skyboxMatrix=i.ad.mat4.multiply(Y,re,Y);const ae=this.point,fe=ae.x,me=ae.y,be=this.width%2/2,Ee=this.height%2/2,Te=Math.cos(this.angle),Oe=Math.sin(this.angle),Me=fe-Math.round(fe)+Te*be+Oe*Ee,Ce=me-Math.round(me)+Te*Ee+Oe*be,Pe=new Float64Array(V);if(i.ad.mat4.translate(Pe,Pe,[Me>.5?Me-1:Me,Ce>.5?Ce-1:Ce,0]),this.alignedProjMatrix=Pe,V=i.ad.mat4.create(),i.ad.mat4.scale(V,V,[this.width/2,-this.height/2,1]),i.ad.mat4.translate(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=i.ad.mat4.create(),i.ad.mat4.scale(V,V,[1,-1,1]),i.ad.mat4.translate(V,V,[-1,-1,0]),i.ad.mat4.scale(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=i.ad.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,B),this._calcFogMatrices(),this._distanceTileDataCache={},V=i.ad.mat4.invert(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=V,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ad.vec3.transformMat4(Ne,Ne,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=V;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,S=[s,s,u];i.ad.vec3.scale(S,S,x),i.ad.vec3.scale(g,g,-1),i.ad.vec3.multiply(g,g,S);const A=i.ad.mat4.create();i.ad.mat4.translate(A,A,g),i.ad.mat4.scale(A,A,S),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,u,x)}_computeCameraPosition(s){const u=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-s/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*S,x.y/this.worldSize-g[1]*S,s/this.worldSize*this._centerAltitude-g[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],x=s[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(S=Math.min((u-g)/x,1)),this._camera.position=i.ad.vec3.scaleAndAdd([],this._camera.position,s,S),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),S=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ak(this._maxPitch)),L=Math.max((s[2]-S)/Math.cos(g),A),z=this._zoomFromMercatorZ(L);i.ad.vec3.scaleAndAdd(s,s,u,L),this._pitch=i.ay(g,i.ak(this.minPitch),i.ak(this.maxPitch)),this.angle=i.bF(x,-Math.PI,Math.PI),this._setZoom(i.ay(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ac(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let u=0,g=i.bY,x=0,S=1/0;for(;g-u>1e-6&&g>u;){const A=u+.5*(g-u),L=this.tileSize*Math.pow(2,A),z=this.getCameraToCenterDistance(this.projection,A,L),B=this.scaleZoom(z/(s*this.tileSize)),V=Math.abs(A-B);V<S&&(S=V,x=A),A<B?u=A:g=A}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,u){const g=Math.min(s.x,u.x),x=Math.max(s.x,u.x),S=Math.min(s.y,u.y),A=Math.max(s.y,u.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new i.P(g,S),new i.P(x,A),new i.P(g,A),new i.P(x,S)],z=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const V of L){const X=this.pointRayIntersection(V);if(X.t<0)return!0;const Y=this.rayIntersectionCoordinate(X);if(Y.x<z||Y.y<0||Y.x>B||Y.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(s,u){const g=i.ad.vec3.length(i.ad.vec3.sub([],this._camera.position,s)),x=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([u,g,x],S){const A=[u,g,x,1];i.ad.vec4.transformMat4(A,A,S);const L=A[3]=Math.max(A[3],1e-6);return A[0]/=L,A[1]/=L,A[2]/=L,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,s))}}getCameraToCenterDistance(s,u=this.zoom,g=this.worldSize){const x=i.b$(s,u,this.width,this.height,1024),S=s.pixelSpaceConversion(this.center.lat,g,x);let A=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(A=i.ah(1,A,i.c9(this.pitch>=Bt?1:this.pitch/Bt))),A}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ad.mat4.multiply(s,s,this.globeMatrix),s}getFrustum(s){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const Bc=(y,s)=>{if(s>0&&y.terrain&&i.w("Cutoff is currently disabled on terrain"),s<=0||y.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=y.transform,g=Math.max(Math.abs(u._zoom-(y.minCutoffZoom-1)),1),x=u.isLODDisabled(!1)?i.ae(60,45,u.pitch):i.ae(30,15,u.pitch),S=u._farZ-u._nearZ,A=s*u.height,L=((1-(z=x))*u.cameraToCenterDistance+z*(u._farZ+A))*g;var z;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(L-u._nearZ)/S,(L-A-u._nearZ)/S]}}},Xo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class XE{constructor(s,u){this.aabb=s,this.lastCascade=u}}class ev{add(s,u){const g=this.receivers[s.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],u.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],u.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],u.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],u.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],u.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],u.max[2])):this.receivers[s.key]=new XE(u,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,u,g){const x=i.ce.fromPoints(s.points);let S=0;for(const A in this.receivers){const L=this.receivers[A];if(!L||!x.intersectsAabb(L.aabb))continue;L.aabb.min=x.closestPoint(L.aabb.min),L.aabb.max=x.closestPoint(L.aabb.max);const z=L.aabb.getCorners();for(let B=0;B<g.length;B++){let V=!0;for(const X of z){const Y=[X[0]*u,X[1]*u,X[2]];if(i.ad.vec3.transformMat4(Y,Y,g[B].matrix),Y[0]<-1||Y[0]>1||Y[1]<-1||Y[1]>1){V=!1;break}}if(L.lastCascade=B,S=Math.max(S,B),V)break}}return S+1}}class $c{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new ev,this._depthMode=new hr(s.context.gl.LEQUAL,hr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(Xo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(Xo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(Xo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,u){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const x=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||x<=0||(this._shadowLayerCount=g.style.order.reduce((ce,ae)=>{const fe=g.style._mergedLayers[ae];return ce+(fe.hasShadowPass()&&!fe.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=g.context,A=Xo.shadowMapResolution,L=Xo.shadowMapResolution;if(this._cascades.length===0||Xo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ce=0;ce<Xo.cascadeCount;++ce){const ae=g._shadowMapDebug,fe=S.gl,me=S.createFramebuffer(A,L,ae,"texture"),be=new i.T(S,{width:A,height:L,data:null},fe.DEPTH_COMPONENT16);if(me.depthAttachment.set(be.texture),ae){const Ee=new i.T(S,{width:A,height:L,data:null},fe.RGBA8);me.colorAttachment.set(Ee.texture)}this._cascades.push({framebuffer:me,texture:be,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=Wu(u);let z=0;if(s.elevation){const ce=s.elevation,ae=[1e4,-1e4];ce.visibleDemTiles.filter(fe=>fe.dem).forEach(fe=>{const me=fe.dem.tree;ae[0]=Math.min(ae[0],me.minimums[0]),ae[1]=Math.max(ae[1],me.maximums[0])}),ae[0]!==1e4&&(z=(ae[1]-ae[0])*ce.exaggeration())}const B=1.5*s.cameraToCenterDistance,V=3*B,X=new Float64Array(16);for(let ce=0;ce<this._cascades.length;++ce){const ae=this._cascades[ce];let fe=s.height/50,me=1;Xo.cascadeCount===1?me=V:ce===0?me=B:(fe=B,me=V);const[be,Ee]=yf(s,this.shadowDirection,fe,me,Xo.shadowMapResolution,z);ae.scale=s.scale,ae.matrix=be,ae.boundingSphereRadius=Ee,i.ad.mat4.invert(X,ae.matrix),ae.frustum=i.bR.fromInvProjectionMatrix(X,1,0,!0),ae.far=me}const Y=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Y].far,this._cascades[Y].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Xo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Xo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ii.ShadowMap0,this._uniformValues.u_shadowmap_1=Ii.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const re=g.transform.elevation;for(const ce of this._groundShadowTiles){let ae={min:0,max:0};if(re){const fe=re.getMinMaxForTile(ce);fe&&(ae=fe)}this.addShadowReceiver(ce.toUnwrapped(),ae.min,ae.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,u){if(!this.enabled)return;const g=this.painter,x=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),x.viewport.set([0,0,Xo.shadowMapResolution,Xo.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){g.currentShadowCascade=S,x.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),x.clear({color:i.al.white,depth:1});for(const A of s.order){const L=s._mergedLayers[A];if(!L.hasShadowPass()||L.isHidden(g.transform.zoom))continue;const z=s.getLayerSourceCache(L),B=z?u[z.id]:void 0;(L.type==="model"||B&&B.length)&&g.renderLayer(g,z,L,B)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,u=s.style,g=s.context,x=u.directionalLight,S=u.ambientLight;if(!x||!S)return;const A=[],L=Bc(s,s.longestCutoffRange);L.shouldRenderCutoff&&A.push("RENDER_CUTOFF"),A.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&A.push("NORMAL_OFFSET");const z=gf(u,x,S),B=new hr(g.gl.LEQUAL,hr.ReadOnly,s.depthRangeFor3D);for(const V of this._groundShadowTiles){const X=V.toUnwrapped(),Y=s.isTileAffectedByFog(V),re=s.getOrCreateProgram("groundShadow",{defines:A,overrideFog:Y});this.setupShadows(X,re),s.uploadCommonUniforms(g,re,X,null,L);const ce={u_matrix:s.transform.calculateProjMatrix(X),u_ground_shadow_factor:z};re.draw(s,g.gl.TRIANGLES,B,Dr.disabled,Xr.multiply,Ir.disabled,ce,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Xr.unblended:Xr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const u=this.painter.transform,g=u.calculatePosMatrix(s,u.worldSize);return i.ad.mat4.multiply(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(s){return i.ad.mat4.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,u,g,x=0){if(!this.enabled)return;const S=this.painter.transform,A=this.painter.context,L=A.gl,z=this._uniformValues,B=new Float64Array(16),V=S.calculatePosMatrix(s,S.worldSize);for(let X=0;X<this._cascades.length;X++)i.ad.mat4.multiply(B,this._cascades[X].matrix,V),z[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(B),A.activeTexture.set(L.TEXTURE0+Ii.ShadowMap0+X),this._cascades[X].texture.bind(L.NEAREST,L.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){const X=i.cd(s.canonical),Y=2/S.tileSize*i.ai/Xo.shadowMapResolution,re=Y*this._cascades[0].boundingSphereRadius,ce=Y*this._cascades[this._cascades.length-1].boundingSphereRadius,ae=(g==="vector-tile"?1:3)/Math.pow(2,x-s.canonical.z-(1-S.zoom+Math.floor(S.zoom)));z.u_shadow_normal_offset=[X,re*ae,ce*ae],z.u_shadow_bias=[6e-5,.0012,.012]}else z.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(A,z)}setupShadowsFromMatrix(s,u,g=!1){if(!this.enabled)return;const x=this.painter.context,S=x.gl,A=this._uniformValues,L=new Float64Array(16);for(let z=0;z<Xo.cascadeCount;z++)i.ad.mat4.multiply(L,this._cascades[z].matrix,s),A[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),x.activeTexture.set(S.TEXTURE0+Ii.ShadowMap0+z),this._cascades[z].texture.bind(S.NEAREST,S.CLAMP_TO_EDGE);if(this.useNormalOffset=g,g){const z=Xo.normalOffset;A.u_shadow_normal_offset=[1,z,z],A.u_shadow_bias=[6e-5,.0012,.012]}else A.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(x,A)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,u,g,x){if(x[2]>=0)return{};const S=function(z,B,V){const X=V/(1<<z.canonical.z);return new i.ce([z.canonical.x*X+z.wrap*V,z.canonical.y*X+z.wrap*V,0],[(z.canonical.x+1)*X+z.wrap*V,(z.canonical.y+1)*X+z.wrap*V,B])}(s,u,g).getCorners(),A=u/-x[2];x[0]<0?(i.ad.vec3.add(S[0],S[0],[x[0]*A,0,0]),i.ad.vec3.add(S[3],S[3],[x[0]*A,0,0])):x[0]>0&&(i.ad.vec3.add(S[1],S[1],[x[0]*A,0,0]),i.ad.vec3.add(S[2],S[2],[x[0]*A,0,0])),x[1]<0?(i.ad.vec3.add(S[0],S[0],[0,x[1]*A,0]),i.ad.vec3.add(S[1],S[1],[0,x[1]*A,0])):x[1]>0&&(i.ad.vec3.add(S[2],S[2],[0,x[1]*A,0]),i.ad.vec3.add(S[3],S[3],[0,x[1]*A,0]));const L={};return L.vertices=S,L.planes=[mf(S[1],S[0],S[4]),mf(S[2],S[1],S[5]),mf(S[3],S[2],S[6]),mf(S[0],S[3],S[7])],L}addShadowReceiver(s,u,g){this._receivers.add(s,i.ce.fromTileIdAndHeight(s,u,g))}getMaxCascadeForTile(s){const u=this._receivers.get(s);return u&&u.lastCascade?u.lastCascade:0}}function mf(y,s,u){const g=i.ad.vec3.sub([],u,s),x=i.ad.vec3.sub([],y,s),S=i.ad.vec3.cross([],g,x),A=i.ad.vec3.length(S);return A===0?[0,0,1,0]:(i.ad.vec3.scale(S,S,1/A),[S[0],S[1],S[2],-i.ad.vec3.dot(S,s)])}function Wu(y){const s=y.properties.get("direction"),u=i.cc(s.x,s.y,s.z);u[2]=i.ay(u[2],0,75);const g=i.cf([u[0],u[1],u[2]]);return i.ad.vec3.fromValues(g.x,g.y,g.z)}function gf(y,s,u){const g=s.properties.get("color-use-theme")==="none",x=s.properties.get("color"),S=s.properties.get("intensity"),A=s.properties.get("direction"),L=[A.x,A.y,A.z],z=u.properties.get("color-use-theme")==="none",B=u.properties.get("color"),V=u.properties.get("intensity"),X=Math.max(i.ad.vec3.dot([0,0,1],L),0),Y=[0,0,0];i.ad.vec3.scale(Y,B.toRenderColor(z?null:y.getLut(s.scope)).toArray01Linear().slice(0,3),V);const re=[0,0,0];return i.ad.vec3.scale(re,x.toRenderColor(g?null:y.getLut(u.scope)).toArray01Linear().slice(0,3),X*S),i.cg([Y[0]>0?Y[0]/(Y[0]+re[0]):0,Y[1]>0?Y[1]/(Y[1]+re[1]):0,Y[2]>0?Y[2]/(Y[2]+re[2]):0])}function yf(y,s,u,g,x,S){const A=y.zoom,L=y.scale,z=y.worldSize,B=1/z,V=y.aspect,X=Math.sqrt(1+V*V)*Math.tan(.5*y.fovX),Y=X*X,re=g-u,ce=g+u;let ae,fe;Y>re/ce?(ae=g,fe=g*X):(ae=.5*ce*(1+Y),fe=.5*Math.sqrt(re*re+2*(g*g+u*u)*Y+ce*ce*Y*Y));const me=y.projection.pixelsPerMeter(y.center.lat,z),be=y._camera.getCameraToWorldMercator(),Ee=[0,0,-ae*B];i.ad.vec3.transformMat4(Ee,Ee,be);let Te=fe*B;const Oe=y._edgeInsets;if(!(Oe.left===0&&Oe.top===0&&Oe.right===0&&Oe.bottom===0||Oe.left===Oe.right&&Oe.top===Oe.bottom)){const Et=y._camera.getWorldToCamera(y.worldSize,y.projection.zAxisUnit==="meters"?me:1),ht=y._camera.getCameraToClipPerspective(y._fov,y.width/y.height,u,g);ht[8]=2*-y.centerOffset.x/y.width,ht[9]=2*y.centerOffset.y/y.height;const Mt=new Float64Array(16);i.ad.mat4.mul(Mt,ht,Et);const Vt=new Float64Array(16);i.ad.mat4.invert(Vt,Mt);const Wt=i.bR.fromInvProjectionMatrix(Vt,z,A,!0);for(const Ht of Wt.points){const ir=((Me=Ht)[0]/=L,Me[1]/=L,Me[2]=i.bH(Me[2],y._center.lat),Me);Te=Math.max(Te,i.ad.vec3.len(i.ad.vec3.subtract([],Ee,ir)))}}var Me;Te*=x/(x-1);const Ce=Math.acos(s[2]),Pe=Math.atan2(-s[0],-s[1]),Ne=new pf;Ne.position=Ee,Ne.setPitchBearing(Ce,Pe);const Ue=Ne.getWorldToCamera(z,me),dt=Te*z,et=Math.min(y._mercatorZfromZoom(17)*z*-2,-2*dt),wt=Ne.getCameraToClipOrthographic(-dt,dt,-dt,dt,et,(dt+S*me)/s[2]),Tt=new Float64Array(16);i.ad.mat4.multiply(Tt,wt,Ue);const Dt=i.ad.vec3.fromValues(Math.floor(1e6*Ee[0])/1e6*z,Math.floor(1e6*Ee[1])/1e6*z,0),Qe=.5*x,bt=[0,0,0];i.ad.vec3.transformMat4(bt,Dt,Tt),i.ad.vec3.scale(bt,bt,Qe);const Ye=[Math.floor(bt[0]),Math.floor(bt[1]),Math.floor(bt[2])],xt=[0,0,0];i.ad.vec3.sub(xt,bt,Ye),i.ad.vec3.scale(xt,xt,-1/Qe);const gt=new Float64Array(16);return i.ad.mat4.identity(gt),i.ad.mat4.translate(gt,gt,xt),i.ad.mat4.multiply(Tt,gt,Tt),[Tt,dt]}class $R extends i.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(s,u){return i.aN(this.requestManager.transformRequest(u,i.R.Model).url).then(g=>{if(!g)return;const x=i.aO(g),S=new i.aP(s,void 0,void 0,x);return S.computeBoundsAndApplyParent(),S}).catch(g=>{if(g&&g.status===404)return null;this.fire(new i.z(new Error(`Could not load model ${s} from ${u}: ${g.message}`)))})}load(s,u,g={keepNumReferences:!1}){this.models[u]||(this.models[u]={});const x=Object.keys(s);this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+x.length;const S=[];for(const A of x)S.push(this.loadModel(A,s[A]));Promise.allSettled(S).then(A=>{for(let L=0;L<A.length;L++){const{status:z,value:B}=A[L];if(z==="fulfilled"&&B){const V=this.models[u][x[L]];this.models[u][x[L]]={model:B,numReferences:g.keepNumReferences&&V?V.numReferences:1}}}this.numModelsLoading[u]-=x.length,this.fire(new i.A("data",{dataType:"style"}))}).catch(A=>{this.fire(new i.z(new Error(`Could not load models: ${A.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,u){return!!this.getModel(s,u)}getModel(s,u){return this.models[u]||(this.models[u]={}),this.models[u][s]?this.models[u][s].model:void 0}addModel(s,u,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={}),this.hasModel(s,g)&&this.models[g][s].numReferences++,this.modelUris[g][s]=this.requestManager.normalizeModelURL(u),this.load({[s]:this.modelUris[g][s]},g)}addModels(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g=this.modelUris[u];for(const x in s)this.models[u][x]={},g[x]=this.requestManager.normalizeModelURL(s[x]);this.load(g,u,{keepNumReferences:!0})}reloadModels(s){this.load(this.modelUris[s],s)}addModelsFromBucket(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g={};for(const x of s)this.hasModel(x,u)?this.models[u][x].numReferences++:(this.modelUris[u][x]=this.requestManager.normalizeModelURL(x),g[x]=this.modelUris[u][x]);this.load(g,u)}removeModel(s,u){if(this.models[u]&&this.models[u][s]&&(this.models[u][s].numReferences--,this.models[u][s].numReferences===0)){const g=this.models[u][s].model;delete this.models[u][s],delete this.modelUris[u][s],g.destroy()}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,u){this.models[u]||(this.models[u]={});for(const g in this.models[u])this.models[u][g].model&&this.models[u][g].model.upload(s.context)}}const UR=new i.a7({data:new i.a8(i.a5.colorTheme.data)}),fb={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function YE(y){return y=y||{},Object.assign(y,fb)}class KE extends i.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aQ(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(A,L){const[z,B]=A,{center:V,radius:X}=L,[Y,re]=V,ce=Math.abs(z-Y);return Math.sqrt((ce>180?360-ce:ce)**2+(B-re)**2)<=X}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.A("floorplangone")));const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=new i.P(this._map.transform.width/2,this._map.transform.height/2),x=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(s?x:g,u);S.length>0&&(this._selectedFloorplan&&S[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=S[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(S){const[[A,L],[z,B]]=S,V=(z-A+360)%360,X=V>180?360-V:V;return{center:[(A+X/2+360)%360,(L+B)/2],radius:Math.sqrt(X**2+(B-L)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const u=this._floorplanStates[this._indoorData.id].selectedBuilding,g=this._floorplanStates[this._indoorData.id].selectedLevel;let x;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const S of this._indoorData.levels)S.id===this._selectedLevel.id&&(x=S.id);if(this.fire(new i.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:x})),u){const S=this._indoorData.buildings.find(A=>A.id===u);this._buildingSelected(S,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(g){const S=this._indoorData.levels.find(A=>A.id===g);this._updateLevels(S,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,u){u&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const g=this._indoorData.levels.filter(x=>s.levels.includes(x.id));this.fire(new i.A("buildingselected",{buildingId:s.id,levels:g}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{const u=this._indoorData.levels.find(g=>g.id===s);this._updateLevels(u,!0)}this.fire(new i.A("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,u){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(u&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function g(B){const V=B.indexOf("/floor/");if(V===-1)return B;const X=V+7,Y=B.indexOf("/",X);return Y===-1?B.slice(X):B.slice(X,Y)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const x=[],S={},A={},L={},z={};for(const B of this._indoorData.levels)if(x.push(B.id),S[B.id]=B.height,A[B.id]=B.base,s){if(this.mergeFloors){const V=g(s.id),X=g(B.id);L[B.id]=X===V?"true":"false"}else L[B.id]=B.id===s.id?"true":"false";z[B.id]=B.base<s.base?"true":"false"}else z[B.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",L]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",z]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),u&&s.extent)){const B=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),V=this._map.getZoom(),X=B.zoom?Math.abs(V-B.zoom):0;this._map.fitBounds(s.extent,X>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:V})}}selectFloorplan(s){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(g,u);if(x.length>0){for(const S of x)if(JSON.parse(S.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=S,this._floorplanSelected(!0);break}}}selectBuilding(s){const u=this._indoorData.buildings.find(g=>g.id===s);this._buildingSelected(u,!0)}selectLevel(s){this._levelSelected(s)}}function JE(y){if(!y.metadata||!y.metadata.content_area)return;const s=i.q.devicePixelRatio,{left:u,top:g,width:x,height:S}=y.metadata.content_area,A=u*s,L=g*s;return[A,L,A+x*s,L+S*s]}function tv(y){if(y)return y.map(([s,u])=>[s*i.q.devicePixelRatio,u*i.q.devicePixelRatio])}class VR{constructor(s,u){this.id=s,this.style=u}addIcons(s){const u=new Map;for(const[g,x]of s.entries()){const S=i.I.from({name:g,iconsetId:this.id});u.set(S,x)}this.style.addImages(u)}}const Zd=(y,s)=>lt(y,s&&s.filter(u=>u.identifier!=="source.canvas")),WR=i.aA(fn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),GR=i.aA(fn,["setCenter","setZoom","setBearing","setPitch"]),rv=new Set(["background","sky","slot","custom"]),QE={version:8,layers:[],sources:{}},jm={duration:300,delay:0};class Sl extends i.E{constructor(s,u={}){super(),this.map=s,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=i.l({},jm),this._buildingIndex=new GE(this),this.crossTileSymbolIndex=new BR,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new Pr,this.dispatcher=u.dispatcher?u.dispatcher:new i.D(i.cj(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new hn(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new i.ck(s._requestManager,u.localFontFamily?i.cl.all:u.localIdeographFontFamily?i.cl.ideographs:i.cl.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new $R(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",i.cm());const g=this;this._rtlTextPluginCallback=Sl.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(S,A)=>{if(i.cn(S),A&&A.every(L=>L))for(const L in g._sourceCaches){const z=g._sourceCaches[L],B=z.getSource().type;B!=="vector"&&B!=="geojson"||z.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const S=this.getOwnSource(x.sourceId);if(S&&S.vectorLayerIds)for(const A in this._layers){const L=this._layers[A];L.source===S.id&&this._validateLayer(L)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(i.f(s))return s;const u=i.co(s);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${i.cp(JSON.stringify(s))}`}_diffStyle(s,u,g){this.globalId=this._getGlobalId(s);const x=(S,A)=>{try{A(null,this.setState(S,g))}catch(L){A(L,!1)}};if(typeof s=="string"){const S=this.map._requestManager.normalizeStyleURL(s),A=this.map._requestManager.transformRequest(S,i.R.Style);i.n(A,(L,z)=>{L?this.fire(new i.z(L)):z&&x(z,u)})}else typeof s=="object"&&x(s,u)}loadURL(s,u={}){this.fire(new i.A("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!i.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,u.accessToken),this.resolvedImports.add(s);const x=this.importsCache.get(s);if(x)return this._load(x,g);const S=this.map._requestManager.transformRequest(s,i.R.Style);this._request=i.n(S,(A,L)=>{if(this._request=null,A)this.fire(new i.z(A));else if(L)return this.importsCache.set(s,L),this._load(L,g)})}loadJSON(s,u={}){this.fire(new i.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=i.q.frame(()=>{this._request=null,this._load(s,u.validate!==!1)})}loadEmpty(){this.fire(new i.A("dataloading",{dataType:"style"})),this._load(QE,!1)}_loadImports(s,u,g){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const S of s){const A=this._createFragmentStyle(S),L=new Promise(V=>{A.once("style.import.load",V),A.once("error",V)}).then(()=>this.mergeAll());if(x.push(L),this.resolvedImports.has(S.url)){A.loadEmpty();continue}const z=S.data||this.importsCache.get(S.url);z?(A.loadJSON(z,{validate:u}),this._isInternalStyle(z)&&(A.globalId=null)):S.url?A.loadURL(S.url,{validate:u}):A.loadEmpty();const B={style:A,id:S.id,config:S.config};if(g){const V=this.fragments.findIndex(({id:X})=>X===g);this.fragments=this.fragments.slice(0,V).concat(B).concat(this.fragments.slice(V))}else this.fragments.push(B)}return Promise.allSettled(x)}getImportGlobalIds(s=this,u=new Set){for(const g of s.fragments)g.style.globalId&&u.add(g.style.globalId),this.getImportGlobalIds(g.style,u);return[...u.values()]}_createFragmentStyle(s){const u=this.scope?i.C(s.id,this.scope):s.id;let g;const x=this._initialConfig&&this._initialConfig[u];(s.config||x)&&(g=i.l({},s.config,x));const S=new Sl(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,u){const g=s.indoor?YE(s.schema):s.schema;if(this._isInternalStyle(s)){const A=i.l({},QE,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(A,u)}if(this.updateConfig(this._config,g),u&&Zd(this,Li(s)))return;this._loaded=!0,this.stylesheet=i.cq(s);const x=()=>{for(const B in s.sources)this.addSource(B,s.sources[B],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const B in s.iconsets)this.addIconset(B,s.iconsets[B]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(s.glyphs);const A=Im(this.stylesheet.layers);if(this._order=A.map(B=>B.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const B=this.stylesheet.lights[0];this.light=new ft(B.properties,B.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ft(this.stylesheet.light)),this._layers={};for(const B of A){const V=i.cv(B,this.scope,this._styleColorTheme.lut,this.options);V.configDependencies.size!==0&&this._configDependentLayers.add(V.fqid),V.setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V;const X=this.getOwnLayerSourceCache(V),Y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&V.canCastShadows()&&Y&&(X.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const L=this.stylesheet.terrain;L&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(L,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.A("data",{dataType:"style"}));const z=this.isRootStyle();s.imports?this._loadImports(s.imports,u).then(()=>{this._reloadImports(),this.fire(new i.A(z?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.A(z?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const S=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(S){const A=this._evaluateColorThemeData(S);this._loadColorTheme(A).then(()=>{x()}).catch(L=>{i.w(`Couldn't load color theme from the stylesheet: ${L}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,u,g,x,S,A,L,z,B,V;const X={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Y=>{if(Y.stylesheet){if(Y.light!=null&&(s=Y.light),Y.stylesheet.lights)for(const re of Y.stylesheet.lights)re.type==="ambient"&&Y.ambientLight!=null&&(u=Y.ambientLight),re.type==="directional"&&Y.directionalLight!=null&&(g=Y.directionalLight);x=this._prioritizeTerrain(x,Y.terrain,Y.stylesheet.terrain),Y.stylesheet.fog&&Y.fog!=null&&(S=Y.fog),Y.stylesheet.snow&&Y.snow!=null&&(A=Y.snow),Y.stylesheet.rain&&Y.rain!=null&&(L=Y.rain),Y.stylesheet.camera!=null&&(V=Y.stylesheet.camera),Y.stylesheet.projection!=null&&(z=Y.stylesheet.projection),Y.stylesheet.transition!=null&&(B=Y.stylesheet.transition),X[Y.scope]=Y._styleColorTheme}}),this.light=s,this.ambientLight=u,this.directionalLight=g,this.fog=S,this.snow=A,this.rain=L,this._styleColorThemeForScope=X,x===null?delete this.terrain:this.terrain=x,this.camera=V||{"camera-projection":"perspective"},this.projection=z||{name:"mercator"},this.transition=i.l({},jm,B),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const u=g=>{for(const x of g.fragments)u(x.style);s(g)};u(this)}_prioritizeTerrain(s,u,g){const x=s&&s.drapeRenderMode===0;return g===null?u&&u.drapeRenderMode===0?u:x?s:null:u!=null&&(!s||x||u&&u.drapeRenderMode===1)?u:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{s=this._prioritizeTerrain(s,u.terrain,u.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(s=u.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},u={},g={};this.forEachFragmentStyle(x=>{for(const S in x._sourceCaches){const A=i.C(S,x.scope);s[A]=x._sourceCaches[S]}for(const S in x._otherSourceCaches){const A=i.C(S,x.scope);u[A]=x._otherSourceCaches[S]}for(const S in x._symbolSourceCaches){const A=i.C(S,x.scope);g[A]=x._symbolSourceCaches[S]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=g}mergeLayers(){const s={},u=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const A of S._order){const L=S._layers[A];if(L.type==="slot"){const z=i.cr(A);if(s[z])continue;s[z]=[]}L.slot&&s[L.slot]?s[L.slot].push(L):u.push(L)}}),this._mergedOrder=[];const x=(S=[])=>{for(const A of S)if(A.type==="slot"){const L=i.cr(A.id);s[L]&&x(s[L]),this._mergedSlots.push(L)}else{const L=i.C(A.id,A.scope);this._mergedOrder.push(L),g[L]=A,A.is3D(!!this.terrain)&&(this._has3DLayers=!0),A.type==="circle"&&(this._hasCircleLayers=!0),A.type==="symbol"&&(this._hasSymbolLayers=!0),A.type==="clip"&&(this._clipLayerPresent=!0)}};x(u),this._mergedOrder.sort((S,A)=>{const L=g[S],z=g[A];return L.hasInitialOcclusionOpacityProperties?z.is3D(!!this.terrain)?1:0:L.is3D(!!this.terrain)&&z.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=i.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(u,g,x){const S=i.l({},g);for(const L of Object.keys(i.a5.colorTheme))S[L]===void 0&&(S[L]=i.a5.colorTheme[L].default);const A=new i.a6(UR,u,new Map(x));return A.setTransitionOrValue(S,x),A.untransitioned().possiblyEvaluate(new i.aa(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,x)=>{const S="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let A=s;A.startsWith(S)||(A=S+A);const L=i.I.from("mapbox-reserved-lut"),z=new Image;z.src=A,z.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},z.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void g();this._styleColorTheme.lutLoading=!1;const{width:B,height:V,data:X}=i.q.getImageData(z);if(V>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(B!==V*V)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(L)&&this.removeImage(L),this.addImage(L,{data:new i.r({width:B,height:V},X),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Y=this.imageManager.getImage(L,this.scope);Y?(this._styleColorTheme.lut={image:Y.data,data:s},g()):x(new Error("Missing LUT image."))}})}getLut(s){const u=this._styleColorThemeForScope[s];return u?u.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(u,g,x){let S,A,L;const z=i.q.devicePixelRatio>1?"@2x":"";let B=i.n(g.transformRequest(g.normalizeSpriteURL(u,z,".json"),i.R.SpriteJSON),(Y,re)=>{B=null,L||(L=Y,S=re,X())}),V=i.o(g.transformRequest(g.normalizeSpriteURL(u,z,".png"),i.R.SpriteImage),(Y,re)=>{V=null,L||(L=Y,A=re,X())});function X(){if(L)x(L);else if(S&&A){const Y=i.q.getImageData(A),re={};for(const ce in S){const{width:ae,height:fe,x:me,y:be,sdf:Ee,pixelRatio:Te,stretchX:Oe,stretchY:Me,content:Ce}=S[ce],Pe=new i.r({width:ae,height:fe});i.r.copy(Y,Pe,{x:me,y:be},{x:0,y:0},{width:ae,height:fe},null),re[ce]={data:Pe,pixelRatio:Te,sdf:Ee,stretchX:Oe,stretchY:Me,content:Ce,usvg:!1}}x(null,re)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(s,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new i.z(u));else if(g){const x=new Map;for(const S in g)x.set(i.I.from(S),g[S]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))})}addIconset(s,u){if(u.type==="sprite")return void this._loadSprite(u.url);const g=this.getOwnSource(u.source);if(!g)return void this.fire(new i.z(new Error(`Source "${u.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));if(g.type!=="raster-array")return void this.fire(new i.z(new Error(`Source "${u.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));this.imageManager.createIconset(this.scope,s);const x=new VR(s,this);g.addIconset(s,x)}_loadIconset(s){if(!i.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const u=this.map._spriteFormat==="auto";var g,x;this._spriteRequest=(x=(S,A)=>{if(this._spriteRequest=null,S)u?this._loadSprite(s):this.fire(new i.z(S));else if(A){const L=new Map;for(const z in A)L.set(i.I.from(z),A[z]);this.addImages(L)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))},i.bj((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(s),i.R.Iconset),(S,A)=>{if(S)return void x(S);const L={},z=i.ch(new i.bi(A));for(const B of z.icons){const V={version:1,pixelRatio:i.q.devicePixelRatio,content:JE(B),stretchX:B.metadata?tv(B.metadata.stretch_x_areas):void 0,stretchY:B.metadata?tv(B.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:B};L[B.name]=V}x(null,L)}))}_validateLayer(s){const u=this.getOwnSource(s.source);if(!u)return;const g=s.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.z(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,u)=>{const g=this.fragments[u];return g&&g.style&&(s.data=g.style.serialize()),s})}_serializeSources(){const s={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();s[g.id]||(s[g.id]=g.serialize())}return s}_serializeLayers(s){const u=[];for(const g of s){const x=this._layers[g];x&&x.type!=="custom"&&u.push(x.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const u=this.getOwnLayer(s);if(u)return u;this.fire(new i.z(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const u=this.getOwnSource(s);if(u)return u;this.fire(new i.z(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,u){const g=this.map.painter;if(g)for(let x=s.minzoom||0;x<(s.maxzoom||25.5);x++){const S=s.getProgramIds();if(S)for(const A of S){const L=s.getDefaultProgramParams(A,u.zoom,this._styleColorTheme.lut);L&&(g.style=this,this.fog&&(g._fogVisible=!0,L.overrideFog=!0,g.getOrCreateProgram(A,L)),g._fogVisible=!1,L.overrideFog=!1,g.getOrCreateProgram(A,L),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(L.overrideRtt=!0,g.getOrCreateProgram(A,L)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const u=this.calculateLightsBrightness();s.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u));const g=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const L in A){const{updatedIds:z,removedIds:B}=A[L];(z||B)&&(this._updateWorkerLayers(L,z,B),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const S={};for(const A in this._mergedSourceCaches){const L=this._mergedSourceCaches[A];S[A]=L.used,L.used=!1,L.tileCoverLift=0}for(const A of this._mergedOrder){const L=this._mergedLayers[A];if(L.recalculate(s,this._availableImages),!L.isHidden(s.zoom)){const z=this.getLayerSourceCache(L);z&&(z.used=!0,z.tileCoverLift=Math.max(z.tileCoverLift,L.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(L,s)}):this.precompilePrograms(L,s))}for(const A in this._mergedSourceCaches){const L=this._mergedSourceCaches[A];if(!L)continue;const z=L._source;z.type==="raster-array"&&z.iconsets&&(L.used=!0)}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();for(const A in S){const L=this._mergedSourceCaches[A];S[A]!==L.used&&L.getSource().fire(new i.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new i.A("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=this._changes.getUpdatedImages();if(s.length){for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s);this._changes.resetUpdatedImages()}}_updateWorkerLayers(s,u,g){const x=this.getFragmentStyle(s);x&&this.dispatcher.broadcast("updateLayers",{layers:u?x._serializeLayers(u):[],scope:s,removedIds:g||[],options:x.options})}setState(s,u){if(this._checkLoaded(),Zd(this,Li(s)))return!1;(s=i.cq(s)).layers=Im(s.layers);const g=function(A,L){if(!A)return[{command:fn.setStyle,args:[L]}];let z=[];try{if(!i.bn(A.version,L.version))return[{command:fn.setStyle,args:[L]}];if(i.bn(A.center,L.center)||z.push({command:fn.setCenter,args:[L.center]}),i.bn(A.zoom,L.zoom)||z.push({command:fn.setZoom,args:[L.zoom]}),i.bn(A.bearing,L.bearing)||z.push({command:fn.setBearing,args:[L.bearing]}),i.bn(A.pitch,L.pitch)||z.push({command:fn.setPitch,args:[L.pitch]}),i.bn(A.sprite,L.sprite)||z.push({command:fn.setSprite,args:[L.sprite]}),i.bn(A.glyphs,L.glyphs)||z.push({command:fn.setGlyphs,args:[L.glyphs]}),i.bn(A.imports,L.imports)||function(re=[],ce=[],ae){ce=ce||[];const fe=(re=re||[]).map(ln),me=ce.map(ln),be=re.reduce(oa,{}),Ee=ce.reduce(oa,{}),Te=fe.slice();let Oe,Me,Ce,Pe;for(Oe=0,Me=0;Oe<fe.length;Oe++)Ce=fe[Oe],Ee.hasOwnProperty(Ce)?Me++:(ae.push({command:fn.removeImport,args:[Ce]}),Te.splice(Te.indexOf(Ce,Me),1));for(Oe=0,Me=0;Oe<me.length;Oe++)Ce=me[me.length-1-Oe],Te[Te.length-1-Oe]!==Ce&&(be.hasOwnProperty(Ce)?(ae.push({command:fn.removeImport,args:[Ce]}),Te.splice(Te.lastIndexOf(Ce,Te.length-Me),1)):Me++,Pe=Te[Te.length-Oe],ae.push({command:fn.addImport,args:[Ee[Ce],Pe]}),Te.splice(Te.length-Oe,0,Ce));for(const Ne of ce){const Ue=be[Ne.id];Ue&&!i.bn(Ue,Ne)&&ae.push({command:fn.updateImport,args:[Ne.id,Ne]})}}(A.imports,L.imports,z),i.bn(A.transition,L.transition)||z.push({command:fn.setTransition,args:[L.transition]}),i.bn(A.light,L.light)||z.push({command:fn.setLight,args:[L.light]}),i.bn(A.fog,L.fog)||z.push({command:fn.setFog,args:[L.fog]}),i.bn(A.snow,L.snow)||z.push({command:fn.setSnow,args:[L.snow]}),i.bn(A.rain,L.rain)||z.push({command:fn.setRain,args:[L.rain]}),i.bn(A.projection,L.projection)||z.push({command:fn.setProjection,args:[L.projection]}),i.bn(A.lights,L.lights)||z.push({command:fn.setLights,args:[L.lights]}),i.bn(A.camera,L.camera)||z.push({command:fn.setCamera,args:[L.camera]}),!i.bn(A["color-theme"],L["color-theme"]))return[{command:fn.setStyle,args:[L]}];const B={},V=[];(function(re,ce,ae,fe){let me;for(me in ce=ce||{},re=re||{})re.hasOwnProperty(me)&&(ce.hasOwnProperty(me)||Zy(me,ae,fe));for(me in ce){if(!ce.hasOwnProperty(me))continue;const be=ce[me];re.hasOwnProperty(me)?i.bn(re[me],be)||(re[me].type==="geojson"&&be.type==="geojson"&&ar(re,ce,me)?ae.push({command:fn.setGeoJSONSourceData,args:[me,be.data]}):sf(me,ce,ae,fe)):Fs(me,ce,ae)}})(A.sources,L.sources,V,B);const X=[];A.layers&&A.layers.forEach(re=>{re.source&&B[re.source]?z.push({command:fn.removeLayer,args:[re.id]}):X.push(re)});let Y=A.terrain;Y&&B[Y.source]&&(z.push({command:fn.setTerrain,args:[void 0]}),Y=void 0),z=z.concat(V),i.bn(Y,L.terrain)||z.push({command:fn.setTerrain,args:[L.terrain]}),function(re,ce,ae){ce=ce||[];const fe=(re=re||[]).map(ln),me=ce.map(ln),be=re.reduce(oa,{}),Ee=ce.reduce(oa,{}),Te=fe.slice(),Oe=Object.create(null);let Me,Ce,Pe,Ne,Ue,dt,et;for(Me=0,Ce=0;Me<fe.length;Me++)Pe=fe[Me],Ee.hasOwnProperty(Pe)?Ce++:(ae.push({command:fn.removeLayer,args:[Pe]}),Te.splice(Te.indexOf(Pe,Ce),1));for(Me=0,Ce=0;Me<me.length;Me++)Pe=me[me.length-1-Me],Te[Te.length-1-Me]!==Pe&&(be.hasOwnProperty(Pe)?(ae.push({command:fn.removeLayer,args:[Pe]}),Te.splice(Te.lastIndexOf(Pe,Te.length-Ce),1)):Ce++,dt=Te[Te.length-Me],ae.push({command:fn.addLayer,args:[Ee[Pe],dt]}),Te.splice(Te.length-Me,0,Pe),Oe[Pe]=!0);for(Me=0;Me<me.length;Me++)if(Pe=me[Me],Ne=be[Pe],Ue=Ee[Pe],!Oe[Pe]&&!i.bn(Ne,Ue))if(i.bn(Ne.source,Ue.source)&&i.bn(Ne["source-layer"],Ue["source-layer"])&&i.bn(Ne.type,Ue.type)){for(et in wn(Ne.layout,Ue.layout,ae,Pe,null,fn.setLayoutProperty),wn(Ne.paint,Ue.paint,ae,Pe,null,fn.setPaintProperty),i.bn(Ne.slot,Ue.slot)||ae.push({command:fn.setSlot,args:[Pe,Ue.slot]}),i.bn(Ne.filter,Ue.filter)||ae.push({command:fn.setFilter,args:[Pe,Ue.filter]}),i.bn(Ne.minzoom,Ue.minzoom)&&i.bn(Ne.maxzoom,Ue.maxzoom)||ae.push({command:fn.setLayerZoomRange,args:[Pe,Ue.minzoom,Ue.maxzoom]}),Ne)Ne.hasOwnProperty(et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&et!=="slot"&&(et.indexOf("paint.")===0?wn(Ne[et],Ue[et],ae,Pe,et.slice(6),fn.setPaintProperty):i.bn(Ne[et],Ue[et])||ae.push({command:fn.setLayerProperty,args:[Pe,et,Ue[et]]}));for(et in Ue)Ue.hasOwnProperty(et)&&!Ne.hasOwnProperty(et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&et!=="slot"&&(et.indexOf("paint.")===0?wn(Ne[et],Ue[et],ae,Pe,et.slice(6),fn.setPaintProperty):i.bn(Ne[et],Ue[et])||ae.push({command:fn.setLayerProperty,args:[Pe,et,Ue[et]]}))}else ae.push({command:fn.removeLayer,args:[Pe]}),dt=Te[Te.lastIndexOf(Pe)+1],ae.push({command:fn.addLayer,args:[Ue,dt]})}(X,L.layers,z)}catch(B){console.warn("Unable to compute style diff:",B),z=[{command:fn.setStyle,args:[L]}]}return z}(this.serialize(),s).filter(A=>!(A.command in GR));if(g.length===0)return!1;const x=g.filter(A=>!(A.command in WR));if(x.length>0)throw new Error(`Unimplemented: ${x.map(A=>A.command).join(", ")}.`);const S=[];return g.forEach(A=>{S.push(this[A.command].apply(this,A.args))}),u&&Promise.all(S).then(u),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}addImages(s){for(const[u,g]of s.entries()){if(this.getImage(u)&&!u.iconsetId)return this.fire(new i.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,g),this._changes.updateImage(u)}return this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this}addImage(s,u){return this.getImage(s)&&!s.iconsetId?this.fire(new i.z(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,u),this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this)}updateImage(s,u,g=!1){this.imageManager.updateImage(s,this.scope,u),g&&(this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(s,u,g={}){return this._checkLoaded(),this._validate(Le,`models.${s}`,u,null,g)||(this.modelManager.addModel(s,u,this.scope),this._changes.setDirty()),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this):this.fire(new i.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,u,g={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(Ho,`sources.${s}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=qy(s,u,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const S=A=>{const L=(A?"symbol:":"other:")+x.id,z=i.C(L,this.scope),B=this._sourceCaches[L]=new js(z,x,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=B,B.onAdd(this.map)};S(!1),u.type!=="vector"&&u.type!=="geojson"||S(!0),x.onAdd&&x.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const u=this.getOwnSource(s);if(!u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new i.z(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const g=this.getOwnSourceCaches(s);for(const x of g){const S=i.cr(x.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,u){this._checkLoaded(),this.getOwnSource(s).setData(u),this._changes.setDirty()}getOwnSource(s){const u=this.getOwnSourceCache(s);return u&&u.getSource()}getOwnSources(){const s=[];for(const u in this._otherSourceCaches){const g=this.getOwnSourceCache(u);g&&s.push(g.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const u in s){const g=s[u]._tiles;for(const x in g){const S=g[x];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const x of s){if(this._validate(Fu,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(x),S.updateTransitions(u)}else this.ambientLight=new Ni(x,Jr||(Jr=new i.a7({color:new i.a8(i.a5.properties_light_ambient.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(x),S.updateTransitions(u)}else this.directionalLight=new Ni(x,Tn||(Tn=new i.a7({direction:new i.am(i.a5.properties_light_directional.direction),color:new i.a8(i.a5.properties_light_directional.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_directional.intensity),"cast-shadows":new i.a8(i.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a8(i.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a8(i.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=new i.aa(this.z||0,u);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,u=this.ambientLight;if(!s||!u)return;const g=Y=>.2126*(Y[0]<=.03928?Y[0]/12.92:Math.pow((Y[0]+.055)/1.055,2.4))+.7152*(Y[1]<=.03928?Y[1]/12.92:Math.pow((Y[1]+.055)/1.055,2.4))+.0722*(Y[2]<=.03928?Y[2]/12.92:Math.pow((Y[2]+.055)/1.055,2.4)),x=s.properties.get("color").toRenderColor(null).toArray01(),S=s.properties.get("intensity"),A=s.properties.get("direction"),L=1-i.cc(A.x,A.y,A.z)[2]/90,z=g(x)*S*L,B=u.properties.get("color").toRenderColor(null).toArray01(),V=u.properties.get("intensity"),X=g(B)*V;return Number(((z+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(!s)return this;if(i.cs(s)){const u=i.ct(s),g=this.fragments.find(({id:S})=>S===u);if(!g)throw new Error(`Style import '${s}' not found`);const x=i.cr(s);return g.style.getFragmentStyle(x)}{const u=this.fragments.find(({id:g})=>g===s);return u?u.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const u={},g=(x,S="")=>`${x}::${S}`;this._featuresetSelectors={};for(const x in s){const S=this._featuresetSelectors[x]=[];for(const A of s[x].selectors){if(A.featureNamespace){const z=this.getOwnLayer(A.layer);if(!z){i.w(`Layer is undefined for selector: ${A.layer}`);continue}const B=g(z.source,z.sourceLayer);if(B in u&&u[B]!==A.featureNamespace){i.w(`"featureNamespace ${A.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}u[B]=A.featureNamespace}let L;if(A.properties)for(const z in A.properties){const B=i.X(A.properties[z]);B.result==="success"&&(L=L||{},L[z]=B.value)}S.push({layerId:A.layer,namespace:A.featureNamespace,properties:L,uniqueFeatureID:A._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const u=this.getFragmentStyle(s);if(!u||!u.stylesheet.featuresets)return[];const g=[];for(const x in u.stylesheet.featuresets)g.push({featuresetId:x,importId:u.scope?u.scope:void 0});return g}getFeaturesetLayers(s,u){const g=this.getFragmentStyle(u),x=g.stylesheet.featuresets;if(!x||!x[s])return this.fire(new i.z(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const S=[];for(const A of x[s].selectors){const L=g.getOwnLayer(A.layer);L&&S.push(L)}return S}getConfigProperty(s,u){const g=this.getFragmentStyle(s);if(!g)return null;const x=i.C(u,g.scope),S=g.options.get(x),A=S?S.value||S.default:null;return A?A.serialize():null}setConfigProperty(s,u,g){const x=this.getFragmentStyle(s);if(!x)return;const S=x.stylesheet.indoor?YE(x.stylesheet.schema):x.stylesheet.schema;if(!S||!S[u])return;const A=i.X(g);if(A.result!=="success")return void Zd(this,A.value);const L=A.value.expression,z=i.C(u,x.scope),B=x.options.get(z);if(!B)return;let V;const{minValue:X,maxValue:Y,stepValue:re,type:ce,values:ae}=S[u],fe=i.X(S[u].default);fe.result==="success"&&(V=fe.value.expression),V?(this.options.set(z,Object.assign({},B,{value:L,default:V,minValue:X,maxValue:Y,stepValue:re,type:ce,values:ae})),this.updateConfigDependencies(u)):this.fire(new i.z(new Error(`No schema defined for the config option "${u}" in the "${s}" fragment.`)))}getConfig(s){const u=this.getFragmentStyle(s);if(!u)return null;const g=u.stylesheet.schema;if(!g)return null;const x={};for(const S in g){const A=i.C(S,u.scope),L=u.options.get(A),z=L?L.value||L.default:null;x[S]=z?z.serialize():null}return x}setConfig(s,u){const g=this.getFragmentStyle(s);g&&(g.updateConfig(u,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const u=this.getFragmentStyle(s);return u?u.stylesheet.schema:null}setSchema(s,u){const g=this.getFragmentStyle(s);g&&(g.stylesheet.schema=u,g.updateConfig(g._config,u),this.updateConfigDependencies())}updateConfig(s,u){if(this._config=s,s||u)if(u)for(const g in u){let x,S;const A=i.X(u[g].default);if(A.result==="success"&&(x=A.value.expression),s&&s[g]!==void 0){const Y=i.X(s[g]);Y.result==="success"&&(S=Y.value.expression)}const{minValue:L,maxValue:z,stepValue:B,type:V,values:X}=u[g];if(x){const Y=i.C(g,this.scope);this.options.set(Y,{default:x,value:S,minValue:L,maxValue:z,stepValue:B,type:V,values:X})}else this.fire(new i.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new i.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const u of this._configDependentLayers){const g=this.getLayer(u);if(g){if(s&&!g.configDependencies.has(s))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const g=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(g){const x=u._evaluateColorThemeData(g);(!u._styleColorTheme.lut&&x!==""||u._styleColorTheme.lut&&x!==u._styleColorTheme.lut.data)&&u.setColorTheme(g)}}),this._changes.setDirty()}addLayer(s,u,g={}){this._checkLoaded();const x=s.id;if(this._layers[x])return void this.fire(new i.z(new Error(`Layer with id "${x}" already exists on this map`)));let S;if(s.type==="custom"){if(Zd(this,i.cu(s)))return;S=i.cv(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(x,s.source),s=i.cq(s),s=i.l(s,{source:x})),this._validate(pe,`layers.${x}`,s,{arrayIndex:-1},g))return;S=i.cv(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}})}S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid);let A=this._order.length;if(u){const V=this._order.indexOf(u);if(V===-1)return void this.fire(new i.z(new Error(`Layer with id "${u}" does not exist on this map.`)));S.slot===this._layers[u].slot?A=V:i.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=S;const L=this.getOwnLayerSourceCache(S),z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();L&&S.canCastShadows()&&z&&(L.castsShadows=!0);const B=this._changes.getRemovedLayer(S);if(B&&S.source&&L&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const V=i.C(S.source,S.scope);B.type!==S.type?this._changes.updateSourceCache(V,"clear"):(this._changes.updateSourceCache(V,"reload"),L.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(s,u){this._checkLoaded();const g=this._checkLayer(s);if(!g||s===u)return;const x=this._order.indexOf(s);this._order.splice(x,1);let S=this._order.length;if(u){const A=this._order.indexOf(u);if(A===-1)return void this.fire(new i.z(new Error(`Layer with id "${u}" does not exist on this map.`)));g.slot===this._layers[u].slot?S=A:i.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const u=this._checkLayer(s);if(!u)return;u.setEventedParent(null);const g=this._order.indexOf(s);this._order.splice(g,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const x=this.getOwnLayerSourceCache(u);if(x&&x.castsShadows){let S=!1;for(const A in this._layers)if(this._layers[A].source===u.source&&this._layers[A].canCastShadows()){S=!0;break}x.castsShadows=S}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const u in this._layers)if(this._layers[u].type===s)return!0;return!1}setLayerZoomRange(s,u,g){this._checkLoaded();const x=this._checkLayer(s);x&&(x.minzoom===u&&x.maxzoom===g||(u!=null&&(x.minzoom=u),g!=null&&(x.maxzoom=g),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,u){this._checkLoaded();const g=this._checkLayer(s);g&&g.slot!==u&&(g.slot=u,this._updateLayer(g))}setFilter(s,u,g={}){this._checkLoaded();const x=this._checkLayer(s);if(x&&!i.bn(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(ye,`layers.${x.id}.filter`,u,{layerType:x.type},g)||(x.filter=i.cq(u),this._updateLayer(x)))}getFilter(s){const u=this._checkLayer(s);if(u)return i.cq(u.filter)}setLayoutProperty(s,u,g,x={}){this._checkLoaded();const S=this._checkLayer(s);if(S&&!i.bn(S.getLayoutProperty(u),g)){if(g!=null&&(!x||x.validate!==!1)&&Zd(S,je.call(Li,{key:`layers.${s}.layout.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:i.a5,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(u,g),S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)}}getLayoutProperty(s,u){const g=this._checkLayer(s);if(g)return g.getLayoutProperty(u)}setPaintProperty(s,u,g,x={}){this._checkLoaded();const S=this._checkLayer(s);if(!S||i.bn(S.getPaintProperty(u),g)||g!=null&&(!x||x.validate!==!1)&&Zd(S,Ae.call(Li,{key:`layers.${s}.paint.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:i.a5})))return;const A=S.setPaintProperty(u,g);S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),A&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(s,u){const g=this._checkLayer(s);if(g)return g.getPaintProperty(u)}setFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:z,importId:B}=s.target,V=this.getFragmentStyle(B),X=V.getFeaturesetLayers(z);for(const{source:Y,sourceLayer:re}of X)V.setFeatureState({id:s.id,source:Y,sourceLayer:re},u)}else if("layerId"in s.target){const{layerId:z}=s.target,B=this.getLayer(z);this.setFeatureState({id:s.id,source:B.source,sourceLayer:B.sourceLayer},u)}return}const g=s.source,x=s.sourceLayer,S=this._checkSource(g);if(!S)return;const A=S.type;if(A==="geojson"&&x)return void this.fire(new i.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(A==="vector"&&!x)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided.")));const L=this.getOwnSourceCaches(g);for(const z of L)z.setFeatureState(x,s.id,u)}removeFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:z,importId:B}=s.target,V=this.getFragmentStyle(B),X=V.getFeaturesetLayers(z);for(const{source:Y,sourceLayer:re}of X)V.removeFeatureState({id:s.id,source:Y,sourceLayer:re},u)}else if("layerId"in s.target){const{layerId:z}=s.target,B=this.getLayer(z);this.removeFeatureState({id:s.id,source:B.source,sourceLayer:B.sourceLayer},u)}return}const g=s.source,x=this._checkSource(g);if(!x)return;const S=x.type,A=S==="vector"?s.sourceLayer:void 0;if(S==="vector"&&!A)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new i.z(new Error("A feature id is required to remove its specific state property.")));const L=this.getOwnSourceCaches(g);for(const z of L)z.removeFeatureState(A,s.id,u)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let S;if("featuresetId"in s.target){const{featuresetId:A,importId:L}=s.target,z=this.getFragmentStyle(L),B=z.getFeaturesetLayers(A);for(const{source:V,sourceLayer:X}of B){const Y=z.getFeatureState({id:s.id,source:V,sourceLayer:X});if(Y&&!S)S=Y;else if(!i.bn(S,Y))return void this.fire(new i.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:A}=s.target,L=this.getLayer(A);S=this.getFeatureState({id:s.id,source:L.source,sourceLayer:L.sourceLayer})}return S}const u=s.source,g=s.sourceLayer,x=this._checkSource(u);if(x){if(x.type!=="vector"||g)return s.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(g,s.id);this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=i.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),u=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return i.cw({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(s){for(const u of Object.values(this._mergedLayers))s(u)&&this._updateLayer(u)}_updateLayer(s){this._changes.updateLayer(s);const u=this.getLayerSourceCache(s),g=i.C(s.source,s.scope),x=this._changes.getUpdatedSourceCaches();s.source&&!x[g]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),u.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const u=L=>this._mergedLayers[L].is3D(!!this.terrain),g=this.order,x={},S=[];for(let L=g.length-1;L>=0;L--){const z=g[L];if(u(z)){x[z]=L;for(const B of s){const V=B[z];if(V)for(const X of V)S.push(X)}}}S.sort((L,z)=>z.intersectionZ-L.intersectionZ);const A=[];for(let L=g.length-1;L>=0;L--){const z=g[L];if(u(z))for(let B=S.length-1;B>=0;B--){const V=S[B].feature;if(V.layer&&x[V.layer.id]<L)break;A.push(V),S.pop()}else for(const B of s){const V=B[z];if(V)for(const X of V)A.push(X.feature)}}return A}queryRenderedFeatures(s,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(ye,"queryRenderedFeatures.filter",u.filter,null,u),x=i.a_(u.filter));const S={},A=V=>{if(rv.has(V.type))return;const X=this.getOwnLayerSourceCache(V),Y=S[X.id]=S[X.id]||{sourceCache:X,layers:{},has3DLayers:!1};V.is3D(!!this.terrain)&&(Y.has3DLayers=!0),Y.layers[V.fqid]=Y.layers[V.fqid]||{styleLayer:V,targets:[]},Y.layers[V.fqid].targets.push({filter:x})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new i.z(new Error("parameters.layers must be an Array."))),[];for(const V of u.layers){const X=this._layers[V];if(!X)return this.fire(new i.z(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];A(X)}}else for(const V in this._layers)A(this._layers[V]);const L=this._queryRenderedFeatures(s,S,g),z=this._flattenAndSortRenderedFeatures(L),B=[];for(const V of z)i.ct(V.layer.id)===this.scope&&B.push(V);return B}queryRenderedFeatureset(s,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(ye,"queryRenderedFeatures.filter",u.filter,null,u),x=i.a_(u.filter));const S="mock",A=[];if(u&&u.target)A.push(Object.assign({},u,{targetId:S,filter:x}));else{const V=this.getFeaturesetDescriptors();for(const X of V)A.push({targetId:S,filter:x,target:X});for(const{style:X}of this.fragments){const Y=X.getFeaturesetDescriptors();for(const re of Y)A.push({targetId:S,filter:x,target:re})}}const L=this.queryRenderedTargets(s,A,g),z=[],B=new Set;for(const V of L)for(const X of V.variants[S])nf(X,V,B)||z.push(new i.cx(V,X));return z}queryRenderedTargets(s,u,g){const x={},S=(L,z,B,V)=>{const X=x[z.id]=x[z.id]||{sourceCache:z,layers:{},has3DLayers:!1};if(X.layers[L.fqid]=X.layers[L.fqid]||{styleLayer:L,targets:[]},L.is3D(!!this.terrain)&&(X.has3DLayers=!0),!V)return B.uniqueFeatureID=!1,void X.layers[L.fqid].targets.push(B);X.layers[L.fqid].targets.push(Object.assign({},B,{namespace:V.namespace,properties:V.properties,uniqueFeatureID:V.uniqueFeatureID}))};for(const L of u)if("featuresetId"in L.target){const{featuresetId:z,importId:B}=L.target,V=this.getFragmentStyle(B);if(!V||!V._featuresetSelectors)continue;const X=V._featuresetSelectors[z];if(!X){this.fire(new i.z(new Error(`The featureset '${z}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Y of X){const re=V.getOwnLayer(Y.layerId);re&&!rv.has(re.type)&&S(re,V.getOwnLayerSourceCache(re),L,Y)}}else if("layerId"in L.target){const{layerId:z}=L.target,B=this.getLayer(z);if(!B||rv.has(B.type))continue;S(B,this.getLayerSourceCache(B),L)}const A=this._queryRenderedFeatures(s,x,g);return this._flattenAndSortRenderedFeatures(A)}_queryRenderedFeatures(s,u,g){const x=[],S=!!this.map._showQueryGeometry,A=Po.createFromScreenPoints(s,g);for(const L in u){const z=nb(A,u[L],this._availableImages,g,S);Object.keys(z).length&&x.push(z)}if(this.placement)for(const L in u){if(!u[L].sourceCache._onlySymbols)continue;const z=UE(A.screenGeometry,u[L],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(z).length&&x.push(z)}return x}querySourceFeatures(s,u){const g=u&&u.filter;g&&this._validate(ye,"querySourceFeatures.filter",g,null,u);let x=[];const S=this.getOwnSourceCaches(s);for(const A of S)x=x.concat(VE(A,u));return x}addSourceType(s,u,g){return Sl.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Sl.setSourceType(s,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:u.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,u,g={}){this._checkLoaded();const x=this.light.getLight();let S=!1;for(const L in s)if(!i.bn(s[L],x[L])){S=!0;break}if(!S)return;const A=this._getTransitionParameters();this.light.setLight(s,u,g),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,u=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=s;const x=s.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const L="terrain-dem-src";this.addSource(L,g.source),g=i.cq(g),g=i.l(g,{source:L})}const S=i.l({},g),A={};if(this.terrain&&x){S.source=this.terrain.get().source;const L=this.terrain?this.getFragmentStyle(this.terrain.scope):null;L&&(A.style=L.serialize())}if(this._validate(Wy,"terrain",S,A))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u),this.fire(new i.A("data",{dataType:"style"}))}else{const S=this.terrain,A=S.get();for(const L of Object.keys(i.a5.terrain))!g.hasOwnProperty(L)&&i.a5.terrain[L].default&&(g[L]=i.a5.terrain[L].default);for(const L in s)if(!i.bn(s[L],A[L])){S.set(s,this.options),this.stylesheet.terrain=s;const z=this._getTransitionParameters({duration:0});S.updateTransitions(z),this.fire(new i.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const u=this.fog=new Gr(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createSnow(s){const u=this.snow=new En(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createRain(s){const u=this.rain=new Pn(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void s();const g=this._evaluateColorThemeData(u);this._loadColorTheme(g).then(()=>{this.fire(new i.A("colorthemeset")),s()}).catch(x=>{i.w(`Couldn't set color theme: ${x}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,u){const g=this.getFragmentStyle(s);g&&(g._styleColorTheme.colorThemeOverride=u,g._reloadColorTheme())}_getTransitionParameters(s){return{now:i.q.now(),transition:i.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],u=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?s.push(g):u.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...u)}_createTerrain(s,u){const g=this.terrain=new yt(s,u,this.scope,this.options);u===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="symbol"&&this._updateLayer(u)}}_validate(s,u,g,x,S={}){if(S&&S.validate===!1)return!1;const A=i.l({},this.serialize());return Zd(this,s.call(Li,i.l({key:u,style:A,value:g,styleSpec:i.a5},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cy.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(s){const u=this.getSourceCaches(s);for(const g of u)g.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const u=this.getSourceCaches(s);for(const g of u)g.resume(),g.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let u;this.directionalLight&&(u=Wu(this.directionalLight));for(const g in this._mergedSourceCaches)this._mergedSourceCaches[g].update(s,void 0,void 0,u)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const u=this._sourceCaches[s];u.resume(),u.reload()}}_updatePlacement(s,u,g,x,S,A,L=!1){let z=!1,B=!1;const V={},X={};for(const Y of this._mergedOrder){const re=this._mergedLayers[Y];if(re.type!=="symbol")continue;const ce=i.C(re.source,re.scope);let ae=V[ce];if(!ae){const me=this.getLayerSourceCache(re);if(!me)continue;const be=me.getRenderableIds(!0).map(Ee=>me.getTileByID(Ee));X[ce]=be.slice(),ae=V[ce]=be.sort((Ee,Te)=>Te.tileID.overscaledZ-Ee.tileID.overscaledZ||(Ee.tileID.isLessThan(Te.tileID)?-1:1))}const fe=this.crossTileSymbolIndex.addLayer(re,ae,u.center.lng,u.projection);z=z||fe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),L=L||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.A("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),u.zoom))&&(this.pauseablePlacement=new Uu(u,this._mergedOrder,L,g,x,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,V,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),B=!0),z&&this.pauseablePlacement.placement.setStale()),B||z){this._buildingIndex.onNewFrame(u.zoom);for(let Y=0;Y<this._mergedOrder.length;Y++){const re=this._mergedLayers[this._mergedOrder[Y]];if(re.type!=="symbol")continue;const ce=this.isLayerClipped(re);this.placement.updateLayerOpacities(re,V[i.C(re.source,re.scope)],Y,ce?A:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,u){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:S})=>S===s.id)!==-1)return void this.fire(new i.z(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!u)return g.push(s),this._loadImports([s],!0);const x=g.findIndex(({id:S})=>S===u);return x===-1&&this.fire(new i.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,x).concat(s).concat(g.slice(x)),this._loadImports([s],!0,u)}updateImport(s,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(s);return x===-1?this:typeof u=="string"?(this.setImportUrl(s,u),this):(u.url&&u.url!==g[x].url&&this.setImportUrl(s,u.url),i.bn(u.config,g[x].config)||this.setImportConfig(s,u.config,u.data.schema),i.bn(u.data,g[x].data)||this.setImportData(s,u.data),this)}moveImport(s,u){this._checkLoaded();let g=this.stylesheet.imports||[];const x=this.getImportIndex(s);if(x===-1)return this;const S=this.getImportIndex(u);if(S===-1)return this;const A=g[x],L=this.fragments[x];return g=g.filter(({id:z})=>z!==s),this.fragments=this.fragments.filter(({id:z})=>z!==s),this.stylesheet.imports=g.slice(0,S).concat(A).concat(g.slice(S)),this.fragments=this.fragments.slice(0,S).concat(L).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(s,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(s);if(x===-1)return this;g[x].url=u;const S=this.fragments[x];return S.style=this._createFragmentStyle(g[x]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(u),this}setImportData(s,u){this._checkLoaded();const g=this.getImportIndex(s),x=this.stylesheet.imports||[];return g===-1?this:u?(this.fragments[g].style.setState(u),this._reloadImports(),this):(delete x[g].data,this.setImportUrl(s,x[g].url))}setImportConfig(s,u,g){this._checkLoaded();const x=this.getImportIndex(s),S=this.stylesheet.imports||[];if(x===-1)return this;u?S[x].config=u:delete S[x].config;const A=this.fragments[x];g&&A.style.stylesheet&&(A.style.stylesheet.schema=g);const L=A.style.stylesheet&&A.style.stylesheet.schema;return A.config=u,A.style.updateConfig(u,L),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const u=this.stylesheet.imports||[],g=this.getImportIndex(s);g!==-1&&(u.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(s){const u=(this.stylesheet.imports||[]).findIndex(g=>g.id===s);return u===-1&&this.fire(new i.z(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),u}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const u in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[u];g&&s.push(g.getSource())}return s}getSource(s,u){const g=this.getSourceCache(s,u);return g&&g.getSource()}getLayerSource(s){const u=this.getLayerSourceCache(s);return u&&u.getSource()}getSourceCache(s,u){const g=i.C(s,u);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(s){const u=i.C(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[s]&&u.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&u.push(this._mergedSymbolSourceCaches[s]),u}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const u in s){const g=s[u];g==="reload"?this.reloadSource(u):g==="clear"&&this.clearSource(u)}}updateLayers(s){const u=this._changes.getUpdatedPaintProperties();for(const g of u){const x=this.getLayer(g);x&&x.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s,this.scope)}getImages(s,u,g){this.imageManager.getImages(u.images,u.scope,g),this._updateTilesForChangedImages();const x=A=>{if(A){const L=u.images.map(z=>i.I.toString(z));A.setDependencies(u.tileID.key,u.type,L)}},S=i.C(u.source,u.scope);x(this._mergedOtherSourceCaches[S]),x(this._mergedSymbolSourceCaches[S])}rasterizeImages(s,u,g){this.imageManager.rasterizeImages(u,g)}getGlyphs(s,u,g){this.glyphManager.getGlyphs(u.stacks,u.scope,g)}getResource(s,u,g){return i.cz(u,g)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const u=[];return this._otherSourceCaches[s]&&u.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&u.push(this._symbolSourceCaches[s]),u}_isSourceCacheLoaded(s){const u=this.getOwnSourceCaches(s);return u.length===0?(this.fire(new i.z(new Error(`There is no source with ID '${s}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,u){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;const g=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D(!!this.terrain)){if(g||u&&u.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Sl.getSourceType=function(y){return rb[y]},Sl.setSourceType=function(y,s){rb[y]=s},Sl.registerForPluginStateChange=i.ci;var pb=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,nv=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Fm=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,iv="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Gu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,ov=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,mb=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Xd=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,vf=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Bm=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,$m=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Uc=[];rc(pb,Uc),rc(Fm,Uc),rc(nv,Uc);const Yd={"_prelude_fog.vertex.glsl":ov,"_prelude_terrain.vertex.glsl":Gu,"_prelude_shadow.vertex.glsl":Bm,"_prelude_fog.fragment.glsl":mb,"_prelude_shadow.fragment.glsl":$m,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Xd,"_prelude_raster_particle.glsl":vf},_f={};nn("",Gu),nn(mb,ov),nn($m,Bm),nn(Xd,""),nn(vf,"");const gb=nn(nv,Fm),av=pb;var Um={background:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:nn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:nn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:nn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:nn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:nn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:nn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:nn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:nn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:nn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:nn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:nn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:nn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),0.001);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:nn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:nn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:nn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:nn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:nn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:nn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,iv),skyboxGradient:nn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,iv),skyboxCapture:nn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:nn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:nn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:nn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:nn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:nn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:nn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:nn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:nn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function rc(y,s){const u=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const S of x)s.includes(S)||s.push(S)}}function nn(y,s){const u=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(B=>{const V=B.split(" ");return V[V.length-1]}),x=[...new Set(x)]);const S={},A=[],L=[];if(y=y.replace(u,(B,V)=>(L.push(V),"")),(s=s.replace(u,(B,V)=>(A.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let z=[...Uc];rc(y,z),rc(s,z);for(const B of[...A,...L])Yd[B]||console.error(`Undefined include: ${B}`),_f[B]||(_f[B]=[],rc(Yd[B],_f[B])),z=[...z,..._f[B]];return{fragmentSource:y=y.replace(g,(B,V,X,Y,re)=>(S[re]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${re}
in ${X} ${Y} ${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="initialize"?`
#ifdef HAS_UNIFORM_u_${re}
    ${X} ${Y} ${re} = u_${re};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${X} ${Y} ${re};
#endif
`:V==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(g,(B,V,X,Y,re)=>{const ce=Y==="float"?"vec2":Y,ae=re.match(/color/)?"color":ce;return V==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${re}
in ${X} ${Y} a_${re};
#endif
`:S[re]?V==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${X} ${ce} a_${re};
out ${X} ${Y} ${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="initialize"?ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = a_${re};
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = unpack_mix_${ae}(a_${re}, u_${re}_t);
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    in ${X} ${Y} a_${re};
    out ${X} ${Y} ${re};
#endif
`:V==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${re} = a_${re};
#endif
`:void 0:V==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${X} ${ce} a_${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="define-instanced"?ae==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${re}0;
in vec4 a_${re}1;
in vec4 a_${re}2;
in vec4 a_${re}3;
#else
uniform ${X} ${Y} u_${re};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${ce} a_${re};
#else
uniform ${X} ${Y} u_${re};
#endif
`:V==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${re}
    ${X} ${Y} ${re} = a_${re};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${X} ${Y} ${re} = a_${re};
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${X} ${Y} ${re} = unpack_mix_${ae}(a_${re}, u_${re}_t);
#else
    ${X} ${Y} ${re} = u_${re};
#endif
`}),staticAttributes:x,usedDefines:z,vertexIncludes:A,fragmentIncludes:L}}class e2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,u,g,x,S,A,L,z){this.context=s;let B=this.boundPaintVertexBuffers.length!==x.length;for(let X=0;!B&&X<x.length;X++)this.boundPaintVertexBuffers[X]!==x[X]&&(B=!0);let V=this.boundDynamicVertexBuffers.length!==L.length;for(let X=0;!V&&X<L.length;X++)this.boundDynamicVertexBuffers[X]!==L[X]&&(V=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||B||V||this.boundIndexBuffer!==S||this.boundVertexOffset!==A)this.freshBind(u,g,x,S,A,L,z);else{s.bindVertexArrayOES.set(this.vao);for(const X of L)X&&(X.bind(),z&&X.instanceCount&&X.setVertexAttribDivisor(s.gl,u,z));S&&S.dynamicDraw&&S.bind()}}freshBind(s,u,g,x,S,A,L){const z=s.numAttributes,B=this.context,V=B.gl;this.vao&&this.destroy(),this.vao=B.gl.createVertexArray(),B.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=A,u.enableAttributes(V,s),u.bind(),u.setVertexAttribPointers(V,s,S);for(const X of g)X.enableAttributes(V,s),X.bind(),X.setVertexAttribPointers(V,s,S);for(const X of A)X&&(X.enableAttributes(V,s),X.bind(),X.setVertexAttribPointers(V,s,S),L&&X.instanceCount&&X.setVertexAttribDivisor(V,s,L));x&&x.bind(),B.currentNumAttributes=z}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function t2(y,s){const u=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new i.ac(0,g/u).toLngLat().lat,new i.ac(0,(g+1)/u).toLngLat().lat]}function xf(y,s,u,g,x,S,A){const L=y.context,z=L.gl,B=u.hillshadeFBO;if(!B)return;y.prepareDrawTile();const V=y.isTileAffectedByFog(s),X=y.getOrCreateProgram("hillshade",{overrideFog:V});L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,B.colorAttachment.get());const Y=((fe,me,be,Ee)=>{const Te=be.paint.get("hillshade-shadow-color"),Oe=be.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Me=be.paint.get("hillshade-highlight-color"),Ce=be.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Pe=be.paint.get("hillshade-accent-color"),Ne=be.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ue=be.paint.get("hillshade-emissive-strength");let dt=i.ak(be.paint.get("hillshade-illumination-direction"));if(be.paint.get("hillshade-illumination-anchor")==="viewport")dt-=fe.transform.angle;else if(fe.style&&fe.style.enable3dLights()&&fe.style.directionalLight){const wt=fe.style.directionalLight.properties.get("direction"),Tt=i.cc(wt.x,wt.y,wt.z);dt=i.ak(Tt[1])}const et=!fe.options.moving;return{u_matrix:Ee||fe.transform.calculateProjMatrix(me.tileID.toUnwrapped(),et),u_image:0,u_latrange:t2(0,me.tileID),u_light:[be.paint.get("hillshade-exaggeration"),dt],u_shadow:Te.toRenderColor(Oe?null:be.lut),u_highlight:Me.toRenderColor(Ce?null:be.lut),u_emissive_strength:Ue,u_accent:Pe.toRenderColor(Ne?null:be.lut)}})(y,u,g,y.terrain?s.projMatrix:null);y.uploadCommonUniforms(L,X,s.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:ce,tileBoundsSegments:ae}=y.getTileBoundsBuffers(u);X.draw(y,z.TRIANGLES,x,S,A,Ir.disabled,Y,g.id,re,ce,ae)}function yb(y,s,u){if(!s.needsDEMTextureUpload)return;const g=y.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||y.getTileTexture(u.stride);const S=u.getPixels();s.demTexture?s.demTexture.update(S,{premultiply:!1}):s.demTexture=new i.T(g,S,x.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function qR(y,s,u){const g=y.context,x=g.gl;if(!s.dem)return;const S=s.dem;if(g.activeTexture.set(x.TEXTURE1),yb(y,s,S),!s.demTexture)return;s.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const A=S.dim;g.activeTexture.set(x.TEXTURE0);let L=s.hillshadeFBO;if(!L){const Y=new i.T(g,{width:A,height:A,data:null},x.RGBA8);Y.bind(x.LINEAR,x.CLAMP_TO_EDGE),L=s.hillshadeFBO=g.createFramebuffer(A,A,!0,"renderbuffer"),L.colorAttachment.set(Y.texture)}g.bindFramebuffer.set(L.framebuffer),g.viewport.set([0,0,A,A]);const{tileBoundsBuffer:z,tileBoundsIndexBuffer:B,tileBoundsSegments:V}=y.getMercatorTileBoundsBuffers(),X=[];y.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),y.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(y,x.TRIANGLES,hr.disabled,Dr.disabled,Xr.unblended,Ir.disabled,((Y,re)=>{const ce=re.stride,ae=i.ad.mat4.create();return i.ad.mat4.ortho(ae,0,i.ai,-i.ai,0,0,1),i.ad.mat4.translate(ae,ae,[0,-i.ai,0]),{u_matrix:ae,u_image:1,u_dimension:[ce,ce],u_zoom:Y.overscaledZ}})(s.tileID,S),u.id,z,B,V),s.needsHillshadePrepare=!1}class ai{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class HR extends ai{getDefault(){return i.al.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class vb extends ai{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class _b extends ai{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class xb extends ai{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class bb extends ai{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class r2 extends ai{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class n2 extends ai{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class ZR extends ai{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Vm extends ai{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class Wm extends ai{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class i2 extends ai{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class hs extends ai{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class wb extends ai{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class sv extends ai{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class lv extends ai{getDefault(){return i.al.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Sb extends ai{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Tb extends ai{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class Eb extends ai{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class cv extends ai{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Ab=class extends ai{getDefault(){return null}set(y){(y!==this.current||this.dirty)&&(this.gl.useProgram(y),this.current=y,this.dirty=!1)}};class Mb extends ai{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class uv extends ai{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class o2 extends ai{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class a2 extends ai{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class bf extends ai{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class XR extends ai{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class YR extends ai{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class KR extends ai{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class JR extends ai{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class QR extends ai{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class eD extends ai{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Gm extends ai{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class Cb extends Gm{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Pb extends Gm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class wf extends Gm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class s2 extends Pb{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const l2=(y,s,u)=>({u_matrix:y,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:u}),Ib=(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:x,u_merc_center:S,u_image0:0,u_frustum_tl:A,u_frustum_tr:L,u_frustum_br:z,u_frustum_bl:B,u_globe_pos:V,u_globe_radius:X,u_viewport:Y,u_grid_matrix:ae?Float32Array.from(ae):new Float32Array(9),u_skirt_height:re,u_far_z_cutoff:ce});function dv(y,s){return y!=null&&s!=null&&!(!y.hasData()||!s.hasData())&&y.demTexture!=null&&s.demTexture!=null&&y.tileID.key!==s.tileID.key}const Bs=new class{constructor(){this.operations={}}newMorphing(y,s,u,g,x){if(y in this.operations){const S=this.operations[y];S.to.tileID.key!==u.tileID.key&&(S.queued=u)}else this.operations[y]={startTime:g,phase:0,duration:x,from:s,to:u,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const s=this.operations[y];return{from:s.from,to:s.to,phase:s.phase}}update(y){for(const s in this.operations){const u=this.operations[s];for(u.phase=(y-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,y)){delete this.operations[s];break}}}_nextOp(y,s){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=s,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Ob={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Vc(y,s,u){if(s===0)return 0;const g=s<1&&u===514?.25/s:1;return 6*Math.pow(1.5,22-y)*Math.max(s,1)*g}function kb(y,s){const u=1<<y.z;return!s&&(y.x===0||y.x===u-1)||y.y===0||y.y===u-1}const Sf=y=>({u_matrix:y});function hv(y,s,u,g,x){if(x>0){const S=i.q.now(),A=(S-y.timeAdded)/x,L=s?(S-s.timeAdded)/x:-1,z=u.getSource(),B=g.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),V=!s||Math.abs(s.tileID.overscaledZ-B)>Math.abs(y.tileID.overscaledZ-B),X=V&&y.refreshedUponExpiration?1:i.ay(V?A:1-L,0,1);return y.refreshedUponExpiration&&A>=1&&(y.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class c2 extends js{constructor(s){const u={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new i.D(i.cj(),null),x=qy("mock-dem",u,g,s.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,u){s.state="loaded",u(null)}}class Rb extends js{constructor(s){const u=qy("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new i.D(i.cj(),null),s.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,u,g){if(s.freezeTileCoverage)return;this.transform=s;const x=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,A)=>{if(S[A.key]="",!this._tiles[A.key]){const L=new xl(A,this._source.tileSize*A.overscaleFactor(),s.tileZoom);L.state="loaded",this._tiles[A.key]=L}return S},{});for(const S in this._tiles)S in x||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(s){const u=this.proxyCachedFBO[s];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class fv extends i.aH{constructor(s,u,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class u2 extends i.cK{constructor(s,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,S]=function(z){const B=new i.b5,V=new i.aV,X=131;B.reserve(17161),V.reserve(33800);const Y=i.ai/128,re=i.ai+Y/2,ce=re+Y;for(let fe=-Y;fe<ce;fe+=Y)for(let me=-Y;me<ce;me+=Y){const be=me<0||me>re||fe<0||fe>re?24575:0,Ee=i.ay(Math.round(me),0,i.ai),Te=i.ay(Math.round(fe),0,i.ai);B.emplaceBack(Ee+be,Te)}const ae=(fe,me)=>{const be=me*X+fe;V.emplaceBack(be+1,be,be+X),V.emplaceBack(be+X,be+X+1,be+1)};for(let fe=1;fe<129;fe++)for(let me=1;me<129;me++)ae(me,fe);return[0,129].forEach(fe=>{for(let me=0;me<130;me++)ae(me,fe),ae(fe,me)}),[B,V,32768]}(),A=s.context;this.gridBuffer=A.createVertexBuffer(g,i.b7.members),this.gridIndexBuffer=A.createIndexBuffer(x),this.gridSegments=i.b8.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=i.b8.simpleSegment(0,0,g.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Rb(u.map),this.orthoMatrix=i.ad.mat4.create(),i.ad.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ai,0,i.ai,0,1);const L=A.gl;this._overlapStencilMode=new Dr({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new c2(u.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,u,g){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const x=s.terrain.properties,S=s.terrain.drapeRenderMode===0,A=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const L=s.terrain&&s.terrain.scope,z=x.get("source"),B=S?this._mockSourceCache:s.getSourceCache(z,L);if(!B)return void i.w(`Couldn't find terrain source "${z}".`);if(this.sourceCache=B,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=A?this.calculateExaggeration(u):x.get("exaggeration"),!u.projection.requiresDraping&&A&&this._exaggeration===0)return void this._disable();this.enabled=!0;const V=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(u,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,V(),this._initializing=!0),V(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const u=this._previousCameraAltitude,g=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=g;const x=u!=null?g-u:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const S=s.zoom,A=this._style.terrain;if(!this._previousUpdateTimestamp)return A.getExaggeration(S);let L=S-this._previousZoom;const z=this._previousUpdateTimestamp;let B=S;this._evaluationZoom!=null&&(B=this._evaluationZoom,Math.abs(S-B)>.5&&(L=.5*(S-B+L)),L*x<0&&(B+=L)),this._evaluationZoom=B;const V=A.getExaggeration(B),X=V===A.getExaggeration(Math.max(0,B-.1));if(X&&Math.abs(V-this._exaggeration)<.01)return V;let Y=Math.min(.1,.00375*(this._updateTimestamp-z));return(X||V<.1||Math.abs(L)<1e-4)&&(Y=Math.min(.2,4*Y)),i.ah(this._exaggeration,V,Y)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(i.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(z=>{const B=u.getTileByID(z).tileID;return B.projMatrix=g.calculateProjMatrix(B.toUnwrapped()),B});(function(z,B){const V=B.transform.pointCoordinate(B.transform.getCameraPoint()),X=new i.P(V.x,V.y);z.sort((Y,re)=>{if(re.overscaledZ-Y.overscaledZ)return re.overscaledZ-Y.overscaledZ;const ce=new i.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),ae=new i.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),fe=X.mult(1<<Y.canonical.z);return fe.x-=.5,fe.y-=.5,fe.distSqr(ce)-fe.distSqr(ae)})})(x,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},x.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const A=this._style._mergedSourceCaches;for(const z in A){const B=A[z];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,s[z],S),B.usedForTerrain))continue;const V=s[z];B.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[u.id]=x.map(z=>new fv(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const L={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const B=this.terrainTileForTile[z.key];if(!B)continue;const V=B.tileID.key;V in L||(this._visibleDemTiles.push(B),L[V]=V)}}_assignTerrainTiles(s){this._initializing||s.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const s=this.painter.context,u=s.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],S=x.dem;!S||x.demTexture&&!x.needsDEMTextureUpload||(s.activeTexture.set(u.TEXTURE1),yb(this.painter,x,S))}}_prepareDemTileUniforms(s,u,g,x){if(!u||u.demTexture==null)return!1;const S=s.tileID.canonical,A=Math.pow(2,u.tileID.canonical.z-S.z),L=x||"";return g[`u_dem_tl${L}`]=[S.x*A%1,S.y*A%1],g[`u_dem_scale${L}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const u=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const S=x.dem.tree.minimums[0];return S>0&&s++,g+S},0);return s?u/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,u=s.gl;s.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new i.cL({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(x,{premultiply:!1}):S=this._emptyDEMTexture=new i.T(s,x,u.R32F,{premultiply:!1}),S}setupElevationDraw(s,u,g){const x=this.painter.context,S=x.gl,A={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};A.u_exaggeration=this.exaggeration();let L=null,z=null,B=1;if(g&&g.morphing&&this._useVertexMorphing){const re=g.morphing.srcDemTile,ce=g.morphing.dstDemTile;B=g.morphing.phase,re&&ce&&(this._prepareDemTileUniforms(s,re,A,"_prev")&&(z=re),this._prepareDemTileUniforms(s,ce,A)&&(L=ce))}const V=re=>re&&re.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let X=null;var Y;if(this.enabled?z&&L?(X=L.demTexture,x.activeTexture.set(S.TEXTURE4),z.demTexture.bind(V(z),S.CLAMP_TO_EDGE),A.u_dem_lerp=B):(L=this.terrainTileForTile[s.tileID.key],X=this._prepareDemTileUniforms(s,L,A)?L.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,x.activeTexture.set(S.TEXTURE2),X&&(A.u_dem_size=(Y=X).size[0]===1?1:Y.size[0]-2,X.bind(V(L),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,u,A),g&&g.useMeterToDem&&L){const re=(1<<L.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=re}if(g&&g.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(x,A),this.painter.transform.projection.name==="globe"){const re=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(x,re)}}globeUniformValues(s,u,g){const x=s.projection;return{u_tile_tl_up:x.upVector(u,0,0),u_tile_tr_up:x.upVector(u,i.ai,0),u_tile_br_up:x.upVector(u,i.ai,i.ai),u_tile_bl_up:x.upVector(u,0,i.ai),u_tile_up_scale:g?i.cM(1):x.upVectorScale(u,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const u=this.painter,g=this.painter.context;s.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,S,A,L,z){if(x.transform.projection.name==="globe")(function(B,V,X,Y,re){const ce=B.context,ae=ce.gl;let fe,me;const be=B.transform,Ee=i.cD(B,ce,be),Te=(wt,Tt)=>{if(me===Tt)return;const Dt=[Ob[Tt],"PROJECTION_GLOBE_VIEW"];Ee&&Dt.push("CUSTOM_ANTIALIASING");const Qe=B.isTileAffectedByFog(wt);fe=B.getOrCreateProgram("globeRaster",{defines:Dt,overrideFog:Qe}),me=Tt},Oe=B.colorModeForRenderPass(),Me=new hr(ae.LEQUAL,hr.ReadWrite,B.depthRangeFor3D);Bs.update(re);const Ce=i.cE(be),Pe=[i.av(be.center.lng),i.aC(be.center.lat)],Ne=B.globeSharedBuffers,Ue=[be.width*i.q.devicePixelRatio,be.height*i.q.devicePixelRatio],dt=Float32Array.from(be.globeMatrix),et={useDenormalizedUpVectorScale:!0};{const wt=B.transform,Tt=Vc(wt.zoom,V.exaggeration(),V.sourceCache._source.tileSize);me=-1;const Dt=ae.TRIANGLES;for(const Qe of Y){const bt=X.getTile(Qe),Ye=Dr.disabled,xt=V.prevTerrainTileForTile[Qe.key],gt=V.terrainTileForTile[Qe.key];dv(xt,gt)&&Bs.newMorphing(Qe.key,xt,gt,re,250),ce.activeTexture.set(ae.TEXTURE0),bt.texture&&bt.texture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const Et=Bs.getMorphValuesForProxy(Qe.key),ht=Et?1:0;Et&&i.L(et,{morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:i.cC(Et.phase)}});const Mt=i.cF(Qe.canonical),Vt=i.cG(Mt.getCenter().lat),Wt=i.cH(Qe.canonical,Mt,Vt,wt.worldSize/wt._pixelsPerMercatorPixel),Ht=i.bc(i.cI(Qe.canonical)),ir=Ib(wt.expandedFarZProjMatrix,dt,Ce,Ht,i.ag(wt.zoom),Pe,wt.frustumCorners.TL,wt.frustumCorners.TR,wt.frustumCorners.BR,wt.frustumCorners.BL,wt.globeCenterInViewSpace,wt.globeRadius,Ue,Tt,wt._farZ,Wt);if(Te(Qe,ht),fe&&(V.setupElevationDraw(bt,fe,et),B.uploadCommonUniforms(ce,fe,Qe.toUnwrapped()),Ne)){const[Or,vr,Mr]=Ne.getGridBuffers(Vt,Tt!==0);fe.draw(B,Dt,Me,Ye,Oe,Ir.backCCW,ir,"globe_raster",Or,vr,Mr)}}}if(Ne&&(B.renderDefaultNorthPole||B.renderDefaultSouthPole)){const wt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ee&&wt.push("CUSTOM_ANTIALIASING"),fe=B.getOrCreateProgram("globeRaster",{defines:wt});for(const Tt of Y){const{x:Dt,y:Qe,z:bt}=Tt.canonical,Ye=Qe===0,xt=Qe===(1<<bt)-1,[gt,Et,ht,Mt]=Ne.getPoleBuffers(bt,!1);if(Mt&&(Ye||xt)){const Vt=X.getTile(Tt);ce.activeTexture.set(ae.TEXTURE0),Vt.texture&&Vt.texture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);let Wt=i.cJ(bt,Dt,be);const Ht=i.bc(i.cI(Tt.canonical)),ir=(Or,vr)=>Or.draw(B,ae.TRIANGLES,Me,Dr.disabled,Oe,Ir.disabled,Ib(be.expandedFarZProjMatrix,Wt,Wt,Ht,0,Pe,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Ue,0,be._farZ),"globe_pole_raster",vr,ht,Mt);V.setupElevationDraw(Vt,fe,et),B.uploadCommonUniforms(ce,fe,Tt.toUnwrapped()),Ye&&B.renderDefaultNorthPole&&ir(fe,gt),xt&&B.renderDefaultSouthPole&&(Wt=i.ad.mat4.scale(i.ad.mat4.create(),Wt,[1,-1,1]),ir(fe,Et))}}}})(x,S,A,L,z);else{const B=x.context,V=B.gl;let X,Y;const re=x.shadowRenderer,ce=Bc(x,x.longestCutoffRange),ae=Oe=>{if(Y===Oe)return;const Me=[];Me.push(Ob[Oe]),ce.shouldRenderCutoff&&Me.push("RENDER_CUTOFF"),re&&(Me.push("RENDER_SHADOWS","DEPTH_TEXTURE"),re.useNormalOffset&&Me.push("NORMAL_OFFSET")),X=x.getOrCreateProgram("terrainRaster",{defines:Me}),Y=Oe},fe=x.colorModeForRenderPass(),me=new hr(V.LEQUAL,hr.ReadWrite,x.depthRangeFor3D);Bs.update(z);const be=x.transform,Ee=Vc(be.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let Te=[0,0,0];if(re){const Oe=x.style.directionalLight,Me=x.style.ambientLight;Oe&&Me&&(Te=gf(x.style,Oe,Me))}{Y=-1;const Oe=V.TRIANGLES,[Me,Ce]=[S.gridIndexBuffer,S.gridSegments];for(const Pe of L){const Ne=A.getTile(Pe),Ue=Dr.disabled,dt=S.prevTerrainTileForTile[Pe.key],et=S.terrainTileForTile[Pe.key];dv(dt,et)&&Bs.newMorphing(Pe.key,dt,et,z,250),B.activeTexture.set(V.TEXTURE0),Ne.texture&&Ne.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const wt=Bs.getMorphValuesForProxy(Pe.key),Tt=wt?1:0;let Dt;wt&&(Dt={morphing:{srcDemTile:wt.from,dstDemTile:wt.to,phase:i.cC(wt.phase)}});const Qe=l2(Pe.projMatrix,kb(Pe.canonical,be.renderWorldCopies)?Ee/10:Ee,Te);if(ae(Tt),!X)continue;S.setupElevationDraw(Ne,X,Dt);const bt=Pe.toUnwrapped();re&&re.setupShadows(bt,X),x.uploadCommonUniforms(B,X,bt,null,ce),X.draw(x,Oe,me,Ue,fe,Ir.backCCW,Qe,"terrain_raster",S.gridBuffer,Me,Ce)}}}}(u,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,x=this.proxySourceCache,S=this.proxiedCoords[x.id],A=this._drapedRenderBatches.shift(),L=u.style.order,z=[];let B=0;for(const V of S){const X=x.getTileByID(V.proxyTileKey),Y=x.proxyCachedFBO[V.key]?x.proxyCachedFBO[V.key][s]:void 0,re=Y!==void 0?x.renderCache[Y]:this.pool[B++],ce=Y!==void 0;if(X.texture=re.tex,ce&&!re.dirty){z.push(X.tileID);continue}let ae;g.bindFramebuffer.set(re.fb.framebuffer),this.renderedToTile=!1,re.dirty&&(g.clear({color:i.al.transparent,stencil:0}),re.dirty=!1);for(let fe=A.start;fe<=A.end;++fe){const me=u.style._mergedLayers[L[fe]];if(me.isHidden(u.transform.zoom))continue;const be=u.style.getLayerSourceCache(me),Ee=be?this.proxyToSource[V.key][be.id]:[V];if(!Ee)continue;const Te=Ee;g.viewport.set([0,0,re.fb.width,re.fb.height]),ae!==(be?be.id:null)&&(this._setupStencil(re,Ee,me,be),ae=be?be.id:null),u.renderLayer(u,be,me,Te)}if(this._drapedRenderBatches.length===0)for(const fe of this._pendingGroundEffectLayers){const me=u.style._mergedLayers[L[fe]];if(me.isHidden(u.transform.zoom))continue;const be=u.style.getLayerSourceCache(me),Ee=be?this.proxyToSource[V.key][be.id]:[V];if(!Ee)continue;const Te=Ee;g.viewport.set([0,0,re.fb.width,re.fb.height]),ae!==(be?be.id:null)&&(this._setupStencil(re,Ee,me,be),ae=be?be.id:null),u.renderLayer(u,be,me,Te)}this.renderedToTile?(re.dirty=!0,z.push(X.tileID)):ce||--B,B===5&&(B=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),A.end+1}postRender(){}isLayerOrderingCorrect(s){const u=s.order.length;let g=-1,x=u;for(let S=0;S<u;++S)this._style.isLayerDraped(s._mergedLayers[s.order[S]])?g=Math.max(g,S):x=Math.min(x,S);return x>g}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{s=Math.min(s,u.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,u,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const A=S.tileID,L=1<<A.overscaledZ,{x:z,y:B}=A.canonical,V=z/L,X=(z+1)/L,Y=B/L,re=(B+1)/L;return{minx:V,miny:Y,maxx:X,maxy:re,t:S.dem.tree.raycastRoot(V,Y,X,re,s,u,g),tile:S}});x.sort((S,A)=>(S.t!==null?S.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const S of x){if(S.t==null)return null;const A=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,s,u,g);if(A!=null)return A}return null}_createFBO(){const s=this.painter.context,u=s.gl,g=this.drapeBufferSize;s.activeTexture.set(u.TEXTURE0);const x=new i.T(s,{width:g[0],height:g[1],data:null},u.RGBA8);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const S=s.createFramebuffer(g[0],g[1],!0,null);return S.colorAttachment.set(x.texture),S.depthAttachment=new s2(s,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:S,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const u=this._style._mergedLayers[s],g=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const g of this._style.getSources())if(g instanceof rf){s=!0;break}if(!s)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(x);if(S&&!u[S.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.ab){u[S.id]=!0;for(const A of this.proxyCoords){const L=this.proxyToSource[A.key][S.id];if(L)for(const z of L)this._clearRenderCacheForTile(S.id,z)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof zs){s=!0;break}if(!s)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(x);if(!S||u[S.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const A=x.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const z=this.proxyToSource[L.key][S.id];if(z)for(const B of z){const V=hv(S.getTile(B),S.findLoadedParent(B,0),S,this.painter.transform,A);(V.opacity!==1||V.mix!==0)&&this._clearRenderCacheForTile(S.id,B)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,u=s.length;if(u===0)return;const g=[];this._pendingGroundEffectLayers=[];let x,S=0,A=this._style._mergedLayers[s[S]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++S<u;)A=this._style._mergedLayers[s[S]];for(;S<u;++S){const L=this._style._mergedLayers[s[S]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?x===void 0&&(x=S):(L.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),x!==void 0&&(g.push({start:x,end:S-1}),x=void 0)))}if(x!==void 0&&g.push({start:x,end:S-1}),g.length!==0){const L=g[g.length-1];this._pendingGroundEffectLayers.every(z=>z>L.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(s){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const A=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let L=0;L<A.length;++L){const z=Object.values(A[L]);u.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let A=g.length-1;A>=0;A--){const L=g[A];if(u.getTileByID(L.key),u.proxyCachedFBO[L.key]!==void 0){const z=s[L.key],B=this.proxyToSource[L.key];let V=0;for(const X in B){const Y=B[X],re=z[X];if(!re||re.length!==Y.length||Y.some((ce,ae)=>ce!==re[ae]||x[X]&&x[X].hasOwnProperty(ce.key))){V=-1;break}++V}for(const X in u.proxyCachedFBO[L.key])u.renderCache[u.proxyCachedFBO[L.key][X]].dirty=V<0||V!==Object.values(z).length}}const S=[...this._drapedRenderBatches];S.sort((A,L)=>L.end-L.start-(A.end-A.start));for(const A of S)for(const L of g){if(u.proxyCachedFBO[L.key])continue;let z=u.renderCachePool.pop();z===void 0&&u.renderCache.length<50&&(z=u.renderCache.length,u.renderCache.push(this._createFBO())),z!==void 0&&(u.proxyCachedFBO[L.key]={},u.proxyCachedFBO[L.key][A.start]=z,u.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(s,u,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,A=S.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let L;if(g.isTileClipped())L=u.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Dr.disabled}_renderTileClippingMasks(s,u){const g=this.painter,x=this.painter.context,S=x.gl;g._tileClippingMaskIDs={},x.setColorMode(Xr.disabled),x.setDepthMode(hr.disabled);const A=g.getOrCreateProgram("clippingMask");for(const L of s){const z=g._tileClippingMaskIDs[L.key]=--u;A.draw(g,S.TRIANGLES,hr.disabled,new Dr({func:S.ALWAYS,mask:0},z,255,S.KEEP,S.KEEP,S.REPLACE),Xr.disabled,Ir.disabled,Sf(L.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){const u=this.painter.transform;if(s.x<0||s.x>u.width||s.y<0||s.y>u.height)return null;const g=[s.x,s.y,1,1];i.ad.vec4.transformMat4(g,g,u.pixelMatrixInverse),i.ad.vec4.scale(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const x=u._camera.position,S=i.bH(1,u.center.lat),A=[x[0],x[1],x[2]/S,0],L=i.ad.vec3.subtract([],g.slice(0,3),A);i.ad.vec3.normalize(L,L);const z=this.raycast(A,L,this._exaggeration);return z!==null&&z?(i.ad.vec3.scaleAndAdd(A,A,L,z),A[3]=A[2],A[2]*=S,A):null}_setupProxiedCoordsForOrtho(s,u,g){if(s.getSource()instanceof i.aK)return this._setupProxiedCoordsForImageSource(s,u,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const x=this.proxiedCoords[s.id]=[],S=this.proxyCoords;for(let z=0;z<S.length;z++){const B=S[z],V=this._findTileCoveringTileID(B,s);if(V){const X=this._createProxiedId(B,V,g[B.key]&&g[B.key][s.id]);x.push(X),this.proxyToSource[B.key][s.id]=[X]}}let A=!1;const L=new Set;for(let z=0;z<u.length;z++){const B=s.getTile(u[z]);if(!B||!B.hasData())continue;const V=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==B.tileID.canonical.z){const X=this.proxyToSource[V.tileID.key][s.id],Y=this._createProxiedId(V.tileID,B,g[V.tileID.key]&&g[V.tileID.key][s.id]);X?X.splice(X.length-1,0,Y):this.proxyToSource[V.tileID.key][s.id]=[Y];const re=this.proxyToSource[V.tileID.key][s.id];L.has(re)||L.add(re),x.push(Y),A=!0}}if(this._sourceTilesOverlap[s.id]=A,A&&this._debugParams.sortTilesHiZFirst)for(const z of L)z.sort((B,V)=>V.overscaledZ-B.overscaledZ)}_setupProxiedCoordsForImageSource(s,u,g){if(!s.getSource().loaded())return;const x=this.proxiedCoords[s.id]=[],S=this.proxyCoords,A=s.getSource(),L=A.tileID;if(!L)return;const z=new i.P(L.x,L.y)._div(1<<L.z),B=A.coordinates.map(i.ac.fromLngLat).reduce((X,Y)=>(X.min.x=Math.min(X.min.x,Y.x-z.x),X.min.y=Math.min(X.min.y,Y.y-z.y),X.max.x=Math.max(X.max.x,Y.x-z.x),X.max.y=Math.max(X.max.y,Y.y-z.y),X),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(X,Y)=>{const re=X.wrap+X.canonical.x/(1<<X.canonical.z),ce=X.canonical.y/(1<<X.canonical.z),ae=i.ai/(1<<X.canonical.z),fe=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),me=Y.canonical.y/(1<<Y.canonical.z);return re+ae<fe+B.min.x||re>fe+B.max.x||ce+ae<me+B.min.y||ce>me+B.max.y};for(let X=0;X<S.length;X++){const Y=S[X];for(let re=0;re<u.length;re++){const ce=s.getTile(u[re]);if(!ce||!ce.hasData()||V(Y,ce.tileID))continue;const ae=this._createProxiedId(Y,ce,g[Y.key]&&g[Y.key][s.id]),fe=this.proxyToSource[Y.key][s.id];fe?fe.push(ae):this.proxyToSource[Y.key][s.id]=[ae],x.push(ae)}}}_createProxiedId(s,u,g){let x=this.orthoMatrix;if(g){const S=g.find(A=>A.key===u.tileID.key);if(S)return S}if(u.tileID.key!==s.key){const S=s.canonical.z-u.tileID.canonical.z;let A,L,z;x=i.ad.mat4.create();const B=u.tileID.wrap-s.wrap<<s.overscaledZ;S>0?(A=i.ai>>S,L=A*((u.tileID.canonical.x<<S)-s.canonical.x+B),z=A*((u.tileID.canonical.y<<S)-s.canonical.y)):(A=i.ai<<-S,L=i.ai*(u.tileID.canonical.x-(s.canonical.x+B<<-S)),z=i.ai*(u.tileID.canonical.y-(s.canonical.y<<-S))),i.ad.mat4.ortho(x,0,A,0,A,0,1),i.ad.mat4.translate(x,x,[L,z,0])}return new fv(u.tileID,s.key,x)}_findTileCoveringTileID(s,u){let g=u.getTile(s);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[u.id],S=x[s.key];if(g=S?u.getTileByID(S):null,g&&g.hasData()||S===null)return g;let A=g?g.tileID:s,L=A.overscaledZ;const z=u.getSource().minzoom,B=[];if(!S){const X=u.getSource().maxzoom;if(s.canonical.z>=X){const Y=s.canonical.z-X;u.getSource().reparseOverscaled?(L=Math.max(s.canonical.z+2,u.transform.tileZoom),A=new i.aH(L,s.wrap,X,s.canonical.x>>Y,s.canonical.y>>Y)):Y!==0&&(L=X,A=new i.aH(L,s.wrap,X,s.canonical.x>>Y,s.canonical.y>>Y))}A.key!==s.key&&(B.push(A.key),g=u.getTile(A))}const V=X=>{B.forEach(Y=>{x[Y]=X}),B.length=0};for(L-=1;L>=z&&(!g||!g.hasData());L--){g&&V(g.tileID.key);const X=A.calculateScaledKey(L);if(g=u.getTileByID(X),g&&g.hasData())break;const Y=x[X];if(Y===null)break;Y===void 0?B.push(X):g=u.getTileByID(Y)}return V(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,u){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[u.key]=!0}}function d2(y,s,u){const g=function(L,z,B){const V=i.ad.vec3.dot(z,L),X=i.ad.vec3.dot(B,[.2126,.7152,.0722]),Y=(ce,ae,fe)=>(1-fe)*ce+fe*ae,re=Y(1-.3*Math.min(X,1),1,Math.min(V+1,1));return Y(.92,1,Math.asin(i.ay(z[2],-1,1))/Math.PI+.5)*re}(y,[0,0,1],s),x=[0,0,0];i.ad.vec3.scale(x,u.slice(0,3),g);const S=[0,0,0];i.ad.vec3.scale(S,s.slice(0,3),y[2]);const A=[0,0,0];return i.ad.vec3.add(A,x,S),i.cg(A)}const qm=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],tD=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class h2{static cacheKey(s,u,g,x){let S=`${u}${x?x.cacheKey:""}`;for(const A of g)s.usedDefines.includes(A)&&(S+=`/${A}`);return S}constructor(s,u,g,x,S,A){const L=s.gl;this.program=L.createProgram(),this.configuration=x,this.name=u,this.fixedDefines=[...A];const z=x?x.getBinderAttributes():[],B=(g.staticAttributes||[]).concat(z);let V=x?x.defines():[];V=V.concat(A.map(fe=>`#define ${fe}`));const X=`#version 300 es
`;let Y=X+V.concat("precision mediump float;",av,gb.fragmentSource).join(`
`);for(const fe of g.fragmentIncludes)Y+=`
${Yd[fe]}`;Y+=`
${g.fragmentSource}`;let re=X+V.concat("precision highp float;",av,gb.vertexSource).join(`
`);for(const fe of g.vertexIncludes)re+=`
${Yd[fe]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(re+=`
uniform int u_instanceID;
`),re+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(re=re.replaceAll("gl_InstanceID","u_instanceID"));const ce=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(ce,Y),L.compileShader(ce),L.attachShader(this.program,ce);const ae=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(ae,re),L.compileShader(ae),L.attachShader(this.program,ae),this.attributes={},this.numAttributes=B.length;for(let fe=0;fe<this.numAttributes;fe++)if(B[fe]){const me=B[fe].startsWith("a_")?B[fe]:`a_${B[fe]}`;L.bindAttribLocation(this.program,fe,me),this.attributes[me]=fe}L.linkProgram(this.program),L.deleteShader(ae),L.deleteShader(ce),this.fixedUniforms=S(s),this.binderUniforms=x?x.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(fe=>({u_instanceID:new i.bN(fe)}))(s)),(A.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(fe=>({u_dem:new i.bN(fe),u_dem_prev:new i.bN(fe),u_dem_tl:new i.bK(fe),u_dem_scale:new i.bM(fe),u_dem_tl_prev:new i.bK(fe),u_dem_scale_prev:new i.bM(fe),u_dem_size:new i.bM(fe),u_dem_lerp:new i.bM(fe),u_exaggeration:new i.bM(fe),u_depth:new i.bN(fe),u_depth_size_inv:new i.bK(fe),u_depth_range_unpack:new i.bK(fe),u_occluder_half_size:new i.bM(fe),u_occlusion_depth_offset:new i.bM(fe),u_meter_to_dem:new i.bM(fe),u_label_plane_matrix_inv:new i.bJ(fe)}))(s)),A.includes("GLOBE")&&(this.globeUniforms=(fe=>({u_tile_tl_up:new i.bL(fe),u_tile_tr_up:new i.bL(fe),u_tile_br_up:new i.bL(fe),u_tile_bl_up:new i.bL(fe),u_tile_up_scale:new i.bM(fe)}))(s)),A.includes("FOG")&&(this.fogUniforms=(fe=>({u_fog_matrix:new i.bJ(fe),u_fog_range:new i.bK(fe),u_fog_color:new i.cb(fe),u_fog_horizon_blend:new i.bM(fe),u_fog_vertical_limit:new i.bK(fe),u_fog_temporal_offset:new i.bM(fe),u_frustum_tl:new i.bL(fe),u_frustum_tr:new i.bL(fe),u_frustum_br:new i.bL(fe),u_frustum_bl:new i.bL(fe),u_globe_pos:new i.bL(fe),u_globe_radius:new i.bM(fe),u_globe_transition:new i.bM(fe),u_is_globe:new i.bN(fe),u_viewport:new i.bK(fe)}))(s)),A.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(fe=>({u_cutoff_params:new i.cb(fe)}))(s)),A.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(fe=>({u_lighting_ambient_color:new i.bL(fe),u_lighting_directional_dir:new i.bL(fe),u_lighting_directional_color:new i.bL(fe),u_ground_radiance:new i.bL(fe)}))(s)),A.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(fe=>({u_light_matrix_0:new i.bJ(fe),u_light_matrix_1:new i.bJ(fe),u_fade_range:new i.bK(fe),u_shadow_normal_offset:new i.bL(fe),u_shadow_intensity:new i.bM(fe),u_shadow_texel_size:new i.bM(fe),u_shadow_map_resolution:new i.bM(fe),u_shadow_direction:new i.bL(fe),u_shadow_bias:new i.bL(fe),u_shadowmap_0:new i.bN(fe),u_shadowmap_1:new i.bN(fe)}))(s))}}setTerrainUniformValues(s,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setGlobeUniformValues(s,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setFogUniformValues(s,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setCutoffUniformValues(s,u){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setLightsUniformValues(s,u){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setShadowUniformValues(s,u){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;s.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}_drawDebugWireframe(s,u,g,x,S,A,L,z,B,V){const X=s.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const Y=s.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||s._terrain&&s._terrain.renderingToTexture||!qm.includes(this.name))||!(!X.layers3D||!tD.includes(this.name))))return;const re=Y.gl,ce=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,S,Y);if(!ce)return;const ae=[...this.fixedDefines];ae.push("DEBUG_WIREFRAME");const fe=s.getOrCreateProgram(this.name,{config:this.configuration,defines:ae});Y.program.set(fe.program);const me=(Te,Oe,Me)=>{if(Oe[Te]&&Me[Te])for(const Ce in Oe[Te])Me[Te][Ce]&&Me[Te][Ce].set(Me.program,Ce,Oe[Te][Ce].current)};B&&B.setUniforms(fe.program,Y,fe.binderUniforms,L,{zoom:z}),me("fixedUniforms",this,fe),me("terrainUniforms",this,fe),me("globeUniforms",this,fe),me("fogUniforms",this,fe),me("lightsUniforms",this,fe),me("shadowUniforms",this,fe),ce.bind(),Y.setColorMode(new Xr([re.ONE,re.ONE_MINUS_SRC_ALPHA,re.ZERO,re.ONE],i.al.transparent,[!0,!0,!0,!1])),Y.setDepthMode(new hr(u.func===re.LESS?re.LEQUAL:u.func,hr.ReadOnly,u.range)),Y.setStencilMode(Dr.disabled);const be=3*A.primitiveLength*2,Ee=3*A.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Te=V||1;for(let Oe=0;Oe<Te;++Oe)fe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Oe),re.drawElements(re.LINES,be,re.UNSIGNED_SHORT,Ee)}else V&&V>1?re.drawElementsInstanced(re.LINES,be,re.UNSIGNED_SHORT,Ee,V):re.drawElements(re.LINES,be,re.UNSIGNED_SHORT,Ee);S.bind(),Y.program.set(this.program),Y.setDepthMode(u),Y.setStencilMode(g),Y.setColorMode(x)}checkUniforms(s,u,g){if(this.fixedDefines.includes(u)){for(const x of Object.keys(g))if(!g[x].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${x} not set but required by ${u} being defined`)}}draw(s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe){const me=s.context,be=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(g),me.setStencilMode(x),me.setColorMode(S),me.setCullFace(A);for(const Oe of Object.keys(this.fixedUniforms))this.fixedUniforms[Oe].set(this.program,Oe,L[Oe]);ce&&ce.setUniforms(this.program,me,this.binderUniforms,Y,{zoom:re});const Ee={[be.POINTS]:1,[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[u];this.checkUniforms(z,"RENDER_SHADOWS",this.shadowUniforms);const Te=fe&&fe>0?1:void 0;for(const Oe of X.get()){const Me=Oe.vaos||(Oe.vaos={});if((Me[z]||(Me[z]=new e2)).bind(me,this,B,ce?ce.getPaintVertexBuffers():[],V,Oe.vertexOffset,ae||[],Te),this.forceManualRenderingForInstanceIDShaders){const Ce=fe||1;for(let Pe=0;Pe<Ce;++Pe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Pe),V?be.drawElements(u,Oe.primitiveLength*Ee,be.UNSIGNED_SHORT,Oe.primitiveOffset*Ee*2):be.drawArrays(u,Oe.vertexOffset,Oe.vertexLength)}else fe&&fe>1?be.drawElementsInstanced(u,Oe.primitiveLength*Ee,be.UNSIGNED_SHORT,Oe.primitiveOffset*Ee*2,fe):V?be.drawElements(u,Oe.primitiveLength*Ee,be.UNSIGNED_SHORT,Oe.primitiveOffset*Ee*2):be.drawArrays(u,Oe.vertexOffset,Oe.vertexLength);u===be.TRIANGLES&&V&&this._drawDebugWireframe(s,g,x,S,V,Oe,Y,re,ce,fe)}}}function Db(y,s){const u=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,y.transform.tileZoom)/u,x=g*(s.tileID.canonical.x+s.tileID.wrap*u),S=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.at(s,1,y.transform.tileZoom),u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const pv={terrain:0,flat:1},Lb=i.ad.mat4.create(),mv=(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me)=>{const be=s.style.light,Ee=be.properties.get("position"),Te=[Ee.x,Ee.y,Ee.z],Oe=i.ad.mat3.create();be.properties.get("anchor")==="viewport"&&(i.ad.mat3.fromRotation(Oe,-s.transform.angle),i.ad.vec3.transformMat3(Te,Te,Oe));const Me=be.properties.get("color"),Ce=s.transform,Pe={u_matrix:y,u_lightpos:Te,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Lb,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:pv[B],u_base_type:pv[V],u_ao:x,u_edge_radius:S,u_width_scale:A,u_flood_light_color:ce,u_vertical_scale:ae,u_flood_light_intensity:fe,u_ground_shadow_factor:me};return Ce.projection.name==="globe"&&(Pe.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],Pe.u_zoom_transition=X,Pe.u_inv_rot_matrix=re,Pe.u_merc_center=Y,Pe.u_up_dir=Ce.projection.upVector(new i.bT(0,0,0),Y[0]*i.ai,Y[1]*i.ai),Pe.u_height_lift=z),Pe},Tf=(y,s,u,g,x,S)=>({u_matrix:y,u_edge_radius:s,u_width_scale:u,u_vertical_scale:g,u_height_type:pv[x],u_base_type:pv[S]}),Nb=(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe)=>{const me=mv(y,s,u,g,x,S,A,L,B,V,X,Y,re,ce,ae,fe,1,[0,0,0]),be={u_height_factor:-Math.pow(2,L.overscaledZ)/z.tileSize/8};return i.l(me,Db(s,z),be)},Ef=(y,s)=>({u_matrix:y,u_emissive_strength:s}),zb=(y,s,u,g)=>i.l(Ef(y,s),Db(u,g)),gv=(y,s,u)=>({u_matrix:y,u_world:u,u_emissive_strength:s}),yv=(y,s,u,g,x)=>i.l(zb(y,s,u,g),{u_world:x}),Hm=(y,s,u,g,x)=>({u_matrix:y,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:u,u_height_scale:g,u_reset_depth:x}),f2=(y,s,u,g)=>{const x=i.ai/u.tileSize;return{u_matrix:y,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/x,s.pixelsToGLUnits[1]/x]}},p2=(y,s,u=1)=>({u_matrix:y,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:u}),Af=i.ad.mat4.create(),vv=(y,s,u,g,x,S,A)=>{const L=y.transform,z=L.projection.name==="globe",B=z?i.cO(L.zoom,s.canonical)*L._pixelsPerMercatorPixel:i.at(u,1,S),V={u_matrix:s.projMatrix,u_extrude_scale:B,u_intensity:A,u_inv_rot_matrix:Af,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){V.u_inv_rot_matrix=g,V.u_merc_center=x,V.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],V.u_zoom_transition=i.ag(L.zoom);const X=x[0]*i.ai,Y=x[1]*i.ai;V.u_up_dir=L.projection.upVector(new i.bT(0,0,0),X,Y)}return V};function Jt(y,[s,u,g,x],[S,A]){if(S===A)return[0,0,0,0];const L=255*(y-1)/(y*(A-S));return[s*L,u*L,g*L,x*L]}function jb(y,s,[u,g]){return u===g?0:.5/y+(s-u)*(y-1)/(y*(g-u))}const Fb=(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me,be,Ee,Te)=>({u_matrix:y,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:B,u_fade_t:V.mix,u_opacity:V.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:i.cP(X.paint.get("raster-saturation")),u_contrast_factor:i.cQ(X.paint.get("raster-contrast")),u_spin_weights:qu(X.paint.get("raster-hue-rotate")),u_perspective_transform:Y,u_raster_elevation:re,u_zoom_transition:A,u_merc_center:L,u_cutoff_params:z,u_colorization_mix:Jt(i.cR,ae,me),u_colorization_offset:jb(i.cR,fe,me),u_color_ramp:ce,u_texture_offset:[Ee/(be+2*Ee),be/(be+2*Ee)],u_texture_res:[be+2*Ee,be+2*Ee],u_emissive_strength:Te});function qu(y){y*=Math.PI/180;const s=Math.sin(y),u=Math.cos(y);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const fs=.05,pr=(y,s,u,g,x,S,A,L,z,B,V,X)=>({u_matrix:y,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:B,u_fade_t:V.mix,u_opacity:V.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:A,u_merc_center:L,u_cutoff_params:z}),Bb=(y,s,u,g,x,S,A,L,z,B)=>({u_particle_texture:y,u_particle_texture_side_len:s,u_tile_offset:u,u_velocity:g,u_color_ramp:S,u_velocity_res:x,u_max_speed:A,u_uv_offset:L,u_data_scale:[255*z[0],255*z[1]],u_data_offset:B,u_particle_pos_scale:1.1,u_particle_pos_offset:[fs,fs]}),rD=(y,s,u,g,x,S,A,L,z,B)=>({u_particle_texture:y,u_particle_texture_side_len:s,u_velocity:u,u_velocity_res:g,u_max_speed:x,u_speed_factor:S,u_reset_rate:A,u_rand_seed:Math.random(),u_uv_offset:L,u_data_scale:[255*z[0],255*z[1]],u_data_offset:B,u_particle_pos_scale:1.1,u_particle_pos_offset:[fs,fs]}),m2=i.ad.mat4.create(),_v=(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me,be,Ee,Te,Oe)=>{const Me=x.transform,Ce={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Me.getCameraToCenterDistance(be),u_rotate_symbol:+u,u_aspect_ratio:Me.width/Me.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:A,u_coord_matrix:L,u_is_text:+B,u_elevation_from_sea:z?1:0,u_pitch_with_map:+g,u_texsize:V,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:m2,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:m2,u_up_vector:[0,-1,0],u_color_adj_mat:Ee,u_icon_transition:Te||0,u_gamma_scale:g?x.transform.getCameraToCenterDistance(be)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+Y,u_scale_factor:Oe||1};return be.name==="globe"&&(Ce.u_tile_id=[re.canonical.x,re.canonical.y,1<<re.canonical.z],Ce.u_zoom_transition=ce,Ce.u_inv_rot_matrix=fe,Ce.u_merc_center=ae,Ce.u_camera_forward=Me._camera.forward(),Ce.u_ecef_origin=i.cS(Me.globeMatrix,re.toUnwrapped()),Ce.u_tile_matrix=Float32Array.from(Me.globeMatrix),Ce.u_up_vector=me),Ce},$b=(y,s,u,g)=>({u_matrix:y,u_emissive_strength:s,u_opacity:u,u_color:g}),g2=(y,s,u,g,x,S,A,L,z)=>i.l(function(B,V,X,Y,re,ce){const{width:ae,height:fe}=Y.imageManager.getPixelSize(V),me=Math.pow(2,ce.tileID.overscaledZ),be=ce.tileSize*Math.pow(2,Y.transform.tileZoom)/me,Ee=be*(ce.tileID.canonical.x+ce.tileID.wrap*me),Te=be*ce.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[ae,fe],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:re?[Y.transform.width,-1*Y.transform.height]:[1/i.at(ce,1,Y.transform.tileZoom),1/i.at(ce,1,Y.transform.tileZoom)],u_pixel_coord_upper:[Ee>>16,Te>>16],u_pixel_coord_lower:[65535&Ee,65535&Te]}}(0,S,A,g,L,z),{u_matrix:y,u_emissive_strength:s,u_opacity:u}),xv=new Float32Array(i.ad.mat4.identity([])),Ub=(y,s,u,g,x,S,A,L,z,B,V,X,Y,re=[0,0,0],ce)=>{const ae=x.style.light,fe=ae.properties.get("position"),me=[-fe.x,-fe.y,fe.z],be=i.ad.mat3.create();ae.properties.get("anchor")==="viewport"&&(i.ad.mat3.fromRotation(be,-x.transform.angle),i.ad.vec3.transformMat3(me,me,be));const Ee=V.alphaMode==="MASK",Te=ae.properties.get("color").toRenderColor(null),Oe=Y.paint.get("model-ambient-occlusion-intensity"),Me=Y.paint.get("model-color").constantOr(i.al.white).toRenderColor(null),Ce=Y.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:y,u_lighting_matrix:s,u_normal_matrix:u,u_node_matrix:g||xv,u_lightpos:me,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_camera_pos:re,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+Ee,u_alphaCutoff:V.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[L[0],L[1],L[2],1],u_metallicFactor:z,u_roughnessFactor:B,u_baseColorTexture:Ii.BaseColor,u_metallicRoughnessTexture:Ii.MetallicRoughness,u_normalTexture:Ii.Normal,u_occlusionTexture:Ii.Occlusion,u_emissionTexture:Ii.Emission,u_lutTexture:Ii.LUT,u_color_mix:[Me.r,Me.g,Me.b,Ce],u_aoIntensity:Oe,u_emissive_strength:X,u_occlusionTextureTransform:ce||[0,0,0,0]}},y2=(y,s=xv,u=xv)=>({u_matrix:y,u_instance:s,u_node_matrix:u}),Vb={fillExtrusion:y=>({u_matrix:new i.bJ(y),u_lightpos:new i.bL(y),u_lightintensity:new i.bM(y),u_lightcolor:new i.bL(y),u_vertical_gradient:new i.bM(y),u_opacity:new i.bM(y),u_edge_radius:new i.bM(y),u_width_scale:new i.bM(y),u_ao:new i.bK(y),u_height_type:new i.bN(y),u_base_type:new i.bN(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_up_dir:new i.bL(y),u_height_lift:new i.bM(y),u_flood_light_color:new i.bL(y),u_vertical_scale:new i.bM(y),u_flood_light_intensity:new i.bM(y),u_ground_shadow_factor:new i.bL(y)}),fillExtrusionDepth:y=>({u_matrix:new i.bJ(y),u_edge_radius:new i.bM(y),u_width_scale:new i.bM(y),u_vertical_scale:new i.bM(y),u_height_type:new i.bN(y),u_base_type:new i.bN(y)}),fillExtrusionPattern:y=>({u_matrix:new i.bJ(y),u_lightpos:new i.bL(y),u_lightintensity:new i.bM(y),u_lightcolor:new i.bL(y),u_vertical_gradient:new i.bM(y),u_height_factor:new i.bM(y),u_edge_radius:new i.bM(y),u_width_scale:new i.bM(y),u_ao:new i.bK(y),u_height_type:new i.bN(y),u_base_type:new i.bN(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_up_dir:new i.bL(y),u_height_lift:new i.bM(y),u_image:new i.bN(y),u_texsize:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_tile_units_to_pixels:new i.bM(y),u_opacity:new i.bM(y)}),fillExtrusionGroundEffect:y=>({u_matrix:new i.bJ(y),u_opacity:new i.bM(y),u_ao_pass:new i.bM(y),u_meter_to_tile:new i.bM(y),u_ao:new i.bK(y),u_flood_light_intensity:new i.bM(y),u_flood_light_color:new i.bL(y),u_attenuation:new i.bM(y),u_edge_radius:new i.bM(y),u_fb:new i.bN(y),u_fb_size:new i.bM(y),u_dynamic_offset:new i.bM(y)}),fill:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y)}),fillPattern:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_image:new i.bN(y),u_texsize:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_tile_units_to_pixels:new i.bM(y)}),fillOutline:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_world:new i.bK(y)}),fillOutlinePattern:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_world:new i.bK(y),u_image:new i.bN(y),u_texsize:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_tile_units_to_pixels:new i.bM(y)}),elevatedStructures:y=>({u_matrix:new i.bJ(y)}),elevatedStructuresDepthReconstruct:y=>({u_matrix:new i.bJ(y),u_camera_pos:new i.bL(y),u_depth_bias:new i.bM(y),u_height_scale:new i.bM(y),u_reset_depth:new i.bM(y)}),circle:i.cT,collisionBox:y=>({u_matrix:new i.bJ(y),u_camera_to_center_distance:new i.bM(y),u_extrude_scale:new i.bK(y)}),collisionCircle:y=>({u_matrix:new i.bJ(y),u_inv_matrix:new i.bJ(y),u_camera_to_center_distance:new i.bM(y),u_viewport_size:new i.bK(y)}),debug:y=>({u_color:new i.cA(y),u_matrix:new i.bJ(y),u_overlay:new i.bN(y),u_overlay_scale:new i.bM(y)}),clippingMask:y=>({u_matrix:new i.bJ(y)}),heatmap:y=>({u_extrude_scale:new i.bM(y),u_intensity:new i.bM(y),u_matrix:new i.bJ(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_up_dir:new i.bL(y)}),heatmapTexture:y=>({u_image:new i.bN(y),u_color_ramp:new i.bN(y),u_opacity:new i.bM(y)}),hillshade:y=>({u_matrix:new i.bJ(y),u_image:new i.bN(y),u_latrange:new i.bK(y),u_light:new i.bK(y),u_shadow:new i.cA(y),u_highlight:new i.cA(y),u_emissive_strength:new i.bM(y),u_accent:new i.cA(y)}),hillshadePrepare:y=>({u_matrix:new i.bJ(y),u_image:new i.bN(y),u_dimension:new i.bK(y),u_zoom:new i.bM(y)}),line:i.cU,linePattern:i.cV,raster:y=>({u_matrix:new i.bJ(y),u_normalize_matrix:new i.bJ(y),u_globe_matrix:new i.bJ(y),u_merc_matrix:new i.bJ(y),u_grid_matrix:new i.cB(y),u_tl_parent:new i.bK(y),u_scale_parent:new i.bM(y),u_fade_t:new i.bM(y),u_opacity:new i.bM(y),u_image0:new i.bN(y),u_image1:new i.bN(y),u_brightness_low:new i.bM(y),u_brightness_high:new i.bM(y),u_saturation_factor:new i.bM(y),u_contrast_factor:new i.bM(y),u_spin_weights:new i.bL(y),u_perspective_transform:new i.bK(y),u_raster_elevation:new i.bM(y),u_zoom_transition:new i.bM(y),u_merc_center:new i.bK(y),u_cutoff_params:new i.cb(y),u_colorization_mix:new i.cb(y),u_colorization_offset:new i.bM(y),u_color_ramp:new i.bN(y),u_texture_offset:new i.bK(y),u_texture_res:new i.bK(y),u_emissive_strength:new i.bM(y)}),rasterParticle:y=>({u_matrix:new i.bJ(y),u_normalize_matrix:new i.bJ(y),u_globe_matrix:new i.bJ(y),u_merc_matrix:new i.bJ(y),u_grid_matrix:new i.cB(y),u_tl_parent:new i.bK(y),u_scale_parent:new i.bM(y),u_fade_t:new i.bM(y),u_opacity:new i.bM(y),u_image0:new i.bN(y),u_image1:new i.bN(y),u_raster_elevation:new i.bM(y),u_zoom_transition:new i.bM(y),u_merc_center:new i.bK(y),u_cutoff_params:new i.cb(y)}),rasterParticleTexture:y=>({u_texture:new i.bN(y),u_opacity:new i.bM(y)}),rasterParticleDraw:y=>({u_particle_texture:new i.bN(y),u_particle_texture_side_len:new i.bM(y),u_tile_offset:new i.bK(y),u_velocity:new i.bN(y),u_color_ramp:new i.bN(y),u_velocity_res:new i.bK(y),u_max_speed:new i.bM(y),u_uv_offset:new i.bK(y),u_data_scale:new i.bK(y),u_data_offset:new i.bM(y),u_particle_pos_scale:new i.bM(y),u_particle_pos_offset:new i.bK(y)}),rasterParticleUpdate:y=>({u_particle_texture:new i.bN(y),u_particle_texture_side_len:new i.bM(y),u_velocity:new i.bN(y),u_velocity_res:new i.bK(y),u_max_speed:new i.bM(y),u_speed_factor:new i.bM(y),u_reset_rate:new i.bM(y),u_rand_seed:new i.bM(y),u_uv_offset:new i.bK(y),u_data_scale:new i.bK(y),u_data_offset:new i.bM(y),u_particle_pos_scale:new i.bM(y),u_particle_pos_offset:new i.bK(y)}),symbol:y=>({u_is_size_zoom_constant:new i.bN(y),u_is_size_feature_constant:new i.bN(y),u_size_t:new i.bM(y),u_size:new i.bM(y),u_camera_to_center_distance:new i.bM(y),u_rotate_symbol:new i.bN(y),u_aspect_ratio:new i.bM(y),u_fade_change:new i.bM(y),u_matrix:new i.bJ(y),u_label_plane_matrix:new i.bJ(y),u_coord_matrix:new i.bJ(y),u_is_text:new i.bN(y),u_elevation_from_sea:new i.bN(y),u_pitch_with_map:new i.bN(y),u_texsize:new i.bK(y),u_texsize_icon:new i.bK(y),u_texture:new i.bN(y),u_texture_icon:new i.bN(y),u_gamma_scale:new i.bM(y),u_device_pixel_ratio:new i.bM(y),u_tile_id:new i.bL(y),u_zoom_transition:new i.bM(y),u_inv_rot_matrix:new i.bJ(y),u_merc_center:new i.bK(y),u_camera_forward:new i.bL(y),u_tile_matrix:new i.bJ(y),u_up_vector:new i.bL(y),u_ecef_origin:new i.bL(y),u_is_halo:new i.bN(y),u_icon_transition:new i.bM(y),u_color_adj_mat:new i.bJ(y),u_scale_factor:new i.bM(y)}),background:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_opacity:new i.bM(y),u_color:new i.cA(y)}),backgroundPattern:y=>({u_matrix:new i.bJ(y),u_emissive_strength:new i.bM(y),u_opacity:new i.bM(y),u_image:new i.bN(y),u_pattern_tl:new i.bK(y),u_pattern_br:new i.bK(y),u_texsize:new i.bK(y),u_pattern_size:new i.bK(y),u_pixel_coord_upper:new i.bK(y),u_pixel_coord_lower:new i.bK(y),u_pattern_units_to_pixels:new i.bK(y)}),terrainRaster:y=>({u_matrix:new i.bJ(y),u_image0:new i.bN(y),u_skirt_height:new i.bM(y),u_ground_shadow_factor:new i.bL(y)}),skybox:y=>({u_matrix:new i.bJ(y),u_sun_direction:new i.bL(y),u_cubemap:new i.bN(y),u_opacity:new i.bM(y),u_temporal_offset:new i.bM(y)}),skyboxGradient:y=>({u_matrix:new i.bJ(y),u_color_ramp:new i.bN(y),u_center_direction:new i.bL(y),u_radius:new i.bM(y),u_opacity:new i.bM(y),u_temporal_offset:new i.bM(y)}),skyboxCapture:y=>({u_matrix_3f:new i.cB(y),u_sun_direction:new i.bL(y),u_sun_intensity:new i.bM(y),u_color_tint_r:new i.cb(y),u_color_tint_m:new i.cb(y),u_luminance:new i.bM(y)}),globeRaster:y=>({u_proj_matrix:new i.bJ(y),u_globe_matrix:new i.bJ(y),u_normalize_matrix:new i.bJ(y),u_merc_matrix:new i.bJ(y),u_zoom_transition:new i.bM(y),u_merc_center:new i.bK(y),u_image0:new i.bN(y),u_grid_matrix:new i.cB(y),u_skirt_height:new i.bM(y),u_far_z_cutoff:new i.bM(y),u_frustum_tl:new i.bL(y),u_frustum_tr:new i.bL(y),u_frustum_br:new i.bL(y),u_frustum_bl:new i.bL(y),u_globe_pos:new i.bL(y),u_globe_radius:new i.bM(y),u_viewport:new i.bK(y)}),globeAtmosphere:y=>({u_frustum_tl:new i.bL(y),u_frustum_tr:new i.bL(y),u_frustum_br:new i.bL(y),u_frustum_bl:new i.bL(y),u_horizon:new i.bM(y),u_transition:new i.bM(y),u_fadeout_range:new i.bM(y),u_color:new i.cb(y),u_high_color:new i.cb(y),u_space_color:new i.cb(y),u_temporal_offset:new i.bM(y),u_horizon_angle:new i.bM(y)}),model:y=>({u_matrix:new i.bJ(y),u_lighting_matrix:new i.bJ(y),u_normal_matrix:new i.bJ(y),u_node_matrix:new i.bJ(y),u_lightpos:new i.bL(y),u_lightintensity:new i.bM(y),u_lightcolor:new i.bL(y),u_camera_pos:new i.bL(y),u_opacity:new i.bM(y),u_baseColorFactor:new i.cb(y),u_emissiveFactor:new i.cb(y),u_metallicFactor:new i.bM(y),u_roughnessFactor:new i.bM(y),u_baseTextureIsAlpha:new i.bN(y),u_alphaMask:new i.bN(y),u_alphaCutoff:new i.bM(y),u_baseColorTexture:new i.bN(y),u_metallicRoughnessTexture:new i.bN(y),u_normalTexture:new i.bN(y),u_occlusionTexture:new i.bN(y),u_emissionTexture:new i.bN(y),u_lutTexture:new i.bN(y),u_color_mix:new i.cb(y),u_aoIntensity:new i.bM(y),u_emissive_strength:new i.bM(y),u_occlusionTextureTransform:new i.cb(y)}),modelDepth:y=>({u_matrix:new i.bJ(y),u_instance:new i.bJ(y),u_node_matrix:new i.bJ(y)}),groundShadow:y=>({u_matrix:new i.bJ(y),u_ground_shadow_factor:new i.bL(y)}),stars:y=>({u_matrix:new i.bJ(y),u_up:new i.bL(y),u_right:new i.bL(y),u_intensity_multiplier:new i.bM(y)}),snowParticle:y=>({u_modelview:new i.bJ(y),u_projection:new i.bJ(y),u_time:new i.bM(y),u_cam_pos:new i.bL(y),u_velocityConeAperture:new i.bM(y),u_velocity:new i.bM(y),u_horizontalOscillationRadius:new i.bM(y),u_horizontalOscillationRate:new i.bM(y),u_boxSize:new i.bM(y),u_billboardSize:new i.bM(y),u_simpleShapeParameters:new i.bK(y),u_screenSize:new i.bK(y),u_thinningCenterPos:new i.bK(y),u_thinningShape:new i.bL(y),u_thinningAffectedRatio:new i.bM(y),u_thinningParticleOffset:new i.bM(y),u_particleColor:new i.cb(y),u_direction:new i.bL(y)}),rainParticle:y=>({u_modelview:new i.bJ(y),u_projection:new i.bJ(y),u_time:new i.bM(y),u_cam_pos:new i.bL(y),u_texScreen:new i.bN(y),u_velocityConeAperture:new i.bM(y),u_velocity:new i.bM(y),u_boxSize:new i.bM(y),u_rainDropletSize:new i.bK(y),u_distortionStrength:new i.bM(y),u_rainDirection:new i.bL(y),u_color:new i.cb(y),u_screenSize:new i.bK(y),u_thinningCenterPos:new i.bK(y),u_thinningShape:new i.bL(y),u_thinningAffectedRatio:new i.bM(y),u_thinningParticleOffset:new i.bM(y),u_shapeDirectionalPower:new i.bM(y),u_shapeNormalPower:new i.bM(y),u_mode:new i.bM(y)}),vignette:y=>({u_vignetteShape:new i.bL(y),u_vignetteColor:new i.cb(y)}),occlusion:y=>({u_matrix:new i.bJ(y),u_anchorPos:new i.bL(y),u_screenSizePx:new i.bK(y),u_occluderSizePx:new i.bK(y),u_color:new i.cb(y)})};class nc{constructor(s,u,g,x){this.id=nc.uniqueIdxCounter,nc.uniqueIdxCounter++,this.context=s;const S=s.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||x||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=nc.uniqueIdxCounter,nc.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}nc.uniqueIdxCounter=0;const Wb={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Gb{constructor(s,u,g,x,S,A){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.instanceCount=A,this.context=s;const L=s.gl;this.buffer=L.createBuffer(),s.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||S||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let g=0;g<this.attributes.length;g++){const x=u.attributes[this.attributes[g].name];x!==void 0&&s.enableVertexAttribArray(x)}}setVertexAttribPointers(s,u,g){for(let x=0;x<this.attributes.length;x++){const S=this.attributes[x],A=u.attributes[S.name];A!==void 0&&s.vertexAttribPointer(A,S.components,s[Wb[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(s,u,g){for(let x=0;x<this.attributes.length;x++){const S=u.attributes[this.attributes[x].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(S,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ka{constructor(s,u,g,x,S){this.context=s,this.width=u,this.height=g;const A=this.framebuffer=s.gl.createFramebuffer();x&&(this.colorAttachment=new Cb(s,A)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new Pb(s,A):new wf(s,A))}destroy(){const s=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&s.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&s.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&s.deleteTexture(u)}s.deleteFramebuffer(this.framebuffer)}}class Hu{constructor(s,u){this.gl=s,this.clearColor=new HR(this),this.clearDepth=new vb(this),this.clearStencil=new _b(this),this.colorMask=new xb(this),this.depthMask=new bb(this),this.stencilMask=new r2(this),this.stencilFunc=new n2(this),this.stencilOp=new ZR(this),this.stencilTest=new Vm(this),this.depthRange=new Wm(this),this.depthTest=new i2(this),this.depthFunc=new hs(this),this.blend=new wb(this),this.blendFunc=new sv(this),this.blendColor=new lv(this),this.blendEquation=new Sb(this),this.cullFace=new Tb(this),this.cullFaceSide=new Eb(this),this.frontFace=new cv(this),this.program=new Ab(this),this.activeTexture=new Mb(this),this.viewport=new uv(this),this.bindFramebuffer=new o2(this),this.bindRenderbuffer=new a2(this),this.bindTexture=new bf(this),this.bindVertexBuffer=new XR(this),this.bindElementBuffer=new YR(this),this.bindVertexArrayOES=new KR(this),this.pixelStoreUnpack=new JR(this),this.pixelStoreUnpackPremultiplyAlpha=new QR(this),this.pixelStoreUnpackFlipY=new eD(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u,g){return new nc(this,s,u,g)}createVertexBuffer(s,u,g,x,S){return new Gb(this,s,u,g,x,S)}createRenderbuffer(s,u,g){const x=this.gl,S=x.createRenderbuffer();return this.bindRenderbuffer.set(S),x.renderbufferStorage(x.RENDERBUFFER,s,u,g),this.bindRenderbuffer.set(null),S}createFramebuffer(s,u,g,x){return new ka(this,s,u,g,x)}clear({color:s,depth:u,stencil:g,colorMask:x}){const S=this.gl;let A=0;s&&(A|=S.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(x||[!0,!0,!0,!0])),u!==void 0&&(A|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(A|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),S.clear(A)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){i.bn(s.blendFunction,Xr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Zm;function bv(y,s,u,g,x,S,A){const L=y.context,z=L.gl,B=y.transform,V=y.getOrCreateProgram("collisionBox"),X=[];let Y=0,re=0;for(let Te=0;Te<g.length;Te++){const Oe=g[Te],Me=s.getTile(Oe),Ce=Me.getBucket(u);if(!Ce)continue;const Pe=cb(Oe,Ce,B);let Ne=Pe;x[0]===0&&x[1]===0||(Ne=y.translatePosMatrix(Pe,Me,x,S));const Ue=A?Ce.textCollisionBox:Ce.iconCollisionBox,dt=Ce.collisionCircleArray;if(dt.length>0){const et=i.ad.mat4.create(),wt=Ne;i.ad.mat4.mul(et,Ce.placementInvProjMatrix,B.glCoordMatrix),i.ad.mat4.mul(et,et,Ce.placementViewportMatrix),X.push({circleArray:dt,circleOffset:re,transform:wt,invTransform:et,projection:Ce.getProjection()}),Y+=dt.length/4,re=Y}Ue&&(y.terrain&&y.terrain.setupElevationDraw(Me,V),V.draw(y,z.LINES,hr.disabled,Dr.disabled,y.colorModeForRenderPass(),Ir.disabled,f2(Ne,B,Me,Ce.getProjection()),u.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,null,B.zoom,null,[Ue.collisionVertexBuffer,Ue.collisionVertexBufferExt]))}if(!A||!X.length)return;const ce=y.getOrCreateProgram("collisionCircle"),ae=new i.cW;ae.resize(4*Y),ae._trim();let fe=0;for(const Te of X)for(let Oe=0;Oe<Te.circleArray.length/4;Oe++){const Me=4*Oe,Ce=Te.circleArray[Me+0],Pe=Te.circleArray[Me+1],Ne=Te.circleArray[Me+2],Ue=Te.circleArray[Me+3];ae.emplace(fe++,Ce,Pe,Ne,Ue,0),ae.emplace(fe++,Ce,Pe,Ne,Ue,1),ae.emplace(fe++,Ce,Pe,Ne,Ue,2),ae.emplace(fe++,Ce,Pe,Ne,Ue,3)}(!Zm||Zm.length<2*Y)&&(Zm=function(Te){const Oe=2*Te,Me=new i.aV;Me.resize(Oe),Me._trim();for(let Ce=0;Ce<Oe;Ce++){const Pe=6*Ce;Me.uint16[Pe+0]=4*Ce+0,Me.uint16[Pe+1]=4*Ce+1,Me.uint16[Pe+2]=4*Ce+2,Me.uint16[Pe+3]=4*Ce+2,Me.uint16[Pe+4]=4*Ce+3,Me.uint16[Pe+5]=4*Ce+0}return Me}(Y));const me=L.createIndexBuffer(Zm,!0),be=L.createVertexBuffer(ae,i.cX.members,!0);for(const Te of X){const Oe={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Ee=B).getCameraToCenterDistance(Te.projection),u_viewport_size:[Ee.width,Ee.height]};ce.draw(y,z.TRIANGLES,hr.disabled,Dr.disabled,y.colorModeForRenderPass(),Ir.disabled,Oe,u.id,be,me,i.b8.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,B.zoom)}var Ee;be.destroy(),me.destroy()}const Mf=i.ad.mat4.create();function wv(y){const s=y._camera.getWorldToCamera(y.worldSize,1),u=i.ad.mat4.multiply([],s,y.globeMatrix);i.ad.mat4.invert(u,u);const g=[0,0,0],x=[0,1,0,0];return i.ad.vec4.transformMat4(x,x,u),g[0]=x[0],g[1]=x[1],g[2]=x[2],i.ad.vec3.normalize(g,g),g}function v2({width:y,height:s,anchor:u,textOffset:g,textScale:x},S){const{horizontalAlign:A,verticalAlign:L}=i.bD(u),z=-(A-.5)*y,B=-(L-.5)*s,V=i.bC(u,g);return new i.P((z/x+V[0])*S,(B/x+V[1])*S)}function $s(y,s,u,g,x,S,A,L,z,B,V){const X=y.text.placedSymbolArray,Y=y.text.dynamicLayoutVertexArray,re=y.icon.dynamicLayoutVertexArray,ce={},ae=y.getProjection(),fe=ds(L,ae,S),me=S.elevation,be=ae.upVectorScale(L.canonical,S.center.lat,S.worldSize).metersToTile;Y.clear();for(let Ee=0;Ee<X.length;Ee++){const Te=X.get(Ee),{tileAnchorX:Oe,tileAnchorY:Me,numGlyphs:Ce}=Te,Pe=Te.hidden||!Te.crossTileID||y.allowVerticalPlacement&&!Te.placedOrientation?null:g[Te.crossTileID];if(Pe){let Ne=0,Ue=0,dt=0;if(me){const gt=me?me.getAtTileOffset(L,Oe,Me):0,[Et,ht,Mt]=ae.upVector(L.canonical,Oe,Me);Ne=gt*Et*be,Ue=gt*ht*be,dt=gt*Mt*be}let[et,wt,Tt,Dt]=bl(Te.projectedAnchorX+Ne,Te.projectedAnchorY+Ue,Te.projectedAnchorZ+dt,u?fe:A);const Qe=cf(S.getCameraToCenterDistance(ae),Dt);let bt=x.evaluateSizeForFeature(y.textSizeData,B,Te)*Qe/i.bw;u&&(bt*=y.tilePixelRatio/z);const Ye=v2(Pe,bt);u?({x:et,y:wt,z:Tt}=ae.projectTilePoint(Oe+Ye.x,Me+Ye.y,L.canonical),[et,wt,Tt]=bl(et+Ne,wt+Ue,Tt+dt,A)):(s&&Ye._rotate(-S.angle),et+=Ye.x,wt+=Ye.y,Tt=0);const xt=y.allowVerticalPlacement&&Te.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let gt=0;gt<Ce;gt++)i.bt(Y,et,wt,Tt,xt);V&&Te.associatedIconIndex>=0&&(ce[Te.associatedIconIndex]={x:et,y:wt,z:Tt,angle:xt})}else wl(Ce,Y)}if(V){re.clear();const Ee=y.icon.placedSymbolArray;for(let Te=0;Te<Ee.length;Te++){const Oe=Ee.get(Te),{numGlyphs:Me}=Oe,Ce=ce[Te];if(Oe.hidden||!Ce)wl(Me,re);else{const{x:Pe,y:Ne,z:Ue,angle:dt}=Ce;for(let et=0;et<Me;et++)i.bt(re,Pe,Ne,Ue,dt)}}y.icon.dynamicLayoutVertexBuffer.updateData(re)}y.text.dynamicLayoutVertexBuffer.updateData(Y)}function $n(y,s,u,g,x,S,A={}){const L=u.paint.get("icon-translate"),z=u.paint.get("text-translate"),B=u.paint.get("icon-translate-anchor"),V=u.paint.get("text-translate-anchor"),X=u.layout.get("icon-rotation-alignment"),Y=u.layout.get("text-rotation-alignment"),re=u.layout.get("icon-pitch-alignment"),ce=u.layout.get("text-pitch-alignment"),ae=u.layout.get("icon-keep-upright"),fe=u.layout.get("text-keep-upright"),me=u.paint.get("icon-color-saturation"),be=u.paint.get("icon-color-contrast"),Ee=u.paint.get("icon-color-brightness-min"),Te=u.paint.get("icon-color-brightness-max"),Oe=u.layout.get("symbol-elevation-reference")==="sea",Me=y.context,Ce=Me.gl,Pe=y.transform,Ne=X==="map",Ue=Y==="map",dt=re==="map",et=ce==="map",wt=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Tt=!1;const Dt=y.depthModeForSublayer(0,hr.ReadOnly),Qe=[i.av(Pe.center.lng),i.aC(Pe.center.lat)],bt=u.layout.get("text-variable-anchor"),Ye=Pe.projection.name==="globe",xt=[],gt=[0,-1,0];for(const Et of g){const ht=s.getTile(Et),Mt=ht.getBucket(u);if(!Mt||Mt.projection.name==="mercator"&&Ye||Mt.fullyClipped)continue;const Vt=Mt.projection.name==="globe",Wt=Vt?i.ag(Pe.zoom):0,Ht=ds(Et,Mt.getProjection(),Pe),ir=Pe.calculatePixelsToTileUnitsMatrix(ht),Or=bt&&Mt.hasTextData(),vr=Mt.hasIconTextFit()&&Or&&Mt.hasIconData(),Mr=Mt.getProjection().createInversionMatrix(Pe,Et.canonical),Tr=Mn=>{Pe.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||y.terrain)&&(Mn.push("DEPTH_D24"),Mn.push("DEPTH_OCCLUSION"))},tn=()=>{const Mn=Ne&&u.layout.get("symbol-placement")!=="point",cn=[];Tr(cn);const Ti=Mn||vr,Hi=u.paint.get("icon-image-cross-fade").constantOr(0);y.terrainRenderModeElevated()&&dt&&cn.push("PITCH_WITH_MAP_TERRAIN"),Vt&&(cn.push("PROJECTION_GLOBE_VIEW"),Ti&&cn.push("PROJECTED_POS_ON_VIEWPORT")),Hi>0&&cn.push("ICON_TRANSITION"),Mt.icon.zOffsetVertexBuffer&&cn.push("Z_OFFSET"),me===0&&be===0&&Ee===0&&Te===1||cn.push("COLOR_ADJUSTMENT"),Mt.sdfIcons&&cn.push("RENDER_SDF");const ho=Mt.icon.programConfigurations.get(u.id),_o=y.getOrCreateProgram("symbol",{config:ho,defines:cn}),gs=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],la=Mt.iconSizeData,sn=i.bp(la,Pe.zoom),ci=dt||Pe.pitch!==0,vn=Lc(Ht,ht.tileID.canonical,dt,Ne,Pe,Mt.getProjection(),ir),Nn=zi(Ht,ht.tileID.canonical,dt,Ne,Pe,Mt.getProjection(),ir),Uo=y.translatePosMatrix(Nn,ht,L,B,!0),ti=y.translatePosMatrix(Ht,ht,L,B),fo=Ti?Mf:vn,ac=Ne&&!dt&&!Mn;let Ha=gt;!Ye&&!Pe.mercatorFromTransition||Ne||(Ha=wv(Pe));const Ws=Vt?Ha:gt,Ra=u.getColorAdjustmentMatrix(me,be,Ee,Te),Gs=_v(la.kind,sn,ac,dt,y,ti,fo,Uo,Oe,!1,gs,[0,0],!0,Et,Wt,Qe,Mr,Ws,Mt.getProjection(),Ra,Hi),Za=ht.imageAtlasTexture?ht.imageAtlasTexture:null,Zc=u.layout.get("icon-size").constantOr(0)!==1||Mt.iconsNeedLinear,sc=Mt.sdfIcons||y.options.rotating||y.options.zooming||Zc||ci?Ce.LINEAR:Ce.NEAREST,Xc=Mt.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,y1=y.terrain&&dt&&Mn?i.ad.mat4.invert(i.ad.mat4.create(),vn):Mf;if(Mn&&Mt.icon){const $f=Pe.elevation,Bv=$f?$f.getAtTileOffsetFunc(Et,Pe.center.lat,Pe.worldSize,Mt.getProjection()):null,v1=Zo(Ht,ht.tileID.canonical,dt,Ne,Pe,Mt.getProjection(),ir);uf(Mt,Ht,y,!1,v1,Nn,dt,ae,Bv,Et)}return{program:_o,buffers:Mt.icon,uniformValues:Gs,atlasTexture:Za,atlasTextureIcon:null,atlasInterpolation:sc,atlasInterpolationIcon:null,isSDF:Mt.sdfIcons,hasHalo:Xc,tile:ht,labelPlaneMatrixInv:y1}},yn=()=>{const Mn=Ue&&u.layout.get("symbol-placement")!=="point",cn=[],Ti=Mn||bt||vr;y.terrainRenderModeElevated()&&et&&cn.push("PITCH_WITH_MAP_TERRAIN"),Vt&&(cn.push("PROJECTION_GLOBE_VIEW"),Ti&&cn.push("PROJECTED_POS_ON_VIEWPORT")),Mt.text.zOffsetVertexBuffer&&cn.push("Z_OFFSET"),Mt.iconsInText&&cn.push("RENDER_TEXT_AND_SYMBOL"),cn.push("RENDER_SDF"),Tr(cn);const Hi=Mt.text.programConfigurations.get(u.id),ho=y.getOrCreateProgram("symbol",{config:Hi,defines:cn});let _o,gs=[0,0],la=null;const sn=Mt.textSizeData;Mt.iconsInText&&(gs=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],la=ht.imageAtlasTexture?ht.imageAtlasTexture:null,_o=et||Pe.pitch!==0||y.options.rotating||y.options.zooming||sn.kind==="composite"||sn.kind==="camera"?Ce.LINEAR:Ce.NEAREST);const ci=ht.glyphAtlasTexture?ht.glyphAtlasTexture.size:[0,0],vn=u.layout.get("text-size-scale-range"),Nn=i.ay(y.scaleFactor,vn[0],vn[1]),Uo=i.bp(sn,Pe.zoom,Nn),ti=Lc(Ht,ht.tileID.canonical,et,Ue,Pe,Mt.getProjection(),ir),fo=zi(Ht,ht.tileID.canonical,et,Ue,Pe,Mt.getProjection(),ir),ac=y.translatePosMatrix(fo,ht,z,V,!0),Ha=y.translatePosMatrix(Ht,ht,z,V),Ws=Ti?Mf:ti,Ra=Ue&&!et&&!Mn;let Gs=gt;!Ye&&!Pe.mercatorFromTransition||Ue||(Gs=wv(Pe));const Za=_v(sn.kind,Uo,Ra,et,y,Ha,Ws,ac,Oe,!0,ci,gs,!0,Et,Wt,Qe,Mr,Vt?Gs:gt,Mt.getProjection(),null,null,Nn),Zc=ht.glyphAtlasTexture?ht.glyphAtlasTexture:null,sc=Ce.LINEAR,Xc=u.paint.get("text-halo-width").constantOr(1)!==0,y1=y.terrain&&et&&Mn?i.ad.mat4.invert(i.ad.mat4.create(),ti):Mf;if(Mn&&Mt.text){const $f=Pe.elevation,Bv=$f?$f.getAtTileOffsetFunc(Et,Pe.center.lat,Pe.worldSize,Mt.getProjection()):null,v1=Zo(Ht,ht.tileID.canonical,et,Ue,Pe,Mt.getProjection(),ir);uf(Mt,Ht,y,!0,v1,fo,et,fe,Bv,Et)}return{program:ho,buffers:Mt.text,uniformValues:Za,atlasTexture:Zc,atlasTextureIcon:la,atlasInterpolation:sc,atlasInterpolationIcon:_o,isSDF:!0,hasHalo:Xc,tile:ht,labelPlaneMatrixInv:y1}},Wn=Mt.icon.segments.get().length,Hr=Mt.text.segments.get().length,li=Wn&&!A.onlyText?tn():null,Lr=Hr&&!A.onlyIcons?yn():null,or=u.paint.get("icon-opacity").constantOr(1),on=u.paint.get("text-opacity").constantOr(1);if(wt&&Mt.canOverlap){Tt=!0;const Mn=or&&!A.onlyText?Mt.icon.segments.get():[],cn=on&&!A.onlyIcons?Mt.text.segments.get():[];for(const Ti of Mn)xt.push({segments:new i.b8([Ti]),sortKey:Ti.sortKey,state:li});for(const Ti of cn)xt.push({segments:new i.b8([Ti]),sortKey:Ti.sortKey,state:Lr})}else A.onlyText||xt.push({segments:or?Mt.icon.segments:new i.b8([]),sortKey:0,state:li}),A.onlyIcons||xt.push({segments:on?Mt.text.segments:new i.b8([]),sortKey:0,state:Lr})}Tt&&xt.sort((Et,ht)=>Et.sortKey-ht.sortKey);for(const Et of xt){const ht=Et.state;if(ht)if(y.terrain?y.terrain.setupElevationDraw(ht.tile,ht.program,{useDepthForOcclusion:Pe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ht.labelPlaneMatrixInv}):y.setupDepthForOcclusion(Pe.depthOcclusionForSymbolsAndCircles,ht.program),Me.activeTexture.set(Ce.TEXTURE0),ht.atlasTexture&&ht.atlasTexture.bind(ht.atlasInterpolation,Ce.CLAMP_TO_EDGE,!0),ht.atlasTextureIcon&&(Me.activeTexture.set(Ce.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,Ce.CLAMP_TO_EDGE,!0)),y.uploadCommonLightUniforms(y.context,ht.program),ht.hasHalo){const Mt=ht.uniformValues;Mt.u_is_halo=1,Cf(ht.buffers,Et.segments,u,y,ht.program,Dt,x,S,Mt,2),Mt.u_is_halo=0}else{if(ht.isSDF){const Mt=ht.uniformValues;ht.hasHalo&&(Mt.u_is_halo=1,Cf(ht.buffers,Et.segments,u,y,ht.program,Dt,x,S,Mt,1)),Mt.u_is_halo=0}Cf(ht.buffers,Et.segments,u,y,ht.program,Dt,x,S,ht.uniformValues,1)}}}function Cf(y,s,u,g,x,S,A,L,z,B){const V=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.iconTransitioningVertexBuffer,y.globeExtVertexBuffer,y.zOffsetVertexBuffer];x.draw(g,g.context.gl.TRIANGLES,S,A,L,Ir.disabled,z,u.id,y.layoutVertexBuffer,y.indexBuffer,s,u.paint,g.transform.zoom,y.programConfigurations.get(u.id),V,B)}function qb(y,s){const u=1<<y.canonical.z,g=(s.x*u-y.canonical.x-y.wrap*u)*i.ai,x=(s.y*u-y.canonical.y)*i.ai,S=i.d5(s.z,s.y);return i.ad.vec3.fromValues(g,x,S)}function Hb(y,s,u,g,x){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const S=y.context.gl,A=new hr(y.context.gl.LEQUAL,hr.ReadWrite,y.depthRangeFor3D),L=new hr(y.context.gl.GREATER,hr.ReadWrite,y.depthRangeFor3D),z=function(re){const ce=i.c4(re.pitch);let ae=.01;return re.isOrthographic&&(ae=i.ah(1e-4,ae,i.c9(ce>=Bt?1:ce/Bt))),2*ae}(y.transform),B=y.transform.getFreeCameraOptions().position,V="elevatedStructuresDepthReconstruct",X=y.getOrCreateProgram(V,{defines:["DEPTH_RECONSTRUCTION"]}),Y=y.getOrCreateProgram(V);for(const re of g){const ce=s.getTile(re),ae=ce.getBucket(u);if(!ae)continue;const fe=ae.elevatedStructures;if(!fe)continue;const me=ae.elevationBufferData.heightRange,be=qb(re.toUnwrapped(),B),Ee=y.translatePosMatrix(re.projMatrix,ce,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let Te,Oe,Me,Ce;if(x==="initialize"){if(!me||me.min>=1||fe.depthSegments.segments[0].primitiveLength===0)continue;Te=Hm(Ee,be,z,1,0),Oe=A,Me=fe.depthSegments,Ce=X}else if(x==="reset"){if(!me||me.min>=0||fe.maskSegments.segments[0].primitiveLength===0)continue;Te=Hm(Ee,be,0,0,1),Oe=L,Me=fe.maskSegments,Ce=X}else if(x==="geometry"){if(fe.depthSegments.segments[0].primitiveLength===0)continue;Te=Hm(Ee,be,z,1,0),Oe=A,Me=fe.depthSegments,Ce=Y}Ce.draw(y,S.TRIANGLES,Oe,Dr.disabled,Xr.disabled,Ir.disabled,Te,u.id,fe.vertexBuffer,fe.indexBuffer,Me,u.paint,y.transform.zoom)}}function Sv(y,s,u){const{painter:g,sourceCache:x,layer:S,coords:A,colorMode:L,elevationType:z,terrainEnabled:B,pass:V}=y,X=g.context.gl,Y=S.paint.get("fill-pattern");let re=z;z!=="road"||s&&!B||(re="none");const ce=re==="road",ae=new hr(g.context.gl.LEQUAL,hr.ReadWrite,g.depthRangeFor3D),fe=Y&&Y.constantOr(1),me=(be,Ee)=>{let Te,Oe,Me,Ce,Pe;Ee?(Oe=fe&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Te=X.LINES):(Oe=fe?"fillPattern":"fill",Te=X.TRIANGLES);for(const Ne of A){const Ue=x.getTile(Ne);if(fe&&!Ue.patternsLoaded())continue;const dt=Ue.getBucket(S);if(!dt)continue;const et=s?dt.elevationBufferData:dt.bufferData;if(et.isEmpty())continue;g.prepareDrawTile();const wt=et.programConfigurations.get(S.id),Tt=g.isTileAffectedByFog(Ne),Dt=[],Qe=[];ce&&(Dt.push("ELEVATED_ROADS"),Qe.push(et.elevatedLayoutVertexBuffer));const bt=g.getOrCreateProgram(Oe,{config:wt,overrideFog:Tt,defines:Dt});fe&&(g.context.activeTexture.set(X.TEXTURE0),Ue.imageAtlasTexture&&Ue.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),wt.updatePaintBuffers());const Ye=Y.constantOr(null);if(Ye&&Ue.imageAtlas){const Et=Ue.imageAtlas,ht=i.d0.from(Ye).getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Mt=Et.patternPositions.get(ht);Mt&&wt.setConstantPatternPositions(Mt)}const xt=g.translatePosMatrix(Ne.projMatrix,Ue,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor")),gt=S.paint.get("fill-emissive-strength");if(Ee){Ce=et.lineIndexBuffer,Pe=et.lineSegments;const Et=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[X.drawingBufferWidth,X.drawingBufferHeight];Me=Oe==="fillOutlinePattern"&&fe?yv(xt,gt,g,Ue,Et):gv(xt,gt,Et)}else Ce=et.indexBuffer,Pe=et.triangleSegments,Me=fe?zb(xt,gt,g,Ue):Ef(xt,gt);g.uploadCommonUniforms(g.context,bt,Ne.toUnwrapped()),bt.draw(g,Te,re!=="none"?ae:be,u||g.stencilModeForClipping(Ne),L,Ir.disabled,Me,S.id,et.layoutVertexBuffer,Ce,Pe,S.paint,g.transform.zoom,wt,Qe)}};g.renderPass===V&&me(g.depthModeForSublayer(1,g.renderPass==="opaque"?hr.ReadWrite:hr.ReadOnly),!1),re==="none"&&g.renderPass==="translucent"&&S.paint.get("fill-antialias")&&me(g.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,hr.ReadOnly),!0)}function Xm(y,s,u,g,x,S,A,L){u.resetLayerRenderingStats(y);const z=y.context,B=z.gl,V=y.transform,X=u.paint.get("fill-extrusion-pattern"),Y=X.constantOr(1),re=u.paint.get("fill-extrusion-opacity"),ce=y.style.enable3dLights(),ae=u.paint.get(ce&&!Y?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),fe=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ae],me=u.layout.get("fill-extrusion-edge-radius"),be=me>0&&!u.paint.get("fill-extrusion-rounded-roof"),Ee=be?0:me,Te=V.projection.name==="globe"?i.d6():0,Oe=V.projection.name==="globe",Me=Oe?i.ag(V.zoom):0,Ce=[i.av(V.center.lng),i.aC(V.center.lat)],Pe=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ne=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(Pe?null:u.lut).toArray01().slice(0,3),Ue=u.paint.get("fill-extrusion-flood-light-intensity"),dt=u.paint.get("fill-extrusion-vertical-scale"),et=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,wt=u.paint.get("fill-extrusion-height-alignment"),Tt=u.paint.get("fill-extrusion-base-alignment"),Dt=Bc(y,u.paint.get("fill-extrusion-cutoff-fade-range")),Qe=[];let bt;Oe&&Qe.push("PROJECTION_GLOBE_VIEW"),fe[0]>0&&Qe.push("FAUX_AO"),be&&Qe.push("ZERO_ROOF_RADIUS"),L&&Qe.push("HAS_CENTROID"),Ue>0&&Qe.push("FLOOD_LIGHT"),Dt.shouldRenderCutoff&&Qe.push("RENDER_CUTOFF"),et&&Qe.push("RENDER_WALL_MODE");const Ye=y.renderPass==="shadow",xt=y.shadowRenderer,gt=Ye&&!!xt;y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!0);let Et=[0,0,0];if(xt){const Vt=y.style.directionalLight,Wt=y.style.ambientLight;Vt&&Wt&&(Et=gf(y.style,Vt,Wt)),Ye||(Qe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),xt.useNormalOffset&&Qe.push("NORMAL_OFFSET")),bt=Qe.concat(["SHADOWS_SINGLE_CASCADE"])}const ht=gt?"fillExtrusionDepth":Y?"fillExtrusionPattern":"fillExtrusion",Mt=u.getLayerRenderingStats();for(const Vt of g){const Wt=s.getTile(Vt),Ht=Wt.getBucket(u);if(!Ht||Ht.projection.name!==V.projection.name)continue;let ir=!1;xt&&(ir=xt.getMaxCascadeForTile(Vt.toUnwrapped())===0);const Or=y.isTileAffectedByFog(Vt),vr=Ht.programConfigurations.get(u.id),Mr=y.getOrCreateProgram(ht,{config:vr,defines:ir?bt:Qe,overrideFog:Or});if(y.terrain&&y.terrain.setupElevationDraw(Wt,Mr,{useMeterToDem:!0}),!Ht.centroidVertexBuffer){const Lr=Mr.attributes.a_centroid_pos;Lr!==void 0&&B.vertexAttrib2f(Lr,0,0)}!Ye&&xt&&xt.setupShadows(Wt.tileID.toUnwrapped(),Mr,"vector-tile",Wt.tileID.overscaledZ),Y&&(y.context.activeTexture.set(B.TEXTURE0),Wt.imageAtlasTexture&&Wt.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),vr.updatePaintBuffers());const Tr=X.constantOr(null);if(Tr&&Wt.imageAtlas){const Lr=Wt.imageAtlas,or=i.d0.from(Tr).getPrimary().scaleSelf(i.q.devicePixelRatio),on=Lr.patternPositions.get(or.toString());on&&vr.setConstantPatternPositions(on)}const tn=u.paint.get("fill-extrusion-vertical-gradient"),yn=1/Ht.tileToMeter;let Wn;if(Ye&&xt){if(kf(Wt.tileID,Ht,y))continue;const Lr=xt.calculateShadowPassMatrixFromTile(Wt.tileID.toUnwrapped());Wn=Tf(Lr,Ee,yn,dt,wt,Tt)}else{const Lr=y.translatePosMatrix(Vt.expandedProjMatrix,Wt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),or=V.projection.createInversionMatrix(V,Vt.canonical);Wn=Y?Nb(Lr,y,tn,re,fe,Ee,yn,Vt,Wt,Te,wt,Tt,Me,Ce,or,Ne,dt):mv(Lr,y,tn,re,fe,Ee,yn,Vt,Te,wt,Tt,Me,Ce,or,Ne,dt,Ue,Et)}y.uploadCommonUniforms(z,Mr,Vt.toUnwrapped(),null,Dt);let Hr=Ht.segments;if(V.projection.name==="mercator"&&!Ye&&(Hr=Ht.getVisibleSegments(Wt.tileID,y.terrain,y.transform.getFrustum(0)),!Hr.get().length))continue;if(Mt)if(Ye)for(const Lr of Hr.get())Mt.numRenderedVerticesInShadowPass+=Lr.primitiveLength;else for(const Lr of Hr.get())Mt.numRenderedVerticesInTransparentPass+=Lr.primitiveLength;const li=[];(y.terrain||L)&&li.push(Ht.centroidVertexBuffer),Oe&&li.push(Ht.layoutVertexExtBuffer),et&&li.push(Ht.wallVertexBuffer),Mr.draw(y,z.gl.TRIANGLES,x,S,A,Ir.backCCW,Wn,u.id,Ht.layoutVertexBuffer,Ht.indexBuffer,Hr,u.paint,y.transform.zoom,vr,li)}y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!1)}function Pf(y,s,u,g,x,S,A,L,z,B,V,X,Y,re,ce,ae,fe,me,be){const Ee=y.context,Te=Ee.gl,Oe=y.transform,Me=y.transform.zoom,Ce=[],Pe=Bc(y,u.paint.get("fill-extrusion-cutoff-fade-range"));B==="clear"?(Ce.push("CLEAR_SUBPASS"),be&&(Ce.push("CLEAR_FROM_TEXTURE"),Ee.activeTexture.set(Te.TEXTURE0),be.bind(Te.LINEAR,Te.CLAMP_TO_EDGE))):B==="sdf"&&Ce.push("SDF_SUBPASS"),fe&&Ce.push("HAS_CENTROID"),Pe.shouldRenderCutoff&&Ce.push("RENDER_CUTOFF");const Ne=u.layout.get("fill-extrusion-edge-radius"),Ue=(dt,et,wt,Tt,Dt)=>{const Qe=et.programConfigurations.get(u.id),bt=y.isTileAffectedByFog(dt),Ye=y.getOrCreateProgram("fillExtrusionGroundEffect",{config:Qe,defines:Ce,overrideFog:bt}),xt=((Et,ht,Mt,Vt,Wt,Ht,ir,Or,vr,Mr,Tr)=>({u_matrix:ht,u_opacity:Mt,u_ao_pass:Vt?1:0,u_meter_to_tile:Wt,u_ao:Ht,u_flood_light_intensity:ir,u_flood_light_color:Or,u_attenuation:vr,u_edge_radius:Mr,u_fb:0,u_fb_size:Tr,u_dynamic_offset:1}))(0,Tt,V,z,Dt,[X,Y*Dt],re,ce,ae,Me>=17?0:Ne*Dt,be?be.size[0]:0),gt=[];fe&&gt.push(et.hiddenByLandmarkVertexBuffer),y.uploadCommonUniforms(Ee,Ye,dt.toUnwrapped(),null,Pe),Ye.draw(y,Ee.gl.TRIANGLES,x,S,A,L,xt,u.id,et.vertexBuffer,et.indexBuffer,wt,u.paint,Me,Qe,gt)};for(const dt of g){const et=s.getTile(dt),wt=et.getBucket(u);if(!wt||wt.projection.name!==Oe.projection.name||!wt.groundEffect||wt.groundEffect&&!wt.groundEffect.hasData())continue;const Tt=wt.groundEffect,Dt=1/wt.tileToMeter;{const Qe=y.translatePosMatrix(dt.projMatrix,et,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),bt=Tt.getDefaultSegment();Ue(dt,Tt,bt,Qe,Dt)}if(me)for(let Qe=0;Qe<4;Qe++){const bt=i.d7[Qe](dt),Ye=s.getTile(bt);if(!Ye)continue;const xt=Ye.getBucket(u);if(!xt||xt.projection.name!==Oe.projection.name||!xt.groundEffect||xt.groundEffect&&!xt.groundEffect.hasData())continue;const gt=xt.groundEffect;let Et,ht;Qe===0?(Et=[-i.ai,0,0],ht=1):Qe===1?(Et=[i.ai,0,0],ht=0):Qe===2?(Et=[0,-i.ai,0],ht=3):(Et=[0,i.ai,0],ht=2);const Mt=gt.regionSegments[ht];if(!Mt)continue;const Vt=new Float32Array(16);i.ad.mat4.translate(Vt,dt.projMatrix,Et),Ue(dt,gt,Mt,y.translatePosMatrix(Vt,et,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Dt)}}}function If(y,s,u,g,x,S,A){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const L=S?S.findDEMTileFor(u):null;if(!(L&&L.dem||A))return;S&&L&&L.dem&&g.selfDEMTileTimestamp!==L.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=L.dem._timestamp);const z=me=>new i.P(Math.ceil((me+i.da)*i.db),0),B=me=>{const be=s.getSource().minzoom,Ee=Oe=>{const Me=s.getTileByID(Oe);if(Me&&Me.hasData())return Me.getBucket(x)},Te=[0,-1,1];for(const Oe of Te){if(me.overscaledZ+Oe<be)continue;const Me=Ee(me.calculateScaledKey(me.overscaledZ+Oe));if(Me)return Me}},V=[0,0,0],X=(me,be)=>(V[0]=Math.min(me.min.y,be.min.y),V[1]=Math.max(me.max.y,be.max.y),V[2]=i.ai-be.min.x>me.max.x?be.min.x-i.ai:me.max.x,V),Y=(me,be)=>(V[0]=Math.min(me.min.x,be.min.x),V[1]=Math.max(me.max.x,be.max.x),V[2]=i.ai-be.min.y>me.max.y?be.min.y-i.ai:me.max.y,V),re=[(me,be)=>X(me,be),(me,be)=>X(be,me),(me,be)=>Y(me,be),(me,be)=>Y(be,me)],ce=(me,be,Ee,Te,Oe,Me,Ce)=>{if(!S)return 0;const Pe=[[Me?Ee:me,Me?me:Ee,0],[Me?Ee:be,Me?be:Ee,0]],Ne=Ce<0?i.ai+Ce:Ce,Ue=[Me?Ne:(me+be)/2,Me?(me+be)/2:Ne,0];return Ee===0&&Ce<0||Ee!==0&&Ce>0?S.getForTilePoints(Oe,[Ue],!0,Te):Pe.push(Ue),S.getForTilePoints(u,Pe,!0,L),Math.max(Pe[0][2],Pe[1][2],Ue[2])/S.exaggeration()};for(let me=0;me<4;me++){const be=g.borderFeatureIndices[me];if(be.length===0)continue;const Ee=i.d7[me](u),Te=B(Ee);if(!(Te&&Te instanceof i.d8))continue;const Oe=S?S.findDEMTileFor(Ee):null;if(!(Oe&&Oe.dem||A)||(S&&Oe&&Oe.dem&&g.borderDEMTileTimestamp[me]!==Oe.dem._timestamp&&(g.borderDoneWithNeighborZ[me]=-1,g.borderDEMTileTimestamp[me]=Oe.dem._timestamp),g.borderDoneWithNeighborZ[me]===Te.canonical.z))continue;Te.centroidVertexArray.length===0&&Te.createCentroidsBuffer();const Me=(me<2?1:5)-me,Ce=Te.borderDoneWithNeighborZ[Me]!==g.canonical.z,Pe=Te.borderFeatureIndices[Me];let Ne=0;if(g.canonical.z!==Te.canonical.z){for(const Ue of be)g.showCentroid(g.featuresOnBorder[Ue]);if(Ce)for(const Ue of Pe)Te.showCentroid(Te.featuresOnBorder[Ue]);g.borderDoneWithNeighborZ[me]=Te.canonical.z,Te.borderDoneWithNeighborZ[Me]=g.canonical.z}for(const Ue of be){const dt=g.featuresOnBorder[Ue],et=g.centroidData[dt.centroidDataIndex],wt=dt.borders[me];let Tt;for(;Ne<Pe.length;){Tt=Te.featuresOnBorder[Pe[Ne]];const Dt=Tt.borders[Me];if(Dt[1]>wt[0]+3||Dt[0]>wt[0]-3)break;Te.showCentroid(Tt),Ne++}if(Tt&&Ne<Pe.length){const Dt=Ne;let Qe=0;for(;!(Tt.borders[Me][0]>wt[1]-3)&&(Qe++,++Ne!==Pe.length);)Tt=Te.featuresOnBorder[Pe[Ne]];Tt=Te.featuresOnBorder[Pe[Dt]];let bt=!1;if(Qe>=1){const gt=Tt.borders[Me];Math.abs(wt[0]-gt[0])<3&&Math.abs(wt[1]-gt[1])<3&&(Qe=1,bt=!0,Ne=Dt+1)}else if(Qe===0){g.showCentroid(dt);continue}const Ye=Te.centroidData[Tt.centroidDataIndex];A&&bt&&(((ae=et).flags|(fe=Ye).flags)&i.d9?(ae.flags|=i.d9,fe.flags|=i.d9):(ae.flags&=~i.d9,fe.flags&=~i.d9));const xt=dt.intersectsCount()>1||Tt.intersectsCount()>1;if(Qe>1)Ne=Dt,et.centroidXY=Ye.centroidXY=new i.P(0,0);else if(Oe&&Oe.dem&&!xt){const gt=re[me](et,Ye),Et=me%2?i.ai-1:0,ht=ce(gt[0],Math.min(i.ai-1,gt[1]),Et,Oe,Ee,me<2,gt[2]);et.centroidXY=Ye.centroidXY=z(ht)}else xt?et.centroidXY=Ye.centroidXY=new i.P(0,0):(et.centroidXY=g.encodeBorderCentroid(dt),Ye.centroidXY=Te.encodeBorderCentroid(Tt));g.writeCentroidToBuffer(et),Te.writeCentroidToBuffer(Ye)}else g.showCentroid(dt)}g.borderDoneWithNeighborZ[me]=Te.canonical.z,Te.borderDoneWithNeighborZ[Me]=g.canonical.z}var ae,fe;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(y)}const Of=[1,0,0],zt=[0,1,0],Yt=[0,0,1];function kf(y,s,u){const g=u.transform,x=u.shadowRenderer;if(!x)return!0;const S=y.toUnwrapped(),A=g.tileSize*x._cascades[u.currentShadowCascade].scale;let L=s.maxHeight;if(g.elevation){const ae=g.elevation.getMinMaxForTile(y);ae&&(L+=ae.max)}const z=[...x.shadowDirection];z[2]=-z[2];const B=x.computeSimplifiedTileShadowVolume(S,L,A,z);if(!B)return!1;const V=[Of,zt,Yt,z,[z[0],0,z[2]],[0,z[1],z[2]]],X=g.projection.name==="globe",Y=g.scaleZoom(A),re=i.bR.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,Y,!X),ce=x.getCurrentCascadeFrustum();return re.intersectsPrecise(B.vertices,B.planes,V)===0||ce.intersectsPrecise(B.vertices,B.planes,V)===0}function bi(y){return[y[0]*i.dc,y[1]*i.dc,y[2]*i.dc,0]}function it(y,s,u,g,x,S,A,L,z){const B=g.getSource(),V=u.globeSharedBuffers;if(!V)return;let X,Y,re;if(s&&(X=g.getTile(s)),B instanceof i.aK?(Y=B.texture,re=i.cJ(0,0,u.transform)):X&&s&&(Y=X.texture,re=i.cJ(s.canonical.z,s.canonical.x,u.transform)),!Y||!re)return;y||(re=i.ad.mat4.scale(i.ad.mat4.create(),re,[1,-1,1]));const ce=u.context,ae=ce.gl,fe=x.paint.get("raster-resampling")==="nearest"?ae.NEAREST:ae.LINEAR,me=u.colorModeForDrapableLayerRenderPass(S),be=A.defines;be.push("GLOBE_POLES");const Ee=new hr(ae.LEQUAL,hr.ReadWrite,u.depthRangeFor3D),Te=Float32Array.from(u.transform.expandedFarZProjMatrix),Oe=Float32Array.from(i.bc(i.cI(new i.bT(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),ce.activeTexture.set(ae.TEXTURE0),Y.bind(fe,ae.CLAMP_TO_EDGE),ce.activeTexture.set(ae.TEXTURE1),Y.bind(fe,ae.CLAMP_TO_EDGE),"useMipmap"in Y&&ce.extTextureFilterAnisotropic&&u.transform.pitch>20&&ae.texParameterf(ae.TEXTURE_2D,ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ce.extTextureFilterAnisotropicMax);const[Me,Ce,Pe,Ne]=s?V.getPoleBuffers(s.canonical.z,!1):V.getPoleBuffers(0,!0),Ue=x.paint.get("raster-elevation");let dt;y?(dt=Me,u.renderDefaultNorthPole=Ue!==0):(dt=Ce,u.renderDefaultSouthPole=Ue!==0);const et=bi(A.mix),wt=((Dt,Qe,bt,Ye,xt,gt,Et,ht,Mt,Vt,Wt,Ht,ir)=>Fb(Dt,Qe,bt,new Float32Array(16),new Float32Array(9),[0,0],Ye,[0,0],[0,0,0,0],1,{opacity:1,mix:0},gt,[0,0],ht,2,Vt,Wt,Ht,1,0,ir))(Te,Oe,re,i.ag(u.transform.zoom),0,x,0,Ue,0,et,A.offset,A.range,S),Tt=u.getOrCreateProgram("raster",{defines:be});u.uploadCommonUniforms(ce,Tt,null),Tt.draw(u,ae.TRIANGLES,Ee,z,me,L,wt,x.id,dt,Pe,Ne)}function _2(y){const s=y._nearZ,u=y.projection.farthestPixelDistance(y),g=u-s,x=.2*y.height,S=s+x;return[s,u,(S-x-s)/g,(S-s)/g]}function Tv(y,s,u,g){if(y)return s instanceof Rc&&y instanceof Oa?s.getTextureDescriptor(y,u,!0):{texture:y.texture,mix:bi(g.mix),offset:g.offset,buffer:0,tileSize:1}}var Zb=i.dd([{name:"a_index",type:"Int16",components:1}]);class Xb{constructor(s,u,g,x){const S={width:g[0],height:g[1],data:null},A=s.gl;this.targetColorTexture=new i.T(s,S,A.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(s,S,A.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(u,x),this.lastInvalidatedAt=0}updateParticleTexture(s,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,x=u.width*u.height;this.particleTexture0=new i.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1});const S=new i.de;S.reserve(x);for(let A=0;A<x;A++)S.emplaceBack(A);this.particleIndexBuffer=this.context.createVertexBuffer(S,Zb.members,!0),this.particleSegment=i.b8.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function x2(y,s,u){if(!y)return null;const g=s.getTextureDescriptor(y,u,!0);if(!g)return null;let{texture:x,mix:S,offset:A,tileSize:L,buffer:z,format:B}=g;if(!x||!B)return null;let V=!1;return B==="uint32"&&(V=!0,S[3]=0,S=Jt(i.df,S,[0,u.paint.get("raster-particle-max-speed")]),A=jb(i.df,A,[0,u.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[z/(L+2*z),L/(L+2*z)],tileSize:L,scalarData:V,scale:S,offset:A,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[B]]}}function b2(y){const s=y._nearZ,u=y.projection.farthestPixelDistance(y),g=u-s,x=.2*y.height,S=s+x;return[s,u,(S-x-s)/g,(S-s)/g]}const Rf=new i.al(1,0,0,1),nD=new i.al(0,1,0,1),iD=new i.al(0,0,1,1),w2=new i.al(1,0,1,1),Ev=new i.al(0,1,1,1);function Zu(y,s,u,g,x,S,A){const L=y.context,z=y.transform,B=L.gl,V=z.projection.name==="globe",X=V?["PROJECTION_GLOBE_VIEW"]:[];let Y=i.ad.mat4.clone(u.projMatrix);if(V&&i.ag(z.zoom)>0){const et=i.bb(u.canonical,z),wt=i.dg(et);Y=i.ad.mat4.multiply(new Float32Array(16),z.globeMatrix,wt),i.ad.mat4.multiply(Y,z.projMatrix,Y)}const re=i.ad.mat4.create();re[12]+=2*x/(i.q.devicePixelRatio*z.width),re[13]+=2*S/(i.q.devicePixelRatio*z.height),i.ad.mat4.multiply(Y,re,Y);const ce=y.getOrCreateProgram("debug",{defines:X}),ae=s.getTileByID(u.key);y.terrain&&y.terrain.setupElevationDraw(ae,ce);const fe=hr.disabled,me=Dr.disabled,be=y.colorModeForRenderPass(),Ee="$debug";L.activeTexture.set(B.TEXTURE0),y.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),V?ae._makeGlobeTileDebugBuffers(y.context,z):ae._makeDebugTileBoundsBuffers(y.context,z.projection);const Te=ae._tileDebugBuffer||y.debugBuffer,Oe=ae._tileDebugIndexBuffer||y.debugIndexBuffer,Me=ae._tileDebugSegments||y.debugSegments;if(ce.draw(y,B.LINE_STRIP,fe,me,be,Ir.disabled,p2(Y,g),Ee,Te,Oe,Me,null,null,null,[ae._globeTileDebugBorderBuffer]),A){const et=ae.latestRawTileData,wt=Math.floor((et&&et.byteLength||0)/1024);let Tt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Tt+=` => ${u.overscaledZ}`),Tt+=` ${ae.state}`,Tt+=` ${wt}kb`,function(Dt,Qe){Dt.initDebugOverlayCanvas();const bt=Dt.debugOverlayCanvas,Ye=Dt.context.gl,xt=Dt.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,bt.width,bt.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(Qe,5,5),xt.strokeText(Qe,5,5),Dt.debugOverlayTexture.update(bt),Dt.debugOverlayTexture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE)}(y,Tt)}const Ce=s.getTile(u).tileSize,Pe=512/Math.min(Ce,512)*(u.overscaledZ/z.zoom)*.5,Ne=ae._tileDebugTextBuffer||y.debugBuffer,Ue=ae._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,dt=ae._tileDebugTextSegments||y.debugSegments;ce.draw(y,B.TRIANGLES,fe,me,Xr.alphaBlended,Ir.disabled,p2(Y,i.al.transparent,Pe),Ee,Ne,Ue,dt,null,null,null,[ae._globeTileDebugTextBuffer])}function Yb(y,s,u,g){Kd(y,0,s+u/2,y.transform.width,u,g)}function Kb(y,s,u,g){Kd(y,s-u/2,0,u,y.transform.height,g)}function Kd(y,s,u,g,x,S){const A=y.context,L=A.gl;L.enable(L.SCISSOR_TEST),L.scissor(s*i.q.devicePixelRatio,u*i.q.devicePixelRatio,g*i.q.devicePixelRatio,x*i.q.devicePixelRatio),A.clear({color:S}),L.disable(L.SCISSOR_TEST)}const Av=i.dd([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Df}=Av;function Wc(y,s,u,g){y.emplaceBack(s,u,g)}class S2{constructor(s){this.vertexArray=new i.dh,this.indices=new i.aV,Wc(this.vertexArray,-1,-1,1),Wc(this.vertexArray,1,-1,1),Wc(this.vertexArray,-1,1,1),Wc(this.vertexArray,1,1,1),Wc(this.vertexArray,-1,-1,-1),Wc(this.vertexArray,1,-1,-1),Wc(this.vertexArray,-1,1,-1),Wc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Df),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=i.b8.simpleSegment(0,0,36,12)}}function ko(y,s,u,g,x,S){const A=y.context.gl,L=s.paint.get("sky-atmosphere-color"),z=s.paint.get("sky-atmosphere-halo-color"),B=s.paint.get("sky-atmosphere-sun-intensity"),V=((X,Y,re,ce,ae)=>({u_matrix_3f:X,u_sun_direction:Y,u_sun_intensity:re,u_color_tint_r:[ce.r,ce.g,ce.b,ce.a],u_color_tint_m:[ae.r,ae.g,ae.b,ae.a],u_luminance:5e-5}))(i.ad.mat3.fromMat4(i.ad.mat3.create(),g),x,B,L,z);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+S,s.skyboxTexture,0),u.draw(y,A.TRIANGLES,hr.disabled,Dr.disabled,Xr.unblended,Ir.frontCW,V,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const oD=i.dd([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ym{constructor(s){const u=new i.di;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new i.aV;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(u,oD.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=i.b8.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const qn=i.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class mn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class T2{constructor(s){this.colorModeAlphaBlendedWriteRGB=new Xr([1,Vu,1,Vu],i.al.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Xr([1,0,1,0],i.al.transparent,[!1,!1,!1,!0]),this.params=new mn,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const u=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Ym(u);const g=this.params.sizeRange,x=this.params.intensityRange,S=function(V){const X=i.dl(30),Y=[];for(let re=0;re<V;++re){const ce=2*Math.PI*X(),ae=Math.acos(1-2*X())-.5*Math.PI;Y.push(i.ad.vec3.fromValues(Math.cos(ae)*Math.cos(ce),Math.cos(ae)*Math.sin(ce),Math.sin(ae)))}return Y}(this.params.starsCount),A=i.dl(300),L=new i.dj,z=new i.aV;let B=0;for(let V=0;V<S.length;++V){const X=i.ad.vec3.scale([],S[V],200),Y=Math.max(0,1+.01*g*(1*A()-.5)),re=Math.max(0,1+.01*x*(1*A()-.5));L.emplaceBack(X[0],X[1],X[2],-1,-1,Y,re),L.emplaceBack(X[0],X[1],X[2],1,-1,Y,re),L.emplaceBack(X[0],X[1],X[2],1,1,Y,re),L.emplaceBack(X[0],X[1],X[2],-1,1,Y,re),z.emplaceBack(B+0,B+1,B+2),z.emplaceBack(B+0,B+2,B+3),B+=4}this.starsVx=u.createVertexBuffer(L,qn.members),this.starsIdx=u.createIndexBuffer(z),this.starsSegments=i.b8.simpleSegment(0,0,L.length,z.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,u){const g=s.context,x=g.gl,S=s.transform,A=new hr(x.LEQUAL,hr.ReadOnly,[0,1]),L=i.ag(S.zoom),z=s.style.getLut(u.scope),B=u.properties.get("color-use-theme")==="none",V=u.properties.get("color").toRenderColor(B?null:z).toArray01(),X=u.properties.get("high-color-use-theme")==="none",Y=u.properties.get("high-color").toRenderColor(X?null:z).toArray01(),re=u.properties.get("space-color-use-theme")==="none",ce=u.properties.get("space-color").toRenderColor(re?null:z).toArray01PremultipliedAlpha(),ae=5e-4,fe=i.dk(u.properties.get("horizon-blend"),0,1,ae,.25),me=i.cD(s,g,S)&&fe===ae?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,be=s.frameCounter/1e3%1,Ee=i.ad.vec3.length(S.globeCenterInViewSpace),Te=Math.sqrt(Math.pow(Ee,2)-Math.pow(me,2)),Oe=Math.acos(Te/Ee),Me=Ce=>{const Pe=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ce&&Pe.push("ALPHA_PASS");const Ne=s.getOrCreateProgram("globeAtmosphere",{defines:Pe}),Ue=((et,wt,Tt,Dt,Qe,bt,Ye,xt,gt,Et,ht,Mt)=>({u_frustum_tl:et,u_frustum_tr:wt,u_frustum_br:Tt,u_frustum_bl:Dt,u_horizon:Qe,u_transition:bt,u_fadeout_range:Ye,u_color:xt,u_high_color:gt,u_space_color:Et,u_temporal_offset:ht,u_horizon_angle:Mt}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,L,fe,V,Y,ce,be,Oe);s.uploadCommonUniforms(g,Ne);const dt=this.atmosphereBuffer;dt&&Ne.draw(s,x.TRIANGLES,A,Dr.disabled,Ce?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Ir.backCW,Ue,Ce?"atmosphere_glow_alpha":"atmosphere_glow",dt.vertexBuffer,dt.indexBuffer,dt.segments)};Me(!1),Me(!0)}drawStars(s,u){const g=i.ay(u.properties.get("star-intensity"),0,1);if(g===0)return;const x=s.context,S=x.gl,A=s.transform,L=s.getOrCreateProgram("stars"),z=i.ad.quat.identity([]);i.ad.quat.rotateX(z,z,-A._pitch),i.ad.quat.rotateZ(z,z,-A.angle),i.ad.quat.rotateX(z,z,i.ak(A._center.lat)),i.ad.quat.rotateY(z,z,-i.ak(A._center.lng));const B=i.ad.mat4.fromQuat(new Float32Array(16),z),V=i.ad.mat4.multiply([],A.starsProjMatrix,B),X=i.ad.mat3.fromMat4([],B),Y=i.ad.mat3.invert([],X),re=[0,1,0];i.ad.vec3.transformMat3(re,re,Y),i.ad.vec3.scale(re,re,this.params.sizeMultiplier);const ce=[1,0,0];i.ad.vec3.transformMat3(ce,ce,Y),i.ad.vec3.scale(ce,ce,this.params.sizeMultiplier);const ae=(fe=re,me=ce,be=g,{u_matrix:Float32Array.from(V),u_up:fe,u_right:me,u_intensity_multiplier:be});var fe,me,be;s.uploadCommonUniforms(x,L),this.starsVx&&this.starsIdx&&L.draw(s,S.TRIANGLES,hr.disabled,Dr.disabled,this.colorModeAlphaBlendedWriteRGB,Ir.disabled,ae,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Gc(y,s){const u=[...y],g=s.cameraWorldSizeForFog/s.worldSize,x=i.ad.mat4.identity([]);return i.ad.mat4.scale(x,x,[g,g,1]),i.ad.mat4.multiply(u,x,u),i.ad.mat4.multiply(u,s.worldToFogMatrix,u),u}function Lf(y,s,u,g,x){const S=u.material,A=g.context,{baseColorTexture:L,metallicRoughnessTexture:z}=S.pbrMetallicRoughness,{normalTexture:B,occlusionTexture:V,emissionTexture:X}=S;function Y(ce,ae,fe){if(ce&&(y.push(ae),A.activeTexture.set(A.gl.TEXTURE0+fe),ce.gfxTexture)){const{minFilter:me,magFilter:be,wrapS:Ee,wrapT:Te}=ce.sampler;ce.gfxTexture.bindExtraParam(me,be,Ee,Te)}}Y(L,"HAS_TEXTURE_u_baseColorTexture",Ii.BaseColor),Y(z,"HAS_TEXTURE_u_metallicRoughnessTexture",Ii.MetallicRoughness),Y(B,"HAS_TEXTURE_u_normalTexture",Ii.Normal),Y(V,"HAS_TEXTURE_u_occlusionTexture",Ii.Occlusion),Y(X,"HAS_TEXTURE_u_emissionTexture",Ii.Emission),x&&(x.texture||(x.texture=new i.dn(g.context,x.image,[x.image.height,x.image.height,x.image.height],A.gl.RGBA8)),A.activeTexture.set(A.gl.TEXTURE0+Ii.LUT),x.texture&&x.texture.bind(A.gl.LINEAR,A.gl.CLAMP_TO_EDGE),y.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(y.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(u.texcoordBuffer)),u.colorBuffer&&(y.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(u.colorBuffer)),u.normalBuffer&&(y.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(u.normalBuffer)),u.pbrBuffer&&(y.push("HAS_ATTRIBUTE_a_pbr"),y.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(u.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||y.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||y.push("DIFFUSE_SHADED");const re=g.shadowRenderer;re&&(y.push("RENDER_SHADOWS","DEPTH_TEXTURE"),re.useNormalOffset&&y.push("NORMAL_OFFSET"))}function qc(y,s,u,g,x,S){const A=u.paint.get("model-opacity").constantOr(1),L=s.context,z=new hr(s.context.gl.LEQUAL,hr.ReadWrite,s.depthRangeFor3D),B=s.transform,V=y.mesh,X=V.material,Y=X.pbrMetallicRoughness,re=s.style.fog;let ce;ce=s.transform.projection.zAxisUnit==="pixels"?[...y.nodeModelMatrix]:i.ad.mat4.multiply([],g.zScaleMatrix,y.nodeModelMatrix),i.ad.mat4.multiply(ce,g.negCameraPosMatrix,ce);const ae=i.ad.mat4.invert([],ce);i.ad.mat4.transpose(ae,ae);const fe=u.paint.get("model-color-use-theme").constantOr("default")==="none",me=u.paint.get("model-emissive-strength").constantOr(0),be=Ub(new Float32Array(y.worldViewProjection),new Float32Array(ce),new Float32Array(ae),null,s,A,Y.baseColorFactor.toRenderColor(null),X.emissiveFactor,Y.metallicFactor,Y.roughnessFactor,X,me,u),Ee={defines:[]},Te=[],Oe=s.shadowRenderer;Oe&&(Oe.useNormalOffset=!1),Lf(Ee.defines,Te,V,s,fe?null:u.lut);let Me=null;if(re){const Ne=Gc(y.nodeModelMatrix,s.transform);if(Me=new Float32Array(Ne),B.projection.name!=="globe"){const Ue=V.aabb.min,dt=V.aabb.max,[et,wt]=re.getOpacityForBounds(Ne,Ue[0],Ue[1],dt[0],dt[1]);Ee.overrideFog=et>=Xt||wt>=Xt}}const Ce=Bc(s,u.paint.get("model-cutoff-fade-range"));Ce.shouldRenderCutoff&&Ee.defines.push("RENDER_CUTOFF");const Pe=s.getOrCreateProgram("model",Ee);s.uploadCommonUniforms(L,Pe,null,Me,Ce),s.renderPass!=="shadow"&&Oe&&Oe.setupShadowsFromMatrix(y.nodeModelMatrix,Pe),Pe.draw(s,L.gl.TRIANGLES,z,x,S,V.material.doubleSided?Ir.disabled:Ir.backCCW,be,u.id,V.vertexBuffer,V.indexBuffer,V.segments,u.paint,s.transform.zoom,void 0,Te)}function Jd(y,s,u,g,x,S,A){let L;L=y.projection.name==="globe"?i.dp(u,y):[...u],i.ad.mat4.multiply(L,L,s.matrix);const z=i.ad.mat4.multiply([],g,L);if(s.meshes)for(const B of s.meshes){if(B.material.alphaMode!=="BLEND"){A.push({mesh:B,depth:0,modelIndex:x,worldViewProjection:z,nodeModelMatrix:L});continue}const V=i.ad.vec3.transformMat4([],B.centroid,z);!y.isOrthographic&&V[2]<=0||S.push({mesh:B,depth:V[2],modelIndex:x,worldViewProjection:z,nodeModelMatrix:L})}if(s.children)for(const B of s.children)Jd(y,B,u,g,x,S,A)}function Km(y,s,u,g){const x=u.shadowRenderer;if(!x)return;const S=x.getShadowPassDepthMode(),A=x.getShadowPassColorMode(),L=x.calculateShadowPassMatrixFromMatrix(s),z=y2(L);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,S,Dr.disabled,A,Ir.backCCW,z,g.id,y.vertexBuffer,y.indexBuffer,y.segments,g.paint,u.transform.zoom,void 0,void 0)}function Jb(y,s,u){const g=s.updateZoomBasedPaintProperties(),x=function(S,A,L){let z,B,V,X=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&X>0){const Y=S.terrain,re=Y.findDEMTileFor(L);re&&re.dem?z=i.dr.create(Y,L,re):X=0}if(X===0&&(A.terrainElevationMin=0,A.terrainElevationMax=0),X===A.validForExaggeration&&(X===0||z&&z._demTile&&z._demTile.tileID===A.validForDEMTile.id&&z._dem._timestamp===A.validForDEMTile.timestamp))return!1;for(const Y in A.instancesPerModel){const re=A.instancesPerModel[Y];for(let ce=0;ce<re.instancedDataArray.length;++ce){const ae=(z?X*z.getElevationAt(0|re.instancedDataArray.float32[16*ce],0|re.instancedDataArray.float32[16*ce+1],!0,!0):0)+re.instancesEvaluatedElevation[ce];re.instancedDataArray.float32[16*ce+6]=ae,B=B?Math.min(A.terrainElevationMin,ae):ae,V=V?Math.max(A.terrainElevationMax,ae):ae}}return A.terrainElevationMin=B||0,A.terrainElevationMax=V||0,A.validForExaggeration=X,A.validForDEMTile=z&&z._demTile?{id:z._demTile.tileID,timestamp:z._dem._timestamp}:{id:void 0,timestamp:0},!0}(y,s,u);(g||x)&&(s.uploaded=!1,s.upload(y.context))}const Us={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.ce([0,0,0],[i.ai,i.ai,0])};function Qb(y,s){const u=1<<y.canonical.z,g=s.getFreeCameraOptions().position,x=s.elevation,S=y.canonical.x/u,A=(y.canonical.x+1)/u,L=y.canonical.y/u,z=(y.canonical.y+1)/u;let B=s._centerAltitude;if(x){const re=x.getMinMaxForTile(y);re&&re.max>B&&(B=re.max)}const V=i.ay(g.x,S,A)-g.x,X=i.ay(g.y,L,z)-g.y,Y=i.bH(B,s.center.lat)-g.z;return s._zoomFromMercatorZ(Math.sqrt(V*V+X*X+Y*Y))}function Tl(y,s,u,g,x,S,A){const L=y.context,z=y.renderPass==="shadow",B=y.shadowRenderer,V=z&&B?B.getShadowPassDepthMode():new hr(L.gl.LEQUAL,hr.ReadWrite,y.depthRangeFor3D),X=y.isTileAffectedByFog(S);if(u.meshes)for(const Y of u.meshes){const re=["MODEL_POSITION_ON_GPU"],ce=[];let ae,fe,me;g.instancedDataArray.length>20&&re.push("INSTANCED_ARRAYS");const be=Bc(y,s.paint.get("model-cutoff-fade-range"));if(be.shouldRenderCutoff&&re.push("RENDER_CUTOFF"),z&&B)ae=y.getOrCreateProgram("modelDepth",{defines:re}),fe=y2(A.shadowTileMatrix,A.shadowTileMatrix,Float32Array.from(u.matrix)),me=B.getShadowPassColorMode();else{Lf(re,ce,Y,y,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),ae=y.getOrCreateProgram("model",{defines:re,overrideFog:X});const Te=Y.material,Oe=Te.pbrMetallicRoughness,Me=s.paint.get("model-opacity").constantOr(1),Ce=s.paint.get("model-emissive-strength").constantOr(0);fe=Ub(S.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,y,Me,Oe.baseColorFactor.toRenderColor(null),Te.emissiveFactor,Oe.metallicFactor,Oe.roughnessFactor,Te,Ce,s,x),B&&(A.shadowUniformsInitialized?ae.setShadowUniformValues(L,B.getShadowUniformValues()):(B.setupShadows(S.toUnwrapped(),ae,"model-tile",S.overscaledZ),A.shadowUniformsInitialized=!0)),me=be.shouldRenderCutoff||Me<1||Te.alphaMode!=="OPAQUE"?Xr.alphaBlended:Xr.unblended}y.uploadCommonUniforms(L,ae,S.toUnwrapped(),null,be);const Ee=Y.material.doubleSided?Ir.disabled:Ir.backCCW;if(g.instancedDataArray.length>20)ce.push(g.instancedDataBuffer),ae.draw(y,L.gl.TRIANGLES,V,Dr.disabled,me,Ee,fe,s.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,s.paint,y.transform.zoom,void 0,ce,g.instancedDataArray.length);else{const Te=z?"u_instance":"u_normal_matrix";for(let Oe=0;Oe<g.instancedDataArray.length;++Oe)fe[Te]=new Float32Array(g.instancedDataArray.arrayBuffer,64*Oe,16),ae.draw(y,L.gl.TRIANGLES,V,Dr.disabled,me,Ee,fe,s.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,s.paint,y.transform.zoom,void 0,ce)}}if(u.children)for(const Y of u.children)Tl(y,s,Y,g,x,S,A)}const Xu=[1,-1,1];function Mv(y,s,u,g){if(!u.modelManager)return!0;const x=u.modelManager;if(!u.shadowRenderer)return!0;const S=u.shadowRenderer,A=s.aabb;let L=!0,z=y.maxHeight;if(z===0){let V=0;for(const X in y.instancesPerModel){const Y=x.getModel(X,g);Y?V=Math.max(V,Math.max(Math.max(Y.aabb.max[0],Y.aabb.max[1]),Y.aabb.max[2])):L=!1}z=y.maxScale*V*1.41+y.maxVerticalOffset,L&&(y.maxHeight=z)}A.max[2]=z,A.min[2]+=y.terrainElevationMin,A.max[2]+=y.terrainElevationMax,i.ad.vec3.transformMat4(A.min,A.min,s.tileMatrix),i.ad.vec3.transformMat4(A.max,A.max,s.tileMatrix);const B=A.intersects(S.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(y.isInsideFirstShadowMapFrustum=B===2),B===0}function Cv(y,s){const u=y.uniformValues.u_cutoff_params[0],g=y.uniformValues.u_cutoff_params[1],x=y.uniformValues.u_cutoff_params[2],S=y.uniformValues.u_cutoff_params[3];return g===u||S===x?1:i.ay(((s-u)/(g-u)-x)/(S-x),0,1)}function e1(y,s,u,g){if(s.pitch<20)return 1;const x=s.getWorldToCameraMatrix();i.ad.mat4.multiply(x,x,y);const S=i.ad.vec4.fromValues(u.min[0],u.min[1],u.min[2],1);let A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A,z=A;S[1]=u.max[1],A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A[1]<L[1]?A:L,z=A[1]>z[1]?A:z,S[0]=u.max[0],A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A[1]<L[1]?A:L,z=A[1]>z[1]?A:z,S[1]=u.min[1],A=i.ad.vec4.transformMat4(i.ad.vec4.create(),S,x),L=A[1]<L[1]?A:L,z=A[1]>z[1]?A:z;const B=i.ay(g[0],0,1),V=100*s.pixelsPerMeter*i.ay(g[1],0,1),X=i.ay(g[2],0,1),Y=i.ad.vec4.lerp(i.ad.vec4.create(),L,z,B),re=Math.tan(.5*s.fovX),ce=-Y[2]*re;if(V===0)return Y[1]<-Math.abs(ce)?X:1;const ae=(-Math.abs(ce)-Y[1])/V,fe=(be,Ee,Te)=>(1-Te)*be+Te*Ee,me=i.ay(fe(1,X,ae),X,1);return fe(1,me,i.ay((s.pitch-20)/20,0,1))}class t1{}class Qd{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,u,g){{const X=this._storage.get(u.id);if(X)return X.lastUsedFrameIdx=s,X.buf}const x=g.gl,S=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),A=new ArrayBuffer(S),L=new Int16Array(A);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(A));const z=new i.dt;for(let X=0;X<S/2;X+=3){const Y=L[X],re=L[X+1],ce=L[X+2];z.emplaceBack(Y,re),z.emplaceBack(re,ce),z.emplaceBack(ce,Y)}const B=g.bindVertexArrayOES.current,V=new t1;return V.buf=new nc(g,z),V.lastUsedFrameIdx=s,this._storage.set(u.id,V),g.bindVertexArrayOES.set(B),V.buf}update(s){for(const[u,g]of this._storage)s-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(u))}destroy(){for(const[s,u]of this._storage)u.buf.destroy(),this._storage.delete(s)}}class r1{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Yu=i.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class n1{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Jm{constructor(s,u){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const i1=i.dd([{type:"Float32",name:"a_pos_2f",components:2}]);class o1{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,u){const g=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const A=new i.du,L=new i.aV;A.emplaceBack(-1,-1),A.emplaceBack(1,-1),A.emplaceBack(1,1),A.emplaceBack(-1,1),L.emplaceBack(0,1,2),L.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(A,i1.members),this.vignetteIdx=s.context.createIndexBuffer(L)}const x=i.b8.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,g);const A={u_vignetteShape:(S={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:S.vignetteColor};g.draw(s,s.context.gl.TRIANGLES,hr.disabled,Dr.disabled,Xr.alphaBlended,Ir.disabled,A,"vignette",this.vignetteVx,this.vignetteIdx,x)}var S}}class Bo{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,u){const g=s.getFreeCameraOptions().position,x=g.toAltitude(),S=g.toLngLat(),A=i.ak(S.lng),L=i.ak(S.lat),z=s.pixelsPerMeter/u,B=A*i.dv,V=i.dv*Math.log(Math.tan(Math.PI/4+L/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const X=-this._offsetYPrev+V,Y=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+B)*z,this._accumulatedOffsetY+=X*z,this._accumulatedElevation+=Y*z,this._offsetXPrev=B,this._offsetYPrev=V,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Pv(y,s){return[-(y[0]-Math.floor(y[0]/s)*s),-(y[1]-Math.floor(y[1]/s)*s),-(y[2]-Math.floor(y[2]/s)*s)]}function Iv(y){const s=i.dl(1323123451230),u=[];for(let g=0;g<y;++g){const x=2*s()-1,S=2*s()-1,A=2*s()-1;u.push(i.ad.vec3.fromValues(x,S,A))}return u}function Va(y,s,u,g,x){const S=i.ay((x-u)/(g-u),0,1);return(1-S)*y+S*s}class Ov{constructor(s){this._movement=new Bo,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new o1,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,u){const g=s.transform;this._movement.update(g,this._ppmScaleFactor);const x=g.starsProjMatrix,S=i.ad.quat.identity([]);i.ad.quat.rotateX(S,S,i.ak(90)-g._pitch),i.ad.quat.rotateZ(S,S,-g.angle);const A=i.ad.mat4.fromQuat(new Float32Array(16),S),L=i.ad.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),z=i.ad.mat4.transpose([],L),B=i.ad.mat4.multiply([],z,A),V=Date.now()/1e3;return this._accumulatedTimeFromStart+=(V-this._prevTime)*u,this._prevTime=V,{projectionMatrix:x,modelviewMatrix:B}}}class a1 extends Ov{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Jm(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const g=Iv(this.particlesCount),x=new i.dw,S=new i.aV;let A=0;const L=i.dl(1323123451230);for(let z=0;z<g.length;++z){const B=g[z],V=[2*L()-1,L(),L(),L()];x.emplaceBack(B[0],B[1],B[2],-1,-1,...V),x.emplaceBack(B[0],B[1],B[2],1,-1,...V),x.emplaceBack(B[0],B[1],B[2],1,1,...V),x.emplaceBack(B[0],B[1],B[2],-1,1,...V),S.emplaceBack(A+0,A+1,A+2),S.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=u.createVertexBuffer(x,Yu.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=s.transform.zoom;if(u.revealStart>g)return;const x=Va(0,1,u.revealStart,u.revealStart+u.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const S=structuredClone(this._params);let A=[-S.direction.x,S.direction.y,-100];i.ad.vec3.normalize(A,A);const L=structuredClone(this._vignetteParams);L.strength*=x,S.overrideStyleParameters||(S.intensity=s.style.rain.state.density,S.timeFactor=s.style.rain.state.intensity,S.color=structuredClone(s.style.rain.state.color),A=structuredClone(s.style.rain.state.direction),S.screenThinning.intensity=s.style.rain.state.centerThinning,S.dropletSizeX=s.style.rain.state.dropletSize[0],S.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],S.distortionStrength=100*s.style.rain.state.distortionStrength,L.strength=1,L.color=structuredClone(s.style.rain.state.vignetteColor));const z=this.updateOnRender(s,S.timeFactor),B=s.context,V=B.gl,X=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new i.T(B,{width:s.width,height:s.height,data:null},V.RGBA8)),S.distortionStrength>0&&(B.activeTexture.set(V.TEXTURE0),this.screenTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),V.copyTexSubImage2D(V.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const Y=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(B,Y),B.activeTexture.set(V.TEXTURE0),this.screenTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const re=[S.color.r,S.color.g,S.color.b,S.color.a],ce=(ae,fe)=>{const me=Pv(this._movement.getPosition(),ae),be=S.dropletSizeX,Ee=S.dropletSizeX*S.dropletSizeYScale,Te=s.width/2,Oe=s.height/2,Me=Va(0,S.screenThinning.start,0,1,S.screenThinning.intensity),Ce=Va(.001,S.screenThinning.range,0,1,S.screenThinning.intensity),Pe=Va(0,S.screenThinning.particleOffset,0,1,S.screenThinning.intensity),Ne=(Ue={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:me,velocityConeAperture:S.velocityConeAperture,velocity:S.velocity,boxSize:ae,rainDropletSize:[be,Ee],distortionStrength:S.distortionStrength,rainDirection:A,color:re,screenSize:[X.width,X.height],thinningCenterPos:[Te,Oe],thinningShape:[Me,Ce,Math.pow(10,S.screenThinning.fadePower)],thinningAffectedRatio:S.screenThinning.affectedRatio,thinningParticleOffset:Pe,shapeDirectionalPower:S.shapeDirPower,shapeNormalPower:S.shapeNormalPower,mode:fe?0:1},{u_modelview:Float32Array.from(Ue.modelview),u_projection:Float32Array.from(Ue.projection),u_time:Ue.time,u_cam_pos:Ue.camPos,u_texScreen:0,u_velocityConeAperture:Ue.velocityConeAperture,u_velocity:Ue.velocity,u_boxSize:Ue.boxSize,u_rainDropletSize:Ue.rainDropletSize,u_distortionStrength:Ue.distortionStrength,u_rainDirection:Ue.rainDirection,u_color:Ue.color,u_screenSize:Ue.screenSize,u_thinningCenterPos:Ue.thinningCenterPos,u_thinningShape:Ue.thinningShape,u_thinningAffectedRatio:Ue.thinningAffectedRatio,u_thinningParticleOffset:Ue.thinningParticleOffset,u_shapeDirectionalPower:Ue.shapeDirectionalPower,u_shapeNormalPower:Ue.shapeNormalPower,u_mode:Ue.mode});var Ue;const dt=Math.round(S.intensity*this.particlesCount),et=i.b8.simpleSegment(0,0,4*dt,2*dt);Y.draw(s,V.TRIANGLES,hr.disabled,Dr.disabled,Xr.alphaBlended,Ir.disabled,Ne,"rain_particles",this.particlesVx,this.particlesIdx,et)};S.distortionStrength>0&&ce(S.boxSize,!0),ce(S.boxSize,!1),this._vignette.draw(s,L)}}const s1=i.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Nf extends Ov{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Jm(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const g=Iv(this.particlesCount),x=new i.dx,S=new i.aV;let A=0;const L=i.dl(1323123451230);for(let z=0;z<g.length;++z){const B=g[z],V=L(),X=L(),Y=L(),re=[z/g.length,V,X,Y],ce=[L(),L()];x.emplaceBack(B[0],B[1],B[2],-1,-1,...re,...ce),x.emplaceBack(B[0],B[1],B[2],1,-1,...re,...ce),x.emplaceBack(B[0],B[1],B[2],1,1,...re,...ce),x.emplaceBack(B[0],B[1],B[2],-1,1,...re,...ce),S.emplaceBack(A+0,A+1,A+2),S.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=u.createVertexBuffer(x,s1.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const u=structuredClone(this._params);let g=[-u.direction.x,u.direction.y,-100];i.ad.vec3.normalize(g,g);const x=structuredClone(this._vignetteParams),S=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},A=s.transform.zoom;if(S.revealStart>A)return;const L=Va(0,1,S.revealStart,S.revealStart+S.revealRange,A);x.strength*=L,u.overrideStyleParameters||(u.intensity=s.style.snow.state.density,u.timeFactor=s.style.snow.state.intensity,u.color=structuredClone(s.style.snow.state.color),g=structuredClone(s.style.snow.state.direction),u.screenThinning.intensity=s.style.snow.state.centerThinning,u.billboardSize=2.79*s.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(s.style.snow.state.vignetteColor));const z=this.updateOnRender(s,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const B=s.context,V=B.gl,X=s.transform,Y=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(B,Y),((re,ce,ae)=>{const fe=Pv(this._movement.getPosition(),re),me=X.width/2,be=X.height/2,Ee=Va(0,ae.screenThinning.start,0,1,ae.screenThinning.intensity),Te=Va(.001,ae.screenThinning.range,0,1,ae.screenThinning.intensity),Oe=Va(0,ae.screenThinning.particleOffset,0,1,ae.screenThinning.intensity),Me=(Ce={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:fe,velocityConeAperture:ae.velocityConeAperture,velocity:ae.velocity,horizontalOscillationRadius:ae.horizontalOscillationRadius,horizontalOscillationRate:ae.horizontalOscillationRate,boxSize:re,billboardSize:1*ae.billboardSize,simpleShapeParameters:[ae.shapeFadeStart,ae.shapeFadePower],screenSize:[X.width,X.height],thinningCenterPos:[me,be],thinningShape:[Ee,Te,Math.pow(10,ae.screenThinning.fadePower)],thinningAffectedRatio:ae.screenThinning.affectedRatio,thinningParticleOffset:Oe,color:[ae.color.r,ae.color.g,ae.color.b,ae.color.a],direction:g},{u_modelview:Float32Array.from(Ce.modelview),u_projection:Float32Array.from(Ce.projection),u_time:Ce.time,u_cam_pos:Ce.camPos,u_velocityConeAperture:Ce.velocityConeAperture,u_velocity:Ce.velocity,u_horizontalOscillationRadius:Ce.horizontalOscillationRadius,u_horizontalOscillationRate:Ce.horizontalOscillationRate,u_boxSize:Ce.boxSize,u_billboardSize:Ce.billboardSize,u_simpleShapeParameters:Ce.simpleShapeParameters,u_screenSize:Ce.screenSize,u_thinningCenterPos:Ce.thinningCenterPos,u_thinningShape:Ce.thinningShape,u_thinningAffectedRatio:Ce.thinningAffectedRatio,u_thinningParticleOffset:Ce.thinningParticleOffset,u_particleColor:Ce.color,u_direction:Ce.direction});var Ce;const Pe=Math.round(ae.intensity*this.particlesCount),Ne=i.b8.simpleSegment(0,0,4*Pe,2*Pe);this.particlesVx&&this.particlesIdx&&Y.draw(s,V.TRIANGLES,hr.disabled,Dr.disabled,Xr.alphaBlended,Ir.disabled,Me,"snow_particles",this.particlesVx,this.particlesIdx,Ne)})(u.boxSize,0,u),this._vignette.draw(s,x)}}const Qm={symbol:function(y,s,u,g,x){if(y.renderPass!=="translucent")return;const S=Dr.disabled,A=y.colorModeForRenderPass(),L=u.layout.get("text-variable-anchor"),z=u.layout.get("text-size-scale-range"),B=i.ay(y.scaleFactor,z[0],z[1]);L&&function(Y,re,ce,ae,fe,me,be,Ee){const Te=re.transform,Oe=fe==="map",Me=me==="map";for(const Ce of Y){const Pe=ae.getTile(Ce),Ne=Pe.getBucket(ce);if(!Ne||!Ne.text||!Ne.text.segments.get().length)continue;const Ue=i.bp(Ne.textSizeData,Te.zoom,Ee),dt=ds(Ce,Ne.getProjection(),Te),et=Te.calculatePixelsToTileUnitsMatrix(Pe),wt=Lc(dt,Pe.tileID.canonical,Me,Oe,Te,Ne.getProjection(),et),Tt=Ne.hasIconTextFit()&&Ne.hasIconData();if(Ue){const Dt=Math.pow(2,Te.zoom-Pe.tileID.overscaledZ);$s(Ne,Oe,Me,be,i.cY,Te,wt,Ce,Dt,Ue,Tt)}}}(g,y,u,s,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x,B);const V=u.paint.get("icon-opacity").constantOr(1)!==0,X=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(V||X)?$n(y,s,u,g,S,A):(V&&$n(y,s,u,g,S,A,{onlyIcons:!0}),X&&$n(y,s,u,g,S,A,{onlyText:!0})),s.map.showCollisionBoxes&&(bv(y,s,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),bv(y,s,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(y,s,u,g){if(y.renderPass!=="translucent")return;const x=u.paint.get("circle-opacity"),S=u.paint.get("circle-stroke-width"),A=u.paint.get("circle-stroke-opacity"),L=u.layout.get("circle-sort-key").constantOr(1)!==void 0,z=u.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(S.constantOr(1)===0||A.constantOr(1)===0))return;const B=y.context,V=B.gl,X=y.transform,Y=y.depthModeForSublayer(0,hr.ReadOnly),re=Dr.disabled,ce=y.colorModeForDrapableLayerRenderPass(z),ae=X.projection.name==="globe",fe=[i.av(X.center.lng),i.aC(X.center.lat)],me=[];for(let Ee=0;Ee<g.length;Ee++){const Te=g[Ee],Oe=s.getTile(Te),Me=Oe.getBucket(u);if(!Me||Me.projection.name!==X.projection.name)continue;const Ce=Me.programConfigurations.get(u.id),Pe=i.cZ(u),Ne=y.isTileAffectedByFog(Te);ae&&Pe.push("PROJECTION_GLOBE_VIEW"),Pe.push("DEPTH_D24"),y.terrain&&X.depthOcclusionForSymbolsAndCircles&&Pe.push("DEPTH_OCCLUSION");const Ue=y.getOrCreateProgram("circle",{config:Ce,defines:Pe,overrideFog:Ne}),dt=Me.layoutVertexBuffer,et=Me.globeExtVertexBuffer,wt=Me.indexBuffer,Tt=X.projection.createInversionMatrix(X,Te.canonical),Dt={programConfiguration:Ce,program:Ue,layoutVertexBuffer:dt,globeExtVertexBuffer:et,indexBuffer:wt,uniformValues:i.c_(y,Te,Oe,Tt,fe,u),tile:Oe};if(L){const Qe=Me.segments.get();for(const bt of Qe)me.push({segments:new i.b8([bt]),sortKey:bt.sortKey,state:Dt})}else me.push({segments:Me.segments,sortKey:0,state:Dt})}L&&me.sort((Ee,Te)=>Ee.sortKey-Te.sortKey);const be={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const Ee of me){const{programConfiguration:Te,program:Oe,layoutVertexBuffer:Me,globeExtVertexBuffer:Ce,indexBuffer:Pe,uniformValues:Ne,tile:Ue}=Ee.state,dt=Ee.segments;y.terrain&&y.terrain.setupElevationDraw(Ue,Oe,be),y.uploadCommonUniforms(B,Oe,Ue.tileID.toUnwrapped()),Oe.draw(y,V.TRIANGLES,Y,re,ce,Ir.disabled,Ne,u.id,Me,Pe,dt,u.paint,X.zoom,Te,[Ce])}},heatmap:function(y,s,u,g){if(u.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const x=y.context,S=x.gl,A=Dr.disabled,L=new Xr([S.ONE,S.ONE,S.ONE,S.ONE],i.al.transparent,[!0,!0,!0,!0]);(function(re,ce,ae,fe){const me=re.gl,be=ce.width*fe,Ee=ce.height*fe;re.activeTexture.set(me.TEXTURE1),re.viewport.set([0,0,be,Ee]);let Te=ae.heatmapFbo;if(!Te||Te&&(Te.width!==be||Te.height!==Ee)){Te&&Te.destroy();const Oe=me.createTexture();me.bindTexture(me.TEXTURE_2D,Oe),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),Te=ae.heatmapFbo=re.createFramebuffer(be,Ee,!0,null),function(Me,Ce,Pe,Ne,Ue,dt){const et=Me.gl;et.texImage2D(et.TEXTURE_2D,0,Me.extRenderToTextureHalfFloat?et.RGBA16F:et.RGBA,Ue,dt,0,et.RGBA,Me.extRenderToTextureHalfFloat?et.HALF_FLOAT:et.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Pe)}(re,0,Oe,Te,be,Ee)}else me.bindTexture(me.TEXTURE_2D,Te.colorAttachment.get()),re.bindFramebuffer.set(Te.framebuffer)})(x,y,u,y.transform.projection.name==="globe"?.5:.25),x.clear({color:i.al.transparent});const z=y.transform,B=z.projection.name==="globe",V=B?["PROJECTION_GLOBE_VIEW"]:[],X=B?Ir.frontCCW:Ir.disabled,Y=[i.av(z.center.lng),i.aC(z.center.lat)];for(let re=0;re<g.length;re++){const ce=g[re];if(s.hasRenderableParent(ce))continue;const ae=s.getTile(ce),fe=ae.getBucket(u);if(!fe||fe.projection.name!==z.projection.name)continue;const me=y.isTileAffectedByFog(ce),be=fe.programConfigurations.get(u.id),Ee=y.getOrCreateProgram("heatmap",{config:be,defines:V,overrideFog:me}),{zoom:Te}=y.transform;y.terrain&&y.terrain.setupElevationDraw(ae,Ee),y.uploadCommonUniforms(x,Ee,ce.toUnwrapped());const Oe=z.projection.createInversionMatrix(z,ce.canonical);Ee.draw(y,S.TRIANGLES,hr.disabled,A,L,X,vv(y,ce,ae,Oe,Y,Te,u.paint.get("heatmap-intensity")),u.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,u.paint,y.transform.zoom,be,B?[fe.globeExtVertexBuffer]:null)}x.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(x,S){const A=x.context,L=A.gl,z=S.heatmapFbo;if(!z)return;A.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,z.colorAttachment.get()),A.activeTexture.set(L.TEXTURE1);let B=S.colorRampTexture;B||(B=S.colorRampTexture=new i.T(A,S.colorRamp,L.RGBA8)),B.bind(L.LINEAR,L.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,L.TRIANGLES,hr.disabled,Dr.disabled,x.colorModeForRenderPass(),Ir.disabled,((V,X,Y,re)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,S),S.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,S.paint,x.transform.zoom)}(y,u))},line:function(y,s,u,g){if(y.renderPass!=="translucent")return;const x=u.paint.get("line-opacity"),S=u.paint.get("line-width");if(x.constantOr(1)===0||S.constantOr(1)===0)return;const A=u.paint.get("line-emissive-strength"),L=u.paint.get("line-occlusion-opacity"),z=u.layout.get("line-elevation-reference"),B=u.layout.get("line-width-unit")==="meters",V=z==="sea",X=y.context,Y=X.gl;if(u.hasElevatedBuckets&&y.transform.projection.name==="globe")return;const re=u.layout.get("line-cross-slope"),ce=re!==void 0,ae=re<1,fe=y.colorModeForDrapableLayerRenderPass(A),me=y.terrain&&y.terrain.renderingToTexture,be=me?1:i.q.devicePixelRatio,Ee=u.paint.get("line-dasharray"),Te=Ee.constantOr(1),Oe=u.layout.get("line-cap"),Me=Ee.constantOr(null),Ce=Oe.constantOr(null),Pe=u.paint.get("line-pattern"),Ne=Pe.constantOr(1),Ue=Pe.constantOr(null),dt=u.paint.get("line-opacity").constantOr(1);let et=!Ne&&dt!==1||y.depthOcclusion&&L>0&&L<1;const wt=u.paint.get("line-gradient"),Tt=Ne?"linePattern":"line",Dt=i.c$(u);let Qe;if(me&&y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(et=!1),L!==0&&y.depthOcclusion){const Ye=u.paint._values["line-opacity"];Ye&&Ye.value&&Ye.value.kind==="constant"?Qe=Ye.value:i.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}S.value.kind!=="constant"&&S.value.isLineProgressConstant===!1&&Dt.push("VARIABLE_LINE_WIDTH");const bt=(Ye,xt,gt,Et,ht,Mt)=>{for(const Vt of Ye){const Wt=s.getTile(Vt);if(Ne&&!Wt.patternsLoaded())continue;const Ht=Wt.getBucket(u);if(!Ht||Ht.hasZOffset&&!ht||!Ht.hasZOffset&&ht)continue;y.prepareDrawTile();const ir=Ht.programConfigurations.get(u.id),Or=y.isTileAffectedByFog(Vt),vr=y.getOrCreateProgram(Tt,{config:ir,defines:xt,overrideFog:Or,overrideRtt:!ht&&void 0});if(Ue&&Wt.imageAtlas){const Lr=i.d0.from(Ue).getPrimary().scaleSelf(be).toString(),or=Wt.imageAtlas.patternPositions.get(Lr);or&&ir.setConstantPatternPositions(or)}if(!Ne&&Me&&Ce&&Wt.lineAtlas){const Lr=Wt.lineAtlas.getDash(Me,Ce);Lr&&ir.setConstantPatternPositions(Lr)}let[Mr,Tr]=u.paint.get("line-trim-offset");(Ce==="round"||Ce==="square")&&Mr!==Tr&&(Mr===0&&(Mr-=1),Tr===1&&(Tr+=1));const tn=me?Vt.projMatrix:null,yn=B?1/Ht.tileToMeter/i.at(Wt,1,y.transform.zoom):1,Wn=B?1/Ht.tileToMeter/i.at(Wt,1,Math.floor(y.transform.zoom)):1,Hr=Ne?i.d1(y,Wt,u,tn,be,yn,Wn,[Mr,Tr]):i.d2(y,Wt,u,tn,Ht.lineClipsArray.length,be,yn,Wn,[Mr,Tr]);if(wt){const Lr=Ht.gradients[u.id];let or=Lr.texture;if(u.gradientVersion!==Lr.version){let on=256;if(u.stepInterpolant){const Mn=s.getSource().maxzoom,cn=Vt.canonical.z===Mn?Math.ceil(1<<y.transform.maxZoom-Vt.canonical.z):1;on=i.ay(i.d3(Ht.maxLineLength/i.ai*1024*cn),256,X.maxTextureSize)}Lr.gradient=i.d4({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:on,image:Lr.gradient||void 0,clips:Ht.lineClipsArray}),Lr.texture?Lr.texture.update(Lr.gradient):Lr.texture=new i.T(X,Lr.gradient,Y.RGBA8),Lr.version=u.gradientVersion,or=Lr.texture}X.activeTexture.set(Y.TEXTURE1),or.bind(u.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}Te&&(X.activeTexture.set(Y.TEXTURE0),Wt.lineAtlasTexture&&Wt.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),ir.updatePaintBuffers()),Ne&&(X.activeTexture.set(Y.TEXTURE0),Wt.imageAtlasTexture&&Wt.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),ir.updatePaintBuffers()),ht&&!V&&y.terrain.setupElevationDraw(Wt,vr),y.uploadCommonUniforms(X,vr,Vt.toUnwrapped());const li=Lr=>{Qe!=null&&(Qe.value=dt*L),vr.draw(y,Y.TRIANGLES,gt,Lr,fe,Ir.disabled,Hr,u.id,Ht.layoutVertexBuffer,Ht.indexBuffer,Ht.segments,u.paint,y.transform.zoom,ir,[Ht.layoutVertexBuffer2,Ht.patternVertexBuffer,Ht.zOffsetVertexBuffer]),Qe!=null&&(Qe.value=dt)};if(et&&!ht){const Lr=y.stencilModeForClipping(Vt).ref;Lr===0&&me&&X.clear({stencil:0});const or={func:Y.EQUAL,mask:255};Hr.u_alpha_discard_threshold=.8,li(new Dr(or,Lr,255,Y.KEEP,Y.KEEP,Y.INVERT)),Hr.u_alpha_discard_threshold=0,li(new Dr(or,Lr,255,Y.KEEP,Y.KEEP,Y.KEEP))}else Hr.u_alpha_discard_threshold=et&&ht&&Mt?.8:0,li(ht?Et:y.stencilModeForClipping(Vt))}};if(u.hasNonElevatedBuckets){const Ye=!me&&y.terrain;L!==0&&Ye?i.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):Ye?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):bt(g,Dt,y.depthModeForSublayer(0,hr.ReadOnly),Dr.disabled,!1,!0)}if(u.hasElevatedBuckets){Dt.push("ELEVATED"),ce&&Dt.push(ae?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),V&&Dt.push("ELEVATION_REFERENCE_SEA");const Ye=et?y.stencilModeFor3D():Dr.disabled,xt=new hr(y.depthOcclusion?Y.GREATER:Y.LEQUAL,hr.ReadOnly,y.depthRangeFor3D);y.forceTerrainMode=!0,bt(g,Dt,xt,Ye,!0,!0),et&&bt(g,Dt,xt,Ye,!0,!1),y.forceTerrainMode=!1}et&&(y.resetStencilClippingMasks(),me&&X.clear({stencil:0})),L===0||y.depthOcclusion||me||y.layersWithOcclusionOpacity.push(y.currentLayer)},fill:function(y,s,u,g){const x=u.paint.get("fill-color"),S=u.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const A=u.paint.get("fill-emissive-strength"),L=y.colorModeForDrapableLayerRenderPass(A),z=u.paint.get("fill-pattern"),B=y.opaquePassEnabledForLayer()&&!z.constantOr(1)&&x.constantOr(i.al.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";let V="none";u.layout.get("fill-elevation-reference")!=="none"?V="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(V="offset");const X=!(!y.terrain||!y.terrain.enabled),Y={painter:y,sourceCache:s,layer:u,coords:g,colorMode:L,elevationType:V,terrainEnabled:X,pass:B};if(V!=="offset"){if(Sv(Y,!1),V==="road"){const re=!X&&y.renderPass==="translucent";re&&Hb(y,s,u,g,"geometry"),Sv(Y,!0,Dr.disabled),re&&function(ce){const{painter:ae,sourceCache:fe,layer:me,coords:be,colorMode:Ee}=ce,Te=ae.context.gl,Oe=new hr(ae.context.gl.LEQUAL,hr.ReadOnly,ae.depthRangeFor3D);for(const Me of be){const Ce=fe.getTile(Me),Pe=Ce.getBucket(me);if(!Pe)continue;const Ne=Pe.elevatedStructures;if(!Ne||!Ne.renderableSegments||Ne.renderableSegments.segments[0].primitiveLength===0)continue;ae.prepareDrawTile();const Ue=Pe.bufferData.programConfigurations.get(me.id),dt=ae.isTileAffectedByFog(Me),et=ae.getOrCreateProgram("elevatedStructures",{config:Ue,overrideFog:dt,defines:["NORMAL_OFFSET"]}),wt={u_matrix:ae.translatePosMatrix(Me.projMatrix,Ce,me.paint.get("fill-translate"),me.paint.get("fill-translate-anchor"))};ae.uploadCommonUniforms(ae.context,et,Me.toUnwrapped()),et.draw(ae,Te.TRIANGLES,Oe,Dr.disabled,Ee,Ir.backCCW,wt,me.id,Ne.vertexBuffer,Ne.indexBuffer,Ne.renderableSegments,me.paint,ae.transform.zoom,Ue,[Ne.vertexBufferNormal])}}(Y)}}else Sv(Y,!1,y.stencilModeFor3D())},"fill-extrusion":function(y,s,u,g){const x=u.paint.get("fill-extrusion-opacity"),S=y.context,A=S.gl,L=y.terrain,z=L&&L.renderingToTexture;if(x===0)return;const B=y.conflationActive&&y.style.isLayerClipped(u,s.getSource()),V=y.style.order.indexOf(u.fqid);if(B&&function(X,Y,re,ce,ae){for(const fe of ce){const me=Y.getTile(fe).getBucket(re);me&&(me.updateReplacement(fe,X.replacementSource,ae),me.uploadCentroid(X.context))}}(y,s,u,g,V),L||B)for(const X of g){const Y=s.getTile(X).getBucket(u);Y&&If(y.context,s,X,Y,u,L,B)}if(y.renderPass==="shadow"&&y.shadowRenderer){const X=y.shadowRenderer;if(L&&x<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ab)return;const Y=X.getShadowPassDepthMode(),re=X.getShadowPassColorMode();Xm(y,s,u,g,Y,Dr.disabled,re,B)}else if(y.renderPass==="translucent"){const X=!u.paint.get("fill-extrusion-pattern").constantOr(1),Y=u.paint.get("fill-extrusion-color").constantOr(i.al.white);if(!z&&Y.a!==0){const re=new hr(y.context.gl.LEQUAL,hr.ReadWrite,y.depthRangeFor3D);x===1&&X?Xm(y,s,u,g,re,Dr.disabled,Xr.unblended,B):(Xm(y,s,u,g,re,Dr.disabled,Xr.disabled,B),Xm(y,s,u,g,re,y.stencilModeFor3D(),y.colorModeForRenderPass(),B),y.resetStencilClippingMasks())}if(y.style.enable3dLights()&&X&&(!L&&y.transform.projection.name!=="globe"||z)){const re=u.paint.get("fill-extrusion-opacity"),ce=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ae=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),fe=u.paint.get("fill-extrusion-flood-light-intensity"),me=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",be=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(me?null:u.lut).toArray01().slice(0,3),Ee=ce>0&&ae>0,Te=fe>0,Oe=(Ce,Pe,Ne)=>(1-Ne)*Ce+Ne*Pe,Me=Ce=>{const Pe=y.depthModeForSublayer(1,hr.ReadOnly,A.LEQUAL,!0),Ne=u.paint.get(Ce?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ue=Oe(.1,3,Ne),dt=y._showOverdrawInspector;if(!dt){const et=new Dr({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),wt=new Xr([A.ONE,A.ONE,A.ONE,A.ONE],i.al.transparent,[!1,!1,!1,!0],A.MIN);Pf(y,s,u,g,Pe,et,wt,Ir.disabled,Ce,"sdf",re,ce,ae,fe,be,Ue,B,!1)}{const et=dt?Dr.disabled:new Dr({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),wt=dt?y.colorModeForRenderPass():new Xr([A.ONE_MINUS_DST_ALPHA,A.DST_ALPHA,A.ONE,A.ONE],i.al.transparent,[!0,!0,!0,!0]);Pf(y,s,u,g,Pe,et,wt,Ir.disabled,Ce,"color",re,ce,ae,fe,be,Ue,B,!1)}};if(z){const Ce=(Pe,Ne,Ue)=>{const dt=y.depthModeForSublayer(1,hr.ReadOnly,A.LEQUAL,!1),et=u.paint.get(Pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),wt=Oe(.1,3,et);{const Tt=new Xr([A.ONE,A.ONE,A.ONE,A.ONE],i.al.transparent,[!1,!1,!1,!0]);Pf(y,s,u,g,dt,Dr.disabled,Tt,Ir.disabled,Pe,"clear",re,ce,ae,fe,be,wt,B,Ne)}{const Tt=new Dr({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),Dt=new Xr([A.ONE,A.ONE,A.ONE,A.ONE],i.al.transparent,[!1,!1,!1,!0],A.MIN);Pf(y,s,u,g,dt,Tt,Dt,Ir.disabled,Pe,"sdf",re,ce,ae,fe,be,wt,B,Ne)}{const Tt=Pe?A.ZERO:A.ONE_MINUS_DST_ALPHA,Dt=new Dr({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),Qe=new Xr([Tt,A.DST_ALPHA,A.ONE_MINUS_DST_ALPHA,A.ZERO],i.al.transparent,[!0,!0,!0,!0]);Pf(y,s,u,g,dt,Dt,Qe,Ir.disabled,Pe,"color",re,ce,ae,fe,be,wt,B,Ne)}{const Tt=new Xr([A.ONE,A.ONE,A.ONE,Pe?A.ZERO:A.ONE],i.al.transparent,[!1,!1,!1,!0],Pe?A.FUNC_ADD:A.MAX);Pf(y,s,u,g,dt,Dr.disabled,Tt,Ir.disabled,Pe,"clear",re,ce,ae,fe,be,wt,B,Ne,Ue)}};if(Ee||Te){let Pe;if(y.prepareDrawTile(),L){const Ne=L.drapeBufferSize[0],Ue=L.drapeBufferSize[1];Pe=L.framebufferCopyTexture,Pe&&(!Pe||Pe.size[0]===Ne&&Pe.size[1]===Ue)||(Pe&&Pe.destroy(),Pe=L.framebufferCopyTexture=new i.T(S,new i.r({width:Ne,height:Ue}),A.RGBA8)),Pe.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.copyTexSubImage2D(A.TEXTURE_2D,0,0,0,0,0,Ne,Ue)}Ee&&Ce(!0,!1,Pe),Te&&Ce(!1,!0,Pe)}}else Ee&&Me(!0),Te&&Me(!1),(Ee||Te)&&y.resetStencilClippingMasks()}}},hillshade:function(y,s,u,g){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent"||y.style.disableElevatedTerrain)return;const x=y.context,S=y.terrain&&y.terrain.renderingToTexture,[A,L]=y.renderPass!=="translucent"||S?[{},g]:y.stencilConfigForOverlap(g);for(const z of L){const B=s.getTile(z);if(B.needsHillshadePrepare&&y.renderPass==="offscreen")qR(y,B,u);else if(y.renderPass==="translucent"){const V=y.depthModeForSublayer(0,hr.ReadOnly),X=u.paint.get("hillshade-emissive-strength"),Y=y.colorModeForDrapableLayerRenderPass(X),re=S&&y.terrain?y.terrain.stencilModeForRTTOverlap(z):A[z.overscaledZ];xf(y,z,B,u,V,re,Y)}}x.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,s,u,g,x,S){if(y.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const A=y.transform.projection.name==="globe",L=u.paint.get("raster-elevation")!==0,z=L&&A;if(y.renderElevatedRasterBackface&&!z)return;const B=y.context,V=B.gl,X=s.getSource(),Y=function(Me,Ce,Pe,Ne){const Ue=Ce.paint.get("raster-color"),dt=Me.type==="raster-array",et=[],wt=Ce.paint.get("raster-resampling"),Tt=Ce.paint.get("raster-color-mix");let Dt=Ce.paint.get("raster-color-range");const Qe=[Tt[0],Tt[1],Tt[2],0],bt=Tt[3];let Ye=wt==="nearest"?Ne.NEAREST:Ne.LINEAR;if(dt&&(et.push("RASTER_ARRAY"),Ue||et.push("RASTER_COLOR"),wt==="linear"&&et.push("RASTER_ARRAY_LINEAR"),Ye=Ne.NEAREST,!Dt&&Me.rasterLayers)){const xt=Me.rasterLayers.find(({id:gt})=>gt===Ce.sourceLayer);xt&&xt.fields&&xt.fields.range&&(Dt=xt.fields.range)}if(Dt=Dt||[0,1],Ue){et.push("RASTER_COLOR"),Pe.activeTexture.set(Ne.TEXTURE2),Ce.updateColorRamp(Dt);let xt=Ce.colorRampTexture;xt||(xt=Ce.colorRampTexture=new i.T(Pe,Ce.colorRamp,Ne.RGBA8)),xt.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}return{mix:Qe,range:Dt,offset:bt,defines:et,resampling:Ye}}(X,u,B,V);if(X instanceof i.aK&&!g.length&&!A)return;const re=u.paint.get("raster-emissive-strength"),ce=y.colorModeForDrapableLayerRenderPass(re),ae=y.terrain&&y.terrain.renderingToTexture,fe=!y.options.moving,me=u.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;if(X instanceof i.aK&&!g.length&&(X.onNorthPole||X.onSouthPole)){const Me=L?y.stencilModeFor3D():Dr.disabled;return void it(!!X.onNorthPole,null,y,s,u,re,Y,Ir.disabled,Me)}if(!g.length)return;const[be,Ee]=X instanceof i.aK||ae?[{},g]:y.stencilConfigForOverlap(g),Te=Ee[Ee.length-1].overscaledZ;z&&Y.defines.push("PROJECTION_GLOBE_VIEW"),L&&Y.defines.push("RENDER_CUTOFF");const Oe=(Me,Ce,Pe)=>{for(const Ne of Me){const Ue=Ne.toUnwrapped(),dt=s.getTile(Ne);if(ae&&(!dt||!dt.hasData()))continue;B.activeTexture.set(V.TEXTURE0);const et=Tv(dt,X,u,Y);if(!et||!et.texture)continue;const{texture:wt,mix:Tt,offset:Dt,tileSize:Qe,buffer:bt}=et;let Ye,xt;ae?(Ye=hr.disabled,xt=Ne.projMatrix):L?(Ye=new hr(V.LEQUAL,hr.ReadWrite,y.depthRangeFor3D),xt=A?Float32Array.from(y.transform.expandedFarZProjMatrix):y.transform.calculateProjMatrix(Ue,fe)):(Ye=y.depthModeForSublayer(Ne.overscaledZ-Te,u.paint.get("raster-opacity")===1?hr.ReadWrite:hr.ReadOnly,V.LESS),xt=y.transform.calculateProjMatrix(Ue,fe));const gt=y.terrain&&ae?y.terrain.stencilModeForRTTOverlap(Ne):be[Ne.overscaledZ],Et=S?0:u.paint.get("raster-fade-duration");dt.registerFadeDuration(Et);const ht=s.findLoadedParent(Ne,0),Mt=hv(dt,ht,s,y.transform,Et);let Vt,Wt;y.terrain&&y.terrain.prepareDrawTile(),B.activeTexture.set(V.TEXTURE0),wt.bind(me,V.CLAMP_TO_EDGE),B.activeTexture.set(V.TEXTURE1),ht?(ht.texture&&ht.texture.bind(me,V.CLAMP_TO_EDGE),Vt=Math.pow(2,ht.tileID.overscaledZ-dt.tileID.overscaledZ),Wt=[dt.tileID.canonical.x*Vt%1,dt.tileID.canonical.y*Vt%1]):wt.bind(me,V.CLAMP_TO_EDGE),"useMipmap"in wt&&B.extTextureFilterAnisotropic&&y.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const Ht=y.transform;let ir;const Or=L?_2(Ht):[0,0,0,0];let vr,Mr,Tr,tn,yn,Wn=0;if(z&&X instanceof i.aK&&X.coordinates.length>3)vr=Float32Array.from(i.bc(i.cI(new i.bT(0,0,0)))),Mr=Float32Array.from(Ht.globeMatrix),Tr=Float32Array.from(i.cE(Ht)),tn=[i.av(Ht.center.lng),i.aC(Ht.center.lat)],ir=X.elevatedGlobePerspectiveTransform,yn=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(z){const or=i.cF(Ne.canonical);Wn=i.cG(or.getCenter().lat),vr=Float32Array.from(i.bc(i.cI(Ne.canonical))),Mr=Float32Array.from(Ht.globeMatrix),Tr=Float32Array.from(i.cE(Ht)),tn=[i.av(Ht.center.lng),i.aC(Ht.center.lat)],ir=[0,0],yn=Float32Array.from(i.cH(Ne.canonical,or,Wn,Ht.worldSize/Ht._pixelsPerMercatorPixel))}else ir=X instanceof i.aK?X.perspectiveTransform:[0,0],vr=new Float32Array(16),Mr=new Float32Array(9),Tr=new Float32Array(16),tn=[0,0],yn=new Float32Array(9);const Hr=Fb(xt,vr,Mr,Tr,yn,Wt||[0,0],i.ag(y.transform.zoom),tn,Or,Vt||1,Mt,u,ir,L?u.paint.get("raster-elevation"):0,2,Tt,Dt,Y.range,Qe,bt,re),li=y.isTileAffectedByFog(Ne),Lr=y.getOrCreateProgram("raster",{defines:Y.defines,overrideFog:li});if(y.uploadCommonUniforms(B,Lr,Ue),X instanceof i.aK){const or=X.elevatedGlobeVertexBuffer,on=X.elevatedGlobeIndexBuffer;if(ae||!A)X.boundsBuffer&&X.boundsSegments&&Lr.draw(y,V.TRIANGLES,Ye,Dr.disabled,ce,Ir.disabled,Hr,u.id,X.boundsBuffer,y.quadTriangleIndexBuffer,X.boundsSegments);else if(or&&on){const Mn=Ht.zoom<=i.c6?X.elevatedGlobeSegments:X.getSegmentsForLongitude(Ht.center.lng);Mn&&Lr.draw(y,V.TRIANGLES,Ye,Dr.disabled,ce,Ce,Hr,u.id,or,on,Mn)}}else if(z){Ye=new hr(V.LEQUAL,hr.ReadOnly,y.depthRangeFor3D);const or=y.globeSharedBuffers;if(or){const[on,Mn,cn]=or.getGridBuffers(Wn,!1);Lr.draw(y,V.TRIANGLES,Ye,Pe||gt,y.colorModeForRenderPass(),Ce,Hr,u.id,on,Mn,cn)}}else{const{tileBoundsBuffer:or,tileBoundsIndexBuffer:on,tileBoundsSegments:Mn}=y.getTileBoundsBuffers(dt);Lr.draw(y,V.TRIANGLES,Ye,gt,ce,Ir.disabled,Hr,u.id,or,on,Mn)}}if(!(X instanceof i.aK)&&z)for(const Ne of Me){const Ue=Ne.canonical.y===(1<<Ne.canonical.z)-1;Ne.canonical.y===0&&it(!0,Ne,y,s,u,re,Y,Ce,Pe||Dr.disabled),Ue&&it(!1,Ne,y,s,u,re,Y,Ce===Ir.frontCW?Ir.backCW:Ir.frontCW,Pe||Dr.disabled)}};z?Oe(Ee,y.renderElevatedRasterBackface?Ir.backCW:Ir.frontCW,y.stencilModeFor3D()):Oe(Ee,Ir.disabled,void 0),y.resetStencilClippingMasks()},"raster-particle":function(y,s,u,g,x,S){y.renderPass==="offscreen"&&function(A,L,z,B){if(!B.length)return;const V=A.context,X=V.gl,Y=L.getSource();if(!(Y instanceof Rc))return;const re=Math.ceil(Math.sqrt(z.paint.get("raster-particle-count")));let ce=z.particlePositionRGBAImage;if(!ce||ce.width!==re){const Ee=function(Te){const Oe=Te*Te,Me=new Uint8Array(4*Oe),Ce=function(Ne){return Ne|=0,Ne=Math.imul(2747636419^Ne,2654435769),Ne=Math.imul(Ne^Ne>>>16,2654435769),((Ne=Math.imul(Ne^Ne>>>16,2654435769))>>>0)/4294967296},Pe=1/1.1;for(let Ne=0;Ne<Oe;Ne++){const Ue=Pe*(Ce(2*Ne+0)+fs),dt=Pe*(Ce(2*Ne+1)+fs),et=255*Ue%1,wt=255*dt%1,Tt=et,Dt=dt-wt/255,Qe=wt;Me[4*Ne+0]=255*(Ue-et/255),Me[4*Ne+1]=255*Tt,Me[4*Ne+2]=255*Dt,Me[4*Ne+3]=255*Qe}return Me}(re);ce=z.particlePositionRGBAImage=new i.r({width:re,height:re},Ee)}let ae=z.particleFramebuffer;ae?ae.width!==re&&(ae.destroy(),ae=z.particleFramebuffer=V.createFramebuffer(re,re,!0,null)):ae=z.particleFramebuffer=V.createFramebuffer(re,re,!0,null);const fe=[];for(const Ee of B){const Te=L.getTile(Ee);if(!(Te instanceof Oa))continue;const Oe=x2(Te,Y,z);if(!Oe)continue;const Me=[Te.tileSize,Te.tileSize];let Ce=z.tileFramebuffer;Ce||(Ce=z.tileFramebuffer=V.createFramebuffer(Me[0],Me[1],!0,null));let Pe=Te.rasterParticleState;Pe||(Pe=Te.rasterParticleState=new Xb(V,Ee,Me,ce));const Ne=Pe.update(z.lastInvalidatedAt);Pe.particleTextureDimension!==re&&Pe.updateParticleTexture(Ee,ce);const Ue=Pe.targetColorTexture;Pe.targetColorTexture=Pe.backgroundColorTexture,Pe.backgroundColorTexture=Ue;const dt=Pe.particleTexture0;Pe.particleTexture0=Pe.particleTexture1,Pe.particleTexture1=dt,fe.push([Ee,Oe,Pe,Ne])}if(fe.length===0)return;const me=i.q.now(),be=z.previousDrawTimestamp?.001*(me-z.previousDrawTimestamp):.0167;if(z.previousDrawTimestamp=me,z.hasColorMap()){V.activeTexture.set(X.TEXTURE0+2);let Ee=z.colorRampTexture;Ee||(Ee=z.colorRampTexture=new i.T(V,z.colorRamp,X.RGBA8)),Ee.bind(X.LINEAR,X.CLAMP_TO_EDGE)}V.bindFramebuffer.set(z.tileFramebuffer.framebuffer),function(Ee,Te,Oe){const Me=Ee.context,Ce=Me.gl,Pe=Te.tileFramebuffer;Me.activeTexture.set(Ce.TEXTURE0);const Ne={u_texture:0,u_opacity:1.05*(dt=Te.paint.get("raster-particle-fade-opacity-factor"))/(dt+.05)},Ue=Ee.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var dt;for(const et of Oe){const[,,wt,Tt]=et;Pe.colorAttachment.set(wt.targetColorTexture.texture),Me.viewport.set([0,0,Pe.width,Pe.height]),Me.clear({color:i.al.transparent}),Tt&&(wt.backgroundColorTexture.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE),Ue.draw(Ee,Ce.TRIANGLES,hr.disabled,Dr.disabled,Xr.alphaBlended,Ir.disabled,Ne,Te.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments))}}(A,z,fe),function(Ee,Te,Oe,Me){const Ce=Ee.context,Pe=Ce.gl,Ne=Oe.tileFramebuffer,Ue=Ee.transform.projection.name==="globe",dt=Oe.paint.get("raster-particle-max-speed");for(const et of Me){const[wt,Tt,Dt]=et;Ce.activeTexture.set(Pe.TEXTURE0+0),Tt.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),Ne.colorAttachment.set(Dt.targetColorTexture.texture);const Qe=Ee.getOrCreateProgram("rasterParticleDraw",{defines:Tt.defines,overrideFog:!1});Ce.activeTexture.set(Pe.TEXTURE0+1);const bt=Tt.scalarData?[]:[0,1,2,3].map(gt=>i.d7[gt](wt));bt.push(wt);const Ye=wt.canonical.x,xt=wt.canonical.y;for(const gt of bt){const Et=Te.getTile(Ue?gt.wrapped():gt);if(!Et)continue;const ht=Et.rasterParticleState;if(!ht)continue;const Mt=gt.canonical.x+(1<<gt.canonical.z)*(gt.wrap-wt.wrap),Vt=gt.canonical.y;ht.particleTexture0.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE);const Wt=Bb(1,ht.particleTexture0.size[0],[Mt-Ye,Vt-xt],0,Tt.texture.size,2,dt,Tt.textureOffset,Tt.scale,Tt.offset);Qe.draw(Ee,Pe.POINTS,hr.disabled,Dr.disabled,Xr.alphaBlended,Ir.disabled,Wt,Oe.id,ht.particleIndexBuffer,void 0,ht.particleSegment)}}}(A,L,z,fe),V.bindFramebuffer.set(z.particleFramebuffer.framebuffer),function(Ee,Te,Oe,Me){const Ce=Ee.context,Pe=Ce.gl,Ne=Te.paint.get("raster-particle-max-speed"),Ue=Me*Te.paint.get("raster-particle-speed-factor")*.15,dt=function(wt){return Math.pow(wt,6)}(.01+1*Te.paint.get("raster-particle-reset-rate-factor")),et=Te.particleFramebuffer;Ce.viewport.set([0,0,et.width,et.height]);for(const wt of Oe){const[,Tt,Dt]=wt;Ce.activeTexture.set(Pe.TEXTURE0+0),Tt.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),Ce.activeTexture.set(Pe.TEXTURE0+1);const Qe=Dt.particleTexture0;Qe.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE);const bt=rD(1,Qe.size[0],0,Tt.texture.size,Ne,Ue,dt,Tt.textureOffset,Tt.scale,Tt.offset);et.colorAttachment.set(Dt.particleTexture1.texture),Ce.clear({color:i.al.transparent}),Ee.getOrCreateProgram("rasterParticleUpdate",{defines:Tt.defines}).draw(Ee,Pe.TRIANGLES,hr.disabled,Dr.disabled,Xr.unblended,Ir.disabled,bt,Te.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments)}}(A,z,fe,be)}(y,s,u,g),y.renderPass==="translucent"&&(function(A,L,z,B,V){const X=A.context,Y=X.gl,re=L.getSource().tileSize,ce=5*(1-i.ae(i.bY,i.bY+1,A.transform.zoom))*re+z.paint.get("raster-particle-elevation"),ae=!A.options.moving,fe=A.transform.projection.name==="globe";if(!B.length)return;const[me,be]=A.stencilConfigForOverlap(B),Ee=[];fe&&Ee.push("PROJECTION_GLOBE_VIEW");const Te=A.stencilModeFor3D();for(const Oe of be){const Me=Oe.toUnwrapped(),Ce=L.getTile(Oe);if(!Ce.rasterParticleState)continue;const Pe=Ce.rasterParticleState,Ne=100;Ce.registerFadeDuration(Ne);const Ue=L.findLoadedParent(Oe,0),dt=hv(Ce,Ue,L,A.transform,Ne);let et,wt;A.terrain&&A.terrain.prepareDrawTile(),X.activeTexture.set(Y.TEXTURE0),Pe.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),X.activeTexture.set(Y.TEXTURE1),Ue&&Ue.rasterParticleState?(Ue.rasterParticleState.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),et=Math.pow(2,Ue.tileID.overscaledZ-Ce.tileID.overscaledZ),wt=[Ce.tileID.canonical.x*et%1,Ce.tileID.canonical.y*et%1]):Pe.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Tt=fe?Float32Array.from(A.transform.expandedFarZProjMatrix):A.transform.calculateProjMatrix(Me,ae),Dt=A.transform,Qe=b2(Dt),bt=i.cF(Oe.canonical),Ye=i.cG(bt.getCenter().lat);let xt,gt,Et,ht,Mt;fe?(xt=Float32Array.from(i.bc(i.cI(Oe.canonical))),gt=Float32Array.from(Dt.globeMatrix),Et=Float32Array.from(i.cE(Dt)),ht=[i.av(Dt.center.lng),i.aC(Dt.center.lat)],Mt=Float32Array.from(i.cH(Oe.canonical,bt,Ye,Dt.worldSize/Dt._pixelsPerMercatorPixel))):(xt=new Float32Array(16),gt=new Float32Array(9),Et=new Float32Array(16),ht=[0,0],Mt=new Float32Array(9));const Vt=pr(Tt,xt,gt,Et,Mt,wt||[0,0],i.ag(A.transform.zoom),ht,Qe,et||1,dt,ce),Wt=A.isTileAffectedByFog(Oe),Ht=A.getOrCreateProgram("rasterParticle",{defines:Ee,overrideFog:Wt});if(A.uploadCommonUniforms(X,Ht,Me),fe){const ir=new hr(Y.LEQUAL,hr.ReadOnly,A.depthRangeFor3D),Or=0,vr=A.globeSharedBuffers;if(vr){const[Mr,Tr,tn]=vr.getGridBuffers(Ye,Or!==0);Ht.draw(A,Y.TRIANGLES,ir,Te,Xr.alphaBlended,A.renderElevatedRasterBackface?Ir.frontCCW:Ir.backCCW,Vt,z.id,Mr,Tr,tn)}}else{const ir=A.depthModeForSublayer(0,hr.ReadOnly),Or=me[Oe.overscaledZ],{tileBoundsBuffer:vr,tileBoundsIndexBuffer:Mr,tileBoundsSegments:Tr}=A.getTileBoundsBuffers(Ce);Ht.draw(A,Y.TRIANGLES,ir,Or,Xr.alphaBlended,Ir.disabled,Vt,z.id,vr,Mr,Tr)}}A.resetStencilClippingMasks()}(y,s,u,g),y.style.map.triggerRepaint())},background:function(y,s,u,g){const x=u.paint.get("background-color"),S=u.paint.get("background-color-use-theme").constantOr("default")==="none",A=u.paint.get("background-opacity"),L=u.paint.get("background-emissive-strength"),z=u.paint.get("background-pitch-alignment")==="viewport";if(A===0)return;const B=y.context,V=B.gl,X=y.transform,Y=X.tileSize,re=u.paint.get("background-pattern");let ce;if(re!==void 0&&(re===null||(ce=y.imageManager.getPattern(i.I.from(re.toString()),u.scope,y.style.getLut(u.scope)),!ce)))return;const ae=!re&&x.a===1&&A===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ae)return;const fe=Dr.disabled,me=y.depthModeForSublayer(0,ae==="opaque"?hr.ReadWrite:hr.ReadOnly),be=y.colorModeForDrapableLayerRenderPass(L),Ee=re?"backgroundPattern":"background";let Te,Oe=g;if(Oe||(Te=y.getBackgroundTiles(),Oe=Object.values(Te).map(Me=>Me.tileID)),re&&(B.activeTexture.set(V.TEXTURE0),y.imageManager.bind(y.context,u.scope)),z){const Me=y.getOrCreateProgram(Ee,{overrideFog:!1,overrideRtt:!0}),Ce=new Float32Array(i.ad.mat4.identity([])),Pe=new i.aH(0,0,0,0,0),Ne=re?g2(Ce,L,A,y,0,u.scope,ce,z,{tileID:Pe,tileSize:Y}):$b(Ce,L,A,x.toRenderColor(S?null:u.lut));Me.draw(y,V.TRIANGLES,me,fe,be,Ir.disabled,Ne,u.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments)}else for(const Me of Oe){const Ce=y.isTileAffectedByFog(Me),Pe=y.getOrCreateProgram(Ee,{overrideFog:Ce}),Ne=Me.toUnwrapped(),Ue=g?Me.projMatrix:y.transform.calculateProjMatrix(Ne);y.prepareDrawTile();const dt=s?s.getTile(Me):Te?Te[Me.key]:new xl(Me,Y,X.zoom,y),et=re?g2(Ue,L,A,y,0,u.scope,ce,z,{tileID:Me,tileSize:Y}):$b(Ue,L,A,x.toRenderColor(S?null:u.lut));y.uploadCommonUniforms(B,Pe,Ne);const{tileBoundsBuffer:wt,tileBoundsIndexBuffer:Tt,tileBoundsSegments:Dt}=y.getTileBoundsBuffers(dt);Pe.draw(y,V.TRIANGLES,me,fe,be,Ir.disabled,et,u.id,wt,Tt,Dt)}},sky:function(y,s,u){const g=y._atmosphere?i.ag(y.transform.zoom):1,x=u.paint.get("sky-opacity")*g;if(x===0)return;const S=y.context,A=u.paint.get("sky-type"),L=new hr(S.gl.LEQUAL,hr.ReadOnly,[0,1]),z=y.frameCounter/1e3%1;A==="atmosphere"?y.renderPass==="offscreen"?u.needsSkyboxCapture(y)&&(function(B,V,X,Y){const re=B.context,ce=re.gl;let ae=V.skyboxFbo;if(!ae){ae=V.skyboxFbo=re.createFramebuffer(32,32,!0,null),V.skyboxGeometry=new S2(re),V.skyboxTexture=re.gl.createTexture(),ce.bindTexture(ce.TEXTURE_CUBE_MAP,V.skyboxTexture),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MAG_FILTER,ce.LINEAR);for(let Ee=0;Ee<6;++Ee)ce.texImage2D(ce.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,ce.RGBA,32,32,0,ce.RGBA,ce.UNSIGNED_BYTE,null)}re.bindFramebuffer.set(ae.framebuffer),re.viewport.set([0,0,32,32]);const fe=V.getCenter(B,!0),me=B.getOrCreateProgram("skyboxCapture"),be=new Float64Array(16);i.ad.mat4.identity(be),i.ad.mat4.rotateY(be,be,.5*-Math.PI),ko(B,V,me,be,fe,0),i.ad.mat4.identity(be),i.ad.mat4.rotateY(be,be,.5*Math.PI),ko(B,V,me,be,fe,1),i.ad.mat4.identity(be),i.ad.mat4.rotateX(be,be,.5*-Math.PI),ko(B,V,me,be,fe,2),i.ad.mat4.identity(be),i.ad.mat4.rotateX(be,be,.5*Math.PI),ko(B,V,me,be,fe,3),i.ad.mat4.identity(be),ko(B,V,me,be,fe,4),i.ad.mat4.identity(be),i.ad.mat4.rotateY(be,be,Math.PI),ko(B,V,me,be,fe,5),re.viewport.set([0,0,B.width,B.height])}(y,u),u.markSkyboxValid(y)):y.renderPass==="sky"&&function(B,V,X,Y,re){const ce=B.context,ae=ce.gl,fe=B.transform,me=B.getOrCreateProgram("skybox");ce.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_CUBE_MAP,V.skyboxTexture);const be=((Ee,Te,Oe,Me,Ce)=>({u_matrix:Ee,u_sun_direction:Te,u_cubemap:0,u_opacity:Me,u_temporal_offset:Ce}))(fe.skyboxMatrix,V.getCenter(B,!1),0,Y,re);B.uploadCommonUniforms(ce,me),me.draw(B,ae.TRIANGLES,X,Dr.disabled,B.colorModeForRenderPass(),Ir.backCW,be,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(y,u,L,x,z):A==="gradient"&&y.renderPass==="sky"&&function(B,V,X,Y,re){const ce=B.context,ae=ce.gl,fe=B.transform,me=B.getOrCreateProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new S2(ce)),ce.activeTexture.set(ae.TEXTURE0);let be=V.colorRampTexture;be||(be=V.colorRampTexture=new i.T(ce,V.colorRamp,ae.RGBA8)),be.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const Ee=((Te,Oe,Me,Ce,Pe)=>({u_matrix:Te,u_color_ramp:0,u_center_direction:Oe,u_radius:i.ak(Me),u_opacity:Ce,u_temporal_offset:Pe}))(fe.skyboxMatrix,V.getCenter(B,!1),V.paint.get("sky-gradient-radius"),Y,re);B.uploadCommonUniforms(ce,me),me.draw(B,ae.TRIANGLES,X,Dr.disabled,B.colorModeForRenderPass(),Ir.backCW,Ee,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(y,u,L,x,z)},debug:function(y,s,u,g,x,S){for(let A=0;A<u.length;A++)if(x){const B=new i.al(g.r*.8,g.g*.8,g.b*.8,1);Zu(y,s,u[A],g,-1,-1,S),Zu(y,s,u[A],g,-1,1,S),Zu(y,s,u[A],g,1,1,S),Zu(y,s,u[A],g,1,-1,S),Zu(y,s,u[A],B,0,0,S)}else Zu(y,s,u[A],g,0,0,S)},custom:function(y,s,u,g){const x=y.context,S=u.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&u.isDraped(s)){if(y.renderPass==="offscreen"){const A=S.prerender;if(A){if(y.setCustomLayerDefaults(),x.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const L=y.transform.pointMerc;A.call(S,x.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),i.ag(y.transform.zoom),[L.x,L.y],y.transform.pixelsPerMeterRatio)}else A.call(S,x.gl,y.transform.customLayerMatrix());x.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const L=S.renderToTile;if(L){const z=g[0].canonical,B=new i.ac(z.x+g[0].wrap*(1<<z.z),z.y,z.z);x.setDepthMode(hr.disabled),x.setStencilMode(Dr.disabled),x.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),L.call(S,x.gl,B),x.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),x.setColorMode(y.colorModeForRenderPass()),x.setStencilMode(Dr.disabled);const A=S.renderingMode==="3d"?new hr(y.context.gl.LEQUAL,hr.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,hr.ReadOnly);if(x.setDepthMode(A),y.transform.projection.name==="globe"){const L=y.transform.pointMerc;S.render(x.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),i.ag(y.transform.zoom),[L.x,L.y],y.transform.pixelsPerMeterRatio)}else S.render(x.gl,y.transform.customLayerMatrix());x.setDirty(),y.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(y,s,u,g){if(y.renderPass==="opaque")return;const x=u.paint.get("model-opacity").constantOr(1);if(x===0)return;const S=u.paint.get("model-cast-shadows");if(y.renderPass==="shadow"&&(!S||y.terrain&&x<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof i.ab))return;const A=y.shadowRenderer,L=u.paint.get("model-receive-shadows");A&&(A.useNormalOffset=!0,L||(A.enabled=!1));const z=()=>{A&&(A.useNormalOffset=!0,L||(A.enabled=!0))},B=s.getSource();if(y.renderPass==="light-beam"&&B.type!=="batched-model")return;if(B.type==="vector"||B.type==="geojson")return function(me,be,Ee,Te,Oe){const Me=me.transform;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Me.projection.name} projection is not yet implemented`);const Ce=Me.getFreeCameraOptions().position;if(!me.modelManager)return;const Pe=me.modelManager;Ee.modelManager=Pe;const Ne=me.shadowRenderer;if(!Ee._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ue=Ee._unevaluatedLayout._values["model-id"],dt=Object.assign({},Ee.layout.get("model-id").parameters),et=me.style.order.indexOf(Ee.fqid);for(const wt of Te){const Tt=be.getTile(wt).getBucket(Ee);if(!Tt||Tt.projection.name!==Me.projection.name)continue;const Dt=Tt.getModelUris();Dt&&!Tt.modelsRequested&&(Pe.addModelsFromBucket(Dt,Oe),Tt.modelsRequested=!0);const Qe=Qb(wt,Me);dt.zoom=Qe;const bt=Ue.possiblyEvaluate(dt);if(Jb(me,Tt,wt),Us.shadowUniformsInitialized=!1,Us.useSingleShadowCascade=!!Ne&&Ne.getMaxCascadeForTile(wt.toUnwrapped())===0,me.renderPass==="shadow"&&Ne){if(me.currentShadowCascade===1&&Tt.isInsideFirstShadowMapFrustum)continue;const gt=Me.calculatePosMatrix(wt.toUnwrapped(),Me.worldSize);if(Us.tileMatrix.set(gt),Us.shadowTileMatrix=Float32Array.from(Ne.calculateShadowPassMatrixFromMatrix(gt)),Us.aabb.min.fill(0),Us.aabb.max[0]=Us.aabb.max[1]=i.ai,Us.aabb.max[2]=0,Mv(Tt,Us,me,Ee.scope))continue}const Ye=1<<wt.canonical.z,xt=[((Ce.x-wt.wrap)*Ye-wt.canonical.x)*i.ai,(Ce.y*Ye-wt.canonical.y)*i.ai,Ce.z*Ye*i.ai];me.conflationActive&&Object.keys(Tt.instancesPerModel).length>0&&me.style.isLayerClipped(Ee,be.getSource())&&Tt.updateReplacement(wt,me.replacementSource,et,Oe)&&(Tt.uploaded=!1,Tt.upload(me.context));for(let gt in Tt.instancesPerModel){const Et=Tt.instancesPerModel[gt];Et.features.length>0&&(gt=bt.evaluate(Et.features[0].feature,{}));const ht=Pe.getModel(gt,Oe);if(ht&&ht.uploaded)for(const Mt of ht.nodes)Tl(me,Ee,Mt,Et,xt,wt,Us)}}}(y,s,u,g,B.type==="vector"?u.scope:""),void z();if(!B.loaded())return;if(B.type==="batched-model")return function(me,be,Ee,Te){Ee.resetLayerRenderingStats(me);const Oe=me.context,Me=me.transform,Ce=me.style.fog,Pe=me.shadowRenderer;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Me.projection.name} projection is not yet implemented`);const Ne=me.transform.getFreeCameraOptions().position,Ue=i.ad.vec3.scale([],[Ne.x,Ne.y,Ne.z],me.transform.worldSize),dt=i.ad.vec3.negate([],Ue),et=i.ad.mat4.identity([]),wt=i.dm(Me.center.lat,Me.zoom),Tt=i.ad.mat4.fromScaling([],[1,1,1/wt]);i.ad.mat4.translate(et,et,dt);const Dt=Ee.paint.get("model-opacity").constantOr(1),Qe=new hr(Oe.gl.LEQUAL,hr.ReadWrite,me.depthRangeFor3D),bt=new hr(Oe.gl.LEQUAL,hr.ReadOnly,me.depthRangeFor3D),Ye=new i.ce([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),xt=me.renderPass==="shadow",gt=xt&&Pe?Pe.getCurrentCascadeFrustum():Me.getFrustum(Me.scaleZoom(Me.worldSize)),Et=Ee.paint.get("model-front-cutoff"),ht=Et[2]<1,Mt=Bc(me,Ee.paint.get("model-cutoff-fade-range")),Vt=Ee.getLayerRenderingStats();(function(Wt,Ht,ir,Or){const vr=Wt.terrain?Wt.terrain.exaggeration():0,Mr=Wt.transform.zoom;for(const Tr of Or){const tn=Ht.getTile(Tr).getBucket(ir);tn&&(tn.setFilter(ir.filter),Wt.conflationActive&&tn.updateReplacement(Tr,Wt.replacementSource),tn.evaluateScale(Wt,ir),Wt.terrain&&vr>0&&tn.elevationUpdate(Wt.terrain,vr,Tr,ir.source),tn.needsReEvaluation(Wt,Mr,ir)&&tn.evaluate(ir))}})(me,be,Ee,Te),function(){let Wt,Ht,ir;ht?(Wt=Te.length-1,Ht=-1,ir=-1):(Wt=0,Ht=Te.length,ir=1);const Or=new Float64Array(16),vr=i.ad.vec3.create(),Mr=new i.P(0,0);for(let Tr=Wt;Tr!==Ht;Tr+=ir){const tn=Te[Tr],yn=be.getTile(tn).getBucket(Ee);if(!yn||!yn.uploaded)continue;let Wn=!1;Pe&&(Wn=Pe.getMaxCascadeForTile(tn.toUnwrapped())===0);const Hr=Me.calculatePosMatrix(tn.toUnwrapped(),Me.worldSize),li=yn.modelTraits;!xt&&ht&&(i.ad.mat4.invert(Or,Hr),i.ad.vec3.transformMat4(vr,Ue,Or),Mr.x=vr[0],Mr.y=vr[1]);const Lr=[];yn.setFilter(Ee.filter);for(const or of yn.getNodesInfo()){if(or.hiddenByReplacement||!or.node.meshes)continue;const on=or.node;let Mn=0;me.terrain&&on.elevation&&(Mn=on.elevation*me.terrain.exaggeration());const cn=(()=>{const Nn=or.aabb;return Ye.min=[...Nn.min],Ye.max=[...Nn.max],Ye.min[2]+=Mn,Ye.max[2]+=Mn,i.ad.vec3.transformMat4(Ye.min,Ye.min,Hr),i.ad.vec3.transformMat4(Ye.max,Ye.max,Hr),Ye})(),Ti=or.evaluatedScale;if(Ti[0]<=1&&Ti[1]<=1&&Ti[2]<=1&&cn.intersects(gt)===0)continue;if(!xt&&ht){const Nn=.16666666666666666;or.cameraCollisionOpacity=Ue[0]>cn.min[0]&&Ue[0]<cn.max[0]&&Ue[1]>cn.min[1]&&Ue[1]<cn.max[1]&&Ue[2]*wt<cn.max[2]&&on.footprint&&i.bA(Mr,on.footprint)?Math.max(or.cameraCollisionOpacity-Nn,0):Math.min(1,or.cameraCollisionOpacity+Nn)}const Hi=[...Hr],ho=on.anchor?on.anchor[0]:0,_o=on.anchor?on.anchor[1]:0;i.ad.mat4.translate(Hi,Hi,[ho*(Ti[0]-1),_o*(Ti[1]-1),Mn]),i.ad.vec3.exactEquals(Ti,i.dq)||i.ad.mat4.scale(Hi,Hi,Ti);const gs=i.ad.mat4.multiply([],Hi,on.matrix),la=i.ad.mat4.multiply([],Me.expandedFarZProjMatrix,gs),sn=i.ad.mat4.multiply([],Me.expandedFarZProjMatrix,Hi),ci=i.ad.vec4.transformMat4([],[ho,_o,Mn,1],la)[2];on.hidden=!1;let vn=Dt;xt||(ht&&(vn*=or.cameraCollisionOpacity,vn*=e1(Hi,Me,or.aabb,Et)),vn*=Cv(Mt,ci)),vn!==0?Lr.push({nodeInfo:or,depth:ci,opacity:vn,wvpForNode:la,wvpForTile:sn,nodeModelMatrix:gs,tileModelMatrix:Hi}):on.hidden=!0}xt||Lr.sort((or,on)=>!ht||or.opacity===1&&on.opacity===1?or.depth<on.depth?-1:1:or.opacity===1?-1:on.opacity===1?1:or.depth>on.depth?-1:1);for(const or of Lr){const on=or.nodeInfo,Mn=on.node;let cn=i.ad.mat4.multiply([],Tt,or.tileModelMatrix);i.ad.mat4.multiply(cn,et,cn);const Ti=i.ad.mat4.invert([],cn);i.ad.mat4.transpose(Ti,Ti),i.ad.mat4.scale(Ti,Ti,Xu),cn=i.ad.mat4.multiply(cn,cn,Mn.matrix);const Hi=me.renderPass==="light-beam",ho=Ee.paint.get("model-color-use-theme").constantOr("default")==="none",_o=li&i.ds.HasMapboxMeshFeatures,gs=_o?0:on.evaluatedRMEA[0][2];for(let la=0;la<Mn.meshes.length;++la){const sn=Mn.meshes[la],ci=la===Mn.lightMeshIndex;let vn=or.wvpForNode;if(ci){if(!Hi&&!me.terrain&&me.shadowRenderer){me.currentLayer<me.firstLightBeamLayer&&(me.firstLightBeamLayer=me.currentLayer);continue}vn=or.wvpForTile}else if(Hi)continue;const Nn={defines:[]},Uo=[];if(!xt&&Pe&&(Pe.useNormalOffset=!!sn.normalBuffer),Lf(Nn.defines,Uo,sn,me,ho?null:Ee.lut),_o||Nn.defines.push("DIFFUSE_SHADED"),Wn&&Nn.defines.push("SHADOWS_SINGLE_CASCADE"),Vt&&(xt?Vt.numRenderedVerticesInShadowPass+=sn.vertexArray.length:Vt.numRenderedVerticesInTransparentPass+=sn.vertexArray.length),xt){Km(sn,or.nodeModelMatrix,me,Ee);continue}let ti=null;if(Ce){const Gs=Gc(or.nodeModelMatrix,me.transform);if(ti=new Float32Array(Gs),Me.projection.name!=="globe"){const Za=sn.aabb.min,Zc=sn.aabb.max,[sc,Xc]=Ce.getOpacityForBounds(Gs,Za[0],Za[1],Zc[0],Zc[1]);Nn.overrideFog=sc>=Xt||Xc>=Xt}}const fo=sn.material;let ac;fo.occlusionTexture&&fo.occlusionTexture.offsetScale&&(ac=fo.occlusionTexture.offsetScale,Nn.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Ha=me.getOrCreateProgram("model",Nn);!xt&&Pe&&Pe.setupShadowsFromMatrix(or.tileModelMatrix,Ha,Pe.useNormalOffset),me.uploadCommonUniforms(Oe,Ha,null,ti);const Ws=fo.pbrMetallicRoughness;Ws.metallicFactor=.9,Ws.roughnessFactor=.5;const Ra=Ub(new Float32Array(vn),new Float32Array(cn),new Float32Array(Ti),new Float32Array(Mn.matrix),me,or.opacity,Ws.baseColorFactor.toRenderColor(null),fo.emissiveFactor,Ws.metallicFactor,Ws.roughnessFactor,fo,gs,Ee,[0,0,0],ac);!ci&&(on.hasTranslucentParts||or.opacity<1)&&Ha.draw(me,Oe.gl.TRIANGLES,Qe,Dr.disabled,Xr.disabled,Ir.backCCW,Ra,Ee.id,sn.vertexBuffer,sn.indexBuffer,sn.segments,Ee.paint,me.transform.zoom,void 0,Uo),Ha.draw(me,Oe.gl.TRIANGLES,ci?bt:Qe,Dr.disabled,ci||or.opacity<1||on.hasTranslucentParts?Xr.alphaBlended:Xr.unblended,Ir.backCCW,Ra,Ee.id,sn.vertexBuffer,sn.indexBuffer,sn.segments,Ee.paint,me.transform.zoom,void 0,Uo)}}}}()}(y,s,u,g),void z();if(B.type!=="model")return;const V=B.getModels(),X=[],Y=y.transform.getFreeCameraOptions().position,re=i.ad.vec3.scale([],[Y.x,Y.y,Y.z],y.transform.worldSize);i.ad.vec3.negate(re,re);const ce=[],ae=[];let fe=0;for(const me of V){const be=u.paint.get("model-rotation").constantOr(null),Ee=u.paint.get("model-scale").constantOr(null),Te=u.paint.get("model-translation").constantOr(null);me.computeModelMatrix(y,be,Ee,Te,!0,!0,!1);const Oe=i.ad.mat4.identity([]),Me=i.dm(me.position.lat,y.transform.zoom),Ce=i.ad.mat4.fromScaling([],[1,1,1/Me]);i.ad.mat4.translate(Oe,Oe,re),X.push({zScaleMatrix:Ce,negCameraPosMatrix:Oe});for(const Pe of me.nodes)Jd(y.transform,Pe,me.matrix,y.transform.expandedFarZProjMatrix,fe,ce,ae);fe++}if(ce.sort((me,be)=>be.depth-me.depth),y.renderPass!=="shadow"){if(x===1)for(const me of ae)qc(me,y,u,X[me.modelIndex],Dr.disabled,y.colorModeForRenderPass());else{for(const me of ae)qc(me,y,u,X[me.modelIndex],Dr.disabled,Xr.disabled);for(const me of ae)qc(me,y,u,X[me.modelIndex],y.stencilModeFor3D(),y.colorModeForRenderPass());y.resetStencilClippingMasks()}for(const me of ce)qc(me,y,u,X[me.modelIndex],Dr.disabled,y.colorModeForRenderPass());z()}else{for(const me of ae)Km(me.mesh,me.nodeModelMatrix,y,u);for(const me of ce)Km(me.mesh,me.nodeModelMatrix,y,u);z()}}},kv={line:function(y,s,u){if(y.hasElevatedBuckets=!1,y.hasNonElevatedBuckets=!1,y._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||y._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const g=s.getVisibleCoordinates();for(const x of g){const S=s.getTile(x).getBucket(y);if(S&&(S.hasZOffset?y.hasElevatedBuckets=!0:y.hasNonElevatedBuckets=!0,y.hasElevatedBuckets&&y.hasNonElevatedBuckets))break}}}else y.hasNonElevatedBuckets=!0},model:function(y,s,u){const g=s.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,g.type==="vector"?y.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const x=g.getModels();for(const S of x)S.upload(u.context)},raster:function(y,s,u){const g=s.getSource();if(!(g instanceof Rc&&g.loaded()))return;const x=y.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const S=y.paint.get("raster-array-band")||g.getInitialBand(x);if(S==null)return;const A=s.getIds().map(L=>s.getTileByID(L));for(const L of A)L.updateNeeded(x,S)&&g.prepareTile(L,x,S)},"raster-particle":function(y,s,u){const g=s.getSource();if(!(g instanceof Rc&&g.loaded()))return;const x=y.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const S=y.paint.get("raster-particle-array-band")||g.getInitialBand(x);if(S==null)return;const A=s.getIds().map(L=>s.getTileByID(L));for(const L of A)L.updateNeeded(x,S)&&g.prepareTile(L,x,S)}},Rv={fill:Hb};class Dv{constructor(s,u,g,x,S){this.context=new Hu(s,u),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const A=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const z of A)this._debugParams.enabledLayers[z]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const z of A)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],z);this.occlusionParams=new r1(S),this.setup(),this.numSublayers=js.maxUnderzooming+js.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dy,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new $c(this),this._wireframeDebugCache=new Qd,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const L=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,L,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x}updateTerrain(s,u){const g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new u2(this,s));const x=this._terrain;this.transform.elevation=g?x:null,x.update(s,this.transform,u),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(s){const u=s.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=u.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const S=g+.78*(x-g);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new u2(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,u){if(this.width=s*i.q.devicePixelRatio,this.height=u*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const s=this.context,u=new i.b5;u.emplaceBack(0,0),u.emplaceBack(i.ai,0),u.emplaceBack(0,i.ai),u.emplaceBack(i.ai,i.ai),this.tileExtentBuffer=s.createVertexBuffer(u,i.b7.members),this.tileExtentSegments=i.b8.simpleSegment(0,0,4,2);const g=new i.b5;g.emplaceBack(0,0),g.emplaceBack(i.ai,0),g.emplaceBack(0,i.ai),g.emplaceBack(i.ai,i.ai),this.debugBuffer=s.createVertexBuffer(g,i.b7.members),this.debugSegments=i.b8.simpleSegment(0,0,4,5);const x=new i.b5;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(x,i.b7.members),this.viewportSegments=i.b8.simpleSegment(0,0,4,2);const S=new i.aU;S.emplaceBack(0,0,0,0),S.emplaceBack(i.ai,0,i.ai,0),S.emplaceBack(0,i.ai,0,i.ai),S.emplaceBack(i.ai,i.ai,i.ai,i.ai),this.mercatorBoundsBuffer=s.createVertexBuffer(S,i.ba.members),this.mercatorBoundsSegments=i.b8.simpleSegment(0,0,4,2);const A=new i.aV;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(A);const L=new i.b6;for(const B of[0,1,3,2,0])L.emplaceBack(B);this.debugIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new i.T(s,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=i.ad.mat4.create();const z=this.context.gl;this.stencilClearMode=new Dr({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,hr.disabled,this.stencilClearMode,Xr.disabled,Ir.disabled,Sf(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,u,g){if(!u||this.currentStencilSource===u.id||!s.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const z of g)if(this._tileClippingMaskIDs[z.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=u.id;const x=this.context,S=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(Xr.disabled),x.setDepthMode(hr.disabled);const A=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of g){const z=u.getTile(L),B=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:X,tileBoundsSegments:Y}=this.getTileBoundsBuffers(z);A.draw(this,S.TRIANGLES,hr.disabled,new Dr({func:S.ALWAYS,mask:0},B,255,S.KEEP,S.KEEP,S.REPLACE),Xr.disabled,Ir.disabled,Sf(L.projMatrix),"$clipping",V,X,Y)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new Dr({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const u=this.context.gl;return new Dr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(s){const u=this.context.gl,g=s.sort((A,L)=>L.overscaledZ-A.overscaledZ),x=g[g.length-1].overscaledZ,S=g[0].overscaledZ-x+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const A={};for(let L=0;L<S;L++)A[L+x]=new Dr({func:u.GEQUAL,mask:255},L+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=S,[A,g]}return[{[x]:Dr.disabled},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Xr([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new i.al(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xr.unblended:Xr.alphaBlended}colorModeForDrapableLayerRenderPass(s){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Xr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new i.al(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,u,g,x=!1){if(this.depthOcclusion)return new hr(this.context.gl.GREATER,hr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return hr.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new hr(g||this.context.gl.LEQUAL,u,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,u=Math.ceil(this.width),g=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),S=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&g!==0&&(this.depthFBO=new ka(this.context,u,g,!1,"texture"),this.depthTexture=new i.T(this.context,{width:u,height:g,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),s.bindTexture(s.TEXTURE_2D,S),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,u,g,0,0,u,g,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,u)=>s+u/this._fpsHistory.length,0))}render(s,u){const g=i.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=u;const x=this.style._mergedLayers,S=!(!this.terrain||!this.terrain.enabled),A=()=>this.style._getOrder(S).filter(Qe=>{const bt=x[Qe];return!(bt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[bt.type]});let L=A(),z=!1,B=!1;for(const Qe of L){const bt=x[Qe];bt.type==="circle"&&(z=!0),bt.type==="symbol"&&(bt.hasInitialOcclusionOpacityProperties?B=!0:z=!0)}let V=L.map(Qe=>x[Qe]);const X=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let Y=0,re=!1;for(const Qe in X){const bt=X[Qe];bt.used&&(bt.prepare(this.context),bt.getSource().usedInConflation&&++Y)}let ce=!1;for(const Qe of V)Qe.isHidden(this.transform.zoom)||(Qe.type==="clip"&&(ce=!0),this.prepareLayer(Qe));const ae={},fe={},me={},be={},Ee={};for(const Qe in X){const bt=X[Qe];ae[Qe]=bt.getVisibleCoordinates(),fe[Qe]=ae[Qe].slice().reverse(),me[Qe]=bt.getVisibleCoordinates(!0).reverse(),be[Qe]=bt.getShadowCasterCoordinates(),Ee[Qe]=bt.sortCoordinatesByDistance(ae[Qe])}const Te=Qe=>{const bt=this.style.getLayerSourceCache(Qe);return bt&&bt.used?bt.getSource():null};if(Y||ce||this._clippingActiveLastFrame){const Qe=[],bt=[];let Ye=0;for(const xt of V)this.isSourceForClippingOrConflation(xt,Te(xt))&&(Qe.push(xt),bt.push(Ye)),Ye++;if(Qe&&(ce||Qe.length>1)||this._clippingActiveLastFrame){ce=!1;const xt=[];for(let gt=0;gt<Qe.length;gt++){const Et=Qe[gt],ht=bt[gt],Mt=this.style.getLayerSourceCache(Et);if(!Mt||!Mt.used||!Mt.getSource().usedInConflation&&Et.type!=="clip")continue;let Vt=i.dA,Wt=i.by.None;const Ht=[];let ir=!0;if(Et.type==="clip"){Vt=ht;for(const Or of Et.layout.get("clip-layer-types"))Wt|=Or==="model"?i.by.Model:Or==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const Or of Et.layout.get("clip-layer-scope"))Ht.push(Or);Et.isHidden(this.transform.zoom)?ir=!1:ce=!0}ir&&xt.push({layer:Et.fqid,cache:Mt,order:Vt,clipMask:Wt,clipScope:Ht})}this.replacementSource.setSources(xt),re=!0}}this._clippingActiveLastFrame=ce,re||this.replacementSource.clear(),this.conflationActive=re,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Qe=0;Qe<V.length;Qe++){const bt=V[Qe],Ye=bt.cutoffRange();if(this.longestCutoffRange=Math.max(Ye,this.longestCutoffRange),Ye>0){const xt=Te(bt);xt&&(this.minCutoffZoom=Math.max(xt.minzoom,this.minCutoffZoom)),bt.minzoom&&(this.minCutoffZoom=Math.max(bt.minzoom,this.minCutoffZoom))}bt.is3D(S)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Qe),this._lastOcclusionLayer=Qe)}const Oe=this.style&&this.style.fog;Oe?(this._fogVisible=Oe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Oe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(me),this.opaquePassCutoff=0,L=A(),V=L.map(Qe=>x[Qe]));const Me=this._shadowRenderer;if(Me){Me.updateShadowParameters(this.transform,this.style.directionalLight);for(const Qe in X)for(const bt of ae[Qe]){let Ye={min:0,max:0};this.terrain&&(Ye=this.terrain.getMinMaxForTile(bt)||Ye),Me.addShadowReceiver(bt.toUnwrapped(),Ye.min,Ye.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dz(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new T2(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ce=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Pe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ce&&!this._snow&&(this._snow=new Nf(this)),!Ce&&this._snow&&(this._snow.destroy(),delete this._snow),Pe&&!this._rain&&(this._rain=new a1(this)),!Pe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!cr.has(this.context.gl))return;this.renderPass="offscreen";for(const Qe of V){const bt=s.getLayerSourceCache(Qe);if(!Qe.hasOffscreenPass()||Qe.isHidden(this.transform.zoom))continue;const Ye=bt?fe[bt.id]:void 0;(Qe.type==="custom"||Qe.type==="raster"||Qe.type==="raster-particle"||Qe.isSky()||Ye&&Ye.length)&&this.renderLayer(this,bt,Qe,Ye)}this.depthRangeFor3D=[0,1-(V.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,be)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ne=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ue=(()=>{if(u.showOverdrawInspector)return i.al.black;const Qe=this.style.fog;if(Qe&&this.transform.projection.supportsFog){const bt=this.style.getLut(Qe.scope);if(!Ne){const Ye=Qe.properties.get("color-use-theme")==="none",xt=Qe.properties.get("color").toRenderColor(Ye?null:bt).toArray01();return new i.al(...xt)}if(Ne){const Ye=Qe.properties.get("space-color-use-theme")==="none",xt=Qe.properties.get("space-color").toRenderColor(Ye?null:bt).toArray01();return new i.al(...xt)}}return i.al.transparent})();if(this.context.clear({color:Ue,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const Qe=V[this.currentLayer],bt=s.getLayerSourceCache(Qe);if(Qe.isSky())continue;const Ye=bt?(Qe.is3D(S)?Ee:fe)[bt.id]:void 0;this._renderTileClippingMasks(Qe,bt,Ye),this.renderLayer(this,bt,Qe,Ye)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ag(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Qe=V[this.currentLayer],bt=s.getLayerSourceCache(Qe);Qe.isSky()&&this.renderLayer(this,bt,Qe,bt?fe[bt.id]:void 0)}function dt(Qe,bt){let Ye;return bt&&(Ye=(Qe.type==="symbol"?me:Qe.is3D(S)?Ee:fe)[bt.id]),Ye}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<L.length;){const Qe=V[this.currentLayer];if(Qe.type==="raster"||Qe.type==="raster-particle"){const bt=s.getLayerSourceCache(Qe);this.renderLayer(this,bt,Qe,dt(Qe,bt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let et=0;Me&&(et=Me.getShadowCastingLayerCount());let wt=!1,Tt=-1;for(let Qe=0;Qe<L.length;++Qe){const bt=V[Qe];bt.isHidden(this.transform.zoom)||bt.is3D(S)&&(Tt=Qe)}B&&Tt===-1&&(z=!0);let Dt=!1;for(;this.currentLayer<L.length;){const Qe=V[this.currentLayer],bt=s.getLayerSourceCache(Qe);if(Qe.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Qe)){if(Qe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Dt&&Qe.is3D(S)&&!S){const Ye=this.currentLayer,xt=gt=>{for(this.currentLayer=0;this.currentLayer<V.length;this.currentLayer++){const Et=V[this.currentLayer];if(Rv[Et.type]){const ht=this.style.getLayerSourceCache(Et);Rv[Et.type](this,ht,Et,dt(Et,ht),gt)}}};xt("initialize"),xt("reset"),this.currentLayer=Ye,Dt=!0}if(z&&!wt&&this.terrain&&!this.transform.isOrthographic&&(wt=!0,this.blitDepth()),B&&Tt!==-1&&this.currentLayer===Tt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Qe,bt,bt?ae[bt.id]:void 0),this.renderLayer(this,bt,Qe,dt(Qe,bt)),!this.terrain&&Me&&et>0&&Qe.hasShadowPass()&&--et==0&&(Me.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ye=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ye;this.currentLayer++){const xt=V[this.currentLayer];if(!xt.hasLightBeamPass())continue;const gt=s.getLayerSourceCache(xt);this.renderLayer(this,gt,xt,gt?fe[gt.id]:void 0)}this.currentLayer=Ye,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ye=this.currentLayer;this.depthOcclusion=!0;for(const xt of this.layersWithOcclusionOpacity){this.currentLayer=xt;const gt=V[this.currentLayer],Et=s.getLayerSourceCache(gt),ht=Et?fe[Et.id]:void 0;this.terrain||this._renderTileClippingMasks(gt,Et,Et?ae[Et.id]:void 0),this.renderLayer(this,Et,gt,ht)}this.depthOcclusion=!1,this.currentLayer=Ye,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Qe=null;V.forEach(bt=>{const Ye=s.getLayerSourceCache(bt);Ye&&!bt.isHidden(this.transform.zoom)&&Ye.getVisibleCoordinates().length&&(!Qe||Qe.getSource().maxzoom<Ye.getSource().maxzoom)&&(Qe=Ye)}),Qe&&this.options.showTileBoundaries&&Qm.debug(this,Qe,Qe.getVisibleCoordinates(),i.al.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Qm.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.al(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Qe){const bt=Qe.transform.padding;Yb(Qe,Qe.transform.height-(bt.top||0),3,Rf),Yb(Qe,bt.bottom||0,3,nD),Kb(Qe,bt.left||0,3,iD),Kb(Qe,Qe.transform.width-(bt.right||0),3,w2);const Ye=Qe.transform.centerPoint;(function(xt,gt,Et,ht){Kd(xt,gt-1,Et-10,2,20,ht),Kd(xt,gt-10,Et-1,20,2,ht)})(Qe,Ye.x,Qe.transform.height-Ye.y,Ev)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),re||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:u}=this.transform.projection,g=!u||!u.includes(s.type);if(kv[s.type]&&(g||this.terrain&&s.type==="custom")){const x=this.style.getLayerSourceCache(s);kv[s.type](s,x,this)}this.gpuTimingEnd()}renderLayer(s,u,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(g.type)&&(!s.terrain||g.type!=="custom")||g.type==="clip"||Qm[g.type](s,u,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,g=this.context.gl;let x=this.gpuTimers[s.id];x||(x=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:g.createQuery()}),x.calls++,g.beginQuery(u.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,u=this.context.gl,g=u.createQuery();this.deferredRenderGpuTimeQueries.push(g),u.beginQuery(s.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const u={};for(const g in s){const x=s[g],S=this.context.extTimerQuery,A=S.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(x.query),u[g]=A}return u}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let g=0;for(const x of s)g+=u.getQueryParameter(x,u.QUERY_RESULT)/1e6,u.deleteQuery(x);return g}translatePosMatrix(s,u,g,x,S){if(!g[0]&&!g[1])return s;const A=S?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(A){const B=Math.sin(A),V=Math.cos(A);g=[g[0]*V-g[1]*B,g[0]*B+g[1]*V]}const L=[S?g[0]:i.at(u,g[0],this.transform.zoom),S?g[1]:i.at(u,g[1],this.transform.zoom),0],z=new Float32Array(16);return i.ad.mat4.translate(z,s,L),z}saveTileTexture(s){const u=s.size[0],g=this._tileTextures[u];g?g.push(s):this._tileTextures[u]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,u,g){const x=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,S=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||S.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||x||u!==void 0&&!u||S.push("FOG","FOG_DITHERING"),x&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(s,u){this.cache=this.cache||{};const g=u&&u.defines||[],x=u&&u.config,S=this.currentGlobalDefines(s,u&&u.overrideFog,u&&u.overrideRtt).concat(g),A=h2.cacheKey(Um[s],s,S,x);return this.cache[A]||(this.cache[A]=new h2(this.context,s,Um[s],x,Vb[s],S)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,u){if(this.style.enable3dLights()){const g=this.style.directionalLight,x=this.style.ambientLight;if(g&&x){const S=((A,L,z)=>{const B=A.properties.get("direction"),V=A.properties.get("color-use-theme")==="none",X=A.properties.get("color").toRenderColor(V?null:z.getLut(A.scope)).toArray01(),Y=A.properties.get("intensity"),re=L.properties.get("color-use-theme")==="none",ce=L.properties.get("color").toRenderColor(re?null:z.getLut(L.scope)).toArray01(),ae=L.properties.get("intensity"),fe=[B.x,B.y,B.z],me=i.cN(ce,ae),be=i.cN(X,Y);return{u_lighting_ambient_color:me,u_lighting_directional_dir:fe,u_lighting_directional_color:be,u_ground_radiance:d2(fe,be,me)}})(g,x,this.style);u.setLightsUniformValues(s,S)}}}uploadCommonUniforms(s,u,g,x,S){if(this.uploadCommonLightUniforms(s,u),this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const L=A.getOpacity(this.transform.pitch),z=((B,V,X,Y,re,ce,ae,fe,me,be,Ee,Te)=>{const Oe=B.transform,Me=V.properties.get("color-use-theme")==="none",Ce=V.properties.get("color").toRenderColor(Me?null:B.style.getLut(V.scope)).toArray01();Ce[3]=Y;const Pe=B.frameCounter/1e3%1,[Ne,Ue]=V.properties.get("vertical-range");return{u_fog_matrix:X?Oe.calculateFogTileMatrix(X):Te||B.identityMat,u_fog_range:V.getFovAdjustedRange(Oe._fov),u_fog_color:Ce,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ne,Ue),Ue],u_fog_temporal_offset:Pe,u_frustum_tl:re,u_frustum_tr:ce,u_frustum_br:ae,u_frustum_bl:fe,u_globe_pos:me,u_globe_radius:be,u_viewport:Ee,u_globe_transition:i.ag(Oe.zoom),u_is_globe:+(Oe.projection.name==="globe")}})(this,A,g,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],x);u.setFogUniformValues(s,z)}S&&u.setCutoffUniformValues(s,S.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,u=s.createTexture();return s.bindTexture(s.TEXTURE_2D,u),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)u[x.key]=s[x.key]||new xl(x,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,u){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[s.key];return u||(this._cachedTileFogOpacities[s.key]=u=this.style.fog.getOpacityForTile(s)),u[0]>=Xt||u[1]>=Xt}setupDepthForOcclusion(s,u,g){const x=this.context,S=x.gl,A=!!g;var L;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(S.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((L=this.depthRangeFor3D)[1]-L[0]),-1-2*L[0]/(L[1]-L[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),x.activeTexture.set(S.TEXTURE0),A||u.setTerrainUniformValues(x,g)}}function Lv(y,s){let u=!1,g=null;const x=()=>{g=null,u&&(y(),g=setTimeout(x,s),u=!1)};return()=>(u=!0,g||x(),g)}class l1{constructor(s){this._hashName=s&&encodeURIComponent(s),i.aQ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Lv(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const u=c1(s);if(this._hashName){const g=this._hashName;let x=!1;const S=location.hash.slice(1).split("&").map(A=>{const L=A.split("=")[0];return L===g?(x=!0,`${L}=${u}`):A}).filter(A=>A);return x||S.push(`${g}=${u}`),`#${S.join("&")}`}return`#${u}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(g))){const g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(u[3]||0):s.getBearing();return s.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function c1(y,s){const u=y.getCenter(),g=Math.round(100*y.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,x),A=Math.round(u.lng*S)/S,L=Math.round(u.lat*S)/S,z=y.getBearing(),B=y.getPitch();let V=s?`/${A}/${L}/${g}`:`${g}/${L}/${A}`;return(z||B)&&(V+="/"+Math.round(10*z)/10),B&&(V+=`/${Math.round(B)}`),V}const eg={linearity:.3,easing:i.dB(0,0,.3,1)},E2=i.l({deceleration:2500,maxSpeed:1400},eg),A2=i.l({deceleration:20,maxSpeed:1400},eg),M2=i.l({deceleration:1e3,maxSpeed:360},eg),C2=i.l({deceleration:1e3,maxSpeed:90},eg);class P2{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=i.q.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)u.zoom+=S.zoomDelta||0,u.bearing+=S.bearingDelta||0,u.pitch+=S.pitchDelta||0,S.panDelta&&u.pan._add(S.panDelta),S.around&&(u.around=S.around),S.pinchAround&&(u.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const S=rg(u.pan.mag(),g,i.l({},E2,s||{}));x.offset=u.pan.mult(S.amount/u.pan.mag()),x.center=this._map.transform.center,tg(x,S)}if(u.zoom){const S=rg(u.zoom,g,A2);x.zoom=this._map.transform.zoom+S.amount,tg(x,S)}if(u.bearing){const S=rg(u.bearing,g,M2);x.bearing=this._map.transform.bearing+i.ay(S.amount,-179,179),tg(x,S)}if(u.pitch){const S=rg(u.pitch,g,C2);x.pitch=this._map.transform.pitch+S.amount,tg(x,S)}if(x.zoom||x.bearing){const S=u.pinchAround===void 0?u.around:u.pinchAround;x.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function tg(y,s){(!y.duration||y.duration<s.duration)&&(y.duration=s.duration,y.easing=s.easing)}function rg(y,s,u){const{maxSpeed:g,linearity:x,deceleration:S}=u,A=i.ay(y*x/(s/1e3),-g,g),L=Math.abs(A)/(S*x);return{easing:u.easing,duration:1e3*L,amount:A*(L/2)}}class Wa extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g,x={}){const S=ve(u.getCanvasContainer(),g),A=u.unproject(S);super(s,i.l({point:S,lngLat:A,originalEvent:g},x)),this._defaultPrevented=!1,this.target=u}}class ng extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g){const x=s==="touchend"?g.changedTouches:g.touches,S=We(u.getCanvasContainer(),x),A=S.map(z=>u.unproject(z)),L=S.reduce((z,B,V,X)=>z.add(B.div(X.length)),new i.P(0,0));super(s,{points:S,point:L,lngLats:A,lngLat:u.unproject(L),originalEvent:g}),this._defaultPrevented=!1}}class I2 extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class O2{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new I2(this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new Wa(s.type,this._map,s))}mouseup(s){this._map.fire(new Wa(s.type,this._map,s))}preclick(s){const u=i.l({},s);u.type="preclick",this._map.fire(new Wa(u.type,this._map,u))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(s),this._map.fire(new Wa(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new Wa(s.type,this._map,s))}mouseover(s){this._map.fire(new Wa(s.type,this._map,s))}mouseout(s){this._map.fire(new Wa(s.type,this._map,s))}touchstart(s){return this._firePreventable(new ng(s.type,this._map,s))}touchmove(s){this._map.fire(new ng(s.type,this._map,s))}touchend(s){this._map.fire(new ng(s.type,this._map,s))}touchcancel(s){this._map.fire(new ng(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class aD{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new Wa(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Wa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Wa(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sD{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&s.button===0&&(te(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const g=u,x=this._startPos,S=this._lastPos;if(!x||!S||S.equals(g)||!this._box&&g.dist(x)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=$("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const A=Math.min(x.x,g.x),L=Math.max(x.x,g.x),z=Math.min(x.y,g.y),B=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${z}px)`,this._box.style.width=L-A+"px",this._box.style.height=B-z+"px")})}mouseupWindow(s,u){if(!this._active)return;const g=this._startPos,x=u;if(g&&s.button===0){if(this.reset(),le(),g.x!==x.x||g.y!==x.y)return this._map.fire(new i.A("boxzoomend",{originalEvent:s})),{cameraAnimation:S=>S.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),oe(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new i.A(s,{originalEvent:u}))}}function si(y,s){const u={};for(let g=0;g<y.length;g++)u[y[g].identifier]=s[g];return u}class k2{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const S=new i.P(0,0);for(const A of x)S._add(A);return S.div(x.length)}(u),this.touches=si(g,u)))}touchmove(s,u,g){if(this.aborted||!this.centroid)return;const x=si(g,u);for(const S in this.touches){const A=x[S];(!A||A.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(s,u,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class u1{constructor(s){this.singleTap=new k2(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,u,g){this.singleTap.touchstart(s,u,g)}touchmove(s,u,g){this.singleTap.touchmove(s,u,g)}touchend(s,u,g){const x=this.singleTap.touchend(s,u,g);if(x){const S=s.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(S&&A||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class lD{constructor(){this._zoomIn=new u1({numTouches:1,numTaps:2}),this._zoomOut=new u1({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,g){this._zoomIn.touchstart(s,u,g),this._zoomOut.touchstart(s,u,g)}touchmove(s,u,g){this._zoomIn.touchmove(s,u,g),this._zoomOut.touchmove(s,u,g)}touchend(s,u,g){const x=this._zoomIn.touchend(s,u,g),S=this._zoomOut.touchend(s,u,g);return x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(x)},{originalEvent:s})}):S?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(S)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ig={0:1,2:2},d1={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class og{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,u){return!1}_move(s,u){return{}}mousedown(s,u){if(this._lastPoint)return;const g=Ie(s);this._correctButton(s,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(s,u){const g=this._lastPoint;if(g){if(s.preventDefault(),this._eventButton!=null&&function(x,S){const A=ig[S];return x.buttons===void 0||(x.buttons&A)!==A}(s,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(s){this._lastPoint&&Ie(s)===this._eventButton&&(this._moved&&le(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nv extends og{mousedown(s,u){super.mousedown(s,u),this._lastPoint&&(this._active=!0)}_correctButton(s,u){return u===0&&!s.ctrlKey}_move(s,u){return{around:u,panDelta:u.sub(s)}}}class ic extends og{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?d1[s.pitchRotateKey]:void 0}_correctButton(s,u){return this._pitchRotateKey?u===0&&s[this._pitchRotateKey]:u===0&&s.ctrlKey||u===2}_move(s,u){const g=.8*(u.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class ag extends og{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?d1[s.pitchRotateKey]:void 0}_correctButton(s,u){return this._pitchRotateKey?u===0&&s[this._pitchRotateKey]:u===0&&s.ctrlKey||u===2}_move(s,u){const g=-.5*(u.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class Ui{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),i.aQ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(s,u,g){return this._calculateTransform(s,u,g)}touchmove(s,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!i.dC())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,u,g)}}touchend(s,u,g){this._calculateTransform(s,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,g){g.length>0&&(this._active=!0);const x=si(g,u),S=new i.P(0,0),A=new i.P(0,0);let L=0;for(const B in x){const V=x[B],X=this._touches[B];X&&(S._add(V),A._add(V.sub(X)),L++,x[B]=V)}if(this._touches=x,L<this._minTouches||!A.mag())return;const z=A.div(L);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(L),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Vs{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,u,g){return{}}touchstart(s,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,g){const x=this._firstTwoTouches;if(!x)return;s.preventDefault();const[S,A]=x,L=zf(g,u,S),z=zf(g,u,A);if(!L||!z)return;const B=this._aroundCenter?null:L.add(z).div(2);return this._move([L,z],B,s)}touchend(s,u,g){if(!this._firstTwoTouches)return;const[x,S]=this._firstTwoTouches,A=zf(g,u,x),L=zf(g,u,S);A&&L||(this._active&&le(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function zf(y,s,u){for(let g=0;g<y.length;g++)if(y[g].identifier===u)return s[g]}function sg(y,s){return Math.log(y/s)/Math.LN2}class R2 extends Vs{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(sg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sg(this._distance,g),pinchAround:u}}}function D2(y,s){return 180*y.angleWith(s)/Math.PI}class lg extends Vs{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u){const g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:D2(this._vector,g),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const x=D2(s,g);return Math.abs(x)<u}}function h1(y){return Math.abs(y.y)>Math.abs(y.x)}class cD extends Vs{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,h1(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,g){const x=this._lastPoints;if(!x)return;const S=s[0].sub(x[0]),A=s[1].sub(x[1]);return this._map._cooperativeGestures&&!i.dC()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(S,A,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(S.y+A.y)/2*-.5})}gestureBeginsVertically(s,u,g){if(this._valid!==void 0)return this._valid;const x=s.mag()>=2,S=u.mag()>=2;if(!x&&!S)return;if(!x||!S)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const A=s.y>0==u.y>0;return h1(s)&&h1(u)&&A}}const f1={panStep:100,bearingStep:15,pitchStep:10};class p1{constructor(){const s=f1;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,g=0,x=0,S=0,A=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),S=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),S=1);break;case 38:s.shiftKey?x=1:(s.preventDefault(),A=-1);break;case 40:s.shiftKey?x=-1:(s.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:L=>{const z=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:cg,zoom:u?Math.round(z)+u*(s.shiftKey?2:1):z,bearing:L.getBearing()+g*this._bearingStep,pitch:L.getPitch()+x*this._pitchStep,offset:[-S*this._panStep,-A*this._panStep],center:L.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cg(y){return y*(2-y)}const eh=4.000244140625,Hc=1/450;class El{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Hc,i.aQ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||i.dC()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=i.q.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%eh==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=ve(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>eh?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&V!==0&&(V=1/V);const X=u(),Y=Math.pow(2,X),re=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):Y;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(re*V))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),x=this._startZoom,S=this._easing;let A,L=!1;if(this._type==="wheel"&&x&&S){const B=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),V=S(B);A=i.ah(x,g,V),B<1?this._frameId||(this._frameId=!0):L=!0}else A=g,L=!0;this._active=!0,L&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let z=A-u();return z*this._lastDelta<0&&(z=0),{noInertia:!0,needsRenderFrame:!L,zoomDelta:z,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=i.dD;if(this._prevEase){const g=this._prevEase,x=(i.q.now()-g.start)/g.duration,S=g.easing(x+.01)-g.easing(x),A=.27/Math.sqrt(S*S+1e-4)*.01,L=Math.sqrt(.0729-A*A);u=i.dB(A,L,.25,1)}return this._prevEase={start:i.q.now(),duration:s,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Ku{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class th{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,u){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ju{constructor(){this._tap=new u1({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,u,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,u,g))}touchmove(s,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=u[0],S=x.y-this._swipePoint.y;return this._swipePoint=x,s.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(s,u,g)}touchend(s,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(s,u,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uD{constructor(s,u,g){this._el=s,this._mousePan=u,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class dD{constructor(s,u,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class hD{constructor(s,u,g,x){this._el=s,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const zv=y=>y.zoom||y.drag||y.pitch||y.rotate;class L2 extends i.A{}class ba{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,u){const g=i.ad.vec3.sub([],u,s);this.radius=i.ad.vec3.length(g[2]<0?i.ad.vec3.div([],g,this.constants):[g[0],g[1],0])}projectRay(s){i.ad.vec3.div(s,s,this.constants),i.ad.vec3.normalize(s,s),i.ad.vec3.mul(s,s,this.constants);const u=i.ad.vec3.scale([],s,this.radius);if(u[2]>0){const g=i.ad.vec3.scale([],[0,0,1],i.ad.vec3.dot(u,[0,0,1])),x=i.ad.vec3.scale([],i.ad.vec3.normalize([],[u[0],u[1],0]),this.radius),S=i.ad.vec3.add([],u,i.ad.vec3.scale([],i.ad.vec3.sub([],i.ad.vec3.add([],x,g),u),2));u[0]=S[0],u[1]=S[1]}return u}}function jf(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class N2{constructor(s,u){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new P2(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ba,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),i.aQ(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,S,A]of this._listeners){const L=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(S,L,A)}}destroy(){for(const[s,u,g]of this._listeners){const x=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(u,x,g)}}_addDefaultHandlers(s){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new O2(u,s));const x=u.boxZoom=new sD(u,s);this._add("boxZoom",x);const S=new lD,A=new th;u.doubleClickZoom=new Ku(A,S),this._add("tapZoom",S),this._add("clickZoom",A);const L=new Ju;this._add("tapDragZoom",L);const z=u.touchPitch=new cD(u);this._add("touchPitch",z);const B=new ic(s),V=new ag(s);u.dragRotate=new dD(s,B,V),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const X=new Nv(s),Y=new Ui(u,s);u.dragPan=new uD(g,X,Y),this._add("mousePan",X),this._add("touchPan",Y,["touchZoom","touchRotate"]);const re=new lg,ce=new R2;u.touchZoomRotate=new hD(g,ce,re,L),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),this._add("blockableMapEvent",new aD(u));const ae=u.scrollZoom=new El(u,this);this._add("scrollZoom",ae,["mousePan"]);const fe=u.keyboard=new p1;this._add("keyboard",fe);for(const me of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[me]&&u[me].enable(s[me])}_add(s,u,g){this._handlers.push({handlerName:s,handler:u,allowed:g}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!zv(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,u,g){for(const x in s)if(x!==g&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const u=[];for(const g of s)this._el.contains(g.target)&&u.push(g);return u}handleEvent(s,u){this._updatingCamera=!0;const g=s.type==="renderFrame",x=g?void 0:s,S={needsRenderFrame:!1},A={},L={},z=s.touches?this._getMapTouches(s.touches):void 0,B=z?We(this._el,z):g?void 0:ve(this._el,s);for(const{handlerName:Y,handler:re,allowed:ce}of this._handlers){if(!re.isEnabled())continue;let ae;this._blockedByActive(L,ce,Y)?re.reset():re[u||s.type]&&(ae=re[u||s.type](s,B,z),this.mergeHandlerResult(S,A,ae,Y,x),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()),(ae||re.isActive())&&(L[Y]=re)}const V={};for(const Y in this._previousActiveHandlers)L[Y]||(V[Y]=x);this._previousActiveHandlers=L,(Object.keys(V).length||jf(S))&&(this._changes.push([S,A,V]),this._triggerRenderFrame()),(Object.keys(L).length||jf(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=S;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(s,u,g,x,S){if(!g)return;i.l(s,g);const A={handlerName:x,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(u.zoom=A),g.panDelta!==void 0&&(u.drag=A),g.pitchDelta!==void 0&&(u.pitch=A),g.bearingDelta!==void 0&&(u.rotate=A)}_applyChanges(){const s={},u={},g={};for(const[x,S,A]of this._changes)x.panDelta&&(s.panDelta=(s.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(s.around=x.around),x.aroundCoord!==void 0&&(s.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(s.pinchAround=x.pinchAround),x.noInertia&&(s.noInertia=x.noInertia),i.l(u,S),i.l(g,A);this._updateMapTransform(s,u,g),this._changes=[]}_updateMapTransform(s,u,g){const x=this._map,S=x.transform,A=be=>[be.x,be.y,be.z];if((be=>{const Ee=this._eventsInProgress.drag;return Ee&&!this._handlersById[Ee.handlerName].isActive()})()&&!jf(s)){const be=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),be!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&x._stop(!0),!jf(s))return void this._fireEvents(u,g,!0);let{panDelta:L,zoomDelta:z,bearingDelta:B,pitchDelta:V,around:X,aroundCoord:Y,pinchAround:re}=s;S._isCameraConstrained&&(z>0&&(z=0),S._isCameraConstrained=!1),re!==void 0&&(X=re),(z||(be=>u[be]&&!this._eventsInProgress[be])("drag"))&&X&&(this._dragOrigin=A(S.pointCoordinate3D(X)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",x._stop(!0),X=X||x.transform.centerPoint,B&&(S.bearing+=B),V&&(S.pitch+=V),S._updateCameraState();const ce=[0,0,0];if(L)if(S.projection.name==="mercator"){const be=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X).dir),Ee=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X.sub(L)).dir);ce[0]=Ee[0]-be[0],ce[1]=Ee[1]-be[1]}else{const be=S.pointCoordinate(X);if(S.projection.name==="globe"){L=L.rotate(-S.angle);const Ee=S._pixelsPerMercatorPixel/S.worldSize;ce[0]=-L.x*i.dE(i.aT(be.y))*Ee,ce[1]=-L.y*i.dE(S.center.lat)*Ee}else{const Ee=S.pointCoordinate(X.sub(L));be&&Ee&&(ce[0]=Ee.x-be.x,ce[1]=Ee.y-be.y)}}const ae=S.zoom,fe=[0,0,0];if(z){const be=A(Y||S.pointCoordinate3D(X)),Ee={dir:i.ad.vec3.normalize([],i.ad.vec3.sub([],be,S._camera.position))};if(Ee.dir[2]<0){const Te=S.zoomDeltaToMovement(be,z);i.ad.vec3.scale(fe,Ee.dir,Te)}}const me=i.ad.vec3.add(ce,ce,fe);S._translateCameraConstrained(me),z&&Math.abs(S.zoom-ae)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,g,!0)}_fireEvents(s,u,g){const x=zv(this._eventsInProgress),S=zv(s),A={};for(const V in s){const{originalEvent:X}=s[V];this._eventsInProgress[V]||(A[`${V}start`]=X),this._eventsInProgress[V]=s[V]}!x&&S&&this._fireEvent("movestart",S.originalEvent);for(const V in A)this._fireEvent(V,A[V]);S&&this._fireEvent("move",S.originalEvent);for(const V in s){const{originalEvent:X}=s[V];this._fireEvent(V,X)}const L={};let z;for(const V in this._eventsInProgress){const{handlerName:X,originalEvent:Y}=this._eventsInProgress[V];this._handlersById[X].isActive()||(delete this._eventsInProgress[V],z=u[X]||Y,L[`${V}end`]=z)}for(const V in L)this._fireEvent(V,L[V]);const B=zv(this._eventsInProgress);if(g&&(x||S)&&!B){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;V?(X(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:z})):(this._map.fire(new i.A("moveend",{originalEvent:z})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new i.A(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new L2("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const z2="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ff extends i.E{constructor(s,u){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,i.aQ(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}panBy(s,u,g){return s=i.P.convert(s).mult(-1),this.panTo(this.transform.center,i.l({offset:s},u),g)}panTo(s,u,g){return this.easeTo(i.l({center:s},u),g)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,g){return this.easeTo(i.l({zoom:s},u),g)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,g){return this.easeTo(i.l({bearing:s},u),g)}resetNorth(s,u){return this.rotateTo(0,i.l({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}cameraForBounds(s,u){s=i.aB.convert(s);const g=u&&u.bearing||0,x=u&&u.pitch||0,S=s.getNorthWest(),A=s.getSouthEast();return this._cameraForBounds(this.transform,S,A,g,x,u)}_extendPadding(s){const u={top:0,right:0,bottom:0,left:0};return s==null?i.l({},u,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:i.l({},u,s)}_extendCameraOptions(s){return(s=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,u){const g=u.max[0]-u.min[0],x=u.max[1]-u.min[1];return g/x>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):x/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,u,g,x,S,A){const L=s.clone(),z=this._extendCameraOptions(A);L.bearing=x,L.pitch=S;const B=i.bO.convert(u),V=i.bO.convert(g),X=.5*(B.lat+V.lat),Y=.5*(B.lng+V.lng),re=i.dF(X,Y),ce=i.ad.vec3.normalize([],re),ae=i.ad.vec3.normalize([],i.ad.vec3.cross([],ce,[0,1,0])),fe=i.ad.vec3.cross([],ae,ce),me=[ae[0],ae[1],ae[2],0,fe[0],fe[1],fe[2],0,ce[0],ce[1],ce[2],0,0,0,0,1],be=[re,i.dF(B.lat,B.lng),i.dF(V.lat,B.lng),i.dF(V.lat,V.lng),i.dF(B.lat,V.lng),i.dF(X,B.lng),i.dF(X,V.lng),i.dF(B.lat,Y),i.dF(V.lat,Y)];let Ee=i.ce.fromPoints(be.map(gt=>[i.ad.vec3.dot(ae,gt),i.ad.vec3.dot(fe,gt),i.ad.vec3.dot(ce,gt)]));const Te=i.ad.vec3.transformMat4([],Ee.center,me);i.ad.vec3.squaredLength(Te)===0&&i.ad.vec3.set(Te,0,0,1),i.ad.vec3.normalize(Te,Te),i.ad.vec3.scale(Te,Te,i.az),L.center=i.dG(Te);const Oe=L.getWorldToCameraMatrix(),Me=i.ad.mat4.invert(new Float64Array(16),Oe);Ee=i.ce.applyTransform(Ee,i.ad.mat4.multiply([],Oe,me));const Ce=this._extendAABB(Ee,L,z,x);if(!Ce)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ee=Ce,i.ad.vec3.transformMat4(Te,Te,Oe);const Pe=.5*(Ee.max[2]-Ee.min[2]),Ne=this._minimumAABBFrustumDistance(L,Ee),Ue=i.ad.vec3.scale([],[0,0,1],Pe),dt=i.ad.vec3.add(Ue,Te,Ue),et=Ne+(L.pitch===0?0:i.ad.vec3.distance(Te,dt)),wt=L.globeCenterInViewSpace,Tt=i.ad.vec3.sub([],Te,[wt[0],wt[1],wt[2]]);i.ad.vec3.normalize(Tt,Tt),i.ad.vec3.scale(Tt,Tt,et);const Dt=i.ad.vec3.add([],Te,Tt);i.ad.vec3.transformMat4(Dt,Dt,Me);const Qe=i.dv/i.az,bt=i.ad.vec3.length(Dt),Ye=i.bH(Math.max(bt*Qe-i.dv,Number.EPSILON),0),xt=Math.min(L.zoomFromMercatorZAdjusted(Ye),z.maxZoom);return xt>.5*(i.c6+i.bY)?(L.setProjection({name:"mercator"}),L.zoom=xt,this._cameraForBounds(L,u,g,x,S,A)):{center:L.center,zoom:xt,bearing:x,pitch:S}}_extendAABB(s,u,g,x){const S=.5*((g.padding.left||0)+(g.padding.right||0)),A=.5*((g.padding.top||0)+(g.padding.bottom||0)),L=A,z=S,B=S,V=A,X=u.width-(z+B),Y=u.height-(L+V),re=i.ad.vec3.sub([],s.max,s.min),ce=Math.min(X/re[0],Y/re[1]),ae=Math.min(u.scaleZoom(u.scale*ce),g.maxZoom);if(isNaN(ae))return null;const fe=u.scale/u.zoomScale(ae),me=new i.ce([s.min[0]-z*fe,s.min[1]-V*fe,s.min[2]],[s.max[0]+B*fe,s.max[1]+L*fe,s.max[2]]),be=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new i.P(g.offset.x,g.offset.y):i.P.convert(g.offset)).rotate(-i.ak(x));return me.center[0]-=be.x*fe,me.center[1]+=be.y*fe,me}queryTerrainElevation(s,u){const g=this.transform.elevation;return g?(u=i.l({},{exaggerated:!0},u),g.getAtPoint(i.ac.fromLngLat(s),null,u.exaggerated)):null}_cameraForBounds(s,u,g,x,S,A){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,u,g,x,S,A);const L=s.clone(),z=this._extendCameraOptions(A);L.bearing=x,L.pitch=S;const B=i.bO.convert(u),V=i.bO.convert(g),X=new i.bO(B.lng,V.lat),Y=new i.bO(V.lng,B.lat),re=L.project(B),ce=L.project(V),ae=this.queryTerrainElevation(B),fe=this.queryTerrainElevation(V),me=this.queryTerrainElevation(X),be=this.queryTerrainElevation(Y),Ee=[[re.x,re.y,Math.min(ae||0,fe||0,me||0,be||0)],[ce.x,ce.y,Math.max(ae||0,fe||0,me||0,be||0)]];let Te=i.ce.fromPoints(Ee);const Oe=L.getWorldToCameraMatrix(),Me=i.ad.mat4.invert(new Float64Array(16),Oe);Te=i.ce.applyTransform(Te,Oe);const Ce=this._extendAABB(Te,L,z,x);if(!Ce)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Ce;const Pe=.5*i.ad.vec3.sub([],Te.max,Te.min)[2],Ne=this._minimumAABBFrustumDistance(L,Te),Ue=[0,0,1,0];i.ad.vec4.transformMat4(Ue,Ue,Oe),i.ad.vec4.normalize(Ue,Ue);const dt=i.ad.vec3.scale([],Ue,Ne+Pe),et=i.ad.vec3.add([],Te.center,dt);i.ad.vec3.transformMat4(Te.center,Te.center,Me),i.ad.vec3.transformMat4(et,et,Me);const wt=L.unproject(new i.P(Te.center[0],Te.center[1])),Tt=i.dH(L.projection,wt),Dt=Math.pow(2,Tt),Qe=Math.min(L._zoomFromMercatorZ(et[2]*L.pixelsPerMeter*Dt/L.worldSize),z.maxZoom);return L.mercatorFromTransition&&Qe<.5*(i.c6+i.bY)?(L.setProjection({name:"globe"}),L.zoom=Qe,this._cameraForBounds(L,u,g,x,S,A)):{center:wt,zoom:Qe,bearing:x,pitch:S}}fitBounds(s,u,g){const x=this.cameraForBounds(s,u);return this._fitInternal(x,u,g)}fitScreenCoordinates(s,u,g,x,S){const A=i.P.convert(s),L=i.P.convert(u),z=new i.P(Math.min(A.x,L.x),Math.min(A.y,L.y)),B=new i.P(Math.max(A.x,L.x),Math.max(A.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(A,L))return this;const V=this.transform.pointLocation3D(z),X=this.transform.pointLocation3D(B),Y=this.transform.pointLocation3D(new i.P(z.x,B.y)),re=this.transform.pointLocation3D(new i.P(B.x,z.y)),ce=[Math.min(V.lng,X.lng,Y.lng,re.lng),Math.min(V.lat,X.lat,Y.lat,re.lat)],ae=[Math.max(V.lng,X.lng,Y.lng,re.lng),Math.max(V.lat,X.lat,Y.lat,re.lat)],fe=x&&x.pitch?x.pitch:this.getPitch(),me=this._cameraForBounds(this.transform,ce,ae,g,fe,x);return this._fitInternal(me,x,S)}_fitInternal(s,u,g){return s?(u=i.l(s,u)).linear?this.easeTo(u,g):this.flyTo(u,g):this}jumpTo(s,u){this.stop();const g=s.preloadOnly?this.transform.clone():this.transform;let x=!1,S=!1,A=!1;"zoom"in s&&g.zoom!==+s.zoom&&(x=!0,g.zoom=+s.zoom),s.center!==void 0&&(g.center=i.bO.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(S=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(A=!0,g.pitch=+s.pitch);const L=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!g.isPaddingEqual(L))if(s.retainPadding===!1){const z=g.clone();z.padding=L,g.setLocationAtPoint(g.center,z.centerPoint)}else g.padding=L;return s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new i.A("movestart",u)).fire(new i.A("move",u)),x&&this.fire(new i.A("zoomstart",u)).fire(new i.A("zoom",u)).fire(new i.A("zoomend",u)),S&&this.fire(new i.A("rotatestart",u)).fire(new i.A("rotate",u)).fire(new i.A("rotateend",u)),A&&this.fire(new i.A("pitchstart",u)).fire(new i.A("pitch",u)).fire(new i.A("pitchend",u)),this.fire(new i.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(z2),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return i.w(z2),this;this.stop();const x=g.zoom,S=g.pitch,A=g.bearing;g.setFreeCameraOptions(s);const L=x!==g.zoom,z=S!==g.pitch,B=A!==g.bearing;return this.fire(new i.A("movestart",u)).fire(new i.A("move",u)),L&&this.fire(new i.A("zoomstart",u)).fire(new i.A("zoom",u)).fire(new i.A("zoomend",u)),B&&this.fire(new i.A("rotatestart",u)).fire(new i.A("rotate",u)).fire(new i.A("rotateend",u)),z&&this.fire(new i.A("pitchstart",u)).fire(new i.A("pitch",u)).fire(new i.A("pitchend",u)),this.fire(new i.A("moveend",u)),this}easeTo(s,u){this._stop(!1,s.easeId),((s=i.l({offset:[0,0],duration:500,easing:i.dD},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const g=this.transform,x=this.getZoom(),S=this.getBearing(),A=this.getPitch(),L=this.getPadding(),z="zoom"in s?+s.zoom:x,B="bearing"in s?this._normalizeBearing(s.bearing,S):S,V="pitch"in s?+s.pitch:A,X=this._extendPadding(s.padding),Y=i.P.convert(s.offset);let re,ce,ae;if(g.projection.name==="globe"){const Ue=i.ac.fromLngLat(g.center),dt=Y.rotate(-g.angle);Ue.x+=dt.x/g.worldSize,Ue.y+=dt.y/g.worldSize;const et=Ue.toLngLat(),wt=i.bO.convert(s.center||et);this._normalizeCenter(wt),re=g.centerPoint.add(dt),ce=new i.P(Ue.x,Ue.y).mult(g.worldSize),ae=new i.P(i.av(wt.lng),i.aC(wt.lat)).mult(g.worldSize).sub(ce)}else{re=g.centerPoint.add(Y);const Ue=g.pointLocation(re),dt=i.bO.convert(s.center||Ue);this._normalizeCenter(dt),ce=g.project(Ue),ae=g.project(dt).sub(ce)}const fe=g.zoomScale(z-x);let me,be;s.around&&(me=i.bO.convert(s.around),be=g.locationPoint(me));const Ee=this._zooming||z!==x,Te=this._rotating||S!==B,Oe=this._pitching||V!==A,Me=!g.isPaddingEqual(X),Ce=s.retainPadding===!1?g.clone():g,Pe=Ue=>dt=>{if(Ee&&(Ue.zoom=i.ah(x,z,dt)),Te&&(Ue.bearing=i.ah(S,B,dt)),Oe&&(Ue.pitch=i.ah(A,V,dt)),Me&&(Ce.interpolatePadding(L,X,dt),re=Ce.centerPoint.add(Y)),me)Ue.setLocationAtPoint(me,be);else{const et=Ue.zoomScale(Ue.zoom-x),wt=z>x?Math.min(2,fe):Math.max(.5,fe),Tt=Math.pow(wt,1-dt),Dt=Ue.unproject(ce.add(ae.mult(dt*Tt)).mult(et));Ue.setLocationAtPoint(Ue.renderWorldCopies?Dt.wrap():Dt,re)}return s.preloadOnly||this._fireMoveEvents(u),Ue};if(s.preloadOnly){const Ue=this._emulate(Pe,s.duration,g);return this._preloadTiles(Ue),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ee,this._rotating=Te,this._pitching=Oe,this._padding=Me,this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,Ne),this._ease(Pe(g),Ue=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(u,Ue)},s),this}_prepareEase(s,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||g.moving||this.fire(new i.A("movestart",s)),this._zooming&&!g.zooming&&this.fire(new i.A("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new i.A("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new i.A("pitchstart",s))}_fireMoveEvents(s){this.fire(new i.A("move",s)),this._zooming&&this.fire(new i.A("zoom",s)),this._rotating&&this.fire(new i.A("rotate",s)),this._pitching&&this.fire(new i.A("pitch",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.A("zoomend",s)),x&&this.fire(new i.A("rotateend",s)),S&&this.fire(new i.A("pitchend",s)),this.fire(new i.A("moveend",s))}flyTo(s,u){if(this._prefersReducedMotion(s)){const gt=i.aA(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(gt,u)}this.stop(),s=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dD},s);const g=this.transform,x=this.getZoom(),S=this.getBearing(),A=this.getPitch(),L=this.getPadding(),z="zoom"in s?i.ay(+s.zoom,g.minZoom,g.maxZoom):x,B="bearing"in s?this._normalizeBearing(s.bearing,S):S,V="pitch"in s?+s.pitch:A,X=this._extendPadding(s.padding),Y=g.zoomScale(z-x),re=i.P.convert(s.offset);let ce=g.centerPoint.add(re);const ae=g.pointLocation(ce),fe=i.bO.convert(s.center||ae);this._normalizeCenter(fe);const me=g.project(ae),be=g.project(fe).sub(me);let Ee=s.curve;const Te=Math.max(g.width,g.height),Oe=Te/Y,Me=be.mag();if("minZoom"in s){const gt=i.ay(Math.min(s.minZoom,x,z),g.minZoom,g.maxZoom),Et=Te/g.zoomScale(gt-x);Ee=Math.sqrt(Et/Me*2)}const Ce=Ee*Ee;function Pe(gt){const Et=(Oe*Oe-Te*Te+(gt?-1:1)*Ce*Ce*Me*Me)/(2*(gt?Oe:Te)*Ce*Me);return Math.log(Math.sqrt(Et*Et+1)-Et)}function Ne(gt){return(Math.exp(gt)-Math.exp(-gt))/2}function Ue(gt){return(Math.exp(gt)+Math.exp(-gt))/2}const dt=Pe(0);let et=function(gt){return Ue(dt)/Ue(dt+Ee*gt)},wt=function(gt){return Te*((Ue(dt)*(Ne(Et=dt+Ee*gt)/Ue(Et))-Ne(dt))/Ce)/Me;var Et},Tt=(Pe(1)-dt)/Ee;if(Math.abs(Me)<1e-6||!isFinite(Tt)){if(Math.abs(Te-Oe)<1e-6)return this.easeTo(s,u);const gt=Oe<Te?-1:1;Tt=Math.abs(Math.log(Oe/Te))/Ee,wt=function(){return 0},et=function(Et){return Math.exp(gt*Ee*Et)}}s.duration="duration"in s?+s.duration:1e3*Tt/("screenSpeed"in s?+s.screenSpeed/Ee:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const Dt=S!==B,Qe=V!==A,bt=!g.isPaddingEqual(X),Ye=s.retainPadding===!1?g.clone():g,xt=gt=>Et=>{const ht=Et*Tt,Mt=1/et(ht);gt.zoom=Et===1?z:x+gt.scaleZoom(Mt),Dt&&(gt.bearing=i.ah(S,B,Et)),Qe&&(gt.pitch=i.ah(A,V,Et)),bt&&(Ye.interpolatePadding(L,X,Et),ce=Ye.centerPoint.add(re));const Vt=Et===1?fe:gt.unproject(me.add(be.mult(wt(ht))).mult(Mt));return gt.setLocationAtPoint(gt.renderWorldCopies?Vt.wrap():Vt,ce),gt._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(u),gt};if(s.preloadOnly){const gt=this._emulate(xt,s.duration,g);return this._preloadTiles(gt),this}return this._zooming=!0,this._rotating=Dt,this._pitching=Qe,this._padding=bt,this._prepareEase(u,!1),this._ease(xt(g),()=>this._afterEase(u),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!s){const g=this.handlers;g&&g.stop(!1)}return this}_ease(s,u,g){g.animate===!1||g.duration===0?(s(1),u()):(this._easeStart=i.q.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,u){s=i.bF(s,-180,180);const g=Math.abs(s-u);return Math.abs(s-360-u)<g&&(s-=360),Math.abs(s+360-u)<g&&(s+=360),s}_normalizeCenter(s){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const g=s.lng-u.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,u,g){const x=Math.ceil(15*u/1e3),S=[],A=s(g.clone());for(let L=0;L<=x;L++){const z=A(L/x);S.push(z.clone())}return S}_preloadTiles(s,u){}}class jv{constructor(s={}){this.options=s,i.aQ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const u=this.options&&this.options.compact,g=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=$("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const x=$("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",g),this._innerContainer=$("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(s){const g=u.reduce((x,S,A)=>(S.value&&(x+=`${S.key}=${S.value}${A<u.length-1?"&":""}`),x),"?");s.href=`${i.e.FEEDBACK_URL}/${g}#${c1(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._mergedSourceCaches;for(const x in u){const S=u[x];if(S.used){const A=S.getSource();A.attribution&&s.indexOf(A.attribution)<0&&s.push(A.attribution)}}s.sort((x,S)=>x.length-S.length),s=s.filter((x,S)=>{for(let A=S+1;A<s.length;A++)if(s[A].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class ps{constructor(){i.aQ(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=$("div","mapboxgl-ctrl");const u=$("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const u in s){const g=s[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class ms{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const x of g)if(x.id===s)return void(x.cancelled=!0)}run(s=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Bf{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const u=i.cC((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,u,g){this._start=this.getValue(u),this._end=s,this._startTime=u,this._endTime=u+g}}const rh={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class nh extends i.A{constructor(s,u,g,x){const{point:S,lngLat:A,originalEvent:L,target:z}=s;super(s.type,{point:S,lngLat:A,originalEvent:L,target:z}),this.preventDefault=()=>{s.preventDefault()},this.id=u,this.interaction=g,this.feature=x}}class m1{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,u){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const g=u.filter;let x=u.type;g&&this.filters.set(s,i.a_(g)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const S=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,u)):S.size===0&&this.map.on(x,this.handleType),S.size===0&&this.interactionsByType.set(x,S),S.set(s,u),this.typeById.set(s,x)}get(s){const u=this.typeById.get(s);if(!u)return;const g=this.interactionsByType.get(u);return g?g.get(s):void 0}remove(s){const u=this.typeById.get(s);if(!u)return;this.typeById.delete(s),this.filters.delete(s);const g=this.interactionsByType.get(u);g&&(g.delete(s),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(u,this.handleType))}queryTargets(s,u){const g=[];for(const[x,S]of u)S.target&&g.push({targetId:x,target:S.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(s,g,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());u.length&&(s.type="mouseenter",this.handleType(s,u));const g=new Map;for(const[x,{feature:S}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||g.set(S.id,S);g.size&&(s.type="mouseleave",this.handleType(s,Array.from(g.values())))}handleOut(s){const u=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);u.length&&(s.type="mouseleave",this.handleType(s,u)),this.hoveredFeatures.clear()}handleType(s,u){const g=Array.from(this.interactionsByType.get(s.type)).reverse(),x=!!u;u=u||this.queryTargets(s.point,g);const S=s.type==="mouseenter";let A=!1;const L=new Set;for(const z of u){for(const[B,V]of g){if(!V.target)continue;const X=z.variants?z.variants[B]:null;if(X){for(const Y of X){if(nf(Y,z,L,B))continue;const re=new i.cx(z,Y),ce=Pm(Y,z,B);x&&(re.state=this.map.getFeatureState(re));const ae=S?this.prevHoveredFeatures.get(ce):null,fe=new nh(s,B,V,re),me=ae?ae.stop:V.handler(fe);if(S&&this.hoveredFeatures.set(ce,{feature:z,stop:me}),me!==!1){A=!0;break}}if(A)break}}if(A)break}if(!A)for(const[z,B]of g){const{handler:V,target:X}=B;if(!X&&V(new nh(s,z,B,null))!==!1)break}}}function gn(y,s){if(Array.isArray(y)&&Array.isArray(s)){const u=new Set(y),g=new Set(s);return u.size===g.size&&y.every(x=>g.has(x))}return i.bn(y,s)}const Qu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},fD={showCompass:!0,showZoom:!0,visualizePitch:!1};class pD{constructor(s,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new ic({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new ag({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),i.aQ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(s,u){this.mouseRotate.mousedown(s,u),this.mousePitch&&this.mousePitch.mousedown(s,u),te()}move(s,u){const g=this.map,x=this.mouseRotate.mousemoveWindow(s,u),S=x&&x.bearingDelta;if(S&&g.setBearing(g.getBearing()+S),this.mousePitch){const A=this.mousePitch.mousemoveWindow(s,u),L=A&&A.pitchDelta;L&&g.setPitch(g.getPitch()+L)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){oe(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(i.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ve(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ve(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=We(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=We(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Fv(y,s,u){if(y=new i.bO(y.lng,y.lat),s){const g=new i.bO(y.lng-360,y.lat),x=new i.bO(y.lng+360,y.lat),S=360*Math.ceil(Math.abs(y.lng-u.center.lng)/360),A=u.locationPoint3D(y).distSqr(s),L=s.x<0||s.y<0||s.x>u.width||s.y>u.height;u.locationPoint3D(g).distSqr(s)<A&&(L||Math.abs(g.lng-u.center.lng)<S)?y=g:u.locationPoint3D(x).distSqr(s)<A&&(L||Math.abs(x.lng-u.center.lng)<S)&&(y=x)}for(;Math.abs(y.lng-u.center.lng)>180;){const g=u.locationPoint3D(y);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;y.lng>u.center.lng?y.lng-=360:y.lng+=360}return y}const oc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ga={anchor:"center",color:"#3FB1CE",scale:1,draggable:!1,clickTolerance:0,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Yo extends i.E{constructor(s,u){super(),(s instanceof HTMLElement||u)&&(s=i.l({element:s},u)),i.aQ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),s=i.l({},Ga,s),this._anchor=s.anchor,this._color=s.color,this._scale=s.scale,this._draggable=s.draggable,this._clickTolerance=s.clickTolerance,this._rotation=s.rotation,this._rotationAlignment=s.rotationAlignment,this._pitchAlignment=s.pitchAlignment,this._occludedOpacity=s.occludedOpacity,this._altitude=s.altitude,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=i.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const g=this._element.classList;for(const S in oc)g.remove(`mapboxgl-marker-anchor-${S}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`);const x=s&&s.className?s.className.trim().split(/\s+/):[];g.add(...x),this._popup=null}_createDefaultMarker(){const s=$("div"),u=H("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const g=H("radialGradient",{id:"shadowGradient"},H("defs",{},u));H("stop",{offset:"10%","stop-opacity":.4},g),H("stop",{offset:"100%","stop-opacity":.05},g),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=i.bO.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||Ga.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const u=s.code,g=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(s){const u=s.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,u=this._pos;if(!s||!u)return!1;const g=s.unproject(u,this._altitude),x=s.getFreeCameraOptions();if(!x.position)return!1;const S=x.position.toLngLat();return S.distanceTo(g)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const u=this._pos;if(!u||u.x<0||u.x>s.transform.width||u.y<0||u.y>s.transform.height)return void this._clearFadeTimer();const g=s.unproject(u,this._altitude);let x;s._showingGlobe()&&i.dK(s.transform,this._lngLat)?x=0:(x=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${oc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const s=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!s||g!=="map")return"";if(!u._showingGlobe()){const z=u.getPitch();return z?`rotateX(${z}deg)`:""}const x=i.c4(i.dL(u.transform,this._lngLat)),S=s.sub(i.dM(u.transform)),A=Math.abs(S.x)+Math.abs(S.y);if(A===0)return"";const L=x/A;return`rotateX(${-S.y*L}deg) rotateY(${S.x*L}deg)`}_calculateZTransform(){const s=this._pos,u=this._map;if(!u||!s)return"";let g=0;const x=this.getRotationAlignment();if(x==="map")if(u._showingGlobe()){const S=u.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),A=u.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(S);g=i.c4(Math.atan2(A.y,A.x))-90}else g=-u.getBearing();else if(x==="horizon"){const S=i.ae(4,6,u.getZoom()),A=i.dM(u.transform);A.y+=S*u.transform.height;const L=s.sub(A),z=i.c4(Math.atan2(L.y,L.x));g=(z>90?z-270:z+90)*(1-S)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Fv(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=i.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const u=this._map;if(!u)return;const g=this._pointerdownPos,x=this._positionDelta;if(g&&x){if(!this._isDragging){const S=this._clickTolerance||u._clickTolerance;if(s.point.dist(g)<S)return;this._isDragging=!0}this._pos=s.point.sub(x),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.A("dragstart"))),this.fire(new i.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.A("dragend")),this._state="inactive"}_addDragHandler(s){const u=this._map,g=this._pos;u&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const u=this._map;return u&&(s?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||Ga.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||Ga.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||Ga.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||Ga.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const qa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},$o={maxWidth:100,unit:"metric"},g1={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ji={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},j2=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ed(y=new i.P(0,0),s="bottom"){if(typeof y=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(s){case"top":return new i.P(0,y);case"top-left":return new i.P(u,u);case"top-right":return new i.P(-u,u);case"bottom":return new i.P(0,-y);case"bottom-left":return new i.P(u,-u);case"bottom-right":return new i.P(-u,-u);case"left":return new i.P(y,0);case"right":return new i.P(-y,0)}return new i.P(0,0)}return y instanceof i.P||Array.isArray(y)?i.P.convert(y):i.P.convert(y[s]||[0,0])}return{version:_,supported:U.supported,setRTLTextPlugin:i.dN,getRTLTextPluginStatus:i.dO,Map:class extends Ff{constructor(y){E.mark(b.create);const s=y;if((y=i.l({},Qu,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&i.dI(window)&&(y.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qy(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies,null,null),y),this._repaint=!!y.repaint,this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new ms,this._domRenderTaskQueue=new ms,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aW(),this._locale=i.l({},rh,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._tessellationStep=y.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=y.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Bf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=y.scaleFactor,this._requestManager=new Je(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,this._contextCreateOptions=y.contextCreateOptions?Object.assign({},y.contextCreateOptions):{},typeof y.container=="string"){const u=document.getElementById(y.container);if(!u)throw new Error(`Container '${y.container.toString()}' not found.`);this._container=u}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),this._spriteFormat=y.spriteFormat,i.aQ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new n1),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new N2(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,(y.style||!y.testMode)&&this.setStyle(y.style||i.e.DEFAULT_STYLE,{config:y.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this.indoor=new KE(this),y.hash&&(this._hash=new l1(typeof y.hash=="string"&&y.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch});const u=y.bounds;u&&(this.resize(),this.fitBounds(u,i.l({},y.fitBoundsOptions,{duration:0})))}this.resize(),y.attributionControl&&this.addControl(new jv({customAttribution:y.customAttribution})),this._logoControl=new ps,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new i.A(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new i.A(`${u.dataType}dataloading`,u))}),this._interactions=new m1(this)}_getMapId(){return this._mapId}addControl(y,s){if(s===void 0&&(s=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new i.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=y.onAdd(this);this._controls.push(y);const g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new i.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(y);return s>-1&&this._controls.splice(s,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new i.A("movestart",y)).fire(new i.A("move",y)),this.fire(new i.A("resize",y)),s&&this.fire(new i.A("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(i.aB.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(y){return this._scaleFactor=y,this.painter.scaleFactor=y,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(s=>s==="auto"?navigator.language:s):y}setLanguage(y){const s=this._parseLanguage(y);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,s=y.projection.name;let u;s==="globe"&&y.zoom>=i.bY?(y.setMercatorFromTransition(),u=!0):s==="mercator"&&y.zoom<i.bY&&(y.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,s){return this._updateProjection(y||s||{name:"mercator"})}_updateProjection(y){let s;return s=y.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(y,s){return this.transform.locationPoint3D(i.bO.convert(y),s)}unproject(y,s){return this.transform.pointLocation3D(i.P.convert(y),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,s,u){const g=x=>{let S=[];if(Array.isArray(s)){const A=s.filter(L=>this.getLayer(L));S=A.length?this.queryRenderedFeatures(x,{layers:A}):[]}else S=this.queryRenderedFeatures(x,{target:s});return S};if(y==="mouseenter"||y==="mouseover"){let x=!1;return{listener:u,targets:s,delegates:{mousemove:A=>{const L=g(A.point);L.length?x||(x=!0,u.call(this,new Wa(y,this,A.originalEvent,{features:L}))):x=!1},mouseout:()=>{x=!1}}}}if(y==="mouseleave"||y==="mouseout"){let x=!1;return{listener:u,targets:s,delegates:{mousemove:L=>{g(L.point).length?x=!0:x&&(x=!1,u.call(this,new Wa(y,this,L.originalEvent)))},mouseout:L=>{x&&(x=!1,u.call(this,new Wa(y,this,L.originalEvent)))}}}}{const x=S=>{const A=g(S.point);A.length&&(S.features=A,u.call(this,S),delete S.features)};return{listener:u,targets:s,delegates:{[y]:x}}}}on(y,s,u){if(typeof s=="function"||u===void 0)return super.on(y,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(y,s,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(y,s,u){if(typeof s=="function"||u===void 0)return super.once(y,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(y,s,u);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(y,s,u){if(typeof s=="function"||u===void 0)return super.off(y,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._delegatedListeners?this._delegatedListeners[y]:void 0;return g&&(x=>{for(let S=0;S<x.length;S++){const A=x[S];if(A.listener===u&&gn(A.targets,s)){for(const L in A.delegates)this.off(L,A.delegates[L]);return x.splice(S,1),this}}})(g),this}queryRenderedFeatures(y,s){if(!this.style)return[];if(y===void 0||y instanceof i.P||Array.isArray(y)||s!==void 0||(s=y,y=void 0),y=y||[[0,0],[this.transform.width,this.transform.height]],!s){const S=this.style.queryRenderedFeatures(y,void 0,this.transform),A=this.style.queryRenderedFeatureset(y,void 0,this.transform);return S.concat(A)}let u=!0;if(s.target&&(u=this._isTargetValid(s.target),u&&!s.layers))return this.style.queryRenderedFeatureset(y,s,this.transform);let g=!0;if(s.layers&&Array.isArray(s.layers)){for(const S of s.layers)if(!this._isValidId(S)){g=!1;break}if(g&&!s.target)return this.style.queryRenderedFeatures(y,s,this.transform)}let x=[];return g&&(x=x.concat(this.style.queryRenderedFeatures(y,s,this.transform))),u&&(x=x.concat(this.style.queryRenderedFeatureset(y,s,this.transform))),x}querySourceFeatures(y,s){return!y||typeof y=="string"&&!this._isValidId(y)?[]:this.style.querySourceFeatures(y,s)}isPointOnSurface(y){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&i.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(y))}addInteraction(y,s){return this._interactions.add(y,s),this}removeInteraction(y){return this._interactions.remove(y),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(y){return this._cooperativeGestures=y,this}setStyle(y,s){return s=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&y&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(y,(u,g)=>{u?(i.w(`Unable to perform style diff: ${String(u.message||u.error||u)}. Rebuilding the style from scratch.`),this._updateStyle(y,s)):g&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(y,s))}_getUIString(y){const s=this._locale[y];if(s==null)throw new Error(`Missing UI string '${y}'`);return s}_updateStyle(y,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y){const u=i.l({},s);s&&s.config&&(u.initialConfig=s.config,delete u.config),this.style=new Sl(this,u).load(y),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Sl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(y){return y==null?(this.fire(new i.z(new Error("IDs can't be empty."))),!1):!i.cs(y)||(this.fire(new i.z(new Error(`IDs can't contain special symbols: "${y}".`))),!1)}_isTargetValid(y){return"featuresetId"in y?this._isValidId("importId"in y?y.importId:y.featuresetId):"layerId"in y&&this._isValidId(y.layerId)}_areTargetsValid(y){if(Array.isArray(y)){for(const s of y)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(y)}addSource(y,s){return this._isValidId(y)?(this._lazyInitEmptyStyle(),this.style.addSource(y,s),this._update(!0)):this}isSourceLoaded(y){return!!this._isValidId(y)&&!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(y,s,u){this._lazyInitEmptyStyle(),this.style.addSourceType(y,s,u)}removeSource(y){return this._isValidId(y)?(this.style.removeSource(y),this._updateTerrain(),this._update(!0)):this}getSource(y){return this._isValidId(y)?this.style.getOwnSource(y):null}addImage(y,s,{pixelRatio:u=1,sdf:g=!1,stretchX:x,stretchY:S,content:A}={}){this._lazyInitEmptyStyle();const L=i.I.from(y);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:z,height:B,data:V}=i.q.getImageData(s);this.style.addImage(L,{data:new i.r({width:z,height:B},V),pixelRatio:u,stretchX:x,stretchY:S,content:A,sdf:g,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new i.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:B}=s,V=s;this.style.addImage(L,{data:new i.r({width:z,height:B},new Uint8Array(V.data)),pixelRatio:u,stretchX:x,stretchY:S,content:A,sdf:g,usvg:!1,version:0,userImage:V}),V.onAdd&&V.onAdd(this,y)}}updateImage(y,s){this._lazyInitEmptyStyle();const u=i.I.from(y),g=this.style.getImage(u);if(!g)return void this.fire(new i.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?i.q.getImageData(s):s,{width:S,height:A,data:L}=x;if(S===void 0||A===void 0)return void this.fire(new i.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||A!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new i.z(new Error(`The width and height of the updated image (${S}, ${A})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const z=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let B=!1;g.usvg?(g.data=new i.r({width:S,height:A},new Uint8Array(L)),g.usvg=!1,g.icon=void 0,B=!0):g.data.replace(L,z),this.style.updateImage(u,g,B)}hasImage(y){return y?!!this.style&&!!this.style.getImage(i.I.from(y)):(this.fire(new i.z(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(i.I.from(y))}loadImage(y,s){i.o(this._requestManager.transformRequest(y,i.R.Image),(u,g)=>{s(u,g instanceof HTMLImageElement?i.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(y=>y.name)}addModel(y,s){this._lazyInitEmptyStyle(),this.style.addModel(y,s)}hasModel(y){return y?this.style.hasModel(y):(this.fire(new i.z(new Error("Missing required model id"))),!1)}removeModel(y){this.style.removeModel(y)}listModels(){return this.style.listModels()}addLayer(y,s){return this._isValidId(y.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(y,s),this._update(!0)):this}getSlot(y){const s=this.getLayer(y);return s&&s.slot||null}setSlot(y,s){return this.style.setSlot(y,s),this.style.mergeLayers(),this._update(!0)}addImport(y,s){return this.style.addImport(y,s),this}updateImport(y,s){return typeof s!="string"&&s.id!==y?(this.removeImport(y),this.addImport(s)):(this.style.updateImport(y,s),this._update(!0))}removeImport(y){return this.style.removeImport(y),this}moveImport(y,s){return this.style.moveImport(y,s),this._update(!0)}moveLayer(y,s){return this._isValidId(y)?(this.style.moveLayer(y,s),this._update(!0)):this}removeLayer(y){return this._isValidId(y)?(this.style.removeLayer(y),this._update(!0)):this}getLayer(y){if(!this._isValidId(y))return null;const s=this.style.getOwnLayer(y);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(y,s,u){return this._isValidId(y)?(this.style.setLayerZoomRange(y,s,u),this._update(!0)):this}setFilter(y,s,u={}){return this._isValidId(y)?(this.style.setFilter(y,s,u),this._update(!0)):this}getFilter(y){return this._isValidId(y)?this.style.getFilter(y):null}setPaintProperty(y,s,u,g={}){return this._isValidId(y)?(this.style.setPaintProperty(y,s,u,g),this._update(!0)):this}getPaintProperty(y,s){return this._isValidId(y)?this.style.getPaintProperty(y,s):null}setLayoutProperty(y,s,u,g={}){return this._isValidId(y)?(this.style.setLayoutProperty(y,s,u,g),this._update(!0)):this}getLayoutProperty(y,s){return this._isValidId(y)?this.style.getLayoutProperty(y,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(y){return this.style.setGlyphsUrl(y),this._update(!0)}getSchema(y){return this.style.getSchema(y)}setSchema(y,s){return this.style.setSchema(y,s),this._update(!0)}getConfig(y){return this.style.getConfig(y)}setConfig(y,s){return this.style.setConfig(y,s),this._update(!0)}getConfigProperty(y,s){return this.style.getConfigProperty(y,s)}setConfigProperty(y,s,u){return this.style.setConfigProperty(y,s,u),this._update(!0)}getFeaturesetDescriptors(y){return this.style.getFeaturesetDescriptors(y)}setLights(y){if(this._lazyInitEmptyStyle(),y&&y.length===1&&y[0].type==="flat"){const s=y[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(y),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const y=this.style.getLights()||[];return y.length===0&&y.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),y}setLight(y,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:y}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(y){return this._lazyInitEmptyStyle(),this.style.setSnow(y),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(y){return this._lazyInitEmptyStyle(),this.style.setRain(y),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(y){return this._lazyInitEmptyStyle(),this.style.setColorTheme(y),this._update(!0)}setImportColorTheme(y,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(y,s),this._update(!0)}setCamera(y){return this.style.setCamera(y),this._triggerCameraUpdate(y)}_triggerCameraUpdate(y){return this._update(this.transform.setOrthographicProjectionAtLowPitch(y["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(y),this.transform):0}setFeatureState(y,s){return y.source&&!this._isValidId(y.source)?this:(this.style.setFeatureState(y,s),this._update())}removeFeatureState(y,s){return y.source&&!this._isValidId(y.source)?this:(this.style.removeFeatureState(y,s),this._update())}getFeatureState(y){return y.source&&!this._isValidId(y.source)?null:this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let u,g,x,S=this._container;for(;S&&(!g||!x);){const A=window.getComputedStyle(S).transform;A&&A!=="none"&&(u=A.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(x=u[3])),S=S.parentElement}this._containerWidth=g?Math.abs(y/g):y,this._containerHeight=x?Math.abs(s/x):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=$("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=$("div","mapboxgl-canvas-container",y);this._canvas=$("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=$("div","mapboxgl-control-container",y),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{g[x]=$("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,s){const u=i.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(y),this._canvas.height=u*Math.ceil(s),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${s}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const s=this._markers.indexOf(y);s!==-1&&this._markers.splice(s,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const s=this._popups.indexOf(y);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const y=i.l({},U.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",y);s?(Ot(s,!0),this.painter=new Dv(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(s)):this.fire(new i.z(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.A("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.A("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let s;this.fire(new i.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,g=i.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=x.createQuery(),x.beginQuery(u.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,V=this.transform.pitch,X=i.q.now(),Y=new i.aa(B,{now:X,fadeDuration:S,pitch:V,transition:this.style.transition});this.style.update(Y)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.isMoving()||this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(g);const L=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),L&&(this._placementDirty=L.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,E.mark(b.load),this.fire(new i.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const B=i.q.now()-g;x.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const V=x.getQueryParameter(s,x.QUERY_RESULT)/1e6;x.deleteQuery(s),this.fire(new i.A("gpu-timing-frame",{cpuTime:B,gpuTime:V}))},50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout(()=>{const V=this.painter.queryGpuTimers(B);this.fire(new i.A("gpu-timing-layer",{layerTimes:V}))},50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const V=this.painter.queryGpuTimeDeferredRender(B);this.fire(new i.A("gpu-timing-deferred-render",{gpuTime:V}))},50)}const z=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(z||this._repaint)this.triggerRepaint();else{const B=this.idle();if(B&&(A=this._updateAverageElevation(g,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new i.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const V=this._calculateSpeedIndex();this.fire(new i.A("speedindexcompleted",{speedIndex:V})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,E.mark(b.fullLoad),this._performanceMetricsCollection&&gr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const s of this._markers)y&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!y||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(y,s=!1){const u=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(s||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const x=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=y;const A=Math.abs(x-S);if(A>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(S),u(S);this._averageElevation.easeTo(S,y,300)}else if(A>1e-4)return this._averageElevation.jumpTo(S),u(S)}return!!this._averageElevation.isEasing(y)&&u(this._averageElevation.getValue(y))}_authenticate(){ge(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===ot||y.status===401)){const s=this.painter.context.gl;Ot(s,!1),this._logoControl instanceof ps&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),tr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&rr(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function x(S){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,S,0);const A=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,A),A}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(x(y),s.canvasCopies.map(x),s.timeStamps)}_canvasPixelComparison(y,s,u){let g=u[1]-u[0];const x=y.length/4;for(let S=0;S<s.length;S++){const A=s[S];let L=0;for(let z=0;z<A.length;z+=4)A[z]===y[z]&&A[z+1]===y[z+1]&&A[z+2]===y[z+2]&&A[z+3]===y[z+3]&&(L+=1);g+=(u[S+2]-u[S+1])*(1-L/x)}return g}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),cr.delete(this.painter.context.gl),Gt.remove(),ut.remove(),this._removed=!0,this.fire(new i.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=i.q.frame(s=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(s)}))}_preloadTiles(y){const s=this.style?this.style.getSourceCaches():[];return i.bl(s,(u,g)=>u._preloadTiles(y,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(y){this._showParseStatus!==y&&(this._showParseStatus=y,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(y){this._showLayers2DWireframe!==y&&(this._showLayers2DWireframe=y,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(y){this._showLayers3DWireframe!==y&&(this._showLayers3DWireframe=y,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,this._tp.refreshUI(),y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,this._tp.refreshUI(),y&&this._update())}_setCacheLimits(y,s){i.dJ(y,s)}get version(){return _}},NavigationControl:class{constructor(y={}){this.options=i.l({},fD,y),this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(i.aQ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),$("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),$("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aQ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:s}):u.resetNorth({},{originalEvent:s}))}),this._compassIcon=$("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const s=y.getZoom(),u=s===y.getMaxZoom(),g=s===y.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pD(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,s){const u=$("button",y,this._container);return u.type="button",u.addEventListener("click",s),u}_setButtonTitle(y,s){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${s}`);y.setAttribute("aria-label",u),y.firstElementChild&&y.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends i.E{constructor(y={}){super();const s=navigator.geolocation;this.options=i.l({geolocation:s},qa,y),i.aQ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Lv(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const s=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,y(u)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>s(u.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(y){const s=this._map.getMaxBounds(),u=y.coords;return!!s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new i.A("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("geolocate",y)),this._finish()}}_updateCamera(y){const s=new i.bO(y.coords.longitude,y.coords.latitude),u=y.coords.accuracy,g=this._map.getBearing(),x=i.l({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(u),x,{geolocateSource:!0})}_updateMarker(y){if(y){const s=new i.bO(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,s=i.bH(1,y._center.lat)*y.worldSize,u=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=$("button","mapboxgl-ctrl-geolocate",this._container),$("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$("div","mapboxgl-user-location"),this._dotElement.appendChild($("div","mapboxgl-user-location-dot")),this._dotElement.appendChild($("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Yo({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=$("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.A("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:jv,ScaleControl:class{constructor(y={}){this.options=i.l({},$o,y),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aQ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,s=this._map,u=s._containerHeight/2,g=s._containerWidth/2-y/2,x=s.unproject([g,u]),S=s.unproject([g+y,u]),A=x.distanceTo(S);if(this.options.unit==="imperial"){const L=3.2808*A;L>5280?this._setScale(y,L/5280,"mile"):this._setScale(y,L,"foot")}else this.options.unit==="nautical"?this._setScale(y,A/1852,"nautical-mile"):A>=1e3?this._setScale(y,A/1e3,"kilometer"):this._setScale(y,A,"meter")}_setScale(y,s,u){this._map._requestDomTask(()=>{const g=function(S){const A=Math.pow(10,`${Math.floor(S)}`.length-1);let L=S/A;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(z){const B=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*B)/B}(L),A*L}(s),x=g/s;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${g1[u]}`,this._container.style.width=y*x+"px"})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y={}){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:i.w("Full screen control 'container' must be a DOM element.")),i.aQ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=$("button","mapboxgl-ctrl-fullscreen",this._controlContainer);$("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(y){super(),this.options=i.l(Object.create(ji),y),this._altitude=this.options.altitude,i.aQ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new i.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new i.A("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=i.bO.convert(y),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(y){return this._altitude=y,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const s=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=y;g=u.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=$("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(y),this.options.closeButton){const u=this._closeButton=$("button","mapboxgl-popup-close-button",s);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let s;return this._classList.delete(y)?s=!1:(this._classList.add(y),s=!0),this._updateClassList(),s}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const s=this._map,u=this._container,g=this._pos;if(!s||!u||!g)return"bottom";const x=u.offsetWidth,S=u.offsetHeight,A=g.x<x/2,L=g.x>s.transform.width-x/2;if(g.y+y<S)return A?"top-left":L?"top-right":"top";if(g.y>s.transform.height-S){if(A)return"bottom-left";if(L)return"bottom-right"}return A?"left":L?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),y.className=s.join(" ")}_update(y){const s=this._map,u=this._content;if(!s||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=$("div","mapboxgl-popup",s.getContainer()),this._tip=$("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Fv(this._lngLat,this._pos,s.transform)),!this._trackPointer||y){const x=this._pos=this._trackPointer&&y instanceof i.P?y:s.project(this._lngLat,this._altitude),S=ed(this.options.offset),A=this._anchor=this._getAnchor(S.y),L=ed(this.options.offset,A),z=x.add(L).round();s._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${oc[A]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&s._showingGlobe()){const x=i.dK(s.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(j2);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:Yo,Style:Sl,LngLat:i.bO,LngLatBounds:i.aB,Point:i.P,MercatorCoordinate:i.ac,FreeCameraOptions:hb,Evented:i.E,config:i.e,prewarm:i.dP,clearPrewarmedResources:i.dQ,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(y){i.e.ACCESS_TOKEN=y},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(y){i.e.API_URL=y},get workerCount(){return i.dR.workerCount},set workerCount(y){i.dR.workerCount=y},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){i.e.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){i.dS(y)},get workerUrl(){return i.dT.workerUrl},set workerUrl(y){i.dT.workerUrl=y},get workerClass(){return i.dT.workerClass},set workerClass(y){i.dT.workerClass=y},get workerParams(){return i.dT.workerParams},set workerParams(y){i.dT.workerParams=y},get dracoUrl(){return i.dU()},set dracoUrl(y){i.dV(y)},get meshoptUrl(){return i.dW()},set meshoptUrl(y){i.dX(y)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var f=a;return f})})(Ooe);var iWe=Ooe.exports;const wd=hi(iWe),PF=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on(l,f,i){if(r[l]===void 0)throw new Error(`Invalid event type: ${l}`);r[l].push({selector:f,fn:i})},render(l){t.store.featureChanged(l)}},a=function(l,f){const i=r[l];let _=i.length;for(;_--;){const b=i[_];if(b.selector(f)){b.fn.call(n,f)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(l){a("drag",l)},click(l){a("click",l)},mousemove(l){a("mousemove",l)},mousedown(l){a("mousedown",l)},mouseup(l){a("mouseup",l)},mouseout(l){a("mouseout",l)},keydown(l){a("keydown",l)},keyup(l){a("keyup",l)},touchstart(l){a("touchstart",l)},touchmove(l){a("touchmove",l)},touchend(l){a("touchend",l)},tap(l){a("tap",l)}}};var E$={},uR={};uR.RADIUS=6378137;uR.FLATTENING=1/298.257223563;uR.POLAR_RADIUS=63567523142e-4;var bZ=uR;E$.geometry=Roe;E$.ring=IF;function Roe(e){var t=0,r;switch(e.type){case"Polygon":return wZ(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)t+=wZ(e.coordinates[r]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)t+=Roe(e.geometries[r]);return t}}function wZ(e){var t=0;if(e&&e.length>0){t+=Math.abs(IF(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(IF(e[r]))}return t}function IF(e){var t,r,n,a,l,f,i,_=0,b=e.length;if(b>2){for(i=0;i<b;i++)i===b-2?(a=b-2,l=b-1,f=0):i===b-1?(a=b-1,l=0,f=1):(a=i,l=i+1,f=i+2),t=e[a],r=e[l],n=e[f],_+=(rN(n[0])-rN(t[0]))*Math.sin(rN(r[1]));_=_*bZ.RADIUS*bZ.RADIUS/2}return _}function rN(e){return e*Math.PI/180}const Js={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},xc={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},vo={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},rl={POLYGON:"polygon",LINE:"line_string",POINT:"point"},rn={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Jn={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},Os={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},CE={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},is={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},Ca={ACTIVE:"true",INACTIVE:"false"},Doe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],oWe=-90,OF=-85,aWe=90,kF=85,sWe=-270,lWe=270,Loe=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:aWe,LAT_MIN:oWe,LAT_RENDERED_MAX:kF,LAT_RENDERED_MIN:OF,LNG_MAX:lWe,LNG_MIN:sWe,activeStates:Ca,classes:Js,cursors:vo,events:Os,geojsonTypes:rn,interactions:Doe,meta:is,modes:Jn,sources:xc,types:rl,updateActions:CE},Symbol.toStringTag,{value:"Module"})),SZ={Point:0,LineString:1,MultiLineString:1,Polygon:2};function cWe(e,t){const r=SZ[e.geometry.type]-SZ[t.geometry.type];return r===0&&e.geometry.type===rn.POLYGON?e.area-t.area:r}function Noe(e){return e.map(t=>(t.geometry.type===rn.POLYGON&&(t.area=E$.geometry({type:rn.FEATURE,property:{},geometry:t.geometry})),t)).sort(cWe).map(t=>(delete t.area,t))}function zoe(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function Ac(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Ac.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Ac.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Ac.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Ac.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Ac.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const uWe=[is.FEATURE,is.MIDPOINT,is.VERTEX],mx={click:dWe,touch:hWe};function dWe(e,t,r){return joe(e,t,r,r.options.clickBuffer)}function hWe(e,t,r){return joe(e,t,r,r.options.touchBuffer)}function joe(e,t,r,n){if(r.map===null)return[];const a=e?zoe(e,n):t,l={};r.options.styles&&(l.layers=r.options.styles.map(b=>b.id).filter(b=>r.map.getLayer(b)!=null));const f=r.map.queryRenderedFeatures(a,l).filter(b=>uWe.indexOf(b.properties.meta)!==-1),i=new Ac,_=[];return f.forEach(b=>{const E=b.properties.id;i.has(E)||(i.add(E),_.push(b))}),Noe(_)}function qM(e,t){const r=mx.click(e,null,t),n={mouse:vo.NONE};return r[0]&&(n.mouse=r[0].properties.active===Ca.ACTIVE?vo.MOVE:vo.POINTER,n.feature=r[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(n.mouse=vo.ADD),t.ui.queueMapClasses(n),t.ui.updateMapClasses(),r[0]}function A$(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}const fWe=4,pWe=12,mWe=500;function RF(e,t,r={}){const n=r.fineTolerance!=null?r.fineTolerance:fWe,a=r.grossTolerance!=null?r.grossTolerance:pWe,l=r.interval!=null?r.interval:mWe;e.point=e.point||t.point,e.time=e.time||t.time;const f=A$(e.point,t.point);return f<n||f<a&&t.time-e.time<l}const gWe=25,yWe=250;function DF(e,t,r={}){const n=r.tolerance!=null?r.tolerance:gWe,a=r.interval!=null?r.interval:yWe;return e.point=e.point||t.point,e.time=e.time||t.time,A$(e.point,t.point)<n&&t.time-e.time<a}let vWe=(e,t=21)=>(r=t)=>{let n="",a=r|0;for(;a--;)n+=e[Math.random()*e.length|0];return n};const _We=vWe("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function M$(){return _We()}const Ls=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||M$(),this.type=t.geometry.type};Ls.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};Ls.prototype.incomingCoords=function(e){this.setCoordinates(e)};Ls.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Ls.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};Ls.prototype.setProperty=function(e,t){this.properties[e]=t};Ls.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:rn.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};Ls.prototype.internal=function(e){const t={id:this.id,meta:is.FEATURE,"meta:type":this.type,active:Ca.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:rn.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const Em=function(e,t){Ls.call(this,e,t)};Em.prototype=Object.create(Ls.prototype);Em.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};Em.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};Em.prototype.getCoordinate=function(){return this.getCoordinates()};const Vd=function(e,t){Ls.call(this,e,t)};Vd.prototype=Object.create(Ls.prototype);Vd.prototype.isValid=function(){return this.coordinates.length>1};Vd.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};Vd.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};Vd.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};Vd.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};const Jl=function(e,t){Ls.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};Jl.prototype=Object.create(Ls.prototype);Jl.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};Jl.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};Jl.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Jl.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(l=>parseInt(l,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};Jl.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};Jl.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};Jl.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};Jl.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),a=parseInt(n[0],10),l=parseInt(n[1],10);this.coordinates[a]===void 0&&(this.coordinates[a]=[]),this.coordinates[a][l]=[t,r]};const xWe={MultiPoint:Em,MultiLineString:Vd,MultiPolygon:Jl},dR=(e,t,r,n,a)=>{const l=r.split("."),f=parseInt(l[0],10),i=l[1]?l.slice(1).join("."):null;return e[f][t](i,n,a)},Is=function(e,t){if(Ls.call(this,e,t),delete this.coordinates,this.model=xWe[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Is.prototype=Object.create(Ls.prototype);Is.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:M$(),type:rn.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Is.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Is.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Is.prototype.getCoordinate=function(e){return dR(this.features,"getCoordinate",e)};Is.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===rn.POLYGON?e.getCoordinates():e.coordinates)))};Is.prototype.updateCoordinate=function(e,t,r){dR(this.features,"updateCoordinate",e,t,r),this.changed()};Is.prototype.addCoordinate=function(e,t,r){dR(this.features,"addCoordinate",e,t,r),this.changed()};Is.prototype.removeCoordinate=function(e){dR(this.features,"removeCoordinate",e),this.changed()};Is.prototype.getFeatures=function(){return this.features};function Bn(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}Bn.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};Bn.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};Bn.prototype.getSelected=function(){return this._ctx.store.getSelected()};Bn.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};Bn.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};Bn.prototype.getFeature=function(e){return this._ctx.store.get(e)};Bn.prototype.select=function(e){return this._ctx.store.select(e)};Bn.prototype.deselect=function(e){return this._ctx.store.deselect(e)};Bn.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};Bn.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)};Bn.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};Bn.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};Bn.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};Bn.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};Bn.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)};Bn.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};Bn.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};Bn.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return mx[r](e,t,this._ctx)};Bn.prototype.newFeature=function(e){const t=e.geometry.type;return t===rn.POINT?new Em(this._ctx,e):t===rn.LINE_STRING?new Vd(this._ctx,e):t===rn.POLYGON?new Jl(this._ctx,e):new Is(this._ctx,e)};Bn.prototype.isInstanceOf=function(e,t){if(e===rn.POINT)return t instanceof Em;if(e===rn.LINE_STRING)return t instanceof Vd;if(e===rn.POLYGON)return t instanceof Jl;if(e==="MultiFeature")return t instanceof Is;throw new Error(`Unknown feature class: ${e}`)};Bn.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};Bn.prototype.onSetup=function(){};Bn.prototype.onDrag=function(){};Bn.prototype.onClick=function(){};Bn.prototype.onMouseMove=function(){};Bn.prototype.onMouseDown=function(){};Bn.prototype.onMouseUp=function(){};Bn.prototype.onMouseOut=function(){};Bn.prototype.onKeyUp=function(){};Bn.prototype.onKeyDown=function(){};Bn.prototype.onTouchStart=function(){};Bn.prototype.onTouchMove=function(){};Bn.prototype.onTouchEnd=function(){};Bn.prototype.onTap=function(){};Bn.prototype.onStop=function(){};Bn.prototype.onTrash=function(){};Bn.prototype.onCombineFeature=function(){};Bn.prototype.onUncombineFeature=function(){};Bn.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const Foe={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},bWe=Object.keys(Foe);function wWe(e){const t=Object.keys(e);return function(r,n={}){let a={};const l=t.reduce((i,_)=>(i[_]=e[_],i),new Bn(r));function f(i){return _=>l[i](a,_)}return{start(){a=l.onSetup(n),bWe.forEach(i=>{const _=Foe[i];let b=()=>!1;e[_]&&(b=()=>!0),this.on(i,b,f(_))})},stop(){l.onStop(a)},trash(){l.onTrash(a)},combineFeatures(){l.onCombineFeatures(a)},uncombineFeatures(){l.onUncombineFeatures(a)},render(i,_){l.toDisplayFeatures(a,i,_)}}}}function SWe(e){const t=Object.keys(e.options.modes).reduce((R,F)=>(R[F]=wWe(e.options.modes[F]),R),{});let r={},n={};const a={};let l=null,f=null;a.drag=function(R,F){F({point:R.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:vo.DRAG}),f.drag(R)):R.originalEvent.stopPropagation()},a.mousedrag=function(R){a.drag(R,F=>!RF(r,F))},a.touchdrag=function(R){a.drag(R,F=>!DF(n,F))},a.mousemove=function(R){if((R.originalEvent.buttons!==void 0?R.originalEvent.buttons:R.originalEvent.which)===1)return a.mousedrag(R);const U=qM(R,e);R.featureTarget=U,f.mousemove(R)},a.mousedown=function(R){r={time:new Date().getTime(),point:R.point};const F=qM(R,e);R.featureTarget=F,f.mousedown(R)},a.mouseup=function(R){const F=qM(R,e);R.featureTarget=F,RF(r,{point:R.point,time:new Date().getTime()})?f.click(R):f.mouseup(R)},a.mouseout=function(R){f.mouseout(R)},a.touchstart=function(R){if(!e.options.touchEnabled)return;n={time:new Date().getTime(),point:R.point};const F=mx.touch(R,null,e)[0];R.featureTarget=F,f.touchstart(R)},a.touchmove=function(R){if(e.options.touchEnabled)return f.touchmove(R),a.touchdrag(R)},a.touchend=function(R){if(R.originalEvent.preventDefault(),!e.options.touchEnabled)return;const F=mx.touch(R,null,e)[0];R.featureTarget=F,DF(n,{time:new Date().getTime(),point:R.point})?f.tap(R):f.touchend(R)};const i=R=>!(R===8||R===46||R>=48&&R<=57);a.keydown=function(R){(R.srcElement||R.target).classList.contains(Js.CANVAS)&&((R.keyCode===8||R.keyCode===46)&&e.options.controls.trash?(R.preventDefault(),f.trash()):i(R.keyCode)?f.keydown(R):R.keyCode===49&&e.options.controls.point?_(Jn.DRAW_POINT):R.keyCode===50&&e.options.controls.line_string?_(Jn.DRAW_LINE_STRING):R.keyCode===51&&e.options.controls.polygon&&_(Jn.DRAW_POLYGON))},a.keyup=function(R){i(R.keyCode)&&f.keyup(R)},a.zoomend=function(){e.store.changeZoom()},a.data=function(R){if(R.dataType==="style"){const{setup:F,map:U,options:$,store:H}=e;$.styles.some(G=>U.getLayer(G.id))||(F.addLayers(),H.setDirty(),H.render())}};function _(R,F,U={}){f.stop();const $=t[R];if($===void 0)throw new Error(`${R} is not valid`);l=R;const H=$(e,F);f=PF(H,e),U.silent||e.map.fire(Os.MODE_CHANGE,{mode:R}),e.store.setDirty(),e.store.render()}const b={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function E(R){let F=!1;Object.keys(R).forEach(U=>{if(b[U]===void 0)throw new Error("Invalid action type");b[U]!==R[U]&&(F=!0),b[U]=R[U]}),F&&e.map.fire(Os.ACTIONABLE,{actions:b})}return{start(){l=e.options.defaultMode,f=PF(t[l](e),e)},changeMode:_,actionable:E,currentModeName(){return l},currentModeRender(R,F){return f.render(R,F)},fire(R,F){e.map&&e.map.fire(R,F)},addEventListeners(){e.map.on("mousemove",a.mousemove),e.map.on("mousedown",a.mousedown),e.map.on("mouseup",a.mouseup),e.map.on("data",a.data),e.map.on("touchmove",a.touchmove),e.map.on("touchstart",a.touchstart),e.map.on("touchend",a.touchend),e.container.addEventListener("mouseout",a.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",a.keydown),e.container.addEventListener("keyup",a.keyup))},removeEventListeners(){e.map.off("mousemove",a.mousemove),e.map.off("mousedown",a.mousedown),e.map.off("mouseup",a.mouseup),e.map.off("data",a.data),e.map.off("touchmove",a.touchmove),e.map.off("touchstart",a.touchstart),e.map.off("touchend",a.touchend),e.container.removeEventListener("mouseout",a.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",a.keydown),e.container.removeEventListener("keyup",a.keyup))},trash(R){f.trash(R)},combineFeatures(){f.combineFeatures()},uncombineFeatures(){f.uncombineFeatures()},getMode(){return l}}}function PE(e){return[].concat(e).filter(t=>t!==void 0)}function TWe(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(xc.HOT)!==void 0))return _();const r=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:r});let n=[],a=[];e.isDirty?a=e.getAllIds():(n=e.getChangedIds().filter(b=>e.get(b)!==void 0),a=e.sources.hot.filter(b=>b.properties.id&&n.indexOf(b.properties.id)===-1&&e.get(b.properties.id)!==void 0).map(b=>b.properties.id)),e.sources.hot=[];const l=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(b=>{const E=b.properties.id||b.properties.parent;return n.indexOf(E)===-1});const f=l!==e.sources.cold.length||a.length>0;n.forEach(b=>i(b,"hot")),a.forEach(b=>i(b,"cold"));function i(b,E){const R=e.get(b).internal(r);e.ctx.events.currentModeRender(R,F=>{F.properties.mode=r,e.sources[E].push(F)})}f&&e.ctx.map.getSource(xc.COLD).setData({type:rn.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(xc.HOT).setData({type:rn.FEATURE_COLLECTION,features:e.sources.hot}),_();function _(){e.isDirty=!1,e.clearChangedIds()}}function to(e){this._features={},this._featureIds=new Ac,this._selectedFeatureIds=new Ac,this._selectedCoordinates=[],this._changedFeatureIds=new Ac,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]};let t;this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,TWe.call(this),this._emitSelectionChange&&(this.ctx.events.fire(Os.SELECTION_CHANGE,{features:this.getSelected().map(r=>r.toGeoJSON()),points:this.getSelectedCoordinates().map(r=>({type:rn.FEATURE,properties:{},geometry:{type:rn.POINT,coordinates:r.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(Os.RENDER,{})}))},this.isDirty=!1}to.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};to.prototype.setDirty=function(){return this.isDirty=!0,this};to.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0){const n=this.get(e);this.ctx.events.fire(Os.CREATE,{features:[n.toGeoJSON()]})}return this};to.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0&&this.ctx.events.fire(Os.UPDATE,{action:t.action?t.action:CE.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this};to.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};to.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};to.prototype.getAllIds=function(){return this._featureIds.values()};to.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this};to.prototype.delete=function(e,t={}){const r=[];return PE(e).forEach(n=>{this._featureIds.has(n)&&(this._featureIds.delete(n),this._selectedFeatureIds.delete(n),t.silent||r.indexOf(this._features[n])===-1&&r.push(this._features[n].toGeoJSON()),delete this._features[n],this.isDirty=!0)}),r.length&&this.ctx.events.fire(Os.DELETE,{features:r}),Boe(this,t),this};to.prototype.get=function(e){return this._features[e]};to.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};to.prototype.select=function(e,t={}){return PE(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};to.prototype.deselect=function(e,t={}){return PE(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),Boe(this,t),this};to.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};to.prototype.setSelected=function(e,t={}){return e=PE(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};to.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};to.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};to.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};to.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))};to.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};to.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};to.prototype.setFeatureProperty=function(e,t,r,n={}){this.get(e).setProperty(t,r),this.featureChanged(e,{silent:n.silent,action:CE.CHANGE_PROPERTIES})};function Boe(e,t={}){const r=e._selectedCoordinates.filter(n=>e._selectedFeatureIds.has(n.feature_id));e._selectedCoordinates.length!==r.length&&!t.silent&&(e._emitSelectionChange=!0),e._selectedCoordinates=r}to.prototype.storeMapConfig=function(){Doe.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};to.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};to.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};const EWe=["mode","feature","mouse"];function AWe(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},a={mode:null,feature:null,mouse:null};function l(){f({mode:null,feature:null,mouse:null}),i()}function f(F){a=Object.assign(a,F)}function i(){if(!e.container)return;const F=[],U=[];EWe.forEach($=>{a[$]!==n[$]&&(F.push(`${$}-${n[$]}`),a[$]!==null&&U.push(`${$}-${a[$]}`))}),F.length>0&&e.container.classList.remove(...F),U.length>0&&e.container.classList.add(...U),n=Object.assign(n,a)}function _(F,U={}){const $=document.createElement("button");return $.className=`${Js.CONTROL_BUTTON} ${U.className}`,$.setAttribute("title",U.title),U.container.appendChild($),$.addEventListener("click",H=>{if(H.preventDefault(),H.stopPropagation(),H.target===r){b(),U.onDeactivate();return}E(F),U.onActivate()},!0),$}function b(){r&&(r.classList.remove(Js.ACTIVE_BUTTON),r=null)}function E(F){b();const U=t[F];U&&U&&F!=="trash"&&(U.classList.add(Js.ACTIVE_BUTTON),r=U)}function C(){const F=e.options.controls,U=document.createElement("div");return U.className=`${Js.CONTROL_GROUP} ${Js.CONTROL_BASE}`,F&&(F[rl.LINE]&&(t[rl.LINE]=_(rl.LINE,{container:U,className:Js.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Jn.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),F[rl.POLYGON]&&(t[rl.POLYGON]=_(rl.POLYGON,{container:U,className:Js.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Jn.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),F[rl.POINT]&&(t[rl.POINT]=_(rl.POINT,{container:U,className:Js.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Jn.DRAW_POINT),onDeactivate:()=>e.events.trash()})),F.trash&&(t.trash=_("trash",{container:U,className:Js.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),F.combine_features&&(t.combine_features=_("combineFeatures",{container:U,className:Js.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),F.uncombine_features&&(t.uncombine_features=_("uncombineFeatures",{container:U,className:Js.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),U}function R(){Object.keys(t).forEach(F=>{const U=t[F];U.parentNode&&U.parentNode.removeChild(U),delete t[F]})}return{setActiveButton:E,queueMapClasses:f,updateMapClasses:i,clearMapClasses:l,addButtons:C,removeButtons:R}}function MWe(e){let t=null,r=null;const n={onRemove(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(a){if(e.map=a,e.events=SWe(e),e.ui=AWe(e),e.container=a.getContainer(),e.store=new to(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=a.boxZoom.isEnabled(),a.boxZoom.disable();const l=a.dragPan.isEnabled();a.dragPan.disable(),a.dragPan.enable(),l||a.dragPan.disable()}return a.loaded()?n.connect():(a.on("load",n.connect),r=setInterval(()=>{a.loaded()&&n.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(xc.COLD,{data:{type:rn.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(xc.HOT,{data:{type:rn.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(a=>{e.map.addLayer(a)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(a=>{e.map.getLayer(a.id)&&e.map.removeLayer(a.id)}),e.map.getSource(xc.COLD)&&e.map.removeSource(xc.COLD),e.map.getSource(xc.HOT)&&e.map.removeSource(xc.HOT)}};return e.setup=n,n}const nN="#3bb2d0",_w="#fbb03b",TZ="#fff",$oe=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],_w,nN],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],_w,nN],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":TZ}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],_w,nN]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":TZ}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":_w}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":_w}}];function hR(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}}function Uoe(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0}function $y(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===Ca.ACTIVE&&e.featureTarget.properties.meta===is.FEATURE}function C$(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===Ca.INACTIVE&&e.featureTarget.properties.meta===is.FEATURE}function fR(e){return e.featureTarget===void 0}function P$(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===is.FEATURE}function IE(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===is.VERTEX}function aO(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1}function pR(e){return e.keyCode===27}function mR(e){return e.keyCode===13}function CWe(){return!0}const PWe=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:$y,isEnterKey:mR,isEscapeKey:pR,isFeature:P$,isInactiveFeature:C$,isOfMetaType:hR,isShiftDown:aO,isShiftMousedown:Uoe,isTrue:CWe,isVertex:IE,noTarget:fR},Symbol.toStringTag,{value:"Module"}));function Fp(e,t){this.x=e,this.y=t}Fp.prototype={clone(){return new Fp(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,a=r*this.x+t*this.y;return this.x=n,this.y=a,this},_rotateAround(e,t){const r=Math.cos(e),n=Math.sin(e),a=t.x+r*(this.x-t.x)-n*(this.y-t.y),l=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=a,this.y=l,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Fp};Fp.convert=function(e){if(e instanceof Fp)return e;if(Array.isArray(e))return new Fp(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new Fp(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};function I$(e,t){const r=t.getBoundingClientRect();return new Fp(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}function gx(e,t,r,n){return{type:rn.FEATURE,properties:{meta:is.VERTEX,parent:e,coord_path:r,active:n?Ca.ACTIVE:Ca.INACTIVE},geometry:{type:rn.POINT,coordinates:t}}}function Voe(e,t,r){const n=t.geometry.coordinates,a=r.geometry.coordinates;if(n[1]>kF||n[1]<OF||a[1]>kF||a[1]<OF)return null;const l={lng:(n[0]+a[0])/2,lat:(n[1]+a[1])/2};return{type:rn.FEATURE,properties:{meta:is.MIDPOINT,parent:e,lng:l.lng,lat:l.lat,coord_path:r.properties.coord_path},geometry:{type:rn.POINT,coordinates:[l.lng,l.lat]}}}function gR(e,t={},r=null){const{type:n,coordinates:a}=e.geometry,l=e.properties&&e.properties.id;let f=[];n===rn.POINT?f.push(gx(l,a,r,_(r))):n===rn.POLYGON?a.forEach((E,C)=>{i(E,r!==null?`${r}.${C}`:String(C))}):n===rn.LINE_STRING?i(a,r):n.indexOf(rn.MULTI_PREFIX)===0&&b();function i(E,C){let R="",F=null;E.forEach((U,$)=>{const H=C!=null?`${C}.${$}`:String($),q=gx(l,U,H,_(H));if(t.midpoints&&F){const J=Voe(l,F,q);J&&f.push(J)}F=q;const G=JSON.stringify(U);R!==G&&f.push(q),$===0&&(R=G)})}function _(E){return t.selectedPaths?t.selectedPaths.indexOf(E)!==-1:!1}function b(){const E=n.replace(rn.MULTI_PREFIX,"");a.forEach((C,R)=>{const F={type:rn.FEATURE,properties:e.properties,geometry:{type:E,coordinates:C}};f=f.concat(gR(F,t,R))})}return f}const Ou={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:SM,LAT_MAX:TM,LAT_RENDERED_MIN:EZ,LAT_RENDERED_MAX:AZ,LNG_MIN:MZ,LNG_MAX:CZ}=Loe;function IWe(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],r=[e.geometry.coordinates].flat(t),n=r.map(i=>i[0]),a=r.map(i=>i[1]),l=i=>Math.min.apply(null,i),f=i=>Math.max.apply(null,i);return[l(n),l(a),f(n),f(a)]}function O$(e,t){let r=SM,n=TM,a=SM,l=TM,f=CZ,i=MZ;e.forEach(b=>{const E=IWe(b),C=E[1],R=E[3],F=E[0],U=E[2];C>r&&(r=C),R<n&&(n=R),R>a&&(a=R),C<l&&(l=C),F<f&&(f=F),U>i&&(i=U)});const _=t;return r+_.lat>AZ&&(_.lat=AZ-r),a+_.lat>TM&&(_.lat=TM-a),n+_.lat<EZ&&(_.lat=EZ-n),l+_.lat<SM&&(_.lat=SM-l),f+_.lng<=MZ&&(_.lng+=Math.ceil(Math.abs(_.lng)/360)*360),i+_.lng>=CZ&&(_.lng-=Math.ceil(Math.abs(_.lng)/360)*360),_}function k$(e,t){const r=O$(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const a=n.getCoordinates(),l=b=>{const E={lng:b[0]+r.lng,lat:b[1]+r.lat};return[E.lng,E.lat]},f=b=>b.map(E=>l(E)),i=b=>b.map(E=>f(E));let _;n.type===rn.POINT?_=l(a):n.type===rn.LINE_STRING||n.type===rn.MULTI_POINT?_=a.map(l):n.type===rn.POLYGON||n.type===rn.MULTI_LINE_STRING?_=a.map(f):n.type===rn.MULTI_POLYGON&&(_=a.map(i)),n.incomingCoords(_)})}const Gi={};Gi.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};Gi.fireUpdate=function(){this.fire(Os.UPDATE,{action:CE.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};Gi.fireActionable=function(){const e=this.getSelected(),t=e.filter(l=>this.isInstanceOf("MultiFeature",l));let r=!1;if(e.length>1){r=!0;const l=e[0].type.replace("Multi","");e.forEach(f=>{f.type.replace("Multi","")!==l&&(r=!1)})}const n=t.length>0,a=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:a})};Gi.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new Ac).values():[]};Gi.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};Gi.onStop=function(){Ou.enable(this)};Gi.onMouseMove=function(e,t){return P$(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0};Gi.onMouseOut=function(e){return e.dragMoving?this.fireUpdate():!0};Gi.onTap=Gi.onClick=function(e,t){if(fR(t))return this.clickAnywhere(e,t);if(hR(is.VERTEX)(t))return this.clickOnVertex(e,t);if(P$(t))return this.clickOnFeature(e,t)};Gi.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),Ou.enable(this),this.stopExtendedInteractions(e)};Gi.clickOnVertex=function(e,t){this.changeMode(Jn.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:vo.MOVE})};Gi.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};Gi.clickOnFeature=function(e,t){Ou.disable(this),this.stopExtendedInteractions(e);const r=aO(t),n=this.getSelectedIds(),a=t.featureTarget.properties.id,l=this.isSelected(a);if(!r&&l&&this.getFeature(a).type!==rn.POINT)return this.changeMode(Jn.DIRECT_SELECT,{featureId:a});l&&r?(this.deselect(a),this.updateUIClasses({mouse:vo.POINTER}),n.length===1&&Ou.enable(this)):!l&&r?(this.select(a),this.updateUIClasses({mouse:vo.MOVE})):!l&&!r&&(n.forEach(f=>this.doRender(f)),this.setSelected(a),this.updateUIClasses({mouse:vo.MOVE})),this.doRender(a)};Gi.onMouseDown=function(e,t){if(e.initialDragPanState=this.map.dragPan.isEnabled(),$y(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&Uoe(t))return this.startBoxSelect(e,t)};Gi.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=I$(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};Gi.onTouchStart=function(e,t){if($y(t))return this.startOnActiveFeature(e,t)};Gi.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};Gi.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:vo.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(Js.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=I$(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),a=Math.max(e.boxSelectStartLocation.x,r.x),l=Math.min(e.boxSelectStartLocation.y,r.y),f=Math.max(e.boxSelectStartLocation.y,r.y),i=`translate(${n}px, ${l}px)`;e.boxSelectElement.style.transform=i,e.boxSelectElement.style.WebkitTransform=i,e.boxSelectElement.style.width=`${a-n}px`,e.boxSelectElement.style.height=`${f-l}px`};Gi.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};k$(this.getSelected(),r),e.dragMoveLocation=t.lngLat};Gi.onTouchEnd=Gi.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,I$(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),a=this.getUniqueIds(n).filter(l=>!this.isSelected(l));a.length&&(this.select(a),a.forEach(l=>this.doRender(l)),this.updateUIClasses({mouse:vo.MOVE}))}this.stopExtendedInteractions(e)};Gi.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?Ca.ACTIVE:Ca.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==Ca.ACTIVE||t.geometry.type===rn.POINT)&&gR(t).forEach(r)};Gi.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};Gi.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let a=0;a<e.length;a++){const l=e[a];if(l.type.replace("Multi","")!==n)return;l.type.includes("Multi")?l.getCoordinates().forEach(f=>{t.push(f)}):t.push(l.getCoordinates()),r.push(l.toGeoJSON())}if(r.length>1){const a=this.newFeature({type:rn.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.fire(Os.COMBINE_FEATURES,{createdFeatures:[a.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};Gi.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const a=e[n];this.isInstanceOf("MultiFeature",a)&&(a.getFeatures().forEach(l=>{this.addFeature(l),l.properties=a.properties,t.push(l.toGeoJSON()),this.select([l.id])}),this.deleteFeature(a.id,{silent:!0}),r.push(a.toGeoJSON()))}t.length>1&&this.fire(Os.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};const Woe=hR(is.VERTEX),Goe=hR(is.MIDPOINT),qi={};qi.fireUpdate=function(){this.fire(Os.UPDATE,{action:CE.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};qi.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};qi.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};qi.stopDragging=function(e){e.canDragMove&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};qi.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!aO(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:aO(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const a=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(a)};qi.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};qi.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};qi.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};qi.dragFeature=function(e,t,r){k$(this.getSelected(),r),e.dragMoveLocation=t.lngLat};qi.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(f=>e.feature.getCoordinate(f)),a=n.map(f=>({type:rn.FEATURE,properties:{},geometry:{type:rn.POINT,coordinates:f}})),l=O$(a,r);for(let f=0;f<n.length;f++){const i=n[f];e.feature.updateCoordinate(e.selectedCoordPaths[f],i[0]+l.lng,i[1]+l.lat)}};qi.clickNoTarget=function(){this.changeMode(Jn.SIMPLE_SELECT)};qi.clickInactive=function(){this.changeMode(Jn.SIMPLE_SELECT)};qi.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};qi.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===rn.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),Ou.disable(this),this.setActionableState({trash:!0}),n};qi.onStop=function(){Ou.enable(this),this.clearSelectedCoordinates()};qi.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Ca.ACTIVE,r(t),gR(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=Ca.INACTIVE,r(t)),this.fireActionable(e)};qi.onTrash=function(e){e.selectedCoordPaths.sort((t,r)=>r.localeCompare(t,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(Jn.SIMPLE_SELECT,{}))};qi.onMouseMove=function(e,t){const r=$y(t),n=Woe(t),a=Goe(t),l=e.selectedCoordPaths.length===0;return r&&l?this.updateUIClasses({mouse:vo.MOVE}):n&&!l?this.updateUIClasses({mouse:vo.MOVE}):this.updateUIClasses({mouse:vo.NONE}),(n||r||a)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0};qi.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0};qi.onTouchStart=qi.onMouseDown=function(e,t){if(Woe(t))return this.onVertex(e,t);if($y(t))return this.onFeature(e,t);if(Goe(t))return this.onMidpoint(e,t)};qi.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};qi.onClick=function(e,t){if(fR(t))return this.clickNoTarget(e,t);if($y(t))return this.clickActiveFeature(e,t);if(C$(t))return this.clickInactive(e,t);this.stopDragging(e)};qi.onTap=function(e,t){if(fR(t))return this.clickNoTarget(e,t);if($y(t))return this.clickActiveFeature(e,t);if(C$(t))return this.clickInactive(e,t)};qi.onTouchEnd=qi.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const Dd={};Dd.onSetup=function(){const e=this.newFeature({type:rn.FEATURE,properties:{},geometry:{type:rn.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:vo.ADD}),this.activateUIButton(rl.POINT),this.setActionableState({trash:!0}),{point:e}};Dd.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT)};Dd.onTap=Dd.onClick=function(e,t){this.updateUIClasses({mouse:vo.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(Os.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.point.id]})};Dd.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Dd.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?Ca.ACTIVE:Ca.INACTIVE,!n)return r(t)};Dd.onTrash=Dd.stopDrawingAndRemove;Dd.onKeyUp=function(e,t){if(pR(t)||mR(t))return this.stopDrawingAndRemove(e,t)};function sO(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}const ku={};ku.onSetup=function(){const e=this.newFeature({type:rn.FEATURE,properties:{},geometry:{type:rn.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),Ou.disable(this),this.updateUIClasses({mouse:vo.ADD}),this.activateUIButton(rl.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};ku.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&sO(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:vo.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};ku.clickOnVertex=function(e){return this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};ku.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),IE(t)&&this.updateUIClasses({mouse:vo.POINTER})};ku.onTap=ku.onClick=function(e,t){return IE(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};ku.onKeyUp=function(e,t){pR(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT)):mR(t)&&this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};ku.onStop=function(e){this.updateUIClasses({mouse:vo.NONE}),Ou.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(Os.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT,{},{silent:!0})))};ku.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?Ca.ACTIVE:Ca.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const a=t.geometry.coordinates[0].length;if(!(a<3)){if(t.properties.meta=is.FEATURE,r(gx(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),a>3){const l=t.geometry.coordinates[0].length-3;r(gx(e.polygon.id,t.geometry.coordinates[0][l],`0.${l}`,!1))}if(a<=4){const l=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:rn.FEATURE,properties:t.properties,geometry:{coordinates:l,type:rn.LINE_STRING}}),a===3)return}return r(t)}};ku.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT)};const Ru={};Ru.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,a="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let l=e.from;if(l&&l.type==="Feature"&&l.geometry&&l.geometry.type==="Point"&&(l=l.geometry),l&&l.type==="Point"&&l.coordinates&&l.coordinates.length===2&&(l=l.coordinates),!l||!Array.isArray(l))throw new Error("Please use the `from` property to indicate which point to continue the line from");const f=r.coordinates.length-1;if(r.coordinates[f][0]===l[0]&&r.coordinates[f][1]===l[1])n=f+1,r.addCoordinate(n,...r.coordinates[f]);else if(r.coordinates[0][0]===l[0]&&r.coordinates[0][1]===l[1])a="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:rn.FEATURE,properties:{},geometry:{type:rn.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),Ou.disable(this),this.updateUIClasses({mouse:vo.ADD}),this.activateUIButton(rl.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:a}};Ru.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&sO(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&sO(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:vo.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};Ru.clickOnVertex=function(e){return this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.line.id]})};Ru.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),IE(t)&&this.updateUIClasses({mouse:vo.POINTER})};Ru.onTap=Ru.onClick=function(e,t){if(IE(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};Ru.onKeyUp=function(e,t){mR(t)?this.changeMode(Jn.SIMPLE_SELECT,{featureIds:[e.line.id]}):pR(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT))};Ru.onStop=function(e){Ou.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(Os.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT,{},{silent:!0})))};Ru.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Jn.SIMPLE_SELECT)};Ru.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?Ca.ACTIVE:Ca.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=is.FEATURE,r(gx(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};const qoe={simple_select:Gi,direct_select:qi,draw_point:Dd,draw_polygon:ku,draw_line_string:Ru},OWe={defaultMode:Jn.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:$oe,modes:qoe,controls:{},userProperties:!1,suppressAPIEvents:!0},kWe={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},RWe={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function PZ(e,t){return e.map(r=>r.source?r:Object.assign({},r,{id:`${r.id}.${t}`,source:t==="hot"?xc.HOT:xc.COLD}))}function DWe(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Object.assign({},RWe,e.controls):t.controls=Object.assign({},kWe,e.controls),t=Object.assign({},OWe,t),t.styles=PZ(t.styles,"cold").concat(PZ(t.styles,"hot")),t}var LWe=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,l;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(l=Object.keys(t),n=l.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,l[a]))return!1;for(a=n;a--!==0;){var f=l[a];if(!e(t[f],r[f]))return!1}return!0}return t!==t&&r!==r};const IZ=hi(LWe);var NWe=jWe,zWe={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function jWe(e){if(!e||!e.type)return null;var t=zWe[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}const FWe=hi(NWe);function Hoe(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())}const BWe={Polygon:Jl,LineString:Vd,Point:Em,MultiPolygon:Is,MultiLineString:Is,MultiPoint:Is};function $We(e,t){t.modes=Jn;const r=e.options.suppressAPIEvents!==void 0?!!e.options.suppressAPIEvents:!0;return t.getFeatureIdsAt=function(n){return mx.click({point:n},null,e).map(l=>l.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:rn.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(n=>e.store.get(n)).map(n=>n.toGeoJSON())}},t.getSelectedPoints=function(){return{type:rn.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(n=>({type:rn.FEATURE,properties:{},geometry:{type:rn.POINT,coordinates:n.coordinates}}))}},t.set=function(n){if(n.type===void 0||n.type!==rn.FEATURE_COLLECTION||!Array.isArray(n.features))throw new Error("Invalid FeatureCollection");const a=e.store.createRenderBatch();let l=e.store.getAllIds().slice();const f=t.add(n),i=new Ac(f);return l=l.filter(_=>!i.has(_)),l.length&&t.delete(l),a(),f},t.add=function(n){const l=JSON.parse(JSON.stringify(FWe(n))).features.map(f=>{if(f.id=f.id||M$(),f.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(f.id)===void 0||e.store.get(f.id).type!==f.geometry.type){const i=BWe[f.geometry.type];if(i===void 0)throw new Error(`Invalid geometry type: ${f.geometry.type}.`);const _=new i(e,f);e.store.add(_,{silent:r})}else{const i=e.store.get(f.id),_=i.properties;i.properties=f.properties,IZ(_,f.properties)||e.store.featureChanged(i.id,{silent:r}),IZ(i.getCoordinates(),f.geometry.coordinates)||i.incomingCoords(f.geometry.coordinates)}return f.id});return e.store.render(),l},t.get=function(n){const a=e.store.get(n);if(a)return a.toGeoJSON()},t.getAll=function(){return{type:rn.FEATURE_COLLECTION,features:e.store.getAll().map(n=>n.toGeoJSON())}},t.delete=function(n){return e.store.delete(n,{silent:r}),t.getMode()===Jn.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(Jn.SIMPLE_SELECT,void 0,{silent:r}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:r}),t.getMode()===Jn.DIRECT_SELECT?e.events.changeMode(Jn.SIMPLE_SELECT,void 0,{silent:r}):e.store.render(),t},t.changeMode=function(n,a={}){return n===Jn.SIMPLE_SELECT&&t.getMode()===Jn.SIMPLE_SELECT?(Hoe(a.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(a.featureIds,{silent:r}),e.store.render()),t):(n===Jn.DIRECT_SELECT&&t.getMode()===Jn.DIRECT_SELECT&&a.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(n,a,{silent:r}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:r}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:r}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:r}),t},t.setFeatureProperty=function(n,a,l){return e.store.setFeatureProperty(n,a,l,{silent:r}),t},t}const UWe=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:PWe,ModeHandler:PF,StringSet:Ac,constrainFeatureMovement:O$,createMidPoint:Voe,createSupplementaryPoints:gR,createVertex:gx,doubleClickZoom:Ou,euclideanDistance:A$,featuresAt:mx,getFeatureAtAndSetCursors:qM,isClick:RF,isEventAtCoordinates:sO,isTap:DF,mapEventToBoundingBox:zoe,moveFeatures:k$,sortFeatures:Noe,stringSetsAreEqual:Hoe,theme:$oe,toDenseArray:PE},Symbol.toStringTag,{value:"Module"})),VWe=function(e,t){e=DWe(e);const r={options:e};t=$We(r,t),r.api=t;const n=MWe(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=rl,t.options=e,t};function yR(e){VWe(e,this)}yR.modes=qoe;yR.constants=Loe;yR.lib=UWe;wd.accessToken="pk.eyJ1IjoiY2FybG9zaDIiLCJhIjoiY203aWxlNHU5MXNwNjJzcTNmZGZscThqaSJ9.mt9vzXHbWRtOj6rqrpSD5g";const WWe=({onPolygonComplete:e,orders:t=[]})=>{const r=ne.useRef(null),n=ne.useRef(null),a=ne.useRef(null),l=ne.useRef([]),[f,i]=ne.useState(!1),_=()=>{l.current.forEach(R=>R.remove()),l.current=[]},b=()=>{n.current&&(_(),t.forEach(R=>{if(R.lat&&R.lng){const F=new wd.Marker().setLngLat([R.lng,R.lat]).setPopup(new wd.Popup({offset:25}).setHTML(`<div>
                  <p><strong>Dirección:</strong> ${R.street} ${R.number}</p>
                  <p><strong>Código Postal:</strong> ${R.postal_code}</p>
                </div>`)).addTo(n.current);l.current.push(F)}}))};ne.useEffect(()=>{if(r.current)return n.current=new wd.Map({container:r.current,style:"mapbox://styles/mapbox/streets-v12",center:[-99.1332,19.4326],zoom:11}),a.current=new yR({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}}),n.current.addControl(a.current),n.current.addControl(new wd.NavigationControl,"top-right"),n.current.on("draw.create",R=>{if(R.features&&R.features.length>0&&R.features[0].geometry&&R.features[0].geometry.coordinates){const F=R.features[0].geometry.coordinates[0];e==null||e(F),i(!1)}}),n.current.on("draw.delete",()=>{i(!1)}),n.current.on("load",()=>{b()}),()=>{_(),n.current&&n.current.remove()}},[]),ne.useEffect(()=>{b()},[t]);const E=()=>{a.current&&!f&&(a.current.changeMode("draw_polygon"),i(!0))},C=()=>{a.current&&(a.current.deleteAll(),i(!1))};return j.jsxs(Rd,{className:"h-[600px] flex flex-col",children:[j.jsx("div",{className:"p-4 border-b",children:j.jsxs("div",{className:"flex gap-2",children:[j.jsxs(Zn,{onClick:E,disabled:f,variant:"outline",className:"flex items-center gap-2",children:[j.jsx(Y_,{className:"h-4 w-4"}),"Dibujar Zona"]}),j.jsxs(Zn,{onClick:C,variant:"outline",className:"flex items-center gap-2",children:[j.jsx(Ome,{className:"h-4 w-4"}),"Borrar"]})]})}),j.jsx("div",{className:"flex-1 relative",children:j.jsx("div",{ref:r,className:"absolute inset-0"})})]})},GWe=()=>{const{data:e}=nk({queryKey:["orders"],queryFn:async()=>{const{data:r,error:n}=await mo.from("orders").select("*").not("lat","is",null).not("lng","is",null);if(n)throw n;return r}}),t=r=>{console.log("Polígono completado:",r)};return j.jsxs("div",{className:"animate-fade-in space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Paquetes"})}),j.jsxs("div",{className:"grid gap-6",children:[j.jsx(WWe,{onPolygonComplete:t,orders:e}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(l0,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Gestión de Paquetes"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Aquí podrás gestionar todos los paquetes, agruparlos, imprimir etiquetas y revisar su estado actual."})]})]})]})},qWe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Inventario"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(pme,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Sistema de Gestión de Inventario"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Maneja tu inventario general, organízalo por ubicación, gestiona el inbound y outbound, y más."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),HWe=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Flota"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(XS,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Gestión de Flota y Conductores"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Administra tus conductores y vehículos, revisa documentación, asignaciones y ranking de desempeño."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),ZWe=()=>{const{data:e,isLoading:t}=nk({queryKey:["operators"],queryFn:async()=>{const{data:r,error:n}=await mo.from("operators").select("*").order("created_at",{ascending:!1});if(n)throw n;return r}});return j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Operadores"}),j.jsx(iy,{to:"/admin/operators/new",children:j.jsxs(Zn,{children:[j.jsx(ZP,{className:"mr-2 h-4 w-4"}),"Nuevo Operador"]})})]}),j.jsxs(Rd,{children:[j.jsxs(eb,{children:[j.jsx(tb,{children:"Lista de Operadores"}),j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsxs("div",{className:"relative flex-1",children:[j.jsx(YO,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),j.jsx(Si,{placeholder:"Buscar operador...",className:"pl-8"})]}),j.jsx(Zn,{variant:"outline",size:"icon",children:j.jsx(DJ,{className:"h-4 w-4"})})]})]}),j.jsx(sm,{children:t?j.jsx("div",{className:"py-6 text-center",children:j.jsx("p",{children:"Cargando operadores..."})}):e&&e.length>0?j.jsxs(s$,{children:[j.jsx(l$,{children:j.jsxs(qg,{children:[j.jsx(zl,{children:"ID"}),j.jsx(zl,{children:"Nombre"}),j.jsx(zl,{children:"Correo"}),j.jsx(zl,{children:"Teléfono"}),j.jsx(zl,{children:"CURP"}),j.jsx(zl,{children:"Acciones"})]})}),j.jsx(c$,{children:e.map(r=>j.jsxs(qg,{children:[j.jsx(Es,{className:"font-medium",children:r.short_id}),j.jsx(Es,{children:`${r.name} ${r.lastname} ${r.second_lastname}`}),j.jsx(Es,{children:r.email}),j.jsx(Es,{children:r.phone}),j.jsx(Es,{children:r.curp}),j.jsx(Es,{children:j.jsx(iy,{to:`/admin/operators/${r.id}/edit`,children:j.jsx(Zn,{variant:"ghost",size:"icon",children:j.jsx(Cme,{className:"h-4 w-4"})})})})]},r.id))})]}):j.jsxs("div",{className:"py-6 text-center",children:[j.jsx("h3",{className:"mt-2 text-lg font-semibold",children:"No hay operadores registrados"}),j.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:'Empieza agregando un nuevo operador con el botón "Nuevo Operador".'}),j.jsx(iy,{to:"/admin/operators/new",className:"mt-6 inline-flex",children:j.jsxs(Zn,{children:[j.jsx(ZP,{className:"mr-2 h-4 w-4"}),"Nuevo Operador"]})})]})})]})]})};var OE=e=>e.type==="checkbox",Hg=e=>e instanceof Date,As=e=>e==null;const Zoe=e=>typeof e=="object";var Go=e=>!As(e)&&!Array.isArray(e)&&Zoe(e)&&!Hg(e),Xoe=e=>Go(e)&&e.target?OE(e.target)?e.target.checked:e.target.value:e,XWe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Yoe=(e,t)=>e.has(XWe(t)),YWe=e=>{const t=e.constructor&&e.constructor.prototype;return Go(t)&&t.hasOwnProperty("isPrototypeOf")},R$=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Qs(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(R$&&(e instanceof Blob||e instanceof FileList))&&(r||Go(e)))if(t=r?[]:{},!r&&!YWe(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=Qs(e[n]));else return e;return t}var vR=e=>Array.isArray(e)?e.filter(Boolean):[],No=e=>e===void 0,Sr=(e,t,r)=>{if(!t||!Go(e))return r;const n=vR(t.split(/[,[\].]+?/)).reduce((a,l)=>As(a)?a:a[l],e);return No(n)||n===e?No(e[t])?r:e[t]:n},gc=e=>typeof e=="boolean",D$=e=>/^\w*$/.test(e),Koe=e=>vR(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Ai=(e,t,r)=>{let n=-1;const a=D$(t)?[t]:Koe(t),l=a.length,f=l-1;for(;++n<l;){const i=a[n];let _=r;if(n!==f){const b=e[i];_=Go(b)||Array.isArray(b)?b:isNaN(+a[n+1])?{}:[]}if(i==="__proto__")return;e[i]=_,e=e[i]}return e};const lO={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},vu={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},lh={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Joe=ze.createContext(null),kE=()=>ze.useContext(Joe),Qoe=e=>{const{children:t,...r}=e;return ze.createElement(Joe.Provider,{value:r},t)};var eae=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(a,l,{get:()=>{const f=l;return t._proxyFormState[f]!==vu.all&&(t._proxyFormState[f]=!n||vu.all),r&&(r[f]=!0),e[f]}});return a},tl=e=>Go(e)&&!Object.keys(e).length,tae=(e,t,r,n)=>{r(e);const{name:a,...l}=e;return tl(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(f=>t[f]===(!n||vu.all))},MS=e=>Array.isArray(e)?e:[e],rae=(e,t,r)=>!e||!t||e===t||MS(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function L$(e){const t=ze.useRef(e);t.current=e,ze.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function KWe(e){const t=kE(),{control:r=t.control,disabled:n,name:a,exact:l}=e||{},[f,i]=ze.useState(r._formState),_=ze.useRef(!0),b=ze.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),E=ze.useRef(a);return E.current=a,L$({disabled:n,next:C=>_.current&&rae(E.current,C.name,l)&&tae(C,b.current,r._updateFormState)&&i({...r._formState,...C}),subject:r._subjects.state}),ze.useEffect(()=>(_.current=!0,b.current.isValid&&r._updateValid(!0),()=>{_.current=!1}),[r]),eae(f,r,b.current,!1)}var Sd=e=>typeof e=="string",nae=(e,t,r,n,a)=>Sd(e)?(n&&t.watch.add(e),Sr(r,e,a)):Array.isArray(e)?e.map(l=>(n&&t.watch.add(l),Sr(r,l))):(n&&(t.watchAll=!0),r);function JWe(e){const t=kE(),{control:r=t.control,name:n,defaultValue:a,disabled:l,exact:f}=e||{},i=ze.useRef(n);i.current=n,L$({disabled:l,subject:r._subjects.values,next:E=>{rae(i.current,E.name,f)&&b(Qs(nae(i.current,r._names,E.values||r._formValues,!1,a)))}});const[_,b]=ze.useState(r._getWatch(n,a));return ze.useEffect(()=>r._removeUnmounted()),_}function QWe(e){const t=kE(),{name:r,disabled:n,control:a=t.control,shouldUnregister:l}=e,f=Yoe(a._names.array,r),i=JWe({control:a,name:r,defaultValue:Sr(a._formValues,r,Sr(a._defaultValues,r,e.defaultValue)),exact:!0}),_=KWe({control:a,name:r,exact:!0}),b=ze.useRef(a.register(r,{...e.rules,value:i,...gc(e.disabled)?{disabled:e.disabled}:{}}));return ze.useEffect(()=>{const E=a._options.shouldUnregister||l,C=(R,F)=>{const U=Sr(a._fields,R);U&&U._f&&(U._f.mount=F)};if(C(r,!0),E){const R=Qs(Sr(a._options.defaultValues,r));Ai(a._defaultValues,r,R),No(Sr(a._formValues,r))&&Ai(a._formValues,r,R)}return()=>{(f?E&&!a._state.action:E)?a.unregister(r):C(r,!1)}},[r,a,f,l]),ze.useEffect(()=>{Sr(a._fields,r)&&a._updateDisabledField({disabled:n,fields:a._fields,name:r,value:Sr(a._fields,r)._f.value})},[n,r,a]),{field:{name:r,value:i,...gc(n)||_.disabled?{disabled:_.disabled||n}:{},onChange:ze.useCallback(E=>b.current.onChange({target:{value:Xoe(E),name:r},type:lO.CHANGE}),[r]),onBlur:ze.useCallback(()=>b.current.onBlur({target:{value:Sr(a._formValues,r),name:r},type:lO.BLUR}),[r,a]),ref:ze.useCallback(E=>{const C=Sr(a._fields,r);C&&E&&(C._f.ref={focus:()=>E.focus(),select:()=>E.select(),setCustomValidity:R=>E.setCustomValidity(R),reportValidity:()=>E.reportValidity()})},[a._fields,r])},formState:_,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Sr(_.errors,r)},isDirty:{enumerable:!0,get:()=>!!Sr(_.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Sr(_.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Sr(_.validatingFields,r)},error:{enumerable:!0,get:()=>Sr(_.errors,r)}})}}const eGe=e=>e.render(QWe(e));var iae=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},OZ=e=>({isOnSubmit:!e||e===vu.onSubmit,isOnBlur:e===vu.onBlur,isOnChange:e===vu.onChange,isOnAll:e===vu.all,isOnTouch:e===vu.onTouched}),kZ=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const CS=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const l=Sr(e,a);if(l){const{_f:f,...i}=l;if(f){if(f.refs&&f.refs[0]&&t(f.refs[0],a)&&!n)return!0;if(f.ref&&t(f.ref,f.name)&&!n)return!0;if(CS(i,t))break}else if(Go(i)&&CS(i,t))break}}};var tGe=(e,t,r)=>{const n=MS(Sr(e,r));return Ai(n,"root",t[r]),Ai(e,r,n),e},N$=e=>e.type==="file",Ah=e=>typeof e=="function",cO=e=>{if(!R$)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},HM=e=>Sd(e),z$=e=>e.type==="radio",uO=e=>e instanceof RegExp;const RZ={value:!1,isValid:!1},DZ={value:!0,isValid:!0};var oae=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!No(e[0].attributes.value)?No(e[0].value)||e[0].value===""?DZ:{value:e[0].value,isValid:!0}:DZ:RZ}return RZ};const LZ={isValid:!1,value:null};var aae=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,LZ):LZ;function NZ(e,t,r="validate"){if(HM(e)||Array.isArray(e)&&e.every(HM)||gc(e)&&!e)return{type:r,message:HM(e)?e:"",ref:t}}var f_=e=>Go(e)&&!uO(e)?e:{value:e,message:""},zZ=async(e,t,r,n,a)=>{const{ref:l,refs:f,required:i,maxLength:_,minLength:b,min:E,max:C,pattern:R,validate:F,name:U,valueAsNumber:$,mount:H,disabled:q}=e._f,G=Sr(t,U);if(!H||q)return{};const J=f?f[0]:l,te=$e=>{n&&J.reportValidity&&(J.setCustomValidity(gc($e)?"":$e||""),J.reportValidity())},oe={},he=z$(l),le=OE(l),ve=he||le,We=($||N$(l))&&No(l.value)&&No(G)||cO(l)&&l.value===""||G===""||Array.isArray(G)&&!G.length,Ie=iae.bind(null,U,r,oe),Re=($e,ot,Je,rt=lh.maxLength,st=lh.minLength)=>{const at=$e?ot:Je;oe[U]={type:$e?rt:st,message:at,ref:l,...Ie($e?rt:st,at)}};if(a?!Array.isArray(G)||!G.length:i&&(!ve&&(We||As(G))||gc(G)&&!G||le&&!oae(f).isValid||he&&!aae(f).isValid)){const{value:$e,message:ot}=HM(i)?{value:!!i,message:i}:f_(i);if($e&&(oe[U]={type:lh.required,message:ot,ref:J,...Ie(lh.required,ot)},!r))return te(ot),oe}if(!We&&(!As(E)||!As(C))){let $e,ot;const Je=f_(C),rt=f_(E);if(!As(G)&&!isNaN(G)){const st=l.valueAsNumber||G&&+G;As(Je.value)||($e=st>Je.value),As(rt.value)||(ot=st<rt.value)}else{const st=l.valueAsDate||new Date(G),at=jt=>new Date(new Date().toDateString()+" "+jt),Be=l.type=="time",ct=l.type=="week";Sd(Je.value)&&G&&($e=Be?at(G)>at(Je.value):ct?G>Je.value:st>new Date(Je.value)),Sd(rt.value)&&G&&(ot=Be?at(G)<at(rt.value):ct?G<rt.value:st<new Date(rt.value))}if(($e||ot)&&(Re(!!$e,Je.message,rt.message,lh.max,lh.min),!r))return te(oe[U].message),oe}if((_||b)&&!We&&(Sd(G)||a&&Array.isArray(G))){const $e=f_(_),ot=f_(b),Je=!As($e.value)&&G.length>+$e.value,rt=!As(ot.value)&&G.length<+ot.value;if((Je||rt)&&(Re(Je,$e.message,ot.message),!r))return te(oe[U].message),oe}if(R&&!We&&Sd(G)){const{value:$e,message:ot}=f_(R);if(uO($e)&&!G.match($e)&&(oe[U]={type:lh.pattern,message:ot,ref:l,...Ie(lh.pattern,ot)},!r))return te(ot),oe}if(F){if(Ah(F)){const $e=await F(G,t),ot=NZ($e,J);if(ot&&(oe[U]={...ot,...Ie(lh.validate,ot.message)},!r))return te(ot.message),oe}else if(Go(F)){let $e={};for(const ot in F){if(!tl($e)&&!r)break;const Je=NZ(await F[ot](G,t),J,ot);Je&&($e={...Je,...Ie(ot,Je.message)},te(Je.message),r&&(oe[U]=$e))}if(!tl($e)&&(oe[U]={ref:J,...$e},!r))return oe}}return te(!0),oe};function rGe(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=No(e)?n++:e[t[n++]];return e}function nGe(e){for(const t in e)if(e.hasOwnProperty(t)&&!No(e[t]))return!1;return!0}function da(e,t){const r=Array.isArray(t)?t:D$(t)?[t]:Koe(t),n=r.length===1?e:rGe(e,r),a=r.length-1,l=r[a];return n&&delete n[l],a!==0&&(Go(n)&&tl(n)||Array.isArray(n)&&nGe(n))&&da(e,r.slice(0,-1)),e}var iN=()=>{let e=[];return{get observers(){return e},next:a=>{for(const l of e)l.next&&l.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(l=>l!==a)}}),unsubscribe:()=>{e=[]}}},LF=e=>As(e)||!Zoe(e);function Sp(e,t){if(LF(e)||LF(t))return e===t;if(Hg(e)&&Hg(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r){const l=e[a];if(!n.includes(a))return!1;if(a!=="ref"){const f=t[a];if(Hg(l)&&Hg(f)||Go(l)&&Go(f)||Array.isArray(l)&&Array.isArray(f)?!Sp(l,f):l!==f)return!1}}return!0}var sae=e=>e.type==="select-multiple",iGe=e=>z$(e)||OE(e),oN=e=>cO(e)&&e.isConnected,lae=e=>{for(const t in e)if(Ah(e[t]))return!0;return!1};function dO(e,t={}){const r=Array.isArray(e);if(Go(e)||r)for(const n in e)Array.isArray(e[n])||Go(e[n])&&!lae(e[n])?(t[n]=Array.isArray(e[n])?[]:{},dO(e[n],t[n])):As(e[n])||(t[n]=!0);return t}function cae(e,t,r){const n=Array.isArray(e);if(Go(e)||n)for(const a in e)Array.isArray(e[a])||Go(e[a])&&!lae(e[a])?No(t)||LF(r[a])?r[a]=Array.isArray(e[a])?dO(e[a],[]):{...dO(e[a])}:cae(e[a],As(t)?{}:t[a],r[a]):r[a]=!Sp(e[a],t[a]);return r}var xw=(e,t)=>cae(e,t,dO(t)),uae=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>No(e)?e:t?e===""?NaN:e&&+e:r&&Sd(e)?new Date(e):n?n(e):e;function aN(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return N$(t)?t.files:z$(t)?aae(e.refs).value:sae(t)?[...t.selectedOptions].map(({value:r})=>r):OE(t)?oae(e.refs).value:uae(No(t.value)?e.ref.value:t.value,e)}var oGe=(e,t,r,n)=>{const a={};for(const l of e){const f=Sr(t,l);f&&Ai(a,l,f._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},bw=e=>No(e)?e:uO(e)?e.source:Go(e)?uO(e.value)?e.value.source:e.value:e;const jZ="AsyncFunction";var aGe=e=>(!e||!e.validate)&&!!(Ah(e.validate)&&e.validate.constructor.name===jZ||Go(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===jZ)),sGe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function FZ(e,t,r){const n=Sr(e,r);if(n||D$(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const l=a.join("."),f=Sr(t,l),i=Sr(e,l);if(f&&!Array.isArray(f)&&r!==l)return{name:r};if(i&&i.type)return{name:l,error:i};a.pop()}return{name:r}}var lGe=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,cGe=(e,t)=>!vR(Sr(e,t)).length&&da(e,t);const uGe={mode:vu.onSubmit,reValidateMode:vu.onChange,shouldFocusError:!0};function dGe(e={}){let t={...uGe,...e},r={submitCount:0,isDirty:!1,isLoading:Ah(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=Go(t.defaultValues)||Go(t.values)?Qs(t.defaultValues||t.values)||{}:{},l=t.shouldUnregister?{}:Qs(a),f={action:!1,mount:!1,watch:!1},i={mount:new Set,unMount:new Set,array:new Set,watch:new Set},_,b=0;const E={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},C={values:iN(),array:iN(),state:iN()},R=OZ(t.mode),F=OZ(t.reValidateMode),U=t.criteriaMode===vu.all,$=Ge=>vt=>{clearTimeout(b),b=setTimeout(Ge,vt)},H=async Ge=>{if(!e.disabled&&(E.isValid||Ge)){const vt=t.resolver?tl((await ve()).errors):await Ie(n,!0);vt!==r.isValid&&C.state.next({isValid:vt})}},q=(Ge,vt)=>{!e.disabled&&(E.isValidating||E.validatingFields)&&((Ge||Array.from(i.mount)).forEach(kt=>{kt&&(vt?Ai(r.validatingFields,kt,vt):da(r.validatingFields,kt))}),C.state.next({validatingFields:r.validatingFields,isValidating:!tl(r.validatingFields)}))},G=(Ge,vt=[],kt,dr,lr=!0,sr=!0)=>{if(dr&&kt&&!e.disabled){if(f.action=!0,sr&&Array.isArray(Sr(n,Ge))){const Kt=kt(Sr(n,Ge),dr.argA,dr.argB);lr&&Ai(n,Ge,Kt)}if(sr&&Array.isArray(Sr(r.errors,Ge))){const Kt=kt(Sr(r.errors,Ge),dr.argA,dr.argB);lr&&Ai(r.errors,Ge,Kt),cGe(r.errors,Ge)}if(E.touchedFields&&sr&&Array.isArray(Sr(r.touchedFields,Ge))){const Kt=kt(Sr(r.touchedFields,Ge),dr.argA,dr.argB);lr&&Ai(r.touchedFields,Ge,Kt)}E.dirtyFields&&(r.dirtyFields=xw(a,l)),C.state.next({name:Ge,isDirty:$e(Ge,vt),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Ai(l,Ge,vt)},J=(Ge,vt)=>{Ai(r.errors,Ge,vt),C.state.next({errors:r.errors})},te=Ge=>{r.errors=Ge,C.state.next({errors:r.errors,isValid:!1})},oe=(Ge,vt,kt,dr)=>{const lr=Sr(n,Ge);if(lr){const sr=Sr(l,Ge,No(kt)?Sr(a,Ge):kt);No(sr)||dr&&dr.defaultChecked||vt?Ai(l,Ge,vt?sr:aN(lr._f)):rt(Ge,sr),f.mount&&H()}},he=(Ge,vt,kt,dr,lr)=>{let sr=!1,Kt=!1;const Zr={name:Ge};if(!e.disabled){const fi=!!(Sr(n,Ge)&&Sr(n,Ge)._f&&Sr(n,Ge)._f.disabled);if(!kt||dr){E.isDirty&&(Kt=r.isDirty,r.isDirty=Zr.isDirty=$e(),sr=Kt!==Zr.isDirty);const Qn=fi||Sp(Sr(a,Ge),vt);Kt=!!(!fi&&Sr(r.dirtyFields,Ge)),Qn||fi?da(r.dirtyFields,Ge):Ai(r.dirtyFields,Ge,!0),Zr.dirtyFields=r.dirtyFields,sr=sr||E.dirtyFields&&Kt!==!Qn}if(kt){const Qn=Sr(r.touchedFields,Ge);Qn||(Ai(r.touchedFields,Ge,kt),Zr.touchedFields=r.touchedFields,sr=sr||E.touchedFields&&Qn!==kt)}sr&&lr&&C.state.next(Zr)}return sr?Zr:{}},le=(Ge,vt,kt,dr)=>{const lr=Sr(r.errors,Ge),sr=E.isValid&&gc(vt)&&r.isValid!==vt;if(e.delayError&&kt?(_=$(()=>J(Ge,kt)),_(e.delayError)):(clearTimeout(b),_=null,kt?Ai(r.errors,Ge,kt):da(r.errors,Ge)),(kt?!Sp(lr,kt):lr)||!tl(dr)||sr){const Kt={...dr,...sr&&gc(vt)?{isValid:vt}:{},errors:r.errors,name:Ge};r={...r,...Kt},C.state.next(Kt)}},ve=async Ge=>{q(Ge,!0);const vt=await t.resolver(l,t.context,oGe(Ge||i.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return q(Ge),vt},We=async Ge=>{const{errors:vt}=await ve(Ge);if(Ge)for(const kt of Ge){const dr=Sr(vt,kt);dr?Ai(r.errors,kt,dr):da(r.errors,kt)}else r.errors=vt;return vt},Ie=async(Ge,vt,kt={valid:!0})=>{for(const dr in Ge){const lr=Ge[dr];if(lr){const{_f:sr,...Kt}=lr;if(sr){const Zr=i.array.has(sr.name),fi=lr._f&&aGe(lr._f);fi&&E.validatingFields&&q([dr],!0);const Qn=await zZ(lr,l,U,t.shouldUseNativeValidation&&!vt,Zr);if(fi&&E.validatingFields&&q([dr]),Qn[sr.name]&&(kt.valid=!1,vt))break;!vt&&(Sr(Qn,sr.name)?Zr?tGe(r.errors,Qn,sr.name):Ai(r.errors,sr.name,Qn[sr.name]):da(r.errors,sr.name))}!tl(Kt)&&await Ie(Kt,vt,kt)}}return kt.valid},Re=()=>{for(const Ge of i.unMount){const vt=Sr(n,Ge);vt&&(vt._f.refs?vt._f.refs.every(kt=>!oN(kt)):!oN(vt._f.ref))&&rr(Ge)}i.unMount=new Set},$e=(Ge,vt)=>!e.disabled&&(Ge&&vt&&Ai(l,Ge,vt),!Sp(Lt(),a)),ot=(Ge,vt,kt)=>nae(Ge,i,{...f.mount?l:No(vt)?a:Sd(Ge)?{[Ge]:vt}:vt},kt,vt),Je=Ge=>vR(Sr(f.mount?l:a,Ge,e.shouldUnregister?Sr(a,Ge,[]):[])),rt=(Ge,vt,kt={})=>{const dr=Sr(n,Ge);let lr=vt;if(dr){const sr=dr._f;sr&&(!sr.disabled&&Ai(l,Ge,uae(vt,sr)),lr=cO(sr.ref)&&As(vt)?"":vt,sae(sr.ref)?[...sr.ref.options].forEach(Kt=>Kt.selected=lr.includes(Kt.value)):sr.refs?OE(sr.ref)?sr.refs.length>1?sr.refs.forEach(Kt=>(!Kt.defaultChecked||!Kt.disabled)&&(Kt.checked=Array.isArray(lr)?!!lr.find(Zr=>Zr===Kt.value):lr===Kt.value)):sr.refs[0]&&(sr.refs[0].checked=!!lr):sr.refs.forEach(Kt=>Kt.checked=Kt.value===lr):N$(sr.ref)?sr.ref.value="":(sr.ref.value=lr,sr.ref.type||C.values.next({name:Ge,values:{...l}})))}(kt.shouldDirty||kt.shouldTouch)&&he(Ge,lr,kt.shouldTouch,kt.shouldDirty,!0),kt.shouldValidate&&jt(Ge)},st=(Ge,vt,kt)=>{for(const dr in vt){const lr=vt[dr],sr=`${Ge}.${dr}`,Kt=Sr(n,sr);(i.array.has(Ge)||Go(lr)||Kt&&!Kt._f)&&!Hg(lr)?st(sr,lr,kt):rt(sr,lr,kt)}},at=(Ge,vt,kt={})=>{const dr=Sr(n,Ge),lr=i.array.has(Ge),sr=Qs(vt);Ai(l,Ge,sr),lr?(C.array.next({name:Ge,values:{...l}}),(E.isDirty||E.dirtyFields)&&kt.shouldDirty&&C.state.next({name:Ge,dirtyFields:xw(a,l),isDirty:$e(Ge,sr)})):dr&&!dr._f&&!As(sr)?st(Ge,sr,kt):rt(Ge,sr,kt),kZ(Ge,i)&&C.state.next({...r}),C.values.next({name:f.mount?Ge:void 0,values:{...l}})},Be=async Ge=>{f.mount=!0;const vt=Ge.target;let kt=vt.name,dr=!0;const lr=Sr(n,kt),sr=()=>vt.type?aN(lr._f):Xoe(Ge),Kt=Zr=>{dr=Number.isNaN(Zr)||Hg(Zr)&&isNaN(Zr.getTime())||Sp(Zr,Sr(l,kt,Zr))};if(lr){let Zr,fi;const Qn=sr(),Pi=Ge.type===lO.BLUR||Ge.type===lO.FOCUS_OUT,qo=!sGe(lr._f)&&!t.resolver&&!Sr(r.errors,kt)&&!lr._f.deps||lGe(Pi,Sr(r.touchedFields,kt),r.isSubmitted,F,R),na=kZ(kt,i,Pi);Ai(l,kt,Qn),Pi?(lr._f.onBlur&&lr._f.onBlur(Ge),_&&_(0)):lr._f.onChange&&lr._f.onChange(Ge);const yl=he(kt,Qn,Pi,!1),Ql=!tl(yl)||na;if(!Pi&&C.values.next({name:kt,type:Ge.type,values:{...l}}),qo)return E.isValid&&(e.mode==="onBlur"?Pi&&H():H()),Ql&&C.state.next({name:kt,...na?{}:yl});if(!Pi&&na&&C.state.next({...r}),t.resolver){const{errors:ls}=await ve([kt]);if(Kt(Qn),dr){const vl=FZ(r.errors,n,kt),Co=FZ(ls,n,vl.name||kt);Zr=Co.error,kt=Co.name,fi=tl(ls)}}else q([kt],!0),Zr=(await zZ(lr,l,U,t.shouldUseNativeValidation))[kt],q([kt]),Kt(Qn),dr&&(Zr?fi=!1:E.isValid&&(fi=await Ie(n,!0)));dr&&(lr._f.deps&&jt(lr._f.deps),le(kt,fi,Zr,yl))}},ct=(Ge,vt)=>{if(Sr(r.errors,vt)&&Ge.focus)return Ge.focus(),1},jt=async(Ge,vt={})=>{let kt,dr;const lr=MS(Ge);if(t.resolver){const sr=await We(No(Ge)?Ge:lr);kt=tl(sr),dr=Ge?!lr.some(Kt=>Sr(sr,Kt)):kt}else Ge?(dr=(await Promise.all(lr.map(async sr=>{const Kt=Sr(n,sr);return await Ie(Kt&&Kt._f?{[sr]:Kt}:Kt)}))).every(Boolean),!(!dr&&!r.isValid)&&H()):dr=kt=await Ie(n);return C.state.next({...!Sd(Ge)||E.isValid&&kt!==r.isValid?{}:{name:Ge},...t.resolver||!Ge?{isValid:kt}:{},errors:r.errors}),vt.shouldFocus&&!dr&&CS(n,ct,Ge?lr:i.mount),dr},Lt=Ge=>{const vt={...f.mount?l:a};return No(Ge)?vt:Sd(Ge)?Sr(vt,Ge):Ge.map(kt=>Sr(vt,kt))},$t=(Ge,vt)=>({invalid:!!Sr((vt||r).errors,Ge),isDirty:!!Sr((vt||r).dirtyFields,Ge),error:Sr((vt||r).errors,Ge),isValidating:!!Sr(r.validatingFields,Ge),isTouched:!!Sr((vt||r).touchedFields,Ge)}),ut=Ge=>{Ge&&MS(Ge).forEach(vt=>da(r.errors,vt)),C.state.next({errors:Ge?r.errors:{}})},tr=(Ge,vt,kt)=>{const dr=(Sr(n,Ge,{_f:{}})._f||{}).ref,lr=Sr(r.errors,Ge)||{},{ref:sr,message:Kt,type:Zr,...fi}=lr;Ai(r.errors,Ge,{...fi,...vt,ref:dr}),C.state.next({name:Ge,errors:r.errors,isValid:!1}),kt&&kt.shouldFocus&&dr&&dr.focus&&dr.focus()},mr=(Ge,vt)=>Ah(Ge)?C.values.subscribe({next:kt=>Ge(ot(void 0,vt),kt)}):ot(Ge,vt,!0),rr=(Ge,vt={})=>{for(const kt of Ge?MS(Ge):i.mount)i.mount.delete(kt),i.array.delete(kt),vt.keepValue||(da(n,kt),da(l,kt)),!vt.keepError&&da(r.errors,kt),!vt.keepDirty&&da(r.dirtyFields,kt),!vt.keepTouched&&da(r.touchedFields,kt),!vt.keepIsValidating&&da(r.validatingFields,kt),!t.shouldUnregister&&!vt.keepDefaultValue&&da(a,kt);C.values.next({values:{...l}}),C.state.next({...r,...vt.keepDirty?{isDirty:$e()}:{}}),!vt.keepIsValid&&H()},Ut=({disabled:Ge,name:vt,field:kt,fields:dr,value:lr})=>{if(gc(Ge)&&f.mount||Ge){const sr=Ge?void 0:No(lr)?aN(kt?kt._f:Sr(dr,vt)._f):lr;Ai(l,vt,sr),he(vt,sr,!1,!1,!0)}},gr=(Ge,vt={})=>{let kt=Sr(n,Ge);const dr=gc(vt.disabled)||gc(e.disabled);return Ai(n,Ge,{...kt||{},_f:{...kt&&kt._f?kt._f:{ref:{name:Ge}},name:Ge,mount:!0,...vt}}),i.mount.add(Ge),kt?Ut({field:kt,disabled:gc(vt.disabled)?vt.disabled:e.disabled,name:Ge,value:vt.value}):oe(Ge,!0,vt.value),{...dr?{disabled:vt.disabled||e.disabled}:{},...t.progressive?{required:!!vt.required,min:bw(vt.min),max:bw(vt.max),minLength:bw(vt.minLength),maxLength:bw(vt.maxLength),pattern:bw(vt.pattern)}:{},name:Ge,onChange:Be,onBlur:Be,ref:lr=>{if(lr){gr(Ge,vt),kt=Sr(n,Ge);const sr=No(lr.value)&&lr.querySelectorAll&&lr.querySelectorAll("input,select,textarea")[0]||lr,Kt=iGe(sr),Zr=kt._f.refs||[];if(Kt?Zr.find(fi=>fi===sr):sr===kt._f.ref)return;Ai(n,Ge,{_f:{...kt._f,...Kt?{refs:[...Zr.filter(oN),sr,...Array.isArray(Sr(a,Ge))?[{}]:[]],ref:{type:sr.type,name:Ge}}:{ref:sr}}}),oe(Ge,!1,void 0,sr)}else kt=Sr(n,Ge,{}),kt._f&&(kt._f.mount=!1),(t.shouldUnregister||vt.shouldUnregister)&&!(Yoe(i.array,Ge)&&f.action)&&i.unMount.add(Ge)}}},Gt=()=>t.shouldFocusError&&CS(n,ct,i.mount),ge=Ge=>{gc(Ge)&&(C.state.next({disabled:Ge}),CS(n,(vt,kt)=>{const dr=Sr(n,kt);dr&&(vt.disabled=dr._f.disabled||Ge,Array.isArray(dr._f.refs)&&dr._f.refs.forEach(lr=>{lr.disabled=dr._f.disabled||Ge}))},0,!1))},cr=(Ge,vt)=>async kt=>{let dr;kt&&(kt.preventDefault&&kt.preventDefault(),kt.persist&&kt.persist());let lr=Qs(l);if(C.state.next({isSubmitting:!0}),t.resolver){const{errors:sr,values:Kt}=await ve();r.errors=sr,lr=Kt}else await Ie(n);if(da(r.errors,"root"),tl(r.errors)){C.state.next({errors:{}});try{await Ge(lr,kt)}catch(sr){dr=sr}}else vt&&await vt({...r.errors},kt),Gt(),setTimeout(Gt);if(C.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:tl(r.errors)&&!dr,submitCount:r.submitCount+1,errors:r.errors}),dr)throw dr},Ot=(Ge,vt={})=>{Sr(n,Ge)&&(No(vt.defaultValue)?at(Ge,Qs(Sr(a,Ge))):(at(Ge,vt.defaultValue),Ai(a,Ge,Qs(vt.defaultValue))),vt.keepTouched||da(r.touchedFields,Ge),vt.keepDirty||(da(r.dirtyFields,Ge),r.isDirty=vt.defaultValue?$e(Ge,Qs(Sr(a,Ge))):$e()),vt.keepError||(da(r.errors,Ge),E.isValid&&H()),C.state.next({...r}))},Pr=(Ge,vt={})=>{const kt=Ge?Qs(Ge):a,dr=Qs(kt),lr=tl(Ge),sr=lr?a:dr;if(vt.keepDefaultValues||(a=kt),!vt.keepValues){if(vt.keepDirtyValues){const Kt=new Set([...i.mount,...Object.keys(xw(a,l))]);for(const Zr of Array.from(Kt))Sr(r.dirtyFields,Zr)?Ai(sr,Zr,Sr(l,Zr)):at(Zr,Sr(sr,Zr))}else{if(R$&&No(Ge))for(const Kt of i.mount){const Zr=Sr(n,Kt);if(Zr&&Zr._f){const fi=Array.isArray(Zr._f.refs)?Zr._f.refs[0]:Zr._f.ref;if(cO(fi)){const Qn=fi.closest("form");if(Qn){Qn.reset();break}}}}n={}}l=e.shouldUnregister?vt.keepDefaultValues?Qs(a):{}:Qs(sr),C.array.next({values:{...sr}}),C.values.next({values:{...sr}})}i={mount:vt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},f.mount=!E.isValid||!!vt.keepIsValid||!!vt.keepDirtyValues,f.watch=!!e.shouldUnregister,C.state.next({submitCount:vt.keepSubmitCount?r.submitCount:0,isDirty:lr?!1:vt.keepDirty?r.isDirty:!!(vt.keepDefaultValues&&!Sp(Ge,a)),isSubmitted:vt.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:lr?{}:vt.keepDirtyValues?vt.keepDefaultValues&&l?xw(a,l):r.dirtyFields:vt.keepDefaultValues&&Ge?xw(a,Ge):vt.keepDirty?r.dirtyFields:{},touchedFields:vt.keepTouched?r.touchedFields:{},errors:vt.keepErrors?r.errors:{},isSubmitSuccessful:vt.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},_t=(Ge,vt)=>Pr(Ah(Ge)?Ge(l):Ge,vt);return{control:{register:gr,unregister:rr,getFieldState:$t,handleSubmit:cr,setError:tr,_executeSchema:ve,_getWatch:ot,_getDirty:$e,_updateValid:H,_removeUnmounted:Re,_updateFieldArray:G,_updateDisabledField:Ut,_getFieldArray:Je,_reset:Pr,_resetDefaultValues:()=>Ah(t.defaultValues)&&t.defaultValues().then(Ge=>{_t(Ge,t.resetOptions),C.state.next({isLoading:!1})}),_updateFormState:Ge=>{r={...r,...Ge}},_disableForm:ge,_subjects:C,_proxyFormState:E,_setErrors:te,get _fields(){return n},get _formValues(){return l},get _state(){return f},set _state(Ge){f=Ge},get _defaultValues(){return a},get _names(){return i},set _names(Ge){i=Ge},get _formState(){return r},set _formState(Ge){r=Ge},get _options(){return t},set _options(Ge){t={...t,...Ge}}},trigger:jt,register:gr,handleSubmit:cr,watch:mr,setValue:at,getValues:Lt,reset:_t,resetField:Ot,clearErrors:ut,unregister:rr,setError:tr,setFocus:(Ge,vt={})=>{const kt=Sr(n,Ge),dr=kt&&kt._f;if(dr){const lr=dr.refs?dr.refs[0]:dr.ref;lr.focus&&(lr.focus(),vt.shouldSelect&&lr.select())}},getFieldState:$t}}function j$(e={}){const t=ze.useRef(),r=ze.useRef(),[n,a]=ze.useState({isDirty:!1,isValidating:!1,isLoading:Ah(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Ah(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...dGe(e),formState:n});const l=t.current.control;return l._options=e,L$({subject:l._subjects.state,next:f=>{tae(f,l._proxyFormState,l._updateFormState,!0)&&a({...l._formState})}}),ze.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),ze.useEffect(()=>{if(l._proxyFormState.isDirty){const f=l._getDirty();f!==n.isDirty&&l._subjects.state.next({isDirty:f})}},[l,n.isDirty]),ze.useEffect(()=>{e.values&&!Sp(e.values,r.current)?(l._reset(e.values,l._options.resetOptions),r.current=e.values,a(f=>({...f}))):l._resetDefaultValues()},[e.values,l]),ze.useEffect(()=>{e.errors&&l._setErrors(e.errors)},[e.errors,l]),ze.useEffect(()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),ze.useEffect(()=>{e.shouldUnregister&&l._subjects.values.next({values:l._getWatch()})},[e.shouldUnregister,l]),ze.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[n]),t.current.formState=eae(n,l),t.current}var hGe="Label",dae=ne.forwardRef((e,t)=>j.jsx(In.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));dae.displayName=hGe;var hae=dae;const fGe=fE("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fae=ne.forwardRef(({className:e,...t},r)=>j.jsx(hae,{ref:r,className:Nr(fGe(),e),...t}));fae.displayName=hae.displayName;const pae=Qoe,mae=ne.createContext({}),Ss=({...e})=>j.jsx(mae.Provider,{value:{name:e.name},children:j.jsx(eGe,{...e})}),_R=()=>{const e=ne.useContext(mae),t=ne.useContext(gae),{getFieldState:r,formState:n}=kE(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...a}},gae=ne.createContext({}),ha=ne.forwardRef(({className:e,...t},r)=>{const n=ne.useId();return j.jsx(gae.Provider,{value:{id:n},children:j.jsx("div",{ref:r,className:Nr("space-y-2",e),...t})})});ha.displayName="FormItem";const fa=ne.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=_R();return j.jsx(fae,{ref:r,className:Nr(n&&"text-destructive",e),htmlFor:a,...t})});fa.displayName="FormLabel";const pa=ne.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:l}=_R();return j.jsx(Bh,{ref:t,id:n,"aria-describedby":r?`${a} ${l}`:`${a}`,"aria-invalid":!!r,...e})});pa.displayName="FormControl";const pGe=ne.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=_R();return j.jsx("p",{ref:r,id:n,className:Nr("text-sm text-muted-foreground",e),...t})});pGe.displayName="FormDescription";const es=ne.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:l}=_R(),f=a?String(a==null?void 0:a.message):t;return f?j.jsx("p",{ref:n,id:l,className:Nr("text-sm font-medium text-destructive",e),...r,children:f}):null});es.displayName="FormMessage";const BZ=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Sr(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},yae=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?BZ(n.ref,r,e):n.refs&&n.refs.forEach(a=>BZ(a,r,e))}},mGe=(e,t)=>{t.shouldUseNativeValidation&&yae(e,t);const r={};for(const n in e){const a=Sr(t.fields,n),l=Object.assign(e[n]||{},{ref:a&&a.ref});if(gGe(t.names||Object.keys(e),n)){const f=Object.assign({},Sr(r,n));Ai(f,"root",l),Ai(r,n,f)}else Ai(r,n,l)}return r},gGe=(e,t)=>e.some(r=>r.startsWith(t+"."));var yGe=function(e,t){for(var r={};e.length;){var n=e[0],a=n.code,l=n.message,f=n.path.join(".");if(!r[f])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];r[f]={message:i.message,type:i.code}}else r[f]={message:l,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(E){return E.errors.forEach(function(C){return e.push(C)})}),t){var _=r[f].types,b=_&&_[n.code];r[f]=iae(f,t,r,a,b?[].concat(b,n.message):n.message)}e.shift()}return r},vae=function(e,t,r){return r===void 0&&(r={}),function(n,a,l){try{return Promise.resolve(function(f,i){try{var _=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(b){return l.shouldUseNativeValidation&&yae({},l),{errors:{},values:r.raw?n:b}})}catch(b){return i(b)}return _&&_.then?_.then(void 0,i):_}(0,function(f){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(f))return{values:{},errors:mGe(yGe(f.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw f}))}catch(f){return Promise.reject(f)}}};function vi(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Zl(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ms(e,t){const r=vi(e);return isNaN(t)?Zl(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Du(e,t){const r=vi(e);if(isNaN(t))return Zl(e,NaN);if(!t)return r;const n=r.getDate(),a=Zl(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const l=a.getDate();return n>=l?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const F$=6048e5,vGe=864e5;let _Ge={};function RE(){return _Ge}function Ld(e,t){var i,_,b,E;const r=RE(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((E=(b=r.locale)==null?void 0:b.options)==null?void 0:E.weekStartsOn)??0,a=vi(e),l=a.getDay(),f=(l<n?7:0)+l-n;return a.setDate(a.getDate()-f),a.setHours(0,0,0,0),a}function Ay(e){return Ld(e,{weekStartsOn:1})}function _ae(e){const t=vi(e),r=t.getFullYear(),n=Zl(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=Ay(n),l=Zl(e,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const f=Ay(l);return t.getTime()>=a.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function yx(e){const t=vi(e);return t.setHours(0,0,0,0),t}function hO(e){const t=vi(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Td(e,t){const r=yx(e),n=yx(t),a=+r-hO(r),l=+n-hO(n);return Math.round((a-l)/vGe)}function xGe(e){const t=_ae(e),r=Zl(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Ay(r)}function NF(e,t){const r=t*7;return Ms(e,r)}function bGe(e,t){return Du(e,t*12)}function wGe(e){let t;return e.forEach(function(r){const n=vi(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function SGe(e){let t;return e.forEach(r=>{const n=vi(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function ll(e,t){const r=yx(e),n=yx(t);return+r==+n}function B$(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function TGe(e){if(!B$(e)&&typeof e!="number")return!1;const t=vi(e);return!isNaN(Number(t))}function FT(e,t){const r=vi(e),n=vi(t),a=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return a*12+l}function EGe(e,t,r){const n=Ld(e,r),a=Ld(t,r),l=+n-hO(n),f=+a-hO(a);return Math.round((l-f)/F$)}function $$(e){const t=vi(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function fl(e){const t=vi(e);return t.setDate(1),t.setHours(0,0,0,0),t}function xae(e){const t=vi(e),r=Zl(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function U$(e,t){var i,_,b,E;const r=RE(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((E=(b=r.locale)==null?void 0:b.options)==null?void 0:E.weekStartsOn)??0,a=vi(e),l=a.getDay(),f=(l<n?-7:0)+6-(l-n);return a.setDate(a.getDate()+f),a.setHours(23,59,59,999),a}function bae(e){return U$(e,{weekStartsOn:1})}const AGe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},MGe=(e,t,r)=>{let n;const a=AGe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function sN(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const CGe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},PGe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},IGe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},OGe={date:sN({formats:CGe,defaultWidth:"full"}),time:sN({formats:PGe,defaultWidth:"full"}),dateTime:sN({formats:IGe,defaultWidth:"full"})},kGe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},RGe=(e,t,r,n)=>kGe[e];function ww(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const f=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):f;a=e.formattingValues[i]||e.formattingValues[f]}else{const f=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[i]||e.values[f]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const DGe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},LGe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},NGe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},zGe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jGe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},FGe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},BGe=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},$Ge={ordinalNumber:BGe,era:ww({values:DGe,defaultWidth:"wide"}),quarter:ww({values:LGe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ww({values:NGe,defaultWidth:"wide"}),day:ww({values:zGe,defaultWidth:"wide"}),dayPeriod:ww({values:jGe,defaultWidth:"wide",formattingValues:FGe,defaultFormattingWidth:"wide"})};function Sw(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const f=l[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],_=Array.isArray(i)?VGe(i,C=>C.test(f)):UGe(i,C=>C.test(f));let b;b=e.valueCallback?e.valueCallback(_):_,b=r.valueCallback?r.valueCallback(b):b;const E=t.slice(f.length);return{value:b,rest:E}}}function UGe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function VGe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function WGe(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],l=t.match(e.parsePattern);if(!l)return null;let f=e.valueCallback?e.valueCallback(l[0]):l[0];f=r.valueCallback?r.valueCallback(f):f;const i=t.slice(a.length);return{value:f,rest:i}}}const GGe=/^(\d+)(th|st|nd|rd)?/i,qGe=/\d+/i,HGe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ZGe={any:[/^b/i,/^(a|c)/i]},XGe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},YGe={any:[/1/i,/2/i,/3/i,/4/i]},KGe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},JGe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},QGe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},eqe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},tqe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},rqe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},nqe={ordinalNumber:WGe({matchPattern:GGe,parsePattern:qGe,valueCallback:e=>parseInt(e,10)}),era:Sw({matchPatterns:HGe,defaultMatchWidth:"wide",parsePatterns:ZGe,defaultParseWidth:"any"}),quarter:Sw({matchPatterns:XGe,defaultMatchWidth:"wide",parsePatterns:YGe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Sw({matchPatterns:KGe,defaultMatchWidth:"wide",parsePatterns:JGe,defaultParseWidth:"any"}),day:Sw({matchPatterns:QGe,defaultMatchWidth:"wide",parsePatterns:eqe,defaultParseWidth:"any"}),dayPeriod:Sw({matchPatterns:tqe,defaultMatchWidth:"any",parsePatterns:rqe,defaultParseWidth:"any"})},wae={code:"en-US",formatDistance:MGe,formatLong:OGe,formatRelative:RGe,localize:$Ge,match:nqe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function iqe(e){const t=vi(e);return Td(t,xae(t))+1}function Sae(e){const t=vi(e),r=+Ay(t)-+xGe(t);return Math.round(r/F$)+1}function Tae(e,t){var E,C,R,F;const r=vi(e),n=r.getFullYear(),a=RE(),l=(t==null?void 0:t.firstWeekContainsDate)??((C=(E=t==null?void 0:t.locale)==null?void 0:E.options)==null?void 0:C.firstWeekContainsDate)??a.firstWeekContainsDate??((F=(R=a.locale)==null?void 0:R.options)==null?void 0:F.firstWeekContainsDate)??1,f=Zl(e,0);f.setFullYear(n+1,0,l),f.setHours(0,0,0,0);const i=Ld(f,t),_=Zl(e,0);_.setFullYear(n,0,l),_.setHours(0,0,0,0);const b=Ld(_,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=b.getTime()?n:n-1}function oqe(e,t){var i,_,b,E;const r=RE(),n=(t==null?void 0:t.firstWeekContainsDate)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.firstWeekContainsDate)??r.firstWeekContainsDate??((E=(b=r.locale)==null?void 0:b.options)==null?void 0:E.firstWeekContainsDate)??1,a=Tae(e,t),l=Zl(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),Ld(l,t)}function Eae(e,t){const r=vi(e),n=+Ld(r,t)-+oqe(r,t);return Math.round(n/F$)+1}function ki(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const np={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return ki(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):ki(r+1,2)},d(e,t){return ki(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return ki(e.getHours()%12||12,t.length)},H(e,t){return ki(e.getHours(),t.length)},m(e,t){return ki(e.getMinutes(),t.length)},s(e,t){return ki(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return ki(a,t.length)}},p_={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$Z={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return np.y(e,t)},Y:function(e,t,r,n){const a=Tae(e,n),l=a>0?a:1-a;if(t==="YY"){const f=l%100;return ki(f,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):ki(l,t.length)},R:function(e,t){const r=_ae(e);return ki(r,t.length)},u:function(e,t){const r=e.getFullYear();return ki(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return ki(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return ki(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return np.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return ki(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=Eae(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):ki(a,t.length)},I:function(e,t,r){const n=Sae(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):ki(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):np.d(e,t)},D:function(e,t,r){const n=iqe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ki(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return ki(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return ki(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return ki(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=p_.noon:n===0?a=p_.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=p_.evening:n>=12?a=p_.afternoon:n>=4?a=p_.morning:a=p_.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return np.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):np.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ki(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):ki(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):np.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):np.s(e,t)},S:function(e,t){return np.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return VZ(n);case"XXXX":case"XX":return Ig(n);case"XXXXX":case"XXX":default:return Ig(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return VZ(n);case"xxxx":case"xx":return Ig(n);case"xxxxx":case"xxx":default:return Ig(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+UZ(n,":");case"OOOO":default:return"GMT"+Ig(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+UZ(n,":");case"zzzz":default:return"GMT"+Ig(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return ki(n,t.length)},T:function(e,t,r){const n=e.getTime();return ki(n,t.length)}};function UZ(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?r+String(a):r+String(a)+t+ki(l,2)}function VZ(e,t){return e%60===0?(e>0?"-":"+")+ki(Math.abs(e)/60,2):Ig(e,t)}function Ig(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=ki(Math.trunc(n/60),2),l=ki(n%60,2);return r+a+t+l}const WZ=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Aae=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},aqe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return WZ(e,t);let l;switch(n){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",WZ(n,t)).replace("{{time}}",Aae(a,t))},sqe={p:Aae,P:aqe},lqe=/^D+$/,cqe=/^Y+$/,uqe=["D","DD","YY","YYYY"];function dqe(e){return lqe.test(e)}function hqe(e){return cqe.test(e)}function fqe(e,t,r){const n=pqe(e,t,r);if(console.warn(n),uqe.includes(e))throw new RangeError(n)}function pqe(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const mqe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,gqe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yqe=/^'([^]*?)'?$/,vqe=/''/g,_qe=/[a-zA-Z]/;function ef(e,t,r){var E,C,R,F,U,$,H,q;const n=RE(),a=(r==null?void 0:r.locale)??n.locale??wae,l=(r==null?void 0:r.firstWeekContainsDate)??((C=(E=r==null?void 0:r.locale)==null?void 0:E.options)==null?void 0:C.firstWeekContainsDate)??n.firstWeekContainsDate??((F=(R=n.locale)==null?void 0:R.options)==null?void 0:F.firstWeekContainsDate)??1,f=(r==null?void 0:r.weekStartsOn)??(($=(U=r==null?void 0:r.locale)==null?void 0:U.options)==null?void 0:$.weekStartsOn)??n.weekStartsOn??((q=(H=n.locale)==null?void 0:H.options)==null?void 0:q.weekStartsOn)??0,i=vi(e);if(!TGe(i))throw new RangeError("Invalid time value");let _=t.match(gqe).map(G=>{const J=G[0];if(J==="p"||J==="P"){const te=sqe[J];return te(G,a.formatLong)}return G}).join("").match(mqe).map(G=>{if(G==="''")return{isToken:!1,value:"'"};const J=G[0];if(J==="'")return{isToken:!1,value:xqe(G)};if($Z[J])return{isToken:!0,value:G};if(J.match(_qe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+J+"`");return{isToken:!1,value:G}});a.localize.preprocessor&&(_=a.localize.preprocessor(i,_));const b={firstWeekContainsDate:l,weekStartsOn:f,locale:a};return _.map(G=>{if(!G.isToken)return G.value;const J=G.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&hqe(J)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&dqe(J))&&fqe(J,t,String(e));const te=$Z[J[0]];return te(i,J,a.localize,b)}).join("")}function xqe(e){const t=e.match(yqe);return t?t[1].replace(vqe,"'"):e}function bqe(e){const t=vi(e),r=t.getFullYear(),n=t.getMonth(),a=Zl(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function wqe(e){return Math.trunc(+vi(e)/1e3)}function Sqe(e){const t=vi(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Tqe(e,t){return EGe(Sqe(e),fl(e),t)+1}function zF(e,t){const r=vi(e),n=vi(t);return r.getTime()>n.getTime()}function Mae(e,t){const r=vi(e),n=vi(t);return+r<+n}function V$(e,t){const r=vi(e),n=vi(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Eqe(e,t){const r=vi(e),n=vi(t);return r.getFullYear()===n.getFullYear()}function lN(e,t){return Ms(e,-t)}function cN(e,t){const r=vi(e),n=r.getFullYear(),a=r.getDate(),l=Zl(e,0);l.setFullYear(n,t,15),l.setHours(0,0,0,0);const f=bqe(l);return r.setMonth(t,Math.min(a,f)),r}function GZ(e,t){const r=vi(e);return isNaN(+r)?Zl(e,NaN):(r.setFullYear(t),r)}var ui;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const l={};for(const f of a)l[f]=f;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),f={};for(const i of l)f[i]=a[i];return e.objectValues(f)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const f in a)Object.prototype.hasOwnProperty.call(a,f)&&l.push(f);return l},e.find=(a,l)=>{for(const f of a)if(l(f))return f},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,l=" | "){return a.map(f=>typeof f=="string"?`'${f}'`:f).join(l)}e.joinValues=n,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(ui||(ui={}));var jF;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(jF||(jF={}));const zr=ui.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Tp=e=>{switch(typeof e){case"undefined":return zr.undefined;case"string":return zr.string;case"number":return isNaN(e)?zr.nan:zr.number;case"boolean":return zr.boolean;case"function":return zr.function;case"bigint":return zr.bigint;case"symbol":return zr.symbol;case"object":return Array.isArray(e)?zr.array:e===null?zr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?zr.promise:typeof Map<"u"&&e instanceof Map?zr.map:typeof Set<"u"&&e instanceof Set?zr.set:typeof Date<"u"&&e instanceof Date?zr.date:zr.object;default:return zr.unknown}},fr=ui.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Aqe=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Wl extends Error{constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const r=t||function(l){return l.message},n={_errors:[]},a=l=>{for(const f of l.issues)if(f.code==="invalid_union")f.unionErrors.map(a);else if(f.code==="invalid_return_type")a(f.returnTypeError);else if(f.code==="invalid_arguments")a(f.argumentsError);else if(f.path.length===0)n._errors.push(r(f));else{let i=n,_=0;for(;_<f.path.length;){const b=f.path[_];_===f.path.length-1?(i[b]=i[b]||{_errors:[]},i[b]._errors.push(r(f))):i[b]=i[b]||{_errors:[]},i=i[b],_++}}};return a(this),n}static assert(t){if(!(t instanceof Wl))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ui.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Wl.create=e=>new Wl(e);const vx=(e,t)=>{let r;switch(e.code){case fr.invalid_type:e.received===zr.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case fr.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,ui.jsonStringifyReplacer)}`;break;case fr.unrecognized_keys:r=`Unrecognized key(s) in object: ${ui.joinValues(e.keys,", ")}`;break;case fr.invalid_union:r="Invalid input";break;case fr.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ui.joinValues(e.options)}`;break;case fr.invalid_enum_value:r=`Invalid enum value. Expected ${ui.joinValues(e.options)}, received '${e.received}'`;break;case fr.invalid_arguments:r="Invalid function arguments";break;case fr.invalid_return_type:r="Invalid function return type";break;case fr.invalid_date:r="Invalid date";break;case fr.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:ui.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case fr.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case fr.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case fr.custom:r="Invalid input";break;case fr.invalid_intersection_types:r="Intersection results could not be merged";break;case fr.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case fr.not_finite:r="Number must be finite";break;default:r=t.defaultError,ui.assertNever(e)}return{message:r}};let Cae=vx;function Mqe(e){Cae=e}function fO(){return Cae}const pO=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,l=[...r,...a.path||[]],f={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let i="";const _=n.filter(b=>!!b).slice().reverse();for(const b of _)i=b(f,{data:t,defaultError:i}).message;return{...a,path:l,message:i}},Cqe=[];function kr(e,t){const r=fO(),n=pO({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===vx?void 0:vx].filter(a=>!!a)});e.common.issues.push(n)}class ss{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return bn;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const l=await a.key,f=await a.value;n.push({key:l,value:f})}return ss.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:l,value:f}=a;if(l.status==="aborted"||f.status==="aborted")return bn;l.status==="dirty"&&t.dirty(),f.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof f.value<"u"||a.alwaysSet)&&(n[l.value]=f.value)}return{status:t.value,value:n}}}const bn=Object.freeze({status:"aborted"}),Q_=e=>({status:"dirty",value:e}),ks=e=>({status:"valid",value:e}),FF=e=>e.status==="aborted",BF=e=>e.status==="dirty",BT=e=>e.status==="valid",$T=e=>typeof Promise<"u"&&e instanceof Promise;function mO(e,t,r,n){if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Pae(e,t,r,n,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var en;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(en||(en={}));var Dw,Lw;class Nd{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const qZ=(e,t)=>{if(BT(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Wl(e.common.issues);return this._error=r,this._error}}};function On(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(f,i)=>{var _,b;const{message:E}=e;return f.code==="invalid_enum_value"?{message:E??i.defaultError}:typeof i.data>"u"?{message:(_=E??n)!==null&&_!==void 0?_:i.defaultError}:f.code!=="invalid_type"?{message:i.defaultError}:{message:(b=E??r)!==null&&b!==void 0?b:i.defaultError}},description:a}}class Fn{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return Tp(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Tp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ss,ctx:{common:t.parent.common,data:t.data,parsedType:Tp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if($T(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Tp(t)},l=this._parseSync({data:t,path:a.path,parent:a});return qZ(a,l)}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Tp(t)},a=this._parse({data:t,path:n.path,parent:n}),l=await($T(a)?a:Promise.resolve(a));return qZ(n,l)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,l)=>{const f=t(a),i=()=>l.addIssue({code:fr.custom,...n(a)});return typeof Promise<"u"&&f instanceof Promise?f.then(_=>_?!0:(i(),!1)):f?!0:(i(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Lu({schema:this,typeName:dn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return Id.create(this,this._def)}nullable(){return dm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Eu.create(this,this._def)}promise(){return xx.create(this,this._def)}or(t){return GT.create([this,t],this._def)}and(t){return qT.create(this,t,this._def)}transform(t){return new Lu({...On(this._def),schema:this,typeName:dn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new KT({...On(this._def),innerType:this,defaultValue:r,typeName:dn.ZodDefault})}brand(){return new W$({typeName:dn.ZodBranded,type:this,...On(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new JT({...On(this._def),innerType:this,catchValue:r,typeName:dn.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return DE.create(this,t)}readonly(){return QT.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Pqe=/^c[^\s-]{8,}$/i,Iqe=/^[0-9a-z]+$/,Oqe=/^[0-9A-HJKMNP-TV-Z]{26}$/,kqe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Rqe=/^[a-z0-9_-]{21}$/i,Dqe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Lqe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Nqe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let uN;const zqe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,jqe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Fqe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Iae="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Bqe=new RegExp(`^${Iae}$`);function Oae(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function $qe(e){return new RegExp(`^${Oae(e)}$`)}function kae(e){let t=`${Iae}T${Oae(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Uqe(e,t){return!!((t==="v4"||!t)&&zqe.test(e)||(t==="v6"||!t)&&jqe.test(e))}class bu extends Fn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==zr.string){const l=this._getOrReturnCtx(t);return kr(l,{code:fr.invalid_type,expected:zr.string,received:l.parsedType}),bn}const n=new ss;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="length"){const f=t.data.length>l.value,i=t.data.length<l.value;(f||i)&&(a=this._getOrReturnCtx(t,a),f?kr(a,{code:fr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):i&&kr(a,{code:fr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),n.dirty())}else if(l.kind==="email")Lqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"email",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="emoji")uN||(uN=new RegExp(Nqe,"u")),uN.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"emoji",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="uuid")kqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"uuid",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="nanoid")Rqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"nanoid",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid")Pqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"cuid",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid2")Iqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"cuid2",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="ulid")Oqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"ulid",code:fr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),kr(a,{validation:"url",code:fr.invalid_string,message:l.message}),n.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"regex",code:fr.invalid_string,message:l.message}),n.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),n.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.invalid_string,validation:{startsWith:l.value},message:l.message}),n.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.invalid_string,validation:{endsWith:l.value},message:l.message}),n.dirty()):l.kind==="datetime"?kae(l).test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.invalid_string,validation:"datetime",message:l.message}),n.dirty()):l.kind==="date"?Bqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.invalid_string,validation:"date",message:l.message}),n.dirty()):l.kind==="time"?$qe(l).test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.invalid_string,validation:"time",message:l.message}),n.dirty()):l.kind==="duration"?Dqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"duration",code:fr.invalid_string,message:l.message}),n.dirty()):l.kind==="ip"?Uqe(t.data,l.version)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"ip",code:fr.invalid_string,message:l.message}),n.dirty()):l.kind==="base64"?Fqe.test(t.data)||(a=this._getOrReturnCtx(t,a),kr(a,{validation:"base64",code:fr.invalid_string,message:l.message}),n.dirty()):ui.assertNever(l);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:fr.invalid_string,...en.errToObj(n)})}_addCheck(t){return new bu({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...en.errToObj(t)})}url(t){return this._addCheck({kind:"url",...en.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...en.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...en.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...en.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...en.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...en.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...en.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...en.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...en.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...en.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...en.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...en.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...en.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...en.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...en.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...en.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...en.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...en.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...en.errToObj(r)})}nonempty(t){return this.min(1,en.errToObj(t))}trim(){return new bu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}bu.create=e=>{var t;return new bu({checks:[],typeName:dn.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...On(e)})};function Vqe(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,l=parseInt(e.toFixed(a).replace(".","")),f=parseInt(t.toFixed(a).replace(".",""));return l%f/Math.pow(10,a)}class lm extends Fn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==zr.number){const l=this._getOrReturnCtx(t);return kr(l,{code:fr.invalid_type,expected:zr.number,received:l.parsedType}),bn}let n;const a=new ss;for(const l of this._def.checks)l.kind==="int"?ui.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?Vqe(t.data,l.value)!==0&&(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.not_finite,message:l.message}),a.dirty()):ui.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,en.toString(r))}gt(t,r){return this.setLimit("min",t,!1,en.toString(r))}lte(t,r){return this.setLimit("max",t,!0,en.toString(r))}lt(t,r){return this.setLimit("max",t,!1,en.toString(r))}setLimit(t,r,n,a){return new lm({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:en.toString(a)}]})}_addCheck(t){return new lm({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:en.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:en.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:en.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:en.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:en.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:en.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:en.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:en.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:en.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ui.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}lm.create=e=>new lm({checks:[],typeName:dn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...On(e)});class cm extends Fn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==zr.bigint){const l=this._getOrReturnCtx(t);return kr(l,{code:fr.invalid_type,expected:zr.bigint,received:l.parsedType}),bn}let n;const a=new ss;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),kr(n,{code:fr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):ui.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,en.toString(r))}gt(t,r){return this.setLimit("min",t,!1,en.toString(r))}lte(t,r){return this.setLimit("max",t,!0,en.toString(r))}lt(t,r){return this.setLimit("max",t,!1,en.toString(r))}setLimit(t,r,n,a){return new cm({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:en.toString(a)}]})}_addCheck(t){return new cm({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:en.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:en.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:en.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:en.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:en.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}cm.create=e=>{var t;return new cm({checks:[],typeName:dn.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...On(e)})};class UT extends Fn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==zr.boolean){const n=this._getOrReturnCtx(t);return kr(n,{code:fr.invalid_type,expected:zr.boolean,received:n.parsedType}),bn}return ks(t.data)}}UT.create=e=>new UT({typeName:dn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...On(e)});class My extends Fn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==zr.date){const l=this._getOrReturnCtx(t);return kr(l,{code:fr.invalid_type,expected:zr.date,received:l.parsedType}),bn}if(isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return kr(l,{code:fr.invalid_date}),bn}const n=new ss;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),n.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),kr(a,{code:fr.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),n.dirty()):ui.assertNever(l);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new My({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:en.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:en.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}My.create=e=>new My({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:dn.ZodDate,...On(e)});class gO extends Fn{_parse(t){if(this._getType(t)!==zr.symbol){const n=this._getOrReturnCtx(t);return kr(n,{code:fr.invalid_type,expected:zr.symbol,received:n.parsedType}),bn}return ks(t.data)}}gO.create=e=>new gO({typeName:dn.ZodSymbol,...On(e)});class VT extends Fn{_parse(t){if(this._getType(t)!==zr.undefined){const n=this._getOrReturnCtx(t);return kr(n,{code:fr.invalid_type,expected:zr.undefined,received:n.parsedType}),bn}return ks(t.data)}}VT.create=e=>new VT({typeName:dn.ZodUndefined,...On(e)});class WT extends Fn{_parse(t){if(this._getType(t)!==zr.null){const n=this._getOrReturnCtx(t);return kr(n,{code:fr.invalid_type,expected:zr.null,received:n.parsedType}),bn}return ks(t.data)}}WT.create=e=>new WT({typeName:dn.ZodNull,...On(e)});class _x extends Fn{constructor(){super(...arguments),this._any=!0}_parse(t){return ks(t.data)}}_x.create=e=>new _x({typeName:dn.ZodAny,...On(e)});class cy extends Fn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ks(t.data)}}cy.create=e=>new cy({typeName:dn.ZodUnknown,...On(e)});class Zh extends Fn{_parse(t){const r=this._getOrReturnCtx(t);return kr(r,{code:fr.invalid_type,expected:zr.never,received:r.parsedType}),bn}}Zh.create=e=>new Zh({typeName:dn.ZodNever,...On(e)});class yO extends Fn{_parse(t){if(this._getType(t)!==zr.undefined){const n=this._getOrReturnCtx(t);return kr(n,{code:fr.invalid_type,expected:zr.void,received:n.parsedType}),bn}return ks(t.data)}}yO.create=e=>new yO({typeName:dn.ZodVoid,...On(e)});class Eu extends Fn{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==zr.array)return kr(r,{code:fr.invalid_type,expected:zr.array,received:r.parsedType}),bn;if(a.exactLength!==null){const f=r.data.length>a.exactLength.value,i=r.data.length<a.exactLength.value;(f||i)&&(kr(r,{code:f?fr.too_big:fr.too_small,minimum:i?a.exactLength.value:void 0,maximum:f?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(kr(r,{code:fr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(kr(r,{code:fr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((f,i)=>a.type._parseAsync(new Nd(r,f,r.path,i)))).then(f=>ss.mergeArray(n,f));const l=[...r.data].map((f,i)=>a.type._parseSync(new Nd(r,f,r.path,i)));return ss.mergeArray(n,l)}get element(){return this._def.type}min(t,r){return new Eu({...this._def,minLength:{value:t,message:en.toString(r)}})}max(t,r){return new Eu({...this._def,maxLength:{value:t,message:en.toString(r)}})}length(t,r){return new Eu({...this._def,exactLength:{value:t,message:en.toString(r)}})}nonempty(t){return this.min(1,t)}}Eu.create=(e,t)=>new Eu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:dn.ZodArray,...On(t)});function __(e){if(e instanceof wo){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Id.create(__(n))}return new wo({...e._def,shape:()=>t})}else return e instanceof Eu?new Eu({...e._def,type:__(e.element)}):e instanceof Id?Id.create(__(e.unwrap())):e instanceof dm?dm.create(__(e.unwrap())):e instanceof zd?zd.create(e.items.map(t=>__(t))):e}class wo extends Fn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=ui.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==zr.object){const b=this._getOrReturnCtx(t);return kr(b,{code:fr.invalid_type,expected:zr.object,received:b.parsedType}),bn}const{status:n,ctx:a}=this._processInputParams(t),{shape:l,keys:f}=this._getCached(),i=[];if(!(this._def.catchall instanceof Zh&&this._def.unknownKeys==="strip"))for(const b in a.data)f.includes(b)||i.push(b);const _=[];for(const b of f){const E=l[b],C=a.data[b];_.push({key:{status:"valid",value:b},value:E._parse(new Nd(a,C,a.path,b)),alwaysSet:b in a.data})}if(this._def.catchall instanceof Zh){const b=this._def.unknownKeys;if(b==="passthrough")for(const E of i)_.push({key:{status:"valid",value:E},value:{status:"valid",value:a.data[E]}});else if(b==="strict")i.length>0&&(kr(a,{code:fr.unrecognized_keys,keys:i}),n.dirty());else if(b!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const b=this._def.catchall;for(const E of i){const C=a.data[E];_.push({key:{status:"valid",value:E},value:b._parse(new Nd(a,C,a.path,E)),alwaysSet:E in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const b=[];for(const E of _){const C=await E.key,R=await E.value;b.push({key:C,value:R,alwaysSet:E.alwaysSet})}return b}).then(b=>ss.mergeObjectSync(n,b)):ss.mergeObjectSync(n,_)}get shape(){return this._def.shape()}strict(t){return en.errToObj,new wo({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,l,f,i;const _=(f=(l=(a=this._def).errorMap)===null||l===void 0?void 0:l.call(a,r,n).message)!==null&&f!==void 0?f:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=en.errToObj(t).message)!==null&&i!==void 0?i:_}:{message:_}}}:{}})}strip(){return new wo({...this._def,unknownKeys:"strip"})}passthrough(){return new wo({...this._def,unknownKeys:"passthrough"})}extend(t){return new wo({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new wo({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:dn.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new wo({...this._def,catchall:t})}pick(t){const r={};return ui.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new wo({...this._def,shape:()=>r})}omit(t){const r={};return ui.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new wo({...this._def,shape:()=>r})}deepPartial(){return __(this)}partial(t){const r={};return ui.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new wo({...this._def,shape:()=>r})}required(t){const r={};return ui.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let l=this.shape[n];for(;l instanceof Id;)l=l._def.innerType;r[n]=l}}),new wo({...this._def,shape:()=>r})}keyof(){return Rae(ui.objectKeys(this.shape))}}wo.create=(e,t)=>new wo({shape:()=>e,unknownKeys:"strip",catchall:Zh.create(),typeName:dn.ZodObject,...On(t)});wo.strictCreate=(e,t)=>new wo({shape:()=>e,unknownKeys:"strict",catchall:Zh.create(),typeName:dn.ZodObject,...On(t)});wo.lazycreate=(e,t)=>new wo({shape:e,unknownKeys:"strip",catchall:Zh.create(),typeName:dn.ZodObject,...On(t)});class GT extends Fn{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(l){for(const i of l)if(i.result.status==="valid")return i.result;for(const i of l)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const f=l.map(i=>new Wl(i.ctx.common.issues));return kr(r,{code:fr.invalid_union,unionErrors:f}),bn}if(r.common.async)return Promise.all(n.map(async l=>{const f={...r,common:{...r.common,issues:[]},parent:null};return{result:await l._parseAsync({data:r.data,path:r.path,parent:f}),ctx:f}})).then(a);{let l;const f=[];for(const _ of n){const b={...r,common:{...r.common,issues:[]},parent:null},E=_._parseSync({data:r.data,path:r.path,parent:b});if(E.status==="valid")return E;E.status==="dirty"&&!l&&(l={result:E,ctx:b}),b.common.issues.length&&f.push(b.common.issues)}if(l)return r.common.issues.push(...l.ctx.common.issues),l.result;const i=f.map(_=>new Wl(_));return kr(r,{code:fr.invalid_union,unionErrors:i}),bn}}get options(){return this._def.options}}GT.create=(e,t)=>new GT({options:e,typeName:dn.ZodUnion,...On(t)});const dh=e=>e instanceof ZT?dh(e.schema):e instanceof Lu?dh(e.innerType()):e instanceof XT?[e.value]:e instanceof um?e.options:e instanceof YT?ui.objectValues(e.enum):e instanceof KT?dh(e._def.innerType):e instanceof VT?[void 0]:e instanceof WT?[null]:e instanceof Id?[void 0,...dh(e.unwrap())]:e instanceof dm?[null,...dh(e.unwrap())]:e instanceof W$||e instanceof QT?dh(e.unwrap()):e instanceof JT?dh(e._def.innerType):[];class xR extends Fn{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==zr.object)return kr(r,{code:fr.invalid_type,expected:zr.object,received:r.parsedType}),bn;const n=this.discriminator,a=r.data[n],l=this.optionsMap.get(a);return l?r.common.async?l._parseAsync({data:r.data,path:r.path,parent:r}):l._parseSync({data:r.data,path:r.path,parent:r}):(kr(r,{code:fr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),bn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const l of r){const f=dh(l.shape[t]);if(!f.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of f){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,l)}}return new xR({typeName:dn.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...On(n)})}}function $F(e,t){const r=Tp(e),n=Tp(t);if(e===t)return{valid:!0,data:e};if(r===zr.object&&n===zr.object){const a=ui.objectKeys(t),l=ui.objectKeys(e).filter(i=>a.indexOf(i)!==-1),f={...e,...t};for(const i of l){const _=$F(e[i],t[i]);if(!_.valid)return{valid:!1};f[i]=_.data}return{valid:!0,data:f}}else if(r===zr.array&&n===zr.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const f=e[l],i=t[l],_=$F(f,i);if(!_.valid)return{valid:!1};a.push(_.data)}return{valid:!0,data:a}}else return r===zr.date&&n===zr.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class qT extends Fn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(l,f)=>{if(FF(l)||FF(f))return bn;const i=$F(l.value,f.value);return i.valid?((BF(l)||BF(f))&&r.dirty(),{status:r.value,value:i.data}):(kr(n,{code:fr.invalid_intersection_types}),bn)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([l,f])=>a(l,f)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}qT.create=(e,t,r)=>new qT({left:e,right:t,typeName:dn.ZodIntersection,...On(r)});class zd extends Fn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==zr.array)return kr(n,{code:fr.invalid_type,expected:zr.array,received:n.parsedType}),bn;if(n.data.length<this._def.items.length)return kr(n,{code:fr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),bn;!this._def.rest&&n.data.length>this._def.items.length&&(kr(n,{code:fr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const l=[...n.data].map((f,i)=>{const _=this._def.items[i]||this._def.rest;return _?_._parse(new Nd(n,f,n.path,i)):null}).filter(f=>!!f);return n.common.async?Promise.all(l).then(f=>ss.mergeArray(r,f)):ss.mergeArray(r,l)}get items(){return this._def.items}rest(t){return new zd({...this._def,rest:t})}}zd.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new zd({items:e,typeName:dn.ZodTuple,rest:null,...On(t)})};class HT extends Fn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==zr.object)return kr(n,{code:fr.invalid_type,expected:zr.object,received:n.parsedType}),bn;const a=[],l=this._def.keyType,f=this._def.valueType;for(const i in n.data)a.push({key:l._parse(new Nd(n,i,n.path,i)),value:f._parse(new Nd(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?ss.mergeObjectAsync(r,a):ss.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Fn?new HT({keyType:t,valueType:r,typeName:dn.ZodRecord,...On(n)}):new HT({keyType:bu.create(),valueType:t,typeName:dn.ZodRecord,...On(r)})}}class vO extends Fn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==zr.map)return kr(n,{code:fr.invalid_type,expected:zr.map,received:n.parsedType}),bn;const a=this._def.keyType,l=this._def.valueType,f=[...n.data.entries()].map(([i,_],b)=>({key:a._parse(new Nd(n,i,n.path,[b,"key"])),value:l._parse(new Nd(n,_,n.path,[b,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const _ of f){const b=await _.key,E=await _.value;if(b.status==="aborted"||E.status==="aborted")return bn;(b.status==="dirty"||E.status==="dirty")&&r.dirty(),i.set(b.value,E.value)}return{status:r.value,value:i}})}else{const i=new Map;for(const _ of f){const b=_.key,E=_.value;if(b.status==="aborted"||E.status==="aborted")return bn;(b.status==="dirty"||E.status==="dirty")&&r.dirty(),i.set(b.value,E.value)}return{status:r.value,value:i}}}}vO.create=(e,t,r)=>new vO({valueType:t,keyType:e,typeName:dn.ZodMap,...On(r)});class Cy extends Fn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==zr.set)return kr(n,{code:fr.invalid_type,expected:zr.set,received:n.parsedType}),bn;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(kr(n,{code:fr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(kr(n,{code:fr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const l=this._def.valueType;function f(_){const b=new Set;for(const E of _){if(E.status==="aborted")return bn;E.status==="dirty"&&r.dirty(),b.add(E.value)}return{status:r.value,value:b}}const i=[...n.data.values()].map((_,b)=>l._parse(new Nd(n,_,n.path,b)));return n.common.async?Promise.all(i).then(_=>f(_)):f(i)}min(t,r){return new Cy({...this._def,minSize:{value:t,message:en.toString(r)}})}max(t,r){return new Cy({...this._def,maxSize:{value:t,message:en.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Cy.create=(e,t)=>new Cy({valueType:e,minSize:null,maxSize:null,typeName:dn.ZodSet,...On(t)});class y0 extends Fn{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==zr.function)return kr(r,{code:fr.invalid_type,expected:zr.function,received:r.parsedType}),bn;function n(i,_){return pO({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,fO(),vx].filter(b=>!!b),issueData:{code:fr.invalid_arguments,argumentsError:_}})}function a(i,_){return pO({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,fO(),vx].filter(b=>!!b),issueData:{code:fr.invalid_return_type,returnTypeError:_}})}const l={errorMap:r.common.contextualErrorMap},f=r.data;if(this._def.returns instanceof xx){const i=this;return ks(async function(..._){const b=new Wl([]),E=await i._def.args.parseAsync(_,l).catch(F=>{throw b.addIssue(n(_,F)),b}),C=await Reflect.apply(f,this,E);return await i._def.returns._def.type.parseAsync(C,l).catch(F=>{throw b.addIssue(a(C,F)),b})})}else{const i=this;return ks(function(..._){const b=i._def.args.safeParse(_,l);if(!b.success)throw new Wl([n(_,b.error)]);const E=Reflect.apply(f,this,b.data),C=i._def.returns.safeParse(E,l);if(!C.success)throw new Wl([a(E,C.error)]);return C.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new y0({...this._def,args:zd.create(t).rest(cy.create())})}returns(t){return new y0({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new y0({args:t||zd.create([]).rest(cy.create()),returns:r||cy.create(),typeName:dn.ZodFunction,...On(n)})}}class ZT extends Fn{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}ZT.create=(e,t)=>new ZT({getter:e,typeName:dn.ZodLazy,...On(t)});class XT extends Fn{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return kr(r,{received:r.data,code:fr.invalid_literal,expected:this._def.value}),bn}return{status:"valid",value:t.data}}get value(){return this._def.value}}XT.create=(e,t)=>new XT({value:e,typeName:dn.ZodLiteral,...On(t)});function Rae(e,t){return new um({values:e,typeName:dn.ZodEnum,...On(t)})}class um extends Fn{constructor(){super(...arguments),Dw.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return kr(r,{expected:ui.joinValues(n),received:r.parsedType,code:fr.invalid_type}),bn}if(mO(this,Dw)||Pae(this,Dw,new Set(this._def.values)),!mO(this,Dw).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return kr(r,{received:r.data,code:fr.invalid_enum_value,options:n}),bn}return ks(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return um.create(t,{...this._def,...r})}exclude(t,r=this._def){return um.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Dw=new WeakMap;um.create=Rae;class YT extends Fn{constructor(){super(...arguments),Lw.set(this,void 0)}_parse(t){const r=ui.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==zr.string&&n.parsedType!==zr.number){const a=ui.objectValues(r);return kr(n,{expected:ui.joinValues(a),received:n.parsedType,code:fr.invalid_type}),bn}if(mO(this,Lw)||Pae(this,Lw,new Set(ui.getValidEnumValues(this._def.values))),!mO(this,Lw).has(t.data)){const a=ui.objectValues(r);return kr(n,{received:n.data,code:fr.invalid_enum_value,options:a}),bn}return ks(t.data)}get enum(){return this._def.values}}Lw=new WeakMap;YT.create=(e,t)=>new YT({values:e,typeName:dn.ZodNativeEnum,...On(t)});class xx extends Fn{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==zr.promise&&r.common.async===!1)return kr(r,{code:fr.invalid_type,expected:zr.promise,received:r.parsedType}),bn;const n=r.parsedType===zr.promise?r.data:Promise.resolve(r.data);return ks(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}xx.create=(e,t)=>new xx({type:e,typeName:dn.ZodPromise,...On(t)});class Lu extends Fn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===dn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:f=>{kr(n,f),f.fatal?r.abort():r.dirty()},get path(){return n.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const f=a.transform(n.data,l);if(n.common.async)return Promise.resolve(f).then(async i=>{if(r.value==="aborted")return bn;const _=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return _.status==="aborted"?bn:_.status==="dirty"||r.value==="dirty"?Q_(_.value):_});{if(r.value==="aborted")return bn;const i=this._def.schema._parseSync({data:f,path:n.path,parent:n});return i.status==="aborted"?bn:i.status==="dirty"||r.value==="dirty"?Q_(i.value):i}}if(a.type==="refinement"){const f=i=>{const _=a.refinement(i,l);if(n.common.async)return Promise.resolve(_);if(_ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?bn:(i.status==="dirty"&&r.dirty(),f(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?bn:(i.status==="dirty"&&r.dirty(),f(i.value).then(()=>({status:r.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const f=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!BT(f))return f;const i=a.transform(f.value,l);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(f=>BT(f)?Promise.resolve(a.transform(f.value,l)).then(i=>({status:r.value,value:i})):f);ui.assertNever(a)}}Lu.create=(e,t,r)=>new Lu({schema:e,typeName:dn.ZodEffects,effect:t,...On(r)});Lu.createWithPreprocess=(e,t,r)=>new Lu({schema:t,effect:{type:"preprocess",transform:e},typeName:dn.ZodEffects,...On(r)});class Id extends Fn{_parse(t){return this._getType(t)===zr.undefined?ks(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Id.create=(e,t)=>new Id({innerType:e,typeName:dn.ZodOptional,...On(t)});class dm extends Fn{_parse(t){return this._getType(t)===zr.null?ks(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}dm.create=(e,t)=>new dm({innerType:e,typeName:dn.ZodNullable,...On(t)});class KT extends Fn{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===zr.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}KT.create=(e,t)=>new KT({innerType:e,typeName:dn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...On(t)});class JT extends Fn{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return $T(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Wl(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Wl(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}JT.create=(e,t)=>new JT({innerType:e,typeName:dn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...On(t)});class _O extends Fn{_parse(t){if(this._getType(t)!==zr.nan){const n=this._getOrReturnCtx(t);return kr(n,{code:fr.invalid_type,expected:zr.nan,received:n.parsedType}),bn}return{status:"valid",value:t.data}}}_O.create=e=>new _O({typeName:dn.ZodNaN,...On(e)});const Wqe=Symbol("zod_brand");class W$ extends Fn{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class DE extends Fn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?bn:l.status==="dirty"?(r.dirty(),Q_(l.value)):this._def.out._parseAsync({data:l.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?bn:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new DE({in:t,out:r,typeName:dn.ZodPipeline})}}class QT extends Fn{_parse(t){const r=this._def.innerType._parse(t),n=a=>(BT(a)&&(a.value=Object.freeze(a.value)),a);return $T(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}QT.create=(e,t)=>new QT({innerType:e,typeName:dn.ZodReadonly,...On(t)});function Dae(e,t={},r){return e?_x.create().superRefine((n,a)=>{var l,f;if(!e(n)){const i=typeof t=="function"?t(n):typeof t=="string"?{message:t}:t,_=(f=(l=i.fatal)!==null&&l!==void 0?l:r)!==null&&f!==void 0?f:!0,b=typeof i=="string"?{message:i}:i;a.addIssue({code:"custom",...b,fatal:_})}}):_x.create()}const Gqe={object:wo.lazycreate};var dn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(dn||(dn={}));const qqe=(e,t={message:`Input not instance of ${e.name}`})=>Dae(r=>r instanceof e,t),Lae=bu.create,Nae=lm.create,Hqe=_O.create,Zqe=cm.create,zae=UT.create,Xqe=My.create,Yqe=gO.create,Kqe=VT.create,Jqe=WT.create,Qqe=_x.create,eHe=cy.create,tHe=Zh.create,rHe=yO.create,nHe=Eu.create,iHe=wo.create,oHe=wo.strictCreate,aHe=GT.create,sHe=xR.create,lHe=qT.create,cHe=zd.create,uHe=HT.create,dHe=vO.create,hHe=Cy.create,fHe=y0.create,pHe=ZT.create,mHe=XT.create,gHe=um.create,yHe=YT.create,vHe=xx.create,HZ=Lu.create,_He=Id.create,xHe=dm.create,bHe=Lu.createWithPreprocess,wHe=DE.create,SHe=()=>Lae().optional(),THe=()=>Nae().optional(),EHe=()=>zae().optional(),AHe={string:e=>bu.create({...e,coerce:!0}),number:e=>lm.create({...e,coerce:!0}),boolean:e=>UT.create({...e,coerce:!0}),bigint:e=>cm.create({...e,coerce:!0}),date:e=>My.create({...e,coerce:!0})},MHe=bn;var Do=Object.freeze({__proto__:null,defaultErrorMap:vx,setErrorMap:Mqe,getErrorMap:fO,makeIssue:pO,EMPTY_PATH:Cqe,addIssueToContext:kr,ParseStatus:ss,INVALID:bn,DIRTY:Q_,OK:ks,isAborted:FF,isDirty:BF,isValid:BT,isAsync:$T,get util(){return ui},get objectUtil(){return jF},ZodParsedType:zr,getParsedType:Tp,ZodType:Fn,datetimeRegex:kae,ZodString:bu,ZodNumber:lm,ZodBigInt:cm,ZodBoolean:UT,ZodDate:My,ZodSymbol:gO,ZodUndefined:VT,ZodNull:WT,ZodAny:_x,ZodUnknown:cy,ZodNever:Zh,ZodVoid:yO,ZodArray:Eu,ZodObject:wo,ZodUnion:GT,ZodDiscriminatedUnion:xR,ZodIntersection:qT,ZodTuple:zd,ZodRecord:HT,ZodMap:vO,ZodSet:Cy,ZodFunction:y0,ZodLazy:ZT,ZodLiteral:XT,ZodEnum:um,ZodNativeEnum:YT,ZodPromise:xx,ZodEffects:Lu,ZodTransformer:Lu,ZodOptional:Id,ZodNullable:dm,ZodDefault:KT,ZodCatch:JT,ZodNaN:_O,BRAND:Wqe,ZodBranded:W$,ZodPipeline:DE,ZodReadonly:QT,custom:Dae,Schema:Fn,ZodSchema:Fn,late:Gqe,get ZodFirstPartyTypeKind(){return dn},coerce:AHe,any:Qqe,array:nHe,bigint:Zqe,boolean:zae,date:Xqe,discriminatedUnion:sHe,effect:HZ,enum:gHe,function:fHe,instanceof:qqe,intersection:lHe,lazy:pHe,literal:mHe,map:dHe,nan:Hqe,nativeEnum:yHe,never:tHe,null:Jqe,nullable:xHe,number:Nae,object:iHe,oboolean:EHe,onumber:THe,optional:_He,ostring:SHe,pipeline:wHe,preprocess:bHe,promise:vHe,record:uHe,set:hHe,strictObject:oHe,string:Lae,symbol:Yqe,transformer:HZ,tuple:cHe,undefined:Kqe,union:aHe,unknown:eHe,void:rHe,NEVER:MHe,ZodIssueCode:fr,quotelessJson:Aqe,ZodError:Wl});const CHe=Do.object({brand:Do.string().min(2,{message:"La marca debe tener al menos 2 caracteres"}),model:Do.string().min(2,{message:"El modelo debe tener al menos 2 caracteres"}),year:Do.number().min(1900,{message:"El año debe ser válido"}),plate:Do.string().min(5,{message:"La placa debe tener al menos 5 caracteres"}),color:Do.string().optional()});Do.object({document_type:Do.string(),file:Do.instanceof(File)});const PHe=Do.object({id:Do.string().optional(),name:Do.string().min(2,{message:"El nombre debe tener al menos 2 caracteres"}),lastname:Do.string().min(2,{message:"El apellido paterno debe tener al menos 2 caracteres"}),secondLastname:Do.string().min(2,{message:"El apellido materno debe tener al menos 2 caracteres"}),sex:Do.enum(["masculino","femenino","otro"],{required_error:"Por favor selecciona una opción"}),birthDate:Do.date({required_error:"La fecha de nacimiento es requerida"}),curp:Do.string().min(18,{message:"El CURP debe tener 18 caracteres"}).max(18),rfc:Do.string().min(10,{message:"El RFC debe tener entre 10 y 13 caracteres"}).max(13),email:Do.string().email({message:"Email inválido"}),phone:Do.string().min(10,{message:"El teléfono debe tener al menos 10 dígitos"}),offerSource:Do.string().min(1,{message:"Por favor indica cómo se enteró de la oferta"}),activeTab:Do.enum(["personal","documents","vehicles"]).default("personal")}),IHe=({defaultValues:e})=>{const[t,r]=ne.useState([]),{toast:n}=Px(),a=j$({resolver:vae(PHe),defaultValues:e||{name:"",lastname:"",secondLastname:"",sex:void 0,email:"",phone:"",offerSource:"",activeTab:"personal"}});ne.useEffect(()=>{e!=null&&e.id&&l()},[e==null?void 0:e.id]);const l=async()=>{if(!(e!=null&&e.id))return;const{data:b}=await mo.from("operator_documents").select("*").eq("operator_id",e.id);b&&r(b)};return{form:a,documents:t,handleDocumentUpload:async(b,E)=>{if(!(!(e!=null&&e.id)||!b))try{const C=b.name.split(".").pop(),R=`${e.id}/${E}_${Date.now()}.${C}`,{error:F}=await mo.storage.from("operator-documents").upload(R,b);if(F)throw F;const{data:U,error:$}=await mo.from("operator_documents").insert({operator_id:e.id,document_type:E,file_name:b.name,file_path:R}).select().single();if($)throw $;r([...t,U]),n({title:"Éxito",description:"Documento cargado correctamente"})}catch(C){throw console.error("Error:",C),C}},handleDocumentDelete:async(b,E)=>{try{const{error:C}=await mo.storage.from("operator-documents").remove([E]);if(C)throw C;const{error:R}=await mo.from("operator_documents").delete().eq("id",b);if(R)throw R;r(t.filter(F=>F.id!==b)),n({title:"Éxito",description:"Documento eliminado correctamente"})}catch(C){throw console.error("Error:",C),C}},onSubmit:async b=>{try{const E=ef(b.birthDate,"yyyy-MM-dd"),C={name:b.name,lastname:b.lastname,second_lastname:b.secondLastname,sex:b.sex,birth_date:E,curp:b.curp,rfc:b.rfc,email:b.email,phone:b.phone,offer_source:b.offerSource};let R,F=e==null?void 0:e.id;if(e!=null&&e.id){const{error:U}=await mo.from("operators").update(C).eq("id",e.id);R=U}else{const{data:U,error:$}=await mo.from("operators").insert(C).select().single();R=$,U&&(F=U.id,a.setValue("id",F))}if(R)throw R;n({title:"Éxito",description:e!=null&&e.id?"La información del operador ha sido actualizada.":"La información del operador ha sido guardada."}),a.watch("activeTab")==="personal"&&a.setValue("activeTab","documents")}catch(E){console.error("Error:",E),n({variant:"destructive",title:"Error",description:"Hubo un error al guardar la información."})}}}};var G$="Radio",[OHe,jae]=gm(G$),[kHe,RHe]=OHe(G$),Fae=ne.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:l,disabled:f,value:i="on",onCheck:_,form:b,...E}=e,[C,R]=ne.useState(null),F=Ci(t,H=>R(H)),U=ne.useRef(!1),$=C?b||!!C.closest("form"):!0;return j.jsxs(kHe,{scope:r,checked:a,disabled:f,children:[j.jsx(In.button,{type:"button",role:"radio","aria-checked":a,"data-state":Uae(a),"data-disabled":f?"":void 0,disabled:f,value:i,...E,ref:F,onClick:Kr(e.onClick,H=>{a||_==null||_(),$&&(U.current=H.isPropagationStopped(),U.current||H.stopPropagation())})}),$&&j.jsx(DHe,{control:C,bubbles:!U.current,name:n,value:i,checked:a,required:l,disabled:f,form:b,style:{transform:"translateX(-100%)"}})]})});Fae.displayName=G$;var Bae="RadioIndicator",$ae=ne.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...a}=e,l=RHe(Bae,r);return j.jsx(Fd,{present:n||l.checked,children:j.jsx(In.span,{"data-state":Uae(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:t})})});$ae.displayName=Bae;var DHe=e=>{const{control:t,checked:r,bubbles:n=!0,...a}=e,l=ne.useRef(null),f=Gne(r),i=rQ(t);return ne.useEffect(()=>{const _=l.current,b=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(b,"checked").set;if(f!==r&&C){const R=new Event("click",{bubbles:n});C.call(_,r),_.dispatchEvent(R)}},[f,r,n]),j.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Uae(e){return e?"checked":"unchecked"}var LHe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],q$="RadioGroup",[NHe,NKe]=gm(q$,[lR,jae]),Vae=lR(),Wae=jae(),[zHe,jHe]=NHe(q$),Gae=ne.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:l,required:f=!1,disabled:i=!1,orientation:_,dir:b,loop:E=!0,onValueChange:C,...R}=e,F=Vae(r),U=eR(b),[$,H]=tm({prop:l,defaultProp:a,onChange:C});return j.jsx(zHe,{scope:r,name:n,required:f,disabled:i,value:$,onValueChange:H,children:j.jsx(Wie,{asChild:!0,...F,orientation:_,dir:U,loop:E,children:j.jsx(In.div,{role:"radiogroup","aria-required":f,"aria-orientation":_,"data-disabled":i?"":void 0,dir:U,...R,ref:t})})})});Gae.displayName=q$;var qae="RadioGroupItem",Hae=ne.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=e,l=jHe(qae,r),f=l.disabled||n,i=Vae(r),_=Wae(r),b=ne.useRef(null),E=Ci(t,b),C=l.value===a.value,R=ne.useRef(!1);return ne.useEffect(()=>{const F=$=>{LHe.includes($.key)&&(R.current=!0)},U=()=>R.current=!1;return document.addEventListener("keydown",F),document.addEventListener("keyup",U),()=>{document.removeEventListener("keydown",F),document.removeEventListener("keyup",U)}},[]),j.jsx(Gie,{asChild:!0,...i,focusable:!f,active:C,children:j.jsx(Fae,{disabled:f,required:l.required,checked:C,..._,...a,name:l.name,ref:E,onCheck:()=>l.onValueChange(a.value),onKeyDown:Kr(F=>{F.key==="Enter"&&F.preventDefault()}),onFocus:Kr(a.onFocus,()=>{var F;R.current&&((F=b.current)==null||F.click())})})})});Hae.displayName=qae;var FHe="RadioGroupIndicator",Zae=ne.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,a=Wae(r);return j.jsx($ae,{...a,...n,ref:t})});Zae.displayName=FHe;var Xae=Gae,Yae=Hae,BHe=Zae;const Kae=ne.forwardRef(({className:e,...t},r)=>j.jsx(Xae,{className:Nr("grid gap-2",e),...t,ref:r}));Kae.displayName=Xae.displayName;const ZM=ne.forwardRef(({className:e,...t},r)=>j.jsx(Yae,{ref:r,className:Nr("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:j.jsx(BHe,{className:"flex items-center justify-center",children:j.jsx(Sme,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ZM.displayName=Yae.displayName;var H$="Popover",[Jae,zKe]=gm(H$,[Dx]),LE=Dx(),[$He,Am]=Jae(H$),Qae=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:f=!1}=e,i=LE(t),_=ne.useRef(null),[b,E]=ne.useState(!1),[C=!1,R]=tm({prop:n,defaultProp:a,onChange:l});return j.jsx(hQ,{...i,children:j.jsx($He,{scope:t,contentId:Ph(),triggerRef:_,open:C,onOpenChange:R,onOpenToggle:ne.useCallback(()=>R(F=>!F),[R]),hasCustomAnchor:b,onCustomAnchorAdd:ne.useCallback(()=>E(!0),[]),onCustomAnchorRemove:ne.useCallback(()=>E(!1),[]),modal:f,children:r})})};Qae.displayName=H$;var ese="PopoverAnchor",UHe=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Am(ese,r),l=LE(r),{onCustomAnchorAdd:f,onCustomAnchorRemove:i}=a;return ne.useEffect(()=>(f(),()=>i()),[f,i]),j.jsx(ek,{...l,...n,ref:t})});UHe.displayName=ese;var tse="PopoverTrigger",rse=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Am(tse,r),l=LE(r),f=Ci(t,a.triggerRef),i=j.jsx(In.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":sse(a.open),...n,ref:f,onClick:Kr(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:j.jsx(ek,{asChild:!0,...l,children:i})});rse.displayName=tse;var Z$="PopoverPortal",[VHe,WHe]=Jae(Z$,{forceMount:void 0}),nse=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,l=Am(Z$,t);return j.jsx(VHe,{scope:t,forceMount:r,children:j.jsx(Fd,{present:r||l.open,children:j.jsx(dE,{asChild:!0,container:a,children:n})})})};nse.displayName=Z$;var bx="PopoverContent",ise=ne.forwardRef((e,t)=>{const r=WHe(bx,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,l=Am(bx,e.__scopePopover);return j.jsx(Fd,{present:n||l.open,children:l.modal?j.jsx(GHe,{...a,ref:t}):j.jsx(qHe,{...a,ref:t})})});ise.displayName=bx;var GHe=ne.forwardRef((e,t)=>{const r=Am(bx,e.__scopePopover),n=ne.useRef(null),a=Ci(t,n),l=ne.useRef(!1);return ne.useEffect(()=>{const f=n.current;if(f)return d$(f)},[]),j.jsx(nR,{as:Bh,allowPinchZoom:!0,children:j.jsx(ose,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kr(e.onCloseAutoFocus,f=>{var i;f.preventDefault(),l.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:Kr(e.onPointerDownOutside,f=>{const i=f.detail.originalEvent,_=i.button===0&&i.ctrlKey===!0,b=i.button===2||_;l.current=b},{checkForDefaultPrevented:!1}),onFocusOutside:Kr(e.onFocusOutside,f=>f.preventDefault(),{checkForDefaultPrevented:!1})})})}),qHe=ne.forwardRef((e,t)=>{const r=Am(bx,e.__scopePopover),n=ne.useRef(!1),a=ne.useRef(!1);return j.jsx(ose,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,b;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=l.target;((b=r.triggerRef.current)==null?void 0:b.contains(f))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),ose=ne.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:f,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:b,onInteractOutside:E,...C}=e,R=Am(bx,r),F=LE(r);return u$(),j.jsx(tR,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:j.jsx(Ix,{asChild:!0,disableOutsidePointerEvents:f,onInteractOutside:E,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:b,onDismiss:()=>R.onOpenChange(!1),children:j.jsx(BB,{"data-state":sse(R.open),role:"dialog",id:R.contentId,...F,...C,ref:t,style:{...C.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ase="PopoverClose",HHe=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Am(ase,r);return j.jsx(In.button,{type:"button",...n,ref:t,onClick:Kr(e.onClick,()=>a.onOpenChange(!1))})});HHe.displayName=ase;var ZHe="PopoverArrow",XHe=ne.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=LE(r);return j.jsx($B,{...a,...n,ref:t})});XHe.displayName=ZHe;function sse(e){return e?"open":"closed"}var YHe=Qae,KHe=rse,JHe=nse,lse=ise;const QHe=YHe,e7e=KHe,cse=ne.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>j.jsx(JHe,{children:j.jsx(lse,{ref:a,align:t,sideOffset:r,className:Nr("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));cse.displayName=lse.displayName;var xn=function(){return xn=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},xn.apply(this,arguments)};function t7e(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function use(e,t,r){for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}function NE(e){return e.mode==="multiple"}function zE(e){return e.mode==="range"}function bR(e){return e.mode==="single"}var r7e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function n7e(e,t){return ef(e,"LLLL y",t)}function i7e(e,t){return ef(e,"d",t)}function o7e(e,t){return ef(e,"LLLL",t)}function a7e(e){return"".concat(e)}function s7e(e,t){return ef(e,"cccccc",t)}function l7e(e,t){return ef(e,"yyyy",t)}var c7e=Object.freeze({__proto__:null,formatCaption:n7e,formatDay:i7e,formatMonthCaption:o7e,formatWeekNumber:a7e,formatWeekdayName:s7e,formatYearCaption:l7e}),u7e=function(e,t,r){return ef(e,"do MMMM (EEEE)",r)},d7e=function(){return"Month: "},h7e=function(){return"Go to next month"},f7e=function(){return"Go to previous month"},p7e=function(e,t){return ef(e,"cccc",t)},m7e=function(e){return"Week n. ".concat(e)},g7e=function(){return"Year: "},y7e=Object.freeze({__proto__:null,labelDay:u7e,labelMonthDropdown:d7e,labelNext:h7e,labelPrevious:f7e,labelWeekNumber:m7e,labelWeekday:p7e,labelYearDropdown:g7e});function v7e(){var e="buttons",t=r7e,r=wae,n={},a={},l=1,f={},i=new Date;return{captionLayout:e,classNames:t,formatters:c7e,labels:y7e,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:l,styles:f,today:i,mode:"default"}}function _7e(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,l=e.fromDate,f=e.toDate;return n?l=fl(n):t&&(l=new Date(t,0,1)),a?f=$$(a):r&&(f=new Date(r,11,31)),{fromDate:l?yx(l):void 0,toDate:f?yx(f):void 0}}var dse=ne.createContext(void 0);function x7e(e){var t,r=e.initialProps,n=v7e(),a=_7e(r),l=a.fromDate,f=a.toDate,i=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;i!=="buttons"&&(!l||!f)&&(i="buttons");var _;(bR(r)||NE(r)||zE(r))&&(_=r.onSelect);var b=xn(xn(xn({},n),r),{captionLayout:i,classNames:xn(xn({},n.classNames),r.classNames),components:xn({},r.components),formatters:xn(xn({},n.formatters),r.formatters),fromDate:l,labels:xn(xn({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:xn(xn({},n.modifiers),r.modifiers),modifiersClassNames:xn(xn({},n.modifiersClassNames),r.modifiersClassNames),onSelect:_,styles:xn(xn({},n.styles),r.styles),toDate:f});return j.jsx(dse.Provider,{value:b,children:e.children})}function ro(){var e=ne.useContext(dse);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function hse(e){var t=ro(),r=t.locale,n=t.classNames,a=t.styles,l=t.formatters.formatCaption;return j.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:l(e.displayMonth,{locale:r})})}function b7e(e){return j.jsx("svg",xn({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:j.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function fse(e){var t,r,n=e.onChange,a=e.value,l=e.children,f=e.caption,i=e.className,_=e.style,b=ro(),E=(r=(t=b.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:b7e;return j.jsxs("div",{className:i,style:_,children:[j.jsx("span",{className:b.classNames.vhidden,children:e["aria-label"]}),j.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:b.classNames.dropdown,style:b.styles.dropdown,value:a,onChange:n,children:l}),j.jsxs("div",{className:b.classNames.caption_label,style:b.styles.caption_label,"aria-hidden":"true",children:[f,j.jsx(E,{className:b.classNames.dropdown_icon,style:b.styles.dropdown_icon})]})]})}function w7e(e){var t,r=ro(),n=r.fromDate,a=r.toDate,l=r.styles,f=r.locale,i=r.formatters.formatMonthCaption,_=r.classNames,b=r.components,E=r.labels.labelMonthDropdown;if(!n)return j.jsx(j.Fragment,{});if(!a)return j.jsx(j.Fragment,{});var C=[];if(Eqe(n,a))for(var R=fl(n),F=n.getMonth();F<=a.getMonth();F++)C.push(cN(R,F));else for(var R=fl(new Date),F=0;F<=11;F++)C.push(cN(R,F));var U=function(H){var q=Number(H.target.value),G=cN(fl(e.displayMonth),q);e.onChange(G)},$=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:fse;return j.jsx($,{name:"months","aria-label":E(),className:_.dropdown_month,style:l.dropdown_month,onChange:U,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:f}),children:C.map(function(H){return j.jsx("option",{value:H.getMonth(),children:i(H,{locale:f})},H.getMonth())})})}function S7e(e){var t,r=e.displayMonth,n=ro(),a=n.fromDate,l=n.toDate,f=n.locale,i=n.styles,_=n.classNames,b=n.components,E=n.formatters.formatYearCaption,C=n.labels.labelYearDropdown,R=[];if(!a)return j.jsx(j.Fragment,{});if(!l)return j.jsx(j.Fragment,{});for(var F=a.getFullYear(),U=l.getFullYear(),$=F;$<=U;$++)R.push(GZ(xae(new Date),$));var H=function(G){var J=GZ(fl(r),Number(G.target.value));e.onChange(J)},q=(t=b==null?void 0:b.Dropdown)!==null&&t!==void 0?t:fse;return j.jsx(q,{name:"years","aria-label":C(),className:_.dropdown_year,style:i.dropdown_year,onChange:H,value:r.getFullYear(),caption:E(r,{locale:f}),children:R.map(function(G){return j.jsx("option",{value:G.getFullYear(),children:E(G,{locale:f})},G.getFullYear())})})}function T7e(e,t){var r=ne.useState(e),n=r[0],a=r[1],l=t===void 0?n:t;return[l,a]}function E7e(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,l=e.toDate,f=e.fromDate,i=e.numberOfMonths,_=i===void 0?1:i;if(l&&FT(l,a)<0){var b=-1*(_-1);a=Du(l,b)}return f&&FT(a,f)<0&&(a=f),fl(a)}function A7e(){var e=ro(),t=E7e(e),r=T7e(t,e.month),n=r[0],a=r[1],l=function(f){var i;if(!e.disableNavigation){var _=fl(f);a(_),(i=e.onMonthChange)===null||i===void 0||i.call(e,_)}};return[n,l]}function M7e(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=fl(e),l=fl(Du(a,n)),f=FT(l,a),i=[],_=0;_<f;_++){var b=Du(a,_);i.push(b)}return r&&(i=i.reverse()),i}function C7e(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,f=n?l:1,i=fl(e);if(!r)return Du(i,f);var _=FT(r,e);if(!(_<l))return Du(i,f)}}function P7e(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,f=n?l:1,i=fl(e);if(!r)return Du(i,-f);var _=FT(i,r);if(!(_<=0))return Du(i,-f)}}var pse=ne.createContext(void 0);function I7e(e){var t=ro(),r=A7e(),n=r[0],a=r[1],l=M7e(n,t),f=C7e(n,t),i=P7e(n,t),_=function(C){return l.some(function(R){return V$(C,R)})},b=function(C,R){_(C)||(R&&Mae(C,R)?a(Du(C,1+t.numberOfMonths*-1)):a(C))},E={currentMonth:n,displayMonths:l,goToMonth:a,goToDate:b,previousMonth:i,nextMonth:f,isDateDisplayed:_};return j.jsx(pse.Provider,{value:E,children:e.children})}function jE(){var e=ne.useContext(pse);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function ZZ(e){var t,r=ro(),n=r.classNames,a=r.styles,l=r.components,f=jE().goToMonth,i=function(E){f(Du(E,e.displayIndex?-e.displayIndex:0))},_=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:hse,b=j.jsx(_,{id:e.id,displayMonth:e.displayMonth});return j.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[j.jsx("div",{className:n.vhidden,children:b}),j.jsx(w7e,{onChange:i,displayMonth:e.displayMonth}),j.jsx(S7e,{onChange:i,displayMonth:e.displayMonth})]})}function O7e(e){return j.jsx("svg",xn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:j.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function k7e(e){return j.jsx("svg",xn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:j.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var xO=ne.forwardRef(function(e,t){var r=ro(),n=r.classNames,a=r.styles,l=[n.button_reset,n.button];e.className&&l.push(e.className);var f=l.join(" "),i=xn(xn({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),j.jsx("button",xn({},e,{ref:t,type:"button",className:f,style:i}))});function R7e(e){var t,r,n=ro(),a=n.dir,l=n.locale,f=n.classNames,i=n.styles,_=n.labels,b=_.labelPrevious,E=_.labelNext,C=n.components;if(!e.nextMonth&&!e.previousMonth)return j.jsx(j.Fragment,{});var R=b(e.previousMonth,{locale:l}),F=[f.nav_button,f.nav_button_previous].join(" "),U=E(e.nextMonth,{locale:l}),$=[f.nav_button,f.nav_button_next].join(" "),H=(t=C==null?void 0:C.IconRight)!==null&&t!==void 0?t:k7e,q=(r=C==null?void 0:C.IconLeft)!==null&&r!==void 0?r:O7e;return j.jsxs("div",{className:f.nav,style:i.nav,children:[!e.hidePrevious&&j.jsx(xO,{name:"previous-month","aria-label":R,className:F,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?j.jsx(H,{className:f.nav_icon,style:i.nav_icon}):j.jsx(q,{className:f.nav_icon,style:i.nav_icon})}),!e.hideNext&&j.jsx(xO,{name:"next-month","aria-label":U,className:$,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?j.jsx(q,{className:f.nav_icon,style:i.nav_icon}):j.jsx(H,{className:f.nav_icon,style:i.nav_icon})})]})}function XZ(e){var t=ro().numberOfMonths,r=jE(),n=r.previousMonth,a=r.nextMonth,l=r.goToMonth,f=r.displayMonths,i=f.findIndex(function(U){return V$(e.displayMonth,U)}),_=i===0,b=i===f.length-1,E=t>1&&(_||!b),C=t>1&&(b||!_),R=function(){n&&l(n)},F=function(){a&&l(a)};return j.jsx(R7e,{displayMonth:e.displayMonth,hideNext:E,hidePrevious:C,nextMonth:a,previousMonth:n,onPreviousClick:R,onNextClick:F})}function D7e(e){var t,r=ro(),n=r.classNames,a=r.disableNavigation,l=r.styles,f=r.captionLayout,i=r.components,_=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:hse,b;return a?b=j.jsx(_,{id:e.id,displayMonth:e.displayMonth}):f==="dropdown"?b=j.jsx(ZZ,{displayMonth:e.displayMonth,id:e.id}):f==="dropdown-buttons"?b=j.jsxs(j.Fragment,{children:[j.jsx(ZZ,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),j.jsx(XZ,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):b=j.jsxs(j.Fragment,{children:[j.jsx(_,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),j.jsx(XZ,{displayMonth:e.displayMonth,id:e.id})]}),j.jsx("div",{className:n.caption,style:l.caption,children:b})}function L7e(e){var t=ro(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?j.jsx("tfoot",{className:a,style:n.tfoot,children:j.jsx("tr",{children:j.jsx("td",{colSpan:8,children:r})})}):j.jsx(j.Fragment,{})}function N7e(e,t,r){for(var n=r?Ay(new Date):Ld(new Date,{locale:e,weekStartsOn:t}),a=[],l=0;l<7;l++){var f=Ms(n,l);a.push(f)}return a}function z7e(){var e=ro(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,l=e.weekStartsOn,f=e.ISOWeek,i=e.formatters.formatWeekdayName,_=e.labels.labelWeekday,b=N7e(a,l,f);return j.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&j.jsx("td",{style:r.head_cell,className:t.head_cell}),b.map(function(E,C){return j.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":_(E,{locale:a}),children:i(E,{locale:a})},C)})]})}function j7e(){var e,t=ro(),r=t.classNames,n=t.styles,a=t.components,l=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:z7e;return j.jsx("thead",{style:n.head,className:r.head,children:j.jsx(l,{})})}function F7e(e){var t=ro(),r=t.locale,n=t.formatters.formatDay;return j.jsx(j.Fragment,{children:n(e.date,{locale:r})})}var X$=ne.createContext(void 0);function B7e(e){if(!NE(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return j.jsx(X$.Provider,{value:t,children:e.children})}return j.jsx($7e,{initialProps:e.initialProps,children:e.children})}function $7e(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,l=t.max,f=function(b,E,C){var R,F;(R=t.onDayClick)===null||R===void 0||R.call(t,b,E,C);var U=!!(E.selected&&a&&(n==null?void 0:n.length)===a);if(!U){var $=!!(!E.selected&&l&&(n==null?void 0:n.length)===l);if(!$){var H=n?use([],n):[];if(E.selected){var q=H.findIndex(function(G){return ll(b,G)});H.splice(q,1)}else H.push(b);(F=t.onSelect)===null||F===void 0||F.call(t,H,b,E,C)}}},i={disabled:[]};n&&i.disabled.push(function(b){var E=l&&n.length>l-1,C=n.some(function(R){return ll(R,b)});return!!(E&&!C)});var _={selected:n,onDayClick:f,modifiers:i};return j.jsx(X$.Provider,{value:_,children:r})}function Y$(){var e=ne.useContext(X$);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function U7e(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?ll(a,e)&&ll(n,e)?void 0:ll(a,e)?{from:a,to:void 0}:ll(n,e)?void 0:zF(n,e)?{from:e,to:a}:{from:n,to:e}:a?zF(e,a)?{from:a,to:e}:{from:e,to:a}:n?Mae(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var K$=ne.createContext(void 0);function V7e(e){if(!zE(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return j.jsx(K$.Provider,{value:t,children:e.children})}return j.jsx(W7e,{initialProps:e.initialProps,children:e.children})}function W7e(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},l=a.from,f=a.to,i=t.min,_=t.max,b=function(F,U,$){var H,q;(H=t.onDayClick)===null||H===void 0||H.call(t,F,U,$);var G=U7e(F,n);(q=t.onSelect)===null||q===void 0||q.call(t,G,F,U,$)},E={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(E.range_start=[l],f?(E.range_end=[f],ll(l,f)||(E.range_middle=[{after:l,before:f}])):E.range_end=[l]):f&&(E.range_start=[f],E.range_end=[f]),i&&(l&&!f&&E.disabled.push({after:lN(l,i-1),before:Ms(l,i-1)}),l&&f&&E.disabled.push({after:l,before:Ms(l,i-1)}),!l&&f&&E.disabled.push({after:lN(f,i-1),before:Ms(f,i-1)})),_){if(l&&!f&&(E.disabled.push({before:Ms(l,-_+1)}),E.disabled.push({after:Ms(l,_-1)})),l&&f){var C=Td(f,l)+1,R=_-C;E.disabled.push({before:lN(l,R)}),E.disabled.push({after:Ms(f,R)})}!l&&f&&(E.disabled.push({before:Ms(f,-_+1)}),E.disabled.push({after:Ms(f,_-1)}))}return j.jsx(K$.Provider,{value:{selected:n,onDayClick:b,modifiers:E},children:r})}function J$(){var e=ne.useContext(K$);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function XM(e){return Array.isArray(e)?use([],e):e!==void 0?[e]:[]}function G7e(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=XM(a)}),t}var Nu;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Nu||(Nu={}));var q7e=Nu.Selected,ch=Nu.Disabled,H7e=Nu.Hidden,Z7e=Nu.Today,dN=Nu.RangeEnd,hN=Nu.RangeMiddle,fN=Nu.RangeStart,X7e=Nu.Outside;function Y7e(e,t,r){var n,a=(n={},n[q7e]=XM(e.selected),n[ch]=XM(e.disabled),n[H7e]=XM(e.hidden),n[Z7e]=[e.today],n[dN]=[],n[hN]=[],n[fN]=[],n[X7e]=[],n);return e.fromDate&&a[ch].push({before:e.fromDate}),e.toDate&&a[ch].push({after:e.toDate}),NE(e)?a[ch]=a[ch].concat(t.modifiers[ch]):zE(e)&&(a[ch]=a[ch].concat(r.modifiers[ch]),a[fN]=r.modifiers[fN],a[hN]=r.modifiers[hN],a[dN]=r.modifiers[dN]),a}var mse=ne.createContext(void 0);function K7e(e){var t=ro(),r=Y$(),n=J$(),a=Y7e(t,r,n),l=G7e(t.modifiers),f=xn(xn({},a),l);return j.jsx(mse.Provider,{value:f,children:e.children})}function gse(){var e=ne.useContext(mse);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function J7e(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Q7e(e){return!!(e&&typeof e=="object"&&"from"in e)}function e9e(e){return!!(e&&typeof e=="object"&&"after"in e)}function t9e(e){return!!(e&&typeof e=="object"&&"before"in e)}function r9e(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function n9e(e,t){var r,n=t.from,a=t.to;if(n&&a){var l=Td(a,n)<0;l&&(r=[a,n],n=r[0],a=r[1]);var f=Td(e,n)>=0&&Td(a,e)>=0;return f}return a?ll(a,e):n?ll(n,e):!1}function i9e(e){return B$(e)}function o9e(e){return Array.isArray(e)&&e.every(B$)}function a9e(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(i9e(r))return ll(e,r);if(o9e(r))return r.includes(e);if(Q7e(r))return n9e(e,r);if(r9e(r))return r.dayOfWeek.includes(e.getDay());if(J7e(r)){var n=Td(r.before,e),a=Td(r.after,e),l=n>0,f=a<0,i=zF(r.before,r.after);return i?f&&l:l||f}return e9e(r)?Td(e,r.after)>0:t9e(r)?Td(r.before,e)>0:typeof r=="function"?r(e):!1})}function Q$(e,t,r){var n=Object.keys(t).reduce(function(l,f){var i=t[f];return a9e(e,i)&&l.push(f),l},[]),a={};return n.forEach(function(l){return a[l]=!0}),r&&!V$(e,r)&&(a.outside=!0),a}function s9e(e,t){for(var r=fl(e[0]),n=$$(e[e.length-1]),a,l,f=r;f<=n;){var i=Q$(f,t),_=!i.disabled&&!i.hidden;if(!_){f=Ms(f,1);continue}if(i.selected)return f;i.today&&!l&&(l=f),a||(a=f),f=Ms(f,1)}return l||a}var l9e=365;function yse(e,t){var r=t.moveBy,n=t.direction,a=t.context,l=t.modifiers,f=t.retry,i=f===void 0?{count:0,lastFocused:e}:f,_=a.weekStartsOn,b=a.fromDate,E=a.toDate,C=a.locale,R={day:Ms,week:NF,month:Du,year:bGe,startOfWeek:function(H){return a.ISOWeek?Ay(H):Ld(H,{locale:C,weekStartsOn:_})},endOfWeek:function(H){return a.ISOWeek?bae(H):U$(H,{locale:C,weekStartsOn:_})}},F=R[r](e,n==="after"?1:-1);n==="before"&&b?F=wGe([b,F]):n==="after"&&E&&(F=SGe([E,F]));var U=!0;if(l){var $=Q$(F,l);U=!$.disabled&&!$.hidden}return U?F:i.count>l9e?i.lastFocused:yse(F,{moveBy:r,direction:n,context:a,modifiers:l,retry:xn(xn({},i),{count:i.count+1})})}var vse=ne.createContext(void 0);function c9e(e){var t=jE(),r=gse(),n=ne.useState(),a=n[0],l=n[1],f=ne.useState(),i=f[0],_=f[1],b=s9e(t.displayMonths,r),E=a??(i&&t.isDateDisplayed(i))?i:b,C=function(){_(a),l(void 0)},R=function(H){l(H)},F=ro(),U=function(H,q){if(a){var G=yse(a,{moveBy:H,direction:q,context:F,modifiers:r});ll(a,G)||(t.goToDate(G,a),R(G))}},$={focusedDay:a,focusTarget:E,blur:C,focus:R,focusDayAfter:function(){return U("day","after")},focusDayBefore:function(){return U("day","before")},focusWeekAfter:function(){return U("week","after")},focusWeekBefore:function(){return U("week","before")},focusMonthBefore:function(){return U("month","before")},focusMonthAfter:function(){return U("month","after")},focusYearBefore:function(){return U("year","before")},focusYearAfter:function(){return U("year","after")},focusStartOfWeek:function(){return U("startOfWeek","before")},focusEndOfWeek:function(){return U("endOfWeek","after")}};return j.jsx(vse.Provider,{value:$,children:e.children})}function eU(){var e=ne.useContext(vse);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function u9e(e,t){var r=gse(),n=Q$(e,r,t);return n}var tU=ne.createContext(void 0);function d9e(e){if(!bR(e.initialProps)){var t={selected:void 0};return j.jsx(tU.Provider,{value:t,children:e.children})}return j.jsx(h9e,{initialProps:e.initialProps,children:e.children})}function h9e(e){var t=e.initialProps,r=e.children,n=function(l,f,i){var _,b,E;if((_=t.onDayClick)===null||_===void 0||_.call(t,l,f,i),f.selected&&!t.required){(b=t.onSelect)===null||b===void 0||b.call(t,void 0,l,f,i);return}(E=t.onSelect)===null||E===void 0||E.call(t,l,l,f,i)},a={selected:t.selected,onDayClick:n};return j.jsx(tU.Provider,{value:a,children:r})}function _se(){var e=ne.useContext(tU);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function f9e(e,t){var r=ro(),n=_se(),a=Y$(),l=J$(),f=eU(),i=f.focusDayAfter,_=f.focusDayBefore,b=f.focusWeekAfter,E=f.focusWeekBefore,C=f.blur,R=f.focus,F=f.focusMonthBefore,U=f.focusMonthAfter,$=f.focusYearBefore,H=f.focusYearAfter,q=f.focusStartOfWeek,G=f.focusEndOfWeek,J=function(at){var Be,ct,jt,Lt;bR(r)?(Be=n.onDayClick)===null||Be===void 0||Be.call(n,e,t,at):NE(r)?(ct=a.onDayClick)===null||ct===void 0||ct.call(a,e,t,at):zE(r)?(jt=l.onDayClick)===null||jt===void 0||jt.call(l,e,t,at):(Lt=r.onDayClick)===null||Lt===void 0||Lt.call(r,e,t,at)},te=function(at){var Be;R(e),(Be=r.onDayFocus)===null||Be===void 0||Be.call(r,e,t,at)},oe=function(at){var Be;C(),(Be=r.onDayBlur)===null||Be===void 0||Be.call(r,e,t,at)},he=function(at){var Be;(Be=r.onDayMouseEnter)===null||Be===void 0||Be.call(r,e,t,at)},le=function(at){var Be;(Be=r.onDayMouseLeave)===null||Be===void 0||Be.call(r,e,t,at)},ve=function(at){var Be;(Be=r.onDayPointerEnter)===null||Be===void 0||Be.call(r,e,t,at)},We=function(at){var Be;(Be=r.onDayPointerLeave)===null||Be===void 0||Be.call(r,e,t,at)},Ie=function(at){var Be;(Be=r.onDayTouchCancel)===null||Be===void 0||Be.call(r,e,t,at)},Re=function(at){var Be;(Be=r.onDayTouchEnd)===null||Be===void 0||Be.call(r,e,t,at)},$e=function(at){var Be;(Be=r.onDayTouchMove)===null||Be===void 0||Be.call(r,e,t,at)},ot=function(at){var Be;(Be=r.onDayTouchStart)===null||Be===void 0||Be.call(r,e,t,at)},Je=function(at){var Be;(Be=r.onDayKeyUp)===null||Be===void 0||Be.call(r,e,t,at)},rt=function(at){var Be;switch(at.key){case"ArrowLeft":at.preventDefault(),at.stopPropagation(),r.dir==="rtl"?i():_();break;case"ArrowRight":at.preventDefault(),at.stopPropagation(),r.dir==="rtl"?_():i();break;case"ArrowDown":at.preventDefault(),at.stopPropagation(),b();break;case"ArrowUp":at.preventDefault(),at.stopPropagation(),E();break;case"PageUp":at.preventDefault(),at.stopPropagation(),at.shiftKey?$():F();break;case"PageDown":at.preventDefault(),at.stopPropagation(),at.shiftKey?H():U();break;case"Home":at.preventDefault(),at.stopPropagation(),q();break;case"End":at.preventDefault(),at.stopPropagation(),G();break}(Be=r.onDayKeyDown)===null||Be===void 0||Be.call(r,e,t,at)},st={onClick:J,onFocus:te,onBlur:oe,onKeyDown:rt,onKeyUp:Je,onMouseEnter:he,onMouseLeave:le,onPointerEnter:ve,onPointerLeave:We,onTouchCancel:Ie,onTouchEnd:Re,onTouchMove:$e,onTouchStart:ot};return st}function p9e(){var e=ro(),t=_se(),r=Y$(),n=J$(),a=bR(e)?t.selected:NE(e)?r.selected:zE(e)?n.selected:void 0;return a}function m9e(e){return Object.values(Nu).includes(e)}function g9e(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(m9e(n)){var l=e.classNames["day_".concat(n)];l&&r.push(l)}}),r}function y9e(e,t){var r=xn({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=xn(xn({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function v9e(e,t,r){var n,a,l,f=ro(),i=eU(),_=u9e(e,t),b=f9e(e,_),E=p9e(),C=!!(f.onDayClick||f.mode!=="default");ne.useEffect(function(){var he;_.outside||i.focusedDay&&C&&ll(i.focusedDay,e)&&((he=r.current)===null||he===void 0||he.focus())},[i.focusedDay,e,r,C,_.outside]);var R=g9e(f,_).join(" "),F=y9e(f,_),U=!!(_.outside&&!f.showOutsideDays||_.hidden),$=(l=(a=f.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:F7e,H=j.jsx($,{date:e,displayMonth:t,activeModifiers:_}),q={style:F,className:R,children:H,role:"gridcell"},G=i.focusTarget&&ll(i.focusTarget,e)&&!_.outside,J=i.focusedDay&&ll(i.focusedDay,e),te=xn(xn(xn({},q),(n={disabled:_.disabled,role:"gridcell"},n["aria-selected"]=_.selected,n.tabIndex=J||G?0:-1,n)),b),oe={isButton:C,isHidden:U,activeModifiers:_,selectedDays:E,buttonProps:te,divProps:q};return oe}function _9e(e){var t=ne.useRef(null),r=v9e(e.date,e.displayMonth,t);return r.isHidden?j.jsx("div",{role:"gridcell"}):r.isButton?j.jsx(xO,xn({name:"day",ref:t},r.buttonProps)):j.jsx("div",xn({},r.divProps))}function x9e(e){var t=e.number,r=e.dates,n=ro(),a=n.onWeekNumberClick,l=n.styles,f=n.classNames,i=n.locale,_=n.labels.labelWeekNumber,b=n.formatters.formatWeekNumber,E=b(Number(t),{locale:i});if(!a)return j.jsx("span",{className:f.weeknumber,style:l.weeknumber,children:E});var C=_(Number(t),{locale:i}),R=function(F){a(t,r,F)};return j.jsx(xO,{name:"week-number","aria-label":C,className:f.weeknumber,style:l.weeknumber,onClick:R,children:E})}function b9e(e){var t,r,n=ro(),a=n.styles,l=n.classNames,f=n.showWeekNumber,i=n.components,_=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:_9e,b=(r=i==null?void 0:i.WeekNumber)!==null&&r!==void 0?r:x9e,E;return f&&(E=j.jsx("td",{className:l.cell,style:a.cell,children:j.jsx(b,{number:e.weekNumber,dates:e.dates})})),j.jsxs("tr",{className:l.row,style:a.row,children:[E,e.dates.map(function(C){return j.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:j.jsx(_,{displayMonth:e.displayMonth,date:C})},wqe(C))})]})}function YZ(e,t,r){for(var n=r!=null&&r.ISOWeek?bae(t):U$(t,r),a=r!=null&&r.ISOWeek?Ay(e):Ld(e,r),l=Td(n,a),f=[],i=0;i<=l;i++)f.push(Ms(a,i));var _=f.reduce(function(b,E){var C=r!=null&&r.ISOWeek?Sae(E):Eae(E,r),R=b.find(function(F){return F.weekNumber===C});return R?(R.dates.push(E),b):(b.push({weekNumber:C,dates:[E]}),b)},[]);return _}function w9e(e,t){var r=YZ(fl(e),$$(e),t);if(t!=null&&t.useFixedWeeks){var n=Tqe(e,t);if(n<6){var a=r[r.length-1],l=a.dates[a.dates.length-1],f=NF(l,6-n),i=YZ(NF(l,1),f,t);r.push.apply(r,i)}}return r}function S9e(e){var t,r,n,a=ro(),l=a.locale,f=a.classNames,i=a.styles,_=a.hideHead,b=a.fixedWeeks,E=a.components,C=a.weekStartsOn,R=a.firstWeekContainsDate,F=a.ISOWeek,U=w9e(e.displayMonth,{useFixedWeeks:!!b,ISOWeek:F,locale:l,weekStartsOn:C,firstWeekContainsDate:R}),$=(t=E==null?void 0:E.Head)!==null&&t!==void 0?t:j7e,H=(r=E==null?void 0:E.Row)!==null&&r!==void 0?r:b9e,q=(n=E==null?void 0:E.Footer)!==null&&n!==void 0?n:L7e;return j.jsxs("table",{id:e.id,className:f.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!_&&j.jsx($,{}),j.jsx("tbody",{className:f.tbody,style:i.tbody,children:U.map(function(G){return j.jsx(H,{displayMonth:e.displayMonth,dates:G.dates,weekNumber:G.weekNumber},G.weekNumber)})}),j.jsx(q,{displayMonth:e.displayMonth})]})}function T9e(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var E9e=T9e()?ne.useLayoutEffect:ne.useEffect,pN=!1,A9e=0;function KZ(){return"react-day-picker-".concat(++A9e)}function M9e(e){var t,r=e??(pN?KZ():null),n=ne.useState(r),a=n[0],l=n[1];return E9e(function(){a===null&&l(KZ())},[]),ne.useEffect(function(){pN===!1&&(pN=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function C9e(e){var t,r,n=ro(),a=n.dir,l=n.classNames,f=n.styles,i=n.components,_=jE().displayMonths,b=M9e(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),E=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,C=[l.month],R=f.month,F=e.displayIndex===0,U=e.displayIndex===_.length-1,$=!F&&!U;a==="rtl"&&(t=[F,U],U=t[0],F=t[1]),F&&(C.push(l.caption_start),R=xn(xn({},R),f.caption_start)),U&&(C.push(l.caption_end),R=xn(xn({},R),f.caption_end)),$&&(C.push(l.caption_between),R=xn(xn({},R),f.caption_between));var H=(r=i==null?void 0:i.Caption)!==null&&r!==void 0?r:D7e;return j.jsxs("div",{className:C.join(" "),style:R,children:[j.jsx(H,{id:b,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),j.jsx(S9e,{id:E,"aria-labelledby":b,displayMonth:e.displayMonth})]},e.displayIndex)}function P9e(e){var t=ro(),r=t.classNames,n=t.styles;return j.jsx("div",{className:r.months,style:n.months,children:e.children})}function I9e(e){var t,r,n=e.initialProps,a=ro(),l=eU(),f=jE(),i=ne.useState(!1),_=i[0],b=i[1];ne.useEffect(function(){a.initialFocus&&l.focusTarget&&(_||(l.focus(l.focusTarget),b(!0)))},[a.initialFocus,_,l.focus,l.focusTarget,l]);var E=[a.classNames.root,a.className];a.numberOfMonths>1&&E.push(a.classNames.multiple_months),a.showWeekNumber&&E.push(a.classNames.with_weeknumber);var C=xn(xn({},a.styles.root),a.style),R=Object.keys(n).filter(function(U){return U.startsWith("data-")}).reduce(function(U,$){var H;return xn(xn({},U),(H={},H[$]=n[$],H))},{}),F=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:P9e;return j.jsx("div",xn({className:E.join(" "),style:C,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},R,{children:j.jsx(F,{children:f.displayMonths.map(function(U,$){return j.jsx(C9e,{displayIndex:$,displayMonth:U},$)})})}))}function O9e(e){var t=e.children,r=t7e(e,["children"]);return j.jsx(x7e,{initialProps:r,children:j.jsx(I7e,{children:j.jsx(d9e,{initialProps:r,children:j.jsx(B7e,{initialProps:r,children:j.jsx(V7e,{initialProps:r,children:j.jsx(K7e,{children:j.jsx(c9e,{children:t})})})})})})})}function k9e(e){return j.jsx(O9e,xn({},e,{children:j.jsx(I9e,{initialProps:e})}))}function xse({className:e,classNames:t,showOutsideDays:r=!0,...n}){return j.jsx(k9e,{showOutsideDays:r,className:Nr("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Nr(Yz({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Nr(Yz({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>j.jsx(CB,{className:"h-4 w-4"}),IconRight:({...a})=>j.jsx(PB,{className:"h-4 w-4"})},...n})}xse.displayName="Calendar";const R9e=()=>{const{control:e,watch:t}=kE(),r=Ny();return j.jsxs(Rd,{children:[j.jsxs(eb,{children:[j.jsx(tb,{children:"Información Personal"}),j.jsx(ME,{children:"Ingrese los datos personales del operador."})]}),j.jsxs(sm,{className:"space-y-4",children:[j.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[j.jsx(Ss,{control:e,name:"name",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Nombre"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Nombre",...n})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e,name:"lastname",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Apellido Paterno"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Apellido paterno",...n})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e,name:"secondLastname",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Apellido Materno"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Apellido materno",...n})}),j.jsx(es,{})]})})]}),j.jsx(Ss,{control:e,name:"sex",render:({field:n})=>j.jsxs(ha,{className:"space-y-3",children:[j.jsx(fa,{children:"Sexo"}),j.jsx(pa,{children:j.jsxs(Kae,{onValueChange:n.onChange,defaultValue:n.value,className:"flex flex-col space-y-1 sm:flex-row sm:space-x-4 sm:space-y-0",children:[j.jsxs(ha,{className:"flex items-center space-x-3 space-y-0",children:[j.jsx(pa,{children:j.jsx(ZM,{value:"masculino"})}),j.jsx(fa,{className:"font-normal",children:"Masculino"})]}),j.jsxs(ha,{className:"flex items-center space-x-3 space-y-0",children:[j.jsx(pa,{children:j.jsx(ZM,{value:"femenino"})}),j.jsx(fa,{className:"font-normal",children:"Femenino"})]}),j.jsxs(ha,{className:"flex items-center space-x-3 space-y-0",children:[j.jsx(pa,{children:j.jsx(ZM,{value:"otro"})}),j.jsx(fa,{className:"font-normal",children:"Otro"})]})]})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e,name:"birthDate",render:({field:n})=>j.jsxs(ha,{className:"flex flex-col",children:[j.jsx(fa,{children:"Fecha de Nacimiento"}),j.jsxs(QHe,{children:[j.jsx(e7e,{asChild:!0,children:j.jsx(pa,{children:j.jsxs(Zn,{variant:"outline",className:Nr("w-full pl-3 text-left font-normal",!n.value&&"text-muted-foreground"),children:[n.value?ef(n.value,"dd/MM/yyyy"):j.jsx("span",{children:"Seleccionar fecha"}),j.jsx(vme,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),j.jsx(cse,{className:"w-auto p-0",align:"start",children:j.jsx(xse,{mode:"single",selected:n.value,onSelect:n.onChange,disabled:a=>a>new Date||a<new Date("1900-01-01"),initialFocus:!0})})]}),j.jsx(es,{})]})}),j.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[j.jsx(Ss,{control:e,name:"curp",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"CURP"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"CURP",...n})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e,name:"rfc",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"RFC"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"RFC",...n})}),j.jsx(es,{})]})})]}),j.jsx(Ss,{control:e,name:"email",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Correo Electrónico"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"correo@ejemplo.com",...n})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e,name:"phone",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Teléfono Celular"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"+52 1234567890",...n})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e,name:"offerSource",render:({field:n})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"¿Cómo se enteró de nuestra oferta de trabajo?"}),j.jsxs(Lie,{onValueChange:n.onChange,defaultValue:n.value,children:[j.jsx(pa,{children:j.jsx(f$,{children:j.jsx(Nie,{placeholder:"Seleccionar origen"})})}),j.jsxs(p$,{children:[j.jsx(_d,{value:"internet",children:"Internet"}),j.jsx(_d,{value:"recomendacion",children:"Recomendación"}),j.jsx(_d,{value:"bolsa_trabajo",children:"Bolsa de trabajo"}),j.jsx(_d,{value:"redes_sociales",children:"Redes sociales"}),j.jsx(_d,{value:"otro",children:"Otro"})]})]}),j.jsx(es,{})]})})]}),j.jsxs(Ioe,{className:"flex justify-end space-x-2 mt-4",children:[j.jsx(Zn,{variant:"outline",type:"button",onClick:()=>r("/admin/operators"),children:"Cancelar"}),j.jsx(Zn,{type:"submit",children:"Guardar y Continuar"})]})]})},D9e=({operatorId:e,documents:t,onDocumentUpload:r,onDocumentDelete:n})=>{const[a,l]=ne.useState(!1),[f,i]=ne.useState({}),[_,b]=ne.useState(null),[E,C]=ne.useState(!1),{toast:R}=Px();ne.useEffect(()=>{const G=async()=>{const J={};for(const te of t)try{const{data:oe,error:he}=await mo.storage.from("operator-documents").createSignedUrl(te.file_path,3600);if(he){console.error("Error creating signed URL:",he);continue}oe&&oe.signedUrl&&(J[te.id]=oe.signedUrl)}catch(oe){console.error("Error getting signed URL for document:",oe)}i(J)};t.length>0&&G()},[t]);const F=async(G,J)=>{try{l(!0),await r(G,J)}catch(te){console.error("Error uploading document:",te),R({variant:"destructive",title:"Error",description:"Error al subir el documento"})}finally{l(!1)}},U=G=>t.some(J=>J.document_type===G),$=G=>t.find(J=>J.document_type===G),H=(G,J)=>{G.preventDefault(),G.stopPropagation(),b(J),C(!0)},q=["INE","Licencia","Comprobante de domicilio","CURP","Carta de Antecedentes","Examen Toxicológico"];return j.jsxs(j.Fragment,{children:[j.jsxs(Rd,{children:[j.jsxs(eb,{children:[j.jsx(tb,{children:"Documentos del Operador"}),j.jsx(ME,{children:"Gestiona los documentos del operador"})]}),j.jsx(sm,{children:j.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:q.map(G=>{const J=U(G),te=$(G);return j.jsx(Rd,{className:Nr("relative overflow-hidden transition-colors",J?"bg-green-50 border-green-200":"bg-background"),children:j.jsx(sm,{className:"p-4",children:j.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[j.jsx(RJ,{className:Nr("h-8 w-8",J?"text-green-500":"text-muted-foreground")}),j.jsx("p",{className:"font-medium text-center",children:G}),J&&te?j.jsxs("div",{className:"w-full space-y-2",children:[j.jsx("p",{className:"text-sm text-center text-muted-foreground",children:te.file_name}),j.jsxs("div",{className:"flex gap-2 justify-center",children:[j.jsxs(Zn,{variant:"outline",size:"sm",onClick:oe=>{f[te.id]?H(oe,f[te.id]):R({variant:"destructive",title:"Error",description:"No se pudo obtener el enlace del documento. Inténtalo nuevamente."})},className:"gap-2",disabled:!f[te.id],type:"button",children:[j.jsx(Eme,{className:"h-4 w-4"}),"Ver documento"]}),j.jsx(Zn,{variant:"destructive",size:"sm",onClick:oe=>{oe.preventDefault(),n(te.id,te.file_path)},type:"button",children:"Eliminar"})]})]}):j.jsx(Si,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:oe=>{var le;const he=(le=oe.target.files)==null?void 0:le[0];he&&F(he,G)},disabled:a,className:"w-full"})]})})},G)})})})]}),j.jsx(Eoe,{open:E,onOpenChange:C,children:j.jsxs(w$,{className:"max-w-4xl h-[90vh] flex flex-col p-0 overflow-hidden",children:[j.jsx(S$,{className:"p-6 pb-2",children:j.jsx(T$,{children:"Vista previa del documento"})}),j.jsx("div",{className:"flex-1 overflow-auto p-6 pt-0",children:_&&(_.toLowerCase().endsWith(".pdf")?j.jsx("iframe",{src:`${_}#toolbar=1&navpanes=1`,className:"w-full h-full border-0 min-h-[600px]",title:"PDF Viewer"}):j.jsx("div",{className:"w-full h-full flex items-center justify-center",children:j.jsx("img",{src:_,alt:"Document preview",className:"max-w-full max-h-[calc(90vh-120px)] object-contain"})}))})]})})]})},L9e=({form:e})=>j.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[j.jsx(Ss,{control:e.control,name:"brand",render:({field:t})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Marca"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Marca del vehículo",...t})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e.control,name:"model",render:({field:t})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Modelo"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Modelo del vehículo",...t})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e.control,name:"year",render:({field:t})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Año"}),j.jsx(pa,{children:j.jsx(Si,{type:"number",placeholder:"Año del vehículo",...t,onChange:r=>t.onChange(Number(r.target.value))})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e.control,name:"plate",render:({field:t})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Placa"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Número de placa",...t})}),j.jsx(es,{})]})}),j.jsx(Ss,{control:e.control,name:"color",render:({field:t})=>j.jsxs(ha,{children:[j.jsx(fa,{children:"Color"}),j.jsx(pa,{children:j.jsx(Si,{placeholder:"Color del vehículo",...t})}),j.jsx(es,{})]})})]}),UF={async registerVehicle(e,t){try{if(!e)throw new Error("ID del operador no proporcionado");console.log("Registrando vehículo para operador:",e),console.log("Datos del vehículo:",t);const r={operator_id:e,brand:t.brand,model:t.model,year:Number(t.year),plate:t.plate,color:t.color||null};console.log("Guardando datos del vehículo:",r);const{data:n,error:a}=await mo.from("operator_vehicles").insert(r).select().single();if(a)throw console.error("Error al guardar vehículo:",a),a;return console.log("Vehículo registrado exitosamente:",n),n}catch(r){throw console.error("Error en registerVehicle:",r),r}},async getVehiclesByOperator(e){try{if(!e)throw new Error("ID del operador no proporcionado");const{data:t,error:r}=await mo.from("operator_vehicles").select("*").eq("operator_id",e);if(r)throw console.error("Error al obtener vehículos:",r),r;return t||[]}catch(t){throw console.error("Error en getVehiclesByOperator:",t),t}},async deleteVehicle(e){try{if(!e)throw new Error("ID del vehículo no proporcionado");const{error:t}=await mo.from("operator_vehicles").delete().eq("id",e);if(t)throw console.error("Error al eliminar vehículo:",t),t;return console.log("Vehículo eliminado exitosamente"),!0}catch(t){throw console.error("Error en deleteVehicle:",t),t}}},N9e=({operatorId:e,onComplete:t})=>{const{toast:r}=Px(),[n,a]=ze.useState(!1),l=j$({resolver:vae(CHe),defaultValues:{brand:"",model:"",year:0,plate:"",color:""}}),f=async i=>{try{a(!0),console.log("Enviando datos del vehículo:",i),console.log("ID del operador:",e),await UF.registerVehicle(e,i),r({title:"Éxito",description:"Vehículo registrado correctamente"}),l.reset(),t()}catch(_){console.error("Error al registrar vehículo:",_),r({variant:"destructive",title:"Error",description:"No se pudo registrar el vehículo. Por favor intente nuevamente."})}finally{a(!1)}};return j.jsxs(Rd,{children:[j.jsxs(eb,{children:[j.jsx(tb,{children:"Nuevo Vehículo"}),j.jsx(ME,{children:"Ingrese los datos del vehículo"})]}),j.jsx(sm,{children:j.jsx(pae,{...l,children:j.jsxs("form",{onSubmit:l.handleSubmit(f),className:"space-y-6",children:[j.jsx(L9e,{form:l}),j.jsxs(Zn,{type:"submit",className:"w-full",disabled:n,children:[j.jsx(OJ,{className:"mr-2 h-4 w-4"}),n?"Registrando...":"Registrar Vehículo"]})]})})})]})},z9e=({operatorId:e})=>{const[t,r]=ne.useState([]),[n,a]=ne.useState(!0),{toast:l}=Px(),f=async()=>{try{a(!0),console.log("Cargando vehículos para operador:",e);const _=await UF.getVehiclesByOperator(e);r(_)}catch(_){console.error("Error al cargar vehículos:",_),l({variant:"destructive",title:"Error",description:"No se pudieron cargar los vehículos. Por favor intente nuevamente."})}finally{a(!1)}};ne.useEffect(()=>{e&&f()},[e]);const i=async _=>{try{await UF.deleteVehicle(_),l({title:"Éxito",description:"Vehículo eliminado correctamente"}),f()}catch(b){console.error("Error al eliminar vehículo:",b),l({variant:"destructive",title:"Error",description:"No se pudo eliminar el vehículo. Por favor intente nuevamente."})}};return j.jsxs(Rd,{children:[j.jsxs(eb,{children:[j.jsx(tb,{children:"Vehículos del Operador"}),j.jsx(ME,{children:"Lista de vehículos registrados"})]}),j.jsxs(sm,{className:"space-y-6",children:[n?j.jsx("div",{className:"text-center py-4",children:"Cargando vehículos..."}):t.length>0?j.jsx("div",{className:"space-y-4",children:t.map(_=>j.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[j.jsxs("div",{className:"flex items-center space-x-4",children:[j.jsx(OJ,{className:"h-6 w-6 text-blue-500"}),j.jsxs("div",{children:[j.jsxs("p",{className:"font-medium",children:[_.brand," ",_.model," (",_.year,")"]}),j.jsxs("p",{className:"text-sm text-muted-foreground",children:["Placa: ",_.plate]}),_.color&&j.jsxs("p",{className:"text-sm text-muted-foreground",children:["Color: ",_.color]})]})]}),j.jsx(Zn,{variant:"destructive",size:"icon",onClick:()=>i(_.id),children:j.jsx(Ime,{className:"h-4 w-4"})})]},_.id))}):j.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No hay vehículos registrados"}),j.jsx(N9e,{operatorId:e,onComplete:f})]})]})},bse=({defaultValues:e})=>{const{form:t,documents:r,handleDocumentUpload:n,handleDocumentDelete:a,onSubmit:l}=IHe({defaultValues:e});return j.jsx(Qoe,{...t,children:j.jsx(pae,{...t,children:j.jsx("form",{onSubmit:t.handleSubmit(l),className:"space-y-6",children:j.jsxs(y$,{defaultValue:"personal",value:t.watch("activeTab"),onValueChange:f=>{(f==="personal"||f==="documents"||f==="vehicles")&&t.setValue("activeTab",f)},className:"w-full",children:[j.jsxs(cR,{className:"grid w-full grid-cols-3",children:[j.jsx(xu,{value:"personal",children:"Datos Personales"}),j.jsx(xu,{value:"documents",children:"Documentos"}),j.jsx(xu,{value:"vehicles",children:"Vehículos"})]}),j.jsx(ly,{value:"personal",className:"space-y-4 mt-4",children:j.jsx(R9e,{})}),j.jsx(ly,{value:"documents",className:"space-y-4 mt-4",children:j.jsx(D9e,{operatorId:e==null?void 0:e.id,documents:r,onDocumentUpload:n,onDocumentDelete:a})}),j.jsx(ly,{value:"vehicles",className:"space-y-4 mt-4",children:(e==null?void 0:e.id)&&j.jsx(z9e,{operatorId:e.id})})]})})})})},j9e=()=>j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(iy,{to:"/admin/operators",children:j.jsx(Zn,{variant:"ghost",size:"icon",className:"mr-2",children:j.jsx(HP,{className:"h-5 w-5"})})}),j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Registro de Operador"})]})}),j.jsx(bse,{})]}),F9e=()=>{const{id:e}=A_e(),t=Ny(),{toast:r}=Px(),{data:n,isLoading:a,error:l}=nk({queryKey:["operator",e],queryFn:async()=>{const{data:f,error:i}=await mo.from("operators").select("*").eq("id",e).single();if(i)throw i;if(!f)throw new Error("Operador no encontrado");return{id:f.id,name:f.name,lastname:f.lastname,secondLastname:f.second_lastname,sex:f.sex,birthDate:new Date(f.birth_date),curp:f.curp,rfc:f.rfc,email:f.email,phone:f.phone,offerSource:f.offer_source,activeTab:"personal"}},meta:{onError:f=>{console.error("Error fetching operator:",f),r({variant:"destructive",title:"Error",description:"No se pudo cargar la información del operador"})}}});return a?j.jsx("div",{children:"Cargando..."}):l||!n?j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(iy,{to:"/admin/operators",children:j.jsx(Zn,{variant:"ghost",size:"icon",className:"mr-2",children:j.jsx(HP,{className:"h-5 w-5"})})}),j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Error"})]})}),j.jsxs("div",{className:"bg-destructive/10 p-4 rounded-md",children:[j.jsx("p",{children:"No se pudo encontrar el operador. Verifique el ID e intente nuevamente."}),j.jsx(Zn,{className:"mt-4",onClick:()=>t("/admin/operators"),children:"Volver al listado"})]})]}):j.jsxs("div",{className:"space-y-6",children:[j.jsx("div",{className:"flex items-center justify-between",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(iy,{to:"/admin/operators",children:j.jsx(Zn,{variant:"ghost",size:"icon",className:"mr-2",children:j.jsx(HP,{className:"h-5 w-5"})})}),j.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Editar Operador"})]})}),j.jsx(bse,{defaultValues:n})]})},B9e=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"TMS"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(_me,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Sistema de Gestión de Transporte"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Visualiza el historial de entregas, gestiona nóminas automatizadas y consulta el ranking de desempeño."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),$9e=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Tracking"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(Y_,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Seguimiento en Tiempo Real"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Visualiza la ubicación de tus entregas en tiempo real, filtra por rutas o conductores y recibe alertas."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),U9e=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Documentación"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(RJ,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Gestión de Documentos"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Administra la documentación de vehículos y conductores, consulta estado de validación y expiraciones próximas."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),V9e=()=>j.jsxs("div",{className:"animate-fade-in",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsx("h1",{className:"text-2xl font-bold",children:"Configuración"})}),j.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[j.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:j.jsx(vz,{className:"h-8 w-8 text-primary"})}),j.jsx("h2",{className:"text-xl font-medium mb-2",children:"Configuración del Sistema"}),j.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Ajusta parámetros del sistema, gestiona roles y permisos, administra API Keys y personaliza tu tenant."}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Pantalla en desarrollo"})]})]}),W9e=()=>{const e=Ly();return ne.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),j.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:j.jsxs("div",{className:"text-center",children:[j.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),j.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),j.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},wse=ne.forwardRef(({className:e,...t},r)=>j.jsx("textarea",{className:Nr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));wse.displayName="Textarea";var G9e=Object.defineProperty,q9e=Object.defineProperties,H9e=Object.getOwnPropertyDescriptors,bO=Object.getOwnPropertySymbols,Sse=Object.prototype.hasOwnProperty,Tse=Object.prototype.propertyIsEnumerable,JZ=(e,t,r)=>t in e?G9e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Bi=(e,t)=>{for(var r in t||(t={}))Sse.call(t,r)&&JZ(e,r,t[r]);if(bO)for(var r of bO(t))Tse.call(t,r)&&JZ(e,r,t[r]);return e},Kp=(e,t)=>q9e(e,H9e(t)),wR=(e,t)=>{var r={};for(var n in e)Sse.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&bO)for(var n of bO(e))t.indexOf(n)<0&&Tse.call(e,n)&&(r[n]=e[n]);return r},rU=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},za=(e,t,r)=>(rU(e,t,"read from private field"),r?r.call(e):t.get(e)),jl=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},pu=(e,t,r,n)=>(rU(e,t,"write to private field"),t.set(e,r),r),Z9e=(e,t,r,n)=>({set _(a){pu(e,t,a)},get _(){return za(e,t,n)}}),wx=(e,t,r)=>(rU(e,t,"access private method"),r),cl=(e,t,r)=>new Promise((n,a)=>{var l=_=>{try{i(r.next(_))}catch(b){a(b)}},f=_=>{try{i(r.throw(_))}catch(b){a(b)}},i=_=>_.done?n(_.value):Promise.resolve(_.value).then(l,f);i((r=r.apply(e,t)).next())}),Ese="https://api.mapbox.com/autofill/v1",X9e="suggest",Y9e="retrieve",K9e=`${Ese}/${X9e}`,J9e=`${Ese}/${Y9e}`,jo=class{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(e){if(e instanceof jo)return new jo(e.lng,e.lat);if(Array.isArray(e)&&e.length===2)return new jo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null&&("lng"in e||"lon"in e)&&"lat"in e)return new jo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}},$l=class{constructor(e,t){this._sw=jo.convert(e),this._ne=jo.convert(t)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new jo(this.getWest(),this.getNorth())}getSouthEast(){return new jo(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(e){if(!e)throw new Error("Invalid LngLatBounds convert value: falsy");if(e instanceof $l)return new $l(e.getSouthWest(),e.getNorthEast());if(Array.isArray(e)&&e.length===2)return new $l(jo.convert(e[0]),jo.convert(e[1]));if(Array.isArray(e)&&e.length===4)return new $l(jo.convert([e[0],e[1]]),jo.convert([e[2],e[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function Q9e(){const t=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[t.slice(0,8),t.slice(8,12),"4"+t.slice(12,15)+"-8"+t.slice(15,18),t.slice(18,30)].join("-")}var Ic=class{constructor(e){this.id=e??Q9e()}toString(){return this.id}static convert(e){return new Ic(e instanceof Ic?e.id:e.toString())}},eZe="Unknown error",tZe=class extends Error{constructor(e,t){super(String(e.message||e.error||eZe)),this.name="MapboxError",this.statusCode=t}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function Mh(e){return cl(this,null,function*(){if(!e.ok){const t=yield e.json();throw new tZe(t,e.status)}})}var QZ=globalThis.fetch,rZe=globalThis.AbortController;function Ed(){if(!QZ)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:QZ,AbortController:rZe}}function Py(...e){const t=[];for(const r of e){if(!r)continue;const n=Object.entries(r);for(const[a,l]of n)l!=null&&t.push(`${a}=${encodeURIComponent(String(l))}`)}return t.join("&")}var YM,VF,Ase,Mse=class{constructor(e={}){jl(this,VF),jl(this,YM,void 0);const t=e,{accessToken:r}=t,n=wR(t,["accessToken"]);this.accessToken=r,this.defaults=Bi(Bi({},Mse.defaults),n)}get responseHeaders(){return za(this,YM)}suggest(e,t){return cl(this,null,function*(){if(!e)throw new Error("searchText is required");const{sessionToken:r,signal:n}=t,a=Kp(Bi(Bi({},this.defaults),t),{sessionToken:r}),l=new URL(`${K9e}/${encodeURIComponent(e)}`);l.search=wx(this,VF,Ase).call(this,a);const{fetch:f}=Ed(),i=yield f(l.toString(),{signal:n});pu(this,YM,i.headers),yield Mh(i);const _=yield i.json();return Kp(Bi({},_),{suggestions:_.suggestions.map(b=>Kp(Bi({},b),{original_search_text:e})),url:l.toString()})})}retrieve(e,t){return cl(this,null,function*(){if(!e)throw new Error("suggestion is required");if(!this.canRetrieve(e))throw new Error("suggestion cannot be retrieved");const{sessionToken:r,signal:n}=t,a=Ic.convert(r),l=new URL(`${J9e}/${e.action.id}`);l.search=Py({access_token:this.accessToken,session_token:a.id});const{fetch:f}=Ed(),i=yield f(l.toString(),{signal:n});yield Mh(i);const _=yield i.json();return _.url=l.toString(),_})}canRetrieve(e){const t=e.action;return typeof(t==null?void 0:t.id)=="string"}},Cse=Mse;YM=new WeakMap;VF=new WeakSet;Ase=function(e){return Py({types:"address",access_token:this.accessToken,streets:e.streets,language:e.language,country:e.country,limit:e.limit},e.sessionToken&&{session_token:Ic.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:jo.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:$l.convert(e.bbox).toFlatArray().join(",")})};Cse.defaults={language:"en",proximity:"ip",streets:!0};var SR="https://api.mapbox.com/search/searchbox/v1",nZe="suggest",iZe="retrieve",oZe="category",aZe="reverse",sZe=`${SR}/${nZe}`,lZe=`${SR}/${iZe}`,cZe=`${SR}/${oZe}`,uZe=`${SR}/${aZe}`,KM,WF,Pse=class{constructor(e={}){jl(this,KM);const t=e,{accessToken:r}=t,n=wR(t,["accessToken"]);this.accessToken=r,this.defaults=Bi(Bi({},Pse.defaults),n)}suggest(e,t){return cl(this,null,function*(){if(!e)throw new Error("searchText is required");const{sessionToken:r,signal:n}=t,a=Kp(Bi(Bi({},this.defaults),t),{q:e,sessionToken:r});if(a.eta_type&&(!a.origin||!a.navigation_profile))throw new Error("to provide eta estimate: eta, navigation_profile, and origin are required");if(a.origin&&!a.navigation_profile)throw new Error("to provide distance estimate: both navigation_profile and origin are required");const l=new URL(sZe);l.search=wx(this,KM,WF).call(this,a);const{fetch:f}=Ed(),i=yield f(l.toString(),{signal:n});yield Mh(i);const _=yield i.json();return _.url=l.toString(),_})}retrieve(e,t){return cl(this,null,function*(){if(!e)throw new Error("suggestion is required");const{sessionToken:r,signal:n,language:a}=t,l=Ic.convert(r),f=Bi(Bi({},this.defaults),a&&{language:a}),i=new URL(`${lZe}/${encodeURIComponent(e.mapbox_id)}`);i.search=Py({access_token:this.accessToken,session_token:l.id},{language:f.language});const{fetch:_}=Ed(),b=yield _(i.toString(),{signal:n});yield Mh(b);const E=yield b.json();return E.url=i.toString(),E})}category(e){return cl(this,arguments,function*(t,r={}){if(!t)throw new Error("category is required");const n=Bi(Bi({},this.defaults),r),a=new URL(`${cZe}/${encodeURIComponent(t)}`);a.search=wx(this,KM,WF).call(this,n);const{fetch:l}=Ed(),f=yield l(a.toString(),{signal:n.signal});yield Mh(f);const i=yield f.json();return i.url=a.toString(),i})}reverse(e){return cl(this,arguments,function*(t,r={}){if(!t)throw new Error("lngLat is required");const[n,a]=typeof t=="string"?t.split(",").map(E=>parseFloat(E)):jo.convert(t).toArray();if(isNaN(n)||isNaN(a))throw new Error("lngLat is required");const l=Bi(Bi({},this.defaults),r),f=new URL(uZe);f.search=Py({access_token:this.accessToken,language:l.language,limit:l.limit,longitude:n,latitude:a},l.types&&{types:typeof l.types=="string"?l.types:[...l.types].join(",")});const{fetch:i}=Ed(),_=yield i(f.toString(),{signal:l.signal});yield Mh(_);const b=yield _.json();return b.url=f.toString(),b})}},Ise=Pse;KM=new WeakSet;WF=function(e){return Py({q:e.q,access_token:this.accessToken,language:e.language,limit:e.limit,navigation_profile:e.navigation_profile,route:e.route,route_geometry:e.route_geometry,sar_type:e.sar_type,time_deviation:e.time_deviation,eta_type:e.eta_type,country:e.country,poi_category:e.poi_category,rich_metadata_provider:e.rich_metadata_provider,poi_category_exclusions:e.poi_category_exclusions},e.sessionToken&&{session_token:Ic.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:jo.convert(e.proximity).toArray().join(",")},e.origin&&{origin:typeof e.origin=="string"?e.origin:jo.convert(e.origin).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:$l.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};Ise.defaults={language:"en"};var dZe="https://api.mapbox.com/autofill/v1",hZe="retrieve",fZe=`${dZe}/${hZe}`,GF,Ose,kse=class{constructor(e={}){jl(this,GF);const t=e,{accessToken:r}=t,n=wR(t,["accessToken"]);this.accessToken=r,this.defaults=Bi(Bi({},kse.defaults),n)}validate(e,t){return cl(this,null,function*(){if(!e)throw new Error("searchText is required");const{sessionToken:r,signal:n}=t,a=Kp(Bi(Bi({},this.defaults),t),{sessionToken:r}),l=new URL(`${fZe}/${encodeURIComponent(e)}`);l.search=wx(this,GF,Ose).call(this,a);const{fetch:f}=Ed(),i=yield f(l.toString(),{signal:n});yield Mh(i);const _=yield i.json();return _.url=l.toString(),_.features.length>0&&(_.features=[_.features[0]]),_})}},Rse=kse;GF=new WeakSet;Ose=function(e){return Py({access_token:this.accessToken,language:e.language,country:e.country},e.sessionToken&&{session_token:Ic.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:jo.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:$l.convert(e.bbox).toFlatArray().join(",")})};Rse.defaults={language:"en",proximity:"ip"};var Dse="https://api.mapbox.com/search/geocode/v6",pZe=`${Dse}/forward`,mZe=`${Dse}/reverse`,gZe=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/,yZe=/[\s,]+/,Nw,JM,qF,vZe=class{constructor(e={}){jl(this,JM),jl(this,Nw,void 0);const t=e,{accessToken:r}=t,n=wR(t,["accessToken"]);this.accessToken=r,this.defaults=Bi({},n)}get responseHeaders(){return za(this,Nw)}forward(e,t){return cl(this,null,function*(){if(!e)throw new Error("searchText is required");let r;t&&({signal:r}=t);const n=Kp(Bi(Bi({},this.defaults),t),{q:e}),a=new URL(`${pZe}`);a.search=wx(this,JM,qF).call(this,n);const{fetch:l}=Ed(),f=r?{signal:r}:{},i=yield l(a.toString(),f);pu(this,Nw,i.headers),yield Mh(i);const _=yield i.json();return _.url=a.toString(),_})}reverse(e,t){return cl(this,null,function*(){if(!e)throw new Error("lngLat is required");let r;t&&({signal:r}=t);let n;if(typeof e=="string"){const[E,C]=e.split(",");n=new jo(Number(E),Number(C))}else n=jo.convert(e);const a=Kp(Bi(Bi({},this.defaults),t),{longitude:n.lng,latitude:n.lat}),l=new URL(`${mZe}`);l.search=wx(this,JM,qF).call(this,a,!0);const{fetch:f}=Ed(),i=r?{signal:r}:{},_=yield f(l.toString(),i);pu(this,Nw,_.headers),yield Mh(_);const b=yield _.json();return b.url=l.toString(),b})}suggest(e,t){return cl(this,null,function*(){if(gZe.test(e)){const n=e.trim().split(yZe).map(a=>a.trim()).join(",");return this.reverse(n,t)}else return this.forward(e,t)})}retrieve(e){return cl(this,null,function*(){return e})}};Nw=new WeakMap;JM=new WeakSet;qF=function(e,t=!1){return t&&["proximity","autocomplete","bbox"].forEach(r=>{r in e&&delete e[r]}),Py({q:e.q,longitude:e.longitude,latitude:e.latitude,access_token:this.accessToken,permanent:e.permanent,language:e.language,country:e.country,limit:e.limit,autocomplete:e.autocomplete,worldview:e.worldview},e.sessionToken&&{session_token:Ic.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:jo.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:$l.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};var Lse=(e=>(e.exact="exact",e.high="high",e.medium="medium",e.low="low",e))(Lse||{}),zw,_Ze=class{constructor(){jl(this,zw,{})}addEventListener(e,t){const r=za(this,zw);r[e]||(r[e]=[]),r[e].push(t)}removeEventListener(e,t){const r=za(this,zw);if(!r[e])return;const n=r[e],a=n.indexOf(t);a!==-1&&n.splice(a,1)}fire(e,t){const r=za(this,zw);if(!r[e])return;const n=r[e];for(const a of n)a(t)}};zw=new WeakMap;function Nse(e,t,r){let n=null;return(...a)=>{n!==null&&clearTimeout(n);const l=r&&r();n=setTimeout(()=>{n=null,!(l!=null&&l.aborted)&&e(...a)},t)}}function mN(){const{AbortController:e}=Ed();return new e}var jw,QM,eC,x_,cp,tC,nU=class extends _Ze{constructor(e,t=0){super(),jl(this,jw,new Ic),jl(this,QM,0),jl(this,eC,!1),jl(this,x_,void 0),jl(this,cp,mN()),jl(this,tC,void 0),pu(this,tC,Nse((r,...n)=>cl(this,[r,...n],function*(a,l={}){if(za(this,cp).abort(),pu(this,cp,mN()),!a){pu(this,x_,null),this.fire("suggest",za(this,x_));return}try{const f=yield this.search.suggest(a,Kp(Bi({sessionToken:this.sessionToken},l),{signal:za(this,cp).signal}));pu(this,x_,f),this.fire("suggest",f)}catch(f){if(f.name==="AbortError")return;this.fire("suggesterror",f)}}),t,()=>za(this,cp).signal)),Object.defineProperties(this,{search:{value:e,writable:!1},debounce:{value:t,writable:!1}})}get sessionToken(){return za(this,eC)?za(this,jw).id:`${za(this,jw).id}.${za(this,QM)}`}set sessionToken(e){pu(this,eC,!0),pu(this,jw,new Ic(e))}get suggestions(){return za(this,x_)}suggest(e,t){return za(this,tC).call(this,e,t),new Promise((r,n)=>{let a,l;a=f=>{this.removeEventListener("suggest",a),this.removeEventListener("suggesterror",l),r(f)},l=f=>{this.removeEventListener("suggest",a),this.removeEventListener("suggesterror",l),n(f)},this.addEventListener("suggest",a),this.addEventListener("suggesterror",l)})}clear(){this.suggest("")}retrieve(e,t){return cl(this,null,function*(){const r=yield this.search.retrieve(e,Bi({sessionToken:this.sessionToken},t));return this.fire("retrieve",r),r})}canRetrieve(e){return this.search.canRetrieve?this.search.canRetrieve(e):!0}canSuggest(e){return this.search.canSuggest?this.search.canSuggest(e):!0}abort(){za(this,cp).abort(),pu(this,cp,mN())}incrementSession(){Z9e(this,QM)._++}};jw=new WeakMap;QM=new WeakMap;eC=new WeakMap;x_=new WeakMap;cp=new WeakMap;tC=new WeakMap;function iU(e){const{properties:t}=e;return Bi({},t)}function TR(e){return e.split("-")[0]}function oU(e){return e.split("-")[1]}function aU(e){return["top","bottom"].includes(TR(e))?"x":"y"}function zse(e){return e==="y"?"height":"width"}function eX(e,t,r){let{reference:n,floating:a}=e;const l=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,i=aU(t),_=zse(i),b=n[_]/2-a[_]/2,E=i==="x";let C;switch(TR(t)){case"top":C={x:l,y:n.y-a.height};break;case"bottom":C={x:l,y:n.y+n.height};break;case"right":C={x:n.x+n.width,y:f};break;case"left":C={x:n.x-a.width,y:f};break;default:C={x:n.x,y:n.y}}switch(oU(t)){case"start":C[i]-=b*(r&&E?-1:1);break;case"end":C[i]+=b*(r&&E?-1:1)}return C}const xZe=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:f}=r,i=await(f.isRTL==null?void 0:f.isRTL(t));let _=await f.getElementRects({reference:e,floating:t,strategy:a}),{x:b,y:E}=eX(_,n,i),C=n,R={},F=0;for(let U=0;U<l.length;U++){const{name:$,fn:H}=l[U],{x:q,y:G,data:J,reset:te}=await H({x:b,y:E,initialPlacement:n,placement:C,strategy:a,middlewareData:R,rects:_,platform:f,elements:{reference:e,floating:t}});b=q??b,E=G??E,R={...R,[$]:{...R[$],...J}},te&&F<=50&&(F++,typeof te=="object"&&(te.placement&&(C=te.placement),te.rects&&(_=te.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:a}):te.rects),{x:b,y:E}=eX(_,C,i)),U=-1)}return{x:b,y:E,placement:C,strategy:a,middlewareData:R}};function bZe(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function wO(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function wZe(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:f,elements:i,strategy:_}=e,{boundary:b="clippingAncestors",rootBoundary:E="viewport",elementContext:C="floating",altBoundary:R=!1,padding:F=0}=t,U=bZe(F),$=i[R?C==="floating"?"reference":"floating":C],H=wO(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement($)))==null||r?$:$.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:b,rootBoundary:E,strategy:_})),q=wO(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({rect:C==="floating"?{...f.floating,x:n,y:a}:f.reference,offsetParent:await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),strategy:_}):f[C]);return{top:H.top-q.top+U.top,bottom:q.bottom-H.bottom+U.bottom,left:H.left-q.left+U.left,right:q.right-H.right+U.right}}const SZe={left:"right",right:"left",bottom:"top",top:"bottom"};function SO(e){return e.replace(/left|right|bottom|top/g,t=>SZe[t])}function TZe(e,t,r){r===void 0&&(r=!1);const n=oU(e),a=aU(e),l=zse(a);let f=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(f=SO(f)),{main:f,cross:SO(f)}}const EZe={start:"end",end:"start"};function tX(e){return e.replace(/start|end/g,t=>EZe[t])}const AZe=["top","right","bottom","left"];AZe.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]);const MZe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r;const{placement:n,middlewareData:a,rects:l,initialPlacement:f,platform:i,elements:_}=t,{mainAxis:b=!0,crossAxis:E=!0,fallbackPlacements:C,fallbackStrategy:R="bestFit",flipAlignment:F=!0,...U}=e,$=TR(n),H=C||($===f||!F?[SO(f)]:function(ve){const We=SO(ve);return[tX(ve),We,tX(We)]}(f)),q=[f,...H],G=await wZe(t,U),J=[];let te=((r=a.flip)==null?void 0:r.overflows)||[];if(b&&J.push(G[$]),E){const{main:ve,cross:We}=TZe(n,l,await(i.isRTL==null?void 0:i.isRTL(_.floating)));J.push(G[ve],G[We])}if(te=[...te,{placement:n,overflows:J}],!J.every(ve=>ve<=0)){var oe,he;const ve=((oe=(he=a.flip)==null?void 0:he.index)!=null?oe:0)+1,We=q[ve];if(We)return{data:{index:ve,overflows:te},reset:{placement:We}};let Ie="bottom";switch(R){case"bestFit":{var le;const Re=(le=te.map($e=>[$e,$e.overflows.filter(ot=>ot>0).reduce((ot,Je)=>ot+Je,0)]).sort(($e,ot)=>$e[1]-ot[1])[0])==null?void 0:le[0].placement;Re&&(Ie=Re);break}case"initialPlacement":Ie=f}if(n!==Ie)return{reset:{placement:Ie}}}return{}}}},CZe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:r,y:n}=t,a=await async function(l,f){const{placement:i,platform:_,elements:b}=l,E=await(_.isRTL==null?void 0:_.isRTL(b.floating)),C=TR(i),R=oU(i),F=aU(i)==="x",U=["left","top"].includes(C)?-1:1,$=E&&F?-1:1,H=typeof f=="function"?f(l):f;let{mainAxis:q,crossAxis:G,alignmentAxis:J}=typeof H=="number"?{mainAxis:H,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...H};return R&&typeof J=="number"&&(G=R==="end"?-1*J:J),F?{x:G*$,y:q*U}:{x:q*U,y:G*$}}(t,e);return{x:r+a.x,y:n+a.y,data:a}}}};function jse(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function tf(e){if(e==null)return window;if(!jse(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function FE(e){return tf(e).getComputedStyle(e)}function Dh(e){return jse(e)?"":e?(e.nodeName||"").toLowerCase():""}function Fse(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function jd(e){return e instanceof tf(e).HTMLElement}function hm(e){return e instanceof tf(e).Element}function sU(e){return typeof ShadowRoot>"u"?!1:e instanceof tf(e).ShadowRoot||e instanceof ShadowRoot}function ER(e){const{overflow:t,overflowX:r,overflowY:n}=FE(e);return/auto|scroll|overlay|hidden/.test(t+n+r)}function PZe(e){return["table","td","th"].includes(Dh(e))}function rX(e){const t=/firefox/i.test(Fse()),r=FE(e);return r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].includes(r.willChange)||t&&r.willChange==="filter"||t&&!!r.filter&&r.filter!=="none"}function Bse(){return!/^((?!chrome|android).)*safari/i.test(Fse())}const nX=Math.min,PS=Math.max,TO=Math.round;function Lh(e,t,r){var n,a,l,f;t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect();let _=1,b=1;t&&jd(e)&&(_=e.offsetWidth>0&&TO(i.width)/e.offsetWidth||1,b=e.offsetHeight>0&&TO(i.height)/e.offsetHeight||1);const E=hm(e)?tf(e):window,C=!Bse()&&r,R=(i.left+(C&&(n=(a=E.visualViewport)==null?void 0:a.offsetLeft)!=null?n:0))/_,F=(i.top+(C&&(l=(f=E.visualViewport)==null?void 0:f.offsetTop)!=null?l:0))/b,U=i.width/_,$=i.height/b;return{width:U,height:$,top:F,right:R+U,bottom:F+$,left:R,x:R,y:F}}function Jp(e){return(t=e,(t instanceof tf(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function AR(e){return hm(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function $se(e){return Lh(Jp(e)).left+AR(e).scrollLeft}function IZe(e,t,r){const n=jd(t),a=Jp(t),l=Lh(e,n&&function(_){const b=Lh(_);return TO(b.width)!==_.offsetWidth||TO(b.height)!==_.offsetHeight}(t),r==="fixed");let f={scrollLeft:0,scrollTop:0};const i={x:0,y:0};if(n||!n&&r!=="fixed")if((Dh(t)!=="body"||ER(a))&&(f=AR(t)),jd(t)){const _=Lh(t,!0);i.x=_.x+t.clientLeft,i.y=_.y+t.clientTop}else a&&(i.x=$se(a));return{x:l.left+f.scrollLeft-i.x,y:l.top+f.scrollTop-i.y,width:l.width,height:l.height}}function Use(e){return Dh(e)==="html"?e:e.assignedSlot||e.parentNode||(sU(e)?e.host:null)||Jp(e)}function iX(e){return jd(e)&&getComputedStyle(e).position!=="fixed"?e.offsetParent:null}function HF(e){const t=tf(e);let r=iX(e);for(;r&&PZe(r)&&getComputedStyle(r).position==="static";)r=iX(r);return r&&(Dh(r)==="html"||Dh(r)==="body"&&getComputedStyle(r).position==="static"&&!rX(r))?t:r||function(n){let a=Use(n);for(sU(a)&&(a=a.host);jd(a)&&!["html","body"].includes(Dh(a));){if(rX(a))return a;a=a.parentNode}return null}(e)||t}function oX(e){if(jd(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=Lh(e);return{width:t.width,height:t.height}}function Vse(e){const t=Use(e);return["html","body","#document"].includes(Dh(t))?e.ownerDocument.body:jd(t)&&ER(t)?t:Vse(t)}function EO(e,t){var r;t===void 0&&(t=[]);const n=Vse(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),l=tf(n),f=a?[l].concat(l.visualViewport||[],ER(n)?n:[]):n,i=t.concat(f);return a?i:i.concat(EO(f))}function aX(e,t,r){return t==="viewport"?wO(function(n,a){const l=tf(n),f=Jp(n),i=l.visualViewport;let _=f.clientWidth,b=f.clientHeight,E=0,C=0;if(i){_=i.width,b=i.height;const R=Bse();(R||!R&&a==="fixed")&&(E=i.offsetLeft,C=i.offsetTop)}return{width:_,height:b,x:E,y:C}}(e,r)):hm(t)?function(n,a){const l=Lh(n,!1,a==="fixed"),f=l.top+n.clientTop,i=l.left+n.clientLeft;return{top:f,left:i,x:i,y:f,right:i+n.clientWidth,bottom:f+n.clientHeight,width:n.clientWidth,height:n.clientHeight}}(t,r):wO(function(n){var a;const l=Jp(n),f=AR(n),i=(a=n.ownerDocument)==null?void 0:a.body,_=PS(l.scrollWidth,l.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),b=PS(l.scrollHeight,l.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0);let E=-f.scrollLeft+$se(n);const C=-f.scrollTop;return FE(i||l).direction==="rtl"&&(E+=PS(l.clientWidth,i?i.clientWidth:0)-_),{width:_,height:b,x:E,y:C}}(Jp(e)))}function OZe(e){const t=EO(e),r=["absolute","fixed"].includes(FE(e).position)&&jd(e)?HF(e):e;return hm(r)?t.filter(n=>hm(n)&&function(a,l){const f=l.getRootNode==null?void 0:l.getRootNode();if(a.contains(l))return!0;if(f&&sU(f)){let i=l;do{if(i&&a===i)return!0;i=i.parentNode||i.host}while(i)}return!1}(n,r)&&Dh(n)!=="body"):[]}const kZe={getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const l=[...r==="clippingAncestors"?OZe(t):[].concat(r),n],f=l[0],i=l.reduce((_,b)=>{const E=aX(t,b,a);return _.top=PS(E.top,_.top),_.right=nX(E.right,_.right),_.bottom=nX(E.bottom,_.bottom),_.left=PS(E.left,_.left),_},aX(t,f,a));return{width:i.right-i.left,height:i.bottom-i.top,x:i.left,y:i.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:n}=e;const a=jd(r),l=Jp(r);if(r===l)return t;let f={scrollLeft:0,scrollTop:0};const i={x:0,y:0};if((a||!a&&n!=="fixed")&&((Dh(r)!=="body"||ER(l))&&(f=AR(r)),jd(r))){const _=Lh(r,!0);i.x=_.x+r.clientLeft,i.y=_.y+r.clientTop}return{...t,x:t.x-f.scrollLeft+i.x,y:t.y-f.scrollTop+i.y}},isElement:hm,getDimensions:oX,getOffsetParent:HF,getDocumentElement:Jp,getElementRects:e=>{let{reference:t,floating:r,strategy:n}=e;return{reference:IZe(t,HF(r),n),floating:{...oX(r),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>FE(e).direction==="rtl"};function RZe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:f=!0,animationFrame:i=!1}=n,_=a&&!i,b=l&&!i,E=_||b?[...hm(e)?EO(e):[],...EO(t)]:[];E.forEach(U=>{_&&U.addEventListener("scroll",r,{passive:!0}),b&&U.addEventListener("resize",r)});let C,R=null;if(f){let U=!0;R=new ResizeObserver(()=>{U||r(),U=!1}),hm(e)&&!i&&R.observe(e),R.observe(t)}let F=i?Lh(e):null;return i&&function U(){const $=Lh(e);!F||$.x===F.x&&$.y===F.y&&$.width===F.width&&$.height===F.height||r(),F=$,C=requestAnimationFrame(U)}(),r(),()=>{var U;E.forEach($=>{_&&$.removeEventListener("scroll",r),b&&$.removeEventListener("resize",r)}),(U=R)==null||U.disconnect(),R=null,i&&cancelAnimationFrame(C)}}const DZe=(e,t,r)=>xZe(e,t,{platform:kZe,...r});var Wse={exports:{}};(function(e){(function(t){var r=!1,n,a;function l(){if(typeof n<"u")return n;var C=document.documentElement,R=document.createElement("div");return R.setAttribute("style","width:99px;height:99px;position:absolute;top:-9999px;overflow:scroll;"),C.appendChild(R),n=R.offsetWidth-R.clientWidth,C.removeChild(R),n}function f(){return document.documentElement.scrollHeight>window.innerHeight}function i(C){if(!(typeof document>"u"||r)){var R=document.documentElement;a=window.pageYOffset,f()?R.style.width="calc(100% - "+l()+"px)":R.style.width="100%",R.style.position="fixed",R.style.top=-a+"px",R.style.overflow="hidden",r=!0}}function _(){if(!(typeof document>"u"||!r)){var C=document.documentElement;C.style.width="",C.style.position="",C.style.top="",C.style.overflow="",window.scroll(0,a),r=!1}}function b(){if(r){_();return}i()}var E={on:i,off:_,toggle:b};e.exports=E})()})(Wse);var LZe=Wse.exports;const sX=hi(LZe);/*!
* tabbable 5.3.3
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var Gse=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],AO=Gse.join(","),qse=typeof Element>"u",Iy=qse?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,ZF=!qse&&Element.prototype.getRootNode?function(e){return e.getRootNode()}:function(e){return e.ownerDocument},Hse=function(t,r,n){var a=Array.prototype.slice.apply(t.querySelectorAll(AO));return r&&Iy.call(t,AO)&&a.unshift(t),a=a.filter(n),a},Zse=function e(t,r,n){for(var a=[],l=Array.from(t);l.length;){var f=l.shift();if(f.tagName==="SLOT"){var i=f.assignedElements(),_=i.length?i:f.children,b=e(_,!0,n);n.flatten?a.push.apply(a,b):a.push({scope:f,candidates:b})}else{var E=Iy.call(f,AO);E&&n.filter(f)&&(r||!t.includes(f))&&a.push(f);var C=f.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(f),R=!n.shadowRootFilter||n.shadowRootFilter(f);if(C&&R){var F=e(C===!0?f.children:C.children,!0,n);n.flatten?a.push.apply(a,F):a.push({scope:f,candidates:F})}else l.unshift.apply(l,f.children)}}return a},Xse=function(t,r){return t.tabIndex<0&&(r||/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||t.isContentEditable)&&isNaN(parseInt(t.getAttribute("tabindex"),10))?0:t.tabIndex},NZe=function(t,r){return t.tabIndex===r.tabIndex?t.documentOrder-r.documentOrder:t.tabIndex-r.tabIndex},Yse=function(t){return t.tagName==="INPUT"},zZe=function(t){return Yse(t)&&t.type==="hidden"},jZe=function(t){var r=t.tagName==="DETAILS"&&Array.prototype.slice.apply(t.children).some(function(n){return n.tagName==="SUMMARY"});return r},FZe=function(t,r){for(var n=0;n<t.length;n++)if(t[n].checked&&t[n].form===r)return t[n]},BZe=function(t){if(!t.name)return!0;var r=t.form||ZF(t),n=function(i){return r.querySelectorAll('input[type="radio"][name="'+i+'"]')},a;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")a=n(window.CSS.escape(t.name));else try{a=n(t.name)}catch(f){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",f.message),!1}var l=FZe(a,t.form);return!l||l===t},$Ze=function(t){return Yse(t)&&t.type==="radio"},UZe=function(t){return $Ze(t)&&!BZe(t)},lX=function(t){var r=t.getBoundingClientRect(),n=r.width,a=r.height;return n===0&&a===0},VZe=function(t,r){var n=r.displayCheck,a=r.getShadowRoot;if(getComputedStyle(t).visibility==="hidden")return!0;var l=Iy.call(t,"details>summary:first-of-type"),f=l?t.parentElement:t;if(Iy.call(f,"details:not([open]) *"))return!0;var i=ZF(t).host,_=(i==null?void 0:i.ownerDocument.contains(i))||t.ownerDocument.contains(t);if(!n||n==="full"){if(typeof a=="function"){for(var b=t;t;){var E=t.parentElement,C=ZF(t);if(E&&!E.shadowRoot&&a(E)===!0)return lX(t);t.assignedSlot?t=t.assignedSlot:!E&&C!==t.ownerDocument?t=C.host:t=E}t=b}if(_)return!t.getClientRects().length}else if(n==="non-zero-area")return lX(t);return!1},WZe=function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var r=t.parentElement;r;){if(r.tagName==="FIELDSET"&&r.disabled){for(var n=0;n<r.children.length;n++){var a=r.children.item(n);if(a.tagName==="LEGEND")return Iy.call(r,"fieldset[disabled] *")?!0:!a.contains(t)}return!0}r=r.parentElement}return!1},MO=function(t,r){return!(r.disabled||zZe(r)||VZe(r,t)||jZe(r)||WZe(r))},XF=function(t,r){return!(UZe(r)||Xse(r)<0||!MO(t,r))},GZe=function(t){var r=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(r)||r>=0)},qZe=function e(t){var r=[],n=[];return t.forEach(function(a,l){var f=!!a.scope,i=f?a.scope:a,_=Xse(i,f),b=f?e(a.candidates):i;_===0?f?r.push.apply(r,b):r.push(i):n.push({documentOrder:l,tabIndex:_,item:a,isScope:f,content:b})}),n.sort(NZe).reduce(function(a,l){return l.isScope?a.push.apply(a,l.content):a.push(l.content),a},[]).concat(r)},HZe=function(t,r){r=r||{};var n;return r.getShadowRoot?n=Zse([t],r.includeContainer,{filter:XF.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:GZe}):n=Hse(t,r.includeContainer,XF.bind(null,r)),qZe(n)},ZZe=function(t,r){r=r||{};var n;return r.getShadowRoot?n=Zse([t],r.includeContainer,{filter:MO.bind(null,r),flatten:!0,getShadowRoot:r.getShadowRoot}):n=Hse(t,r.includeContainer,MO.bind(null,r)),n},EM=function(t,r){if(r=r||{},!t)throw new Error("No node provided");return Iy.call(t,AO)===!1?!1:XF(r,t)},XZe=Gse.concat("iframe").join(","),gN=function(t,r){if(r=r||{},!t)throw new Error("No node provided");return Iy.call(t,XZe)===!1?!1:MO(r,t)};/*!
* focus-trap 6.9.4
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function cX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cX(Object(r),!0).forEach(function(n){YZe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YZe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dX=function(){var e=[];return{activateTrap:function(r){if(e.length>0){var n=e[e.length-1];n!==r&&n.pause()}var a=e.indexOf(r);a===-1||e.splice(a,1),e.push(r)},deactivateTrap:function(r){var n=e.indexOf(r);n!==-1&&e.splice(n,1),e.length>0&&e[e.length-1].unpause()}}}(),KZe=function(t){return t.tagName&&t.tagName.toLowerCase()==="input"&&typeof t.select=="function"},JZe=function(t){return t.key==="Escape"||t.key==="Esc"||t.keyCode===27},QZe=function(t){return t.key==="Tab"||t.keyCode===9},hX=function(t){return setTimeout(t,0)},fX=function(t,r){var n=-1;return t.every(function(a,l){return r(a)?(n=l,!1):!0}),n},Tw=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return typeof t=="function"?t.apply(void 0,n):t},AM=function(t){return t.target.shadowRoot&&typeof t.composedPath=="function"?t.composedPath()[0]:t.target},eXe=function(t,r){var n=(r==null?void 0:r.document)||document,a=uX({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},r),l={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},f,i=function(he,le,ve){return he&&he[le]!==void 0?he[le]:a[ve||le]},_=function(he){return l.containerGroups.findIndex(function(le){var ve=le.container,We=le.tabbableNodes;return ve.contains(he)||We.find(function(Ie){return Ie===he})})},b=function(he){var le=a[he];if(typeof le=="function"){for(var ve=arguments.length,We=new Array(ve>1?ve-1:0),Ie=1;Ie<ve;Ie++)We[Ie-1]=arguments[Ie];le=le.apply(void 0,We)}if(le===!0&&(le=void 0),!le){if(le===void 0||le===!1)return le;throw new Error("`".concat(he,"` was specified but was not a node, or did not return a node"))}var Re=le;if(typeof le=="string"&&(Re=n.querySelector(le),!Re))throw new Error("`".concat(he,"` as selector refers to no known node"));return Re},E=function(){var he=b("initialFocus");if(he===!1)return!1;if(he===void 0)if(_(n.activeElement)>=0)he=n.activeElement;else{var le=l.tabbableGroups[0],ve=le&&le.firstTabbableNode;he=ve||b("fallbackFocus")}if(!he)throw new Error("Your focus-trap needs to have at least one focusable element");return he},C=function(){if(l.containerGroups=l.containers.map(function(he){var le=HZe(he,a.tabbableOptions),ve=ZZe(he,a.tabbableOptions);return{container:he,tabbableNodes:le,focusableNodes:ve,firstTabbableNode:le.length>0?le[0]:null,lastTabbableNode:le.length>0?le[le.length-1]:null,nextTabbableNode:function(Ie){var Re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,$e=ve.findIndex(function(ot){return ot===Ie});if(!($e<0))return Re?ve.slice($e+1).find(function(ot){return EM(ot,a.tabbableOptions)}):ve.slice(0,$e).reverse().find(function(ot){return EM(ot,a.tabbableOptions)})}}}),l.tabbableGroups=l.containerGroups.filter(function(he){return he.tabbableNodes.length>0}),l.tabbableGroups.length<=0&&!b("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},R=function oe(he){if(he!==!1&&he!==n.activeElement){if(!he||!he.focus){oe(E());return}he.focus({preventScroll:!!a.preventScroll}),l.mostRecentlyFocusedNode=he,KZe(he)&&he.select()}},F=function(he){var le=b("setReturnFocus",he);return le||(le===!1?!1:he)},U=function(he){var le=AM(he);if(!(_(le)>=0)){if(Tw(a.clickOutsideDeactivates,he)){f.deactivate({returnFocus:a.returnFocusOnDeactivate&&!gN(le,a.tabbableOptions)});return}Tw(a.allowOutsideClick,he)||he.preventDefault()}},$=function(he){var le=AM(he),ve=_(le)>=0;ve||le instanceof Document?ve&&(l.mostRecentlyFocusedNode=le):(he.stopImmediatePropagation(),R(l.mostRecentlyFocusedNode||E()))},H=function(he){var le=AM(he);C();var ve=null;if(l.tabbableGroups.length>0){var We=_(le),Ie=We>=0?l.containerGroups[We]:void 0;if(We<0)he.shiftKey?ve=l.tabbableGroups[l.tabbableGroups.length-1].lastTabbableNode:ve=l.tabbableGroups[0].firstTabbableNode;else if(he.shiftKey){var Re=fX(l.tabbableGroups,function(at){var Be=at.firstTabbableNode;return le===Be});if(Re<0&&(Ie.container===le||gN(le,a.tabbableOptions)&&!EM(le,a.tabbableOptions)&&!Ie.nextTabbableNode(le,!1))&&(Re=We),Re>=0){var $e=Re===0?l.tabbableGroups.length-1:Re-1,ot=l.tabbableGroups[$e];ve=ot.lastTabbableNode}}else{var Je=fX(l.tabbableGroups,function(at){var Be=at.lastTabbableNode;return le===Be});if(Je<0&&(Ie.container===le||gN(le,a.tabbableOptions)&&!EM(le,a.tabbableOptions)&&!Ie.nextTabbableNode(le))&&(Je=We),Je>=0){var rt=Je===l.tabbableGroups.length-1?0:Je+1,st=l.tabbableGroups[rt];ve=st.firstTabbableNode}}}else ve=b("fallbackFocus");ve&&(he.preventDefault(),R(ve))},q=function(he){if(JZe(he)&&Tw(a.escapeDeactivates,he)!==!1){he.preventDefault(),f.deactivate();return}if(QZe(he)){H(he);return}},G=function(he){var le=AM(he);_(le)>=0||Tw(a.clickOutsideDeactivates,he)||Tw(a.allowOutsideClick,he)||(he.preventDefault(),he.stopImmediatePropagation())},J=function(){if(l.active)return dX.activateTrap(f),l.delayInitialFocusTimer=a.delayInitialFocus?hX(function(){R(E())}):R(E()),n.addEventListener("focusin",$,!0),n.addEventListener("mousedown",U,{capture:!0,passive:!1}),n.addEventListener("touchstart",U,{capture:!0,passive:!1}),n.addEventListener("click",G,{capture:!0,passive:!1}),n.addEventListener("keydown",q,{capture:!0,passive:!1}),f},te=function(){if(l.active)return n.removeEventListener("focusin",$,!0),n.removeEventListener("mousedown",U,!0),n.removeEventListener("touchstart",U,!0),n.removeEventListener("click",G,!0),n.removeEventListener("keydown",q,!0),f};return f={get active(){return l.active},get paused(){return l.paused},activate:function(he){if(l.active)return this;var le=i(he,"onActivate"),ve=i(he,"onPostActivate"),We=i(he,"checkCanFocusTrap");We||C(),l.active=!0,l.paused=!1,l.nodeFocusedBeforeActivation=n.activeElement,le&&le();var Ie=function(){We&&C(),J(),ve&&ve()};return We?(We(l.containers.concat()).then(Ie,Ie),this):(Ie(),this)},deactivate:function(he){if(!l.active)return this;var le=uX({onDeactivate:a.onDeactivate,onPostDeactivate:a.onPostDeactivate,checkCanReturnFocus:a.checkCanReturnFocus},he);clearTimeout(l.delayInitialFocusTimer),l.delayInitialFocusTimer=void 0,te(),l.active=!1,l.paused=!1,dX.deactivateTrap(f);var ve=i(le,"onDeactivate"),We=i(le,"onPostDeactivate"),Ie=i(le,"checkCanReturnFocus"),Re=i(le,"returnFocus","returnFocusOnDeactivate");ve&&ve();var $e=function(){hX(function(){Re&&R(F(l.nodeFocusedBeforeActivation)),We&&We()})};return Re&&Ie?(Ie(F(l.nodeFocusedBeforeActivation)).then($e,$e),this):($e(),this)},pause:function(){return l.paused||!l.active?this:(l.paused=!0,te(),this)},unpause:function(){return!l.paused||!l.active?this:(l.paused=!1,C(),J(),this)},updateContainerElements:function(he){var le=[].concat(he).filter(Boolean);return l.containers=le.map(function(ve){return typeof ve=="string"?n.querySelector(ve):ve}),l.active&&C(),this}},f.updateContainerElements(t),f},Kse={exports:{}};(function(e){(function(t,r,n){e.exports?e.exports=n():t[r]=n()})(Aa,"subtag",function(){var t="",r=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function n(_){return _.match(r)||[]}function a(_){return n(_).filter(function(b,E){return b&&E})}function l(_){return _=n(_),{language:_[1]||t,extlang:_[2]||t,script:_[3]||t,region:_[4]||t}}function f(_,b,E){Object.defineProperty(_,b,{value:E,enumerable:!0})}function i(_,b,E){function C(R){return n(R)[_]||t}f(C,"pattern",b),f(l,E,C)}return i(1,/^[a-zA-Z]{2,3}$/,"language"),i(2,/^[a-zA-Z]{3}$/,"extlang"),i(3,/^[a-zA-Z]{4}$/,"script"),i(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),f(l,"split",a),l})})(Kse);var tXe=Kse.exports;const Jse=hi(tXe);var Qse={exports:{}};(function(e,t){var r=function(){var n={},a=Math.PI/180,l=180/Math.PI,f=6378137,i=20037508342789244e-9;function _(E){return Number(E)===E&&E%1!==0}function b(E){if(E=E||{},this.size=E.size||256,this.expansion=E.antimeridian===!0?2:1,!n[this.size]){var C=this.size,R=n[this.size]={};R.Bc=[],R.Cc=[],R.zc=[],R.Ac=[];for(var F=0;F<30;F++)R.Bc.push(C/360),R.Cc.push(C/(2*Math.PI)),R.zc.push(C/2),R.Ac.push(C),C*=2}this.Bc=n[this.size].Bc,this.Cc=n[this.size].Cc,this.zc=n[this.size].zc,this.Ac=n[this.size].Ac}return b.prototype.px=function(E,C){if(_(C)){var R=this.size*Math.pow(2,C),F=R/2,U=R/360,$=R/(2*Math.PI),H=R,q=Math.min(Math.max(Math.sin(a*E[1]),-.9999),.9999),G=F+E[0]*U,J=F+.5*Math.log((1+q)/(1-q))*-$;return G>H*this.expansion&&(G=H*this.expansion),J>H&&(J=H),[G,J]}else{var F=this.zc[C],q=Math.min(Math.max(Math.sin(a*E[1]),-.9999),.9999),G=Math.round(F+E[0]*this.Bc[C]),J=Math.round(F+.5*Math.log((1+q)/(1-q))*-this.Cc[C]);return G>this.Ac[C]*this.expansion&&(G=this.Ac[C]*this.expansion),J>this.Ac[C]&&(J=this.Ac[C]),[G,J]}},b.prototype.ll=function(E,C){if(_(C)){var R=this.size*Math.pow(2,C),F=R/360,U=R/(2*Math.PI),$=R/2,H=(E[1]-$)/-U,q=(E[0]-$)/F,G=l*(2*Math.atan(Math.exp(H))-.5*Math.PI);return[q,G]}else{var H=(E[1]-this.zc[C])/-this.Cc[C],q=(E[0]-this.zc[C])/this.Bc[C],G=l*(2*Math.atan(Math.exp(H))-.5*Math.PI);return[q,G]}},b.prototype.bbox=function(E,C,R,F,U){F&&(C=Math.pow(2,R)-1-C);var $=[E*this.size,(+C+1)*this.size],H=[(+E+1)*this.size,C*this.size],q=this.ll($,R).concat(this.ll(H,R));return U==="900913"?this.convert(q,"900913"):q},b.prototype.xyz=function(E,C,R,F){F==="900913"&&(E=this.convert(E,"WGS84"));var U=[E[0],E[1]],$=[E[2],E[3]],H=this.px(U,C),q=this.px($,C),G=[Math.floor(H[0]/this.size),Math.floor((q[0]-1)/this.size)],J=[Math.floor(q[1]/this.size),Math.floor((H[1]-1)/this.size)],te={minX:Math.min.apply(Math,G)<0?0:Math.min.apply(Math,G),minY:Math.min.apply(Math,J)<0?0:Math.min.apply(Math,J),maxX:Math.max.apply(Math,G),maxY:Math.max.apply(Math,J)};if(R){var oe={minY:Math.pow(2,C)-1-te.maxY,maxY:Math.pow(2,C)-1-te.minY};te.minY=oe.minY,te.maxY=oe.maxY}return te},b.prototype.convert=function(E,C){return C==="900913"?this.forward(E.slice(0,2)).concat(this.forward(E.slice(2,4))):this.inverse(E.slice(0,2)).concat(this.inverse(E.slice(2,4)))},b.prototype.forward=function(E){var C=[f*E[0]*a,f*Math.log(Math.tan(Math.PI*.25+.5*E[1]*a))];return C[0]>i&&(C[0]=i),C[0]<-i&&(C[0]=-i),C[1]>i&&(C[1]=i),C[1]<-i&&(C[1]=-i),C},b.prototype.inverse=function(E){return[E[0]*l/f,(Math.PI*.5-2*Math.atan(Math.exp(-E[1]/f)))*l]},b}();e.exports=r})(Qse);var rXe=Qse.exports;const nXe=hi(rXe);var iXe=Object.defineProperty,oXe=Object.defineProperties,aXe=Object.getOwnPropertyDescriptors,pX=Object.getOwnPropertySymbols,sXe=Object.prototype.hasOwnProperty,lXe=Object.prototype.propertyIsEnumerable,mX=(e,t,r)=>t in e?iXe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Hn=(e,t)=>{for(var r in t||(t={}))sXe.call(t,r)&&mX(e,r,t[r]);if(pX)for(var r of pX(t))lXe.call(t,r)&&mX(e,r,t[r]);return e},Gl=(e,t)=>oXe(e,aXe(t)),lU=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},ue=(e,t,r)=>(lU(e,t,"read from private field"),r?r.call(e):t.get(e)),Pt=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},xr=(e,t,r,n)=>(lU(e,t,"write to private field"),t.set(e,r),r),IS=(e,t,r)=>(lU(e,t,"access private method"),r),Sx=(e,t,r)=>new Promise((n,a)=>{var l=_=>{try{i(r.next(_))}catch(b){a(b)}},f=_=>{try{i(r.throw(_))}catch(b){a(b)}},i=_=>_.done?n(_.value):Promise.resolve(_.value).then(l,f);i((r=r.apply(e,t)).next())}),gX=document.implementation.createHTMLDocument();function Uy(e,t){const r={};for(const[n,a]of Object.entries(t))r[n]=e.querySelector(a);return r}function cXe(e){return Array.from(e.childNodes||[]).filter(t=>t.nodeType===Node.ELEMENT_NODE)}function Xl(e){const t=document.createElement("template");return t.innerHTML=e,t.content.firstElementChild}function uXe(e){const t=gX.createElement("style");return t.textContent=e,gX.head.appendChild(t),t.sheet}function dXe(e){return window.getComputedStyle(e).display!=="none"}function id(e,t){if(!e)return;Object.getOwnPropertyDescriptor(e.constructor.prototype,"value").set.call(e,t);const n=e;n._valueTracker&&n._valueTracker.setValue("");const a=new Event("input",{bubbles:!0});a.simulated=!0,e.dispatchEvent(a);const l=new Event("change",{bubbles:!0});l.simulated=!0,e.dispatchEvent(l)}function ele(e,t=!1){let r,n;const a=e.getBoundingClientRect();if(e.style.display==="none"||a.height===0&&a.width===0){const l=e.cloneNode(t);e.parentElement.appendChild(l),l.style.setProperty("display","block","important");const f=l.getBoundingClientRect();r=f.width,n=f.height,l.style.setProperty("display","none"),l.remove()}else r=a.width,n=a.height;return{height:Math.floor(n),width:Math.floor(r)}}function hXe(e){const t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)}var fXe=new RegExp("[_a-zA-Z]+[_a-zA-Z0-9-]*","g"),pXe=new RegExp(`\\.${fXe.source}`,"g"),mXe=new RegExp("^\\s*(@(?:media|supports)[^{]*){(.*)}\\s*$");function rC(e,t){return e.replace(pXe,r=>"."+t(r.slice(1)))}function tle(e,t){const n=uXe(e).cssRules;function a(f){if(f instanceof CSSStyleRule)return`${rC(f.selectorText,t)} { ${f.style.cssText} }`;const i=mXe.exec(f.cssText.split(`
`).join(""));if(i&&i.length>2){const _=i[1],b=i[2];return`${_} { ${tle(b,t)} }`}return f.cssText}let l="";for(const f of Array.from(n))l+=a(f)+`

`;return l.trim()}function yX(e,t){const r=Array.from(e.querySelectorAll("[class]"));r.push(e);for(const n of r){const{classList:a}=n;for(const l of Array.from(a))a.remove(l),a.add(t(l))}return e}var cU=1.4;function rle(e,t,r=.5){const{center:n,zoom:a}=e.cameraForBounds(t),l=Math.max(a-r,0);return{center:n,zoom:l,speed:cU}}function nle(e){switch(e){case"street":return 15;case"neighborhood":case"postcode":case"locality":case"oaza":return 14;case"place":case"city":return 13;case"district":return 9;case"region":case"prefecture":return 6;case"country":return 4;default:return 16}}function ile(e,t){return`https://api.mapbox.com/styles/v1/${e}/${t}/static/`}var uU='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.8 3.8a1 1 0 0 1 1.4 0L9 7.58l3.8-3.8a1 1 0 1 1 1.4 1.42L10.42 9l3.8 3.8a1 1 0 0 1-1.42 1.4L9 10.42l-3.8 3.8a1 1 0 0 1-1.4-1.42L7.58 9l-3.8-3.8a1 1 0 0 1 0-1.4Z" fill="currentColor"/></svg>',ole='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/></svg>',gXe=ile("mapbox","satellite-streets-v11"),yXe="20d01",vXe=["mapbox.com","mapbox.cn","tilestream.net"],_Xe=Xl(`
<template>
  <div class="MapboxSearch">
    <div class="Label" role="label" aria-live="polite" aria-atomic="true">
    </div>
    <div class="Results" aria-hidden="true">
      <div class="ResultsList" role="listbox">
      </div>
      <div class="ResultsAttribution" aria-hidden="true">
        <a href="https://www.mapbox.com/search-service" target="_blank" tabindex="-1">
          Powered by Mapbox
        </a>
      </div>
    </div>
  </div>
</template>
`),xXe=Xl(`
<template>
  <div class="Suggestion" role="option" tabindex="-1">
    <div class="SuggestionIcon" aria-hidden="true"></div>
    <div class="SuggestionText">
      <div class="SuggestionName"></div>
      <div class="SuggestionDesc"></div>
    </div>
  </div>
</template>
`),bXe=Xl(`
<template>
  <div class="SearchBox">
    <div class="SearchIcon"></div>
    <input class="Input" type="text" />
    <div class="ActionIcon">
      <button aria-label="Clear" class="ClearBtn" type="button">${uU}</button>
      <div class="LoadingIcon">${ole}</div>
    </div>
  </div>
</template>
`),wXe=Xl(`
<template>
  <div class="Geocoder">
    <div class="SearchIcon"></div>
    <input class="Input" type="text" />
    <div class="ActionIcon">
      <button aria-label="Clear" class="ClearBtn" type="button">${uU}</button>
      <div class="LoadingIcon">${ole}</div>
    </div>
  </div>
</template>
`);function uy(){return"mbx"+new Ic().id.slice(0,8)}function Tx(e){try{return JSON.parse(e)}catch{return null}}function dU(e,t){if(e==null||t==null||typeof e!="object"||typeof t!="object")return e===t;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r)if(!dU(e[a],t[a]))return!1;return!0}function vX(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}function SXe(e){return!!e.match(/localhost|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|::1|\.local|^$/gi)}function TXe(e){return!!vXe.some(t=>e.includes(t))}var Fw,b_,w_,Mm=class extends HTMLElement{constructor(){super(...arguments),Pt(this,Fw,uy()),Pt(this,b_,void 0),Pt(this,w_,e=>`${ue(this,Fw)}--${e}`)}get template(){return null}get templateStyle(){return null}get templateUserStyle(){return null}clonedCallback(e,t){const r=l=>l.replace(e,t);yX(this,r);const n=Array.from(this.querySelectorAll("style"));for(const l of n)l.textContent=rC(l.textContent,r);n.length&&xr(this,b_,n[n.length-1]);const a=Array.from(this.querySelectorAll(`[id^="${e}"]`));for(const l of a)l.id=l.id.replace(e,t)}connectedCallback(){if(this.childElementCount>0){const n=this.dataset.seed,a=ue(this,Fw);n&&n!==a&&(this.clonedCallback(n,a),this.dataset.seed=a);return}this.dataset.seed=ue(this,Fw);const e=this.template;if(e){const n=this.prepareTemplate(e);this.appendChild(n)}const t=this.templateStyle;if(t){const n=document.createElement("style");n.textContent=this.prepareCSS(t),this.appendChild(n)}const r=document.createElement("style");this.templateUserStyle&&(r.textContent=this.prepareCSS(this.templateUserStyle)),this.appendChild(r),xr(this,b_,r)}prepareTemplate(e){const t=e.content.firstElementChild;return yX(t.cloneNode(!0),ue(this,w_))}prepareCSS(e){return tle(e,ue(this,w_))}updateTemplateUserStyle(e){ue(this,b_)&&(ue(this,b_).textContent=this.prepareCSS(e))}querySelector(e){return super.querySelector(rC(e,ue(this,w_)))}querySelectorAll(e){return super.querySelectorAll(rC(e,ue(this,w_)))}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}dispatchEvent(e){return super.dispatchEvent(e)}};Fw=new WeakMap;b_=new WeakMap;w_=new WeakMap;var EXe='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9 16A7 7 0 1 0 9 2a7 7 0 0 0 0 14ZM6.88 4.88a2.58 2.58 0 0 1 1.83-.75h1.08a2.58 2.58 0 0 1 2.59 2.58v.16c0 1-.53 1.94-1.4 2.46l-.56.34c-.27.16-.45.42-.52.71-.03.14-.14.25-.28.25H8.38a.23.23 0 0 1-.24-.25c.08-.91.59-1.74 1.38-2.21l.56-.34c.34-.2.54-.57.54-.96V6.7a.83.83 0 0 0-.83-.83H8.71a.83.83 0 0 0-.84.83v.18a.87.87 0 1 1-1.75 0V6.7c0-.69.28-1.34.76-1.83ZM10 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" fill="currentColor"/></svg>',AXe='<svg width="48" height="56" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#a)"><path d="m24 50.4 13.79-14.12a18.82 18.82 0 0 0 4.23-20.86 19.23 19.23 0 0 0-7.19-8.6 19.76 19.76 0 0 0-21.66 0c-3.21 2.11-5.71 5.1-7.19 8.6a18.82 18.82 0 0 0 4.23 20.86L24 50.4Z" fill="currentColor"/><path d="M37.26 35.75 24 49.34 10.75 35.76l-.01-.01A18.07 18.07 0 0 1 6.68 15.7a18.48 18.48 0 0 1 6.9-8.26 19 19 0 0 1 20.84 0 18.48 18.48 0 0 1 6.9 8.26 18.07 18.07 0 0 1-4.06 20.04Z" stroke="#fff" stroke-width="1.5"/></g><circle cx="24" cy="22.45" fill="#fff" r="5.85"/><defs><filter id="a" x=".5" y=".6" width="47" height="54.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1"/><feGaussianBlur stdDeviation="2"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_17_871"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_17_871" result="shape"/></filter></defs></svg>',MXe=`<svg width="24" height="24" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.08 14.94 5.625 3.06h1.17l-3.42 11.88H1.08Zm15.885 0L12.42 3.06h-1.17l3.42 11.88h2.295Zm-6.86-1.44H7.946l.128-2.61h1.912l.119 2.61Zm-.217-4.77H8.181l.088-1.8h1.537l.082 1.8ZM9.74 5.49h-1.4l.049-.99h1.306l.045.99Z" fill="currentColor" />
</svg>`,CXe=`<!-- TODO: I'm not sure if the way I added the circle will "scale" properly, need to check that -->
<svg width="24" height="24" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
  <path fill="none" stroke="currentColor" stroke-width="1.5" d="M4 7a5 5 0 1 1 10 0c0 3.025-3.28 6.713-5 9-1.72-2.287-5-5.975-5-9z"></path>
    <circle cx="9" cy="7" r="2" fill="currentColor"></circle>
</svg>`,PXe=`<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
  <path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>
</svg>`,IXe="@mapbox/search-js-web",MR="1.0.0",OXe=`https://api.mapbox.com/search-js/v${MR}/img/style-toggle-satellite.jpg`,kXe=`https://api.mapbox.com/search-js/v${MR}/img/style-toggle-default.jpg`,RXe=767,DXe=`@media only screen and (max-width: ${RXe}px)`,hU={variables:{unit:["mobile","16px","14px"],unitHeader:["mobile","24px","18px"],minWidth:"min(300px, 100vw)",spacing:"0.75em",padding:"0.5em 0.75em",paddingFooterLabel:"0.5em 0.75em",paddingModal:"1.25em",colorText:"rgba(0, 0, 0, 0.75)",colorPrimary:"#4264FB",colorSecondary:"#667F91",colorBackground:"#fff",colorBackgroundHover:"#f5f5f5",colorBackgroundActive:"#f0f0f0",colorBackdrop:"rgba(102, 127, 145, 0.3)",border:"none",borderRadius:"4px",boxShadow:`
      0 0 10px 2px rgba(0, 0, 0, 0.05),
      0 0 6px 1px rgba(0, 0, 0, 0.1),
      0 0 0 1px rgba(0, 0, 0, 0.1)
    `,lineHeight:"1.2em",fontFamily:`
      -apple-system, BlinkMacSystemFont,
      avenir next, avenir,
      segoe ui,
      helvetica neue, helvetica,
      Ubuntu, roboto, noto, arial, sans-serif
    `,fontWeight:"normal",fontWeightSemibold:"600",fontWeightBold:"bold",duration:"150ms",curve:"ease-out"},icons:{close:uU,question:EXe,marker:AXe,street:MXe,addressMarker:CXe,search:PXe},images:{styleToggleDefault:kXe,styleToggleSatellite:OXe}};function ml(e,t={}){const r=Hn(Hn({},hU.variables),t.variables||{});let n=t.cssText||"",a="";for(const[l,f]of Object.entries(r)){if(!Array.isArray(f)){a+=`--${l}: ${f};`;continue}if(f[0]!=="mobile"){const b=JSON.stringify(f);throw new Error(`Unsupported expression in theme variables: ${l} ${b}`)}const[,i,_]=f;n+=`${DXe} { ${e} { --${l}: ${i} !important; } }`,a+=`--${l}: ${_};`}return n+`${e} { ${a} }`}function Sc(e,t={}){return Hn(Hn({},hU.icons),t.icons||{})[e]}function LXe(e,t={}){return Hn(Hn({},hU.images),t.images||{})[e]}var S_,YF,_X=class{constructor(e,t,r){Pt(this,S_,void 0),Pt(this,YF,{placement:"bottom-start",flip:!1,offset:10}),this.update=()=>Sx(this,null,function*(){const n={placement:this.options.placement,middleware:[CZe(this.options.offset),this.options.flip&&MZe()].filter(Boolean)},{x:a,y:l}=yield DZe(this.referenceEl,this.floatingEl,n);Object.assign(this.floatingEl.style,{left:`${a}px`,top:`${l}px`})}),this.referenceEl=e,this.floatingEl=t,xr(this,S_,Hn(Hn({},ue(this,YF)),r)),this.destroy=RZe(this.referenceEl,this.floatingEl,this.update)}get options(){return ue(this,S_)}set options(e){xr(this,S_,Hn(Hn({},ue(this,S_)),e))}};S_=new WeakMap;YF=new WeakMap;var Vy="*{box-sizing:border-box!important}[role=button]{cursor:pointer}.MapboxSearch{--width:0;display:none}.Results{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);min-width:var(--minWidth);overflow-y:auto;position:absolute;transform:translateZ(0);transition:visibility var(--duration);width:var(--width);z-index:1000}.Results:not([aria-hidden=true]){visibility:visible}.Results[aria-hidden=true]{animation:fadein var(--duration) var(--curve) reverse forwards;visibility:hidden}.Suggestion{align-items:center;display:flex;padding:var(--padding)}.Suggestion:hover{cursor:pointer}.Suggestion[aria-selected=true]{background-color:var(--colorBackgroundHover)}.Suggestion:active{background-color:var(--colorBackgroundActive)}.SuggestionName{font-weight:var(--fontWeightBold)}.SuggestionIcon{margin-right:6px}.SuggestionIcon[aria-hidden=true]{display:none}.ResultsAttribution{padding:var(--paddingFooterLabel)}.ResultsAttribution a{color:var(--colorSecondary)}.ResultsAttribution a:not(:hover){text-decoration:none}.ResultsList{list-style:none;margin:0;padding:0}.Label{display:none}.Geocoder,.SearchBox{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--padding);padding-bottom:0;padding-top:0;position:relative;width:100%}.SearchIcon{fill:#757575;left:.5em}.ActionIcon,.SearchIcon{bottom:0;height:20px;margin:auto 0;position:absolute;top:0;width:20px}.ActionIcon{right:.5em}.ActionIcon>button{background:none;border:none;color:inherit;cursor:pointer;font:inherit;height:100%;outline:inherit;padding:0;width:100%}.ActionIcon>button:hover{background:none!important}.ClearBtn{display:none}.ClearBtn:hover{color:#909090}.LoadingIcon{-moz-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;-webkit-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;display:none;height:100%}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.Input{background-color:transparent;border:0;color:#404040;color:rgba(0,0,0,.75);font:inherit;height:36px;margin:0;overflow:hidden;padding:0 40px;text-overflow:ellipsis;white-space:nowrap;width:100%}.Input::-ms-clear{display:none}.Input:focus{border:thin dotted;border-radius:var(--borderRadius);box-shadow:none;color:#404040;color:rgba(0,0,0,.75);outline:0}mapbox-address-confirmation-feature[aria-hidden=true],mapbox-address-confirmation-no-feature[aria-hidden=true]{display:none}.MapboxAddressConfirmation{align-items:center;background-color:var(--colorBackdrop);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;transform:translateZ(0);z-index:1000}.MapboxAddressConfirmation:not([aria-hidden=true]){animation:fadein var(--duration) var(--curve) forwards;visibility:visible}.MapboxAddressConfirmation[aria-hidden=true]{visibility:hidden}.ContentFeature,.ContentNoFeature{width:var(--minWidth)}.Modal{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--paddingModal);width:100%}@media screen and (max-width:480px){.MapboxAddressConfirmation{align-items:flex-end}.ContentFeature,.ContentNoFeature{width:100%}.Modal{border-bottom-left-radius:0;border-bottom-right-radius:0}}.ModalHeader{align-items:center;color:var(--colorPrimary);display:flex;font-size:var(--unitHeader);font-weight:var(--fontWeightBold);margin-bottom:var(--spacing);user-select:none;width:100%}.ModalMap{height:calc(var(--minWidth)*9/16);margin-left:calc(var(--paddingModal)*-1);width:calc(100% + var(--paddingModal)*2)}.ModalMap[aria-hidden=true]{display:none}.Icon{height:var(--unitHeader);width:var(--unitHeader)}.Icon.IconClose{color:var(--colorSecondary)}.ModalHeaderTitle{flex:1;margin-left:.25em}.ModalFooter{color:var(--colorSecondary);margin-top:var(--spacing);text-align:center}.ModalFooter[aria-hidden=true]{display:none}.ModalSubheader{font-weight:var(--fontWeightBold);user-select:none}.ModalDescription{color:var(--colorPrimary)}.ModalAddress,.ModalSubheader{margin-bottom:var(--spacing)}.ModalAddress.ModalAddressApprove{color:var(--colorPrimary)}.Button{border-radius:var(--borderRadius);cursor:pointer;font-weight:var(--fontWeightSemibold);margin-top:var(--spacing);padding:var(--padding);text-align:center;user-select:none;width:100%}.Button[aria-hidden=true]{display:none}.Button.ButtonPrimary{background-color:var(--colorPrimary);color:var(--colorBackground)}.Button.ButtonSecondary{border:1px solid var(--colorSecondary);color:var(--colorSecondary)}@keyframes fadein{0%{opacity:0}to{opacity:1}}.MapboxAddressMinimap{font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight)}.MapboxAddressMinimap[aria-hidden=true]{display:none}.MinimapImageContainer{border-radius:var(--borderRadius);overflow:hidden}.MinimapImage{height:unset;max-height:unset;max-width:unset;position:relative;width:unset}.MinimapInnerFrame{border:var(--border);border-radius:inherit;height:inherit;left:0;overflow:hidden;position:absolute;top:0;width:inherit}.MinimapMarker{left:50%;position:absolute;top:50%}.MinimapMarker>svg{color:var(--colorPrimary);display:block!important}.MinimapAttributionLogo{bottom:0;left:0;margin:0 0 6px 6px;position:absolute}.MinimapAttributionLogo a{cursor:pointer;display:block;height:23px;width:88px}.MinimapAttributionText{background-color:hsla(0,0%,100%,.65);bottom:0;font:11px/16px Helvetica Neue,Arial,Helvetica,sans-serif;padding:0 5px;position:absolute;right:0}.MinimapAttributionText a{color:rgba(0,0,0,.75);text-decoration:none}.MinimapAttributionText a:hover{color:inherit;text-decoration:underline}.MinimapAttributionText a:not(:first-child){margin-left:3px}.MinimapStyleToggle{background-position:0;background-repeat:no-repeat;background-size:contain;border:2px solid #fff;border-radius:3px;box-shadow:var(--boxShadow);cursor:pointer;height:2em;position:absolute;right:var(--spacing);top:var(--spacing);width:2em}.MinimapFooter{color:var(--colorSecondary);font-family:var(--fontFamily);font-size:var(--unit);margin-top:var(--spacing)}.MinimapFooter[aria-hidden=true]{display:none}.MinimapEditButtons{bottom:26px;display:flex;font-family:var(--fontFamily);position:absolute;right:var(--spacing)}.MinimapEditButtons .Button{box-shadow:var(--boxShadow)}.MinimapButtonCancel{background-color:var(--colorBackground);margin-left:var(--spacing)}.draggable{cursor:move;cursor:grab}.draggable:active{cursor:grabbing}",Vi=class extends CustomEvent{constructor(e,t){super(e,{composed:!0,detail:t})}clone(e){const t=new Vi(this.type,this.detail);return e&&Object.defineProperty(t,"target",{value:e}),t}},NXe="Type in 2 or more characters for results.",zXe="When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.",jXe="No search results.",FXe=(e,t,r)=>`${t} ${t===1?"result is":"results are"} available. ${e}. ${r} of ${t} is selected.`,BXe=e=>`${e} ${e===1?"result is":"results are"} available. Use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.`;function ale(e){const t=e.currentTarget;(e.key===" "||e.key==="Enter")&&(e.preventDefault(),e.stopPropagation(),t.dispatchEvent(new MouseEvent("click",{bubbles:!0,composed:!0})))}var sle="search-listbox__description",fU=e=>{const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.setAttribute("role","status"),t.setAttribute("style","border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;margin-bottom: -1px;margin-right: -1px;overflow: hidden;padding: 0px;position: absolute;white-space: nowrap;width: 1px;");const r=document.createElement("div");return r.setAttribute("id",`${e}--${sle}`),t.appendChild(r),t},xX=(e,t)=>{var r;const n=(r=document.body.querySelector(`[id="${t}--${sle}"]`))!=null?r:null;n&&(n.textContent=e)},$Xe=e=>{e.name=e.name+" address-search",e.setAttribute("data-lpignore","true")},UXe=(e,t,r)=>{let n=null;const a=!t||t.length===0;if((e==null?void 0:e.length)<2)n=NXe+" "+zXe;else if(a)n=jXe;else if(r!==void 0){const l=t[r],f=l.name||l.feature_name||l.properties.name;n=FXe(f,t.length,r+1)}else n=BXe(t.length);return n},KF=(e,t)=>{switch(t){case 0:return e.matching_name||e.feature_name||e.address_line1;case 2:return e.name;case 1:return e.properties.name;default:return""}},VXe=(e,t)=>{switch(t){case 0:return e.description;case 2:return e.feature_type==="poi"?e.full_address:e.place_formatted;case 1:return e.properties.place_formatted;default:return""}};function yN(e,t){return`${e}-${t}`}var Ka,xs,Bw,hh,$w,nC,Uw,iC,JF,QF,lle,oC,aC,sC,OS,Vw,T_,lC,BE=class extends Mm{constructor(){super(...arguments),Pt(this,iC),Pt(this,QF),this.suggestions=null,Pt(this,Ka,null),Pt(this,xs,void 0),Pt(this,Bw,void 0),Pt(this,hh,void 0),Pt(this,$w,void 0),Pt(this,nC,null),Pt(this,Uw,void 0),Pt(this,oC,{}),Pt(this,aC,{}),Pt(this,sC,e=>{const{Results:t}=ue(this,xs),r=e.target;if(r.dataset.mapboxSuccess){delete r.dataset.mapboxSuccess;return}const n=r.value;this.renderAriaMessage(),t.setAttribute("aria-busy","true"),this.dispatchEvent(new Vi("input",{lastInput:e.data,inputText:n}))}),this.renderAriaMessage=()=>{var e;const t=UXe((e=this.input)==null?void 0:e.value,this.suggestions,this.selectedIndex);xX(t,this.dataset.seed)},this.clearAriaMessage=()=>{xX("",this.dataset.seed)},this.handleSuggest=e=>{if(this.suggestions=e,(!e||e.length===0)&&this.renderAriaMessage(),!e){this.hideResults();return}IS(this,QF,lle).call(this),e.length&&IS(this,iC,JF).call(this);const{Results:t}=ue(this,xs);t.setAttribute("aria-busy","false")},this.handleError=()=>{const{Results:e}=ue(this,xs);e.setAttribute("aria-busy","false"),this.hideResults()},Pt(this,OS,(e,t)=>Sx(this,null,function*(){const r=this.input;r&&(r.dataset.mapboxSuccess="true");const n={suggestion:e,selectedIndex:t};this.dispatchEvent(new Vi("select",n)),this.hideResults()})),Pt(this,Vw,()=>{const e=this.input;delete e.dataset.mapboxSuccess,this.dispatchEvent(new Vi("focus")),this.renderAriaMessage(),IS(this,iC,JF).call(this)}),Pt(this,T_,()=>{document.activeElement!==this.input&&(this.dispatchEvent(new Vi("blur")),this.clearAriaMessage(),this.hideResults())}),this.handleArrowUp=()=>{this.selectedIndex===void 0?this.selectedIndex=this.suggestions.length-1:this.selectedIndex===0?this.selectedIndex=void 0:this.selectedIndex=Math.max(0,this.selectedIndex-1)},this.handleArrowDown=()=>{this.selectedIndex===void 0?this.selectedIndex=0:this.selectedIndex===this.suggestions.length-1?this.selectedIndex=void 0:this.selectedIndex=Math.min(this.selectedIndex+1,this.suggestions.length-1)},Pt(this,lC,e=>{var t;if((t=this.suggestions)!=null&&t.length){if(e.key==="ArrowDown"){e.preventDefault(),this.handleArrowDown();return}if(e.key==="ArrowUp"){e.preventDefault(),this.handleArrowUp();return}if(e.key==="Escape"){this.hideResults();return}if(this.selectedIndex!==void 0){if(e.key==="Tab"){ue(this,OS).call(this,this.suggestions[this.selectedIndex],this.selectedIndex);return}if(e.key==="Enter"){e.preventDefault(),ue(this,OS).call(this,this.suggestions[this.selectedIndex],this.selectedIndex);return}}}})}get template(){return _Xe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".MapboxSearch",this.theme)}get input(){return ue(this,$w)}set input(e){const t=ue(this,$w);t&&(t.removeEventListener("input",ue(this,sC)),t.removeEventListener("focus",ue(this,Vw)),t.removeEventListener("blur",ue(this,T_)),t.removeEventListener("keydown",ue(this,lC)),ue(this,Ka)&&ue(this,Ka).destroy()),e&&(e.addEventListener("input",ue(this,sC)),e.addEventListener("focus",ue(this,Vw)),e.addEventListener("blur",ue(this,T_)),e.addEventListener("keydown",ue(this,lC)),e.setAttribute("role","combobox"),e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-controls",ue(this,hh)),this.isConnected&&xr(this,Ka,new _X(e,ue(this,xs).Results,this.popoverOptions))),xr(this,$w,e)}get searchService(){return ue(this,nC)}set searchService(e){xr(this,nC,e)}get selectedIndex(){return ue(this,Uw)}set selectedIndex(e){const t=ue(this,Uw);xr(this,Uw,e);const{ResultsList:r}=ue(this,xs),n=yN(ue(this,hh),e);if(e!==void 0?(this.input.setAttribute("aria-activedescendant",n),r.setAttribute("aria-activedescendant",n)):(this.input.removeAttribute("aria-activedescendant"),r.removeAttribute("aria-activedescendant")),t!==e){const a=yN(ue(this,hh),t),l=r.querySelector(`#${a}`);if(l==null||l.removeAttribute("aria-selected"),l==null||l.setAttribute("tabindex","-1"),e!==void 0){const f=r.querySelector(`#${n}`);f==null||f.setAttribute("aria-selected","true"),f==null||f.setAttribute("tabindex","0")}}this.renderAriaMessage()}hideResults(){const{Results:e,ResultsList:t}=ue(this,xs);e.setAttribute("aria-hidden","true"),this.input.setAttribute("aria-expanded","false"),t.removeAttribute("aria-activedescendant"),this.input.removeAttribute("aria-activedescendant")}renderItem(e){const t=this.prepareTemplate(xXe);return t.id=yN(ue(this,hh),e),t}fillItem(e,t,r,n){const a=e.querySelector('[class$="SuggestionIcon"]'),l=e.querySelector('[class$="SuggestionName"]'),f=e.querySelector('[class$="SuggestionDesc"]');this.searchService===0?(a.innerHTML=Sc(t.accuracy==="street"?"street":"addressMarker",this.theme),a.removeAttribute("aria-hidden")):a.setAttribute("aria-hidden","true"),l.textContent=f.textContent="",l.textContent=KF(t,this.searchService),f.textContent=VXe(t,this.searchService),r===this.selectedIndex?e.setAttribute("aria-selected","true"):e.removeAttribute("aria-selected"),e.setAttribute("aria-posinset",(r+1).toString()),e.setAttribute("aria-setsize",n.toString())}get theme(){return ue(this,oC)}set theme(e){xr(this,oC,e),!(!ue(this,xs)||!e)&&this.updateTemplateUserStyle(ml(".MapboxSearch",e))}get popoverOptions(){return ue(this,aC)}set popoverOptions(e){xr(this,aC,e),ue(this,Ka)&&(ue(this,Ka).options=e,ue(this,Ka).update())}connectedCallback(){super.connectedCallback(),this.dataSeed=this.dataset.seed,xr(this,Bw,this.dataset.seed+"-Label"),xr(this,hh,this.dataset.seed+"-ResultsList"),this.input&&this.input.setAttribute("aria-controls",ue(this,hh)),xr(this,xs,Uy(this,{MapboxSearch:".MapboxSearch",Results:".Results",ResultsList:".ResultsList",Label:".Label"}));const{Results:e,ResultsList:t,Label:r}=ue(this,xs);r.id=ue(this,Bw),t.id=ue(this,hh),t.setAttribute("aria-labelledby",ue(this,Bw)),e.addEventListener("blur",ue(this,T_)),!ue(this,Ka)&&this.input&&xr(this,Ka,new _X(this.input,ue(this,xs).Results,this.popoverOptions)),requestAnimationFrame(()=>{ue(this,Ka)&&ue(this,Ka).update()})}disconnectedCallback(){this.input=null;const{Results:e}=ue(this,xs);e.removeEventListener("blur",ue(this,T_)),ue(this,Ka)&&ue(this,Ka).destroy()}focus(){document.activeElement===this.input?ue(this,Vw).call(this):this.input.focus()}blur(){this.input.blur()}updatePopover(){ue(this,Ka)&&ue(this,Ka).update()}};Ka=new WeakMap;xs=new WeakMap;Bw=new WeakMap;hh=new WeakMap;$w=new WeakMap;nC=new WeakMap;Uw=new WeakMap;iC=new WeakSet;JF=function(){if(!this.suggestions||!this.suggestions.length)return;const{Results:e,MapboxSearch:t}=ue(this,xs),r=this.input.getBoundingClientRect();t.style.setProperty("--width",`${r.width}px`),t.style.setProperty("display","block"),this.input.setAttribute("aria-expanded","true"),e.removeAttribute("aria-hidden"),this.selectedIndex=void 0};QF=new WeakSet;lle=function(){const{ResultsList:e}=ue(this,xs);if(!this.suggestions||!this.suggestions.length){e.innerHTML="",this.hideResults();return}const t=cXe(e);if(this.suggestions.length>t.length)for(let r=t.length;r<this.suggestions.length;r++){const n=this.renderItem(r);t.push(n),n.onmouseenter=()=>{this.selectedIndex=r},n.onmouseleave=()=>{this.selectedIndex=void 0},e.appendChild(n)}if(this.suggestions.length<t.length)for(let r=this.suggestions.length;r<t.length;r++)t[r].remove();for(let r=0;r<this.suggestions.length;r++){const n=this.suggestions[r],a=t[r];this.fillItem(a,n,r,this.suggestions.length),a.onclick=()=>{ue(this,OS).call(this,n,r)}}};oC=new WeakMap;aC=new WeakMap;sC=new WeakMap;OS=new WeakMap;Vw=new WeakMap;T_=new WeakMap;lC=new WeakMap;window.MapboxSearchListbox=BE;window.customElements.get("mapbox-search-listbox")||customElements.define("mapbox-search-listbox",BE);var WXe=new Set(["street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code"]),GXe=new Set(["off","on","true","false"]);function cle(e){let t=e.parentNode;for(;t;){if(t instanceof HTMLFormElement)return t;t=t.parentNode}return null}function qXe(e){const t=e||document;return Array.from(t.querySelectorAll('input[autocomplete~="address-line1"], input[autocomplete~="street-address"]'))}var HXe="section-",ZXe="section-default",XXe="section-shipping",YXe="section-billing";function pU(e){const t=Array.from(e.querySelectorAll("[autocomplete]")).filter(n=>{const a=n.tagName.toLowerCase();return a==="input"||a==="select"||a==="textarea"}),r=[];for(const n of t){if(!dXe(n))continue;const a=n.getAttribute("autocomplete")||"";if(!a||GXe.has(a))continue;const l=a.toLowerCase().split(" ");if(l.length>3)continue;const f=l[l.length-1];if(!WXe.has(f))continue;l.pop();let i=ZXe;if(l.length){const _=l[l.length-1];_==="shipping"&&(i=XXe,l.pop()),_==="billing"&&(i=YXe,l.pop())}if(l.length){const _=l[l.length-1];_.startsWith(HXe)&&(i=_)}r.push({input:n,section:i,field:f})}return r}function $E(e,t){const r=[],n=[],a=pU(e);let l=null;for(const{input:f,section:i,field:_}of a){let b=r.length-1,E=!1;if(r.length?(n[b]!==i||r[b][_])&&(E=!0):E=!0,E){if(l)break;r.push({[_]:f}),n.push(i),b++}else r[b][_]=f;f===t&&(l=r[b])}return l??{}}function ule(e,t,r){var n;const a=$E(e,t),l=[r.address_line1,r.address_line2,r.address_line3].filter(i=>!!i).join(", ");id(a["street-address"],a["address-line2"]?r.address_line1||"":l),id(a["address-line1"],r.address_line1||""),id(a["address-line2"],r.address_line2||""),id(a["address-level1"],r.address_level1||""),id(a["address-level2"],r.address_level2||""),id(a["address-level3"],r.address_level3||"");const f=r.country_code||((n=r.metadata)==null?void 0:n.iso_3166_1)||"";if(a.country&&a.country instanceof HTMLSelectElement){let i=a.country.querySelector("option").value;i===""&&(i=a.country.querySelectorAll("option")[1].value);const _=i===i.toUpperCase();id(a.country,_?f.toUpperCase():f)}else id(a.country,f);id(a["country-name"],r.country||""),id(a["postal-code"],r.postcode||"")}function KXe(e,t){const r=$E(e,t),n={};for(const[a,l]of Object.entries(r))l!=null&&l.value&&(n[a]=l.value);return n}function dle(e){const t=[];return e["street-address"]?t.push(e["street-address"]):t.push(e["address-line1"]||""),t.push(e["address-line2"]||""),t.push(e["address-line3"]||""),t.push(e["address-level3"]||""),t.push(e["address-level2"]||""),t.push(e["address-level1"]||""),t.push(e["postal-code"]||""),e["country-name"]?t.push(e["country-name"]):t.push(e.country||""),t.filter(r=>!!r).map(r=>r.trim()).join(", ")}function hle(e,t){const r=cle(t);if(!r)return;const n=iU(e);ule(r,t,n);const a=$E(r,t);a["address-line2"]&&!n.address_line2&&a["address-line2"].focus()}function JXe(e){var t;const r={},n=[e.properties.address_line1,e.properties.address_line2,e.properties.address_line3].filter(a=>!!a).join(", ");return r["street-address"]=n,r["address-line1"]=e.properties.address_line1,r["address-line2"]=e.properties.address_line2,r["address-line3"]=e.properties.address_line3,r["address-level1"]=e.properties.address_level1,r["address-level2"]=e.properties.address_level2,r["address-level3"]=e.properties.address_level3,r.country=(t=e.properties.metadata)==null?void 0:t.iso_3166_1,r["country-name"]=e.properties.country,r["postal-code"]=e.properties.postcode,r}function QXe(e,t){for(const[r,n]of Object.entries(e))if(t[r]!==n)return!0;return!1}var eYe=e=>e.filter((t,r,n)=>{const a=KF(t,0);return t.accuracy!=="street"||n.findIndex(l=>a===KF(l,0))===r}),e0=(e,t,r)=>{const l=r?t||"address-line1":"new-password";e&&(e.autocomplete=l)},tYe=(e,t,r)=>{if(!e||!r)return;e0(e,t,!0);const n={properties:Gl(Hn({},r),{address_line1:r.address_line1+" ",postcode:null})};hle(n,e),e0(e,t,!1),e==null||e.focus()},rYe=class{constructor(){this.feedbackEnabled=!0,this.autofillSessionToken=new Ic,this.autofillSessionEnabled=!1,this.detectBrowserAutofillEnabled=!1}},Au=new rYe;Object.defineProperty(Au,"autofillSessionToken",{configurable:!1,writable:!1});var nYe=Xl(`
<template>
  <div class="MapboxAddressConfirmation" aria-hidden="true">
    <mapbox-address-confirmation-feature class="ContentFeature"></mapbox-address-confirmation-feature>
    <mapbox-address-confirmation-no-feature class="ContentNoFeature"></mapbox-address-confirmation-no-feature>
  </div>
</template>
`),cC,fc,E_,uC,mU=class extends Mm{constructor(){super(...arguments),Pt(this,cC,!1),Pt(this,fc,void 0),Pt(this,E_,void 0),Pt(this,uC,{})}get template(){return nYe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".MapboxAddressConfirmation",this.theme)}get theme(){return ue(this,uC)}set theme(e){if(xr(this,uC,e),!ue(this,fc)||!e)return;this.updateTemplateUserStyle(ml(".MapboxAddressConfirmation",e));const{ContentFeature:t,ContentNoFeature:r}=ue(this,fc);t.theme=e,r.theme=e}connectedCallback(){super.connectedCallback(),xr(this,fc,Uy(this,{MapboxAddressConfirmation:".MapboxAddressConfirmation",ContentFeature:".ContentFeature",ContentNoFeature:".ContentNoFeature"}));const{MapboxAddressConfirmation:e}=ue(this,fc);e.setAttribute("aria-hidden","true");const t=this.theme;if(t){const{ContentFeature:r,ContentNoFeature:n}=ue(this,fc);r.theme=t,n.theme=t}}disconnectedCallback(){xr(this,E_,null)}hide(){var e;if(xr(this,cC,!1),!ue(this,fc))return;const{MapboxAddressConfirmation:t}=ue(this,fc);t.setAttribute("aria-hidden","true"),(e=ue(this,E_))==null||e.deactivate(),sX.off()}show(e,t,r){return Sx(this,null,function*(){var n;if(!ue(this,fc))return{type:"cancel"};const{MapboxAddressConfirmation:a,ContentFeature:l,ContentNoFeature:f}=ue(this,fc),{accessToken:i,minimap:_=!1,theme:b,footer:E}=t;this.theme=b,r?(l.removeAttribute("aria-hidden"),f.setAttribute("aria-hidden","true"),l.minimap=_,l.accessToken=i,l.footer=E,l.update(r,e)):(l.setAttribute("aria-hidden","true"),f.removeAttribute("aria-hidden"),f.update(e)),xr(this,cC,!0),a.removeAttribute("aria-hidden"),sX.on();const C=r?l:f;return xr(this,E_,eXe(a,{fallbackFocus:C,escapeDeactivates:()=>(this.hide(),!0)})),(n=ue(this,E_))==null||n.activate(),new Promise(R=>{const F=C,U=$=>{F.removeEventListener("result",U);const H=$.detail;this.hide(),R(H==="change"?{type:"change",feature:r}:{type:H})};F.addEventListener("result",U)})})}tryShow(e,t){return Sx(this,null,function*(){if(!ue(this,fc))return{type:"cancel"};const{accessToken:r,options:n={}}=t,a=new Rse(Hn({accessToken:r},n)),l=dle(e),i=(yield a.validate(l,{sessionToken:Au.autofillSessionToken})).features[0];if(i){const _=E=>E.properties.match_code.confidence===Lse.exact,{skipConfirmModal:b=_}=t;if(b(i))return{type:"nochange"}}return yield this.show(e,t,i)})}};cC=new WeakMap;fc=new WeakMap;E_=new WeakMap;uC=new WeakMap;window.MapboxAddressConfirmation=mU;window.customElements.get("mapbox-address-confirmation")||customElements.define("mapbox-address-confirmation",mU);var vN=new mU;function iYe(e){return Sx(this,arguments,function*(t,r={}){var n;const{sections:a=[]}=r;vN.parentNode||document.body.appendChild(vN);let l={type:"nochange"};const f=qXe(t),i=pU(t),_=Array.from(document.querySelectorAll("mapbox-search-listbox"));for(const b of f){if(a.length){const $=i.find(H=>H.input===b);if(!$||!a.includes($.section))continue}const E=KXe(t,b),C=_.find($=>$.input===b),R=C==null?void 0:C.autofillHost;if(R){const $=R.retrieveFeature;if($){const H=JXe($);if(!QXe(E,H))continue}}const F=r.accessToken||Au.accessToken,U=yield vN.tryShow(E,Gl(Hn({},r),{accessToken:F}));if(U.type==="change"){const $=$E(t,b);if((n=$["address-line2"])!=null&&n.value&&(U.feature.properties.address_line2=$["address-line2"].value),C)R.simulateRetrieve(U.feature);else{b.dataset.mapboxSuccess="true";const H=iU(U.feature);ule(t,b,H)}}U.type==="change"&&l.type!=="cancel"&&(l=U),U.type==="cancel"&&(l=U)}return l})}function fle(e,t,r,n,a){if(t){const l=Xl(`
        <span>
          <span></span>
          <br />
          <span></span>
        </span>
      `),[f,i]=Array.from(l.querySelectorAll("span > span"));if(r&&n)f.textContent=r,i.textContent=n;else{const _=t.split(",");f.textContent=_[0].trim(),i.textContent=_.slice(1).join(",").trim()}if(!a){if(e["address-line2"]){const _=document.createElement("span");_.textContent=e["address-line2"],l.insertBefore(_,i),l.insertBefore(document.createElement("br"),i)}if(e["address-line3"]){const _=document.createElement("span");_.textContent=e["address-line3"],l.insertBefore(_,i),l.insertBefore(document.createElement("br"),i)}}return l}else{const l=e["street-address"]||e["address-line1"]||"",f=e["address-line2"],i=e["address-line3"],_=[e["address-level4"]||"",e["address-level3"]||"",e["address-level2"]||"",`${e["address-level1"]||""} ${e["postal-code"]||""}`,e.country||e["country-name"]||""].filter(Boolean).join(", "),E=[l,f,i,_].filter(Boolean).map(R=>`<span>${R}</span>`).join("<br />");return Xl(`
        <span>${E}</span>
      `)}}function oYe(e,t,r,n){return Sx(this,null,function*(){if(!r)return;const a=cle(e),l=Object.values($E(a,e));if(!t.detail.elements.some(R=>l.includes(R)))return;const f=pU(a),_=f.find(R=>R.input===e).section,b=Array.from(new Set(f.filter(R=>t.detail.elements.includes(R.input)).map(R=>R.section)));if(!b.includes(_))return;const E=typeof r=="object"&&r.sections||[];if(E.length&&!E.some(R=>b.includes(R)))return;let C=typeof r=="object"?r:{};C=Gl(Hn({},C),{accessToken:n,sections:[_]}),yield iYe(a,C)})}var aYe="https://contribute-api.mapbox.com/v1",sYe="https://contribute-api-staging.tilestream.net/v1",lYe="edit-suggestion";function ple(e,t){if(!Au.feedbackEnabled)return;const r=window.location.hostname,a=`${SXe(r)||TXe(r)?sYe:aYe}/${lYe}/address?access_token=${e}`,{originalCoordinate:l,originalAddress:f,changes:i}=t,_={action:"update",reason:"incorrect_address",location:{longitude:l[0],latitude:l[1]},userEmail:"no-reply-autofill@mapbox.com",changes:i,placeName:f};fetch(a,{method:"POST",headers:new Headers({"User-Agent":`mapbox-search-js.${MR}.${navigator.userAgent}`,"Content-Type":"application/json"}),body:JSON.stringify(_)})}var cYe=Xl(`
<template>
  <div class="MapboxAddressConfirmationFeature">
    <div class="Modal" aria-modal="true" role="dialog">
      <div class="ModalHeader">
        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>
        <div class="ModalHeaderTitle">Did you mean?</div>
        <svg
          viewBox="0 0 18 18"
          class="Icon IconClose"
          tabindex="0"
          role="button"
          title="Close"
          aria-label="Close"
          aria-expanded="true"
        ></svg>
      </div>

      <div class="ModalAddress ModalAddressApprove"></div>
            
      <div class="ModalMap">
        <mapbox-address-minimap class="Minimap"></mapbox-address-minimap>
      </div>

      <div
        class="Button ButtonPrimary ButtonApprove"
        tabindex="0"
        role="button"
        aria-label="Yes"
      >
        Yes
      </div>
      
      <div
        class="Button ButtonSecondary ButtonReject"
        tabindex="0"
        role="button"
        aria-label="No, use the address I provided"
      >
        No, use the address I provided
      </div>

      <div class="ModalFooter">
          Your confirmation helps improve address data accuracy.
      </div>
    </div>
  </div>
</template>
`),fh,dC,Ww,hC,fC,pC,mC,gC,mle=class extends Mm{constructor(){super(...arguments),Pt(this,fh,void 0),Pt(this,dC,{}),this.minimap=!1,Pt(this,Ww,void 0),Pt(this,hC,void 0),this.update=(e,t)=>{var r;xr(this,Ww,e),xr(this,hC,t);const{ModalMap:n,Minimap:a,ModalAddressApprove:l}=ue(this,fh);if(this.minimap){if(n.removeAttribute("aria-hidden"),a.accessToken=this.accessToken,typeof this.minimap=="object"){const{defaultMapStyle:i,theme:_,mapStyleMode:b,satelliteToggle:E}=this.minimap;i&&(a.defaultMapStyle=this.minimap.defaultMapStyle),_&&(a.theme=this.minimap.theme),b&&(a.mapStyleMode=b),E!==void 0&&(a.satelliteToggle=E)}a.feature=e}else n.setAttribute("aria-hidden","true");const f=e.properties.place_name||e.properties.full_address||e.properties.address;l.innerHTML="",l.appendChild(fle(t,f,e.properties.feature_name,e.properties.description,((r=e.properties.place_type)==null?void 0:r[0])==="secondary_address"))},Pt(this,fC,()=>{this.dispatchEvent(new Vi("result","cancel"))}),this.approve=()=>{this.dispatchEvent(new Vi("result","change"))},this.reject=()=>{this.dispatchEvent(new Vi("result","nochange")),ple(this.accessToken,{originalCoordinate:ue(this,Ww).geometry.coordinates,originalAddress:ue(this,Ww).properties.full_address,changes:{address:dle(ue(this,hC))}})},Pt(this,pC,uy()),Pt(this,mC,uy()),Pt(this,gC,uy())}get template(){return cYe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".MapboxAddressConfirmationFeature",this.theme)}get theme(){return ue(this,dC)}set theme(e){if(xr(this,dC,e),!ue(this,fh)||!e)return;this.updateTemplateUserStyle(ml(".MapboxAddressConfirmationFeature",e));const{IconQuestion:t,IconClose:r}=ue(this,fh);t.innerHTML=Sc("question",e),r.innerHTML=Sc("close",e)}set footer(e){if(e===void 0)return;const t=this.querySelector(".ModalFooter");typeof e=="string"?(t.textContent=e,t.removeAttribute("aria-hidden")):e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback(),xr(this,fh,Uy(this,{MapboxAddressConfirmationFeature:".MapboxAddressConfirmationFeature",Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",ModalMap:".ModalMap",Minimap:".Minimap",IconQuestion:".IconQuestion",IconClose:".IconClose",ButtonApprove:".ButtonApprove",ButtonReject:".ButtonReject",ModalAddressApprove:".ModalAddressApprove"}));const{Modal:e,ModalHeaderTitle:t,IconClose:r,ButtonApprove:n,ButtonReject:a,ModalAddressApprove:l}=ue(this,fh);e.setAttribute("aria-labelledby",ue(this,mC)),e.setAttribute("aria-describedby",ue(this,gC)),r.setAttribute("aria-controls",ue(this,pC)),e.id=ue(this,pC),t.id=ue(this,mC),l.id=ue(this,gC);const f=Array.from(this.querySelectorAll('[role="button"]'));for(const _ of f)_.addEventListener("keydown",ale);r.addEventListener("click",ue(this,fC)),n.addEventListener("click",this.approve),a.addEventListener("click",this.reject);const i=this.theme;if(i){const{IconQuestion:_,IconClose:b}=ue(this,fh);_.innerHTML=Sc("question",i),b.innerHTML=Sc("close",i)}}disconnectedCallback(){const{IconClose:e,ButtonApprove:t}=ue(this,fh);e.removeEventListener("click",ue(this,fC)),t.removeEventListener("click",this.approve)}};fh=new WeakMap;dC=new WeakMap;Ww=new WeakMap;hC=new WeakMap;fC=new WeakMap;pC=new WeakMap;mC=new WeakMap;gC=new WeakMap;window.MapboxAddressConfirmationFeature=mle;window.customElements.get("mapbox-address-confirmation-feature")||customElements.define("mapbox-address-confirmation-feature",mle);var uYe=Xl(`
<template>
  <div class="MapboxAddressConfirmationNoFeature">
    <div class="Modal" aria-modal="true" role="dialog">
      <div class="ModalHeader">
        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>
        <div class="ModalHeaderTitle">Confirm address</div>
        <svg
          viewBox="0 0 18 18"
          class="Icon IconClose"
          tabindex="0"
          role="button"
          title="Close"
          aria-label="Close"
          aria-expanded="true"
        ></svg>
      </div>
      <div class="ModalDescription">
        We couldn't verify this address. Please check that your information is correct before continuing.
      </div>
      <br />
      <div class="ModalSubheader">
        You entered
      </div>
      <div class="ModalAddress"></div>
      <div
        class="Button ButtonPrimary"
        tabindex="0"
        role="button"
        aria-label="Use the address I provided"
      >
        Use the address I provided
      </div>
    </div>
  </div>
</template>
`),ph,yC,vC,_C,xC,bC,gle=class extends Mm{constructor(){super(...arguments),Pt(this,ph,void 0),Pt(this,yC,{}),this.update=e=>{const{ModalAddress:t}=ue(this,ph);t.innerHTML="",t.appendChild(fle(e))},Pt(this,vC,()=>{this.dispatchEvent(new Vi("result","cancel"))}),this.reject=()=>{this.dispatchEvent(new Vi("result","nochange"))},Pt(this,_C,uy()),Pt(this,xC,uy()),Pt(this,bC,uy())}get template(){return uYe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".MapboxAddressConfirmationNoFeature",this.theme)}get theme(){return ue(this,yC)}set theme(e){if(xr(this,yC,e),!ue(this,ph)||!e)return;this.updateTemplateUserStyle(ml(".MapboxAddressConfirmationNoFeature",e));const{IconQuestion:t,IconClose:r}=ue(this,ph);t.innerHTML=Sc("question",e),r.innerHTML=Sc("close",e)}connectedCallback(){super.connectedCallback(),xr(this,ph,Uy(this,{Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",IconQuestion:".IconQuestion",IconClose:".IconClose",ModalAddress:".ModalAddress",ButtonReject:".Button"}));const{Modal:e,ModalHeaderTitle:t,IconClose:r,ModalAddress:n,ButtonReject:a}=ue(this,ph);e.setAttribute("aria-labelledby",ue(this,xC)),e.setAttribute("aria-describedby",ue(this,bC)),r.setAttribute("aria-controls",ue(this,_C)),e.id=ue(this,_C),t.id=ue(this,xC),n.id=ue(this,bC);const l=Array.from(this.querySelectorAll('[role="button"]'));for(const i of l)i.addEventListener("keydown",ale);r.addEventListener("click",ue(this,vC)),a.addEventListener("click",this.reject);const f=this.theme;if(f){const{IconQuestion:i,IconClose:_}=ue(this,ph);i.innerHTML=Sc("question",f),_.innerHTML=Sc("close",f)}}disconnectedCallback(){const{IconClose:e,ButtonReject:t}=ue(this,ph);e.removeEventListener("click",ue(this,vC)),t.removeEventListener("click",this.reject)}};ph=new WeakMap;yC=new WeakMap;vC=new WeakMap;_C=new WeakMap;xC=new WeakMap;bC=new WeakMap;window.MapboxAddressConfirmationNoFeature=gle;window.customElements.get("mapbox-address-confirmation-no-feature")||customElements.define("mapbox-address-confirmation-no-feature",gle);var dYe='input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{animation-name:onbrowserautofillstart}input:not(:-webkit-autofill),select:not(:-webkit-autofill),textarea:not(:-webkit-autofill){animation-name:onbrowserautofillcancel}@keyframes onbrowserautofillstart{0%{animation-name:"onbrowserautofillstart"}to{animation-name:"onbrowserautofillstart"}}@keyframes onbrowserautofillcancel{0%{animation-name:"onbrowserautofillcancel"}to{animation-name:"onbrowserautofillcancel"}}',CO="browser-autofilled",e4=[];function hYe(){window.dispatchEvent(new window.CustomEvent("browserautofill",{bubbles:!0,cancelable:!0,detail:{elements:e4}})),e4=[]}var fYe=Nse(hYe,5);function yle(e){e.hasAttribute(CO)||(e.setAttribute(CO,""),e4.push(e),fYe())}function vle(e){e.hasAttribute(CO)&&e.removeAttribute(CO)}function pYe(e){e.animationName==="onbrowserautofillstart"?yle(e.target):vle(e.target)}function mYe(e){const t=e.target;t.nodeName.toLowerCase()!=="select"&&!e.simulated&&!(e instanceof Vi)&&(e.inputType==="insertReplacementText"||!("data"in e))?yle(t):vle(t)}function gYe(){Au.detectBrowserAutofillEnabled||(Au.detectBrowserAutofillEnabled=!0,hXe(dYe),document.addEventListener("animationstart",pYe,!0),document.addEventListener("input",mYe,!0))}var gU=(e,t)=>{if(typeof e=="string")if(e==="ip"){const r=t==null?void 0:t.get("ip-proximity");return r&&typeof r=="string"?r.split(",").map(parseFloat):[999,999]}else return e.split(",").map(Number);else return jo.convert(e).toArray()},yYe=e=>{const t={};return e.bbox&&(typeof e.bbox=="string"?t.bbox=e.bbox.split(",").map(Number):t.bbox=$l.convert(e.bbox).toFlatArray()),e.proximity&&(t.proximity=gU(e.proximity)),e.country&&(t.country=e.country.split(",")),e.language&&(t.language=e.language.split(",")),e.types&&(typeof e.types=="string"?t.types=e.types.split(","):t.types=Array.from(e.types)),e.limit&&(typeof e.limit=="string"?t.limit=parseInt(e.limit):t.limit=e.limit),t},vYe=(e,t)=>{const r={};return e.bbox&&(typeof e.bbox=="string"?r.bbox=e.bbox.split(",").map(Number):r.bbox=$l.convert(e.bbox).toFlatArray()),e.proximity&&(r.proximity=gU(e.proximity,t)),e.country&&(r.country=e.country.split(",")),e.language&&(r.language=e.language.split(",")),e.types&&(typeof e.types=="string"?r.types=e.types.split(","):r.types=Array.from(e.types)),e.limit&&(typeof e.limit=="string"?r.limit=parseInt(e.limit):r.limit=e.limit),typeof e.autocomplete=="boolean"&&(r.autocomplete=e.autocomplete),e.worldview&&(r.worldview=e.worldview),e.permanent&&(r.permanent=e.permanent),r},_Ye=(e,t)=>{const r={};return e.bbox&&(typeof e.bbox=="string"?r.bbox=e.bbox.split(",").map(Number):r.bbox=$l.convert(e.bbox).toFlatArray()),e.proximity&&(r.proximity=gU(e.proximity,t)),e.country&&(r.country=e.country.split(",")),e.language&&(r.language=e.language.split(",")),e.limit&&(typeof e.limit=="string"?r.limit=parseInt(e.limit):r.limit=e.limit),e.streets!==void 0&&e.streets!==null&&(typeof e.streets=="string"?r.streets=e.streets==="true":r.streets=e.streets),r},xYe=(e,t,r)=>{switch(t){case 2:return yYe(e);case 1:return vYe(e,r);case 0:return _Ye(e,r)}},bYe=e=>({suggestionIds:e.map(t=>t.mapbox_id||""),suggestionNames:e.map(t=>t.feature_type==="poi"?[t.name,t.full_address].filter(Boolean).join(", "):t.full_address?t.full_address:t.name),suggestionTypes:e.map(t=>t.feature_type||""),suggestionSources:e.map(()=>"mapbox")}),wYe=e=>({suggestionIds:e.map(t=>t.properties.mapbox_id||t.id||""),suggestionNames:e.map(t=>t.properties.full_address||""),suggestionTypes:e.map(t=>t.properties.feature_type||""),suggestionSources:e.map(()=>"mapbox")}),SYe=e=>({suggestionIds:e.map(t=>t.mapbox_id||""),suggestionNames:e.map(t=>t.full_address||""),suggestionTypes:e.map(t=>{var r;return((r=t.place_type)==null?void 0:r[0])||""}),suggestionSources:e.map(()=>"mapbox")}),TYe=(e,t)=>{switch(t){case 2:return bYe(e);case 1:return wYe(e);case 0:return SYe(e)}},bX=(e,t)=>{switch(e){case 2:return"search/searchbox/v1/suggest";case 1:return`search/geocode/v6/${/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/.test(t)?"reverse":"forward"}`;case 0:return"autofill/v1/suggest"}},t4,r4,Og,wC,n4,kg,Gw,qw,Hw,Zw,i4,A_,mh,o4,a4,s4,Xw,l4,c4,u4,d4,h4,f4,Yw,Rg,Kw,yU=class{constructor(e){Pt(this,t4,"https://api.mapbox.com"),Pt(this,r4,"events/v2"),Pt(this,Og,void 0),Pt(this,wC,void 0),Pt(this,n4,navigator.language||null),Pt(this,kg,[]),Pt(this,Gw,""),Pt(this,qw,0),Pt(this,Hw,!0),Pt(this,Zw,1e3),Pt(this,i4,100),Pt(this,A_,void 0),Pt(this,mh,void 0),this.start=(t,r,n,a)=>{xr(this,Og,r.accessToken);const l=ue(this,Xw).call(this,"search.start",{queryString:t,options:r,map:n,responseHeaders:a});l&&ue(this,Kw).call(this,l)},this.input=(t,r,n,a,l)=>{if(xr(this,Og,n.accessToken),ue(this,Hw)&&(this.start(t,n,a,l),xr(this,Hw,!1)),!r)return;const f=ue(this,Xw).call(this,"search.keystroke",{lastInput:r,queryString:t,options:n,map:a,responseHeaders:l});f&&ue(this,Kw).call(this,f)},this.select=(t,r,n,a,l,f)=>{xr(this,Og,a.accessToken);const i=ue(this,Xw).call(this,"search.select",{queryString:t,selectedIndex:r,suggestions:n,options:a,map:l,responseHeaders:f});i&&(i.resultIndex===ue(this,qw)&&i.queryString===ue(this,Gw)||i.resultIndex===-1||(xr(this,qw,i.resultIndex),xr(this,Gw,i.queryString),ue(this,Kw).call(this,i)))},this.clear=()=>{xr(this,Hw,!0),xr(this,Gw,""),xr(this,qw,0),ue(this,Rg).call(this)},Pt(this,o4,t=>{const r=`${ue(this,t4)}/${ue(this,r4)}?access_token=${ue(this,Og)}`,n=ue(this,a4).call(this,t);try{fetch(r,n)}catch(a){ue(this,s4).call(this,a)}}),Pt(this,a4,t=>(Array.isArray(t)||(t=[t]),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})),Pt(this,s4,t=>{console.log(t)}),Pt(this,Xw,(t,r)=>{if(t==="search.select"&&!(typeof r.selectedIndex=="number"||r.suggestions)||t==="search.keystroke"&&!r.lastInput)return null;const n=xYe(r.options,ue(this,mh),r.responseHeaders),a=ue(this,l4).call(this,t,r,n);return t==="search.keystroke"?ue(this,c4).call(this,a,r,n):t==="search.select"&&ue(this,u4).call(this,a,r,n),ue(this,f4).call(this,a)?a:null}),Pt(this,l4,(t,r,n)=>{let a={event:t,version:ue(this,h4).call(this,t),created:+new Date,sessionIdentifier:r.options.sessionToken,userAgent:ue(this,wC),keyboardLocale:ue(this,n4),queryString:r.queryString};if(n&&(a=Hn(Hn({},a),n)),t==="search.start")for(const l of["streets","permanent"])delete a[l];if(r.map){const l=r.map.getZoom()||void 0,f=r.map.getCenter();a=Gl(Hn({},a),{mapZoom:l,mapCenterLat:f.lat,mapCenterLng:f.lng})}return a}),Pt(this,c4,(t,r,n)=>{switch(ue(this,mh)){case 0:n.streets&&(t.streets=n.streets);break;case 1:n.permanent&&(t.permanent=n.permanent);break}t.path=bX(ue(this,mh),r.queryString),t.lastAction=r.lastInput}),Pt(this,u4,(t,r,n)=>{switch(ue(this,mh)){case 0:n.streets&&(t.streets=n.streets);break;case 1:n.permanent&&(t.permanent=n.permanent);break}t.path=bX(ue(this,mh),r.queryString);const{selectedIndex:a,suggestions:l}=r;if(l&&l.length>0){const f=TYe(l,ue(this,mh));t.resultIndex=a,t.resultPlaceName=f.suggestionNames[a],t.resultId=f.suggestionIds[a],t.resultId.startsWith("dXJuOm1ie")&&(t.resultMapboxId=t.resultId),t.suggestionIds=f.suggestionIds,t.suggestionNames=f.suggestionNames,t.suggestionTypes=f.suggestionTypes,t.suggestionSources=f.suggestionSources}}),Pt(this,d4,()=>`mapbox.${IXe.split("/")[1]}.${MR}.${navigator.userAgent}`),Pt(this,h4,t=>["search.keystroke","search.select"].includes(t)?"2.2":"2.0"),Pt(this,f4,t=>{if(!t||!t.event)return!1;const r=["event","created","sessionIdentifier","queryString"],n=["event","created","sessionIdentifier","queryString","lastAction"],a=["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"],l=t.event;return l==="search.start"?ue(this,Yw).call(this,t,r):l==="search.keystroke"?ue(this,Yw).call(this,t,n):l==="search.select"?ue(this,Yw).call(this,t,a):!0}),Pt(this,Yw,(t,r)=>r.every(n=>n==="queryString"?typeof t[n]=="string"&&t[n].length>0:t[n]!==void 0)),Pt(this,Rg,()=>{ue(this,kg).length>0&&ue(this,Og)&&(ue(this,o4).call(this,ue(this,kg)),xr(this,kg,[])),ue(this,A_)&&clearTimeout(ue(this,A_)),ue(this,Zw)&&xr(this,A_,setTimeout(ue(this,Rg),ue(this,Zw)))}),Pt(this,Kw,(t,r)=>{ue(this,kg).push(t),(ue(this,kg).length>=ue(this,i4)||r)&&ue(this,Rg).call(this)}),this.remove=()=>{ue(this,Rg).call(this)},xr(this,mh,e),xr(this,wC,ue(this,d4).call(this)),xr(this,A_,setTimeout(ue(this,Rg),ue(this,Zw)))}};t4=new WeakMap;r4=new WeakMap;Og=new WeakMap;wC=new WeakMap;n4=new WeakMap;kg=new WeakMap;Gw=new WeakMap;qw=new WeakMap;Hw=new WeakMap;Zw=new WeakMap;i4=new WeakMap;A_=new WeakMap;mh=new WeakMap;o4=new WeakMap;a4=new WeakMap;s4=new WeakMap;Xw=new WeakMap;l4=new WeakMap;c4=new WeakMap;u4=new WeakMap;d4=new WeakMap;h4=new WeakMap;f4=new WeakMap;Yw=new WeakMap;Rg=new WeakMap;Kw=new WeakMap;var up,Hs,Zs,Oi,M_,dp,Jw,SC,TC,Qw,EC,AC,MC,CC,PC,IC,OC,p4,vU=class extends Mm{constructor(){super(...arguments),Pt(this,up,new Cse),Pt(this,Hs,new nU(ue(this,up))),Pt(this,Zs,void 0),Pt(this,Oi,new BE),Pt(this,M_,new yU(0)),Pt(this,dp,void 0),this.options={},this.confirmOnBrowserAutofill=!1,Pt(this,Jw,!1),Pt(this,SC,e=>{const t=e!=null&&e.suggestions?eYe(e.suggestions):null;ue(this,Oi).handleSuggest(t),this.dispatchEvent(new Vi("suggest",e))}),Pt(this,TC,e=>{ue(this,Oi).handleError(),this.dispatchEvent(new Vi("suggesterror",e))}),Pt(this,Qw,e=>{var t;if(this.dispatchEvent(new Vi("retrieve",e)),this.retrieveFeature=(t=e.features)==null?void 0:t[0],!ue(this,Zs))return;const r=e;!r||!r.features||!r.features.length||hle(r.features[0],ue(this,Zs))}),Pt(this,EC,()=>{var e;try{const t=(e=this.querySelector("input"))!=null?e:null;xr(this,Zs,t),ue(this,Oi).input=t}catch(t){xr(this,Zs,null),ue(this,Oi).input=null,console.error(t.message||t)}}),Pt(this,AC,new MutationObserver(ue(this,EC))),Pt(this,MC,e=>{ue(this,Oi).blur(),oYe(ue(this,Zs),e,this.confirmOnBrowserAutofill,this.accessToken)}),this.retrieveFeature=null,this.interceptSearch=null,Pt(this,CC,e=>{this.dispatchEvent(new Vi("input",e.detail.inputText));const{lastInput:t,inputText:r}=e.detail,n=this.browserAutofillEnabled===!0&&(r==null?void 0:r.length)<=2;if(e0(ue(this,Zs),ue(this,dp),n),!r){ue(this,p4).call(this);return}const a=this.interceptSearch&&this.interceptSearch(r),l=this.interceptSearch?a:r;if(this.interceptSearch&&!a||(l==null?void 0:l.length)<=2){ue(this,Oi).handleSuggest(null);return}ue(this,Hs).suggest(l,this.options),ue(this,M_).input(l,t,Gl(Hn({},this.options),{sessionToken:ue(this,Hs).sessionToken,accessToken:this.accessToken}),null,ue(this,up).responseHeaders)}),Pt(this,PC,e=>{const{suggestion:t,selectedIndex:r}=e.detail;t.accuracy!=="street"?(e0(ue(this,Zs),ue(this,dp),!0),ue(this,Hs).retrieve(t,this.options),ue(this,M_).select(this.input.value,r,ue(this,Oi).suggestions,Gl(Hn({},this.options),{sessionToken:ue(this,Hs).sessionToken,accessToken:this.accessToken}),null,ue(this,up).responseHeaders)):tYe(ue(this,Zs),ue(this,dp),t)}),Pt(this,IC,()=>{e0(ue(this,Zs),ue(this,dp),!0),ue(this,Hs).abort()}),Pt(this,OC,()=>{var e;const t=this.browserAutofillEnabled===!0&&((e=ue(this,Zs).value)==null?void 0:e.length)<=2;e0(ue(this,Zs),ue(this,dp),t)}),Pt(this,p4,()=>{ue(this,Oi).handleSuggest(null),ue(this,M_).clear()})}get accessToken(){return ue(this,up).accessToken}set accessToken(e){ue(this,up).accessToken=e}get input(){return ue(this,Zs)}get theme(){return ue(this,Oi).theme}set theme(e){ue(this,Oi).theme=e}get popoverOptions(){return ue(this,Oi).popoverOptions}set popoverOptions(e){ue(this,Oi).popoverOptions=e}get browserAutofillEnabled(){return ue(this,Jw)}set browserAutofillEnabled(e){xr(this,Jw,e)}connectedCallback(){var e;super.connectedCallback(),Au.autofillSessionEnabled=!0,ue(this,Hs).sessionToken=Au.autofillSessionToken.id,ue(this,Oi).autofillHost=this,ue(this,Oi).searchService=0;const t=(e=this.querySelector("input"))!=null?e:null;ue(this,AC).observe(this,{subtree:!0,childList:!0}),ue(this,EC).call(this),ue(this,Oi).addEventListener("input",ue(this,CC)),ue(this,Oi).addEventListener("select",ue(this,PC)),ue(this,Oi).addEventListener("blur",ue(this,IC)),ue(this,Oi).addEventListener("focus",ue(this,OC)),ue(this,Hs).addEventListener("suggest",ue(this,SC)),ue(this,Hs).addEventListener("suggesterror",ue(this,TC)),ue(this,Hs).addEventListener("retrieve",ue(this,Qw)),document.body.appendChild(ue(this,Oi)),t&&(t.insertAdjacentElement("beforebegin",fU(ue(this,Oi).dataSeed)),$Xe(t),xr(this,dp,t.autocomplete)),gYe(),window.addEventListener("browserautofill",ue(this,MC))}disconnectedCallback(){ue(this,Oi).remove(),ue(this,Oi).removeEventListener("input",ue(this,CC)),ue(this,Oi).removeEventListener("select",ue(this,PC)),ue(this,Oi).removeEventListener("blur",ue(this,IC)),ue(this,Oi).removeEventListener("focus",ue(this,OC)),ue(this,Hs).removeEventListener("suggest",ue(this,SC)),ue(this,Hs).removeEventListener("suggesterror",ue(this,TC)),ue(this,Hs).removeEventListener("retrieve",ue(this,Qw)),ue(this,M_).remove(),ue(this,AC).disconnect(),window.removeEventListener("browserautofill",ue(this,MC))}attributeChangedCallback(e,t,r){if(e==="access-token"){ue(this,up).accessToken=r;return}if(e==="browser-autofill-enabled"){xr(this,Jw,!!r);return}if(e==="theme"){this.theme=Tx(r);return}if(e==="popover-options"){this.popoverOptions=Tx(r);return}const n=e.split("-").join("_");r||delete this.options[n],this.options[n]=r}focus(){ue(this,Oi).focus()}simulateRetrieve(e){const t=this.input;t&&(t.dataset.mapboxSuccess="true"),ue(this,Oi).hideResults();const r={type:"FeatureCollection",features:[e],url:""};ue(this,Qw).call(this,r)}};up=new WeakMap;Hs=new WeakMap;Zs=new WeakMap;Oi=new WeakMap;M_=new WeakMap;dp=new WeakMap;Jw=new WeakMap;SC=new WeakMap;TC=new WeakMap;Qw=new WeakMap;EC=new WeakMap;AC=new WeakMap;MC=new WeakMap;CC=new WeakMap;PC=new WeakMap;IC=new WeakMap;OC=new WeakMap;p4=new WeakMap;vU.observedAttributes=["access-token","browser-autofill-enabled","theme","popover-options","css-text","language","country","bbox","limit","proximity","streets"];window.MapboxAddressAutofill=vU;window.customElements.get("mapbox-address-autofill")||customElements.define("mapbox-address-autofill",vU);var EYe={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"},_le={placeholder:EYe},AYe=9,ad,C_,Xs,ou,sd,Xi,P_,m4,xle,I_,kC,RC,DC,Dg,LC,NC,eS,zC,jC,hp,FC,BC,_U=class extends Mm{constructor(){super(...arguments),Pt(this,m4),Pt(this,ad,void 0),Pt(this,C_,new Ise({})),Pt(this,Xs,new nU(ue(this,C_))),Pt(this,ou,null),Pt(this,sd,void 0),Pt(this,Xi,new BE),Pt(this,P_,new yU(2)),this.options={},Pt(this,I_,void 0),Pt(this,kC,e=>{ue(this,hp).call(this),ue(this,Xi).handleSuggest((e==null?void 0:e.suggestions)||null),this.dispatchEvent(new Vi("suggest",e))}),Pt(this,RC,e=>{ue(this,hp).call(this),ue(this,Xi).handleError(),this.dispatchEvent(new Vi("suggesterror",e))}),Pt(this,DC,e=>{ue(this,hp).call(this),this.dispatchEvent(new Vi("retrieve",e));const t=e;if(!t||!t.features.length)return;const r=iU(t.features[0]);ue(this,sd).value=r.name;const n=ue(this,ou);if(!n)return;const a=t.features[0];if(!a)return;const l=a.properties.feature_type,f=a.properties.bbox;if(f)n.flyTo(rle(n,$l.convert(f).toFlatArray()));else{const i=a.geometry.coordinates,_=nle(l);n.flyTo({center:i,zoom:_,speed:cU})}this.marker&&this.mapboxgl&&ue(this,NC).call(this,a)}),Pt(this,Dg,void 0),Pt(this,LC,()=>{ue(this,Dg)&&(ue(this,Dg).remove(),xr(this,Dg,null))}),Pt(this,NC,e=>{if(!ue(this,ou)||(ue(this,LC).call(this),!e))return;const r=Hn(Hn({},{color:"#4668F2"}),typeof this.marker=="object"&&this.marker);xr(this,Dg,new this.mapboxgl.Marker(r)),e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&ue(this,Dg).setLngLat(e.geometry.coordinates).addTo(ue(this,ou))}),this.interceptSearch=null,Pt(this,eS,e=>{this.dispatchEvent(new Vi("input",e.detail.inputText));const{lastInput:t,inputText:r}=e.detail;if(!r){ue(this,FC).call(this);return}const n=this.interceptSearch&&this.interceptSearch(r),a=this.interceptSearch?n:r;if(this.interceptSearch&&!n){ue(this,Xi).hideResults();return}ue(this,Xs).suggest(a,this.options),ue(this,P_).input(a,t,Gl(Hn({},this.options),{sessionToken:ue(this,Xs).sessionToken,accessToken:this.accessToken}),ue(this,ou)),ue(this,hp).call(this,!0)}),Pt(this,zC,e=>{const{suggestion:t,selectedIndex:r}=e.detail;ue(this,Xs).retrieve(t,this.options),ue(this,P_).select(this.value,r,ue(this,Xi).suggestions,Gl(Hn({},this.options),{sessionToken:ue(this,Xs).sessionToken,accessToken:this.accessToken}),ue(this,ou)),ue(this,hp).call(this,!0)}),Pt(this,jC,()=>{ue(this,Xs).abort()}),Pt(this,hp,(e=!1)=>{e?(ue(this,ad).ClearBtn.style.display="none",ue(this,ad).LoadingIcon.style.display="block"):(ue(this,ad).LoadingIcon.style.display="none",ue(this,ad).ClearBtn.style.display=this.value?"block":"none")}),Pt(this,FC,()=>{this.value="",ue(this,hp).call(this),ue(this,NC).call(this,null),ue(this,Xi).handleSuggest(null),ue(this,P_).clear(),ue(this,Xs).incrementSession(),this.dispatchEvent(new Vi("clear"))}),this.marker=!0,Pt(this,BC,()=>{const e=ue(this,ou),t=Hn({},this.options);if(e.getZoom()<=AYe){delete t.proximity,this.options=t;return}const r=e.getCenter();this.options=Gl(Hn({},t),{proximity:r})})}get accessToken(){return ue(this,C_).accessToken}set accessToken(e){ue(this,C_).accessToken=e}get value(){return ue(this,sd).value}set value(e){ue(this,sd).value=e||""}get input(){return ue(this,sd)}get template(){return bXe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".SearchBox",ue(this,Xi).theme)}get theme(){return ue(this,Xi).theme}set theme(e){if(ue(this,Xi).theme=e,!ue(this,ad)||!e)return;this.updateTemplateUserStyle(ml(".SearchBox",e)),ue(this,Xi).updatePopover();const{SearchIcon:t}=ue(this,ad);t.innerHTML=Sc("search",e)}get popoverOptions(){return ue(this,Xi).popoverOptions}set popoverOptions(e){ue(this,Xi).popoverOptions=e}get placeholder(){return ue(this,I_)||IS(this,m4,xle).call(this)}set placeholder(e){xr(this,I_,e),ue(this,sd)&&(ue(this,sd).placeholder=this.placeholder,ue(this,sd).setAttribute("aria-label",this.placeholder))}connectedCallback(){super.connectedCallback(),xr(this,ad,Uy(this,{SearchBox:".SearchBox",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"})),this.theme=Hn({},this.theme);const{Input:e,ClearBtn:t}=ue(this,ad);xr(this,sd,e),ue(this,Xi).input=e,ue(this,Xi).searchService=2,ue(this,Xi).addEventListener("input",ue(this,eS)),ue(this,Xi).addEventListener("select",ue(this,zC)),ue(this,Xi).addEventListener("blur",ue(this,jC)),ue(this,Xs).addEventListener("suggest",ue(this,kC)),ue(this,Xs).addEventListener("suggesterror",ue(this,RC)),ue(this,Xs).addEventListener("retrieve",ue(this,DC)),t.addEventListener("click",ue(this,FC)),this.placeholder=ue(this,I_),this.parentElement.appendChild(ue(this,Xi)),e&&(e.previousElementSibling.hasAttribute("aria-live")&&e.previousElementSibling.remove(),e.insertAdjacentElement("beforebegin",fU(ue(this,Xi).dataSeed)))}disconnectedCallback(){ue(this,Xi).remove(),ue(this,Xi).input=null,ue(this,Xi).removeEventListener("input",ue(this,eS)),ue(this,Xi).removeEventListener("select",ue(this,zC)),ue(this,Xi).removeEventListener("blur",ue(this,jC)),ue(this,Xs).removeEventListener("suggest",ue(this,kC)),ue(this,Xs).removeEventListener("suggesterror",ue(this,RC)),ue(this,Xs).removeEventListener("retrieve",ue(this,DC)),ue(this,P_).remove()}attributeChangedCallback(e,t,r){if(e==="access-token"){ue(this,C_).accessToken=r;return}if(e==="theme"){this.theme=Tx(r);return}if(e==="popover-options"){this.popoverOptions=Tx(r);return}if(e==="placeholder"){this.placeholder=r;return}const n=e.split("-").join("_");r||delete this.options[n],this.options[n]=r,n==="language"&&(this.placeholder=ue(this,I_))}focus(){ue(this,Xi).focus()}search(e){this.value=e;const t={lastInput:e,inputText:e};ue(this,eS).call(this,new Vi("input",t))}bindMap(e){ue(this,ou)&&ue(this,ou).off("moveend",ue(this,BC)),e&&e.on("moveend",ue(this,BC)),xr(this,ou,e)}unbindMap(){this.bindMap(null)}onAdd(e){this.bindMap(e),this.remove();const t=document.createElement("div");return t.className="mapboxgl-ctrl",t.style.width="300px",t.appendChild(this),t}onRemove(){this.remove(),this.unbindMap(),ue(this,LC).call(this)}getDefaultPosition(){return"top-right"}};ad=new WeakMap;C_=new WeakMap;Xs=new WeakMap;ou=new WeakMap;sd=new WeakMap;Xi=new WeakMap;P_=new WeakMap;m4=new WeakSet;xle=function(){if(this.options.language){const e=this.options.language.split(",")[0],t=Jse.language(e),r=_le.placeholder[t];if(r)return r}return"Search"};I_=new WeakMap;kC=new WeakMap;RC=new WeakMap;DC=new WeakMap;Dg=new WeakMap;LC=new WeakMap;NC=new WeakMap;eS=new WeakMap;zC=new WeakMap;jC=new WeakMap;hp=new WeakMap;FC=new WeakMap;BC=new WeakMap;_U.observedAttributes=["access-token","theme","popover-options","placeholder","language","country","bbox","limit","navigation-profile","origin","proximity","eta-type","types"];window.MapboxSearchBox=_U;window.customElements.get("mapbox-search-box")||customElements.define("mapbox-search-box",_U);var MYe=9,ld,fp,Ys,au,cd,Yi,O_,g4,ble,k_,$C,UC,VC,Lg,WC,GC,tS,qC,HC,pp,ZC,XC,xU=class extends Mm{constructor(){super(...arguments),Pt(this,g4),Pt(this,ld,void 0),Pt(this,fp,new vZe({})),Pt(this,Ys,new nU(ue(this,fp))),Pt(this,au,null),Pt(this,cd,void 0),Pt(this,Yi,new BE),Pt(this,O_,new yU(1)),this.options={},Pt(this,k_,void 0),Pt(this,$C,e=>{ue(this,pp).call(this),ue(this,Yi).handleSuggest((e==null?void 0:e.features)||null),this.dispatchEvent(new Vi("suggest",e))}),Pt(this,UC,e=>{ue(this,pp).call(this),ue(this,Yi).handleError(),this.dispatchEvent(new Vi("suggesterror",e))}),Pt(this,VC,e=>{ue(this,pp).call(this),this.dispatchEvent(new Vi("retrieve",e));const t=e;if(!t)return;ue(this,cd).value=t.properties.full_address;const r=ue(this,au);if(!r)return;const n=t.properties.feature_type,a=t.properties.bbox;if(a)r.flyTo(rle(r,$l.convert(a).toFlatArray()));else{const l=t.geometry.coordinates,f=nle(n);r.flyTo({center:l,zoom:f,speed:cU})}this.marker&&this.mapboxgl&&ue(this,GC).call(this,t)}),Pt(this,Lg,void 0),Pt(this,WC,()=>{ue(this,Lg)&&(ue(this,Lg).remove(),xr(this,Lg,null))}),Pt(this,GC,e=>{if(!ue(this,au)||(ue(this,WC).call(this),!e))return;const r=Hn(Hn({},{color:"#4668F2"}),typeof this.marker=="object"&&this.marker);xr(this,Lg,new this.mapboxgl.Marker(r)),e.geometry&&e.geometry.type&&e.geometry.type==="Point"&&e.geometry.coordinates&&ue(this,Lg).setLngLat(e.geometry.coordinates).addTo(ue(this,au))}),this.interceptSearch=null,Pt(this,tS,e=>{this.dispatchEvent(new Vi("input",e.detail.inputText));const{lastInput:t,inputText:r}=e.detail;if(!r){ue(this,ZC).call(this);return}const n=this.interceptSearch&&this.interceptSearch(r),a=this.interceptSearch?n:r;if(this.interceptSearch&&!n){ue(this,Yi).hideResults();return}ue(this,Ys).suggest(a,this.options),ue(this,O_).input(a,t,Gl(Hn({},this.options),{sessionToken:ue(this,Ys).sessionToken,accessToken:this.accessToken}),ue(this,au),ue(this,fp).responseHeaders),ue(this,pp).call(this,!0)}),Pt(this,qC,e=>{const{suggestion:t,selectedIndex:r}=e.detail;ue(this,Ys).retrieve(t,this.options),ue(this,O_).select(this.value,r,ue(this,Yi).suggestions,Gl(Hn({},this.options),{sessionToken:ue(this,Ys).sessionToken,accessToken:this.accessToken}),ue(this,au),ue(this,fp).responseHeaders),ue(this,pp).call(this,!0)}),Pt(this,HC,()=>{ue(this,Ys).abort()}),Pt(this,pp,(e=!1)=>{e?(ue(this,ld).ClearBtn.style.display="none",ue(this,ld).LoadingIcon.style.display="block"):(ue(this,ld).LoadingIcon.style.display="none",ue(this,ld).ClearBtn.style.display=this.value?"block":"none")}),Pt(this,ZC,()=>{this.value="",ue(this,pp).call(this),ue(this,GC).call(this,null),ue(this,Yi).handleSuggest(null),ue(this,O_).clear(),ue(this,Ys).incrementSession(),this.dispatchEvent(new Vi("clear"))}),this.marker=!0,Pt(this,XC,()=>{const e=ue(this,au),t=Hn({},this.options);if(e.getZoom()<=MYe){delete t.proximity,this.options=t;return}const r=e.getCenter();this.options=Gl(Hn({},t),{proximity:r})})}get accessToken(){return ue(this,fp).accessToken}set accessToken(e){ue(this,fp).accessToken=e}get value(){return ue(this,cd).value}set value(e){ue(this,cd).value=e||""}get input(){return ue(this,cd)}get template(){return wXe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".Geocoder",ue(this,Yi).theme)}get theme(){return ue(this,Yi).theme}set theme(e){if(ue(this,Yi).theme=e,!ue(this,ld)||!e)return;this.updateTemplateUserStyle(ml(".Geocoder",e)),ue(this,Yi).updatePopover();const{SearchIcon:t}=ue(this,ld);t.innerHTML=Sc("search",e)}get popoverOptions(){return ue(this,Yi).popoverOptions}set popoverOptions(e){ue(this,Yi).popoverOptions=e}get placeholder(){return ue(this,k_)||IS(this,g4,ble).call(this)}set placeholder(e){xr(this,k_,e),ue(this,cd)&&(ue(this,cd).placeholder=this.placeholder,ue(this,cd).setAttribute("aria-label",this.placeholder))}connectedCallback(){super.connectedCallback(),xr(this,ld,Uy(this,{Geocoder:".Geocoder",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"})),this.theme=Hn({},this.theme);const{Input:e,ClearBtn:t}=ue(this,ld);xr(this,cd,e),ue(this,Yi).input=e,ue(this,Yi).searchService=1,ue(this,Yi).addEventListener("input",ue(this,tS)),ue(this,Yi).addEventListener("select",ue(this,qC)),ue(this,Yi).addEventListener("blur",ue(this,HC)),ue(this,Ys).addEventListener("suggest",ue(this,$C)),ue(this,Ys).addEventListener("suggesterror",ue(this,UC)),ue(this,Ys).addEventListener("retrieve",ue(this,VC)),t.addEventListener("click",ue(this,ZC)),this.placeholder=ue(this,k_),this.parentElement.appendChild(ue(this,Yi)),e&&(e.previousElementSibling.hasAttribute("aria-live")&&e.previousElementSibling.remove(),e.insertAdjacentElement("beforebegin",fU(ue(this,Yi).dataSeed)))}disconnectedCallback(){ue(this,Yi).remove(),ue(this,Yi).input=null,ue(this,Yi).removeEventListener("input",ue(this,tS)),ue(this,Yi).removeEventListener("select",ue(this,qC)),ue(this,Yi).removeEventListener("blur",ue(this,HC)),ue(this,Ys).removeEventListener("suggest",ue(this,$C)),ue(this,Ys).removeEventListener("suggesterror",ue(this,UC)),ue(this,Ys).removeEventListener("retrieve",ue(this,VC)),ue(this,O_).remove()}attributeChangedCallback(e,t,r){if(e==="access-token"){ue(this,fp).accessToken=r;return}if(e==="theme"){this.theme=Tx(r);return}if(e==="popover-options"){this.popoverOptions=Tx(r);return}if(e==="placeholder"){this.placeholder=r;return}const n=e.split("-").join("_");r||delete this.options[n],this.options[n]=r,n==="language"&&(this.placeholder=ue(this,k_))}focus(){ue(this,Yi).focus()}search(e){this.value=e;const t={lastInput:e,inputText:e};ue(this,tS).call(this,new Vi("input",t))}bindMap(e){ue(this,au)&&ue(this,au).off("moveend",ue(this,XC)),e&&e.on("moveend",ue(this,XC)),xr(this,au,e)}unbindMap(){this.bindMap(null)}onAdd(e){this.bindMap(e),this.remove();const t=document.createElement("div");return t.className="mapboxgl-ctrl",t.style.width="300px",t.appendChild(this),t}onRemove(){this.remove(),this.unbindMap(),ue(this,WC).call(this)}getDefaultPosition(){return"top-right"}};ld=new WeakMap;fp=new WeakMap;Ys=new WeakMap;au=new WeakMap;cd=new WeakMap;Yi=new WeakMap;O_=new WeakMap;g4=new WeakSet;ble=function(){if(this.options.language){const e=this.options.language.split(",")[0],t=Jse.language(e),r=_le.placeholder[t];if(r)return r}return"Search"};k_=new WeakMap;$C=new WeakMap;UC=new WeakMap;VC=new WeakMap;Lg=new WeakMap;WC=new WeakMap;GC=new WeakMap;tS=new WeakMap;qC=new WeakMap;HC=new WeakMap;pp=new WeakMap;ZC=new WeakMap;XC=new WeakMap;xU.observedAttributes=["access-token","theme","popover-options","placeholder","autocomplete","language","country","bbox","limit","proximity","types","worldview","permanent"];window.MapboxGeocoder=xU;window.customElements.get("mapbox-geocoder")||customElements.define("mapbox-geocoder",xU);var wX=new nXe({size:512,antimeridian:!0}),m_=1280;function SX(e,t){const{width:r,height:n}=ele(e,!0);switch(t){case"center":return[0,0];case"top":return[0,n/2];case"bottom":return[0,-1*n/2];case"left":return[r/2,0];case"right":return[-1*r/2,0];case"top-left":return[r/2,n/2];case"top-right":return[-1*r/2,n/2];case"bottom-left":return[r/2,-1*n/2];case"bottom-right":return[-1*r/2,-1*n/2]}}var YC,y4,R_,KC,JC,v4,QC,eP,_4,tP,rP,D_,x4,nP,CYe=class{constructor(e,t,r,n,a,l){Pt(this,YC,void 0),Pt(this,y4,()=>{[this.anchorOffsetX,this.anchorOffsetY]=SX(this.markerElement,this.anchor),this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}),Pt(this,R_,{anchorX:0,anchorY:0,globalX:0,globalY:0,correctionX:0,correctionY:0}),Pt(this,KC,!1),Pt(this,JC,void 0),Pt(this,v4,i=>{this.isActive&&(i.preventDefault(),i.stopPropagation(),ue(this,D_).call(this,i),window.addEventListener("pointermove",ue(this,eP)),window.addEventListener("pointerup",ue(this,QC)))}),Pt(this,QC,()=>{window.removeEventListener("pointermove",ue(this,eP)),window.removeEventListener("pointerup",ue(this,QC))}),Pt(this,eP,i=>{i.preventDefault(),i.stopPropagation();const _=this.curPointerXPos-i.pageX,b=this.curPointerYPos-i.pageY;this.markerDeltaX+=_,this.markerDeltaY-=b,this.markerDeltaX=Math.max(Math.min(this.imgElement.width/2,this.markerDeltaX),this.imgElement.width/2*-1),this.markerDeltaY=Math.max(Math.min(this.imgElement.height/2,this.markerDeltaY),this.imgElement.height/2*-1);const E=this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],C=this.imgCenterPx[1]-this.imgCenterAdjustedPx[1],R=this.markerDeltaX-E,F=this.markerDeltaY+C;this.markerTransform={globalX:R,globalY:F},ue(this,D_).call(this,i)}),Pt(this,_4,i=>{this.isActive&&(i.preventDefault(),i.stopPropagation(),ue(this,D_).call(this,i),window.addEventListener("pointermove",ue(this,rP)),window.addEventListener("pointerup",ue(this,tP)))}),Pt(this,tP,()=>{window.removeEventListener("pointermove",ue(this,rP)),window.removeEventListener("pointerup",ue(this,tP))}),Pt(this,rP,i=>{i.preventDefault();let _=Math.round(this.imgContainerElement.scrollTop+(this.curPointerYPos-i.pageY));_=Math.max(Math.min(this.imgElement.height-this.imgContainerElement.clientHeight,_),0);let b=Math.round(this.imgContainerElement.scrollLeft+(this.curPointerXPos-i.pageX));b=Math.max(Math.min(this.imgElement.width-this.imgContainerElement.clientWidth,b),0),this.imgContainerElement.scrollTop=_,this.imgContainerElement.scrollLeft=b;const E=Math.round(b-(this.imgElement.width-this.imgContainerElement.clientWidth)/2),C=Math.round((this.imgElement.height-this.imgContainerElement.clientHeight)/2-_);if(this.imgCenterAdjustedPx=[this.imgCenterPx[0]+E,this.imgCenterPx[1]-C],!this.keepMarkerCentered){const R=this.markerDeltaX+E,F=this.markerDeltaY+C;this.markerTransform={globalX:R,globalY:F}}ue(this,nP).call(this,b,_),ue(this,D_).call(this,i)}),Pt(this,D_,i=>{this.curPointerXPos=i.pageX,this.curPointerYPos=i.pageY}),Pt(this,x4,()=>{const{anchorX:i,anchorY:_,globalX:b,globalY:E,correctionX:C,correctionY:R}=ue(this,R_),F=i-b+C,U=_+E+R;this.markerElement.style.transform=`translate(calc(-50% + ${F}px), calc(-50% + ${U}px))`}),this.reCenter=()=>{const i=(this.imgElement.height-this.imgContainerElement.clientHeight)/2,_=(this.imgElement.width-this.imgContainerElement.clientWidth)/2;this.imgContainerElement.scrollTop=i,this.imgContainerElement.scrollLeft=_,this.imgCenterAdjustedPx=this.imgCenterPx,this.markerDeltaX=this.markerDeltaY=0,this.markerTransform={globalX:0,globalY:0,correctionX:0,correctionY:0}},this.handleMinimapResize=()=>{if(!this.imgElement.height||!this.imgElement.width)return;const i=this.imgCenterOffset.x,_=this.imgCenterOffset.y,b=this.imgElement.width/2-i-this.imgContainerElement.clientWidth/2,E=this.imgElement.height/2-_-this.imgContainerElement.clientHeight/2;this.imgContainerElement.scrollLeft=b,this.imgContainerElement.scrollTop=E,ue(this,nP).call(this,b,E)},Pt(this,nP,(i,_)=>{const b=this.imgCenterOffset.x,E=this.imgCenterOffset.y,{correctionX:C,correctionY:R}=this.markerTransform,F={};if(i/2<b*-1){const U=b*-1-i/2;F.correctionX=U*2}else i<0?F.correctionX=i:C!==0&&(F.correctionX=0);if(_/2<E*-1){const U=E*-1-_/2;F.correctionY=U*2}else _<0?F.correctionY=_:R!==0&&(F.correctionY=0);this.markerTransform=F}),this.markerElement=r,this.imgContainerElement=e,this.imgElement=t,this.keepMarkerCentered=n,this.zoom=a,this.anchor=l,this.curPointerXPos=0,this.curPointerYPos=0,this.markerDeltaX=0,this.markerDeltaY=0,this.imgContainerElement.addEventListener("pointerdown",ue(this,_4)),this.keepMarkerCentered||this.markerElement.addEventListener("pointerdown",ue(this,v4)),new ResizeObserver(ue(this,y4)).observe(this.markerElement)}get anchor(){return ue(this,YC)}set anchor(e){xr(this,YC,e),[this.anchorOffsetX,this.anchorOffsetY]=SX(this.markerElement,e),this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}get markerTransform(){return ue(this,R_)}set markerTransform(e){xr(this,R_,Hn(Hn({},ue(this,R_)),e)),ue(this,x4).call(this)}get isActive(){return ue(this,KC)}set isActive(e){this.imgContainerElement.style.touchAction=e?"none":"",xr(this,KC,e)}get coordinate(){const e=this.keepMarkerCentered?this.imgCenterAdjustedPx:[this.imgCenterPx[0]-this.markerDeltaX,this.imgCenterPx[1]+this.markerDeltaY];if(dU(e,this.imgCenterPx))return ue(this,JC);{const t=wX.ll(e,this.zoom);return[vX(t[0],6),vX(t[1],6)]}}set coordinate(e){xr(this,JC,e),this.imgCenterPx=this.imgCenterAdjustedPx=wX.px(e,this.zoom)}get imgCenterOffset(){return{x:this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],y:this.imgCenterPx[1]-this.imgCenterAdjustedPx[1]}}};YC=new WeakMap;y4=new WeakMap;R_=new WeakMap;KC=new WeakMap;JC=new WeakMap;v4=new WeakMap;QC=new WeakMap;eP=new WeakMap;_4=new WeakMap;tP=new WeakMap;rP=new WeakMap;D_=new WeakMap;x4=new WeakMap;nP=new WeakMap;var PYe='<svg width="88" height="23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill-rule="evenodd"><defs><path id="g" d="M11.5 2.25a9.25 9.25 0 1 1 0 18.5 9.25 9.25 0 0 1 0-18.5zM7 15.98c-.05-.33-.83-5.8 2.23-8.87a4.4 4.4 0 0 1 3.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39a4.4 4.4 0 0 1-1.28 3.13C12.72 16.93 7 16 7 16v-.02zm8.3-5.48-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z"/><path id="b" d="M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19A3.77 3.77 0 0 1 50.86 15v3.77c0 .13-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01.01-.01c.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V15a3.7 3.7 0 0 1-2.73 1.19c-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.38-.19a4.24 4.24 0 0 0-4.16 3.29 4.07 4.07 0 0 0 0 1.77 4.23 4.23 0 0 0 4.17 3.3 4.22 4.22 0 0 0 4.26-4.19 4.2 4.2 0 0 0-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18a4 4 0 0 1 3.84 3.28c.13.59.13 1.2 0 1.8a4 4 0 0 1-3.84 3.29A3.77 3.77 0 0 1 60.86 15v.77c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4a.23.23 0 0 1-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55a2.73 2.73 0 0 1 2.44-1.56c1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.62 0h-1.61a.27.27 0 0 1-.12-.03c-.1-.06-.13-.19-.06-.28l2.43-3.71-2.4-3.65a.21.21 0 0 1-.02-.12.2.2 0 0 1 .2-.21h1.61c.13 0 .24.06.3.17L82 10.54l1.4-2.37a.34.34 0 0 1 .3-.17h1.6l.12.03c.1.06.13.19.06.28l-2.37 3.65 2.43 3.7.01.13a.2.2 0 0 1-.2.21h-1.61a.33.33 0 0 1-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 0 1-.3.17zm-7.12-1.49A2.47 2.47 0 0 1 70.7 12a2.47 2.47 0 0 1 2.42-2.52 2.47 2.47 0 0 1 2.42 2.51 2.48 2.48 0 0 1-2.42 2.52zm-19.87 0a2.48 2.48 0 0 1-2.42-2.48v-.07a2.47 2.47 0 0 1 2.4-2.49 2.47 2.47 0 0 1 2.41 2.51 2.47 2.47 0 0 1-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51a2.47 2.47 0 0 1 2.4-2.52 2.46 2.46 0 0 1 2.41 2.48l.02.08zm18.12 2.47a2.47 2.47 0 0 1-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51a2.47 2.47 0 0 1-2.42 2.51z"/></defs><mask id="c"><rect width="100%" height="100%" fill="#fff"/><use xlink:href="#g"/><use xlink:href="#b"/></mask><g opacity=".3" stroke="#000" stroke-width="3"><circle mask="url(#c)" cx="11.5" cy="11.5" r="9.25"/><use xlink:href="#b" mask="url(#c)"/></g><g opacity=".9" fill="#fff"><use xlink:href="#g"/><use xlink:href="#b"/></g></svg>',TX=16,IYe=Xl(`
<template>
  <div class="MapboxAddressMinimap" aria-hidden="true">
    <div class="MinimapImageContainer">
      <img class="MinimapImage" draggable="false"></img>
      <div class="MinimapInnerFrame">
        <div class="MinimapMarker"></div>
        <div class="MinimapAttribution">
          <div class="MinimapAttributionLogo">
            <a target="_blank" rel="noopener nofollow" href="https://www.mapbox.com/" aria-label="Mapbox logo">
              ${PYe}
            </a>
          </div>
          <div class="MinimapAttributionText">
            <a target="_blank" href='https://www.mapbox.com/about/maps/'>© Mapbox</a><a target="_blank" href='http://www.openstreetmap.org/copyright'>© OpenStreetMap</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
`),OYe=Xl(`
<template>
  <button type="button" class="MinimapStyleToggle"></button>
</template>
`),kYe=Xl(`
<template>
  <div class="MinimapFooter">Adjust the marker on the map if it doesn't precisely match your location. This helps improve address data quality.</div>
</template>
`),b4="Adjust pin",w4="Save",S4="Cancel",RYe=Xl(`
<template>
  <div class="MinimapEditButtons">
    <div class="Button ButtonPrimary MinimapButtonAdjust">${b4}</div>
    <div class="Button ButtonPrimary MinimapButtonSave" aria-hidden="true">${w4}</div>
    <div class="Button MinimapButtonCancel" aria-hidden="true">${S4}</div>
  </div>
</template>
`),iP,L_,rS,gh,Ng,ud,dd,Ki,wa,oP,aP,sP,N_,lP,cP,uP,dP,hP,fP,nS,pP,mP,gP,yP,T4,E4,vP,iS,oS,_P,xP,A4,bP,M4,bU=class extends Mm{constructor(){super(...arguments),Pt(this,iP,!1),this.keepMarkerCentered=!1,this.markerAnchor="bottom",Pt(this,L_,!1),Pt(this,rS,!1),Pt(this,gh,void 0),Pt(this,Ng,""),Pt(this,ud,void 0),Pt(this,dd,void 0),Pt(this,Ki,void 0),Pt(this,wa,void 0),Pt(this,oP,void 0),Pt(this,aP,{}),Pt(this,sP,!1),Pt(this,N_,"default"),Pt(this,lP,void 0),Pt(this,cP,void 0),Pt(this,uP,void 0),Pt(this,dP,["mapbox","streets-v11"]),Pt(this,hP,void 0),Pt(this,fP,void 0),Pt(this,nS,()=>{const{ImageContainer:e,ButtonAdjust:t,ButtonSave:r,ButtonCancel:n}=ue(this,Ki);ue(this,L_)?(e.classList.add(`${this.dataset.seed}--draggable`),ue(this,wa).isActive=!0,t.setAttribute("aria-hidden","true"),r.removeAttribute("aria-hidden"),n.removeAttribute("aria-hidden")):(e.classList.remove(`${this.dataset.seed}--draggable`),ue(this,wa).isActive=!1,t.removeAttribute("aria-hidden"),r.setAttribute("aria-hidden","true"),n.setAttribute("aria-hidden","true"))}),Pt(this,pP,()=>{xr(this,L_,!0),ue(this,nS).call(this)}),Pt(this,mP,()=>{if(this.feature.properties.full_address&&!dU(this.feature.geometry.coordinates,ue(this,wa).coordinate)){const[e,t]=ue(this,wa).coordinate;ple(this.accessToken,{originalCoordinate:this.feature.geometry.coordinates,originalAddress:this.feature.properties.full_address,changes:{location:{longitude:e,latitude:t}}})}this.onSaveMarkerLocation&&this.onSaveMarkerLocation(ue(this,wa).coordinate),xr(this,L_,!1),ue(this,nS).call(this)}),Pt(this,gP,()=>{ue(this,wa).reCenter(),xr(this,L_,!1),ue(this,nS).call(this)}),Pt(this,yP,()=>{this.mapStyleMode=this.mapStyleMode==="default"?"satellite":"default"}),Pt(this,T4,()=>{ue(this,rS)||ue(this,wa).reCenter(),xr(this,rS,!0),ue(this,wa)&&ue(this,wa).handleMinimapResize()}),Pt(this,E4,()=>{xr(this,rS,!1)}),Pt(this,vP,e=>{if(ue(this,ud)===0||ue(this,dd)===0)return"";const[t,r]=this.defaultMapStyle,n=ile(t,r),a=this.mapStyleMode==="default"?n:gXe,l=yXe+Au.autofillSessionToken.toString();let f=a+jo.convert(e).toArray().join(",")+","+TX+",0/"+Math.min(ue(this,ud)*2,m_)+"x"+Math.min(ue(this,dd)*2,m_)+"?access_token="+this.accessToken+"&attribution=false&logo=false";return Au.autofillSessionEnabled&&(f+=`&sku=${l}`),f}),Pt(this,iS,()=>{if(ue(this,gh)){const e=ue(this,gh).geometry.coordinates;xr(this,Ng,ue(this,vP).call(this,e));const{Image:t}=ue(this,Ki);t.src=ue(this,Ng)}}),Pt(this,oS,e=>`url("${LXe(e==="default"?"styleToggleDefault":"styleToggleSatellite",this.theme)}")`),Pt(this,_P,()=>{const{MapboxAddressMinimap:e,ImageContainer:t,Image:r}=ue(this,Ki),{width:n,height:a}=ele(this.container),[l,f]=[ue(this,ud),ue(this,dd)];xr(this,ud,Math.min(n,m_)),xr(this,dd,Math.min(a,m_)),e.style.setProperty("width",`${ue(this,ud)}px`),e.style.setProperty("height",`${ue(this,dd)}px`),t.style.setProperty("height",`${ue(this,dd)}px`),t.style.setProperty("width",`${ue(this,ud)}px`);const[i,_]=[r.width,r.height];ue(this,ud)>l&&ue(this,ud)>i/2&&i<m_||ue(this,dd)>f&&ue(this,dd)>_/2&&_<m_?ue(this,iS).call(this):ue(this,wa)&&ue(this,wa).handleMinimapResize()}),Pt(this,xP,()=>{if(this.querySelector(".MinimapFooter"))return;const t=this.prepareTemplate(kYe),r=this.querySelector(".MapboxAddressMinimap");if(!r||(r.appendChild(t),this.querySelector(".MinimapEditButtons")))return;const a=this.prepareTemplate(RYe);this.querySelector(".MinimapInnerFrame").appendChild(a),xr(this,Ki,Gl(Hn({},ue(this,Ki)),{EditButtons:this.querySelector(".MinimapEditButtons"),ButtonAdjust:this.querySelector(".MinimapButtonAdjust"),ButtonSave:this.querySelector(".MinimapButtonSave"),ButtonCancel:this.querySelector(".MinimapButtonCancel")}));const{ButtonAdjust:f,ButtonSave:i,ButtonCancel:_}=ue(this,Ki);f.addEventListener("click",ue(this,pP)),i.addEventListener("click",ue(this,mP)),_.addEventListener("click",ue(this,gP))}),Pt(this,A4,()=>{if(!ue(this,Ki))return;const{EditButtons:e,ButtonAdjust:t,ButtonSave:r,ButtonCancel:n}=ue(this,Ki),a=this.querySelector(".MinimapFooter");a==null||a.remove(),e==null||e.remove(),t&&(t.remove(),t.removeEventListener("click",ue(this,pP))),r&&(r.remove(),r.removeEventListener("click",ue(this,mP))),n&&(n.remove(),n.removeEventListener("click",ue(this,gP))),delete ue(this,Ki).EditButtons,delete ue(this,Ki).ButtonAdjust,delete ue(this,Ki).ButtonSave,delete ue(this,Ki).ButtonCancel}),Pt(this,bP,()=>{if(this.querySelector(".MinimapStyleToggle"))return;const t=this.prepareTemplate(OYe),r=this.querySelector(".MinimapInnerFrame");r&&(r.appendChild(t),ue(this,Ki).MapStyleToggle=t,t.addEventListener("click",ue(this,yP)),t.style.backgroundImage=ue(this,oS).call(this,this.mapStyleMode==="default"?"satellite":"default"),t.setAttribute("title",`Switch to ${this.mapStyleMode==="default"?"Satellite":"Default"}`))}),Pt(this,M4,()=>{if(!ue(this,Ki))return;const{MapStyleToggle:e}=ue(this,Ki);e&&(e.remove(),e.removeEventListener("click",ue(this,yP)),delete ue(this,Ki).MapStyleToggle)})}get canAdjustMarker(){return ue(this,iP)}set canAdjustMarker(e){xr(this,iP,e),e?ue(this,xP).call(this):ue(this,A4).call(this)}get accessToken(){return ue(this,oP)||Au.accessToken}set accessToken(e){xr(this,oP,e)}get feature(){return ue(this,gh)}set feature(e){xr(this,gh,e),e?this.show():this.hide()}get template(){return IYe}get templateStyle(){return Vy}get templateUserStyle(){return ml(".MapboxAddressMinimap",this.theme)}get satelliteToggle(){return ue(this,sP)}set satelliteToggle(e){xr(this,sP,e),e?ue(this,bP).call(this):ue(this,M4).call(this)}get theme(){return ue(this,aP)}set theme(e){if(xr(this,aP,e),!ue(this,Ki)||!e)return;this.updateTemplateUserStyle(ml(".MapboxAddressMinimap",e));const{Marker:t,MapStyleToggle:r}=ue(this,Ki);t.innerHTML=Sc("marker",e),r&&(r.style.backgroundImage=ue(this,oS).call(this,this.mapStyleMode==="default"?"satellite":"default"))}get adjustBtnText(){return ue(this,lP)||b4}set adjustBtnText(e){xr(this,lP,e);const t=this.querySelector(".MinimapButtonAdjust");t.textContent=e||b4}get saveBtnText(){return ue(this,cP)||w4}set saveBtnText(e){xr(this,cP,e);const t=this.querySelector(".MinimapButtonSave");t.textContent=e||w4}get cancelBtnText(){return ue(this,uP)||S4}set cancelBtnText(e){xr(this,uP,e);const t=this.querySelector(".MinimapButtonCancel");t.textContent=e||S4}get mapStyleMode(){return ue(this,N_)}set mapStyleMode(e){const t=ue(this,N_);if(t===e||(xr(this,N_,e),!ue(this,Ki)))return;const{MapStyleToggle:r}=ue(this,Ki);r&&(r.style.backgroundImage=ue(this,oS).call(this,t),r.setAttribute("title",`Switch to ${t==="satellite"?"Satellite":"Default"}`),ue(this,iS).call(this))}get defaultMapStyle(){return ue(this,dP)}set defaultMapStyle(e){xr(this,dP,e),ue(this,iS).call(this)}get footer(){return ue(this,hP)}set footer(e){xr(this,hP,e);const t=this.querySelector(".MinimapFooter");t&&(typeof e=="string"?(t.textContent=e,t.removeAttribute("aria-hidden")):e?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true"))}get container(){return ue(this,fP)}set container(e){e&&(e.style.position="relative",xr(this,fP,e))}show(){if(!ue(this,gh))return;const e=ue(this,gh).geometry.coordinates;ue(this,wa).coordinate=e,xr(this,Ng,ue(this,vP).call(this,e));const{MapboxAddressMinimap:t,Image:r}=ue(this,Ki);r.src=ue(this,Ng),t.removeAttribute("aria-hidden")}hide(){const{MapboxAddressMinimap:e}=ue(this,Ki);e.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback(),xr(this,Ki,Uy(this,{MapboxAddressMinimap:".MapboxAddressMinimap",ImageContainer:".MinimapImageContainer",Image:".MinimapImage",Marker:".MinimapMarker",MapStyleToggle:".MinimapStyleToggle",EditButtons:".MinimapEditButtons",ButtonAdjust:".MinimapButtonAdjust",ButtonSave:".MinimapButtonSave",ButtonCancel:".MinimapButtonCancel"})),this.mapStyleMode=ue(this,N_),this.theme=Hn({},this.theme),this.canAdjustMarker&&ue(this,xP).call(this),this.satelliteToggle&&ue(this,bP).call(this),this.container=this.parentElement,new ResizeObserver(ue(this,_P)).observe(this.container),ue(this,_P).call(this);const{MapboxAddressMinimap:t,ImageContainer:r,Image:n,Marker:a}=ue(this,Ki);xr(this,wa,new CYe(r,n,a,this.keepMarkerCentered,TX,this.markerAnchor)),ue(this,wa).reCenter(),n.onload=ue(this,T4),n.onerror=ue(this,E4),n.src=ue(this,Ng),ue(this,gh)?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden","true")}attributeChangedCallback(e,t,r){if(e==="access-token")this.accessToken=r;else if(e==="can-adjust-marker")this.canAdjustMarker=r==="true";else if(e==="keep-marker-centered")this.keepMarkerCentered=r==="true";else if(e==="marker-anchor"){const n=r;this.markerAnchor=n,ue(this,wa)&&(ue(this,wa).anchor=n)}else e==="satellite-toggle"&&(this.satelliteToggle=r==="true")}};iP=new WeakMap;L_=new WeakMap;rS=new WeakMap;gh=new WeakMap;Ng=new WeakMap;ud=new WeakMap;dd=new WeakMap;Ki=new WeakMap;wa=new WeakMap;oP=new WeakMap;aP=new WeakMap;sP=new WeakMap;N_=new WeakMap;lP=new WeakMap;cP=new WeakMap;uP=new WeakMap;dP=new WeakMap;hP=new WeakMap;fP=new WeakMap;nS=new WeakMap;pP=new WeakMap;mP=new WeakMap;gP=new WeakMap;yP=new WeakMap;T4=new WeakMap;E4=new WeakMap;vP=new WeakMap;iS=new WeakMap;oS=new WeakMap;_P=new WeakMap;xP=new WeakMap;A4=new WeakMap;bP=new WeakMap;M4=new WeakMap;bU.observedAttributes=["access-token","can-adjust-marker","keep-marker-centered","marker-anchor","satellite-toggle"];window.MapboxAddressMinimap=bU;window.customElements.get("mapbox-address-minimap")||customElements.define("mapbox-address-minimap",bU);var DYe=ze.forwardRef((e,t)=>{const{accessToken:r,options:n,theme:a,popoverOptions:l,confirmOnBrowserAutofill:f,browserAutofillEnabled:i,children:_,onChange:b,onSuggest:E,onSuggestError:C,onRetrieve:R,interceptSearch:F}=e,U=ne.useRef();return ne.useImperativeHandle(t,()=>({focus:()=>{if(U.current)return U.current.focus();throw new Error("AddressAutofill is not mounted")}})),ne.useEffect(()=>{U.current&&(U.current.options=n)},[U.current,n]),ne.useEffect(()=>{U.current&&(U.current.interceptSearch=F)},[U.current,n]),ne.useEffect(()=>{U.current&&(U.current.theme=a)},[U.current,a]),ne.useEffect(()=>{U.current&&(U.current.popoverOptions=l)},[U.current,l]),ne.useEffect(()=>{U.current&&(U.current.confirmOnBrowserAutofill=f)},[U.current,f]),ne.useEffect(()=>{U.current&&(U.current.browserAutofillEnabled=i)},[U.current,i]),ne.useEffect(()=>{const $=U.current;if(!$||!E)return;const H=q=>E(q.detail);return $.addEventListener("suggest",H),()=>{$.removeEventListener("suggest",H)}},[U.current,E]),ne.useEffect(()=>{const $=U.current;if(!$||!C)return;const H=q=>C(q.detail);return $.addEventListener("suggesterror",H),()=>{$.removeEventListener("suggesterror",H)}},[U.current,C]),ne.useEffect(()=>{const $=U.current;if(!$||!R)return;const H=q=>R(q.detail);return $.addEventListener("retrieve",H),()=>{$.removeEventListener("retrieve",H)}},[U.current,R]),ne.useEffect(()=>{const $=U.current;if(!$||!b)return;const H=q=>{q.target===q.currentTarget&&b(q.detail)};return $.addEventListener("input",H),()=>{$.removeEventListener("input",H)}},[U.current,b]),ne.useEffect(()=>{U.current&&(U.current.accessToken=r)},[U.current,r]),ze.createElement("mapbox-address-autofill",{ref:U},_)});ze.forwardRef((e,t)=>{const{accessToken:r,options:n,theme:a,popoverOptions:l,placeholder:f,map:i,marker:_,mapboxgl:b,value:E,onChange:C,onSuggest:R,onSuggestError:F,onRetrieve:U,onClear:$,interceptSearch:H}=e,q=ne.useRef();return ne.useImperativeHandle(t,()=>({focus:()=>{if(q.current)return q.current.focus();throw new Error("SearchBox is not mounted")},search:G=>{if(q.current)return q.current.search(G);throw new Error("SearchBox is not mounted")}})),ne.useEffect(()=>{q.current&&(q.current.options=n||{})},[q.current,n]),ne.useEffect(()=>{q.current&&(q.current.interceptSearch=H)},[q.current,H]),ne.useEffect(()=>{q.current&&(q.current.theme=a)},[q.current,a]),ne.useEffect(()=>{q.current&&(q.current.popoverOptions=l)},[q.current,l]),ne.useEffect(()=>{q.current&&(q.current.placeholder=f)},[q.current,f]),ne.useEffect(()=>{q.current&&(q.current.value=E||"")},[q.current,E]),ne.useEffect(()=>{const G=q.current;if(G)return G.bindMap(i),()=>{G.unbindMap()}},[q.current,i]),ne.useEffect(()=>{q.current&&(q.current.marker=_)},[q.current,_]),ne.useEffect(()=>{q.current&&(q.current.mapboxgl=b)},[q.current,b]),ne.useEffect(()=>{const G=q.current;if(!G||!R)return;const J=te=>R(te.detail);return G.addEventListener("suggest",J),()=>{G.removeEventListener("suggest",J)}},[q.current,R]),ne.useEffect(()=>{const G=q.current;if(!G||!F)return;const J=te=>F(te.detail);return G.addEventListener("suggesterror",J),()=>{G.removeEventListener("suggesterror",J)}},[q.current,F]),ne.useEffect(()=>{const G=q.current;if(!G||!U)return;const J=te=>U(te.detail);return G.addEventListener("retrieve",J),()=>{G.removeEventListener("retrieve",J)}},[q.current,U]),ne.useEffect(()=>{const G=q.current;if(!G||!C)return;const J=te=>{te.target===te.currentTarget&&C(te.detail)};return G.addEventListener("input",J),()=>{G.removeEventListener("input",J)}},[q.current,C]),ne.useEffect(()=>{const G=q.current;if(!G||!$)return;const J=()=>{$()};return G.addEventListener("clear",J),()=>{G.removeEventListener("clear",J)}},[q.current,$]),ne.useEffect(()=>{q.current&&(q.current.accessToken=r)},[q.current,r]),ze.createElement("mapbox-search-box",{ref:q})});ze.forwardRef((e,t)=>{const{accessToken:r,options:n,theme:a,popoverOptions:l,placeholder:f,map:i,marker:_,mapboxgl:b,value:E,onChange:C,onSuggest:R,onSuggestError:F,onRetrieve:U,onClear:$,interceptSearch:H}=e,q=ne.useRef();return ne.useImperativeHandle(t,()=>({focus:()=>{if(q.current)return q.current.focus();throw new Error("Geocoder is not mounted")},search:G=>{if(q.current)return q.current.search(G);throw new Error("Geocoder is not mounted")}})),ne.useEffect(()=>{q.current&&(q.current.options=n||{})},[q.current,n]),ne.useEffect(()=>{q.current&&(q.current.interceptSearch=H)},[q.current,H]),ne.useEffect(()=>{q.current&&(q.current.theme=a)},[q.current,a]),ne.useEffect(()=>{q.current&&(q.current.popoverOptions=l)},[q.current,l]),ne.useEffect(()=>{q.current&&(q.current.placeholder=f)},[q.current,f]),ne.useEffect(()=>{q.current&&(q.current.value=E||"")},[q.current,E]),ne.useEffect(()=>{const G=q.current;if(G)return G.bindMap(i),()=>{G.unbindMap()}},[q.current,i]),ne.useEffect(()=>{q.current&&(q.current.marker=_)},[q.current,_]),ne.useEffect(()=>{q.current&&(q.current.mapboxgl=b)},[q.current,b]),ne.useEffect(()=>{const G=q.current;if(!G||!R)return;const J=te=>R(te.detail);return G.addEventListener("suggest",J),()=>{G.removeEventListener("suggest",J)}},[q.current,R]),ne.useEffect(()=>{const G=q.current;if(!G||!F)return;const J=te=>F(te.detail);return G.addEventListener("suggesterror",J),()=>{G.removeEventListener("suggesterror",J)}},[q.current,F]),ne.useEffect(()=>{const G=q.current;if(!G||!U)return;const J=te=>U(te.detail);return G.addEventListener("retrieve",J),()=>{G.removeEventListener("retrieve",J)}},[q.current,U]),ne.useEffect(()=>{const G=q.current;if(!G||!C)return;const J=te=>{te.target===te.currentTarget&&C(te.detail)};return G.addEventListener("input",J),()=>{G.removeEventListener("input",J)}},[q.current,C]),ne.useEffect(()=>{const G=q.current;if(!G||!$)return;const J=()=>{$()};return G.addEventListener("clear",J),()=>{G.removeEventListener("clear",J)}},[q.current,$]),ne.useEffect(()=>{q.current&&(q.current.accessToken=r)},[q.current,r]),ze.createElement("mapbox-geocoder",{ref:q})});wd.accessToken="pk.eyJ1IjoiY2FybG9zaDIiLCJhIjoiY203aWxlNHU5MXNwNjJzcTNmZGZscThqaSJ9.mt9vzXHbWRtOj6rqrpSD5g";const LYe=({onAddressSelect:e})=>{const t=ne.useRef(null),r=ne.useRef(null),n=ne.useRef(null),[a,l]=ne.useState("");ne.useEffect(()=>{if(t.current)return r.current=new wd.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v12",center:[-99.1332,19.4326],zoom:10}),r.current.addControl(new wd.NavigationControl),n.current=new wd.Marker({color:"#FF0000"}),()=>{r.current&&r.current.remove()}},[]);const f=async i=>{var C,R;if(!i.features||!i.features.length||!r.current||!n.current)return;const _=i.features[0],b=_.geometry.coordinates;r.current.flyTo({center:b,zoom:16}),n.current.setLngLat(b).addTo(r.current);const E={street:((C=_.properties.address_line1)==null?void 0:C.split(" ").slice(1).join(" "))||"",number:((R=_.properties.address_line1)==null?void 0:R.split(" ")[0])||"",neighborhood:_.properties.neighborhood||_.properties.locality||"",postal_code:_.properties.postcode||"",administrative_area:_.properties.region||"",sub_administrative_area:_.properties.place||"",lat:b[1],lng:b[0]};e(E)};return j.jsxs(Rd,{className:"h-full flex flex-col",children:[j.jsxs("div",{className:"p-4 border-b",children:[j.jsx("div",{className:"mb-4",children:j.jsxs("div",{className:"relative",children:[j.jsx(YO,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground z-10"}),j.jsx("div",{id:"address-autofill-container",children:(()=>{const i=DYe;return j.jsx(i,{accessToken:wd.accessToken,onRetrieve:f,children:j.jsx(Si,{placeholder:"Buscar dirección...",className:"pl-8",autoComplete:"street-address",value:a,onChange:_=>l(_.target.value)})})})()})]})}),j.jsx("div",{className:"text-sm text-muted-foreground",children:j.jsxs("p",{className:"flex items-center",children:[j.jsx(LJ,{className:"h-4 w-4 mr-1"}),"Busca una dirección o selecciona un punto en el mapa"]})})]}),j.jsx("div",{className:"flex-1 relative",children:j.jsx("div",{ref:t,className:"absolute inset-0"})})]})},{createElement:Ex,createContext:NYe,createRef:jKe,forwardRef:wle,useCallback:Ks,useContext:Sle,useEffect:dy,useImperativeHandle:Tle,useLayoutEffect:zYe,useMemo:jYe,useRef:nl,useState:v0}=kO,EX=kO[`useId${Math.random()}`.slice(0,5)],FYe=zYe,CR=NYe(null);CR.displayName="PanelGroupContext";const hy=FYe,BYe=typeof EX=="function"?EX:()=>null;let $Ye=0;function wU(e=null){const t=BYe(),r=nl(e||t||null);return r.current===null&&(r.current=""+$Ye++),e??r.current}function Ele({children:e,className:t="",collapsedSize:r,collapsible:n,defaultSize:a,forwardedRef:l,id:f,maxSize:i,minSize:_,onCollapse:b,onExpand:E,onResize:C,order:R,style:F,tagName:U="div",...$}){const H=Sle(CR);if(H===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:q,expandPanel:G,getPanelSize:J,getPanelStyle:te,groupId:oe,isPanelCollapsed:he,reevaluatePanelConstraints:le,registerPanel:ve,resizePanel:We,unregisterPanel:Ie}=H,Re=wU(f),$e=nl({callbacks:{onCollapse:b,onExpand:E,onResize:C},constraints:{collapsedSize:r,collapsible:n,defaultSize:a,maxSize:i,minSize:_},id:Re,idIsFromProps:f!==void 0,order:R});nl({didLogMissingDefaultSizeWarning:!1}),hy(()=>{const{callbacks:Je,constraints:rt}=$e.current,st={...rt};$e.current.id=Re,$e.current.idIsFromProps=f!==void 0,$e.current.order=R,Je.onCollapse=b,Je.onExpand=E,Je.onResize=C,rt.collapsedSize=r,rt.collapsible=n,rt.defaultSize=a,rt.maxSize=i,rt.minSize=_,(st.collapsedSize!==rt.collapsedSize||st.collapsible!==rt.collapsible||st.maxSize!==rt.maxSize||st.minSize!==rt.minSize)&&le($e.current,st)}),hy(()=>{const Je=$e.current;return ve(Je),()=>{Ie(Je)}},[R,Re,ve,Ie]),Tle(l,()=>({collapse:()=>{q($e.current)},expand:Je=>{G($e.current,Je)},getId(){return Re},getSize(){return J($e.current)},isCollapsed(){return he($e.current)},isExpanded(){return!he($e.current)},resize:Je=>{We($e.current,Je)}}),[q,G,J,he,Re,We]);const ot=te($e.current,a);return Ex(U,{...$,children:e,className:t,id:f,style:{...ot,...F},"data-panel":"","data-panel-collapsible":n||void 0,"data-panel-group-id":oe,"data-panel-id":Re,"data-panel-size":parseFloat(""+ot.flexGrow).toFixed(1)})}const Ale=wle((e,t)=>Ex(Ele,{...e,forwardedRef:t}));Ele.displayName="Panel";Ale.displayName="forwardRef(Panel)";let C4=null,Zg=null;function UYe(e,t){if(t){const r=(t&Ole)!==0,n=(t&kle)!==0,a=(t&Rle)!==0,l=(t&Dle)!==0;if(r)return a?"se-resize":l?"ne-resize":"e-resize";if(n)return a?"sw-resize":l?"nw-resize":"w-resize";if(a)return"s-resize";if(l)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function VYe(){Zg!==null&&(document.head.removeChild(Zg),C4=null,Zg=null)}function _N(e,t){const r=UYe(e,t);C4!==r&&(C4=r,Zg===null&&(Zg=document.createElement("style"),document.head.appendChild(Zg)),Zg.innerHTML=`*{cursor: ${r}!important;}`)}function Mle(e){return e.type==="keydown"}function Cle(e){return e.type.startsWith("pointer")}function Ple(e){return e.type.startsWith("mouse")}function PR(e){if(Cle(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Ple(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function WYe(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function GYe(e,t,r){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function qYe(e,t){if(e===t)throw new Error("Cannot compare node with itself");const r={a:CX(e),b:CX(t)};let n;for(;r.a.at(-1)===r.b.at(-1);)e=r.a.pop(),t=r.b.pop(),n=e;jn(n,"Stacking order can only be calculated for elements with a common ancestor");const a={a:MX(AX(r.a)),b:MX(AX(r.b))};if(a.a===a.b){const l=n.childNodes,f={a:r.a.at(-1),b:r.b.at(-1)};let i=l.length;for(;i--;){const _=l[i];if(_===f.a)return 1;if(_===f.b)return-1}}return Math.sign(a.a-a.b)}const HYe=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ZYe(e){var t;const r=getComputedStyle((t=Ile(e))!==null&&t!==void 0?t:e).display;return r==="flex"||r==="inline-flex"}function XYe(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||ZYe(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||HYe.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function AX(e){let t=e.length;for(;t--;){const r=e[t];if(jn(r,"Missing node"),XYe(r))return r}return null}function MX(e){return e&&Number(getComputedStyle(e).zIndex)||0}function CX(e){const t=[];for(;e;)t.push(e),e=Ile(e);return t}function Ile(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const Ole=1,kle=2,Rle=4,Dle=8,YYe=WYe()==="coarse";let Mu=[],_0=!1,Ep=new Map,IR=new Map;const eE=new Set;function KYe(e,t,r,n,a){var l;const{ownerDocument:f}=t,i={direction:r,element:t,hitAreaMargins:n,setResizeHandlerState:a},_=(l=Ep.get(f))!==null&&l!==void 0?l:0;return Ep.set(f,_+1),eE.add(i),PO(),function(){var E;IR.delete(e),eE.delete(i);const C=(E=Ep.get(f))!==null&&E!==void 0?E:1;if(Ep.set(f,C-1),PO(),C===1&&Ep.delete(f),Mu.includes(i)){const R=Mu.indexOf(i);R>=0&&Mu.splice(R,1),TU(),a("up",!0,null)}}}function PX(e){const{target:t}=e,{x:r,y:n}=PR(e);_0=!0,SU({target:t,x:r,y:n}),PO(),Mu.length>0&&(IO("down",e),e.preventDefault(),e.stopPropagation())}function Ew(e){const{x:t,y:r}=PR(e);if(_0&&e.buttons===0&&(_0=!1,IO("up",e)),!_0){const{target:n}=e;SU({target:n,x:t,y:r})}IO("move",e),TU(),Mu.length>0&&e.preventDefault()}function g_(e){const{target:t}=e,{x:r,y:n}=PR(e);IR.clear(),_0=!1,Mu.length>0&&e.preventDefault(),IO("up",e),SU({target:t,x:r,y:n}),TU(),PO()}function SU({target:e,x:t,y:r}){Mu.splice(0);let n=null;e instanceof HTMLElement&&(n=e),eE.forEach(a=>{const{element:l,hitAreaMargins:f}=a,i=l.getBoundingClientRect(),{bottom:_,left:b,right:E,top:C}=i,R=YYe?f.coarse:f.fine;if(t>=b-R&&t<=E+R&&r>=C-R&&r<=_+R){if(n!==null&&document.contains(n)&&l!==n&&!l.contains(n)&&!n.contains(l)&&qYe(n,l)>0){let U=n,$=!1;for(;U&&!U.contains(l);){if(GYe(U.getBoundingClientRect(),i)){$=!0;break}U=U.parentElement}if($)return}Mu.push(a)}})}function xN(e,t){IR.set(e,t)}function TU(){let e=!1,t=!1;Mu.forEach(n=>{const{direction:a}=n;a==="horizontal"?e=!0:t=!0});let r=0;IR.forEach(n=>{r|=n}),e&&t?_N("intersection",r):e?_N("horizontal",r):t?_N("vertical",r):VYe()}function PO(){Ep.forEach((e,t)=>{const{body:r}=t;r.removeEventListener("contextmenu",g_),r.removeEventListener("pointerdown",PX),r.removeEventListener("pointerleave",Ew),r.removeEventListener("pointermove",Ew)}),window.removeEventListener("pointerup",g_),window.removeEventListener("pointercancel",g_),eE.size>0&&(_0?(Mu.length>0&&Ep.forEach((e,t)=>{const{body:r}=t;e>0&&(r.addEventListener("contextmenu",g_),r.addEventListener("pointerleave",Ew),r.addEventListener("pointermove",Ew))}),window.addEventListener("pointerup",g_),window.addEventListener("pointercancel",g_)):Ep.forEach((e,t)=>{const{body:r}=t;e>0&&(r.addEventListener("pointerdown",PX,{capture:!0}),r.addEventListener("pointermove",Ew))}))}function IO(e,t){eE.forEach(r=>{const{setResizeHandlerState:n}=r,a=Mu.includes(r);n(e,a,t)})}function JYe(){const[e,t]=v0(0);return Ks(()=>t(r=>r+1),[])}function jn(e,t){if(!e)throw console.error(t),Error(t)}const EU=10;function Oy(e,t,r=EU){return e.toFixed(r)===t.toFixed(r)?0:e>t?1:-1}function xh(e,t,r=EU){return Oy(e,t,r)===0}function Ll(e,t,r){return Oy(e,t,r)===0}function QYe(e,t,r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){const a=e[n],l=t[n];if(!Ll(a,l,r))return!1}return!0}function t0({panelConstraints:e,panelIndex:t,size:r}){const n=e[t];jn(n!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:l,maxSize:f=100,minSize:i=0}=n;if(Oy(r,i)<0)if(l){const _=(a+i)/2;Oy(r,_)<0?r=a:r=i}else r=i;return r=Math.min(f,r),r=parseFloat(r.toFixed(EU)),r}function aS({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:n,prevLayout:a,trigger:l}){if(Ll(e,0))return t;const f=[...t],[i,_]=n;jn(i!=null,"Invalid first pivot index"),jn(_!=null,"Invalid second pivot index");let b=0;if(l==="keyboard"){{const C=e<0?_:i,R=r[C];jn(R,`Panel constraints not found for index ${C}`);const{collapsedSize:F=0,collapsible:U,minSize:$=0}=R;if(U){const H=t[C];if(jn(H!=null,`Previous layout not found for panel index ${C}`),Ll(H,F)){const q=$-H;Oy(q,Math.abs(e))>0&&(e=e<0?0-q:q)}}}{const C=e<0?i:_,R=r[C];jn(R,`No panel constraints found for index ${C}`);const{collapsedSize:F=0,collapsible:U,minSize:$=0}=R;if(U){const H=t[C];if(jn(H!=null,`Previous layout not found for panel index ${C}`),Ll(H,$)){const q=H-F;Oy(q,Math.abs(e))>0&&(e=e<0?0-q:q)}}}}{const C=e<0?1:-1;let R=e<0?_:i,F=0;for(;;){const $=t[R];jn($!=null,`Previous layout not found for panel index ${R}`);const q=t0({panelConstraints:r,panelIndex:R,size:100})-$;if(F+=q,R+=C,R<0||R>=r.length)break}const U=Math.min(Math.abs(e),Math.abs(F));e=e<0?0-U:U}{let R=e<0?i:_;for(;R>=0&&R<r.length;){const F=Math.abs(e)-Math.abs(b),U=t[R];jn(U!=null,`Previous layout not found for panel index ${R}`);const $=U-F,H=t0({panelConstraints:r,panelIndex:R,size:$});if(!Ll(U,H)&&(b+=U-H,f[R]=H,b.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?R--:R++}}if(QYe(a,f))return a;{const C=e<0?_:i,R=t[C];jn(R!=null,`Previous layout not found for panel index ${C}`);const F=R+b,U=t0({panelConstraints:r,panelIndex:C,size:F});if(f[C]=U,!Ll(U,F)){let $=F-U,q=e<0?_:i;for(;q>=0&&q<r.length;){const G=f[q];jn(G!=null,`Previous layout not found for panel index ${q}`);const J=G+$,te=t0({panelConstraints:r,panelIndex:q,size:J});if(Ll(G,te)||($-=te-G,f[q]=te),Ll($,0))break;e>0?q--:q++}}}const E=f.reduce((C,R)=>R+C,0);return Ll(E,100)?f:a}function eKe({layout:e,panelsArray:t,pivotIndices:r}){let n=0,a=100,l=0,f=0;const i=r[0];jn(i!=null,"No pivot index found"),t.forEach((C,R)=>{const{constraints:F}=C,{maxSize:U=100,minSize:$=0}=F;R===i?(n=$,a=U):(l+=$,f+=U)});const _=Math.min(a,100-l),b=Math.max(n,100-f),E=e[i];return{valueMax:_,valueMin:b,valueNow:E}}function tE(e,t=document){return Array.from(t.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${e}"]`))}function Lle(e,t,r=document){const a=tE(e,r).findIndex(l=>l.getAttribute("data-panel-resize-handle-id")===t);return a??null}function Nle(e,t,r){const n=Lle(e,t,r);return n!=null?[n,n+1]:[-1,-1]}function zle(e,t=document){var r;if(t instanceof HTMLElement&&(t==null||(r=t.dataset)===null||r===void 0?void 0:r.panelGroupId)==e)return t;const n=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return n||null}function OR(e,t=document){const r=t.querySelector(`[data-panel-resize-handle-id="${e}"]`);return r||null}function tKe(e,t,r,n=document){var a,l,f,i;const _=OR(t,n),b=tE(e,n),E=_?b.indexOf(_):-1,C=(a=(l=r[E])===null||l===void 0?void 0:l.id)!==null&&a!==void 0?a:null,R=(f=(i=r[E+1])===null||i===void 0?void 0:i.id)!==null&&f!==void 0?f:null;return[C,R]}function rKe({committedValuesRef:e,eagerValuesRef:t,groupId:r,layout:n,panelDataArray:a,panelGroupElement:l,setLayout:f}){nl({didWarnAboutMissingResizeHandle:!1}),hy(()=>{if(!l)return;const i=tE(r,l);for(let _=0;_<a.length-1;_++){const{valueMax:b,valueMin:E,valueNow:C}=eKe({layout:n,panelsArray:a,pivotIndices:[_,_+1]}),R=i[_];if(R!=null){const F=a[_];jn(F,`No panel data found for index "${_}"`),R.setAttribute("aria-controls",F.id),R.setAttribute("aria-valuemax",""+Math.round(b)),R.setAttribute("aria-valuemin",""+Math.round(E)),R.setAttribute("aria-valuenow",C!=null?""+Math.round(C):"")}}return()=>{i.forEach((_,b)=>{_.removeAttribute("aria-controls"),_.removeAttribute("aria-valuemax"),_.removeAttribute("aria-valuemin"),_.removeAttribute("aria-valuenow")})}},[r,n,a,l]),dy(()=>{if(!l)return;const i=t.current;jn(i,"Eager values not found");const{panelDataArray:_}=i,b=zle(r,l);jn(b!=null,`No group found for id "${r}"`);const E=tE(r,l);jn(E,`No resize handles found for group id "${r}"`);const C=E.map(R=>{const F=R.getAttribute("data-panel-resize-handle-id");jn(F,"Resize handle element has no handle id attribute");const[U,$]=tKe(r,F,_,l);if(U==null||$==null)return()=>{};const H=q=>{if(!q.defaultPrevented)switch(q.key){case"Enter":{q.preventDefault();const G=_.findIndex(J=>J.id===U);if(G>=0){const J=_[G];jn(J,`No panel data found for index ${G}`);const te=n[G],{collapsedSize:oe=0,collapsible:he,minSize:le=0}=J.constraints;if(te!=null&&he){const ve=aS({delta:Ll(te,oe)?le-oe:oe-te,initialLayout:n,panelConstraints:_.map(We=>We.constraints),pivotIndices:Nle(r,F,l),prevLayout:n,trigger:"keyboard"});n!==ve&&f(ve)}}break}}};return R.addEventListener("keydown",H),()=>{R.removeEventListener("keydown",H)}});return()=>{C.forEach(R=>R())}},[l,e,t,r,n,a,f])}function IX(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function jle(e,t){const r=e==="horizontal",{x:n,y:a}=PR(t);return r?n:a}function nKe(e,t,r,n,a){const l=r==="horizontal",f=OR(t,a);jn(f,`No resize handle element found for id "${t}"`);const i=f.getAttribute("data-panel-group-id");jn(i,"Resize handle element has no group id attribute");let{initialCursorPosition:_}=n;const b=jle(r,e),E=zle(i,a);jn(E,`No group element found for id "${i}"`);const C=E.getBoundingClientRect(),R=l?C.width:C.height;return(b-_)/R*100}function iKe(e,t,r,n,a,l){if(Mle(e)){const f=r==="horizontal";let i=0;e.shiftKey?i=100:a!=null?i=a:i=10;let _=0;switch(e.key){case"ArrowDown":_=f?0:i;break;case"ArrowLeft":_=f?-i:0;break;case"ArrowRight":_=f?i:0;break;case"ArrowUp":_=f?0:-i;break;case"End":_=100;break;case"Home":_=-100;break}return _}else return n==null?0:nKe(e,t,r,n,l)}function oKe({panelDataArray:e}){const t=Array(e.length),r=e.map(l=>l.constraints);let n=0,a=100;for(let l=0;l<e.length;l++){const f=r[l];jn(f,`Panel constraints not found for index ${l}`);const{defaultSize:i}=f;i!=null&&(n++,t[l]=i,a-=i)}for(let l=0;l<e.length;l++){const f=r[l];jn(f,`Panel constraints not found for index ${l}`);const{defaultSize:i}=f;if(i!=null)continue;const _=e.length-n,b=a/_;n++,t[l]=b,a-=b}return t}function y_(e,t,r){t.forEach((n,a)=>{const l=e[a];jn(l,`Panel data not found for index ${a}`);const{callbacks:f,constraints:i,id:_}=l,{collapsedSize:b=0,collapsible:E}=i,C=r[_];if(C==null||n!==C){r[_]=n;const{onCollapse:R,onExpand:F,onResize:U}=f;U&&U(n,C),E&&(R||F)&&(F&&(C==null||xh(C,b))&&!xh(n,b)&&F(),R&&(C==null||!xh(C,b))&&xh(n,b)&&R())}})}function MM(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function aKe({defaultSize:e,dragState:t,layout:r,panelData:n,panelIndex:a,precision:l=3}){const f=r[a];let i;return f==null?i=e!=null?e.toPrecision(l):"1":n.length===1?i="1":i=f.toPrecision(l),{flexBasis:0,flexGrow:i,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function sKe(e,t=10){let r=null;return(...a)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{e(...a)},t)}}function OX(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,r)=>{localStorage.setItem(t,r)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function Fle(e){return`react-resizable-panels:${e}`}function Ble(e){return e.map(t=>{const{constraints:r,id:n,idIsFromProps:a,order:l}=t;return a?n:l?`${l}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((t,r)=>t.localeCompare(r)).join(",")}function $le(e,t){try{const r=Fle(e),n=t.getItem(r);if(n){const a=JSON.parse(n);if(typeof a=="object"&&a!=null)return a}}catch{}return null}function lKe(e,t,r){var n,a;const l=(n=$le(e,r))!==null&&n!==void 0?n:{},f=Ble(t);return(a=l[f])!==null&&a!==void 0?a:null}function cKe(e,t,r,n,a){var l;const f=Fle(e),i=Ble(t),_=(l=$le(e,a))!==null&&l!==void 0?l:{};_[i]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{a.setItem(f,JSON.stringify(_))}catch(b){console.error(b)}}function kX({layout:e,panelConstraints:t}){const r=[...e],n=r.reduce((l,f)=>l+f,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(l=>`${l}%`).join(", ")}`);if(!Ll(n,100)&&r.length>0)for(let l=0;l<t.length;l++){const f=r[l];jn(f!=null,`No layout data found for index ${l}`);const i=100/n*f;r[l]=i}let a=0;for(let l=0;l<t.length;l++){const f=r[l];jn(f!=null,`No layout data found for index ${l}`);const i=t0({panelConstraints:t,panelIndex:l,size:f});f!=i&&(a+=f-i,r[l]=i)}if(!Ll(a,0))for(let l=0;l<t.length;l++){const f=r[l];jn(f!=null,`No layout data found for index ${l}`);const i=f+a,_=t0({panelConstraints:t,panelIndex:l,size:i});if(f!==_&&(a-=_-f,r[l]=_,Ll(a,0)))break}return r}const uKe=100,sS={getItem:e=>(OX(sS),sS.getItem(e)),setItem:(e,t)=>{OX(sS),sS.setItem(e,t)}},RX={};function Ule({autoSaveId:e=null,children:t,className:r="",direction:n,forwardedRef:a,id:l=null,onLayout:f=null,keyboardResizeBy:i=null,storage:_=sS,style:b,tagName:E="div",...C}){const R=wU(l),F=nl(null),[U,$]=v0(null),[H,q]=v0([]),G=JYe(),J=nl({}),te=nl(new Map),oe=nl(0),he=nl({autoSaveId:e,direction:n,dragState:U,id:R,keyboardResizeBy:i,onLayout:f,storage:_}),le=nl({layout:H,panelDataArray:[],panelDataArrayChanged:!1});nl({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),Tle(a,()=>({getId:()=>he.current.id,getLayout:()=>{const{layout:ut}=le.current;return ut},setLayout:ut=>{const{onLayout:tr}=he.current,{layout:mr,panelDataArray:rr}=le.current,Ut=kX({layout:ut,panelConstraints:rr.map(gr=>gr.constraints)});IX(mr,Ut)||(q(Ut),le.current.layout=Ut,tr&&tr(Ut),y_(rr,Ut,J.current))}}),[]),hy(()=>{he.current.autoSaveId=e,he.current.direction=n,he.current.dragState=U,he.current.id=R,he.current.onLayout=f,he.current.storage=_}),rKe({committedValuesRef:he,eagerValuesRef:le,groupId:R,layout:H,panelDataArray:le.current.panelDataArray,setLayout:q,panelGroupElement:F.current}),dy(()=>{const{panelDataArray:ut}=le.current;if(e){if(H.length===0||H.length!==ut.length)return;let tr=RX[e];tr==null&&(tr=sKe(cKe,uKe),RX[e]=tr);const mr=[...ut],rr=new Map(te.current);tr(e,mr,rr,H,_)}},[e,H,_]),dy(()=>{});const ve=Ks(ut=>{const{onLayout:tr}=he.current,{layout:mr,panelDataArray:rr}=le.current;if(ut.constraints.collapsible){const Ut=rr.map(cr=>cr.constraints),{collapsedSize:gr=0,panelSize:Gt,pivotIndices:ge}=Sg(rr,ut,mr);if(jn(Gt!=null,`Panel size not found for panel "${ut.id}"`),!xh(Gt,gr)){te.current.set(ut.id,Gt);const Ot=z_(rr,ut)===rr.length-1?Gt-gr:gr-Gt,Pr=aS({delta:Ot,initialLayout:mr,panelConstraints:Ut,pivotIndices:ge,prevLayout:mr,trigger:"imperative-api"});MM(mr,Pr)||(q(Pr),le.current.layout=Pr,tr&&tr(Pr),y_(rr,Pr,J.current))}}},[]),We=Ks((ut,tr)=>{const{onLayout:mr}=he.current,{layout:rr,panelDataArray:Ut}=le.current;if(ut.constraints.collapsible){const gr=Ut.map(_t=>_t.constraints),{collapsedSize:Gt=0,panelSize:ge=0,minSize:cr=0,pivotIndices:Ot}=Sg(Ut,ut,rr),Pr=tr??cr;if(xh(ge,Gt)){const _t=te.current.get(ut.id),hn=_t!=null&&_t>=Pr?_t:Pr,Ln=z_(Ut,ut)===Ut.length-1?ge-hn:hn-ge,Ge=aS({delta:Ln,initialLayout:rr,panelConstraints:gr,pivotIndices:Ot,prevLayout:rr,trigger:"imperative-api"});MM(rr,Ge)||(q(Ge),le.current.layout=Ge,mr&&mr(Ge),y_(Ut,Ge,J.current))}}},[]),Ie=Ks(ut=>{const{layout:tr,panelDataArray:mr}=le.current,{panelSize:rr}=Sg(mr,ut,tr);return jn(rr!=null,`Panel size not found for panel "${ut.id}"`),rr},[]),Re=Ks((ut,tr)=>{const{panelDataArray:mr}=le.current,rr=z_(mr,ut);return aKe({defaultSize:tr,dragState:U,layout:H,panelData:mr,panelIndex:rr})},[U,H]),$e=Ks(ut=>{const{layout:tr,panelDataArray:mr}=le.current,{collapsedSize:rr=0,collapsible:Ut,panelSize:gr}=Sg(mr,ut,tr);return jn(gr!=null,`Panel size not found for panel "${ut.id}"`),Ut===!0&&xh(gr,rr)},[]),ot=Ks(ut=>{const{layout:tr,panelDataArray:mr}=le.current,{collapsedSize:rr=0,collapsible:Ut,panelSize:gr}=Sg(mr,ut,tr);return jn(gr!=null,`Panel size not found for panel "${ut.id}"`),!Ut||Oy(gr,rr)>0},[]),Je=Ks(ut=>{const{panelDataArray:tr}=le.current;tr.push(ut),tr.sort((mr,rr)=>{const Ut=mr.order,gr=rr.order;return Ut==null&&gr==null?0:Ut==null?-1:gr==null?1:Ut-gr}),le.current.panelDataArrayChanged=!0,G()},[G]);hy(()=>{if(le.current.panelDataArrayChanged){le.current.panelDataArrayChanged=!1;const{autoSaveId:ut,onLayout:tr,storage:mr}=he.current,{layout:rr,panelDataArray:Ut}=le.current;let gr=null;if(ut){const ge=lKe(ut,Ut,mr);ge&&(te.current=new Map(Object.entries(ge.expandToSizes)),gr=ge.layout)}gr==null&&(gr=oKe({panelDataArray:Ut}));const Gt=kX({layout:gr,panelConstraints:Ut.map(ge=>ge.constraints)});IX(rr,Gt)||(q(Gt),le.current.layout=Gt,tr&&tr(Gt),y_(Ut,Gt,J.current))}}),hy(()=>{const ut=le.current;return()=>{ut.layout=[]}},[]);const rt=Ks(ut=>function(mr){mr.preventDefault();const rr=F.current;if(!rr)return()=>null;const{direction:Ut,dragState:gr,id:Gt,keyboardResizeBy:ge,onLayout:cr}=he.current,{layout:Ot,panelDataArray:Pr}=le.current,{initialLayout:_t}=gr??{},hn=Nle(Gt,ut,rr);let qr=iKe(mr,ut,Ut,gr,ge,rr);const Ln=Ut==="horizontal";document.dir==="rtl"&&Ln&&(qr=-qr);const Ge=Pr.map(dr=>dr.constraints),vt=aS({delta:qr,initialLayout:_t??Ot,panelConstraints:Ge,pivotIndices:hn,prevLayout:Ot,trigger:Mle(mr)?"keyboard":"mouse-or-touch"}),kt=!MM(Ot,vt);(Cle(mr)||Ple(mr))&&oe.current!=qr&&(oe.current=qr,!kt&&qr!==0?Ln?xN(ut,qr<0?Ole:kle):xN(ut,qr<0?Rle:Dle):xN(ut,0)),kt&&(q(vt),le.current.layout=vt,cr&&cr(vt),y_(Pr,vt,J.current))},[]),st=Ks((ut,tr)=>{const{onLayout:mr}=he.current,{layout:rr,panelDataArray:Ut}=le.current,gr=Ut.map(_t=>_t.constraints),{panelSize:Gt,pivotIndices:ge}=Sg(Ut,ut,rr);jn(Gt!=null,`Panel size not found for panel "${ut.id}"`);const Ot=z_(Ut,ut)===Ut.length-1?Gt-tr:tr-Gt,Pr=aS({delta:Ot,initialLayout:rr,panelConstraints:gr,pivotIndices:ge,prevLayout:rr,trigger:"imperative-api"});MM(rr,Pr)||(q(Pr),le.current.layout=Pr,mr&&mr(Pr),y_(Ut,Pr,J.current))},[]),at=Ks((ut,tr)=>{const{layout:mr,panelDataArray:rr}=le.current,{collapsedSize:Ut=0,collapsible:gr}=tr,{collapsedSize:Gt=0,collapsible:ge,maxSize:cr=100,minSize:Ot=0}=ut.constraints,{panelSize:Pr}=Sg(rr,ut,mr);Pr!=null&&(gr&&ge&&xh(Pr,Ut)?xh(Ut,Gt)||st(ut,Gt):Pr<Ot?st(ut,Ot):Pr>cr&&st(ut,cr))},[st]),Be=Ks((ut,tr)=>{const{direction:mr}=he.current,{layout:rr}=le.current;if(!F.current)return;const Ut=OR(ut,F.current);jn(Ut,`Drag handle element not found for id "${ut}"`);const gr=jle(mr,tr);$({dragHandleId:ut,dragHandleRect:Ut.getBoundingClientRect(),initialCursorPosition:gr,initialLayout:rr})},[]),ct=Ks(()=>{$(null)},[]),jt=Ks(ut=>{const{panelDataArray:tr}=le.current,mr=z_(tr,ut);mr>=0&&(tr.splice(mr,1),delete J.current[ut.id],le.current.panelDataArrayChanged=!0,G())},[G]),Lt=jYe(()=>({collapsePanel:ve,direction:n,dragState:U,expandPanel:We,getPanelSize:Ie,getPanelStyle:Re,groupId:R,isPanelCollapsed:$e,isPanelExpanded:ot,reevaluatePanelConstraints:at,registerPanel:Je,registerResizeHandle:rt,resizePanel:st,startDragging:Be,stopDragging:ct,unregisterPanel:jt,panelGroupElement:F.current}),[ve,U,n,We,Ie,Re,R,$e,ot,at,Je,rt,st,Be,ct,jt]),$t={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Ex(CR.Provider,{value:Lt},Ex(E,{...C,children:t,className:r,id:l,ref:F,style:{...$t,...b},"data-panel-group":"","data-panel-group-direction":n,"data-panel-group-id":R}))}const Vle=wle((e,t)=>Ex(Ule,{...e,forwardedRef:t}));Ule.displayName="PanelGroup";Vle.displayName="forwardRef(PanelGroup)";function z_(e,t){return e.findIndex(r=>r===t||r.id===t.id)}function Sg(e,t,r){const n=z_(e,t),l=n===e.length-1?[n-1,n]:[n,n+1],f=r[n];return{...t.constraints,panelSize:f,pivotIndices:l}}function dKe({disabled:e,handleId:t,resizeHandler:r,panelGroupElement:n}){dy(()=>{if(e||r==null||n==null)return;const a=OR(t,n);if(a==null)return;const l=f=>{if(!f.defaultPrevented)switch(f.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{f.preventDefault(),r(f);break}case"F6":{f.preventDefault();const i=a.getAttribute("data-panel-group-id");jn(i,`No group element found for id "${i}"`);const _=tE(i,n),b=Lle(i,t,n);jn(b!==null,`No resize element found for id "${t}"`);const E=f.shiftKey?b>0?b-1:_.length-1:b+1<_.length?b+1:0;_[E].focus();break}}};return a.addEventListener("keydown",l),()=>{a.removeEventListener("keydown",l)}},[n,e,t,r])}function Wle({children:e=null,className:t="",disabled:r=!1,hitAreaMargins:n,id:a,onBlur:l,onDragging:f,onFocus:i,style:_={},tabIndex:b=0,tagName:E="div",...C}){var R,F;const U=nl(null),$=nl({onDragging:f});dy(()=>{$.current.onDragging=f});const H=Sle(CR);if(H===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:q,groupId:G,registerResizeHandle:J,startDragging:te,stopDragging:oe,panelGroupElement:he}=H,le=wU(a),[ve,We]=v0("inactive"),[Ie,Re]=v0(!1),[$e,ot]=v0(null),Je=nl({state:ve});hy(()=>{Je.current.state=ve}),dy(()=>{if(r)ot(null);else{const Be=J(le);ot(()=>Be)}},[r,le,J]);const rt=(R=n==null?void 0:n.coarse)!==null&&R!==void 0?R:15,st=(F=n==null?void 0:n.fine)!==null&&F!==void 0?F:5;return dy(()=>{if(r||$e==null)return;const Be=U.current;return jn(Be,"Element ref not attached"),KYe(le,Be,q,{coarse:rt,fine:st},(jt,Lt,$t)=>{if(Lt)switch(jt){case"down":{We("drag"),jn($t,'Expected event to be defined for "down" action'),te(le,$t);const{onDragging:ut}=$.current;ut&&ut(!0);break}case"move":{const{state:ut}=Je.current;ut!=="drag"&&We("hover"),jn($t,'Expected event to be defined for "move" action'),$e($t);break}case"up":{We("hover"),oe();const{onDragging:ut}=$.current;ut&&ut(!1);break}}else We("inactive")})},[rt,q,r,st,J,le,$e,te,oe]),dKe({disabled:r,handleId:le,resizeHandler:$e,panelGroupElement:he}),Ex(E,{...C,children:e,className:t,id:a,onBlur:()=>{Re(!1),l==null||l()},onFocus:()=>{Re(!0),i==null||i()},ref:U,role:"separator",style:{...{touchAction:"none",userSelect:"none"},..._},tabIndex:b,"data-panel-group-direction":q,"data-panel-group-id":G,"data-resize-handle":"","data-resize-handle-active":ve==="drag"?"pointer":Ie?"keyboard":void 0,"data-resize-handle-state":ve,"data-panel-resize-handle-enabled":!r,"data-panel-resize-handle-id":le})}Wle.displayName="PanelResizeHandle";const hKe=({className:e,...t})=>j.jsx(Vle,{className:Nr("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t}),DX=Ale,fKe=({withHandle:e,className:t,...r})=>j.jsx(Wle,{className:Nr("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...r,children:e&&j.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:j.jsx(Ame,{className:"h-2.5 w-2.5"})})}),pKe=()=>{const e=Ny(),{register:t,handleSubmit:r,setValue:n,formState:{errors:a,isSubmitting:l}}=j$(),f=async _=>{try{const{data:b,error:E}=await mo.auth.getUser();if(E)throw E;if(!b.user){Lp.error("Usuario no autenticado");return}const{error:C}=await mo.from("orders").insert({..._,is_manual:!0,user_id:b.user.id,country:"MX"});if(C)throw C;Lp.success("Orden manual creada exitosamente"),e("/admin/orders")}catch(b){console.error("Error creating manual order:",b),Lp.error("Error al crear la orden manual")}},i=_=>{Object.entries(_).forEach(([b,E])=>{E&&n(b,E)}),Lp.success("Dirección seleccionada correctamente")};return j.jsxs("div",{className:"py-6",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsxs("div",{className:"flex items-center",children:[j.jsx(Zn,{variant:"ghost",size:"sm",onClick:()=>e("/admin/orders"),className:"mr-2",children:j.jsx(HP,{className:"h-4 w-4"})}),j.jsx("h1",{className:"text-2xl font-bold",children:"Nueva Orden Manual"})]})}),j.jsx("form",{onSubmit:r(f),children:j.jsxs(hKe,{direction:"horizontal",className:"min-h-[600px] rounded-lg border",children:[j.jsx(DX,{defaultSize:50,minSize:30,children:j.jsxs("div",{className:"h-full overflow-y-auto p-6 space-y-6 bg-white",children:[j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"street",children:"Calle"}),j.jsx(Si,{id:"street",...t("street",{required:"La calle es requerida"}),placeholder:"Calle"}),a.street&&j.jsx("p",{className:"text-sm text-red-500",children:a.street.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"number",children:"Número"}),j.jsx(Si,{id:"number",...t("number",{required:"El número es requerido"}),placeholder:"Número exterior"}),a.number&&j.jsx("p",{className:"text-sm text-red-500",children:a.number.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"int_number",children:"Número Interior"}),j.jsx(Si,{id:"int_number",...t("int_number"),placeholder:"Número interior (opcional)"})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"neighborhood",children:"Colonia"}),j.jsx(Si,{id:"neighborhood",...t("neighborhood",{required:"La colonia es requerida"}),placeholder:"Colonia"}),a.neighborhood&&j.jsx("p",{className:"text-sm text-red-500",children:a.neighborhood.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"postal_code",children:"Código Postal"}),j.jsx(Si,{id:"postal_code",...t("postal_code",{required:"El código postal es requerido"}),placeholder:"Código postal"}),a.postal_code&&j.jsx("p",{className:"text-sm text-red-500",children:a.postal_code.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"administrative_area",children:"Estado"}),j.jsx(Si,{id:"administrative_area",...t("administrative_area",{required:"El estado es requerido"}),placeholder:"Estado"}),a.administrative_area&&j.jsx("p",{className:"text-sm text-red-500",children:a.administrative_area.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"sub_administrative_area",children:"Ciudad"}),j.jsx(Si,{id:"sub_administrative_area",...t("sub_administrative_area",{required:"La ciudad es requerida"}),placeholder:"Ciudad"}),a.sub_administrative_area&&j.jsx("p",{className:"text-sm text-red-500",children:a.sub_administrative_area.message})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"reference",children:"Referencia"}),j.jsx(Si,{id:"reference",...t("reference"),placeholder:"Referencia (opcional)"})]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"text-sm font-medium",htmlFor:"notes",children:"Notas"}),j.jsx(wse,{id:"notes",...t("notes"),placeholder:"Notas adicionales (opcional)",className:"h-24"})]}),j.jsx("input",{type:"hidden",...t("lat")}),j.jsx("input",{type:"hidden",...t("lng")}),j.jsxs("div",{className:"flex justify-end space-x-4",children:[j.jsx(Zn,{type:"button",variant:"outline",onClick:()=>e("/admin/orders"),children:"Cancelar"}),j.jsxs(Zn,{type:"submit",disabled:l,children:[j.jsx(Pme,{className:"h-4 w-4 mr-2"}),l?"Creando...":"Crear Orden"]})]})]})}),j.jsx(fKe,{withHandle:!0}),j.jsx(DX,{defaultSize:50,minSize:30,children:j.jsx(LYe,{onAddressSelect:i})})]})})]})},mKe=new kve,gKe=()=>j.jsx(Y_e,{children:j.jsx(zve,{client:mKe,children:j.jsxs(mve,{children:[j.jsx(pge,{}),j.jsx(Vge,{}),j.jsxs(U_e,{children:[j.jsx(Qo,{path:"/",element:j.jsx(F_e,{to:"/login",replace:!0})}),j.jsx(Qo,{path:"/login",element:j.jsx(wbe,{})}),j.jsxs(Qo,{path:"/admin",element:j.jsx(bbe,{}),children:[j.jsx(Qo,{index:!0,element:j.jsx(J6e,{})}),j.jsx(Qo,{path:"create-user",element:j.jsx(Sbe,{})}),j.jsx(Qo,{path:"orders",element:j.jsx(tWe,{})}),j.jsx(Qo,{path:"manual-order",element:j.jsx(pKe,{})}),j.jsx(Qo,{path:"routes",element:j.jsx(nWe,{})}),j.jsx(Qo,{path:"packages",element:j.jsx(GWe,{})}),j.jsx(Qo,{path:"inventory",element:j.jsx(qWe,{})}),j.jsx(Qo,{path:"fleet",element:j.jsx(HWe,{})}),j.jsx(Qo,{path:"operators",element:j.jsx(ZWe,{})}),j.jsx(Qo,{path:"operators/new",element:j.jsx(j9e,{})}),j.jsx(Qo,{path:"operators/:id/edit",element:j.jsx(F9e,{})}),j.jsx(Qo,{path:"tms",element:j.jsx(B9e,{})}),j.jsx(Qo,{path:"tracking",element:j.jsx($9e,{})}),j.jsx(Qo,{path:"documents",element:j.jsx(U9e,{})}),j.jsx(Qo,{path:"settings",element:j.jsx(V9e,{})})]}),j.jsx(Qo,{path:"*",element:j.jsx(W9e,{})})]})]})})});nJ(document.getElementById("root")).render(j.jsx(gKe,{}));export{hi as g};
